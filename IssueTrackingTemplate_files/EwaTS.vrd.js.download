'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[20],{1377:function(w,C,a){a.r(C);w=a(521);var b=a(1),c=a(10);C=a(0);var h=a(734),k=a(53),d=a(38),f=a(993);class u extends h.a{constructor(n){super(n)}Uf(){d.TaskExtensions.za(k.GetServiceTaskFactory.create(this.$.ga,102,this.$.ka,this.Ta),n=>{this.Lf([new f.FormulaBarCommandHandler(this.$,n.result)])},this.$.ka)}static la(n){h.a.qg(280,new u(n))}}Object(C.a)(u,"FormulaBarCommandHandlerFactory",h.a,[]);var r=a(233),
t=a(6),v=a(901),x=a(49),m=a(737);class l extends r.a{constructor(n){super();this.$=n;this.je()}create(){x.PageLoadTrackingInfo.instance.cia(t.a.Dna);const n=k.GetServiceTaskFactory.ud(this.$.ga,388,387,this.Ta);d.TaskExtensions.za(d.TaskExtensions.Wf([n],this.ka),()=>{this.Ld(Object(m.a)(this.$.ga,172,()=>new v.FormulaBar(this.$,n.result)))},this.$.ka,3)}}Object(C.a)(l,"FormulaBarFactory",r.a,[]);w.a.Dk(".ewa-fb{height:20px;background-color:#fff;color:#444;overflow:hidden;padding:10px 8px;position:relative;margin:auto}.grid-visual-refresh .ewa-fb{height:32px;overflow:hidden;padding:0;background-color:#f5f5f5}.ewa-fb-placeholder{color:#bbb}.ewa-root-ltr .ewa-fb{padding-right:4px}.ewa-root-rtl .ewa-fb{padding-left:4px}.ewa-fb-text-box,.ewa-fb-presence-cover{display:inline-block;margin:0 0 0 1px;padding:0;height:18px;width:100%;z-index:101}.ewa-fb-presence-cover{opacity:.2;position:absolute;margin:1px 10px 0 10px}.ewa-fb-text-box,.ewa-fb-text-box-new-theme,.ewa-fb-text-box-monospace-experiment{overflow:hidden;border:1px solid #e6e7e8;outline:none;resize:none;position:relative;flex-grow:1;white-space:pre}.ewa-fb-text-box:focus-within{outline:1px auto}.grid-visual-refresh .ewa-fb-text-box{background-color:#fff;height:18px;line-height:22px;margin:0 0 0 0;top:4px;width:auto;position:relative;padding:2px}.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#fff;height:18px;line-height:18px;margin:0;top:4px;width:auto;position:relative;padding:2px}.ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:18px;overflow:hidden;margin-top:1px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:100%;width:calc(100% - 4px);scrollbar-width:thin;scrollbar-color:#b1b0b0 #fff}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:start{background-color:#fff;height:18px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:end{background-color:#fff;height:4px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-thumb{border-radius:10px;background-color:#b1b0b0}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar{width:6px}.ewa-fb-extended .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{overflow-y:auto;overflow-x:hidden}.grid-visual-refresh .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit;height:inherit}.grid-visual-refresh .ewa-fb-text-box.ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit}.ewa-fb-text-box.ql-container{pointer-events:none}.ewa-fb-text-box .ewa-rteTextElement{pointer-events:all}.ewa-root-ltr .ewa-fb-text-box,.ewa-root-ltr .ewa-fb-presence-cover{left:33px}.ewa-root-ltr .grid-visual-refresh .ewa-fb-text-box{right:4px;left:38px}.ewa-root-rtl .ewa-fb-text-box .ewa-root-rtl .ewa-fb-presence-cover{right:33px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-text-box{right:38px;left:4px}.ewa-fb .functionbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101}.green-fill-paths:hover path{fill:#107c41}.grid-visual-refresh .ewa-fb .functionbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-root-ltr .grid-visual-refresh .ewa-fb .functionbox{margin-right:3px}.ewa-root-rtl .grid-visual-refresh .ewa-fb .functionbox{margin-left:3px}.ewa-fb-presence-cover-internal{height:100%}.ewa-root-ltr .ewa-fb-presence-cover-internal{margin-right:50px}.ewa-root-rtl .ewa-fb-presence-cover-internal{margin-left:50px}.ewa-fb .functionbox .clip13x13{margin:2px 8px 1px 8px}.grid-visual-refresh .ewa-fb .functionbox .clip13x13{margin-top:4px;margin-bottom:4px}.ewa-fb .functionbox:hover .ewaboot_formulabar13{margin-top:-13px}.ewa-root-ltr .ewa-fb.drop-down{padding-left:3px}.ewa-root-rtl .ewa-fb.drop-down{padding-right:3px}.ewa-fb .ok-cancel-buttons-container{position:relative;z-index:101;display:none;flex-flow:row}.ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{display:flex;order:1;height:22px;border:1px solid #e6e7e8;top:4px}.ewa-root-rtl .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-left:3px}.ewa-root-ltr .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-right:3px}.grid-visual-refresh .ewa-fb .ok-cancel-buttons-container{position:relative}.ewa-fb .okbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;margin:0 2px 0 2px;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .okbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb .cancelbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .cancelbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb-nb{display:flex;flex-flow:row}.grid-visual-refresh .ewa-fb-nb{background-color:#f5f5f5;height:32px}.ewa-fb-nb .ewa-fb.drop-down{flex:1 1 auto}.grid-visual-refresh .ewa-fb-nb .ewa-fb.drop-down{right:0;height:32px;display:flex;flex-flow:row}.ewa-fb-name-box-placeholder{position:relative;width:118px;float:left;display:block;overflow:hidden;height:20px;background-color:#fff;padding:2px;align-self:center;margin:0 0 0 4px}.ewa-root-rtl .ewa-fb-name-box-placeholder{float:right;margin:0 4px 0 0}.button-disabled{pointer-events:none;background-color:#f0f0f0 !important}.ewa-fb-extended .ewa-fb-expand-button-img{transform:rotate(180deg)}.ewa-fb-expand-button-container{padding-top:3px;position:absolute;z-index:102}.ewa-root-ltr .ewa-fb-expand-button-container{padding-right:7px;right:0}.ewa-root-rtl .ewa-fb-expand-button-container{padding-left:7px;left:0}.ewa-fb-text-div-container{width:100%;position:relative}.ewa-fb-refactor .ewa-fb-text-div-container{order:2}body.ewa-fb-drag-resize *{cursor:inherit !important}body.ewa-fb-drag-resize{cursor:ns-resize}.ewa-fb-drag-handler{position:absolute;height:6px;width:100%;cursor:ns-resize;z-index:102;bottom:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new{height:calc(100% - 8px);box-sizing:border-box;width:100%}.grid-visual-refresh .ewa-fb-refactor.ewa-fb-nb .ewa-fb.drop-down{height:inherit}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{height:auto;overflow:hidden;white-space:pre-wrap}.ewa-root-ltr .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-right:20px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-left:20px}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .functionbox{top:0;order:2;border:none;margin:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .okbox{top:0;margin:0;border:none;order:1}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .cancelbox{top:0;border:none;order:0}.ewr-presentMode-on .ewa-fb{color:#f3f2f1}.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#3c3c3c;border:1px solid #3c3c3c;border-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#292827 !important;border:1px solid #292827 !important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-nb{background-color:#323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-nb{background-color:#000 !important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .functionbox{background-color:#323130;border:1px solid #323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .functionbox{background-color:#000 !important;border:1px solid #000 !important}.ewr-presentMode-on .green-fill-paths:hover path{fill:#37a660}.ewr-presentMode-on .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{border:none}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-on .ewa-fb .okbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-right-radius:2px;border-bottom-right-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .okbox{background-color:#292827 !important;border:1px solid #292827 !important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-on .ewa-fb .cancelbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-left-radius:2px;border-bottom-left-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .cancelbox{background-color:#292827 !important;border:1px solid #292827 !important}.ewr-presentMode-on .ewa-fb-expand-button-img{fill:#e1dfdd}.ewr-presentMode-on .ql-editor *::selection{background-color:#605e5c}.ewr-presentMode-on .functionbox.button-disabled{background-color:#323130 !important}.ewr-presentMode-on .ewa-fb-function-button-img{fill:#e1dfdd}.ewr-presentMode-on .functionbox.button-disabled .ewa-fb-function-button-img{fill:#8a8886 !important}.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .functionbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-transition .ewa-fb .okbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-transition .ewa-fb .cancelbox{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-fb,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-nb,.ewr-presentMode-transition .functionbox.button-disabled{transition:background-color .4s linear,color .4s linear}.ewa-fb-nb-fix{flex:0 0 auto !important}.ewa-fb-nb .cui-cb{flex:0 1 auto;align-self:center;z-index:101}.ewa-fb-refactor.ewa-fb-nb .cui-cb{align-self:baseline;top:4px}@media screen and (-ms-high-contrast:active){.ewa-fb-nb .cui-cb:hover .cui-dd-arrow-button path,.ewa-fb-nb .cui-fa-dropped .cui-dd-arrow-button .ewa-svg-icon path,.ewa-fb-nb .cui-cb-focus .cui-dd-arrow-button .ewa-svg-icon path{fill:HighlightText}.ewa-fb-nb .cui-cb .cui-cb-input{border-color:WindowText;background-color:Window !important}.ewa-fb-nb .cui-fa-dropped .cui-dd-arrow-button{background-color:Highlight}.ewa-fb-nb .cui-dd-arrow-button .ewa-svg-icon path{fill:ButtonText}}.ewa-root-ltr .grid-visual-refresh .ewa-fb-nb .cui-cb{position:relative;margin:0 0 0 4px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-nb .cui-cb{position:relative;margin:0 4px 0 0}.ewa-fb-nb .cui-cb-input{height:14px;font-size:14.7px;font-family:Calibri}.grid-visual-refresh .ewa-fb-nb .cui-cb-input{height:18px}.ewa-fb-nb .cui-dd-arrow-button{height:18px;background-color:#fff}.grid-visual-refresh .ewa-fb-nb .cui-dd-arrow-button{height:18px;padding-top:2px;padding-bottom:2px}.ewr-presentMode-on .ewa-fb-nb .cui-cb-input{background-color:#3c3c3c;color:#f3f2f1;border:1px solid #3c3c3c;border-top-left-radius:2px;border-bottom-left-radius:2px}.ewr-presentMode-on .ewa-fb-nb .cui-disabled .cui-cb-input{background-color:#3c3c3c !important;border:1px solid #3c3c3c !important}.ewr-presentMode-on .ewa-fb-nb .cui-cb:hover .cui-cb-input{border-color:#37a660 !important}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb-nb .cui-cb-input{background-color:#292827;border:1px solid #292827}.ewr-presentMode-on .ewa-fb-nb .cui-dd-arrow-button{background-color:#3c3c3c;border-top:1px solid #3c3c3c;border-right:1px solid #3c3c3c;border-bottom:1px solid #3c3c3c;border-top-right-radius:2px;border-bottom-right-radius:2px}.ewr-presentMode-on .ewa-fb-nb .cui-disabled .cui-dd-arrow-button{background-color:#3c3c3c !important;border-top:1px solid #3c3c3c !important;border-right:1px solid #3c3c3c !important;border-bottom:1px solid #3c3c3c !important}.ewr-presentMode-on .ewa-fb-nb .cui-cb:hover .cui-dd-arrow-button{border-color:#37a660 !important}.ewr-presentMode-on .ewa-fb-nb-dropdown-button-img{fill:#e1dfdd}.ewr-presentMode-on .ewa-fb-nb .cui-disabled .cui-dd-arrow-button .ewa-fb-nb-dropdown-button-img{fill:#8a8886 !important}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb-nb .cui-dd-arrow-button{background-color:#292827;border-top:1px solid #292827;border-right:1px solid #292827;border-bottom:1px solid #292827}#presentModeNamedObjectsMenu{z-index:1056 !important;background-color:#3c3c3c !important;border:1px solid #323130 !important}#presentModeNamedObjectsMenu .cui-ctl-mediumlabel{color:#e1dfdd !important}#presentModeNamedObjectsMenu .cui-ctl-menu:hover .cui-ctl-mediumlabel,#presentModeNamedObjectsMenu .cui-ctl-menu:focus .cui-ctl-mediumlabel{color:#f3f2f1 !important}#presentModeNamedObjectsMenu .cui-ctl-menu:hover,#presentModeNamedObjectsMenu .cui-ctl-menu:focus{background-color:#484644 !important;border-color:#484644 !important}.ewr-presentMode-transition .ewa-fb-nb .cui-cb-input,.ewr-presentMode-transition .ewa-fb-nb .cui-disabled .cui-cb-input,.ewr-presentMode-transition .ewa-fb-nb .cui-dd-arrow-button,.ewr-presentMode-transition .ewa-fb-nb .cui-disabled .cui-dd-arrow-button{transition:background-color .4s linear,color .4s linear}");
(()=>{c.a.Ga(n=>{n.ga.Qa(186,new l(n));b.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateServices7",!1)||u.la(n)})})();String(f);window.___1689695406774_closurehack=f},901:function(w,C,a){a.r(C);w=a(0);var b=a(14),c=a(92),h=a(5),k=a(117),d=a(13),f=a(96),u=a(729),r=a(32),t=a(375),v=a(70),x=a(149),m=a(89);class l{}l.kKh="ewa-fb";l.pKh="ewa-fb-placeholder";l.qKh="ewa-fb-text-box";l.tKh="ewa-fb-text-box-new-theme";l.rKh="ewa-fb-text-box-monospace-experiment";l.sKh="ewa-fb-text-box-new";
l.S1e="ewa-fb-refactor";l.Q1e="ewa-fb-extended";l.K0i="not-ie";l.U9e="functionbox";l.Gli="green-fill-paths";l.yT="drop-down";l.Vwc="ok-cancel-buttons-container";l.FKf="okbox";l.QLe="cancelbox";l.R1e="ewa-fb-nb";l.oKh="ewa-fb-name-box-placeholder";l.YJe="button-disabled";l.nKh="ewa-fb-expand-button-img";l.mKh="ewa-fb-expand-button-container";l.uKh="ewa-fb-text-div-container";l.P1e="ewa-fb-drag-resize";l.lKh="ewa-fb-drag-handler";l.L2e="ewa-svg-icon";l.AX="cui-disabled";Object(w.a)(l,"CssClassNames",
null,[]);var n=a(6),z=a(275),y=a(631),B=a(629),G=a(490),E=a(166),J=a(142),I=a(83),R=a(101);class X extends R.a{constructor(Fa,Ha,Na,W,U,za){super(Fa);this.WQ=()=>{this.domElement.disabled||(this.Jbc.className=this.qec+" "+this.HHf)};this.VQ=()=>{this.domElement.disabled||(this.Jbc.className=this.qec+" "+this.nZi)};this.jRf=ua=>{if(!this.domElement.disabled){const $a=ua.keyCode;if("mousedown"===ua.type||13===$a||32===$a)this.Jbc.className=this.qec+" "+this.toj}};this.kRf=()=>{this.domElement.disabled||
(this.Jbc.className=this.qec+" "+this.HHf)};this.qec=Na;this.HHf=W;this.nZi=U;this.toj=za;this.Xe.la("mouseover",this.WQ);this.Xe.la("mouseout",this.VQ);this.Xe.la("focus",this.WQ);this.Xe.la("blur",this.VQ);this.Xe.la("mousedown",this.jRf);this.Xe.la("keydown",this.jRf);this.Xe.la("mouseup",this.kRf);this.Xe.la("keyup",this.kRf);this.Jbc=Ha}}Object(w.a)(X,"PseudoClassBehavior",R.a,[]);var H=a(12);class M extends I.a{constructor(Fa){super();this.kyd=[];this.$=Fa}dispose(){f.a.Fe(this.kyd);this.kyd.length=
0;this.$=null;super.dispose()}N9b(Fa,Ha,Na,W,U){const za=H.DOMElementExtensions.getElementById(this.$.domElement,this.$.Pd+Fa);Fa=Fa===Ha?za:H.DOMElementExtensions.getElementById(this.$.domElement,this.$.Pd+Ha);if(!za)return null;Na=new X(za,Fa,Na,W,"",U);this.kyd.push(Na);return Na}}M.nbh="ewa-menu-btn-hover";M.pbh="ewa-menu-btn-pressed";Object(w.a)(M,"InitializePseudoClasses",I.a,[]);var O=a(30),L=a(260),S=a(202),T=a(159),V=a(38),la=a(19);class Z{constructor(Fa,Ha){this.$=Fa;this.Ie=Ha;z.a(this.$).vk(this)}get Ce(){return this.Ie.textBox.Pg}get zi(){return la.h(this.$).ld&&
la.h(this.$).ks}get jg(){return L.a.n9e}Pi(Fa,Ha){Ha||H.DOMElementExtensions.setFocus(this.Ce);return!Ha}Nj(Fa){return H.DOMElementExtensions.mi(this.Ce,Fa)}Ll(){}lm(){}dispose(){z.a(this.$).gB(this)}}Object(w.a)(Z,"FormulaBarFocusManager",null,[56,5]);var da=a(234),ba=a(250),na=a(18),Y=a(56),Ga=a(93),ma=a(747),fa=a(169),Xa=a(1);class Ua extends I.a{constructor(Fa,Ha,Na,W=null){super();this.wVa=this.uab=null;this.MOf=()=>{const U=new Ga.a(753860909,2,this.$.se,2,null);this.$.Ha.Ad(U);return!0};this.NOf=
U=>U.Ba.keyCode===c.a.xk?(U=new Ga.a(753860909,1,this.$.se,2,null),this.$.Ha.Ad(U),!0):!1;this.OOf=()=>{if(this.gridView.ld){const U=this.gridView.Nk;Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:7561900_InsertFunctionPositionBugFix")?U.textBox.k$b():U.textBox.eI=!0}return!1};this.$=Na;this.gridView=la.h(Na);this.svgIconProvider=W;this.oZh=Ha.ia(1035);this.nZh=l.U9e+" "+l.yT;this.cV=Fa.N9b(n.a.bjc,n.a.bjc,this.nZh,l.Gli,"");Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8026743_insertFunctionButtonTooltipEnabled")&&
(this.cV.domElement.role="button",this.cV.domElement.title=Ha.ia(1035));this.uab=W?W.Bfa(ma.a.mZh,13,13,this.cV.domElement,void 0,void 0,void 0,Ha.ia(1035)):fa.createClusteredImageFromClusterWithImageClass(13,13,na.a.SNh,Y.a.Ci(0),null,null,!0,Ha.ia(1035));this.cV.domElement.appendChild(this.uab);da.a.instance.ta(d.a.click,this.cV.domElement,this.MOf);k.KeyInputManager.instance.ta(d.a.me,this.cV.domElement,this.NOf);ba.a.instance.ta(d.a.pointerDown,this.cV.domElement,this.OOf)}dispose(){this.cV&&
(da.a.instance.Aa(d.a.click,this.cV.domElement,this.MOf),k.KeyInputManager.instance.Aa(d.a.me,this.cV.domElement,this.NOf),ba.a.instance.Aa(d.a.pointerDown,this.cV.domElement,this.OOf));f.a.Ma(this.cV);this.cV=null;H.DOMElementExtensions.Oh(this.uab);this.wVa=this.uab=null;super.dispose()}Whk(Fa){!this.wVa&&this.svgIconProvider&&(this.wVa=this.svgIconProvider.Bfa(ma.a.uZh,13,13,this.cV.domElement,void 0,void 0,void 0,this.oZh))&&this.wVa.classList.add("ewa-fb-function-button-img");this.uab&&this.wVa&&
(H.DOMElementExtensions.setVisible(this.uab,!Fa),H.DOMElementExtensions.setVisible(this.wVa,Fa))}}Object(w.a)(Ua,"FormulaBarFunctionControl",I.a,[]);var ka=a(182),nb=a(172),Ea=a(47),sb=a(8),Oa=a(163),La=a(148),ia=a(11);class Sa{constructor(Fa){this.Mya=this.ena=this.HTc=this.GTc=this.FTc=null;this.asc=this.cAd=this.s9=!1;this.wte=this.xqb=this.qKe=this.c$f=0;this.Fxc=Ha=>{this.X5e();Ha.Ba.rawEvent.preventDefault();return!0};this.Bxc=Ha=>{this.cAd=!0;this.c$f=Ha.clientPoint.y;document.body.classList.add(l.P1e);
this.s9||(this.OWa=0);this.Q7a.la("mousemove",this.KNf,!0);this.Q7a.la("touchmove",this.KNf);this.Q7a.la("mouseup",this.LMd);this.Q7a.la("touchend",this.LMd);this.Q7a.la("mouseleave",this.LMd);return!0};this.LMd=()=>{this.cAd=!1;this.OWa=this.$r.clientHeight-Oa.c;document.body.classList.remove(l.P1e);this.Q7a.MH();b.ULS.sendTraceTag(575426571,0,50,`FormulaBarResizeControl.OnDragHandlerResizeEnd formula bar drag resized to: ${this.$r.clientHeight} pixel`)};this.KNf=Ha=>{this.cAd?(Ha=ia.HelperMethods.Yjc(Ha).y,
Ha=this.jff(this.OWa+Math.min(Ha,this.$.domElement.clientHeight-75)-this.c$f),this.s9=Ha>=this.lineHeight,H.DOMElementExtensions.toggleCssClass(this.$r,l.Q1e,this.s9),Ha=Oa.c+Math.round(Math.max(Ha-2,0)),this.$r.clientHeight!==Ha&&(this.$r.style.height=Ha+"px",this.$.LEa())):b.ULS.shipAssertTag(537161935,0,!1,"FormulaBarResizeControl.OnDragHandlerResize: reached OnDragHandlerResize with isDuringResize false")};this.YQ=Ha=>{this.s9&&(this.ePa=Math.round((Math.round(this.ePa/this.lineHeight)+(0<Ha.Xta?
1:-1))*this.lineHeight));Ha.Ba.preventDefault();return!1};this.K$=()=>{this.wGj();this.asc&&(ka.a.instance.Aa(d.a.kL,document.body,this.K$),ka.a.instance.Aa(d.a.OCa,document.body,this.K$),nb.a.instance.Aa(d.a.sg,document.body,this.K$),this.asc=!1);return!1};this.Eg=()=>{this.ePa=0};this.onScroll=Ha=>{this.asc||(ka.a.instance.ta(d.a.kL,document.body,this.K$),ka.a.instance.ta(d.a.OCa,document.body,this.K$),nb.a.instance.ta(d.a.sg,document.body,this.K$),this.asc=!0);Ha.preventDefault()};this.Afj=Ha=>
{this.ePa=this.qKe;Ha.preventDefault()};this.$=Fa;this.Q7a=La.a.instance.nNa(document.body.ownerDocument)}get lineHeight(){return this.xqb?this.xqb:sb.a.p9e}set lineHeight(Fa){this.xqb=Fa}get $r(){const {FormulaBar:Fa}=a(901);this.FTc||(this.FTc=Fa.Gkc(this.$));return this.FTc}get cjc(){this.GTc||(this.GTc=document.getElementById(n.a.uCb));return this.GTc}get Tea(){this.HTc||(this.HTc=document.getElementById(n.a.uCb+"_"+n.a.AKc));return this.HTc}get ePa(){return this.Tea.scrollTop}set ePa(Fa){this.qKe=
Fa;this.Tea.scrollTop!==Fa&&(this.Tea.scrollTop=Fa)}get wYh(){return 2*this.lineHeight-2}get OWa(){return this.wte}set OWa(Fa){this.wte=Fa}X5e(){this.s9=!this.s9;H.DOMElementExtensions.toggleCssClass(this.$r,l.Q1e,this.s9);this.s9&&!this.OWa&&(this.OWa=this.wYh);this.$r.style.height=Oa.c+(this.s9?this.OWa:0)+"px";this.ena.setAttribute(n.a.Pw,this.s9?"Collapse the formula bar":"Expand the formula bar");this.$.LEa();b.ULS.sendTraceTag(575426572,0,50,`FormulaBarResizeControl.OnExpandButtonClick formula bar ${this.s9?
"expanded":"collapsed"}`)}ruh(Fa){const Ha=document.createElement("div");Ha.id=this.$.Pd+n.a.s9e;Ha.className=l.uKh;this.ena=Sa.Bqh(this.$.Pd,Fa);Ha.appendChild(this.ena);this.Mya=Sa.Zph(this.$.Pd);Ha.appendChild(this.Mya);return Ha}Sxj(){ka.a.instance.ta(d.a.Er,this.ena,this.Fxc);nb.a.instance.ta(d.a.Bh,this.ena,this.Fxc);ka.a.instance.ta(d.a.Er,this.Mya,this.Bxc);nb.a.instance.ta(d.a.Bh,this.Mya,this.Bxc)}Vxj(){ka.a.instance.ta(d.a.kG,this.cjc,this.YQ);Ea.a.addHandler(this.Tea,d.a.scroll,this.onScroll);
Ea.a.addHandler(this.Tea,d.a.focus,this.Afj);la.h(this.$).ha.add_activeCellChanged(this.Eg)}Kfk(){void 0!==this.ena&&null!==this.ena&&(ka.a.instance.Aa(d.a.Er,this.ena,this.Fxc),nb.a.instance.Aa(d.a.Bh,this.ena,this.Fxc));void 0!==this.Mya&&null!==this.Mya&&(ka.a.instance.Aa(d.a.Er,this.Mya,this.Bxc),nb.a.instance.Aa(d.a.Bh,this.Mya,this.Bxc));void 0!==this.cjc&&null!==this.cjc&&ka.a.instance.Aa(d.a.kG,this.cjc,this.YQ);la.h(this.$).ha.remove_activeCellChanged(this.Eg)}wGj(){this.ePa=Math.round(this.jff(this.ePa))}jff(Fa){return Math.round(Fa/
this.lineHeight)*this.lineHeight}static Bqh(Fa,Ha){const Na=document.createElement("a");Na.id=Fa+n.a.zYh;Na.classList.add(l.mKh);H.DOMElementExtensions.Gz(Na,n.a.Ow);Na.setAttribute(n.a.Pw,"Expand the formula bar");Ha.Bfa(ma.a.Ujh,12,12,Na).classList.add(l.nKh);return Na}static Zph(Fa){const Ha=document.createElement("div");Ha.id=Fa+n.a.xYh;Ha.className=l.lKh;return Ha}}Object(w.a)(Sa,"FormulaBarResizeControl",null,[]);R=a(249);var Za=a(45),Ab=a(1009),pb=a(190),Tb=a(111),ob=a(46),va=a(1089);class Pa{}
Pa.disabled="disabled";Pa.y4j="stale";Pa.noj="presentationMode";Object(w.a)(Pa,"NameBoxStateUpdateKey",null,[]);class jb extends R.a{constructor(Fa,Ha){super(document.createElement("div"));this.oh=null;this.nck=()=>{this.$.Ha.aFb("PopulateNameBoxMenu",{menuId:"NameBox"})};this.eNd=()=>{var Na=this.gridView.ha;const W=Na.ra.lFb()?Na.ra.Lzb:Na.ra.activeRange;Na=W.isSingle?Na.ra.activeCell.toString():W.Jei();this.qO(Na)};this.om=(Na,W)=>{this.yha(Na,W);this.VTb(Na,W)};this.VTb=()=>{let Na=va.c(this.$,
this.gridView);Ab.c(Na,!0)||(this.oh&&(Na=this.$.Ud.getItemByName(this.oh))&&Na.deactivate(),this.qO(this.gridView.ha.ra.activeCell.toString()))};this.fDa=(Na,W)=>{if(Na=W.na){var U=Na.usedRange;2===Na.type&&(U=pb.a(Na));var za=this.gridView.ha.ra.Ij,ua=this.gridView.inRangePicker||this.gridView.fl,$a=!1;2===Na.type&&za&&!ua&&(za=this.gridView.ha.ra.activeRange,$a=Na.sheetName===this.$.va.na.name&&!!za&&za.top===U.top&&za.left===U.left&&za.bottom===U.bottom&&za.right===U.right);U=Za.v(U,this.$),U.NamedObjectName=
Na.name,U.SheetName=Na.sheetName,this.gridView.Bj(U,null,null,null,60,"EditableNamedObjectsDropdownList.OnActiveNamedObjectChanged",0,!0,!0,null,W.disableAutoFocusOnGrid);W=Ab.a(Na.name);this.qO(W.name,W.fullName)}};this.ky=()=>{const Na=va.b(this.gridView);null!=Na&&this.qO(Na.name)};this.EOf=(Na,W)=>{this.eNd(Na,W)};this.wj=()=>{this.B7a(!1)};this.LDa=()=>{this.B7a(!0)};this.KDa=()=>{this.B7a(!1)};this.pz=()=>{this.B7a(!this.$.isEditMode)};this.ZQ=(Na,W)=>{this.B7a(W.JS?!0:!this.$.isEditMode)};
this.onKeyDown=Na=>Na.Ba.keyCode===c.a.SGa?(this.gridView.focus(),!0):!1;this.yha=()=>{this.O$d({[Pa.y4j]:!0})};this.$=Fa;this.gridView=la.h(Fa);this.z9g(Ha)&&(this.qO(this.gridView.ha.ra.activeCell.toString()),this.B7a(ob.a(this.$).Br()||!this.$.isEditMode),this.il(),k.KeyInputManager.instance.ta(d.a.me,this.domElement,this.onKeyDown.bind(this)))}dispose(){this.$&&(this.$.yd.tWd(this.LDa.bind(this)),this.$.yd.sWd(this.KDa.bind(this)),this.$.ea.l4(this.pz.bind(this)),Tb.a(this.$).gDc(this.EOf.bind(this)),
Tb.a(this.$).gWd(this.ky.bind(this)),ob.a(this.$).ti.Mra(this.ZQ.bind(this)),this.$.Ud&&(this.$.Ud.uj(this.fDa.bind(this)),this.$.Ud.lDc(this.VTb.bind(this)),this.$.Ud.lDc(this.O3f.bind(this)),this.$.Ud.uaa(this.yha.bind(this)),this.$.Ud.Lra(this.yha.bind(this)),this.$.Ud.AWa(this.yha.bind(this)),this.$.Ud.BRb(this.yha.bind(this))),this.$.va&&this.$.va.uj(this.om.bind(this)));if(this.gridView){const Fa=this.gridView.ha;Fa.xaa(this.VTb.bind(this));Fa.m4(this.eNd.bind(this));Fa.Va.taa(this.ky.bind(this))}super.dispose()}Uhk(Fa){this.O$d({[Pa.noj]:Fa})}z9g(Fa){const Ha=
document.getElementById(this.$.Pd+n.a.q9e);void 0!==Ha&&null!==Ha&&Fa.removeChild(Ha);appChrome.renderNameBoxUI(this.domElement,this.nck.bind(this));Fa.insertBefore(this.domElement,Fa.firstChild);return!0}il(){this.$.yd.b6c(this.LDa.bind(this));this.$.yd.a6c(this.KDa.bind(this));this.$.ea.Q0(this.pz.bind(this));const Fa=this.gridView.ha;this.$.Ud.Ri(this.fDa.bind(this));this.$.va.Ri(this.om.bind(this));Fa.fla(this.VTb.bind(this));Fa.S0(this.eNd.bind(this));Fa.Va.ZW(this.ky.bind(this));Tb.a(this.$).R5c(this.ky.bind(this));
Tb.a(this.$).Q7b(this.EOf.bind(this));ob.a(this.$).ti.ela(this.ZQ.bind(this));this.$.Ud.U7b(this.VTb.bind(this));this.$.Ud.U7b(this.O3f.bind(this));this.$.Ud.R0(this.yha.bind(this));this.$.Ud.cla(this.yha.bind(this));this.$.Ud.WKa(this.yha.bind(this));this.$.Ud.H3a(this.yha.bind(this))}qO(Fa,Ha=""){this.oh=""!==Ha?Ha:this.oh;appChrome.setNamedObjectOrActiveCellRange(Ha,Fa)}B7a(Fa){this.O$d({[Pa.disabled]:Fa})}O3f(Fa,Ha){va.a(this.$,!0);this.yha(Fa,Ha)}O$d(Fa){appChrome.updateNameBoxState(Fa)}}Object(w.a)(jb,
"NameBox",R.a,[5]);var Ob=a(187);const kb=l.FKf+" "+l.yT,ra=l.QLe+" "+l.yT;class rb extends I.a{constructor(Fa,Ha,Na,W){super();this.Vwb=this.lNb=this.uMa=this.hUa=null;this.SK=this.Lrc=!1;this.K4f=()=>{this.gridView.XM.Gp(this.kk);this.gridView.XM.Mq(this.wj);this.Lrc=!0};this.kk=()=>{this.THb?this.frg(!0):this.Vwc.style.display="flex"};this.wj=()=>{this.THb?this.frg(!1):this.Vwc.style.display="none"};this.LRf=za=>this.jxc(!0,`OkCancelEditControl.OnOkClick: ${za.Gd}`,ia.HelperMethods.pt(za));this.MRf=
za=>this.jxc(!0,`OkCancelEditControl.OnOkKeyDown: ${za.Gd}`);this.XLf=za=>this.jxc(!1,`OkCancelEditControl.OnCancelClick: ${za.Gd}`,ia.HelperMethods.pt(za));this.$Lf=za=>this.jxc(!1,`OkCancelEditControl.OnCancelKeyDown: ${za.Gd}`);this.onPointerDown=()=>{this.gridView.ld&&(this.gridView.Nk.textBox.eI=!0);return!1};const {FormulaBar:U}=a(901);this.$=Na;this.gridView=la.h(Na);this.SK=O.a.SK();this.Vwc=rb.wci(Na);this.THb=O.a.ppa();W?(this.hUa=W.tQa(ma.a.rgh,16),this.uMa=W.tQa(ma.a.cyh,16),this.THb&&
(this.lNb=W.tQa(ma.a.sgh,16),this.Vwb=W.tQa(ma.a.dyh,16),this.hUa.style.display="none",this.uMa.style.display="none")):(this.hUa=fa.createClusteredImageFromClusterWithImageClass(16,16,na.a.KNh,Y.a.Ci(1),null,null,!0,Ha.ia(1041)),this.uMa=fa.createClusteredImageFromClusterWithImageClass(16,16,na.a.MNh,Y.a.Ci(1),null,null,!0,Ha.ia(1042)));this.y$=Fa.N9b(U.ILd,U.ILd,kb,"","");this.y$.domElement.appendChild(this.hUa);this.c7=Fa.N9b(U.n$c,U.n$c,ra,"","");this.c7.domElement.appendChild(this.uMa);this.THb&&
(this.y$.domElement.appendChild(this.lNb),this.c7.domElement.appendChild(this.Vwb));this.gridView.cellTextEditBox.Gp(this.kk);this.gridView.cellTextEditBox.Mq(this.wj);da.a.instance.ta(d.a.click,this.y$.domElement,this.LRf);k.KeyInputManager.instance.ta(d.a.me,this.y$.domElement,this.MRf);ba.a.instance.ta(d.a.pointerDown,this.y$.domElement,this.onPointerDown);da.a.instance.ta(d.a.click,this.c7.domElement,this.XLf);k.KeyInputManager.instance.ta(d.a.me,this.c7.domElement,this.$Lf);ba.a.instance.ta(d.a.pointerDown,
this.c7.domElement,this.onPointerDown);this.SK&&this.gridView.WYg(this.K4f)}dispose(){this.gridView&&this.gridView.cellTextEditBox&&(this.gridView.cellTextEditBox.zp(this.kk),this.gridView.cellTextEditBox.$p(this.wj));this.gridView&&this.SK&&(this.gridView.WAj(this.K4f),this.Lrc&&(this.gridView.XM.zp(this.kk),this.gridView.XM.$p(this.wj),this.Lrc=!1));this.y$&&(da.a.instance.Aa(d.a.click,this.y$.domElement,this.LRf),k.KeyInputManager.instance.Aa(d.a.me,this.y$.domElement,this.MRf),ba.a.instance.Aa(d.a.pointerDown,
this.y$.domElement,this.onPointerDown));this.c7&&(da.a.instance.Aa(d.a.click,this.c7.domElement,this.XLf),k.KeyInputManager.instance.Aa(d.a.me,this.c7.domElement,this.$Lf),ba.a.instance.Aa(d.a.pointerDown,this.c7.domElement,this.onPointerDown));f.a.Ma(this.y$);this.y$=null;f.a.Ma(this.c7);this.c7=null;H.DOMElementExtensions.Oh(this.uMa);this.uMa=null;H.DOMElementExtensions.Oh(this.hUa);this.hUa=null;this.THb&&(H.DOMElementExtensions.Oh(this.Vwb),this.Vwb=null,H.DOMElementExtensions.Oh(this.lNb),this.lNb=
null);super.dispose()}jxc(Fa,Ha,Na=null){const W=this.gridView.Nk;if(Na){const U=this.gridView.ks?"formulaBar_end_edit_ok_cancel_btn":"cell_text_end_edit_ok_cancel_btn";let za;za=[Object(Ob.a)(this.gridView.cellTextEditBox.textBox.aGa)];Ob.b(this.$).sGa(Na.rawEvent,U,za)}this.Lrc&&this.gridView.XM.HH?this.gridView.XM.endEdit(Fa,Ha,0):W.endEdit(Fa,Ha,0);this.gridView.focus();return!0}frg(Fa){const Ha=Fa?"block":"none";Fa=Fa?"none":"block";this.hUa.style.display=Ha;this.uMa.style.display=Ha;this.lNb.style.display=
Fa;this.Vwb.style.display=Fa}static wci(Fa){const {FormulaBar:Ha}=a(901);return document.getElementById(Fa.Pd+Ha.EKf)}}Object(w.a)(rb,"OkCancelEditControl",I.a,[]);var Kb=a(299),Sb=a(273),cb=a(75),cc=a(199),Ub=a(16),wb=a(265),vc=a(204),Lb=a(297),Ja=a(143),Hb=a(171),gc=a(49),ec=a(326),Ta=a(281),ib=a(165),bc;(function(Fa){Fa[Fa.loaded=0]="loaded";Fa[Fa.error=1]="error";Fa[Fa.loading=2]="loading";Fa[Fa.unloaded=3]="unloaded";Fa[Fa.missing=4]="missing";Fa[Fa.undefined=5]="undefined";Fa[Fa.unexpected=
6]="unexpected"})(bc||(bc={}));Object(w.b)("LoadStatus",bc);a.d(C,"FormulaBar",function(){return jc});class jc extends t.a{constructor(Fa,Ha=null){super(la.h(Fa));this.oqg=null;this.VJd=["nameBox","nameBoxData"];this.$je=this.Xx=this.clearContentNotifier=this.nameBox=this.$r=null;this.Sbe=!1;this.Tea=null;this.Tpc=this.sKe=this.cvf=this.UDf=this.oFb=!1;this.jMi=Xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaBarFontValidation",!1);this.Wxg=!1;this.VXh=Xa.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.FormulaBarFontStatusLogDelay",
2E3);this.kk=()=>{this.qqc&&(this.Sbe=!1);this.y1d();this.Tpc&&this.TKc(!this.buf)};this.wj=()=>{this.y1d();this.Fd||this.zNe();this.Tpc&&this.TKc(!1)};this.TKc=Na=>{jc.Gza&&this.sKe!==Na&&(H.DOMElementExtensions.toggleCssClass(jc.Gza,l.YJe,Na),this.sKe=Na)};this.XUf=()=>{this.ld||this.textBox.disabled||this.startEdit(!0,!1,null)};this.Wp=()=>{this.sFa()};this.ZQ=(Na,W)=>{this.sFa();jc.Gza&&(W.JS?jc.Gza.classList.add(l.YJe):this.m6c())};this.Bt=(Na,W)=>{Na=this.grid;this.qqc&&(this.Sbe=!0);this.ld?
(this.Gbb||(W.FHb||this.FG(null),this.raiseEvent(t.a.cxb,W)),this.Fd&&this.Gbb||(this.Fd?Na.cellTextEditBox.textBox.isCursorAttached()&&!this.textBox.isCursorAttached()&&Na.cellTextEditBox.textBox.clearCursorFormatLocation():this.Fd||this.Xlb())):Na.ld&&this.sFa()};this.Ng=(Na,W)=>{(Na=this.grid.ha.ra.activeCell)&&(W=this.grid.JE(W.af.hash))&&Na.hf(W.$f)&&this.sFa()};this.hOb=(Na,W)=>{-185374993===W.command&&this.sFa()};this.hg=()=>{this.sFa();V.TaskExtensions.za(S.a(this.$.ga),()=>{this.Gfg()},this.ka,
11)};this.Jga=()=>{this.Gfg();gc.PageLoadTrackingInfo.instance.Mha(n.a.Dna,["formulaButton","textbox","textboxData"]);gc.PageLoadTrackingInfo.instance.Aaa(n.a.Dna,["formulaButton","textbox","textboxData"]);gc.PageLoadTrackingInfo.instance.zaa(n.a.Dna,["formulaButton"])};this.onKeyDown=Na=>{if(!this.Fd){var W=this.$.shortcutKeyManager.eu(Na.Ba);this.c_f(Na.Ba,W)}if(Na.Ba.keyCode===c.a.HE){var U=this.Zza();W=H.DOMElementExtensions.vr(U);U=H.DOMElementExtensions.aQ(U);return H.DOMElementExtensions.oFa(Na.Ba,
W,U)}return!1};this.UQ=()=>{this.m6c()};this.IGb=()=>{this.$r?(this.nameBox=new jb(this.$,this.$r),this.aFj()):this.J8f()};Ha||b.ULS.sendTraceTag(509223749,0,50,"FormulaBar.ctor: SVGIconProvider must always exist.");O.a.ppa()?(this.$je=new Sa(Fa),this.initialize(this.Q0d(Fa,Ha)),this.dPa.Sxj()):(this.initialize(jc.yRj(Fa)),this.$r=jc.Gkc(Fa));if(h.AFrameworkApplication.sa.Ra.gh){const Na=document.getElementById("AdditionalBarsRegion");Na&&(Na.style.height="")}this.Kzd=Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5160311_CrossBookCrossSheetDataBookPickerOverlay");
this.nF=new Kb.a(this.$r,1);this.SEi=Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6148798_FormulaBarCrossSessionPicker");this.Ocb=this.cG&&Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8026558_ParenthesesCoupling");this.qqc=Xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaBarTabbingBehaviorChangeXLO",!1);this.cvf=Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:7367969_formulaEditingLogLoadedFontStatus");this.Foc=new M(Fa);this.Foc.N9b(n.a.drg,n.a.drg,n.a.dak+" cui-TabRowRight",M.nbh,
M.pbh);this.o9e=new Ua(this.Foc,Ub.a.instance,Fa,Ha);this.L2i=new rb(this.Foc,Ub.a.instance,Fa,Ha);this.oqg=Ta.b(()=>{this.chg()},1,this.$.ka,"FormulaBar.setTextBoxForActiveItem",!0);Fa.va.Ri(this.hg);Ha=this.grid;Ha.cellTextEditBox.Gp(this.kk);Ha.cellTextEditBox.Mq(this.wj);Ha.cellTextEditBox.VKa(this.Bt);Ha.iH(this.Wp);Ha.ya.Eu(this.Ng);Ha.ya.eda(this.Ng);Ha.Cub(this.hOb);ob.a(Fa).ti.ela(this.ZQ);Fa.ea.N0(this.UQ);Tb.a(Fa).R5c(this.Wp);Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&
Fa.ga.qd(313,Na=>{this.clearContentNotifier=Na;this.clearContentNotifier.EBe(this.Bt)});k.KeyInputManager.instance.ta(d.a.me,this.Ce,this.onKeyDown);Ha=this.textBox.style;wb.c(Ha,Fa.isChromeRtl,"0px");Ha.textAlign=this.Jrf?"right":"left";this.isVisible=!1;this.Kzd&&(this.textBox.isVisible=!1);E.a(this.$).XKa(this.Jga);this.$.ea.iBa&&(b.ULS.sendTraceTag(537161948,0,50,"FormulaBar: CommandUI already generated when registering to: OnCommandUIAttachCompleted"),this.Jga(null,null));this.sFa();this.m6c();
this.textBox.fjg=!0;this.cxi();z.a(Fa).vk(this);this.textBox.ZBe(this.XUf);this.Gbb=!1;this.Xx=new Z(this.$,this);O.a.DAd()&&this.Avi();this.textBox.eT(()=>{gc.PageLoadTrackingInfo.instance.zaa(n.a.Dna,["textbox","textboxData"]);this.toggleEditingEvents(!1)});this.Tpc=Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8106214_disableFunctionButtonV2")}set text(Fa){this.Fd&&this.ld?this.textBox.setPlainText(Fa):super.text=Fa}get ld(){return super.ld}set ld(Fa){super.ld=Fa;this.toggleEditingEvents(Fa)}get buf(){return this.ioc||
0>=this.text.length}get sWb(){return!0}get formattedText(){return this.Fd?this.textBox.getFormattedText():super.formattedText}set formattedText(Fa){this.Fd?this.textBox.setFormattedText(Fa):super.formattedText=Fa}get tbb(){return this.ld}get isVisible(){return H.DOMElementExtensions.isVisible(this.$r)}set isVisible(Fa){this.Kzd?H.DOMElementExtensions.setVisible(this.$r,Fa):(H.DOMElementExtensions.setVisible(this.$r,Fa),this.textBox.isVisible=Fa)}get Ce(){return this.$r}get zi(){return this.isVisible}get jg(){return L.a.und}get dPa(){return this.$je}Pi(Fa,
Ha){Fa=!1;Ha||(Fa=this.HXh());return Fa}dispose(){const Fa=this.$;if(Fa){Fa.va.uj(this.hg);var Ha=this.grid;Ha.cellTextEditBox.zp(this.kk);Ha.cellTextEditBox.$p(this.wj);Ha.cellTextEditBox.yWa(this.Bt);Ha.NI(this.Wp);Ha.ya.Ft(this.Ng);Ha.ya.xWa(this.Ng);ob.a(this.$).ti.Mra(this.ZQ);Fa.ea.k4(this.UQ);Tb.a(Fa).gWd(this.Wp);Ha=E.a(this.$);k.KeyInputManager.instance.Aa(d.a.me,this.Ce,this.onKeyDown);O.a.ppa()&&this.dPa.Kfk();Ha&&Ha.BWa(this.Jga);z.a(Fa).gB(this);Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&
(this.clearContentNotifier&&this.clearContentNotifier.BVd(this.Bt),Fa.ga.C1(313))}this.textBox&&this.textBox.Q6f(this.XUf);this.nameBox&&this.$.ea.xo(this.IGb);f.a.Fe([this.nF,this.o9e,this.L2i,this.Foc,this.nameBox]);f.a.Ma(this.Xx);this.$r&&(H.DOMElementExtensions.gK(this.$r),this.$r.className="");b.ULS.sendTraceTag(537161946,0,50,"FormulaBar.Dispose: setting this.formulaBarElement to null");this.$r=null;super.dispose()}endEdit(Fa,Ha,Na,W=null){this.textBox.addEventLogRecord("FormulaBar.EndEdit",
{["Commit"]:Fa,["Caller"]:Ha});this.UFa(!1);if(this.ld){var U=null;this.qqc&&W&&(U=this.$.shortcutKeyManager.eu(W));var za=this.grid.he;this.Fd||this.textBox.clear("FormulaBar.EndEdit");this.ld=!1;this.sH(!0);this.DSa()&&this.grid.$w&&this.grid.$w.fPa&&this.grid.$w.njb(n.a.nGb);if(Fa){var ua=new y.a(this.grid.ha.ra.activeCell,za.text,za.text,!1,this.grid.$.va.na);this.j1f(ua);null!==ua&&(za.text=ua.newValue)}else this.textBox.setPlainText(this.text);ua=new B.a(this.grid.ha.ra.activeCell,za.text,Fa);
this.LSd(ua);za.endEdit(Fa,`${Ha}->FormulaBar.EndEdit`,Na,W);this.Lxf(U)||za.textBox.focus();this.textBox.Jkb("FormulaBar.EndEdit")}else this.textBox.Jkb("FormulaBar.EndEdit",{["IsEditing"]:"false"})}w8(Fa,Ha,Na,W=!0,U=!0){super.w8(Fa,Ha,Na,W,U);this.Fd&&this.grid.he.w8(Fa,Ha,Na,W,U)}e_f(Fa){if(this.Fd){const Ha=this.grid.he,Na=this.textBox.selection;Na.length&&Ha.w8(Na.index,Na.length,Fa,!1,!1)}}Nj(Fa){return H.DOMElementExtensions.mi(this.$r,Fa)}Ll(){h.AFrameworkApplication.sa.ii.hq(this.jg)}lm(){}Cvg(Fa){this.nameBox.Uhk(Fa);
this.o9e.Whk(Fa)}kae(){if(this.Tea){var Fa=Object(ib.g)(this.text);this.oFb!==Fa&&(this.dhg(Fa),this.oFb=Fa)}}ULd(){this.textBox.addEventLogRecord("FormulaBar.OnAutoCompleteCommandHandled");const Fa=this.grid.he;if(this.Fd){if(!Fa.ld||!this.ld)return;Fa.formattedText=this.formattedText}else Fa.text=this.text;Fa.setCaretPosition(this.textBox.caretPosition)}BOb(Fa){this.textBox.disabled||(this.grid.cellTextEditBox.textBox.eI=!0,this.Fd&&this.ld||this.startEdit(!1,!0,Fa),this.Xla())}IUa(Fa){this.Fd?
(this.mR&&(this.eP=this.textBox.caretPosition,this.yW=this.textBox.b_.length),this.cG&&this.FG(null)):super.IUa(Fa);this.Oha();this.ftg()}Vqa(Fa){var Ha=this.$.shortcutKeyManager.eu(Fa);const Na=this.Fd&&this.Gbb;1872288872===Ha||125627505===Ha||267796030===Ha?super.Vqa(Fa):Na?cb.g(Fa):this.ld&&this.grid.he.ld&&(Ha=this.grid.he,this.Fd?Ha.formattedText=this.formattedText:Ha.text=this.text,Ha.setCaretPosition(this.textBox.caretPosition),this.qMc(),this.Ocb&&0===this.textBox.selection.length&&this.FG(null,
null),this.SEi&&this.inRangePicker&&this.I5d(),super.Vqa(Fa))}uf(Fa,Ha){this.ld&&super.uf(Fa,Ha)}gv(Fa,Ha){this.ld&&super.gv(Fa,Ha)}Avi(){const Fa=this.grid.Hd(void 0);Fa?(this.oFb=Fa.dz||Object(ib.g)(Fa.text),this.dhg(this.oFb)):b.ULS.sendTraceTag(509720320,0,50,"FormulaBar.initTextElementStyles: failed to get active cell")}dhg(Fa){H.DOMElementExtensions.toggleCssClass(this.Tea,l.rKh,Fa);this.cvf&&!this.UDf&&this.oFb&&(this.UDf=!0,this.BSi());this.Mmk(Fa)}Mmk(Fa){this.jMi&&!this.Wxg&&Fa&&(this.Wxg=
!0,this.Omk(),this.Pmk(),this.Nmk())}Omk(){const Fa=window.getComputedStyle(this.Tea).getPropertyValue("font-family").replace(/[""]/g,"").toLowerCase().split(",").map(Na=>Na.trim()),Ha=sc.map(Na=>Na.toLowerCase()).reduce((Na,W,U)=>`${Na?Na+",":Na} ${W}=${W===Fa[U]}`,"");b.ULS.sendTraceTag(508687192,0,50,`FormulaBar.validateMonospaceFontFamily: ${Ha}`)}Pmk(){void document.fonts.ready.then(()=>{var Fa=document.createElement("canvas").getContext("2d");Fa.font=`11pt ${sc.join(", ")}`;const Ha=Fa.measureText(".").width;
Fa=Fa.measureText("X").width;b.ULS.sendTraceTag(508687191,0,50,`FormulaBar.validateMonospaceFontWidth: equals=${Ha===Fa}, dot=${Ha}, x=${Fa}`)})}Nmk(){void document.fonts.ready.then(()=>{const Fa=gridRenderer.CanvasRendererGlobals.getFontsLoadStatus(sc);Fa.forEach(Ha=>{Ha.status=bc[Ha.status]});b.ULS.sendTraceTag(508687190,0,50,`FormulaBar.validateMonospaceFontFace: ${JSON.stringify(Fa)}`)})}BSi(){setTimeout(()=>{const Fa=gridRenderer.CanvasRendererGlobals.getFontsLoadStatus(sc);let Ha="FormulaBar: Formula fonts load status: ";
for(const Na of Fa)Ha+=`${Na.font}: ${bc[Na.status]}; `;b.ULS.sendTraceTag(509642332,0,50,Ha)},this.VXh)}Q0d(Fa,Ha){this.$r=jc.Gkc(Fa);this.$r.classList.add(l.R1e);this.$r.classList.add(l.S1e);const Na=this.dPa.ruh(Ha);Ha=jc.rdc(this.Fd,!0);Na.appendChild(Ha);jc.Gza=jc.ZSe(Fa.Pd);const W=jc.VSe(),U=jc.ETe(Fa.Pd),za=jc.DTe(Fa.Pd),ua=jc.sSe(Fa.Pd);za.tabIndex=-1;ua.tabIndex=-1;U.appendChild(ua);U.appendChild(za);U.appendChild(jc.Gza);W.appendChild(U);W.appendChild(Na);Fa=jc.vTe(Fa.Pd);this.$r.appendChild(Fa);
this.$r.appendChild(W);const $a=new Lb.a(Ha,this.Fd,!1);this.Tea=Ha;this.dPa.lineHeight=$a.T8h();$a.eT(()=>{ec.c($a.Pg,u.a.ariaLabel,"formula bar")});$a.eT(()=>{this.dPa.Vxj()});$a.isVisible=!1;return $a}HUa(Fa){this.CBc(Fa);super.HUa(Fa);Ja.b(this.$).nf(J.a.BYh,{["Location"]:"canvas"});r.a.Xi&&window.focus();const Ha=this.$.shortcutKeyManager.eu(Fa);this.Fd&&this.c_f(Fa,Ha);this.textBox.disabled||this.Fd&&this.ld||this.startEdit(!0,!1,Fa);let Na;Na={};Na.wasEditing=this.ld;Na.formulaBar=!0;let W=
this.Ml(Fa,Ha);!W&&cc.d(Ha,this.Vbb,!0)&&(W=this.Lxf(Ha)?!0:this.grid.ha.Ml(Fa,Ha,Na));W||Hb.a(this.$).jHd(Fa,0,7)}startEdit(Fa,Ha,Na){const W=this.grid;if(!this.ld||!W.ld){this.textBox.Jkb("FormulaBar.StartEdit");this.textBox.addEventLogRecord("FormulaBar.StartEdit",{["SetCaretPositionToEnd"]:Fa,["IsOnMouseDown"]:Ha});Ja.b(W.$).nf(J.a.AYh,{["Location"]:"canvas"});this.ld=this.Gbb=!0;W.Et&&W.Et.mGc(this);W.cellTextEditBox.sH(!1);W.cellTextEditBox.yXd();this.Bgg(!1);var U=()=>{var za=W.$.va.na;const ua=
W.Hd(null);za=new G.a(ua,za,void 0,void 0,void 0,this.Qqd(ua));this.MSd(za);this.Fd&&this.hUb(W.cellTextEditBox.textBox.KH);!this.Fd&&ua&&ua.$3d&&(this.text="");this.Fd?(window.setTimeout(()=>{if(this.ld&&W.ld){W.ld&&W.cellTextEditBox.textBox.detachCursorFormat();if(!this.FG(null)){const Va=W.cellTextEditBox.formattedText;var $a=this.textBox.caretPosition;const hb=Va.Text.length;$a=this.textBox.text.length!==hb?hb:$a;this.formattedText=Va;this.textBox.caretPosition=$a}this.Gbb=!1;this.textBox.clearHistory()}else this.ld=
!1},0),W.cellTextEditBox.EXd()):(Ha||(this.Xlb(),this.FG(null)),W.cellTextEditBox.EXd(),this.Gbb=!1)};if(W.ld)W.MD=1,U();else if(this.textBox.eI=!0,V.TaskExtensions.za(W.startEdit(!1,1,Na,!1,void 0,Ha,1),za=>{za.result?(W.ld||(this.textBox.addErrorLogRecord("FormulaBar.StartEdit","tag_cnkc7"),b.ULS.sendTraceTag(37003425,0,10,"FormulaBar.StartEdit: grid.IsEditing is false after calling grid.StartEdit. Stack=")),this.ld&&W.ld?(W.cellTextEditBox.textBox.eI=!0,za=W.Hd(null),this.textBox.O8e(Number.NaN,
this.Qqd(za)),Fa&&this.textBox.setCaretPositionToEnd(),U()):this.ld=!1):this.ld=!1},this.ka,11),this.textBox.eI=!1,Na=W.Hd(null),null===Na||void 0===Na?0:Na.gBd)this.textBox.addEventLogRecord("FormulaBar.StartEditStripOutLegacyArrayCurlyBraces"),this.text=ia.HelperMethods.fog(this.text)}}rud(Fa){super.rud(Fa);this.Tpc&&this.grid&&this.grid.ld&&2===Fa&&this.TKc(!this.buf)}Eg(Fa,Ha){super.Eg(Fa,Ha);this.y1d()}bYa(Fa){Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:7549189_logsForNullTextboxInvestigation")&&
b.ULS.sendTraceTag(509445518,0,50,`FormulaBar.set_textBox: Setting the text box for the formula bar, textBox defined: ${!!Fa}`);super.bYa(Fa)}y1d(){const Fa=this.grid;Fa.ld&&2===Fa.MD||this.sFa()}Mh(){var Fa=this.grid;this.ld&&Fa.ld&&(Fa=Fa.he,Fa.text=this.text,Fa.setCaretPosition(this.textBox.caretPosition),this.inRangePicker&&this.textBox.focus())}sFa(){this.Fd?this.oqg():this.chg()}chg(){if(this.textBox){var Fa=this.grid;this.textBox.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal",
{["IsEditing"]:this.ld,["TextBox.Initialized"]:this.textBox.initialized,["Grid.IsEditing"]:Fa.ld});if(!this.ld){var Ha=ob.a(this.$).Br();this.$r.disabled=Ha||!this.$.isEditMode;var Na=(Ha=this.$.BX===Fa)&&1===Fa.ha.Bg;this.textBox.initialized&&(this.textBox.disabled=this.$r.disabled||Ha&&!Na);Ha=new vc.a(this.textBox.style);var W=!1;if(Na)if(Fa.ld)this.textBox.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"CellTextEditBox.Text"}),Na=Fa.cellTextEditBox.text;
else{W=Fa.Hd(null);Na=new T.a(this.$.va);if(!W||!Na.pJb(W.range,Fa))return;Fa=Na.Oj;Na=W.hj;var U=W.formulaBarText;const za=W.text;this.textBox.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["sheetProtection.IsLocked"]:Fa,["activeCell.IsHidden"]:Na,["activeCell.FormulaBarText"]:!!U,["activeCell.Text"]:!!za});Na=Fa&&Na?"":U||za;W=W.$3d}else Na="",U=Fa.ha.Va.pe,U=(null===U||void 0===U?0:U.floatingObject)?U.floatingObject.Jd:null,64===Fa.ha.Bg&&U&&U.IsShapeFormulaPresent&&
((Fa=(Fa=U.ShapeText)?Fa.substring(Fa.indexOf("\nFormula:")+9,Fa.indexOf(";FormulaVal:")):null)?(this.textBox.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"ShapeFormula"}),Na="="+Fa):b.ULS.sendTraceTag(537161938,0,15,"FormulaBar.setTextBoxForActiveItemInternal: IsShapeFormulaPresent is true but formula not found in shapeText"));this.Bgg(W);this.Qpb=this.W$b();Ha.pB.direction=this.m9?m.a.rtl:m.a.BTa;Ha.pB.textAlign=this.m9?m.a.right:m.a.left;
Ha.dX();this.text=Na}}}Gfg(){var Fa=this.$.BX;if(this.Kzd){const Ha=!!this.grid.XM&&this.grid.XM.HH;this.isVisible=Fa=!!Fa&&this.$.vnd&&!this.$.ea.te.inEmbedView;Ha||(this.textBox.isVisible=Fa)}else this.isVisible=!!Fa&&this.$.vnd&&!this.$.ea.te.inEmbedView;this.$.bI(n.a.$4d);this.$.xL()}Bgg(Fa){H.DOMElementExtensions.toggleCssClass(this.textBox.domElement,l.pKh,Fa)}Zza(){return this.$r.querySelectorAll(H.DOMElementExtensions.Uu+", div[tabindex]")}vr(){return H.DOMElementExtensions.vr(this.Zza())}HXh(){const Fa=
this.vr();return Fa?(H.DOMElementExtensions.setFocus(Fa),!0):!1}c_f(Fa,Ha){Ha=-287251124===Ha||-1925065947===Ha||1764140053===Ha;Sb.a.GSa()&&Ha&&Fa.preventDefault()}m6c(){this.TKc(!this.$.isEditMode)}hUb(Fa){this.Fd&&(this.textBox.KH=Fa)}toggleEditingEvents(Fa){this.textBox.toggleEditingEvents(Fa)}cxi(){this.$r?Xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InitNameBoxEagerly",!1)?this.IGb():Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:7134788_FixingNameBoxReliabliity")?this.$.ea.nh?
this.IGb():this.$.ea.Fl(this.IGb):this.$.ea.Fl(this.IGb):this.J8f()}aFj(){gc.PageLoadTrackingInfo.instance.Mha(n.a.Dna,this.VJd);gc.PageLoadTrackingInfo.instance.Aaa(n.a.Dna,this.VJd);gc.PageLoadTrackingInfo.instance.zaa(n.a.Dna,this.VJd)}J8f(){b.ULS.sendTraceTag(537161947,0,50,"FormulaBar.ctor: this.formulaBarElement is null (probably after dispose)")}Lxf(Fa){return this.qqc&&!this.Sbe&&(125627505===Fa||706199415===Fa)}get text(){return super.text}static Gkc(Fa){return document.getElementById(Fa.Pd+
n.a.k7a)}static yRj(Fa){const Ha=Xa.EwaSettings.Fd(),Na=jc.Gkc(Fa);Na.classList.add(l.R1e);jc.Gza=jc.ZSe(Fa.Pd);const W=jc.rdc(Ha,!0),U=jc.VSe();U.appendChild(jc.Gza);U.appendChild(W);const za=jc.ETe(Fa.Pd),ua=jc.DTe(Fa.Pd),$a=jc.sSe(Fa.Pd);za.appendChild(ua);za.appendChild($a);U.appendChild(za);Fa=jc.vTe(Fa.Pd);Na.appendChild(Fa);Na.appendChild(U);const Va=new Lb.a(W,Ha,!1);Va.eT(()=>{ec.c(Va.Pg,u.a.ariaLabel,"formula bar")});Va.isVisible=!1;return Va}static VSe(){const Fa=document.createElement("div");
Fa.className=l.kKh;Fa.classList.add(l.yT);return Fa}static ETe(Fa){const Ha=document.createElement("div");Ha.id=Fa+jc.EKf;Ha.className=l.Vwc;Ha.classList.add(l.yT);return Ha}static rdc(Fa,Ha){const Na=Sb.a.GSa(),W=document.createElement(Na?"div":"textarea");W.className=l.qKh;O.a.pHi()&&W.classList.add(l.tKh);Ha&&Fa&&W.classList.add(l.sKh);Fa?W.classList.add(l.K0i):(W.setAttribute(x.a.autoCorrect,v.a.off),W.setAttribute(x.a.wrap,v.a.virtual),W.setAttribute(x.a.spellcheck,v.a.XGa),H.DOMElementExtensions.Gz(W,
n.a.v4a),W.tabIndex=0);Na?(W.id=n.a.uCb,Fa||W.setAttribute(x.a.contentEditable,v.a.ibe)):(W.cols=20,W.rows=2);return W}static ZSe(Fa){const Ha=document.createElement("div");Ha.id=Fa+n.a.bjc;Ha.className=l.U9e;H.DOMElementExtensions.Gz(Ha,n.a.Ow);Ha.setAttribute(n.a.Pw,"insert function");Ha.tabIndex=0;Ha.classList.add(l.yT);return Ha}static DTe(Fa){const Ha=document.createElement("div");Ha.id=Fa+jc.ILd;Ha.className=l.FKf;H.DOMElementExtensions.Gz(Ha,n.a.Ow);Ha.setAttribute(n.a.Pw,"commit edit");Ha.tabIndex=
0;Ha.classList.add(l.yT);return Ha}static sSe(Fa){const Ha=document.createElement("div");Ha.id=Fa+jc.n$c;Ha.className=l.QLe;H.DOMElementExtensions.Gz(Ha,n.a.Ow);Ha.setAttribute(n.a.Pw,"cancel edit");Ha.tabIndex=0;Ha.classList.add(l.yT);return Ha}static vTe(Fa){const Ha=document.createElement("div");Ha.id=Fa+n.a.q9e;Ha.className=l.oKh;return Ha}}jc.EKf="okCancelButtonContainer";jc.ILd="okboxButton";jc.n$c="cancelboxButton";jc.Gza=null;Object(w.a)(jc,"FormulaBar",t.a,[56]);const sc=["Consolas","Monaco",
"Menlo","Courier New","monospace"]}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.vrd.js.map/242661edd92aa9bcc520dca5c1629234/EwaTS.vrd.js.map