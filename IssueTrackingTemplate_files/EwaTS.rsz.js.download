'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[48],{1361:function(w,C,a){function b(U){const za=k(U),ua=[];if(0===za&&1===U.length)return ua.push({destination:U[0],source:null,Drc:!1}),ua;for(let $a=0;$a<=za;$a++){const Va=U.filter(hb=>hb.C8().topLeft.Y===$a);for(let hb=0;hb+1<Va.length;hb+=1)ua.push({destination:Va[hb],source:Va[hb+1],Drc:!1})}O.ULS.sendTraceTag(509658E3,0,50,`GridInstantaneousAction.getBlockPairsInViewport parameter = blockPairsLength, value=${ua.length}`);
return ua}function c(U,za){let ua;const $a=Y.HelperMethods.SU(()=>{ua=gridRenderer.CanvasRendererGlobals.hideRowCols(U,za,!1)});d("HideRowCols",$a);return ua}function h(U,za,ua,$a){U=gridRenderer.CanvasRendererGlobals.performModelCascade(U,za,ua,$a);U.metric&&d("ModelCascade",U.metric.wsk);return U}function k(U){let za=-1;for(let ua=0;ua<U.length;ua++){const $a=U[ua].C8().topLeft.Y;$a>za&&(za=$a)}return za}function d(U,za){O.ULS.sendTraceTag(509723719,0,50,`GridInstantaneousAction: Time taken to complete operation=${U} is time=${za}`)}
function f(){return Fa}function u(){Fa={dispose(){}}}a.r(C);w={};a.r(w);a.d(w,"GridInstantaneousAction",function(){return Ha});a.d(w,"testableGetBlockPairsInViewport",function(){return b});a.d(w,"testablePerformHideColumnOperation",function(){return c});a.d(w,"testablePerformModelCascade",function(){return h});a.d(w,"testableGetPartialInteractivityState",function(){return f});a.d(w,"testableInitPartialInteractivityState",function(){return u});C=a(521);var r=a(10),t=a(0),v=a(233),x=a(8),m=a(18),l=
a(72),n=a(69),z=a(6),y=a(35);class B{}B.uMh="ewa-resizehdr-row-hidden";B.tMh="ewa-resizehdr-col-hidden";Object(t.a)(B,"CssClassNames",null,[]);var G=a(250),E=a(13),J=a(172),I=a(650),R=a(32),X=a(234),H=a(5),M=a(237),O=a(14),L=a(77),S=a(142),T=a(45),V=a(26),la=a(56),Z=a(12),da=a(75),ba=a(1),na=a(101),Y=a(11),Ga=a(16),ma=a(265),fa=a(143),Xa=a(384),Ua=a(46),ka=a(36);class nb{constructor(U,za,ua,$a,Va,hb,qb){this.KAa=U;this.kMb=za;this.vqa=ua;this.Fvd=$a;this.Gib=Va;this.iyf=hb;this.Zpi=qb}}Object(t.a)(nb,
"HeaderEventCachedInfo",null,[]);class Ea{constructor(U){this.bid=U}pRe(U){U=Y.HelperMethods.oQd(U);return Math.max(0,Math.min(Ea.FGf,U))}cRe(U){return this.slj(U)}Xih(U){return Math.round(this.bid*U+2*this.wcf()+1)}slj(U){return Math.max(0,Math.min(Ea.jGf,(Math.max(0,Math.min(x.a.tvc,U))-2*this.wcf()-1)/this.bid))}wcf(){return Math.floor(Math.max((this.bid+3)/4,2))}dlc(U,za){return za?U?Ea.FGf:x.a.IId:U?Ea.jGf:x.a.tvc}}Ea.FGf=409;Ea.jGf=255;Object(t.a)(Ea,"ResizeHeadersConverter",null,[]);var sb=
a(187);class Oa extends na.a{constructor(U,za){super(za.domElement);this.k0=this.e$f=!1;this.nk=this.hdb=this.MFa=null;this.wXd=!0;this.Vrc=!1;this.eTb=this.xn=this.offset=0;this.hQ=this.jV=this.U4=null;this.hri="headerResizeTooltip";this.iJ=this.YGd=null;this.v8c=this.U5=this.MEa=!1;this.IWf=this.Zfb=x.a.dBa;this.WYb=!1;this.rz=ua=>{if(this.grid.uk)return!1;ua=ka.a(this.grid.$).yg(ua);if(3===ua.Gd&&!this.jyf(ua.Ba)||!this.DZf(ua,!1))return!1;O.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");
const $a=this.qIc();this.fod(ua.clientPoint,$a,!0);this.MEa||(G.a.instance.ta(E.a.Fn,this.domElement.ownerDocument.body,this.kfb),J.a.instance.ta(E.a.Ki,this.domElement.ownerDocument.body,this.kfb),this.MEa=!0);this.k0&&this.Eof(ua);return!1};this.zNb=ua=>{ua=ka.a(this.grid.$).yg(ua);this.v8c&&this.Eof(ua);if(!ua.Ba.type.includes("touch")&&ua.Ba.button!==Sys.UI.MouseButton.leftButton||!this.eJb)return!1;da.g(ua.Ba);this.V_e();ua=this.grid.uk?this.Zfb:x.a.dBa;if(this.grid.uk&&this.nk){var $a=ua!==
this.xn;!$a&&this.WYb&&(this.pg.removeRowColFromModel(this.nk.stb,this.nk.c5f),this.pg.Pia(this.grid.ha.ra.selectedRanges),this.pg.Ds("HeaderResizeBehavior::onDocumentMouseUp"))}else this.nk&&(ua=this.U5?this.Lpd():this.nk.J8()),$a=ua!==this.xn;if(this.MFa&&$a&&ua!==x.a.dBa){ua=this.grid;var Va=this.msd(ua);$a={};$a.SheetMultiRange=T.r(Va,ua.$);Oa.k1d($a,this.isRow,this.xn);this.grid.uk&&(Va=$a.SheetMultiRange.Ranges[0],O.ULS.sendTraceTag(509694147,2,50,`HeaderResizeBehavior.OnDocumentMouseUp: cellAbsoluteIndex=${this.nk?
this.nk.stb:-1}, isResizingHiddenHeader=${this.U5}, headerViewBlockHashCode=${this.pg.hashCode},
          rangeFirstRow=${Va.FirstRow}, rangeFirstColumn=${Va.FirstColumn}, rangeLastRow=${Va.LastRow}, rangeLastColumn=${Va.LastColumn},`));this.YFh($a);ua.N7j=!0}else this.Mh(null,null),this.pRb();return this.WYb=this.U5=!1};this.Mga=ua=>{if(this.grid.uk)return!1;ua=I.a.create(ua.eventName,ua.$d,ua.Ba,ua.Gd);ua=ka.a(this.grid.$).yg(ua);if(!this.DZf(ua,!0))return!1;ua=this.grid;var $a=this.msd(ua);$a=T.r($a,ua.$);ua.Kd.cm([this.isRow?13:14]);ua.Kd.GFa();this.pRb();ua.$.Me(this.isRow?146338636:1391094586,
L.a.Bd,30,{["autoFitRanges"]:$a});return!1};this.JPf=ua=>{this.k0?(this.U5&&!this.WYb&&(this.EVg(),this.pg.Ds("HeaderResizeBehavior::onHeaderResizeChanged")),this.Vrc||this.Tpf(),ua=new Sys.UI.DomEvent(ua),ua=I.a.create(E.a.Kla,this.domElement,ua,2),ua=ka.a(this.grid.$).yg(ua),this.fNd(ua.clientPoint)):O.ULS.sendTraceTag(521480320,2,50,`HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = ${this.nk?this.nk.stb:-1}, isRow = ${this.isRow}`)};this.KPf=ua=>{ua=
new Sys.UI.DomEvent(ua);ua=I.a.create(E.a.Kla,this.domElement,ua,2);this.zNb(ua)};this.m$i=ua=>{this.sDa(ua,this.nk,!1)};this.kfb=ua=>{ua=ka.a(this.grid.$).yg(ua);da.g(ua.Ba);return this.fNd(ua.clientPoint)};this.pL=ua=>{if(this.grid.uk)return!1;ua=ka.a(this.grid.$).yg(ua);let $a;if(!this.grid.isResizeAllowed(this.isRow)||-1!==this.grid.ha.selectionType)return Ua.a(this.grid.$).Br()&&($a=this.Gqd(ua))&&($a.KAa.style.cursor=""),!1;if(this.k0)return this.Tpf(),!1;$a=this.Gqd(ua);if(!$a)return!1;$a.KAa.style.cursor=
!this.grid.ld&&this.hEd($a)?this.isRow?"row-resize":"col-resize":"";da.g(ua.Ba);return!0};this.gv=()=>{this.pRb()};this.Mh=()=>{if((3===L.a.Bd||R.a.ls)&&this.grid.ha.ra.Ij){var ua=this.grid.ha.ra.lf;if(!(!ua.isRow&&!ua.Oi||!this.domElement||ua.isRow&&this.isRow&&!this.pg.kx.includes(ua.top)||ua.Oi&&!this.isRow&&!this.pg.kx.includes(ua.left))){var $a=this.grid.Ni(ua,this.pg.pl.paneType);if($a){if(this.grid.uk){const Va=this.isRow?ua.bottom:ua.right;this.nk=this.pg.Vu(V.Range.Je(ua.bottom,ua.right));
if(!this.nk){O.ULS.sendTraceTag(522826880,2,50,`HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index ${Va}, is row ${this.isRow}`);return}}this.iJ||this.Duh();ua.isRow&&this.isRow?(Z.DOMElementExtensions.setVisible(this.iJ,!0),this.iJ.style.top=$a.bottomRight.y-this.iJ.offsetHeight/2+"px"):ua.isRow||this.isRow||(Z.DOMElementExtensions.setVisible(this.iJ,!0),ma.c(this.iJ.style,this.grid.rtl,$a.bottomRight.x-this.iJ.offsetWidth/2+"px"))}}}};
this.ZQ=(ua,$a)=>{ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&O.ULS.sendTraceTag(521787422,2,50,`HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated ${$a.JS}`);$a.JS&&this.Wwb()};this.pg=za;this.isRow=za.isRow;this.rtl=za.pl.rtl;this.grid=U;this.lGf=this.isRow?x.a.IId:x.a.tvc;this.cri=Ga.a.instance.ia(436);this.lri=Ga.a.instance.ia(435);this.fri=Ga.a.instance.ia(437);fa.a(this.grid.$,ua=>{this.YGd=ua.sT(S.a.UGj,
!1)});this.Hwj();this.grid.ha.XJ(this.Mh);this.grid.ha.gla(this.gv);this.grid.Fu(this.Mh);Ua.a(this.grid.$).ti.ela(this.ZQ)}get eJb(){return this.k0}get WGj(){this.IGh();return Oa.Hib}sDa(U,za,ua){var $a=new Sys.UI.DomEvent(U);$a=I.a.create(E.a.Kla,this.domElement,$a,2);$a=ka.a(this.grid.$).yg($a);this.CZf(za,$a.clientPoint.x,$a.clientPoint.y,!1,ua,U);U=this.qIc();this.fod(this.MFa,U,!0);this.MEa||(U=this.domElement.ownerDocument.body,U.addEventListener(E.a.Kla,this.JPf),U.addEventListener(E.a.ZLa,
this.KPf),this.MEa=!0)}j$i(U,za,ua){this.CZf(za,U.clientX,U.clientY,!0,ua,U);U=this.grid;za=this.msd(U);za=T.r(za,U.$);U.Kd.cm([this.isRow?13:14]);U.Kd.GFa();this.pRb();U.$.Me(this.isRow?146338636:1391094586,L.a.Bd,30,{["autoFitRanges"]:za})}dispose(){this.Uad();this.grid.ha&&(this.grid.ha.QI(this.Mh),this.grid.ha.Kha(this.gv));this.grid.Ax(this.Mh);Ua.a(this.grid.$)&&Ua.a(this.grid.$).ti.Mra(this.ZQ);X.a.instance.Aa(E.a.ym,this.domElement,this.Mga);G.a.instance.Aa(E.a.Gi,this.domElement.ownerDocument.body,
this.zNb);J.a.instance.Aa(E.a.sg,this.domElement.ownerDocument.body,this.zNb);R.a.ls||(G.a.instance.Aa(E.a.pointerDown,this.domElement,this.rz),G.a.instance.Aa(E.a.Fn,this.domElement,this.pL));this.MEa&&(G.a.instance.Aa(E.a.Fn,this.domElement.ownerDocument.body,this.kfb),J.a.instance.Aa(E.a.Ki,this.domElement.ownerDocument.body,this.kfb),this.MEa=!1);this.iJ&&(G.a.instance.Aa(E.a.pointerDown,this.iJ,this.rz),X.a.instance.Aa(E.a.ym,this.iJ,this.Mga),this.Uad(),this.iJ=null);this.e$f&&(Z.DOMElementExtensions.Oh(Oa.Hib),
Oa.Hib=null);this.pg=null;super.dispose()}Hwj(){X.a.instance.ta(E.a.ym,this.domElement,this.Mga);G.a.instance.ta(E.a.Gi,this.domElement.ownerDocument.body,this.zNb);J.a.instance.ta(E.a.sg,this.domElement.ownerDocument.body,this.zNb);R.a.ls||(G.a.instance.ta(E.a.pointerDown,this.domElement,this.rz),G.a.instance.ta(E.a.Fn,this.domElement,this.pL))}IGh(){if(!Oa.Hib){document.getElementById(Oa.d$f);this.e$f=!0;var U=Oa.Hib=document.createElement("div");this.grid.$.frame.Yea().appendChild(U);U.id=Oa.d$f;
U.className=y.a.vMh;Z.DOMElementExtensions.setVisible(U,!1)}}V_e(){if(this.MEa){const U=this.domElement.ownerDocument.body;this.grid.uk?(U.removeEventListener(E.a.Kla,this.JPf),U.removeEventListener(E.a.ZLa,this.KPf)):(G.a.instance.Aa(E.a.Fn,U,this.kfb),J.a.instance.Aa(E.a.Ki,U,this.kfb));this.MEa=!1}this.k0=!1;ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")?this.a6f():(this.O$f(),this.uVd());Xa.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")}O$f(){this.grid.Kd.cm([this.isRow?
13:14]);this.grid.Kd.GFa()}EVg(){this.pg.addRowColToModel(this.nk.stb-1,this.nk.c5f);this.WYb=!0}fNd(U){if(!this.k0)return!1;const za=this.isRow;if(!this.grid.uk&&!this.U4){this.U4=document.createElement("div");this.U4.style.cssText="position: relative; width: inherit; height: inherit;"+(za?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var ua=this.nk.YH();ua.nextSibling;)this.U4.appendChild(ua.nextSibling);ua.parentNode.appendChild(this.U4)}ua=za?U.y-this.hdb.y:(this.rtl?-1:1)*(U.x-this.hdb.x);
const $a=za?U.y-this.MFa.y:(this.rtl?-1:1)*(U.x-this.MFa.x),Va=this.grid.uk?this.Zfb:this.nk.J8();if(Va===x.a.dBa)return!1;ua&&(0<this.xn||0<Va+$a)&&Va+$a<=this.lGf&&(this.xn=this.qIc($a),this.fod(U,this.xn,!1),this.grid.uk?this.xn>=Oa.Jmf?(this.wXd=!0,this.nk.setCellExtent(this.xn)):this.wXd&&(this.wXd=!1,this.nk.setCellExtent(Oa.Jmf)):(Z.DOMElementExtensions.Kta(this.nk.YH(),!za,Math.max(this.eTb+$a,0)),this.U4.style[za?"top":this.rtl?"right":"left"]=Math.max($a,-this.eTb)+"px"),ua=(this.grid.uk?
this.IWf:za?this.nk.pg.kF:this.nk.pg.mF)+Math.max($a,this.grid.uk?-this.Zfb+Oa.tmc:-this.eTb),Z.DOMElementExtensions.Kta(this.nk.pg.domElement,!za,ua),this.grid.uk&&this.nk.pg.cPj(ua),this.hdb=new Sys.UI.Point(U.x,U.y),Z.DOMElementExtensions.setVisible(this.iJ,!1));return!0}J8(){return this.nk?this.U5?Oa.sri:this.nk.J8():x.a.dBa}fod(U,za,ua){this.hQ&&ua&&(O.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),
this.uVd());this.hQ||ua||O.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.YGd&&this.YGd(()=>({["Location"]:"canvas"}));this.hQ?this.C$e(za):(this.hQ=document.createElement("div"),this.hQ.id=this.hri,this.C$e(za),this.hQ.className=y.a.VKh,za=document.getElementById(this.grid.$.Pd+z.a.$Hf),za.insertBefore(this.hQ,za.firstChild),U=ka.a(this.grid.$).eoa(U),this.hQ.style.left=(this.rtl?Math.max(U.x-
this.hQ.offsetWidth,0):U.x-Math.max(U.x+this.hQ.offsetWidth-za.offsetWidth,0)).toString()+"px",za=document.getElementById(z.a.exa),this.hQ.style.top=(U.y-(H.AFrameworkApplication.sa&&H.AFrameworkApplication.sa.Ra.gh?0:za.offsetHeight)-this.hQ.offsetHeight).toString()+"px")}uVd(){Z.DOMElementExtensions.Oh(this.hQ);this.hQ=null}C$e(U){var za=new Ea(this.grid.$.workbookContext.DxDigitNormal);za=this.isRow?za.pRe(U).toFixed(2):za.cRe(U).toFixed(2);this.hQ.innerText=`${this.isRow?this.cri:this.lri} ${za} (${U.toString()} ${this.fri})`}DZf(U,
za){let ua;const $a=this.grid.isResizeAllowed(this.isRow);if(-1!==this.grid.ha.selectionType||2===U.Gd&&U.Ba.button!==Sys.UI.MouseButton.leftButton||!this.hEd(ua=this.Gqd(U))||!$a)return!1;da.g(U.Ba);this.MFa=this.hdb=new Sys.UI.Point(U.clientPoint.x,U.clientPoint.y);this.Xbh(ua,za);if(!this.nk)return!1;this.k0=!0;this.cJi(this.nk,ua)&&this.nvi();this.eTb=this.Lpd();return this.EZf(U.Ba.rawEvent,za)}CZf(U,za,ua,$a,Va,hb){this.k0=!0;this.U5=Va;this.nk=U;this.Vrc=!1;this.MFa=this.hdb=new Sys.UI.Point(za,
ua);U=this.nk.getRange();this.jV=Va?this.CDe(U):U;this.Zfb=this.J8();this.IWf=this.isRow?this.nk.pg.kF:this.nk.pg.mF;this.EZf(hb,$a)}EZf(U,za){const ua=this.grid.uk?{["IsResizingHiddenHeader"]:this.U5,["IsAutoFitting"]:za,["NumberOfSelectedRanges"]:this.grid.ha.ra.lG,["Location"]:"canvas",["ResizeRange"]:this.jV,["ResizedCellAbsoluteIndex"]:this.nk.stb,["HeaderViewBlockHashCode"]:this.pg.hashCode}:{["IsResizingHiddenHeader"]:this.U5,["IsAutoFitting"]:za,["NumberOfSelectedRanges"]:this.grid.ha.ra.lG,
["Location"]:"canvas"};fa.b(this.grid.$).nf(S.a.LGj,ua);this.grid.yZj&&(za=za?"header_resize_autofit":"header_resize_start",sb.b(this.grid.$).sGa(U,za,void 0));this.offset=this.nk.efa();this.xn=this.grid.uk?this.Zfb:this.nk.J8();if(this.xn===x.a.dBa)return!1;Xa.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0}cJi(U,za){var ua=this.nk.YH();if(!ua)return O.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),!1;ua=ua.nextSibling;if(!ua)return!1;
U=U.getRange();ua=this.pg.Rza(ua).getRange();if(!U||!ua)return O.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;U=this.isRow?U.bottom:U.right;ua=this.isRow?ua.bottom:ua.right;return U+1!==ua&&U!==ua&&this.hEd(za,!0)}nvi(){var U=this.nk.YH();const za=this.pg.Rza(U.nextSibling);Oa.dJi(za,this.isRow)?(this.nk=za,this.jV=this.nk.getRange()):(this.FVg(U),this.nk=za,U=this.nk.getRange(),this.jV=this.CDe(U),this.U5=!0)}CDe(U){return this.isRow?new V.Range(U.top-1,U.left,U.top-1,U.right,
!1,!0):new V.Range(U.top,U.left-1,U.bottom,U.left-1,!1,!0)}FVg(U){const za=this.pg.Rza(U.nextSibling),ua=Oa.Sqh(za,this.isRow,this.rtl);ua&&U.parentNode.insertBefore(ua,za.YH())}msd(U){const za=this.jV,ua=U.ha.ra.selectedRanges;if(U.ha.ra.hAb(za))if(this.isRow){if(M.a.all(ua,$a=>$a.isRow))return ua}else if(M.a.all(ua,$a=>$a.Oi))return ua;return[za]}getCellExtent(){return this.nk.getCellExtent()}Lpd(){const U=this.nk.YH().style;return Math.max(0,Math.min(this.lGf,0|parseInt(this.isRow?U.height:U.width,
10)))}qIc(U=0){const za=this.grid;var ua=this.pg.pl.paneType;let $a;$a=this.isRow?3===ua?[3,2]:[1,4]:4===ua?[2,4]:[1,3];var Va=Math.max(this.grid.uk?this.Zfb:this.nk.J8(),0);U=this.U5&&!this.grid.uk?Math.max(this.Lpd(),0):Math.max(Va+U,0);ua=za.Pai(ua,this.isRow);ua=this.isRow?new n.a(0,this.offset,ua,U):new n.a(this.offset,0,U,ua);Va=[this.isRow?13:14];za.Kd.kn(new V.Range(1,1,x.a.yh,x.a.xh,!1,!0),Va,!1);za.Kd.Jt(Va,ua,$a);return U}Uad(){this.jV=this.MFa=this.hdb=null;if(this.U4){const U=this.U4.parentNode;
if(U)for(U.removeChild(this.U4);this.U4.firstChild;)U.appendChild(this.U4.firstChild);this.U4=null}this.nk=null;this.k0=!1;ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")||this.a6f()}a6f(){this.Vrc=!1;this.uVd();Z.DOMElementExtensions.setVisible(Oa.Hib,!1);Z.DOMElementExtensions.setVisible(this.iJ,!1);ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")&&this.O$f()}Gqd(U){if(Z.DOMElementExtensions.bG(U.$d,"a"))return null;const za=this.jyf(U.Ba);
if(za&&this.grid.ha.ra.Ij){var ua=this.grid.ha.ra.lf;ua=this.pg.Vu(V.Range.Je(ua.bottom,ua.right))}else ua=this.pg.Rza(U.$d);if(!ua)return null;const $a=ua.YH(),Va=new Sys.UI.Bounds($a.offsetLeft,$a.offsetTop,$a.offsetWidth,$a.offsetHeight);var hb=Z.DOMElementExtensions.getBoundingClientRect(U.$d);hb=new Sys.UI.Point(U.clientPoint.x-hb.x,U.clientPoint.y-hb.y);this.isRow&&!za&&(hb.y+=Y.HelperMethods.SF(U.$d,$a,this.rtl).y);return new nb($a,hb,Va,ua.getRange(),Math.max(Oa.BYi,Math.min(Oa.CXi,(this.isRow?
Va.height:Va.width)*Oa.VGj)),za,!this.isRow&&0<$a.getElementsByTagName("input").length)}hEd(U,za=!1){if(!U||this.grid.ld)return!1;if(U.iyf)return!0;var ua=U.vqa;const $a=U.Gib;var Va=this.pg.pl.paneType,hb=this.grid.Xh(Va).Ol,qb=!!hb&&hb.top===U.Fvd.top,Nb=!!hb&&hb.left===U.Fvd.left;Va=!!hb&&hb.bottom===U.Fvd.bottom&&(3===Va||2===Va);this.isRow?(Nb=U.kMb.y,U=Nb<=$a&&!qb,ua=Nb>=ua.height-$a-(Va?Oa.$Yh:0),za=za?U:ua||U):(Va=U.Zpi,qb=this.rtl,hb=U.kMb.x,U=hb<=$a&&(!Nb||qb)&&(!Va||!qb),ua=hb>=ua.width-
$a&&(!qb||!Nb)&&(!Va||qb),za=za?qb?ua:U:U||ua);return za}Xbh(U,za){const ua=this.isRow;if(U.iyf)this.nk=this.pg.Rza(U.KAa);else if(ua&&U.kMb.y<=U.Gib&&U.vqa.height>U.Gib||!ua&&U.vqa.width>U.Gib&&(!this.rtl&&U.kMb.x<=U.Gib||this.rtl&&U.kMb.x>=U.vqa.width-U.Gib)){if(this.nk=U.KAa.previousSibling?this.pg.Rza(U.KAa.previousSibling):this.dai(),za&&U.KAa.classList.contains(ua?y.a.g5e:y.a.f5e)&&(U=this.pg.Rza(U.KAa)))U=U.getRange(),this.jV=ua?new V.Range(U.top-1,U.left,U.top-1,U.right,!1,!0):new V.Range(U.top,
U.left-1,U.bottom,U.left-1,!1,!0)}else this.nk=this.pg.Rza(U.KAa);!this.jV&&this.nk&&(this.jV=this.nk.getRange())}dai(){var U=this.isRow?1:0;return(U=this.pg.pl.JE(this.pg.pl.ya.Wi(this.grid.$.na,l.a.SM(this.pg.position.X+U-1,this.pg.position.Y-U,this.pg.position.PaneType))))?U.cai():null}Tpf(){this.Vrc=!0;const U=this.WGj;Z.DOMElementExtensions.setVisible(U,!0);U.style.cursor=this.isRow?y.a.y2e:y.a.u1e;this.qIc()}YFh(U){this.grid.$.Me(this.isRow?745189930:-445963340,L.a.Bd,30,{["resizeRowColumnParameters"]:U})}Duh(){const U=
document.createElement("div");U.className=y.a.tNh;const za=document.createElement("div");za.className=m.a.hK;U.appendChild(za);const ua=document.createElement("img");ua.src=la.a.Ci(0);ua.className=this.isRow?m.a.sMh:m.a.nMh;za.appendChild(ua);this.pg.dA.domElement.parentNode.insertBefore(U,this.pg.dA.domElement);this.grid.uk?U.addEventListener(E.a.Cda,this.m$i):(G.a.instance.ta(E.a.pointerDown,U,this.rz),X.a.instance.ta(E.a.ym,U,this.Mga));Z.DOMElementExtensions.setVisible(U,!1);this.iJ=U}pRb(){this.Uad();
this.iJ&&(this.pg.dA.domElement.parentNode.removeChild(this.iJ),this.iJ=null)}jyf(U){return Z.DOMElementExtensions.mi(this.iJ,U.target)}Wwb(){this.k0&&(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6810003_HandleCancelResize")&&this.grid.uk&&this.fNd(this.MFa),this.V_e(),this.grid.uk||Z.DOMElementExtensions.Kta(this.nk.YH(),!this.isRow,this.eTb),this.pRb(),this.WYb=this.U5=!1)}Eof(U){(U=U.Ba.rawEvent)&&U.detail===Oa.NLj&&(U.type===E.a.Er?(this.k0=!1,this.v8c=!0):U.type===E.a.kL&&(this.k0=!0,this.v8c=
!1))}static Qqh(U,za){return new Oa(U,za)}static k1d(U,za,ua){if(za){U.ColumnWidth=-1;U.RowHeight=ua;for(const $a of U.SheetMultiRange.Ranges)$a.FirstColumn=0,$a.LastColumn=0}else{U.RowHeight=-1;U.ColumnWidth=ua;for(const $a of U.SheetMultiRange.Ranges)$a.FirstRow=0,$a.LastRow=0}}static dJi(U,za){if(!U||!U.YH())return O.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;const ua=U.getRange();U=U.YH().style;if(!ua||!U)return O.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),
!1;U=za?U.height:U.width;return(za?ua.top:ua.left)===(za?x.a.yh:x.a.xh)&&U===Oa.Qzg}static Sqh(U,za,ua){if(!U)return O.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),null;var $a=U.YH();if(!$a||!$a.style)return O.ULS.shipAssertTag(537154011,2,!1,"header after hidden element or style is null"),null;U=document.createElement("div");const Va=$a.style;U.style.top=za?Va.top:Oa.Qzg;za||(ua?U.style.right=Va.right:U.style.left=Va.left);U.classList.add(za?B.uMh:B.tMh);U.classList.add(za?y.a.sBb:
y.a.rBb);ua=document.createElement("div");ua.classList.add(za?y.a.U4e:y.a.Okd);$a=za?Number.parseInvariant($a.innerText):V.Range.k6a($a.innerText);ua.innerText=za?($a-1).toString():V.Range.JP($a-1);U.appendChild(ua);return U}}Oa.BYi=0;Oa.CXi=5;Oa.tmc=1;Oa.Jmf=1;Oa.sri=0;Oa.$Yh=3;Oa.VGj=.1;Oa.d$f="ewa-rszrbg";Oa.Qzg="0px";Oa.NLj=2;Oa.Hib=null;Object(t.a)(Oa,"HeaderResizeBehavior",na.a,[344]);class La extends v.a{constructor(){super();this.je()}create(){this.Ld(Oa.Qqh)}static la(U){U.ga.Qa(136,new La)}}
Object(t.a)(La,"HeaderResizeBehaviorFactory",v.a,[]);var ia=a(62),Sa=a(734),Za=a(53),Ab=a(38),pb=a(175),Tb=a(432),ob=a(383),va=a(200),Pa=a(159),jb=a(248),Ob=a(247),kb=a(67),ra=a(19);class rb{constructor(U,za){this.isRow=!1;this.autoFitRange=null;this.isRow=U;this.autoFitRange=za}}Object(t.a)(rb,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[135]);class Kb{constructor(U){this.resizeParameters=null;this.resizeParameters=U}}Object(t.a)(Kb,"MacroRecorderSheetRowsColumnsResizedPayload",null,[135]);
var Sb=a(138);na=a(295);var cb=a(22),cc=a(58);class Ub extends na.a{constructor(U,za){super(U);this.TPa=ua=>{ua=this.Tqd(ua);return this.Xnd(ua)};this.MGj=(ua,$a)=>{var Va=this.Fcb=$a[Ub.pDi];1===ua?(ua=$a[Ub.o2j],Va=this.Zif(ua,Va),O.ULS.shipAssertTag(537153996,0,Va!==Ub.Ffa,`ResizeHeadersDialogHandler - invalid size input, size = ${ua}`),ua=Va!==this.Gxd,O.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",
this.isRow,this.Fcb,Va,ua),ua&&this.soh(Va)):O.ULS.sendTraceTag(537153994,0,50,`ResizeHeadersDialog Cancel button pressed, isRow = ${this.isRow}.`)};this.isRow=2040891415===za.command;this.gridView=ra.h(this.$);this.jEc=new Ea(this.$.workbookContext.DxDigitNormal);this.Gxd=this.Dch();U=this.$mh(this.Gxd);za=this.bnh(this.Gxd);this.xm=Ga.a.instance.ia(this.isRow?478:479);U=this.CK(U,za);this.initializeAndShow(this.xm,this.MGj,U);O.ULS.sendTraceTag(537153997,0,50,`ResizeHeaders React Dialog opened, isRow = ${this.isRow}.`)}get we(){return"ResizeHeadersDialog"}get Fcb(){return Ub.lne}set Fcb(U){Ub.lne=
U}CK(U,za){return{[Ub.jQ]:this.we,[Ub.sJi]:this.isRow,[Ub.Ovi]:U,[Ub.Nvi]:za,[Ub.VFi]:this.Fcb,[Ub.Sqd]:this.TPa}}Dch(){const U=this.k1h();try{return this.I5h(U)}finally{U&&U.dispose()}}soh(U){const za={};za.SheetMultiRange=T.r(this.gridView.ha.ra.selectedRanges,this.$);Ub.k1d(za,this.isRow,U);this.$.Me(this.isRow?745189930:-445963340,L.a.Bd,8,{["resizeRowColumnParameters"]:za})}Zif(U,za){return cb.a.E9(U)?za?this.Zmh(U):this.anh(U):Ub.Ffa}anh(U){return Math.floor(parseFloat(U))}Zmh(U){U=parseFloat(U);
return 0>U?Ub.Ffa:U?this.isRow?Y.HelperMethods.Clj(U):this.jEc.Xih(U):0}bnh(U){return U===Ub.Ffa?"":this.isRow?this.jEc.pRe(U).toString():this.jEc.cRe(U).toFixed(2)}$mh(U){return U===Ub.Ffa?"":U.toString()}I5h(U){if(!U||!U.$$mn()||!U.jo)return Ub.Ffa;var za=Object(Sb.a)(376,U.jo);if(!za)return Ub.Ffa;for(za=this.isRow?za.CGb:za.Exd;U.$$mn();){const ua=Object(Sb.a)(376,U.jo);if(ua&&(this.isRow?ua.CGb:ua.Exd)!==za)return Ub.Ffa}return za}k1h(){const U=[];for(const ua of this.gridView.ha.ra.selectedRanges){const $a=
ua.clone();var za=this.gridView.Xh(this.gridView.jd.$j($a));za=$a.wg(za.Ol);if(!za)return null;this.isRow?$a.right=$a.left=za.left:$a.top=$a.bottom=za.top;U.push($a)}return U.length?this.gridView.A7("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",U):null}Tqd(U){if(!cb.a.E9(U))return 1;U=this.Zif(U,this.Fcb);if(0===U){const za=this.gridView.ha.ra.selectedRanges,ua=this.gridView.al("ResizeHeaderDialog");if(Object(cc.c)(ua)){if(!ua.value.YKe(za,this.isRow))return 3}else if(this.bJi())return 3}return this.lMi(U)?
0:2}bJi(){const U=this.gridView.ha.ra.selectedRanges;return this.isRow&&T.Q(U)||!this.isRow&&T.P(U)}Xnd(U){let za="";switch(U){case 0:za="";break;case 1:za=Ga.a.instance.ia(767);break;case 2:za=String.format(Ga.a.instance.xd(99),0,this.dlc(this.Fcb));break;case 3:za=Ga.a.instance.ia(768)}return za}lMi(U){return 0<=U&&U<=this.dlc(!1)}dlc(U){return this.jEc.dlc(U,this.isRow)}static k1d(U,za,ua){if(za){U.ColumnWidth=Ub.Ffa;U.RowHeight=ua;for(const $a of U.SheetMultiRange.Ranges)$a.FirstColumn=0,$a.LastColumn=
0}else{U.RowHeight=Ub.Ffa;U.ColumnWidth=ua;for(const $a of U.SheetMultiRange.Ranges)$a.FirstRow=0,$a.LastRow=0}}}Ub.jQ="id";Ub.sJi="isRow";Ub.Ovi="initialSizeInPx";Ub.Nvi="initialSizeInDefaultUnits";Ub.VFi="isInitialUnitsDefaultUnits";Ub.Sqd="getInputErrorIfInvalid";Ub.o2j="size";Ub.pDi="isDefaultUnits";Ub.Ffa=-1;Ub.lne=!0;Object(t.a)(Ub,"ResizeHeadersDialog",na.a,[]);var wb=a(59);const vc=(U,za,ua,$a,Va,hb,qb=null)=>{qb=U.Pa(41,qb);qb.resizeRowColumnParameters=za;return wb.g(U,"ResizeRowsColumns",
qb,ua,$a,Va,hb,0)};var Lb=a(298),Ja=a(153),Hb=a(34),gc=a(358);class ec{constructor(U,za,ua,$a){this.odj=(Va,hb)=>{if(!jb.a(Va)&&hb){const qb=!!Va&&!!Va.RequestTelemetryData;ra.h(this.$).fj.dqa(hb,Va.StateId,qb?Va.RequestTelemetryData.EcsOperationDuration:0,qb?Va.RequestTelemetryData.EcsRequestDuration:0,qb?Va.RequestTelemetryData.WfeRequestDuration:0)}};this.l5i=(Va,hb)=>{Ab.TaskExtensions.za(Za.GetServiceTaskFactory.ud(this.$.ga,534,535,1),qb=>{qb.result.zck(hb)},this.$.ka,3)};this.$=U;this.eh=za;
this.gridInstantaneousAction=ua;this.grid=ra.h(this.$);this.REb=$a}Pe(U,za){U=!0;switch(za){case -445963340:case 1391094586:U=this.Rf(8);break;case 745189930:case 146338636:U=this.Rf(16)}return!U}executeCommand(U,za,ua){var $a=ra.h(this.$);const Va=za.command;var hb=pb.a.create().toString();let qb=Ab.TaskExtensions.Ul();switch(Va){case 1391094586:case 146338636:U=1391094586===Va;(hb=ua.autoFitRanges)&&hb.Ranges&&hb.Ranges.length||(hb=T.r($a.ha.ra.selectedRanges,this.$));qb=this.GBh(U?1:0,hb,za);break;
case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:U=-445963340===Va||-706918724===Va||369708605===Va;ba.EwaSettings.WRa()&&-706918724===Va&&$a.fj.P4(18,hb,Tb.a(Va));if(-445963340===Va||745189930===Va){var Nb=Tb.a(za.command);$a.fj.P4(16,hb,Nb);$a=ua.resizeRowColumnParameters}else{ua=$a.ha.ra.selectedRanges;let Ka=0,Pb=!1,rc="",$c=!1;const Dd=ba.EwaSettings.hIb();Dd&&(rc=Tb.a(za.command),Pb=1<ua.length?!0:!1);for(var yb of ua){if(Dd&&this.REb){var ja=this.grid.ya.h2(yb);
this.REb.s4c(ja,rc)}if(-706918724===Va||369708605===Va)ja=yb.right-yb.left+1,Ka+=0<ja?ja:-1*ja;else if(1542466017===Va||1051390410===Va)$c=!0,Ka+=yb.bottom-yb.top+1}Dd&&this.REb&&(this.REb.RAe(Ka,rc),this.REb.Wze(rc,$c,Ka,ua[0]));369708605===Va||1542466017===Va?O.ULS.sendTraceTag(520938758,0,50,`ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges=${Ka}, isDiscontinuous=${Pb}`):(-706918724===Va||1051390410===Va)&&O.ULS.sendTraceTag(520938757,0,50,`ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges=${Ka}, isDiscontinuous=${Pb}`);
if(!Object(cc.c)($a.al("ResizeCmdHandler"))){if(-706918724===Va&&6===za.Tg&&T.P(ua)){O.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===Va&&6===za.Tg&&T.Q(ua)){O.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");break}}yb=369708605===Va||1542466017===Va?-2:0;$a={};$a.SheetMultiRange=T.r(ua,this.$);
if(U)for(Nb of $a.SheetMultiRange.Ranges)Nb.FirstRow=0,Nb.LastRow=0;else for(const Jd of $a.SheetMultiRange.Ranges)Jd.FirstColumn=0,Jd.LastColumn=0;$a.RowHeight=U?-1:yb;$a.ColumnWidth=U?yb:-1}qb=this.bCh($a,za,hb,U);break;case 957527587:case 2040891415:new Ub(this.$,za)}return qb}Be(U,za,ua,$a){if(U=!!ua&&!!$a&&1===$a.iA)switch(za.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;
default:U=!1}return U}Ue(){return!1}MSi(U){O.ULS.sendTraceTag(537154004,0,50,`ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: ${Object(Lb.c)(U)}. Reason: ${Object(Lb.c)(U)?void 0:U.reason}.`)}Rf(U){return(new Pa.a(this.$.va)).Rf(U)}GBh(U,za,ua){const $a=this.$.qa.ua.ie(),Va=0===U,hb=()=>new rb(Va,za);return ob.a(this.$.userOperationManager,(qb,Nb,yb)=>{var ja=this.$.qa.ua;qb=Ob.b(qb,this.l5i);var Ka={BCi:!Va,L4a:za};const Pb=ja.Pa(41,$a);Pb.isRow=Va;Pb.autoFitRanges=za;return wb.g(ja,
"AutoFit",Pb,qb,Nb,yb,Ka,0)},qb=>new va.a(135,0,qb,void 0,hb),ua)}bCh(U,za,ua,$a){const Va=za.command,hb=ra.h(this.$),qb=T.g(U.SheetMultiRange.Ranges);if(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")){var Nb=1051390410===Va||745189930===Va&&0===U.RowHeight;const Pb=-706918724===Va||-445963340===Va&&0===U.ColumnWidth,rc=hb.al("ResizeCmdHandler");if((Nb||Pb)&&Object(cc.c)(rc)&&!rc.value.YKe(qb,!$a))return this.OAh($a),Ab.TaskExtensions.Ul()}let yb;Nb=ba.EwaSettings.WRa()&&-706918724===
Va;if(745189930===Va||-445963340===Va||Nb)O.ULS.shipAssertTag(537154002,0,this.$.activeItemName===U.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!"),Nb?(this.gridInstantaneousAction.qvj(),Object(Ja.c)(()=>{hb.fj.ovc();this.gridInstantaneousAction.s6g(Va)},this.$.ka,0)):(yb=this.eh.b4d(hb,qb,$a?U.ColumnWidth:U.RowHeight,!$a),this.MSi(yb),Object(Lb.c)(yb)&&hb.fj.JR(ua,kb.BasicTelemetryCalculator.nQ));const ja=this.$.qa.ua.ie({cqa:!0,Qoa:3});$a=(Pb,rc,
$c)=>{this.$.iB();T.i(qb,",",this.$,!1);return vc(this.$.qa.ua,U,Ob.b(Pb,this.odj),rc,$c,ua,ja)};const Ka=()=>new Kb(U);return yb&&Object(Lb.c)(yb)?ob.a(this.$.userOperationManager,$a,Pb=>new va.a(136,0,Pb,64,Ka),za):ob.a(this.$.userOperationManager,$a,Pb=>new va.a(136,0,Pb,void 0,Ka),za)}OAh(U){U=Hb.a.qf(1,0,U?769:771,U?770:772,0,U?-2037763134:503471870,U?"HideAllColumnsError":"HideAllRowsError");new gc.a(this.$,U)}}Object(t.a)(ec,"ResizeCommandHandler",null,[203]);var Ta=a(91),ib=a(137),bc=a(15);
class jc extends Sa.a{constructor(U){super(U)}Uf(){const U=Object(Ta.d)(ib.a.resolve(bc.gb,{Ja:this.Ta}));let za;za=ba.EwaSettings.WRa()?ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateGridInstantaneousAction",!1)?Object(Ta.d)(ib.a.resolve(bc.wb,{Ja:this.Ta})):Za.GetServiceTaskFactory.ud(this.$.ga,528,529,this.Ta):ia.Task.Wa(null);let ua;ua=ba.EwaSettings.hIb()?Object(Ta.d)(ib.a.resolve(bc.tb,{Ja:this.Ta})):ia.Task.Wa(null);Ab.TaskExtensions.za(Ab.TaskExtensions.Wf([U,ua],this.ka),
()=>{this.Lf([new ec(this.$,U.result,za.result,ua.result)])},this.ka,3)}static la(U){Sa.a.qg(113,new jc(U))}}Object(t.a)(jc,"ResizeCommandHandlerFactory",Sa.a,[]);na=a(731);var sc=a(96);let Fa=null,Ha=class{constructor(U){this.ek=()=>{Fa&&(sc.a.Ma(Fa),Fa=null);this.fIb&&(this.$.MAd=!1)};this.$=U;this.gridView=ra.h(this.$);this.ya=this.gridView.ya;this.WIb=!1;this.ufd=this.$.ea.xg;this.sSb={};this.i9={};this.fIb=ba.EwaSettings.getBooleanFeatureGate("isGlobalStylesSlice1Enabled",!1);this.ya.Ws(this.ek)}dispose(){this.gridView=
this.$=null;this.i9={};this.WIb=!1;this.sSb={};this.ya.Bs(this.ek)}s6g(U){if(this.WIb)O.ULS.sendTraceTag(509658009,0,15,`GridInstantaneousAction.attemptInstantaneousGridAction command=${U}, parameter = isProcessing, value=true, reason = AttemptInstantaneousGridAction is still processing, isRow=false`);else{var za=this.ya.Caf(),ua=b(za);this.i9={};this.aGi(U,za,ua)?(this.WIb=!0,this.$.MAd=!0,this.b0f(U,!1,ua,za)):this.gridView.fj.ovc(!1)}}qvj(){this.ufd=this.$.ea.xg}aGi(U,za,ua){const $a=this.gridView;
if(-706918724!==U||$a.rtl)return!1;if($a.jd.gQ)return O.ULS.sendTraceTag(508958784,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${U}, parameter = hasPanes, value=true, isRow=false`),!1;var Va=$a.al("GridInstantaneousAction");if(!Object(cc.c)(Va))return O.ULS.sendTraceTag(509658008,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${U}, parameter = ActiveSheetProcessedData, value=null, isRow=false`),!1;var hb=$a.ha.ra.selectedRanges,qb=hb[0];const Nb=
hb.length;if(1<Nb)return O.ULS.sendTraceTag(509658007,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${U}, parameter = SelectedRanges, value=${Nb}, reason = Discontinuous selection, isRow=false`),!1;if(Va.value.Zbb(qb))return O.ULS.sendTraceTag(509658006,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${U}, parameter = isPartOfRangeHidden, value=true, isRow=false`),!1;Va=qb.right-qb.left+1;if(Va>ba.EwaSettings.RWi())return O.ULS.sendTraceTag(509658005,
0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${U}, parameter = ColumnCount, value=${Va}, reason = Multiple columns selected, isRow=false`),!1;za=za.length;if(za>ba.EwaSettings.QWi())return O.ULS.sendTraceTag(509658004,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${U}, parameter = BlocksInViewport, value=${za}, reason = Blocks in viewport limit exceeded, isRow=false`),!1;a:{for(yb of ua){if(!yb||!yb.source||!yb.destination){O.ULS.sendTraceTag(509649925,
0,50,"GridInstantaneousAction.canRowColHideOrCascade: blockPair or sourceBlock or destinationBlock is null");var yb=!1;break a}za=yb.source.Sf.GridBlockModel;if(!gridRenderer.CanvasRendererGlobals.canRowColHideOrCascade(za,za.ColumnNumbers[0],!1)){yb=!1;break a}}yb=!0}if(!yb)return O.ULS.sendTraceTag(509658003,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${U}, parameter = canRowColCascade, value=false, reason = Model has complex cells, isRow=false`),!1;a:{yb=qb.left;qb=
this.ya.yPa(qb,this.$.activeItemName);for(ja of qb)if(!gridRenderer.CanvasRendererGlobals.canRowColHideOrCascade(ja.Sf.GridBlockModel,yb,!1)){var ja=!1;break a}ja=!0}if(!ja)return O.ULS.sendTraceTag(509084812,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${U}, parameter = canRowColHideOrCascade, value=false, reason = Selected row or Col has complex cells, isRow=false`),!1;hb=hb[0];ja=0;for(Ka of ua)if(Ka.destination.$f.hf(hb)||Ka.destination.$f.left>hb.right)ja+=1;var Ka=
ja;if(Ka>ba.EwaSettings.UWi())return O.ULS.sendTraceTag(509658002,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${U}, parameter = TransitionCount, value=${Ka}, reason = Transition count limit exceeded, isRow=false`),!1;if(Ka=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8043178_HideColumnBugFixes"))a:{for(const Pb of ua)if($a.T$e(Pb.destination.$f).IsFirstColOfNextBlockHidden){Ka=!0;break a}Ka=!1}if(Ka)return O.ULS.sendTraceTag(508564123,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${U}, parameter = isFirstRowColOfNextBlockHidden, value=true, isRow=false`),
!1;O.ULS.sendTraceTag(509658001,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${U}, parameter = isInstantaneousGridActionPossible, value=true, reason = isInstantaneousGridActionPossible successful, isRow=false`);return!0}b0f(U,za,ua,$a){try{const Va=Y.HelperMethods.Nd(),hb=ba.EwaSettings.TWi(),qb=ua.filter(Nb=>!Nb.Drc);for(const Nb of qb){if(this.xye("WebServiceResponseReceivedInProcessGridAction",$a,U))return;const yb=this.gridView.ha.ra.selectedRanges[0],ja=Nb.destination.$f.right;
if(ja<yb.left){Nb.Drc=!0;O.ULS.sendTraceTag(509657999,0,50,`GridInstantaneousAction.processGridAction command=${U}, parameter = BlockRangeLessThanSelectedRange, selectedRangeLeftValue=${yb.left}, blockRangeRightMostValue=${ja}, hashCode=${Nb.destination.sf}, isRow=false`);continue}const Ka=za?yb.topLeft.top:yb.topLeft.left,Pb=this.Laf("SourceModel",Nb.source),rc=this.Laf("DestinationModel",Nb.destination),$c=Nb.destination.sf;if(Nb.destination.$f.hf(yb)){if(!c(rc,Ka)){this.Bwa();O.ULS.sendTraceTag(509657998,
0,15,`GridInstantaneousAction.processGridAction command=${U}, parameter = isHideColumnSuccessful, value=false, reason = "HideRowColOperation was failure", hashCode=${$c}, isRow=${za}, rowColNumber=${Ka}`);return}O.ULS.sendTraceTag(509657997,0,50,`GridInstantaneousAction.processGridAction command=${U}, parameter = isHideColumnSuccessful, value=true, reason = "HideRowColOperation was successful", hashCode=${$c}, isRow=${za}, rowColNumber=${Ka}`)}const Dd=Pb.ColumnNumbers[0],Jd=Nb.source.sf;if(h(Pb,
rc,Dd,za).isSuccess)Nb.Drc=!0,O.ULS.sendTraceTag(509657996,0,50,`GridInstantaneousAction.processGridAction command=${U}, parameter = cascadeResult.isSuccess, value=true, reason = "CascadeResult was successful", hashCode=${Jd}, isRow=${za}, rowColNumber=${Dd}`);else{this.Bwa();O.ULS.sendTraceTag(509657995,0,15,`GridInstantaneousAction.processGridAction command=${U}, parameter = cascadeResult.isSuccess, value=false, reason = "CascadeResult was failure", hashCode=${Jd}, isRow=${za}, rowColNumber=${Dd}`);
return}this.m6j(rc,Pb,Nb);if(Y.HelperMethods.Nd()-Va>hb){this.WKj(U,za,qb,$a);return}}this.Qjh(za,U,$a);d("ProcessGridAction",Y.HelperMethods.Nd()-Va)}catch(Va){this.zni(Va)}}Qjh(U,za,ua){if(!this.xye("CommitGridInstantaneousActionResults",ua,za)){var $a=Y.HelperMethods.Nd();if(this.i9&&0!==Object.keys(this.i9).length)if(this.Slj(ua),this.tDg(za,ua)){var Va=pb.a.create().toString(),hb=this.gridView.al("GridInstantaneousAction");Object(cc.c)(hb)?(hb.value.aae(this.gridView.ha.ra.selectedRanges,0,U),
za=Object.keys(this.i9),this.ya.g1f(za,Va,U?"row":"column",!0),this.WIb=!1,Fa=Ua.a(this.$).ti.FKa(6,"GridInstantaneousAction.commitGridInstantaneousActionResults",void 0,Ga.a.instance.ia(2188)),d("CommitGridInstantaneousActionResults",Y.HelperMethods.Nd()-$a)):(this.r$f(ua),this.Bwa(),O.ULS.sendTraceTag(509645768,0,50,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${za}, parameter = ActiveSheetProcessedData, value=null, isRow=${U}`))}else this.r$f(ua),this.Bwa();else this.Bwa(),
O.ULS.sendTraceTag(509657994,0,50,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${za}, parameter = interimModels, value=false, reason = "InterimModels was null", isRow=${U}`)}}Laf(U,za){let ua=this.i9[za.sf];if(!ua){const $a=Y.HelperMethods.SU(()=>{ua=za.t4h()});d(U,$a)}return ua}Slj(U){for(const za of U)U=za.sf,this.sSb[U]||(this.sSb[U]=za.Blc())}r$f(U){for(const za of U){U=za.sf;const ua=this.sSb[U];if(ua&&!za.j8f(ua)){O.ULS.sendTraceTag(509653846,0,15,`GridInstantaneousAction.restoreBlockModels parameter = isModelRestored, value=false, hashCode=${U}`);
this.Bwa();break}}}tDg(U,za){for(const ua of za)if(za=ua.sf,this.i9[za]&&!ua.j8f(this.i9[za]))return O.ULS.sendTraceTag(509657993,0,15,`GridInstantaneousAction.UpdateModelsInBlockCacheSuccessful command=${U}, parameter = isModelUpdated, value=false, reason = "Response Model not updated", hashCode=${za}, isRow=false`),!1;return!0}WKj(U,za,ua,$a){window.setTimeout(()=>{this.b0f(U,za,ua,$a)},0)}NLi(U){for(const za of U)if(za.Sf.Information.Revision>this.ufd)return!0;return!1}xye(U,za,ua){return this.NLi(za)?
(this.ufd=this.$.ea.xg,this.Bwa(),O.ULS.sendTraceTag(509657992,0,50,`GridInstantaneousAction.abortIfServerResponseReceived command=${ua}, parameter = ${U}, value=true, reason = "Server response received before completing client side estimation", isRow=false`),!0):!1}Bwa(){this.i9={};this.WIb=!1;this.sSb={};this.gridView.fj.ovc(!1)}zni(U){this.Bwa();O.ULS.sendTraceTag(509723721,0,10,`${"GridInstantaneousAction.ProcessGridAction"} encountered exception ${U}.`)}m6j(U,za,ua){this.i9[ua.destination.sf]=
U;this.i9[ua.source.sf]=za}};Ha=Object(na.a)([Object(ib.d)(bc.wb),Object(na.b)(0,Object(bc.W)())],Ha);Object(t.a)(Ha,"GridInstantaneousAction",null,[209]);var Na=a(737);class W extends v.a{constructor(U){super();this.$=U;this.je()}create(){this.Ld(Object(Na.a)(this.$.ga,528,()=>new Ha(this.$)))}static la(U){U.ga.Qa(529,new W(U))}}Object(t.a)(W,"GridInstantaneousActionFactory",v.a,[]);C.a.Dk(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}");(()=>
{r.a.Ga(U=>{La.la(U);jc.la(U)})})();(()=>{r.a.Ga(U=>{ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateGridInstantaneousAction",!1)||W.la(U)})})();String(w);window.___1689695406719_closurehack=w}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.rsz.js.map/50750cc73aa18fa283c0ae63cbb4f97a/EwaTS.rsz.js.map