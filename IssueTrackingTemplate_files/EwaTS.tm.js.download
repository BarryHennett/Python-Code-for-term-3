'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1210:function(w,C,a){a.r(C);w=a(0);var b=a(14),c=a(103),h=a(83),k=a(11),d=a(233);class f extends d.a{constructor(t){super();this.$=t;this.je()}create(){const {RenderingFidelityTracker:t}=a(1210);let v=this.$.ga.Da(462);v||(v=this.$.ga.Qa(462,new t));this.Ld(v)}}Object(w.a)(f,"RenderingFidelityTrackerFactory",d.a,[]);var u=a(49);a.d(C,"RenderingFidelityTracker",function(){return r});class r extends h.a{constructor(){super();
this.HYi=3E4;this.xlb={};this.wbe={};this.HIe={};c.Health.instance.addQosPillar("Fidelity")}static la(t){t.ga.Qa(463,new f(t))}P2g(t,v,x,m){if(!(u.PageLoadTrackingInfo.instance.foa(new Date)<this.HYi)){var l=k.HelperMethods.SU(()=>{var n=gridRenderer.CanvasRendererGlobals.analyzeLowRenderingFidelity(v),z=Object.keys(n),y=this.HIe[t];for(var B=0;B<z.length;B++){var G=z[B];this.wbe[G]||(null===y||void 0===y?0:y[G])&&this.xlb[G]&&(this.xlb[G]-=y[G])}this.HIe[t]=n;for(B=0;B<z.length;B++)if(y=z[B],!this.wbe[y])if(G=
n[y],this.xlb[y]&&(G+=this.xlb[y]),gridRenderer.CanvasRendererGlobals.hasRenderingFidelityThresholdExceeded(y,G)){this.wbe[y]=!0;n=gridRenderer.CanvasRendererGlobals.getErrorTypeForRenderingFidelityProblem(y);z=gridRenderer.CanvasRendererGlobals.getVetoForRenderingFidelityProblem(y);B=!("ThickBorder"===y||"MediumBorder"===y);n&&z&&B&&c.Health.instance.recordQosError(n,[z],!1,!0,!0,!1,null);b.ULS.sendTraceTag(527472324,0,50,"Session Vetoed because of : { key:"+y+", isHC:"+x+", scaleFactor:"+m+"}");
break}else this.xlb[y]=G});1<l&&b.ULS.sendTraceTag(527472323,1,50,`RenderingFidelityTracker.AnalyzeModelForLowFidelity: Duration for AnalyzeModelForLowFidelity the model, duration=${l}`)}}}Object(w.a)(r,"RenderingFidelityTracker",h.a,[485,5])},1329:function(w,C,a){function b(xa){var wa=xa.replace(/-.*/g,()=>"");wa=xc.get(wa);return null!==wa&&void 0!==wa?wa:xa.startsWith("ooux")?"ooux":"other"}function c(xa){switch(!0){case xa.RA:return Xd.MergedCell;case xa.eQ:return Xd.bBg;case xa.dz:return Xd.Formula;
case xa.hasAutoFilter:return Xd.AutoFilter;case xa.E2:return Xd.PivotFilter;case !!xa.pAc:return Xd.PivotTable;case xa.yoa:return Xd.Comment;case xa.aab:return Xd.Sparkline;case xa.qFb:return Xd.InCellImage;case xa.hasRichText:return Xd.QCg;default:return""}}a.r(C);var h={};a.r(h);a.d(h,"InteractivityTrackerService",function(){return ed});var k={};a.r(k);a.d(k,"JsSelfProfilerManager",function(){return te});var d={};a.r(d);a.d(d,"PageLoadEngagementInfo",function(){return wd});var f={};a.r(f);var u=
{};a.r(u);a.d(u,"GridActionTelemetryManager",function(){return Ie});var r={};a.r(r);a.d(r,"DocumentVisibilityObserver",function(){return e});var t={};a.r(t);a.d(t,"ValidationTelemetryManager",function(){return yh});var v=a(0),x=a(14);class m{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=
this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(v.a)(m,"BrowserInfo",null,[]);class l{constructor(){this.Version=this.Name=null}}Object(v.a)(l,"PluginInfo",null,[]);var n=a(5),z=a(32);class y{static HGd(){if(n.AFrameworkApplication.da.pa("LogBrowserInfoIsEnabled")){var xa=
y.IZh();try{const wa=JSON.stringify(xa);x.ULS.sendTraceTag(6903563,102,50,wa)}catch(wa){x.ULS.sendTraceTag(6903564,102,15,wa.message)}}else x.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static udi(){const xa=window.navigator.plugins;if(!xa||!xa.length)return null;const wa=[];for(let Ic=0;Ic<xa.length;Ic++){const Zd=xa[Ic].name,Ke=xa[Ic].version;Array.add(wa,Object.assign(new l,{Name:Zd,Version:Ke}))}return wa}static IZh(){const xa=new m,wa=new Sys.StringBuilder;
y.ew(Ic=>{xa.DocElemClientHeight=Ic},()=>document.documentElement.clientHeight,wa);y.ew(Ic=>{xa.DocElemClientWidth=Ic},()=>document.documentElement.clientWidth,wa);y.ew(Ic=>{xa.DocElemOffsetHeight=Ic},()=>document.documentElement.offsetHeight,wa);y.ew(Ic=>{xa.DocElemOffsetWidth=Ic},()=>document.documentElement.offsetWidth,wa);y.ew(Ic=>{xa.ScreenAvailHeight=Ic},()=>window.screen.availHeight,wa);y.ew(Ic=>{xa.ScreenAvailWidth=Ic},()=>window.screen.availWidth,wa);y.ew(Ic=>{xa.ScreenWidth=Ic},()=>window.screen.width,
wa);y.ew(Ic=>{xa.ScreenHeight=Ic},()=>window.screen.height,wa);y.ew(Ic=>{xa.ScreenLogicalXdpi=Ic},()=>window.screen.logicalXDPI,wa);y.ew(Ic=>{xa.ScreenLogicalYdpi=Ic},()=>window.screen.logicalYDPI,wa);y.ew(Ic=>{xa.ScreenDeviceXdpi=Ic},()=>window.screen.deviceXDPI,wa);y.ew(Ic=>{xa.ScreenDeviceYdpi=Ic},()=>window.screen.deviceYDPI,wa);y.ew(Ic=>{xa.WinInnerHeight=Ic},()=>window.self.innerHeight,wa);y.ew(Ic=>{xa.WinInnerWidth=Ic},()=>window.self.innerWidth,wa);y.ew(Ic=>{xa.WinOuterHeight=Ic},()=>window.self.outerHeight,
wa);y.ew(Ic=>{xa.WinOuterWidth=Ic},()=>window.self.outerWidth,wa);y.ew(Ic=>{xa.WinOrientation=Ic},()=>window.self.orientation,wa);y.ew(Ic=>{xa.WinDevicePixelRatio=Ic},()=>window.self.devicePixelRatio,wa);y.ew(Ic=>{xa.SupportsTouch=Ic},()=>z.a.SJc,wa);y.ew(Ic=>{xa.NavAppName=Ic},()=>window.navigator.appName,wa);y.ew(Ic=>{xa.NavAppVersion=Ic},()=>window.navigator.appVersion,wa);y.ew(Ic=>{xa.NavLanguage=Ic},()=>window.navigator.browserLanguage||window.navigator.language,wa);y.ew(Ic=>{xa.NavUserAgent=
Ic},()=>window.navigator.userAgent,wa);y.ew(Ic=>{xa.NavPlatform=Ic},()=>window.navigator.platform,wa);y.ew(Ic=>{xa.NavPlugins=Ic},y.udi,wa);y.ew(Ic=>{xa.CalculatedDevicePixelRatio=Ic},()=>y.devicePixelRatio,wa);xa.Error=wa.toString();return xa}static get devicePixelRatio(){const xa=window.devicePixelRatio;return isNaN(xa)?window.screen.deviceXDPI/window.screen.logicalXDPI:xa}static ew(xa,wa,Ic){try{const Zd=wa();xa(Zd)}catch(Zd){Ic.isEmpty()||Ic.append(" | "),Ic.append(Zd.message||"null")}}}Object(v.a)(y,
"BrowserInfoLogger",null,[]);var B=a(261);class G{get name(){return"Common.App.BrowserInfoLogger"}Xj(){}init(){y.HGd()}dispose(){}static main(){B.a.instance.Tk(new G)}}Object(v.a)(G,"BrowserInfoLoggerPackage",null,[2,3]);var E=a(64);class J{constructor(xa){this.BPc=xa}atf(xa){if(!this.BPc)return!0;xa=E.a.Kqd(xa);if(!xa)return!1;xa=xa.toLowerCase();for(let wa=0;wa<this.BPc.length;wa++)if(xa.endsWith(this.BPc[wa]))return!0;return!1}}Object(v.a)(J,"DomainAllowListManager",null,[]);class I{constructor(xa,
wa){this.HX=null;this.o2c=xa;this.url=wa}get sae(){return E.a.j4(this.url)}get Lt(){return this.o2c}b8d(){const xa={},wa=this.Lt;xa.a=this.sae;xa.b=this.round(wa.navigationStart);xa.c=this.round(wa.unloadEventStart);xa.d=this.round(wa.unloadEventEnd);xa.e=this.round(wa.redirectStart);xa.f=this.round(wa.redirectEnd);xa.g=this.round(wa.fetchStart);xa.h=this.round(wa.domainLookupStart);xa.i=this.round(wa.domainLookupEnd);xa.j=this.round(wa.connectStart);xa.k=this.round(wa.connectEnd);xa.l=void 0!==wa.secureConnectionStart&&
null!==wa.secureConnectionStart?this.round(wa.secureConnectionStart):0;xa.m=this.round(wa.requestStart);xa.n=this.round(wa.responseStart);xa.o=this.round(wa.responseEnd);xa.q=this.round(wa.domInteractive);xa.r=this.round(wa.domContentLoadedEventStart);xa.s=this.round(wa.domContentLoadedEventEnd);xa.t=this.round(wa.domComplete);xa.u=this.round(wa.loadEventStart);xa.v=this.round(wa.loadEventEnd);xa.w=this.HX;return xa}round(xa){return Math.round(1E3*xa)/1E3}}Object(v.a)(I,"PerformanceTimingEntry",null,
[]);const R=(xa,wa)=>{const Ic={};let Zd=null;switch(xa){case 0:Zd="ResourceTiming";xa=wa.a;null!=xa&&(Ic.Url=xa);xa=wa.b;null!=xa&&(Ic.InitiatorType=xa);xa=null==wa.c?null:wa.c.toString();null!=xa&&(Ic.RedirectStart=xa);xa=null==wa.d?null:wa.d.toString();null!=xa&&(Ic.RedirectEnd=xa);xa=null==wa.e?null:wa.e.toString();null!=xa&&(Ic.FetchStart=xa);xa=null==wa.f?null:wa.f.toString();null!=xa&&(Ic.DomainLookupStart=xa);xa=null==wa.g?null:wa.g.toString();null!=xa&&(Ic.DomainLookupEnd=xa);xa=null==wa.h?
null:wa.h.toString();null!=xa&&(Ic.ConnectStart=xa);xa=null==wa.i?null:wa.i.toString();null!=xa&&(Ic.ConnectEnd=xa);xa=null==wa.j?null:wa.j.toString();null!=xa&&(Ic.SecureConnectionStart=xa);xa=null==wa.k?null:wa.k.toString();null!=xa&&(Ic.RequestStart=xa);xa=null==wa.l?null:wa.l.toString();null!=xa&&(Ic.ResponseStart=xa);xa=null==wa.m?null:wa.m.toString();null!=xa&&(Ic.ResponseEnd=xa);xa=wa.n;null!=xa&&(Ic.CustomText=xa);xa=null==wa.o?null:wa.o.toString();null!=xa&&(Ic.DecodedBodySize=xa);xa=null==
wa.p?null:wa.p.toString();null!=xa&&(Ic.EncodedBodySize=xa);wa=null==wa.q?null:wa.q.toString();null!=wa&&(Ic.TransferSize=wa);break;case 1:Zd="PerformanceTiming",xa=wa.a,null!=xa&&(Ic.Url=xa),xa=null==wa.b?null:wa.b.toString(),null!=xa&&(Ic.NavigationStart=xa),xa=null==wa.c?null:wa.c.toString(),null!=xa&&(Ic.UnloadEventStart=xa),xa=null==wa.d?null:wa.d.toString(),null!=xa&&(Ic.UnloadEventEnd=xa),xa=null==wa.e?null:wa.e.toString(),null!=xa&&(Ic.RedirectStart=xa),xa=null==wa.f?null:wa.f.toString(),
null!=xa&&(Ic.RedirectEnd=xa),xa=null==wa.g?null:wa.g.toString(),null!=xa&&(Ic.FetchStart=xa),xa=null==wa.h?null:wa.h.toString(),null!=xa&&(Ic.DomainLookupStart=xa),xa=null==wa.i?null:wa.i.toString(),null!=xa&&(Ic.DomainLookupEnd=xa),xa=null==wa.j?null:wa.j.toString(),null!=xa&&(Ic.ConnectStart=xa),xa=null==wa.k?null:wa.k.toString(),null!=xa&&(Ic.ConnectEnd=xa),xa=null==wa.l?null:wa.l.toString(),null!=xa&&(Ic.SecureConnectionStart=xa),xa=null==wa.m?null:wa.m.toString(),null!=xa&&(Ic.RequestStart=
xa),xa=null==wa.n?null:wa.n.toString(),null!=xa&&(Ic.ResponseStart=xa),xa=null==wa.o?null:wa.o.toString(),null!=xa&&(Ic.ResponseEnd=xa),xa=null==wa.p?null:wa.p.toString(),null!=xa&&(Ic.DomLoading=xa),xa=null==wa.q?null:wa.q.toString(),null!=xa&&(Ic.DomInteractive=xa),xa=null==wa.r?null:wa.r.toString(),null!=xa&&(Ic.DomContentLoadedEventStart=xa),xa=null==wa.s?null:wa.s.toString(),null!=xa&&(Ic.DomContentLoadedEventEnd=xa),xa=null==wa.t?null:wa.t.toString(),null!=xa&&(Ic.DomComplete=xa),xa=null==wa.u?
null:wa.u.toString(),null!=xa&&(Ic.LoadEventStart=xa),xa=null==wa.v?null:wa.v.toString(),null!=xa&&(Ic.LoadEventEnd=xa),wa=wa.w,null!=wa&&(Ic.CustomText=wa)}Ic.Table=Zd;return Sys.Serialization.JavaScriptSerializer.serialize(Ic)};var X=a(52),H=a(173),M=a(362);class O{constructor(xa,wa,Ic){this.aj=xa;this.rae=this;this.GJg=(void 0===wa?null:wa)||(()=>window.location.href);this.BSc=new J(void 0===Ic?null:Ic)}run(){if(O.aT(window.performance))try{const Ke=this.GJg();if(O.lSg.exec(Ke)&&this.BSc.atf(Ke)){var xa=
new I(window.performance.timing,Ke);M.a.instance.cvj(xa.Lt.fetchStart);M.a.instance.dvj(xa.Lt.navigationStart);M.a.instance.WLb(X.a.IYh,"connectStart","requestStart");M.a.instance.WLb(X.a.QYh,"requestStart","responseStart");M.a.instance.WLb(X.a.TYh,"responseStart","responseEnd");this.rae.ih(1,xa.b8d());this.aj.tn(X.a.Eza,xa.Lt.fetchStart);this.aj.tn(X.a.NYh,xa.Lt.domainLookupStart);this.aj.tn(X.a.MYh,xa.Lt.domainLookupEnd);this.aj.tn(X.a.KYh,xa.Lt.connectStart);this.aj.tn(X.a.UYh,xa.Lt.secureConnectionStart);
this.aj.tn(X.a.JYh,xa.Lt.connectEnd);this.aj.tn(X.a.RYh,xa.Lt.requestStart);this.aj.tn(X.a.Bnd,xa.Lt.responseStart);this.aj.tn(X.a.OYh,xa.Lt.responseEnd-xa.Lt.responseStart);this.aj.tn(X.a.SYh,xa.Lt.responseStart-xa.Lt.requestStart);var wa=0,Ic=0,Zd=0;(()=>{let Te=this.Ldk(Ke);({transferSize:wa,Vid:Ic,ogd:Zd}=Te);return Te})().returnValue&&(this.aj.tn(X.a.VYh,wa),this.aj.tn(X.a.LYh,Zd),this.aj.tn(X.a.PYh,Ic));this.aj.tn(X.a.znd,xa.Lt.navigationStart)}}catch(Ke){x.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",
Ke)}}Ldk(xa){let wa,Ic,Zd;Zd=Ic=wa=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:wa,Vid:Ic,ogd:Zd};xa=window.performance.getEntriesByName(xa,"navigation");if(void 0===xa||null===xa||1!==xa.length)return{returnValue:!1,transferSize:wa,Vid:Ic,ogd:Zd};xa=xa[0];var Ke=xa.transferSize;void 0!==wa&&null!==wa&&(wa=Ke);Ke=xa.decodedBodySize;void 0!==Ke&&null!==Ke&&(Zd=Ke);xa=xa.encodedBodySize;void 0!==xa&&null!==xa&&(Ic=
xa);return{returnValue:!0,transferSize:wa,Vid:Ic,ogd:Zd}}ih(xa,wa){x.ULS.sendTraceTag(4551815,306,50,R(xa,wa))}static get instance(){return O.La||(O.La=new O(H.a.instance,null,n.AFrameworkApplication.da.pa("PerfTimingLoggerFilterDomainsIsEnabled")?n.AFrameworkApplication.da.ay("ResourceLoggerDomainAllowList"):null))}static aT(xa){return!(void 0===xa||null===xa)&&!(void 0===xa.timing||null===xa.timing)}}O.La=null;O.lSg=RegExp("^https?://.*","i");Object(v.a)(O,"PerformanceTimingLogger",null,[750]);
var L=a(105),S=a(138);class T{constructor(xa,wa){this.HX=null;this.o2c=xa;this.behavior=wa;this.url=this.Lt.name}get sae(){return 2===this.behavior?this.url:E.a.j4(this.url)}get Lt(){return this.o2c}b8d(){const xa={},wa=this.Lt;xa.a=this.sae;xa.b=wa.initiatorType;xa.c=this.round(wa.redirectStart);xa.d=this.round(wa.redirectEnd);xa.e=this.round(wa.fetchStart);xa.f=this.round(wa.domainLookupStart);xa.g=this.round(wa.domainLookupEnd);xa.h=this.round(wa.connectStart);xa.i=this.round(wa.connectEnd);xa.j=
void 0!==wa.secureConnectionStart&&null!==wa.secureConnectionStart?this.round(wa.secureConnectionStart):0;xa.k=this.round(wa.requestStart);xa.l=this.round(wa.responseStart);xa.m=this.round(wa.responseEnd);xa.o=this.round(T.oAa(wa,"decodedBodySize"));xa.p=this.round(T.oAa(wa,"encodedBodySize"));xa.q=this.round(T.oAa(wa,"transferSize"));xa.n=this.HX;return xa}round(xa){return Math.round(1E3*xa)/1E3}static oAa(xa,wa){return xa[wa]}}Object(v.a)(T,"ResourceTimingEntry",null,[764]);var V=a(103),la=a(145),
Z=a(42),da=a(113),ba=a(174);class na{constructor(xa,wa,Ic){this.Kee=xa;this.s5b=void 0===wa?null:wa;this.kua={};this.oGg=void 0===Ic?100:Ic}$ck(xa){var wa=xa.name.toLowerCase();const Ic=E.a.t2(wa);this.l$f(Ic,wa)&&(Ic in this.kua?x.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",Ic):(wa={},wa.fetchstart=xa.fetchStart,wa.responseend=xa.responseEnd,wa.iscached=this.fyf(xa),wa.encodedsize=T.oAa(xa,"encodedBodySize"),wa.decodedsize=T.oAa(xa,"decodedBodySize"),
this.kua[Ic]=wa))}adk(xa){var wa=xa.name.toLowerCase();const Ic=E.a.t2(wa);this.lHj(Ic,wa)&&(Ic in this.kua?x.ULS.sendTraceTag(508925201,306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",Ic):(wa={},wa.fetchstart=xa.fetchStart,wa.responseend=xa.responseEnd,wa.iscached=this.fyf(xa),wa.encodedsize=T.oAa(xa,"encodedBodySize"),wa.decodedsize=T.oAa(xa,"decodedBodySize"),wa.it=xa.initiatorType,wa.ress=xa.responseStart,wa.cs=xa.connectStart,wa.ce=xa.connectEnd,wa.dls=xa.domainLookupStart,
wa.dle=xa.domainLookupEnd,wa.rs=xa.redirectStart,wa.re=xa.redirectEnd,wa.reqs=xa.requestStart,wa.scs=xa.secureConnectionStart,this.kua[Ic]=wa))}l$f(xa,wa){if(this.Kee)return Array.contains(this.Kee,xa);if(this.s5b)for(xa=E.a.AK(wa),wa=0;wa<this.s5b.length;wa++)if(this.s5b[wa]&&xa.endsWith(this.s5b[wa]))return!0;return!1}lHj(xa,wa){return this.l$f(xa,wa)?xa.endsWith(".js")||xa.endsWith(".css"):!1}fyf(xa){try{const wa=T.oAa(xa,"transferSize");if(void 0!==wa&&null!==wa)return!wa;x.ULS.sendTraceTag(51652510,
306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return xa.responseEnd-xa.fetchStart<this.oGg}catch(wa){x.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",wa.message)}return!1}Bvj(){if(da.a.ij(this.kua))x.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var xa=n.AFrameworkApplication.flightId?n.AFrameworkApplication.flightId.split(";"):
[],wa=Object.assign(new ba.a,{extendedProperties:la.a.Zt()});wa.extendedProperties.set("Flights",Z.c(xa));this.RSi(wa,this.kua,V.Health.instance)}}uod(xa){let wa=0,Ic=0,Zd=0,Ke=0;const Te=this.kua;for(const Ef in Te){var If=Te[Ef];Ef.endsWith(".js")&&(If=Object(S.a)(Object,If),If.responseend<xa&&(wa+=1,Ic+=If.decodedsize,Ke+=If.encodedsize,Zd+=If.iscached?0:If.encodedsize))}xa={};xa.filesLoaded=wa;xa.decodedBytes=Ic;xa.transferredBytes=Zd;xa.encodedBytes=Ke;return xa}RSi(xa,wa,Ic){if(wa){var Zd=0,
Ke=0,Te=0,If=0,Ef=0,ta=0,zb=0,qc=0,Kc=0,Xc=0,Sd=0;for(const Le in wa){var me=wa[Le];try{const Xe=Object(S.a)(Object,me);if(!Xe)continue;const rf=Xe.iscached?Boolean.parse(Xe.iscached.toString()):!1,Ff=Xe.fetchstart?this.parseFloat(Xe.fetchstart.toString()):0,Kf=(Xe.responseend?this.parseFloat(Xe.responseend.toString()):0)-Ff,Pf=Xe.encodedsize?this.parseFloat(Xe.encodedsize.toString()):0,ya=Xe.decodedsize?this.parseFloat(Xe.decodedsize.toString()):0;Zd+=Kf;If+=Pf;zb+=ya;Xc++;rf?(Te+=Kf,ta+=Pf,Kc+=
ya,Sd++):(Ke+=Kf,Ef+=Pf,qc+=ya)}catch(Xe){x.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",Xe.message)}}xa.extendedProperties.set("StaticResources",Z.c(wa));xa.extendedProperties.set("TotalResourceDownloadLatency",Zd.toString());xa.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",Ke.toString());xa.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",Te.toString());xa.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",
If.toString());xa.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Ef.toString());xa.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",ta.toString());xa.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",zb.toString());xa.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",qc.toString());xa.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",Kc.toString());xa.extendedProperties.set("TotalNumberOfResourcesDownloaded",
Xc.toString());xa.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Sd.toString());Ic.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);Ic.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",xa)}}parseFloat(xa){if(!xa)return 0;xa=parseFloat(xa);return isNaN(xa)?0:xa}}Object(v.a)(na,"AppStaticResourceManager",null,[]);class Y extends Sys.EventArgs{constructor(xa){super();this.entries=xa}}Object(v.a)(Y,"EntriesAvailableEventArgs",
Sys.EventArgs,[]);var Ga=a(112);class ma{constructor(xa,wa,Ic,Zd,Ke,Te){Ic=void 0===Ic?null:Ic;Zd=void 0===Zd?null:Zd;Ke=void 0===Ke?100:Ke;Te=void 0===Te?!1:Te;this.CWc=!1;this.Yk=null;this.fob=0;this.$a=new L.a;this.BHa=null;this.vS=!1;this.Twe=0;this.fg=xa;this.Hhe=0;this.rae=this;this.BSc=new J(Ic);this.Mx=wa;Zd&&(this.BHa=new na(null,Zd,Ke));this.UEg=Te}get mJe(){try{return!(void 0===this.Mx||null===this.Mx)&&!(void 0===this.Mx.getEntriesByType||null===this.Mx.getEntriesByType)}catch(xa){return x.ULS.sendTraceTag(50873240,
306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",xa),!1}}get Owh(){return this.Hhe}get isActive(){return this.vS}get R7d(){return this.Twe}dZg(xa){this.$a.addHandler(ma.xjd,xa)}bBj(xa){this.$a.removeHandler(ma.xjd,xa)}Xj(xa,wa){const Ic=this.R7d!==xa;this.Twe=xa;this.isActive&&this.fg&&Ic&&(this.rr(),this.Sh());this.Hhe=wa}activate(){!this.isActive&&this.mJe&&(this.Sh(),this.vS=!0)}deactivate(xa){this.isActive&&(this.rr(),xa&&this.flush(),this.vS=!1)}flush(){if(this.isActive&&
this.mJe)try{var xa=window.performance.getEntriesByType("resource");0<xa.length-this.fob&&x.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",xa.length-this.fob);const wa=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);wa&&(window.performance.clearResourceTimings(),this.fob=0);const Ic=[];for(let Zd=this.fob;Zd<xa.length;Zd++)this.BSc.atf(xa[Zd].name)&&(this.BHa&&(this.UEg?
this.BHa.adk(xa[Zd]):this.BHa.$ck(xa[Zd])),Ic.push(new T(xa[Zd],this.Owh)));wa||(this.fob=xa.length);this.$a.raiseEvent(ma.xjd,new Y(Ic));for(xa=0;xa<Ic.length;xa++)0!==Ic[xa].behavior&&2!==Ic[xa].behavior||this.rae.ih(0,Ic[xa].b8d());0<Ic.length&&x.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",Ic.length)}catch(wa){x.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",wa)}}ih(xa,wa){x.ULS.sendTraceTag(4310804,
306,50,R(xa,wa))}bvj(){this.BHa.Bvj()}uod(xa){return this.BHa.uod(xa)}Sh(){this.fg&&0<this.R7d&&(this.Yk=new Ga.a(3,2,1E3*this.R7d,()=>{this.flush()},5),this.fg.Sh(this.Yk),this.CWc=!0)}rr(){this.CWc&&(this.fg.rr(this.Yk),this.Yk=null,this.CWc=!1)}}ma.xjd="EntriesAvailable";Object(v.a)(ma,"ResourceTimingLogger",null,[734,750]);var fa=a(123);class Xa{constructor(){this.hd=null}get name(){return"Common.ResourceTiming"}init(){this.hd.resolve("Common.NetworkTiming.IResourceTimingLogger");O.instance.run()}dispose(){}Xj(xa){this.hd=
xa;let wa=null;if(n.AFrameworkApplication.da.pa("ResourceLoggerFilterDomainsIsEnabled"))try{wa=n.AFrameworkApplication.da.ay("ResourceLoggerDomainAllowList")}catch(Te){x.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const Ic=[];Ic.push(E.a.AK(fa.a.RL).toLowerCase());Ic.push(E.a.AK(fa.a.Pjb).toLowerCase());const Zd=n.AFrameworkApplication.da.Hf("AppStaticResourceMonitorCacheThresholdInMs",100),Ke=n.AFrameworkApplication.da.pa("PPTAggregateResourceTimingV2Enabled");
xa.register(734,"Common.NetworkTiming.IResourceTimingLogger").Ee().Le(()=>new ma(n.AFrameworkApplication.Vj,window.performance,wa,Ic,Zd,Ke))}static main(){B.a.instance.Tk(new Xa)}}Object(v.a)(Xa,"ResourceTimingPackage",null,[2,3]);var Ua=a(79);class ka extends Sys.EventArgs{constructor(xa,wa){super();this.w9j=xa;this.actualValue=wa}}Object(v.a)(ka,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var nb=a(119);class Ea{constructor(){this.h0a=[];this.ehe=this.SRc=0;this.nja=null;this.$a=
new L.a}init(xa,wa,Ic){this.nja=xa;this.SRc=wa;this.ehe=Ic;this.nja.zCe(Object(Ua.a)(this,this.W5i,"onCpuMeterFrameAvailable"));this.A_g(Object(Ua.a)(this,this.Snh,"cpuPercentThresholdExceeded"))}W5i(xa,wa){wa.KIf&&(Array.enqueue(this.h0a,wa.KIf.CP),this.h0a.length>this.ehe&&(Array.dequeue(this.h0a),this.Mfh()))}Mfh(){var xa=this.h0a.length;let wa=0;for(let Ic=0;Ic<xa;Ic++){const Zd=Array.dequeue(this.h0a);wa+=Zd;Array.enqueue(this.h0a,Zd)}xa=wa/xa;xa>this.SRc&&this.$a.raiseEvent("CPTTE",new ka(this.SRc,
xa))}Snh(xa,wa){nb.a(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.Sph(wa.w9j,wa.actualValue))}A_g(xa){this.$a.addHandler("CPTTE",xa)}Sph(xa,wa){const Ic={};Ic.ThresholdValue=xa;Ic.ActualValue=wa;return Ic}}Object(v.a)(Ea,"CpuMeterMonitor",null,[752]);var sb=a(179);class Oa{constructor(){this.S=this.T=this.M=this.C=0}}Object(v.a)(Oa,"ProfileInformation",null,[]);var La=a(13),ia=a(47),Sa=a(267);class Za{constructor(xa,wa){this.$Uc=!1;this.HIa={};this.J2b=void 0===xa?0:xa;this.S2b=
void 0===wa?0:wa;this.E2c=0;ia.a.addHandler(window.self,La.a.b2g,()=>{this.$Uc=!0});ia.a.addHandler(window.self,La.a.c2g,()=>{this.$Uc=!1})}SDe(xa,wa,Ic){const Zd=Za.generateKey(wa,Ic);Zd in this.HIa?wa=this.HIa[Zd]:(wa=new Oa,wa.S=Ic?1:0,this.HIa[Zd]=wa,this.E2c++);wa.C++;wa.M=xa>wa.M?xa:wa.M;wa.T+=xa}MS(xa,wa){this.SDe(xa,wa,!1);this.$Uc&&this.SDe(xa,wa,!0)}getData(){if(0<this.S2b&&this.E2c>this.S2b)return this.D5h();const xa=0<this.J2b,wa={},Ic=this.HIa;for(const Ke in Ic){var Zd=Ke;const Te=Ic[Ke];
this.xag(Te);xa&&Te.T>=this.J2b&&(wa[Zd]=Te)}return xa?da.a.ij(wa)?null:wa:this.HIa}D5h(){var xa=0<this.J2b,wa=[];const Ic=this.HIa;for(const Zd in Ic){const Ke={key:Zd,value:Ic[Zd]},Te=Ke.value;(!xa||Te.T>=this.J2b)&&Array.add(wa,Ke)}if(wa.length>this.S2b)wa.sort((Zd,Ke)=>Ke.value.T-Zd.value.T),wa=wa.slice(0,this.S2b);else if(!wa.length)return null;xa={};for(const Zd of wa)wa=Zd.value,this.xag(wa),xa[Zd.key]=wa;return xa}xag(xa){xa.M=Sa.a.Gaa(xa.M,0);xa.T=Sa.a.Gaa(xa.T,0)}reset(){this.HIa={};this.E2c=
0}static generateKey(xa,wa){return wa?xa+" [it]":xa}}Object(v.a)(Za,"FunctionCallAggregator",null,[187]);class Ab{}Ab.v7g="BatchedOperation";Ab.replication="Replication";Ab.qek="25";Ab.nEj="9_"+Ab.v7g+"_"+Ab.replication;Object(v.a)(Ab,"CpuMeterConstants",null,[]);class pb{}Object(v.a)(pb,"CpuMeterFrame",null,[]);class Tb extends Sys.EventArgs{constructor(xa){super();this.KIf=xa}}Object(v.a)(Tb,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class ob{}Object(v.a)(ob,"MiniTaskItemInfo",null,[]);
class va{}Object(v.a)(va,"TaskItemInfo",null,[]);var Pa=a(562),jb=a(106);class Ob{static Qki(){if(!Ob.OZb&&(Ob.OZb=new jb.a,n.AFrameworkApplication.da&&n.AFrameworkApplication.da.Ur("AggregatorIdDisabledList"))){const xa=n.AFrameworkApplication.da.ay("AggregatorIdDisabledList");for(let wa=0;wa<xa.length;wa++)Ob.OZb.fa(xa[wa],!0)}return Ob.OZb}}Ob.OZb=null;Object(v.a)(Ob,"DisabledAggregatorListStore",null,[]);var kb=a(270);class ra{constructor(xa,wa,Ic,Zd,Ke,Te,If){Te=void 0===Te?!0:Te;If=void 0===
If?null:If;this.b0=this.iwe=this.une=!1;this.fg=null;if(!xa)throw kb.a.argument("taskManagerLazy");if(!Ke)throw kb.a.argument("dataAggregator");this.yRg=xa;this.aZc=wa;this._id=Ic;this.Jle=6E4*Zd;this.$_b=Ke;this.ute=Te;this.hsb=If;Ob.Qki().kd(this._id.toString())&&(this.b0=!0)}get taskManager(){return this.fg||(this.fg=this.yRg.value)}track(xa,wa){wa=void 0===wa?null:wa;this.b0||(this.NGh(),this.TKj(),this.$_b.MS(xa,wa))}TKj(){!this.une&&0<this.Jle&&(this.une=!0,this.mcg())}mcg(){const xa=new Ga.a(5,
1,this.Jle,()=>{this.RMj()},19,this._id.toString());this.taskManager.Sh(xa)}RMj(){!this.hsb||this.hsb.JWj()?this.rdg():this.ute&&this.$_b.reset();this.mcg()}rdg(){const xa=this.$_b.getData();if(xa){const wa=parseInt(String(xa.length));if(isNaN(wa)||0<wa)this.SFc(xa),this.ute&&this.$_b.reset()}}SFc(xa){x.ULS.sendTraceTag(7079840,335,50,"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:xa})}NGh(){this.iwe||(this.aZc(()=>{this.rdg()}),this.iwe=!0)}static $P(xa,wa,Ic,Zd,Ke){return new ra(new Pa.a(()=>
n.AFrameworkApplication.Vj),n.AFrameworkApplication.Lkb,xa,wa,Ic,Zd,Ke)}static C9a(xa,wa,Ic){return ra.$P(xa,wa,Ic,!0,null)}}Object(v.a)(ra,"Aggregator",null,[192]);class rb{constructor(xa){xa=void 0===xa?null:xa;this.Yo=null;this.reset();this.hsb=xa}MS(xa,wa){if(!this.hsb||this.hsb.JWj())wa in this.Yo||(this.Yo[wa]=[]),this.Yo[wa].push(xa)}getData(){return da.a.count(this.Yo)?this.Yo:null}reset(){this.Yo={}}}Object(v.a)(rb,"NamedValuesAggregator",null,[187]);var Kb=a(237);class Sb{constructor(xa,
wa,Ic,Zd,Ke){this.hKa=0;this.aH=null;this.A4b=this.Tve=0;this.jue=!1;this.I0a=0;this.Xpb=!1;this.Nva=null;this.H1b=0;this.are=new L.a;this.wRg=[];this.UO=xa;this.TXc=wa;this.NTc=Ic;this.kpe=Zd;n.AFrameworkApplication.da&&n.AFrameworkApplication.da.pa("WrapSetTimeoutForTelemetryIsEnabled")&&this.AEd();this.QIg=Ke;this.OTc=new Za(100);this.KMg=ra.C9a(1,5,new rb)}zCe(xa){this.are.addHandler("OnCpuMeterFrameAvailable",xa)}ahb(xa,wa,Ic,Zd){Ic=(Zd=void 0===Zd?null:Zd)?Zd.priority:7;const Ke=this.UO();this.start(wa,
Ic);try{xa()}finally{this.stop(wa,Zd),xa=this.UO()-Ke,this.kpe.track(xa,wa)}}IZ(xa,wa){const Ic=this.UO();try{xa()}finally{xa=this.UO()-Ic,this.NTc.MS(xa,wa),0<this.hKa&&this.OTc.MS(xa,wa),this.kpe.track(xa,wa)}}FOd(xa){const wa=new va;wa.TN=xa.Iuc;wa.TP=xa.priority;this.V1f(1,wa)}geb(xa){this.H1b|=xa}start(xa,wa){if(!this.hKa){this.OTc.reset();const Ic=this.tyf(xa);Ic&&this.CId(1);this.aH=new va;this.aH.TN=xa;this.aH.TP=wa;this.aH.ST=(new Date).toISOString();this.aH.STS=Sa.a.Gaa(this.UO(),2);Ic?
this.aH.UI=1:this.YGi(xa)?this.aH.UI=2:this.aH.UI=0}this.hKa++}CId(xa){this.I0a|=xa}Kad(xa,wa){this.I0a=void 0===xa||xa?0:this.I0a&~(void 0===wa?0:wa)}stop(xa,wa){wa=void 0===wa?null:wa;let Ic;this.hKa--;0>=this.hKa&&this.aH&&(Ic=this.UO()-this.aH.STS,this.A4b+=Ic,this.TXc.MS(Ic,xa),this.tyf(xa)&&this.Kad(!1,1),this.aH.TRT=Sa.a.Gaa(Ic,2),wa&&(this.aH.TQT=Sa.a.Gaa(wa.krj,2),this.aH.TDT=Sa.a.Gaa(wa.Mzf,2)),this.QIg&&(this.V1f(0,this.aH),this.ZEj()),this.hKa=0);0<=xa.indexOf(Ab.qek)&&this.geb(2);0<=
xa.indexOf(Ab.nEj)&&this.geb(4);1===(this.I0a&1)&&this.geb(1);2===(this.I0a&2)&&this.geb(8)}ZEj(){var xa=this.aH.TRT;if(750<xa){let Ic=this.OTc.getData();if(Ic){const Zd={};for(const Ke in Ic){var wa=Ic[Ke];const Te=Ke;Te.startsWith("SiOp_")||Te.endsWith("[it]")||(Zd[Te]=Math.round(100*wa.T/xa))}Ic=Zd}xa=Object.assign(new ob,{B:this.aH.STS,T:xa,S:Ic});this.KMg.track(xa,this.aH.TN)}}y3j(){var xa=this.UO()-this.Tve,wa=Sa.a.Gaa(this.A4b/xa*100,2);xa=new pb;xa.CP=wa;xa.II=this.H1b;wa=this.TXc.getData();
da.a.count(wa)&&(xa.LRT=wa);wa=this.NTc.getData();da.a.count(wa)&&(xa.FP=wa);this.are.raiseEvent("OnCpuMeterFrameAvailable",new Tb(xa));this.Umg()}Umg(){this.TXc.reset();this.NTc.reset();this.A4b=this.hKa=0;this.Tve=this.UO();this.H1b=0;this.aH=null}run(){this.jue?this.y3j():(this.Umg(),this.jue=!0);this.Nva?this.Nva(Object(Ua.a)(this,this.run,"run"),1E3):window.setTimeout(Object(Ua.a)(this,this.run,"run"),1E3)}V1f(xa,wa){xa=this.wRg[xa];if(!Kb.a.ij(xa))for(let Zd=0;Zd<xa.length;Zd++){var Ic=xa[Zd];
const Ke=Ic[0];Ic=Ic[1];Ke&&!Ke(wa)||Ic(wa)}}AEd(){if(!this.Xpb){const xa=window.setTimeout;this.Nva=(wa,Ic)=>xa(wa,Ic);this.Xpb=!0}}tyf(xa){return xa.startsWith("key")||xa.startsWith("input")}YGi(xa){return xa.startsWith("click")||xa.startsWith("mouse")||xa.startsWith("pointer")}}Object(v.a)(Sb,"CpuMeter",null,[108]);class cb{constructor(xa){this.dob=null;this.Gm=new sb.a;this.UO=xa}initialize(xa,wa,Ic,Zd){this.dob||(this.dob=new Sb(this.UO,xa,wa,Ic,void 0===Zd?!1:Zd),this.Gm.setResult(this.dob));
return this.dob}}Object(v.a)(cb,"CpuMeterProvider",null,[753]);class cc{constructor(xa){this.$z=[];this.h0b=[];this._count=void 0===xa?1:xa}FVh(){let xa=0;for(let wa=0;wa<this.$z.length;wa++)this.$z[wa]<this.$z[xa]&&(xa=wa);return xa}MS(xa,wa){xa=Sa.a.Gaa(xa,2);if(this.$z.length<this._count)Array.add(this.$z,xa),Array.add(this.h0b,wa);else{var Ic=this.FVh();xa>this.$z[Ic]&&(this.$z[Ic]=xa,this.h0b[Ic]=wa)}}getData(){return this.$z.length?{["Vals"]:this.$z,["Desc"]:this.h0b}:null}reset(){this.$z=[];
this.h0b=[]}}Object(v.a)(cc,"MaxDataAggregator",null,[187]);var Ub=a(41),wb=a(84);class vc{get name(){return"Common.App.CpuMeter"}Xj(xa){xa.register(cb,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").Ee().Le(()=>new cb(Ub.a.Of));xa.register(Ea,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").Ee().Le(()=>new Ea)}init(){const xa=n.AFrameworkApplication.da;if(xa.pa("CpuMeterIsEnabled")){const wa=wb.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");
M.a.instance.QEe.continueWith(()=>{vc.gwi(xa,wa)})}}dispose(){}static gwi(xa,wa){const Ic=ra.C9a(10,5,new Za(xa.Hf("TaskManagerLoggingThreshold",0),xa.Hf("CpuMeterMaximumEntriesToLog",0)));wa=wa.initialize(new cc(5),new Za,Ic,xa.pa("CPUMeterExposeTaskDetailsIsEnabled"));xa.pa("WordEditorInteractivePerfDisableCpuMeterFrames")||(wa.run(),xa.pa("CpuMeterMonitorIsEnabled")&&wb.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(wa,xa.G8("CpuMeterAverageCpuPercentThreshold",80),xa.Hf("CpuMeterRollingAverageFramesCount",
15)));nb.a(16827671,306,50,"Initializing CpuMeter")}static main(){B.a.instance.Tk(new vc)}}Object(v.a)(vc,"CpuMeterPackage",null,[2,3]);var Lb=a(997);class Ja{get name(){return"Common.App.EventsCachePackage"}Xj(){}init(){Lb.a.instance.init()}dispose(){}static main(){B.a.instance.Tk(new Ja)}}Object(v.a)(Ja,"EventsCachePackage",null,[2,3]);var Hb=a(10),gc=a(233),ec=a(906),Ta=a(181),ib=a(385),bc=a(214),jc=a(251),sc=a(60),Fa=a(93),Ha=a(1),Na=a(22),W=a(171),U=a(764);class za extends ec.a{constructor(xa,
wa,Ic){super(wa,Ic);this.Ua=new L.a;this.ysi=Zd=>{if(Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:3449424_AgaveValidateHost")){const Ke=Zd.Values.m_Origin;n.AFrameworkApplication.wopiHostOriginFromPostMessage||(n.AFrameworkApplication.wopiHostOriginFromPostMessage=Ke)}switch(Zd.MessageId){case Ta.a.swd:W.a(this.$).Zkf(Zd);break;case Ta.a.lGd:jc.a.ltas(null);break;case Ta.a.Tnc:this.u$i();break;case Ta.a.wwd:this.t$i(Zd)}};this.$=xa;Ic!==U.a.DM&&this.LS(Ic);this.txi();this.Cwi();xa=this.ysi;this.fm(Ta.a.swd,
xa);this.fm(Ta.a.lGd,xa);this.fm(Ta.a.Tnc,xa);this.fm(Ta.a.wwd,xa)}dispose(){this.$=null;super.dispose()}txi(){this.Rn(Ta.a.UKe);this.Rn(Ta.a.swd);this.Rn(Ta.a.Tnc);this.Rn(Ta.a.wwd);this.q3a(Ta.a.lGd);this.Rn(Ta.a.vwd)}Cwi(){this.KS(Ta.a.wtb);this.KS(Ta.a.L1);this.KS("App_CloseTab");this.KS(Ta.a.n_a);this.KS(Ta.a.o_a);this.KS(Ta.a.Onf);this.KS(Ta.a.Qnc);this.KS("App_ModifyURLState")}u$i(){const xa={};xa.hostMessageReceived=(new Date).getTime();x.ULS.sendTraceTag(537162883,0,50,"EwaHostMessenger.OnHostUnload");
n.AFrameworkApplication.msc=!0;xa.appUnloadStart=(new Date).getTime();xa.sendBeaconFlight=n.AFrameworkApplication.da.pa("SendBeaconOnShuttingDownRequestsEnabled");xa.sendBeaconSupported=sc.a.aia();sc.a.aFe();xa.appUnloadEnd=(new Date).getTime();xa.appMessageSent=(new Date).getTime();this.sendMessage(Ta.a.v3g,xa)}t$i(xa){x.ULS.sendTraceTag(537162882,0,50,"EwaHostMessenger.OnHostSwitchMode");xa.Values&&ib.a.xKd in xa.Values&&Na.a.equals(xa.Values[ib.a.xKd],bc.a.edit,!0)&&!this.$.isEditMode&&(x.ULS.sendTraceTag(537162881,
0,50,`EwaHostMessenger.OnHostSwitchMode: Switching to ${xa.Values[ib.a.xKd]}`),xa=new Fa.a(-8805455,0,1,0,null),this.$.Ha.Ad(xa))}}Object(v.a)(za,"EwaHostMessenger",ec.a,[748,268,5]);class ua extends gc.a{constructor(xa){super();this.eQe=!1;this.$=xa;this.je()}create(){const xa=this.$.ga,wa=wb.a.instance;if(!this.eQe){this.eQe=!0;let Ic;Ic=Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?this.$.xa.DocumentHostInfo.PostMessageOrigin||U.a.DM:n.AFrameworkApplication.RQd||
U.a.DM;wa.register(za,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").Ee().Le(()=>new za(this.$,window.parent,Ic,n.AFrameworkApplication.da.pa("HostSendReadyToAcceptPostMessage")))}this.Ld(xa.Da(21)||xa.Qa(21,wa.resolve("Postmessage.IHostPostmessenger")))}}Object(v.a)(ua,"HostMessengerFactory",gc.a,[]);var $a=a(118),Va=a(176),hb=a(712),qb=a(563),Nb=a(83),yb=a(142),ja=a(48),Ka=a(281),Pb=a(333),rc=a(332),$c=a(440),Dd=a(6),Jd=a(55),Kd=a(77);class ce{constructor(xa,
wa,Ic){this.correlations=this.properties=this.operation=null;this.operation=xa;this.properties=wa;this.correlations=Ic}static gTh(xa,wa,Ic){const Zd={},Ke=Jd.b();switch(xa.command){case -1537138325:Zd.Action=wa.LabelText;break;case -1104934572:Zd.PrevTab=Ke.zl(parseInt(wa.OldContextCommand,10));Zd.NextTab=Ke.zl(parseInt(wa.NewContextCommand,10));break;case 802602464:Zd.Origin=wa[Dd.a.SH];break;case -1027730316:case -1059615499:Zd.MenuType=wa.launcherId;break;case -236759591:case 1650812936:case 1970784898:case 1378078823:case -400966242:case 467002767:"SqmControlId"in
wa&&(Zd.SqmControlId=wa.SqmControlId);break;case 1371713064:case 875133075:Kd.a.We in wa&&(Zd.SampleTableId=wa[Kd.a.We])}Zd.InputMethod=Pb.a[xa.method];Zd.Location=rc.a[xa.Tg];Zd.Mode=$c.a[xa.mode];Zd.ParentName=xa.tabName;Zd.IsSystemInitiated="IsSystemInitiated"in wa?wa.IsSystemInitiated:!1;Zd.NoReporting="NoReporting"in wa?wa.NoReporting:!1;"ControlIdToLog"in wa&&(Zd.ControlId=wa.ControlIdToLog);"TerminalParentControlIdToLog"in wa&&(Zd.TerminalParentControlId=wa.TerminalParentControlIdToLog);for(const Te of Object.keys(Ic))Zd[Te]=
Ic[Te];return Zd}}Object(v.a)(ce,"InteractivityRecord",null,[]);class ge extends ce{constructor(xa,wa,Ic){super(xa.operation,xa.properties,xa.correlations);this.timeFromNavigationStart=this.timeFromAppInteractive=0;this.timeFromAppInteractive=wa;this.timeFromNavigationStart=Ic}}Object(v.a)(ge,"FirstUserInteractivityRecord",ce,[]);var uc=a(661);class dd{constructor(){this.commandSurface=this.triggerMethod=$a.a.Tlb}static uwi(){dd.U8a||(dd.U8a=new uc.a(qb.a.Fh()),dd.U8a.add("InputMethod"),dd.U8a.add("Location"),
dd.U8a.add("Mode"))}}dd.U8a=null;Object(v.a)(dd,"ExcelUserAction",null,[]);var Rd=a(223),Yd=a(49),Md=a(439),ad=a(153),Mb=a(137),Aa=a(15);class Bc extends Nb.a{constructor(xa){super();this.Aqf=0;this.d8e=!1;this.WEd=Array(Bc.keb);this.Mdc=0;this.$=xa;this.Txf=Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:3683664_AddTelemetryForNonCommandActions");$a.a.Nci();this.Efa={};Bc.C6b||(Bc.C6b=new hb.a(qb.a.Fh()),Bc.Evi(Bc.C6b));dd.uwi();if(Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback"))for(xa=
0;xa<Bc.keb;xa++)this.WEd[xa]="NA"}dispose(){this.$=this.Efa=null;super.dispose()}p8f(xa,wa,Ic){const Zd=Jd.b().zl(xa.command),Ke=JSON.stringify(xa);Zd||x.ULS.sendTraceTag(537155555,3,50,`InteractivityLogger.ReportCommand: command name is null or empty. commandName: ${Zd}, command: ${xa.command}, commandInfo: ${Ke}`);wa=ce.gTh(xa,wa,Ic);Ic=!!wa&&(!("IsSystemInitiated"in wa)||!wa.IsSystemInitiated);this.$&&this.$.ea.nh&&Ic&&Lb.a.instance.n3f("OtelUserAction",new Md.a(Zd,xa.tabName,Date.now()));this.D8f(Zd,
wa,null,!0,!0)}nf(xa,wa,Ic,Zd){this.D8f(xa,wa,void 0===Ic?null:Ic,!1,void 0===Zd?!1:Zd)}eJc(xa){if(this.Efa){++this.Aqf;this.Efa[xa]||(this.Efa[xa]=[]);var wa=this.Aqf.toString();this.Efa[xa].push(wa);x.ULS.sendTraceTag(537155553,0,50,`StartInteractivityCorrellation - '${xa}', correlation=${wa}`)}else x.ULS.shipAssertTag(537155554,0,!1,`StartInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${xa}] == null`)}qJc(xa){if(this.Efa&&this.Efa[xa]){var wa=this.Efa[xa],
Ic=wa.pop().toString();wa.length||delete this.Efa[xa];x.ULS.sendTraceTag(537155551,0,50,`StopInteractivityCorrellation - '${xa}', correlation=${Ic}`)}else x.ULS.shipAssertTag(537155552,0,!1,`StopInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${xa}] == null`)}sT(xa,wa,Ic){Ic=void 0===Ic?!1:Ic;return Ka.b(Zd=>{this.nf(xa,Zd(),void 0,Ic)},Bc.y9j,this.ka,ja.a.rzi,!1,!wa)}XWd(){let xa="";for(let wa=0;wa<Bc.keb;wa++)xa+=this.WEd[(this.Mdc+Bc.keb-wa-1)%Bc.keb]+
",";x.ULS.sendTraceTag(557188890,0,15,`Last operations ${xa}`)}Cik(xa){xa&&(this.WEd[this.Mdc]=xa,this.Mdc=(this.Mdc+1)%Bc.keb)}OSi(xa,wa,Ic){n.AFrameworkApplication.xgc();const Zd=xa.operation,Ke=xa.properties;void 0!==Ic?void Mb.a.resolve(Aa.dc,{Ja:0}).then(Te=>{Te.Dvj(Zd,Ke,Ic)}):this.zek(xa);this.Aek(xa);this.$hj(wa,Ke,Zd)}zek(xa){this.D2j(xa)||(this.d8e=!0,xa=new ge(xa,Yd.PageLoadTrackingInfo.instance.foa(new Date),Yd.PageLoadTrackingInfo.FA()),xa=Sys.Serialization.JavaScriptSerializer.serialize(xa),
x.ULS.sendTraceTag(458261331,0,50,`${xa}`))}D2j(xa){const wa=xa.properties;xa=xa.operation;return this.d8e||void 0===xa||null===xa||xa===yb.a.U3c||xa===yb.a.m_d||xa===yb.a.qRd||sc.a.hCd(xa)||!!wa&&"IsSystemInitiated"in wa&&wa.IsSystemInitiated}Aek(xa){Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&this.Cik(xa.operation);xa=Sys.Serialization.JavaScriptSerializer.serialize(xa);x.ULS.sendTraceTag(21542793,0,50,`${xa}`)}$hj(xa,wa,Ic){$a.a.Epa()&&(wa?"NoReporting"in
wa&&wa.NoReporting||"IsSystemInitiated"in wa&&wa.IsSystemInitiated||!xa&&!this.Txf||((xa=$a.a.$k(wa,Bc.C6b,dd.U8a))?(wa=Bc.oTh(wa))?Va.a.sendUserActionEvent($a.a.tdc(Ic,null,wa.triggerMethod,wa.commandSurface,xa)):x.ULS.sendTraceTag(537155550,0,50,"user action was null"):x.ULS.sendTraceTag(537155549,0,15,"OtelUtils.DictionaryToDataFields returned null")):x.ULS.sendTraceTag(537155548,0,50,`Not logging action telemetry because adction data was null, actionName: ${Ic}`))}D8f(xa,wa,Ic,Zd,Ke){const Te=
Rd.a(this.$);if(this.Txf){let Ef=null;Na.a.equals(xa,yb.a.HFc,!0)&&wa&&"InputMethod"in wa&&(Ef=yb.a.f9e(xa,wa.InputMethod));Te.bSb(Ef||xa,Ic)}else Na.a.equals(xa,yb.a.HFc,!0)&&wa&&"InputMethod"in wa&&(xa=yb.a.f9e(xa,wa.InputMethod)),Te.bSb(xa,Ic);wa&&(wa.IsCommand=Zd);let If="ActionRelativeTime"in wa?wa.ActionRelativeTime:Yd.PageLoadTrackingInfo.FA();Object(ad.c)(()=>{const Ef=new ce(xa,wa,this.Efa);this.OSi(Ef,Ke,If)},this.$.ka,50)}static oTh(xa){if(!xa)return null;const wa=new dd;"InputMethod"in
xa&&(wa.triggerMethod=xa.InputMethod);"Location"in xa&&(wa.commandSurface=xa.Location);return wa}static Evi(xa){xa?(xa.add("Origin",2),xa.add("InputMethod",2),xa.add("ButtonType",2),xa.add("selectedRange",2),xa.add("SelectedRanges",2),xa.add("editRange",2),xa.add("Location",2),xa.add("Mode",2),xa.add("CurrentSelectionMode",2),xa.add("Action",2),xa.add("type",2),xa.add("floatingObjectType",2),xa.add("PrevTab",2),xa.add("NextTab",2),xa.add("DialogName",2),xa.add("dx",3),xa.add("dy",3),xa.add("NumberOfSelectedRanges",
3),xa.add("IsCommand",1),xa.add("IsInFormulaBarEdit",1),xa.add("isLink",1),xa.add("isSheetRef",1),xa.add("isEmptyText",1),xa.add("isFormula",1),xa.add("IsResizingHiddenHeader",1)):x.ULS.sendTraceTag(537155547,0,15,"InitTypeSpecifier was passed in a null dictionary")}}Bc.y9j=1E3;Bc.keb=40;Bc.C6b=null;Object(v.a)(Bc,"InteractivityLogger",Nb.a,[15]);var Vc=a(2);class hc{constructor(){this.appInfoProperties=this.appState=null}}Object(v.a)(hc,"CurrentAppInfo",null,[]);const xc=new Map;[{name:"keyboard_selection",
actions:new Set("move_down move_left move_right move_up extend_down extend_left extend_right extend_up cell_text_move_down cell_text_move_left cell_text_move_right cell_text_move_up cell_text_extend_down cell_text_extend_left cell_text_extend_right cell_text_extend_up formulaBar_extend_left formulaBar_extend_right formulaBar_extend_down formulaBar_extend_up formulaBar_move_right formulaBar_move_down formulaBar_move_left formulaBar_move_up commit_down commit_right formulaBar_commit_down formulaBar_commit_right cell_text_commit_right cell_text_commit_down".split(" "))},
{name:"cell_edit",actions:new Set("commit_down_end_edit commit_right_end_edit formulaBar_commit_down_end_edit formulaBar_commit_right_end_edit cell_text_commit_down_end_edit cell_text_commit_right_end_edit cell_text_edit_end cell_text_edit_type cell_text_edit_typing cell_text_start_edit cell_text_start_edit_replace formulaBar_start_edit_replace formulaBar_start_edit formulaBar_end_edit_ok_cancel_btn cell_text_end_edit_ok_cancel_btn formulaBar_end_edit_sheet_changed cell_text_end_edit_sheet_changed move_down_end_edit move_left_end_edit move_right_end_edit move_up_end_edit extend_down_end_edit extend_left_end_edit extend_right_end_edit extend_up_end_edit cell_text_move_down_end_edit cell_text_move_left_end_edit cell_text_move_right_end_edit cell_text_move_up_end_edit cell_text_extend_down_end_edit cell_text_extend_left_end_edit cell_text_extend_right_end_edit cell_text_extend_up_end_edit cell_text_active_cell_selection_change_entire_row_end_edit formulaBar_active_cell_selection_change_entire_row_end_edit cell_text_active_cell_selection_change_entire_column_end_edit formulaBar_active_cell_selection_change_entire_column_end_edit cell_text_active_cell_selection_change_right_click_end_edit formulaBar_active_cell_selection_change_right_click_end_edit cell_text_active_cell_selection_change_end_edit formulaBar_active_cell_selection_change_end_edit formulaBar_edit_type formulaBar_move_left_end_edit formulaBar_move_down_end_edit formulaBar_extend_left_end_edit formulaBar_move_right_end_edit formulaBar_move_up_end_edit formulaBar_extend_up_end_edit formulaBar_extend_right_end_edit formulaBar_extend_down_end_edit".split(" "))},
{name:"active_cell_selection",actions:new Set("cell_text_active_cell_selection_change_entire_row formulaBar_active_cell_selection_change_entire_row cell_text_active_cell_selection_change_entire_column formulaBar_active_cell_selection_change_entire_column cell_text_active_cell_selection_change_right_click formulaBar_active_cell_selection_change_right_click cell_text_active_cell_selection_change formulaBar_active_cell_selection_change".split(" "))},{name:"headers",actions:new Set(["header_resize_start",
"header_resize_autofit"])}].forEach(xa=>{xa.actions.forEach(wa=>{xc.set(wa,xa.name)})});class ab{constructor(){this.value=this.key=null}}Object(v.a)(ab,"AppInfoProperty",null,[]);class Wb{constructor(xa){this.$=xa}getAppState(){const xa=Yd.PageLoadTrackingInfo.instance.foa(new Date);return-1===xa?"boot":3E4>xa?"postboot":"steady"}isChangeGateEnabled(xa){return Ha.EwaSettings.isChangeGateEnabled(xa)}getBooleanFeatureGate(xa,wa){return Ha.EwaSettings.getBooleanFeatureGate(xa,wa)}getCurrentAppInfo(){return Object(Vc.a)(new hc,
{appState:this.getAppState(),appInfoProperties:[Object(Vc.a)(new ab,{key:"coauthCount",value:this.$.ea.Vp.length.toString()})]})}sendBeaconTraceTag(xa,wa,Ic,Zd){this.$.sendBeaconTraceTag(xa,wa,Ic,Zd)}getActionBucket(xa){return b(xa)}getAppInfoForReport(){return`${"maxCoauthCount"}: ${this.$.ea.NXi}`}}Object(v.a)(Wb,"InteractivityTrackerCallbacks",null,[726]);class Yc{constructor(){this.events=null;this.durationThresholdInMs=0;this.periodicReport=this.patchTaskScheduling=this.callbacks=null}}Object(v.a)(Yc,
"InteractivityTrackerOptions",null,[]);const Tc=(xa,wa)=>Io(function*(){return Mb.a.resolve(Aa.S,wa).then(Ic=>Ic("interactivity"))});Object(Mb.b)(Aa.Gb,{yt:"singleton"})(xa=>Io(function*(){const wa=yield Mb.a.resolve(Aa.W,xa);yield Tc(wa,xa);const Ic=interactivity.InteractivityTrackerFactoryGlobal.create();return new ed(wa,Ic)}));class ed{constructor(xa,wa){this.S2=void 0===wa?null:wa;ed.Iuf?x.ULS.sendTraceTag(537155545,0,50,"InteractivityTrackerService: instance was already created once. skipping initialization."):
(this.initialize(xa),ed.Iuf=!0)}initialize(xa){x.ULS.sendTraceTag(555360983,0,15,"InteractivityTrackerService: starting InteractivityTracker");Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:8082961_TrackerAndProfilerServicesWithNewInfra")||(this.S2=interactivity.InteractivityTrackerFactoryGlobal.create());if(this.S2){var wa=new Yc;Ha.EwaSettings.KDd()&&ed.OJc.push(La.a.Cda);Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:7457630_addSupportedEventMouseUpAndTouchStart")&&(ed.OJc.push("mouseup"),ed.OJc.push("touchstart"));
wa.events=ed.OJc;wa.durationThresholdInMs=ed.durationThresholdInMs;wa.callbacks=new Wb(xa);wa.patchTaskScheduling=Ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PatchClientTaskScheduling",!1);xa=Ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PeriodicReport",!1);const Ic=Ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PeriodicReportPassiveTest",!1),Zd=Ha.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.PeriodicReportIntervalMs",6E4);if(xa||Ic)wa.periodicReport=
{isPassiveTestEnabled:Ic,intervalMs:Zd};wa=this.S2.start(wa);wa.started?x.ULS.sendTraceTag(537155543,0,50,"InteractivityTrackerService: InteractivityTracker started"):x.ULS.sendTraceTag(537155542,0,15,"InteractivityTrackerService InteractivityTracker start failed: "+wa.failureReason)}else x.ULS.sendTraceTag(537155541,0,15,"InteractivityTrackerService: InteractivityTracker not created")}sGa(xa,wa,Ic){if(this.S2)return this.S2.track(xa,wa,Ic);x.ULS.sendTraceTag(524326924,0,50,`InteractivityTrackerService.TrackInputEventPerf: interactivityTracker not initialized. Discarding userAction: ${wa}`)}nUe(){return this.S2?
this.S2.createActionsRetriever():(x.ULS.sendTraceTag(537155539,0,15,"InteractivityTrackerService.CreateSlowActionsRetriever: interactivityTracker not initialized."),null)}dispose(){this.S2&&(this.S2.stop(),this.S2=null)}addContext(xa,wa,Ic){this.S2?this.S2.addContext(xa,wa,Ic):x.ULS.sendTraceTag(509445952,0,15,"InteractivityTrackerService.addContext: interactivityTracker not initialized.")}}ed.durationThresholdInMs=100;ed.OJc="click mousedown contextmenu keypress keydown dblclick touchend".split(" ");
ed.Iuf=!1;Object(v.a)(ed,"InteractivityTrackerService",null,[347]);var be=a(737);class Fc extends gc.a{constructor(xa){super();this.$=xa;this.je()}create(){Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")?void Mb.a.resolve(Aa.S,{Ja:this.Ta}).then(xa=>xa("interactivity")).then(()=>{Object(be.a)(this.$.ga,443,()=>new ed(this.$))}):this.Ld(Object(be.a)(this.$.ga,443,()=>new ed(this.$)))}static la(xa){xa.ga.Qa(444,new Fc(xa))}}Object(v.a)(Fc,"InteractivityTrackerServiceFactory",
gc.a,[]);var vd=a(38),lb=a(731),Eb=a(96),Hc=a(480),Bd=a(8),he=a(54),je=a(63);class Fd{constructor(xa){this.j3j=xa}getCustomProperties(xa){const wa=new Map;if(xa.hasOwnProperty("startTimeInMs")&&xa.hasOwnProperty("totalExecutionTimeInMs")){const Ic=xa.startTimeInMs;xa=this.j3j.retrieveSlowActionsBetweenTimeRange(Ic,Ic+xa.totalExecutionTimeInMs);wa.set("actions",je.a.He(xa))}return wa}}Object(v.a)(Fd,"CallTreeCustomPropertiesRetriever",null,[733]);class Oc{constructor(){this.customProperties=new Map}addCustomProperty(xa,
wa){this.customProperties.set(xa,wa)}getCustomProperties(){return this.customProperties}}Object(v.a)(Oc,"CustomPropertiesRetriever",null,[730]);class Ad{isFeatureEnabled(xa,wa){return Ha.EwaSettings.getBooleanFeatureGate(xa,wa)}}Object(v.a)(Ad,"ExcelFeatureChecker",null,[732]);class Gb{isProfilingEnabled(){return!0}}Object(v.a)(Gb,"ExcelProfilingFeatureChecker",null,[731]);class Wc{constructor(xa,wa){this.cfj=xa;this.efj=wa}onProfilerEvent(xa){switch(xa.eventId){case 1:this.cfj(Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6144046_KeepOldCollectedActions"));
break;case 0:this.efj();break;default:x.ULS.sendTraceTag(537155529,0,15,`JSCPUIJSCPUProfilerObserver.OnProfilerEvent: got unhandled profilerEventId ${xa.eventId}`)}}}Object(v.a)(Wc,"JSCPUProfilerObserver",null,[729]);class pd{constructor(){this.samplingIntervalInMs=0;this.idleIntervalInMs=this.profilingIntervalInMs=this.maximumNumberOfSamplesToTake=null}}Object(v.a)(pd,"JSCPUProfilerInitOptions",null,[]);class fe{constructor(){this.profilerTraceLoggingChunkSize=this.shouldLogRawProfilerTrace=this.shouldRecordFrameCounts=
this.shouldMakeSerializedCallTreesFullyReconstructible=this.shouldKeepQueryParamsInResourceURLs=this.shouldProcessProfileCapturedWhileUserIsIdle=this.shouldSendProfilesForDeobfuscationImmediately=this.canUseMultipleWebWorkers=this.shouldUseInMemoryLogger=this.featureEnabledChecker=this.deObfuscationRequestQueryParamsRetriever=this.deObfuscationRequestBodyPropertiesRetriever=this.durationThresholdInMsToLogOperationData=this.shouldAlwaysLogOperationsData=this.shouldUseSendBeaconForSendingCallTrees=
this.shouldSendAllCallTreesFromProfileInASingleRequest=this.frameTotalExecutionTimeFilteringThresholdInMs=this.shouldCompressSerializedCallTrees=this.shouldRecordExpandedTimeStamps=this.profilerTraceProcessingWebWorkerSourceURL=this.useMainEventLoopForProfilerTraceProcessing=this.shouldKeepSamplesOutsideOfProfilingInterval=this.shouldProfilingStartInAHiddenDocument=this.shouldProcessProfileCapturedInAHiddenDocument=this.callTreeFilteringThresholdInMs=this.deObfuscationEndpoint=this.ulsInstance=this.buildVersion=
this.appName=null}}Object(v.a)(fe,"JSCPUProfilingPackageInitOptions",null,[]);class le{filter(xa){var wa,Ic,Zd;const Ke=!Yd.PageLoadTrackingInfo.instance.TTSI||(null===(wa=xa.serializedFrames[0])||void 0===wa?void 0:wa.startTimeInMs)<Yd.PageLoadTrackingInfo.instance.mek;wa=(null===(Ic=xa.propertyBag)||void 0===Ic?void 0:Ic.actions)&&"[]"!==xa.propertyBag.actions;xa=0<(null===(Zd=xa.serializedFrames[0])||void 0===Zd?void 0:Zd.totalExecutionTimeInMs);return Ke&&xa||wa}}Object(v.a)(le,"CallTreeCustomFilterer",
null,[728]);let te=class{constructor(xa,wa){this.interactivityTrackerService=this.ang=this.lSd=this.bhb=this.mSd=this.o0f=this.q0f=null;this.Rpj=new Set([1,0]);x.ULS.sendTraceTag(537155528,0,50,"JsSelfProfilerManager.Ctor: creating new JsSelfProfilerManager");this.$=xa;this.interactivityTrackerService=wa;this.pxi();this.oxi();this.qNi=Ha.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingSampleIntervalInMs",16);this.profilingIntervalInMs=Ha.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingWindowDurationInMs",
1E4);this.YQe=Ha.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingIdleIntervalInMs",3E5);this.wij=Ha.EwaSettings.getStringFeatureGate("Microsoft.Office.Excel.ProfilerName","");this.q5j()}dispose(){x.ULS.sendTraceTag(537155527,0,50,"JsSelfProfilerManager.Dispose");Eb.a.Ma(this.ang);this.lSd=this.$=null;this.mSd.clear();this.bhb.clear()}F4j(){const xa=Math.random()*this.YQe;x.ULS.sendTraceTag(537155526,0,50,`JsSelfProfilerManager.Ctor: starting ContinuousSessionProfiler in: ${xa}`);
this.ang=he.a.instance.create(()=>{this.Qff("ExcelOnlineContinuousSessionProfiler",2).start()},xa,ja.a.VVj,!0)}T4j(){x.ULS.sendTraceTag(537155525,0,50,"JsSelfProfilerManager.StartFullSessionProfiler: Starting a new profiler");this.Qff("ExcelOnlineFullSessionProfiler",3).start()}p0f(xa){return this.bhb.has(xa)}q5j(){Ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FullSessionJSProfiler",!1)?this.T4j():this.F4j()}createProfiler(xa,wa,Ic,Zd,Ke,Te){x.ULS.sendTraceTag(537155521,0,50,"JsSelfProfilerManager.CreateProfiler: Creating a new profiler");
const If=new pd;If.samplingIntervalInMs=wa;If.maximumNumberOfSamplesToTake=Ic;If.idleIntervalInMs=Zd;If.profilingIntervalInMs=Ke;return this.Ssh(xa,Te,If)}oxi(){const xa=new Gb,wa=new fe;wa.ulsInstance=new Hc.a;wa.deObfuscationEndpoint="ProfilerReporting.ashx";wa.shouldCompressSerializedCallTrees=!1;wa.shouldKeepSamplesOutsideOfProfilingInterval=!1;wa.shouldSendAllCallTreesFromProfileInASingleRequest=!Ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldSendEachCallTreeIndividuallyFromProfile",
!1);wa.shouldUseSendBeaconForSendingCallTrees=Ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldUseSendBeaconForSendingCallTrees",!1);wa.callTreeFilteringThresholdInMs=Ha.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilerCallTreeFilteringThresholdInMs",1);wa.frameTotalExecutionTimeFilteringThresholdInMs=Ha.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilerFrameTotalExecutionTimeFilteringThresholdInMs",0);wa.shouldRecordFrameCounts=!1;Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:8083064_profilerCounters")&&
(wa.callTreeFilteringThresholdInMs=-1,wa.frameTotalExecutionTimeFilteringThresholdInMs=-1,wa.shouldRecordFrameCounts=!0);wa.deObfuscationRequestQueryParamsRetriever=this.Kph();wa.deObfuscationRequestBodyPropertiesRetriever=this.Jph();wa.featureEnabledChecker=new Ad;wa.useMainEventLoopForProfilerTraceProcessing=!1;wa.profilerTraceProcessingWebWorkerSourceURL=this.$.xa.JSProfilerProcessingWebWorkerJsScriptUrl;wa.shouldProcessProfileCapturedWhileUserIsIdle=Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6144063_ShouldProcessProfileCapturedWhileUserIsIdle");
Ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldLogRawProfilerTrace",!1)&&(wa.shouldLogRawProfilerTrace=!0,wa.profilerTraceLoggingChunkSize=Ha.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.ProfilerTraceLoggingChunkSize",30));this.lSd=this.q0f.retrievePackage(xa,wa).retrieveProfilerFactory()}Kph(){const xa=new Oc;xa.addCustomProperty(Bd.a.V0f,n.AFrameworkApplication.userType);xa.addCustomProperty(n.AFrameworkApplication.Qta,n.AFrameworkApplication.userSessionId);xa.addCustomProperty(Bd.a.HKd,
this.$.xa.SkipAuthentication?Bd.a.bJf:null);xa.addCustomProperty(Bd.a.ISd,this.$.xa.MachineCluster);return xa}Jph(){const xa=new Oc;xa.addCustomProperty("appName","Excel");xa.addCustomProperty("buildVersion",n.AFrameworkApplication.buildVersion);xa.addCustomProperty("shouldUseSourceMaps","true");xa.addCustomProperty("shouldFilterSensitiveResources","true");xa.addCustomProperty("shouldUseJSSelfProfilerSpecificDeobfuscator","false");return xa}Ssh(xa,wa,Ic){const Zd=new Oc;Zd.addCustomProperty("ProfilerName",
xa);this.o0f.set(xa,Zd);wa=this.lSd.createProfiler(wa,Ic,Zd);this.bhb.set(xa,wa);xa=this.jrh(xa);wa.subscribeProfilerObserver(xa,this.Rpj);Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:7875154_ProcessCallStacksWithActionOrBeforeTTSI")&&(xa=new le,wa.subscribeCallTreeCustomFilterer(xa));return wa}jei(xa){return this.p0f(xa)?this.bhb.get(xa):(x.ULS.shipAssertTag(537155520,0,!1,`JsSelfProfilerManager.GetProfiler: Profiler with such name (${xa}) does not exist`),null)}Qff(xa,wa){var Ic=void 0===Ic?null:
Ic;xa=this.wij||xa;if(this.p0f(xa))return this.jei(xa);const Zd=this.qNi;return this.createProfiler(xa,Zd,null!=Ic&&0<Zd?Ic/Zd:2E6,2===wa?this.YQe:null,0===wa?null:this.profilingIntervalInMs,wa)}jrh(xa){var wa=this.interactivityTrackerService;if(wa){const Ic=wa.nUe();if(Ic){wa=this.bhb.get(xa);const Zd=new Fd(Ic);wa.subscribeCallTreeCustomPropertiesRetriever(Zd);wa=new Wc(Ke=>{Ic.startCollectingSlowActions(Ke)},Object(Ua.a)(Ic,Ic.stopCollectingSlowActions,"stopCollectingSlowActions"));this.mSd.set(xa,
wa);return wa}x.ULS.sendTraceTag(537155491,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: CreateSlowActionsRetriever returned null");return null}x.ULS.sendTraceTag(537155490,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: call to InteractivityTracker returned null");return null}pxi(){this.q0f=officeOnlineCpuProfiling.getJSCPUProfilingPackageRetriever();this.o0f=new Map;this.mSd=new Map;this.bhb=new Map}};te=Object(lb.a)([Object(Mb.d)(Aa.Hb),Object(lb.b)(0,Object(Aa.W)()),
Object(lb.b)(1,Object(Aa.Gb)()),Object(lb.b)(2,Object(Aa.Xb)())],te);Object(v.a)(te,"JsSelfProfilerManager",null,[711,5]);var Ce=a(91);class Xb extends gc.a{constructor(xa){super();this.$=xa;this.je()}create(){x.ULS.sendTraceTag(537155489,0,50,"JsSelfProfilerManagerFactory.Create: loading officeOnlineCpuProfiling script");vd.TaskExtensions.za((()=>Ce.d(Mb.a.resolve(Aa.T,{Ja:this.Ta})))(),xa=>{Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:8082961_TrackerAndProfilerServicesWithNewInfra")?void Mb.a.KE(Aa.Gb).then(wa=>
{this.kTe(xa.result,wa)}):this.$.ga.qd(443,wa=>{this.kTe(xa.result,wa)})},this.$.ka,3)}kTe(xa,wa){vd.TaskExtensions.za(Ce.d(xa.zv.loadScript("officeOnlineCpuProfiling")),()=>{const Ic=Object(be.a)(this.$.ga,437,()=>new te(this.$,wa));this.Ld(Ic)},this.$.ka,3)}static la(xa){xa.ga.Qa(438,new Xb(xa))}}Object(v.a)(Xb,"JsSelfProfilerManagerFactory",gc.a,[]);class oc{constructor(){this.order=0;this.componentName=this.name=null;this.timeFromNavigationStart=0}}Object(v.a)(oc,"ActionData",null,[]);class Zc{constructor(){this.hasBlockedActions=
!1;this.blockedActions=[]}}Object(v.a)(Zc,"BlockedEngagementInfo",null,[]);class yd extends oc{constructor(){super();this.inputMethod=null;this.isCommand=!1}}Object(v.a)(yd,"SuccessfulActionData",oc,[]);class Od{constructor(){this.successfulActions=[]}}Object(v.a)(Od,"SuccessfulEngagementInfo",null,[]);var dc=a(46),gd;let wd=gd=class{constructor(xa){this.UOa=new Set;this.pWb=null;this.c8e=this.Aog=!1;this.Tfb=(wa,Ic)=>{this.dwb.hasBlockedActions=!0;wa=this.dwb.blockedActions.length;const Zd=Ic.details?
Ic.actionName+"_"+Ic.details:Ic.actionName;Ic=Object(Vc.a)(new oc,{order:wa+1,name:Zd,componentName:Ic.componentName,timeFromNavigationStart:Ic.timeFromNavigationStart});this.dwb.blockedActions.push(Ic)};this.Lh=()=>{dc.a(this.$).ERb(this.Tfb);this.ERi();this.pWb=he.a.instance.create(()=>{this.jLb()},gd.W6j,ja.a.jLb)};this.De=()=>{this.jLb()};this.XSd=()=>{this.$.Me(2009315810,-1,0,null);this.j3d=!1};this.dwb=new Zc;this.dwb.hasBlockedActions=!1;this.Nkb=new Od;this.GUh();this.$=xa;this.$.ea.Fl(this.Lh);
this.$.gk(this.De);this.Z6j=0;this.j3d=!1;Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")&&(this.yRe=new Promise(wa=>{this.qnh=wa}));dc.a(this.$).c8b(this.Tfb)}dispose(){this.$.ea&&this.$.ea.xo(this.Lh);this.$.Hn(this.De);Eb.a.Ma(this.pWb);this.$=this.pWb=null}Dvj(xa,wa,Ic){if(void 0!==xa&&null!==xa&&wa){var Zd=this.Nkb.successfulActions.length+1,Ke="InputMethod"in wa?wa.InputMethod:"",Te="IsCommand"in wa&&wa.IsCommand;if(this.SLi(xa,wa,Ke,Te)){++this.Z6j===
gd.alk?(this.j3d=!0,this.Ckj=he.a.instance.create(this.XSd,5E3,ja.a.XSd)):this.j3d&&this.Ckj.Es();if(Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")){const If=!Te&&xa;this.c8e||If===yb.a.Kyg||If===yb.a.Lyg||If===yb.a.Hyg||If===yb.a.Iyg||(this.c8e=!0,this.qnh(void 0))}Zd>gd.oGf||(xa=Object(Vc.a)(new yd,{order:Zd,name:xa,componentName:"Location"in wa?wa.Location:"",timeFromNavigationStart:Ic,inputMethod:Ke,isCommand:Te}),this.Nkb.successfulActions.push(xa),
1===Zd?this.xSi():Zd===gd.oGf&&this.jLb())}}}ERi(){x.ULS.sendTraceTag(254546634,0,50,`${Z.c(this.dwb)}`)}xSi(){Yd.PageLoadTrackingInfo.instance.foa(new Date)>gd.RUh?x.ULS.sendTraceTag(537154758,0,50,`First user interaction was filtered: ${Z.c(this.Nkb.successfulActions[0])}`):x.ULS.sendTraceTag(254563592,0,50,`${Z.c(this.Nkb.successfulActions[0])}`)}jLb(){!this.Aog&&this.Nkb.successfulActions.length&&(this.Aog=!0,Eb.a.Ma(this.pWb),this.pWb=null,this.$.sendBeaconTraceTag(254559496,50,!1,Z.c(this.Nkb)))}GUh(){this.UOa.add(yb.a.U3c);
this.UOa.add(yb.a.m_d);this.UOa.add(yb.a.qRd);this.UOa.add(yb.a.KZf);this.UOa.add(yb.a.MZf);this.UOa.add(yb.a.OZf)}SLi(xa,wa,Ic,Zd){Ic=!Ic||"unknown"===Ic;const Ke="IsSystemInitiated"in wa&&wa.IsSystemInitiated;wa="NoReporting"in wa&&wa.NoReporting;const Te=this.UOa.has(xa);xa=Na.a.equals(xa,yb.a.HFc,!0)&&Ic;return!Ke&&!wa&&!Te&&!xa&&!(Zd&&Ic)}};wd.oGf=10;wd.RUh=6E4;wd.W6j=12E4;wd.alk=25;wd=gd=Object(lb.a)([Object(Mb.d)(Aa.dc),Object(lb.b)(0,Object(Aa.W)())],wd);Object(v.a)(wd,"PageLoadEngagementInfo",
null,[]);Object(Mb.b)(Aa.Xb)(()=>Io(function*(){yield Mb.a.resolve(Aa.S,{Ja:0}).then(xa=>xa("officeOnlineCpuProfiling"));return officeOnlineCpuProfiling}));var Ld=a(19);const Xd={MergedCell:"MergedCell",bBg:"ConditionalFormat",Comment:"Comment",Formula:"Formula",AutoFilter:"AutoFilter",PivotFilter:"PivotFilter",PivotTable:"PivotTable",Sparkline:"Sparkline",InCellImage:"InCellImage",QCg:"RichText"};let Ie=class{constructor(xa){this.De=()=>{const wa=JSON.stringify(this.tPe),Ic=JSON.stringify(this.sPe);
x.ULS.sendTraceTag(508929763,0,50,`GridActionTelemetryManager.onWorkBookClosing: {"commandNameToRowColCount": ${wa}}`);x.ULS.sendTraceTag(508826823,0,50,`GridActionTelemetryManager.onWorkBookClosing: {"commandNameToComplexCellInfo": ${Ic}}`)};this.$=xa;this.tPe=[];this.sPe=[];Ha.EwaSettings.hIb()&&this.$.gk(this.De)}dispose(){this.$=null}RAe(xa,wa){this.tPe.push({commandName:wa,rowColCount:xa.toString()})}s4c(xa,wa){if(xa&&0!==xa.length){var Ic=[];const Zd={};for(let Ke of xa)Ke.bCi()&&(xa=c(Ke),
""!==xa&&(Zd[xa]=Zd[xa]?Zd[xa]+1:1));for(let Ke of Object.keys(Zd))Ic.push({cellType:Ke,count:Zd[Ke]});0!==Ic.length&&this.sPe.push({commandName:wa,complexCellTypes:Ic})}}Wze(xa,wa,Ic,Zd){const Ke=Ld.h(this.$);var Te=Ke.ya.Caf();let If=[],Ef=!1;"UnhideColumn"!==xa&&"UnhideRow"!==xa&&"insertColumns"!==xa&&"insertRows"!==xa||(Ef=!0);for(let Xc of Te){{Te=Xc.$f;var ta=Zd,zb=Ic,qc=wa,Kc=Ef;let Sd=null;if(ta&&Te||!Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:7990966_GridActionTelemetryBlockRangeFix"))Kc?
Te.hf(ta)&&(Sd=Te,qc?Sd.top=Sd.bottom-zb+1:Sd.left=Sd.right-zb+1):Te.hf(ta)||(Sd=Te,qc?Sd.bottom=Sd.top+zb-1:Sd.right=Sd.left+zb-1);Te=Sd}Te&&(Te=Ke.ya.h2(Te))&&(If=[...If,...Te])}this.s4c(If,xa+"Cascade")}};Ie=Object(lb.a)([Object(Mb.d)(Aa.tb),Object(lb.b)(0,Object(Aa.W)())],Ie);Object(v.a)(Ie,"GridActionTelemetryManager",null,[460,5]);var We=a(53),jf=a(57),tc=a(144),Qc=a(525),xd=a(39),Gd=a(86),pe=a(430),Dc=a(40),Wa=a(245);class Qb extends Sys.EventArgs{constructor(xa){super();this.PH=xa}}Object(v.a)(Qb,
"ErrorDataArgs",Sys.EventArgs,[]);var Lc=a(667),Ba=a(120),qa=a(33);class gb{constructor(xa,wa){this.x_b=null;this.gec=this.nwd=!1;this.vue=this.wue=null;this.mab=this.lab=0;this.tcg=xa;this.Gre=wa}get VWf(){return this.Gre}get iTb(){return this.wue}get scg(){return this.vue}get oNi(){return this.KKe(this.tcg.getTime())}get Sij(){return this.KKe(this.scg.getTime())}get Wig(){return!(this.gec||void 0===window.bsqmXLSPageLoadStartTime)}get jbd(){try{return this.x_b||(this.x_b=Ba.toUtc(window.bsqmXLSPageLoadStartTime)),
this.x_b}catch(xa){return null}}set jbd(xa){this.x_b=xa}sTj(xa){this.gec||(this.wue=xa,this.vue=Ba.toUtc(this.iTb))}Esi(xa){if(xa.Values&&(!this.lab||!this.mab))try{ib.a.Tnf in xa.Values&&(this.lab=parseInt(xa.Values[ib.a.Tnf].toString(),10));ib.a.Unf in xa.Values&&(this.mab=parseInt(xa.Values[ib.a.Unf].toString(),10));const wa=M.a.instance;0<this.lab&&(this.VCf(this.lab,"PageLoadFromHostClick"),wa.Fvj(this.lab));0<this.mab&&(this.VCf(this.mab,"PageLoadFromHostFrameCreation"),wa.Gvj(this.mab));const Ic=
xa.Values[ib.a.Hsi]||0,Zd=xa.Values[ib.a.Fsi]||xa.Values[ib.a.Gsi]||0;0<Zd&&wa.mvj(Zd);wa.nvj(Ic)}catch(wa){}}CGj(){this.tcg=this.jbd=qa.a.$b.ke;this.Gre=0;this.nwd=this.gec=!1}KKe(xa){const wa=this.jbd.getTime();return wa>=xa?0:xa-wa+this.VWf}VCf(xa,wa){if(xa){const Ic=Jd.b();Ic.gJc("UserAction",wa,wa,qa.a.oId(xa),Lc.EcmaDateClock.instance.appStart);Ic.tgc(wa,Ba.toTimestamp(this.iTb))}}}Object(v.a)(gb,"PageLoadPerfInfo",null,[]);var Bb=a(75);class ic{constructor(xa,wa,Ic){this.s1c=xa.keyCode;this.XTb(xa.ctrlKey,
1);this.XTb(xa.shiftKey,2);this.XTb(xa.altKey,4);this.XTb(Bb.b(xa),8);this.XTb(Ic,16);this.s1c=this.Bkb|wa<<24}get Bkb(){return this.s1c}get keyCode(){return this.Bkb&65535}XTb(xa,wa){xa&&(this.s1c=this.Bkb|wa<<16)}}Object(v.a)(ic,"ShortcutSqmData",null,[]);class Cc{constructor(){this.qHd=null;this.ijh={["0"]:0,["1"]:1,["2"]:2,["4"]:3,["8"]:4,["16"]:5,["32"]:6};this.R9f()}heh(xa,wa,Ic){0===Ic&&(Ic=this.ijh[wa.toString()]);return Cc.Vig(xa,Ic)&&(xa=new ic(xa,Ic,z.a.isMac),!Dc.a.Li(this.qHd,xa.Bkb.toString()))?
(this.qHd[xa.Bkb.toString()]=!0,xa):null}R9f(){this.qHd={}}static cFi(xa){return 112<=xa&&123>=xa||61440<=xa&&61451>=xa}static DGi(xa){return 17!==xa&&18!==xa&&16!==xa&&91!==xa&&93!==xa}static Vig(xa,wa){let Ic=xa.ctrlKey||xa.altKey||Bb.b(xa);xa=xa.keyCode;Ic=Cc.cFi(xa)||Ic;Ic=Cc.DGi(xa)&&Ic;return 0!==wa&&Ic}}Object(v.a)(Cc,"UnhandledShortcutLogger",null,[]);class hd{constructor(xa){this.Lbc=[];this.u3g=null;this.sqmManager=xa}h7b(xa){this.Lbc.push(xa)}r3(xa,wa,Ic){try{if(wa)wa.endTime=Ic,this.sqmManager.Vze(wa);
else for(let Zd=0,Ke=this.Lbc.length;Zd<Ke;Zd++){const Te=this.Lbc[Zd];xa?(Te.endTime=Te.startTime,Te.uPe=0):Te.endTime=Ic;this.sqmManager.Vze(Te)}}catch(Zd){}finally{this.Lbc.length=0}}}Object(v.a)(hd,"UserInteractionPerfInfo",null,[]);var Pd=a(37),ue=a(76),Ee=a(241);class Se extends Nb.a{constructor(xa,wa){super();this.bvd=this.fSb=!1;this.Zig=!0;this.Ua=new xd.a;this.VRc=!1;this.De=()=>{const Ic=ue.a(this.$).rf.activityState,Zd=Dc.a.Li(Ic,Pd.a.zze);Dc.a.Li(Ic,Pd.a.Ptb)||Zd||this.upload()};this.$=
xa;this.uDb=wa;this.ea=xa.ea;this.$.gk(this.De);this.Etg=new Cc;this.YUa=new gb(sc.a.wZd,xa.xa.PageGenerationMetrics.TimeToCompleteFirstFlush);this.kNc=new hd(this)}n5c(xa){this.Ua.addHandler("EREK",xa)}IVd(xa){this.Ua.removeHandler("EREK",xa)}get wvh(){return this.VRc}get czi(){return this.$.frame.BU?Bd.a.ezi:Bd.a.dzi}get workbookContext(){return this.$.workbookContext}get mX(){Se.qnb||(Se.qnb=this.h0e());Se.o9c||(Se.o9c=!0,this.Gpf());return Se.qnb}set mX(xa){Se.qnb=xa;Se.qnb||(Se.o9c=!1)}get Z6(){return Gd.a(this.$.xa,
3)}dispose(){this.wvh&&n.AFrameworkApplication.Jn&&n.AFrameworkApplication.Jn.disable();this.$&&this.$.Hn(this.De);this.$=this.kNc=this.YUa=this.mX=null;super.dispose()}Zkf(xa){this.YUa.Esi(xa);this.ESi()}$_d(xa){this.setDw(9415,xa)}h7b(xa){this.kNc.h7b(xa)}r3(xa,wa,Ic){this.kNc.r3(xa,wa,Ic)}NGd(xa){this.Z6&&(xa=this.$.isEditMode||xa&&this.ea.workbookContext.Options&512?2:this.ea.te.inEmbedView?14:1,this.setDw(8721,xa),this.LWh(xa),this.VRc=!1)}kDf(){const xa=this.YUa;this.Z6&&xa.Wig&&(this.setDw(9450,
xa.VWf),this.setDw(9085,xa.oNi))}lDf(xa){if(!this.fSb){this.fSb=!0;const wa=this.YUa;let Ic=0;this.Z6&&wa.Wig?(wa.sTj(xa),this.kNc.u3g=wa.scg,this.setDw(9086,wa.Sij),wa.gec=!0,Ic=this.YUa.iTb.getTime()):Ic=xa.getTime();vd.TaskExtensions.za(this.uDb.value,Zd=>{Zd.result.sendMessage(Ta.a.p3g,{[ib.a.q3g]:Ic})},this.ka,3)}}Vze(xa){this.Z6&&xa&&1!==xa.uia&&this.ala(8327,Wa.b(xa),Wa.l(xa),Wa.a(xa),2,xa.uPe,Wa.m(xa),Wa.d(xa),Wa.e(xa))}TWd(xa,wa){xa&&xa.MessageIdHash&&this.SWd(xa.MessageIdHash,xa.MessageIdName,
xa.MessageId,xa.ErrorCause?xa.ErrorCause:jf.a.ILc,!1,wa,xa,null)}SWd(xa,wa,Ic,Zd,Ke,Te,If,Ef){Se.appEncounteredFirstError||(Se.appEncounteredFirstError=!0,tc.a.get_instance().isCompleted(13)||(tc.a.get_instance().nv(13),x.ULS.sendTraceTag(537151323,0,50,"App encountered its first error so updating app init status")));xa=this.n8a(xa);const ta=!!If,zb={};zb.ErrorName=wa;zb.ErrorHashCode=xa.toString();zb.ErrorId=Ic.toString();zb.ErrorCause=Zd.toString();zb.ErrorType=0===Te?"ErrorDialog":"BusinessBar";
zb.BusinessBarEntryName=Ef||"null";zb.ServerCorrelationId=ta?If.CorrelationId:"null";zb.WebMethodName=ta?If.WebMethodName:"null";zb.SessionHostingEcs=this.ea.workbookContext?this.ea.workbookContext.EcsServerName:"null";zb.WfeServerId=ta?If.WfeServerId:"null";wa=je.a.He(zb);this.Ua.raiseEvent("EREK",new Qb(zb));x.ULS.sendTraceTag(1881314,0,15,wa);this.Z6&&(la.a.q3f(xa.toString()),this.ala(9134,xa,Zd,jf.a.I9d),this.ea.fy||Ke||(this.setDw(10459,xa),this.NGd(!0),this.bvd=!0,this.upload(),this.Gpf()))}n8a(xa){return 5439488|
(xa>>>16^xa&65535)&65535}jHd(xa,wa,Ic){xa=this.Etg.heh(xa,wa,Ic);this.Z6&&xa&&this.ala(11007,xa.Bkb)}upload(){!this.Z6||!this.fSb&&!this.bvd||z.a.vh&&n.AFrameworkApplication.Di?z.a.vh&&n.AFrameworkApplication.Di&&x.ULS.sendTraceTag(537151320,0,15,"SqmManager.Upload: skipped UploadWsaData"):(this.mX.qYb(),this.VRc=!0);n.AFrameworkApplication.Jn=this.mX=null;this.YUa.CGj();this.fSb=!1;n.AFrameworkApplication.Jn=this.mX=this.h0e();this.Etg.R9f()}ESi(){const xa=this.YUa;if(this.Z6&&!xa.nwd){var wa=xa.lab,
Ic=xa.mab,Zd=xa.iTb.getTime();n.AFrameworkApplication.PP=xa.iTb;wa&&this.setDw(10324,wa>Zd?0:Zd-wa);Ic&&this.setDw(10325,Ic>Zd?0:Zd-Ic);xa.nwd=!0}}ala(xa,...wa){this.Z6&&this.mX.ala(xa,...wa)}setDw(xa,wa){this.Z6&&this.mX.setDw(xa,wa)}h0e(){pe.a.E0e(this.$.xa);return n.AFrameworkApplication.Jn}LWh(xa){let wa;try{wa=Object(S.a)(Object,je.a.Fk(n.AFrameworkApplication.da.appSettings.SessionStartInfoJson))}catch(Ic){x.ULS.sendTraceTag(537151311,0,15,`Couldn't parse SessionStartInfoJson. Message: ${Ic.message}`);
return}if(wa){let Ic=Object(S.a)(String,wa.ApplicationModeExtended),Zd=Object(S.a)(String,wa.ApplicationMode);Ic&&Zd&&(Ic=Ic.toUpperCase(),2!==xa&&16!==xa||"VIEW"!==Ic&&"UNIFIED"!==Ic?1!==xa||"EDIT"!==Ic&&"UNIFIED"!==Ic||(Ic="VIEW",Zd="View"):(Ic="EDIT",Zd="Edit"),wa.ApplicationModeExtended=Ic,wa.ApplicationMode=Zd,n.AFrameworkApplication.da.appSettings.SessionStartInfoJson=je.a.He(wa))}}Gpf(){const xa=this.$.xa;this.mX.zQ=!0;this.mX.RZa(xa.BWsaStartTime);this.setDw(59,83);this.fSb=!1;if(this.Z6){const wa=
xa.DocumentHostInfo;this.fuh();this.setDw(8491,this.$.GG);this.setDw(9236,xa.RequestedUILcid);this.setDw(8473,xa.WacHostId);this.setDw(9902,Wa.c(wa.ClusterId));Ha.EwaSettings.Ea(398)?this.mX.sfg(""):this.mX.sfg(xa.FlightHolder?xa.FlightHolder.FlightId:"");this.$_d(this.ea.te.inEmbedView?1:0);this.bvd=!1;this.setDw(9104,Wa.c(wa.FileSourceId));this.setDw(10309,this.czi);this.mVj();n.AFrameworkApplication.Dd.DUd(Qc.a.getInstance(!1))}}mVj(){M.a.instance.Kvi(this.mX);if(this.Zig){const xa=M.a.instance;
xa.ivj();xa.Avj();xa.yvj();xa.xvj();xa.svj();this.Zig=!1}}fuh(){this.createStream(8327,1,Ee.a.oxh,Ee.a.o7a);this.createStream(9134,1,3,Ee.a.o7a);this.createStream(11007,1,1,Ee.a.o7a)}createStream(xa,wa,Ic,Zd){this.mX.createStream(xa,wa,Ic,Zd)}}Se.qnb=null;Se.o9c=!1;Se.appEncounteredFirstError=!1;Object(v.a)(Se,"SqmManager",Nb.a,[189,486]);var cf=a(769);class mf{constructor(xa,wa){this.entryTypes=null;this.buffered=!1;this.entryTypes=xa;this.buffered=void 0===wa?!1:wa}}Object(v.a)(mf,"PerformanceObserverInit",
null,[]);class ac extends Sys.EventArgs{constructor(xa){super();this.H0e=xa}}Object(v.a)(ac,"LongTaskObservedEventArgs",Sys.EventArgs,[]);class bd extends Sys.EventArgs{constructor(xa){super();this.Goc=xa}}Object(v.a)(bd,"LongTaskPerformanceObserverInitializedEventArgs",Sys.EventArgs,[]);class nd{constructor(xa){this.Ua=new xd.a;this.kVc=!1;this.Lh=()=>{if(z.a.Sp){try{void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&((new PerformanceObserver(this.KUi)).observe(new mf([Bd.a.uHd])),
this.kVc=!0)}catch(wa){this.kVc=!1,x.ULS.sendTraceTag(537153885,0,10,`Exception related to PerformanceObserver: ${wa}`)}this.Ua.raiseEvent("ltpoiek",new bd(this.Goc))}};this.KUi=wa=>{this.Ua.raiseEvent("ltoek",new ac(wa))};this.$=xa;this.$.ea.nh?this.Lh(this,Sys.EventArgs.Empty):this.$.ea.Fl(this.Lh)}get Goc(){return this.kVc}pCe(xa){this.Ua.addHandler("ltoek",xa)}XBj(xa){this.Ua.removeHandler("ltoek",xa)}k_g(xa){this.Ua.addHandler("ltpoiek",xa)}YBj(xa){this.Ua.removeHandler("ltpoiek",xa)}dispose(){this.$.ea.xo(this.Lh);
Eb.a.Ma(this.Ua);this.$=this.Ua=null}}Object(v.a)(nd,"LongTaskPerformanceObserver",null,[5]);var se=a(161);class Ge{constructor(xa,wa){this.longTaskDuration=this.activeSessionDuration=0;this.activeSessionDuration=void 0===xa?0:xa;this.longTaskDuration=void 0===wa?0:wa}get xHd(){return this.activeSessionDuration?this.longTaskDuration/this.activeSessionDuration:0}oMi(xa){return 100*this.xHd>xa}HXg(xa){this.iBe(xa.longTaskDuration);this.Z4c(xa.activeSessionDuration)}iBe(xa){this.longTaskDuration+=xa}Z4c(xa){this.activeSessionDuration+=
xa}}Object(v.a)(Ge,"LongTaskPerformanceData",null,[]);class Ve{constructor(xa,wa,Ic,Zd,Ke){this.isVetoSession=!1;this.postBootWindowData=this.worstWindowData=this.entireSessionData=null;this.maxUsersCount=0;this.isVetoSession=xa;this.entireSessionData=wa;this.worstWindowData=Ic;this.postBootWindowData=Zd;this.maxUsersCount=Ke}get reportName(){return"LongTaskPerformance"}static get gFh(){return new Ve(!1,new Ge,new Ge,new Ge,0)}}Object(v.a)(Ve,"LongTaskPerformanceDataStatistics",null,[527]);class df extends Sys.EventArgs{constructor(xa){super();
this.vHd=xa}}Object(v.a)(df,"LongTaskTrackedEventArgs",Sys.EventArgs,[]);var pf=a(389),kf=a(302);class Af{constructor(xa,wa){this.Ua=new xd.a;this.XSa=this.h$=this.WV=this.Zf=null;this.Fzf=this.A3d=this.Fsc=!1;this.yTa=null;this.maxUsersCount=0;this.iyc=(Ic,Zd)=>{Ic=Zd.H0e.getEntriesByType(Bd.a.uHd);for(const Ke of Ic)this.Zf.aG(Ke.duration)||n.AFrameworkApplication.ASa||(this.WV.iBe(Ke.duration),this.Ua.raiseEvent("lttek",new df(Ke)),Ic={},Ic.LongTaskDuration=Ke.duration,Ic.LongTaskStartTime=Ke.startTime,
x.ULS.sendTraceTag(187982418,0,50,JSON.stringify(Ic)))};this.Lh=()=>{this.A3d=!0;this.fWb()};this.kE=(Ic,Zd)=>{Zd&&(this.maxUsersCount=Math.max(this.maxUsersCount,Zd.wlk));this.h$.maxUsersCount=this.maxUsersCount};this.wf=()=>{this.fWb()};this.De=()=>{this.iWb()};this.UQf=(Ic,Zd)=>{Zd.Goc&&this.fWb()};this.MDf=()=>{this.WV.Z4c(Ba.getElapsedMilliseconds(this.XSa,qa.a.$b.ke));this.D5d(!0);var Ic=!1;this.h$.postBootWindowData.activeSessionDuration?(!this.Fzf&&Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&
(Jd.b().G8f(2),V.Health.instance.recordKpiUsage(kf.a.longJsTask,0,pf.a.pNi,null),this.Fzf=!0),!this.h$.isVetoSession&&this.WV.oMi(this.wyg)&&(this.h$.isVetoSession=!0,Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(Jd.b().H8f(2,this.IUi),V.Health.instance.recordKpiFailure(kf.a.longJsTask,"SessionVetoedJsLoadTooSlow",!1,!0,null))),this.h$.worstWindowData.xHd<=this.WV.xHd&&(this.h$.worstWindowData=this.WV),this.h$.entireSessionData.HXg(this.WV)):(this.h$.postBootWindowData=
new Ge(this.WV.activeSessionDuration,this.WV.longTaskDuration),Ic=!0);const Zd={};Zd.LastWindowScore=this.WV;Zd.postBootWindow=Ic;Zd.CoauthersNumber=this.$.ea.Vp.length;Ic=JSON.stringify(Zd);x.ULS.sendTraceTag(20779346,0,50,Ic);this.WV=new Ge};this.cxc=()=>{this.Zf.hj||n.AFrameworkApplication.ASa||this.D5d(!1)};this.axc=()=>{this.WV.Z4c(Ba.getElapsedMilliseconds(this.XSa,qa.a.$b.ke));this.XSa=null;this.yTa.cancel()};this.$=xa;this.wyg=xa.xa.LongTaskPerformanceVetoThreshold;this.IUi="PercentageOver_"+
this.wyg.toString();this.wHd=xa.xa.LongTaskPerformanceWindowDurationInMs;this.CQ=wa;Ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Mb.a.resolve(Aa.O).then(Ic=>{this.Zf=Ic;this.fWb()}):this.$.ga.qd(291,Ic=>{this.Zf=Ic;this.fWb()});this.$.ea.nh?this.Lh(this,Sys.EventArgs.Empty):this.$.ea.Fl(this.Lh);this.CQ.k_g(this.UQf);this.$.Zm(this.wf);this.$.gk(this.De)}l_g(xa){this.Ua.addHandler("lttek",xa)}ZBj(xa){this.Ua.removeHandler("lttek",
xa)}dispose(){this.A3d=!1;this.iWb();this.$.co(this.wf);this.$.Hn(this.De);this.CQ.YBj(this.UQf);Eb.a.Ma(this.yTa);this.CQ=this.$=this.yTa=null;void 0!==this.Zf&&null!==this.Zf&&Eb.a.Ma(this.Zf)}fWb(){void 0===this.Zf||null===this.Zf?x.ULS.sendTraceTag(537153884,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but visibilityObserver is not ready yet"):this.CQ.Goc?this.Fsc?x.ULS.sendTraceTag(537153882,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we already tracking"):
this.A3d?(this.Fsc=!0,this.h$=Ve.gFh,this.WV=new Ge,this.$.ea.gda(this.kE),this.maxUsersCount=this.$.ea.Vp.length,this.CQ.pCe(this.iyc),this.Zf.P0(this.axc),this.Zf.YW(this.cxc),n.AFrameworkApplication.e5c(this.axc),n.AFrameworkApplication.f5c(this.cxc),this.yTa=he.a.instance.create(this.MDf,this.wHd,ja.a.$Cf,!1),Rd.a(this.$).VW(this.h$),this.Zf.hj||n.AFrameworkApplication.ASa||this.D5d(!0),x.ULS.sendTraceTag(537153880,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: Start tracking")):x.ULS.sendTraceTag(537153881,
0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we still not ready to start tracking"):x.ULS.sendTraceTag(537153883,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but longTaskPerformanceObserver InitializedSuccessfully")}iWb(){this.Fsc&&(this.Fsc=!1,this.$.ea.xo(this.Lh),this.CQ.XBj(this.iyc),this.$.ea.yaa(this.kE),void 0!==this.Zf&&null!==this.Zf&&(this.Zf.zWa(this.axc),this.Zf.DEa(this.cxc)),n.AFrameworkApplication.q6f(this.axc),
n.AFrameworkApplication.r6f(this.cxc),this.yTa.cancel(),this.XSa=this.WV=this.h$=null,this.maxUsersCount=0)}D5d(xa){xa||void 0===this.XSa||null===this.XSa?(this.XSa=qa.a.$b.ke,this.yTa=se.AsyncMethodContext.Myb(this.MDf,xa?this.wHd:this.wHd-this.WV.activeSessionDuration,ja.a.$Cf,this.yTa)):x.ULS.sendTraceTag(589875356,0,15,"LongTaskPerformanceTracker:StampLastAppAwakeAndDocumentUnhiddenEcmaDateAndRestartTimer lastAppAwakeAndDocumentUnhiddenEcmaDate is not null when resuming a window")}}Object(v.a)(Af,
"LongTaskPerformanceTracker",null,[5]);var eb=a(30);class bb extends xd.a{constructor(xa,wa){super();this.statusBarManager=this.Zf=null;this.VQf=(Ic,Zd)=>{Zd.vHd&&Zd.vHd.duration>=this.LUi&&(this.fEf++,this.dAf=Zd.vHd.duration)};this.$=xa;this.$.ga.qd(29,Ic=>{this.statusBarManager=Ic;Ic.zM(this)});Ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Mb.a.resolve(Aa.O).then(Ic=>{this.Zf=Ic}):this.$.ga.qd(291,Ic=>{this.Zf=Ic});this.dAf=this.fEf=
0;this.LUi=xa.xa.LongTaskThresholdMs;this.Tdb=wa;this.Tdb.l_g(this.VQf)}Xs(xa){this.addHandler("LTSCEK",xa)}Gt(xa){this.removeHandler("LTSCEK",xa)}pC(){this.Up("QueryLongTasksCount")&&this.raiseEvent("LTSCEK")}Ru(xa,wa){if("QueryLongTasksCount"!==xa)return!1;this.Boi(wa);return!0}Up(){return Ha.EwaSettings.Ea(505)}dispose(){this.statusBarManager&&(this.statusBarManager.MI(this),this.statusBarManager=null);this.Tdb.ZBj(this.VQf);super.dispose()}Boi(xa){const wa=`Long Tasks: ${this.fEf} | Last Task Duration: ${Math.round(this.dAf)}ms`;
eb.a.Yn()?(xa.LabelText=wa,xa.Visible=!0):xa.Value=wa}}Object(v.a)(bb,"LongTasksStatusBarManager",xd.a,[5,295,188]);var Rb=a(11);class Q{constructor(){this.rttMs=this.bandwidthMps=0;this.effectiveConnection=this.connectionType=null;this.downlinkMaxMps=0}}Object(v.a)(Q,"NetworkInfoData",null,[]);class Ia extends xd.a{constructor(xa){super();this.statusBarManager=null;this.J4c=!1;this.yJf=()=>{this.raiseEvent("NetworkInformation")};this.$=xa;Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:3539919_AddNetworkInformationTelemetry")&&
(this.mL=this.m9d("connection")||this.m9d("mozConnection")||this.m9d("webkitConnection"))&&Ha.EwaSettings.Ea(410)&&xa.ga.qd(29,wa=>{this.statusBarManager=wa;wa.zM(this);this.mL.addEventListener("change",this.yJf);this.J4c=!0})}Xs(xa){this.addHandler("NetworkInformation",xa)}Gt(xa){this.removeHandler("NetworkInformation",xa)}h$a(){return this.mL?Object(Vc.a)(new Q,{bandwidthMps:this.mL.downlink,rttMs:this.mL.rtt,connectionType:this.mL.type,effectiveConnection:this.mL.effectiveType,downlinkMaxMps:this.mL.downlinkMax}):
null}Ru(xa,wa){if("QueryNetworkInformation"!==xa)return!1;this.Coi(wa);return!0}Up(){return this.J4c}dispose(){this.J4c&&(this.statusBarManager&&(this.statusBarManager.MI(this),this.statusBarManager=null),this.mL&&this.mL.removeEventListener("change",this.yJf));this.$=null;super.dispose()}m9d(xa){return Rb.HelperMethods.Tp(window.navigator,xa)?window.navigator[xa]:null}Coi(xa){const wa="Network: "+this.mL.downlink.toString()+" Mbps, "+this.mL.rtt.toString()+" ms";eb.a.Yn()?(xa.LabelText=wa,xa.Visible=
!0):xa.Value=wa}}Object(v.a)(Ia,"NetworkInformationManager",xd.a,[295,188]);var ub=a(198);class Yb{constructor(xa,wa,Ic,Zd,Ke,Te,If,Ef,ta,zb){this.name=null;this.startToResponseRenderEnd=this.startToNextFrame=this.startTime=0;this.isPartOfGroup=this.isGroupBreaking=this.isUserOperation=this.wasHidden=!1;this.operationThatLedToLogging=null;this.startToOperationThatLedToLogging=0;this.name=void 0===xa?"":xa;this.startTime=void 0===wa?-1:wa;this.startToNextFrame=void 0===Ic?-1:Ic;this.startToResponseRenderEnd=
void 0===Zd?-1:Zd;this.wasHidden=void 0===Ke?!1:Ke;this.isUserOperation=void 0===Te?!0:Te;this.isGroupBreaking=void 0===If?!0:If;this.operationThatLedToLogging=void 0===ta?"":ta;this.startToOperationThatLedToLogging=void 0===zb?-1:zb;this.isPartOfGroup=void 0===Ef?!1:Ef}}Object(v.a)(Yb,"OperationStatisticsData",null,[]);var Ca=a(85);class tb{constructor(){this.operationsGroups=null;this.Zui()}isGroup(xa,wa,Ic){const Zd=new ub.a;Zd.addRange(xa);Zd.addRange(wa);for(let Ke=0;Ke<this.operationsGroups.count;Ke++)if(this.bIi(this.operationsGroups.ma(Ke),
Zd,Ic))return x.ULS.sendTraceTag(595194768,1,50,`OperationsGroupDetector: Operation '${Ic}' is part of a group ( operationsList: ${this.EWf(xa)} , frameOperationsList: ${this.EWf(wa)})`),!0;x.ULS.sendTraceTag(595194767,1,50,`OperationsGroupDetector: Operation '${Ic}' is NOT part of a group.`);return!1}bIi(xa,wa,Ic){let Zd=0;for(let Ke=0;Ke<wa.count;Ke++)if(wa.ma(Ke).isGroupBreaking){if(xa.count<=Zd||!Na.a.equals(wa.ma(Ke).name,xa.ma(Zd),!0))return!1;Zd++}return xa.count>Zd&&Na.a.equals(Ic,xa.ma(Zd),
!0)}EWf(xa){xa=Ca.select(xa,wa=>wa.name);return`[${Ca.toArray(xa).join(", ")}]`}Zui(){this.operationsGroups=new ub.a;this.u3a(new ub.a(["Paste","SelectingRange_unknown"]));this.u3a(new ub.a(["AutoSum","SelectingRange_unknown"]));this.u3a(new ub.a(["ChangeSheetDirection","ActiveItemChanged"]));this.u3a(new ub.a(["InsertSheet","ActiveItemChanged","SelectingRange_unknown"]));this.u3a(new ub.a(["DeleteSheet","DialogButtonClick","ActiveItemChanged","SelectingRange_unknown"]));this.u3a(new ub.a(["EditBoxEndEdit",
"SetCell","SelectingRange_keyboard","MoveDownWithinSelectionOrCommitEdit"]))}u3a(xa){this.operationsGroups.add(xa)}}Object(v.a)(tb,"OperationsGroupDetector",null,[]);var $b=a(27);class cd{constructor(xa,wa,Ic,Zd){this.framePerformanceTracker=this.TRb=this.S3=this.T4=null;this.MEj=()=>{this.K6c=-1;const Ke=Rb.HelperMethods.Nd();this.Xjk(Ke);Ha.EwaSettings.Ea(326)&&(this.oTb&&(x.ULS.sendTraceTag(537153878,1,50,"GroupDetector: Setting current frame operations render duration due to rendering without additional blocks."),
this.fYb(this.FH,Ke),this.oTb=!1),this.Jqc&&(this.fYb(this.sG,Ke),this.oTb||this.fYb(this.FH,Ke)));window.setTimeout(this.CSi,0)};this.CSi=()=>{var Ke=[];const Te=this.$.xa.OperationToPrevOperationThreshold;for(var If=0;If<this.FH.count;If++){var Ef=this.FH.ma(If);If<Te&&Ke.push(Ef);this.sG.add(Ef)}Ld.h(this.$)&&Ld.h(this.$).ya?((If=this.sessionStatisticsManager.vpd(0))?(Ef=JSON.stringify(this.pLb),Ke=JSON.stringify(Ke),x.ULS.sendTraceTag(237798547,1,50,`DOM count: (${If.zYi}, ${If.e7g}, ${If.pXi}), long tasks: ${Ef}, operations count: ${this.FH.count}, operations: ${Ke}`)):
x.ULS.sendTraceTag(537153876,1,50,"Report Manager NumberOfDomElements does not exist"),this.FH.count>Te&&x.ULS.sendTraceTag(537153875,1,50,`More than ${Te} operations are in the operationsList. count: ${this.FH.count}`),this.FH.clear(),this.pLb.clear()):x.ULS.sendTraceTag(537153877,1,10,"Grid == null or BlockManager == null")};this.iyc=(Ke,Te)=>{this.JUi(Te.H0e)};this.$=xa;this.IL=wa;this.zj=this.zj||qa.a.$b;this.sG=new ub.a;this.FH=new ub.a;this.K6c=this.gdb=-1;this.pLb=new ub.a;this.operationsGroupDetector=
new tb;this.oTb=this.Jqc=!1;this.xvi();this.avi();this.$ui();this.sessionStatisticsManager=Ic;this.CQ=Zd;this.CQ.pCe(this.iyc);this.$.ga.qd(263,Ke=>{this.framePerformanceTracker=Ke})}bSb(xa,wa){var Ic=Rb.HelperMethods.Nd();const Zd=Ha.EwaSettings.Ea(326)?this.operationsGroupDetector.isGroup(this.sG,this.FH,xa):!1;this.Jqc=this.Fvf(xa);Ha.EwaSettings.Ea(326)?this.Jqc&&0<this.sG.count&&!Zd&&(this.ajk(),this.dwg(xa,Ic),this.v8e()):0<this.sG.count&&this.Fvf(xa)&&(this.dwg(xa,Ic),this.v8e());this.gdb=
-1;if(Ld.h(this.$)&&Ld.h(this.$).ya){var Ke=!this.T4.contains(xa);Ic=new Yb(xa,Ic,void 0,void 0,void 0,Ke,this.Jqc,Zd);this.FH.add(Ic);this.framePerformanceTracker&&this.framePerformanceTracker.h5j(Ic.name,wa);Ha.EwaSettings.Ea(326)&&!this.oTb&&this.TRb.contains(xa)&&(this.oTb=!0);-1===this.K6c&&(this.K6c=window.requestAnimationFrame(this.MEj))}else x.ULS.sendTraceTag(537153879,1,10,"Grid == null or BlockManager == null")}RDc(){this.gdb=Rb.HelperMethods.Nd()}YDc(){this.sG.count||this.FH.count?(this.fYb(this.FH,
this.gdb),this.fYb(this.sG,this.gdb)):x.ULS.sendTraceTag(0,1,50,`ReportOnBlockCacheConsistant when no operations in the list. Last block render time: ${this.gdb}`);this.gdb=-1}Fvf(xa){return!this.S3.contains(xa)&&!xa.includes("Menu")&&!xa.includes("TellMe")}v8e(){for(let xa=0;xa<this.sG.count;xa++){const wa=this.sG.ma(xa);this.IL.yTg(wa);this.gTi(wa)}this.sG.clear()}Xjk(xa){for(let wa=0;wa<this.FH.count;wa++)this.FH.ma(wa).startToNextFrame=this.Ard(this.FH.ma(wa).startTime,xa),this.FH.ma(wa).wasHidden=
cf.a.aG(this.FH.ma(wa).startToNextFrame)}dwg(xa,wa){for(let Ic=0;Ic<this.sG.count;Ic++)-1===this.sG.ma(Ic).startToResponseRenderEnd&&(this.sG.ma(Ic).operationThatLedToLogging=xa,this.sG.ma(Ic).startToOperationThatLedToLogging=this.Ard(this.sG.ma(Ic).startTime,wa))}ajk(){var xa=!1;for(let wa of this.sG)if(wa.isPartOfGroup){xa=!0;break}if(xa)for(xa=0;xa<this.sG.count;xa++)this.sG.ma(xa).isPartOfGroup=this.sG.ma(xa).isGroupBreaking}fYb(xa,wa){for(let Ic=0;Ic<xa.count;Ic++)xa.ma(Ic).startToResponseRenderEnd=
this.Ard(xa.ma(Ic).startTime,wa),xa.ma(Ic).wasHidden=cf.a.aG(xa.ma(Ic).startToResponseRenderEnd)}gTi(xa){xa=JSON.stringify(xa);x.ULS.sendTraceTag(2020372336,1,50,`${xa}`)}Ard(xa,wa){return-1===xa?-1:-1===wa?-2:wa-xa}JUi(xa){xa=xa.getEntriesByType(Bd.a.uHd);for(let wa=0;wa<xa.length;wa++)if(30>this.pLb.count)if(this.FH.count)this.pLb.add(this.Akj(xa[wa]));else{const Ic=xa[wa];if(null===Ic||void 0===Ic?0:Ic.attribution)void 0!==Ic.attribution.containerSrc&&null!==Ic.attribution.containerSrc&&(Ic.attribution.containerSrc=
""),void 0!==Ic.attribution.containerId&&null!==Ic.attribution.containerId&&(Ic.attribution.containerId=""),void 0!==Ic.attribution.containerName&&null!==Ic.attribution.containerName&&(Ic.attribution.containerName="");x.ULS.sendTraceTag(40777251,1,50,"LongTaskObserverAction: long task occur when operations list was empty.")}else{x.ULS.sendTraceTag(537153874,1,50,`More then ${30} long tasks are in the longTaskList. entries length: ${xa.length} First long task: ${this.pLb.ma(0)}`);break}}Akj(xa){return`name:${xa.name}, startTime:${xa.startTime}, duration:${xa.duration}`}xvi(){this.T4||
(this.T4=new uc.a(qb.a.Fh()),this.T4.add("ActiveItemChanged"),this.T4.add(Jd.b().zl(-1398645260)),this.T4.add(Jd.b().zl(722290388)),this.T4.add(Jd.b().zl(974713501)),this.T4.add($b.a.cU($b.a.Bbc)),this.T4.add($b.a.cU($b.a.Abc)),this.T4.add($b.a.cU($b.a.Jxb)),this.T4.add($b.a.cU($b.a.H0f)),this.T4.add($b.a.cU($b.a.Vra)))}avi(){this.S3||(this.S3=new uc.a(qb.a.Fh()),this.S3.add("PromptEditInBrowser"),this.S3.add(Jd.b().zl(-1398645260)),this.S3.add(Jd.b().zl(722290388)),this.S3.add(Jd.b().zl(974713501)),
this.S3.add($b.a.cU($b.a.Bbc)),this.S3.add($b.a.cU($b.a.Abc)),this.S3.add($b.a.cU($b.a.Jxb)),this.S3.add($b.a.cU($b.a.H0f)),this.S3.add($b.a.cU($b.a.Vra)))}$ui(){this.TRb||(this.TRb=new uc.a(qb.a.Fh()),this.TRb.add("SelectingRange_keyboard"),this.TRb.add("SelectingRange_mouse"))}}Object(v.a)(cd,"OperationStatistics",null,[]);var sd=a(595);class re{constructor(xa,wa){this.messageIdName=null;this.errorCause=0;this.messageIdName=xa;this.errorCause=wa}}Object(v.a)(re,"RequestError",null,[]);class De{constructor(xa,
wa,Ic,Zd,Ke,Te,If,Ef,ta,zb,qc,Kc,Xc,Sd,me,Le,Xe){this.requestName=null;this.isPromotedUTRRequest=this.isFullyLoggedKPIRequest=this.isUserTriggeredRequest=!1;this.TimeFromLastEcsFreeze=this.WfeRequestDuration=this.EcsRequestDuration=this.ecsOperationDuration=this.requestInvokedTime=this.requestTimeInQueue=this.totalOperationDuration=this.requestDuration=0;this.DuringLoadOnDemand=!1;this.errors=this.correlationID=null;this.httpStatus=0;this.requestResourceTiming=null;this.communicationErrorRetryCount=
0;this.isDocumentHidden=this.successfulCall=!1;this.responseSize=this.coauthorsCount=0;this.networkInfoData=null;this.responseToCallbackTime=0;this.requestName=xa;this.isUserTriggeredRequest=De.I$h(xa);this.isFullyLoggedKPIRequest=De.z$h(xa);this.isPromotedUTRRequest=De.B$h(xa);this.requestDuration=wa;this.totalOperationDuration=Ic;this.requestTimeInQueue=Zd;this.requestInvokedTime=Ke;this.ecsOperationDuration=Te.EcsOperationDuration;this.EcsRequestDuration=Te.EcsRequestDuration;this.WfeRequestDuration=
Te.WfeRequestDuration;this.TimeFromLastEcsFreeze=Te.TimeFromLastEcsFreeze;this.DuringLoadOnDemand=Te.DuringLoadOnDemand;this.correlationID=If;this.errors=De.xlh(Ef);this.httpStatus=ta;this.requestResourceTiming=zb;this.communicationErrorRetryCount=qc;this.successfulCall=Kc;this.isDocumentHidden=Xc;this.coauthorsCount=Sd;this.responseSize=me;this.networkInfoData=Le;this.responseToCallbackTime=Xe}static xlh(xa){if(!xa)return[];const wa=[];for(const Ic of xa)wa.push(new re(Ic.MessageIdName,Ic.ErrorCause));
return wa}static I$h(xa){return!De.z0i.contains(xa)}static $bi(){const xa=new uc.a(qb.a.Fh());xa.add("CheckPersistedContentUpdate");xa.add("GetContentBundle");xa.add("GetSessionStatus");xa.add("GetStatusBarAggregates");xa.add("PollSessionStatus");xa.add("UpdatePresenceUsers");xa.add("UploadLatencyTelemetry");return xa}static z$h(xa){return De.kZh.contains(xa)}static B$h(xa){return De.Xpj.contains(xa)}static $8h(){const xa=new uc.a(qb.a.Fh());xa.add("SetRichTextCell");xa.add("Copy");xa.add("FormatCells");
xa.add("PasteRange");xa.add("FindCell");xa.add("ApplyToRangesV2");xa.add("ResizeRowsColumns");xa.add("InsertDeleteCells");xa.add("FillRange");xa.add("PasteHtmlContent");xa.add("ApplyFilter");xa.add("PasteString");xa.add("Undo");xa.add("LineageUpdateView");xa.add("FindAll");xa.add("ApplyHyperlink");xa.add("AutoFit");xa.add("GetPrintSettings");xa.add("GetEdgeCell");xa.add("Paste");xa.add("MoveAndResizeFloatingObject");xa.add("FindRange");xa.add("SetCustomFilter");xa.add("RenameSheet");xa.add("ApplyThreadedComment");
xa.add("SortFilterColumn");xa.add("InsertCopiedCutCells");xa.add("InsertSheet");xa.add("ToggleAutoFilter");xa.add("ReorderSheets");xa.add("SetOutlineLevel");xa.add("RefreshAll");xa.add("LineageOpenPaneOrChangeFilter");xa.add("ApplySlicerSelection");xa.add("GetCardViewCardByCell");xa.add("AutoSum");xa.add("LineageClosePane");xa.add("Sort");xa.add("ClearAutoFilter");xa.add("DeleteSheet");xa.add("Redo");Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5317483_AdditionalOperationsInXlreqKPI")&&(xa.add("RemovePageBreak"),
xa.add("InsertPageBreak"),xa.add("SetPrintArea"),xa.add("ClearPrintArea"));return xa}static C$h(){const xa=new uc.a(qb.a.Fh());xa.add("DeleteConditionalFormattingRules");xa.add("GetConditionalFormattingRules");xa.add("AddConditionalFormattingRule");xa.add("QuickEditConditionalFormattingRule");xa.add("GetPrintSettings");xa.add("UpdatePresenceUsers");xa.add("GetThemeInfo");xa.add("InsertCopiedCutCells");xa.add("PasteRange");xa.add("FillRange");xa.add("InsertCopiedCutCellsCrossSession");Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5738374_UTR_xlreq_lineage")&&
(xa.add("LineageOpenPaneOrChangeFilter"),xa.add("LineageUpdateView"),xa.add("LineageRefreshView"),xa.add("LineageLoadMore"));return xa}}De.z0i=De.$bi();De.kZh=De.$8h();De.Xpj=De.C$h();Object(v.a)(De,"RequestStatisticsData",null,[]);class Ye{constructor(xa,wa,Ic){this.$=xa;this.IL=wa;this.mqa=Ic}bEc(xa,wa,Ic,Zd,Ke,Te,If,Ef,ta,zb,qc,Kc,Xc,Sd){Kc=sd.a(Kc);xa=new De(xa,wa,Ic,Zd,Ke,Te,If,Ef,ta,Kc,zb,qc,cf.a.aG(wa),this.$qd(null),Xc,this.mqa.h$a(),Sd);this.iXd(xa)}xj(xa,wa){xa="UnknownMethodName";var Ic=
-1;void 0!==wa.context&&null!==wa.context&&(xa=wa.context.methodName,Ic=wa.context.communicationErrorRetryCount);let Zd,Ke={EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1};wa.Cf?(Zd=wa.Cf.Errors||[],this.IL.EEj(wa.Cf.EditSessionIsDirty),void 0!==wa.Cf.RequestTelemetryData&&null!==wa.Cf.RequestTelemetryData&&(Ke=wa.Cf.RequestTelemetryData)):Zd=[];const Te=wa.duration,If=sd.a(wa.url);xa=new De(xa,Te,wa.totalOperationDuration,wa.I7d,
wa.$F,Ke,wa.I_d,Zd,wa.httpStatus,If,Ic,!0,cf.a.aG(Te),this.$qd(wa.Cf),wa.responseSize,this.mqa.h$a(),wa.responseToCallbackTime);this.iXd(xa);xa.requestResourceTiming&&(Ic=xa.requestResourceTiming.totalDuration-xa.WfeRequestDuration,Ic>=this.$.xa.LongNetworkTimeTelemetryThresholdInMilliseconds&&wa.responseHeaders&&x.ULS.sendTraceTag(508880928,0,50,`RequestStatistics.onWebMethodSuccess: Slow network time detected: requestName = ${xa.requestName}, requestDuration = ${xa.requestDuration}, networkTime = ${Ic},  ServerCorrelation = ${xa.correlationID}, msEdgeHeader = ${Bd.a.tMb in
wa.responseHeaders?wa.responseHeaders[Bd.a.tMb]:""}, backendDatacenter = ${Bd.a.xLd in wa.responseHeaders?wa.responseHeaders[Bd.a.xLd]:""}, proxyDatacenter = ${Bd.a.zLd in wa.responseHeaders?wa.responseHeaders[Bd.a.zLd]:""}`))}So(xa,wa){xa="UnknownMethodName";let Ic=-1;void 0!==wa.context&&null!==wa.context&&(xa=wa.context.methodName,Ic=wa.context.communicationErrorRetryCount);const Zd=wa.duration,Ke=sd.a(wa.url);wa=new De(xa,Zd,wa.totalOperationDuration,wa.I7d,wa.$F,{EcsOperationDuration:-1,EcsRequestDuration:-1,
WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1},wa.I_d,wa.errors||[],wa.httpStatus,Ke,Ic,!1,cf.a.aG(Zd),this.$qd(null),-1,this.mqa.h$a(),wa.responseToCallbackTime);this.iXd(wa)}iXd(xa){this.IL.f2g(xa);if(Ha.EwaSettings.Ea(212)){var wa=xa.requestName;if(wa!==Bd.a.nAa&&"SetCell"!==wa&&"FindRange"!==wa&&"FindAll"!==wa&&"FindCell"!==wa)return}wa=Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5514802_UTRBasedOnULS_xlreq")&&!(void 0===xa.requestName||null===xa.requestName)&&xa.isPromotedUTRRequest;
Ye.dDh(xa,wa);this.IL.zTg(xa)}$qd(xa){var wa;if(null===(wa=null===xa||void 0===xa?void 0:xa.CollaborationResult)||void 0===wa?0:wa.Users)return xa.CollaborationResult.Users.length;xa=this.$.ea.Vp.length;return 0<xa?xa:1}static dDh(xa,wa){wa?Jd.b().UFc(388829456,0,15,xa):(wa=Sys.Serialization.JavaScriptSerializer.serialize(xa),x.ULS.sendTraceTag(388829456,0,50,wa));if(Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5294200_ReportXlreqKPI")&&void 0!==xa.requestName&&null!==xa.requestName&&xa.isFullyLoggedKPIRequest){wa=
new Map;wa.set("isUserTriggeredRequest",xa.isUserTriggeredRequest.toString());wa.set("requestDuration",xa.requestDuration.toString());wa.set("totalOperationDuration",xa.totalOperationDuration.toString());wa.set("requestTimeInQueue",xa.requestTimeInQueue.toString());wa.set("requestInvokedTime",xa.requestInvokedTime.toString());wa.set("ecsOperationDuration",xa.ecsOperationDuration.toString());wa.set("ecsRequestDuration",xa.EcsRequestDuration.toString());wa.set("wfeRequestDuration",xa.WfeRequestDuration.toString());
wa.set("timeFromLastEcsFreeze",xa.TimeFromLastEcsFreeze.toString());wa.set("duringLoadOnDemand",xa.DuringLoadOnDemand.toString());wa.set("correlationID",xa.correlationID);wa.set("errors",xa.errors.toString());wa.set("httpStatus",xa.httpStatus.toString());if(xa.networkInfoData){var Ic=xa.networkInfoData;wa.set("networkInfoData_bandwidthMps",void 0===Ic.bandwidthMps||null===Ic.bandwidthMps?"NA":Ic.bandwidthMps.toString());wa.set("networkInfoData_rttMs",void 0===Ic.rttMs||null===Ic.rttMs?"NA":Ic.rttMs.toString());
wa.set("networkInfoData_effectiveConnection",void 0===Ic.effectiveConnection||null===Ic.effectiveConnection?"NA":Ic.effectiveConnection)}xa.requestResourceTiming&&(Ic=xa.requestResourceTiming,wa.set("requestResourceTiming_fetchStart",void 0===Ic.downloadDuration||null===Ic.downloadDuration?"NA":Ic.downloadDuration.toString()));wa.set("communicationErrorRetryCount",xa.communicationErrorRetryCount.toString());wa.set("successfulCall",xa.successfulCall.toString());wa.set("isDocumentHidden",xa.isDocumentHidden.toString());
wa.set("coauthorsCount",xa.coauthorsCount.toString());wa.set("responseSize",xa.responseSize.toString());wa.set("responseToCallbackTime",xa.responseToCallbackTime.toString());Jd.b().ZDc(xa.requestName,xa.successfulCall,wa)}}}Object(v.a)(Ye,"RequestStatistics",null,[]);var $e=a(215),tf=a(59),Jb=a(276);class yc{constructor(){this.operationName=null;this.isUserOperation=!1;this.longestStartToResponse=this.longestStartToNextFrame=this.totalCount=0;this.startToResponsePercentiles=this.startToNextFramePercentiles=
null}}Object(v.a)(yc,"OperationTypeStatisticsData",null,[]);class Id{constructor(xa,wa){this.data=new yc;this.data.operationName=xa;this.data.isUserOperation=wa;this.data.totalCount=0;this.jng=[];this.kng=[];this.data.longestStartToNextFrame=-1;this.data.longestStartToResponse=-1;this.data.startToNextFramePercentiles="";this.data.startToResponsePercentiles=""}nf(xa){this.data.totalCount<Id.aid&&(this.jng.push(xa.startToNextFrame),this.kng.push(xa.startToResponseRenderEnd));this.data.totalCount++;
this.data.longestStartToNextFrame<xa.startToNextFrame&&(this.data.longestStartToNextFrame=xa.startToNextFrame);this.data.longestStartToResponse<xa.startToResponseRenderEnd&&(this.data.longestStartToResponse=xa.startToResponseRenderEnd)}Tld(){0<this.data.totalCount&&(this.data.startToNextFramePercentiles=this.agf(this.jng),this.data.startToResponsePercentiles=this.agf(this.kng))}agf(xa){xa.sort(Rb.HelperMethods.yI);let wa;wa="("+cf.a.Tna(xa,25).toString();wa=wa+", "+cf.a.Tna(xa,50).toString();wa=wa+
", "+cf.a.Tna(xa,75).toString();wa=wa+", "+cf.a.Tna(xa,95).toString();return wa+")"}}Id.aid=1E3;Object(v.a)(Id,"OperationTypeStatistics",null,[]);class qe{constructor(){this.requestName=null;this.averageWfeDuration=this.averageEcsDuration=this.averageEcsOperationDuration=this.averageDuration=this.callsDuringLoadOnDemand=this.callsDuringEcsFreeze=this.unsuccessfulCalls=this.successfulCalls=this.totalCount=0;this.longestRequest=null;this.requestDurationPercentile95=this.requestDurationPercentile75=
this.requestDurationPercentile50=this.requestDurationPercentile25=0}}Object(v.a)(qe,"RequestTypeStatisticsData",null,[]);class Me{constructor(xa){this.data=new qe;this.data.requestName=xa;this.data.totalCount=0;this.wib=[];this.G8d=this.y8d=this.z8d=this.D8d=0;this.data.successfulCalls=0;this.data.unsuccessfulCalls=0;this.data.callsDuringEcsFreeze=0;this.data.longestRequest=null;this.data.requestDurationPercentile25=-1;this.data.requestDurationPercentile50=-1;this.data.requestDurationPercentile75=
-1;this.data.requestDurationPercentile95=-1}lFj(xa){this.data.totalCount<Me.aid&&this.wib.push(xa.requestDuration);this.data.totalCount++;this.D8d+=xa.requestDuration;this.z8d+=Me.sod(xa.ecsOperationDuration);this.y8d+=Me.sod(xa.EcsRequestDuration);this.G8d+=Me.sod(xa.WfeRequestDuration);0<xa.TimeFromLastEcsFreeze&&xa.TimeFromLastEcsFreeze<Me.ZYh&&this.data.callsDuringEcsFreeze++;xa.successfulCall?this.data.successfulCalls++:this.data.unsuccessfulCalls++;xa.DuringLoadOnDemand&&this.data.callsDuringLoadOnDemand++;
if(void 0===this.data.longestRequest||null===this.data.longestRequest||this.data.longestRequest.requestDuration<xa.requestDuration)this.data.longestRequest=xa}Tld(){0<this.data.totalCount&&(this.data.averageDuration=Math.floor(this.D8d/this.data.totalCount),0<this.data.successfulCalls?(this.data.averageEcsOperationDuration=Math.floor(this.z8d/this.data.successfulCalls),this.data.averageEcsDuration=Math.floor(this.y8d/this.data.successfulCalls),this.data.averageWfeDuration=Math.floor(this.G8d/this.data.successfulCalls)):
(this.data.averageEcsOperationDuration=0,this.data.averageEcsDuration=0,this.data.averageWfeDuration=0),this.wib.sort(Rb.HelperMethods.yI),this.data.requestDurationPercentile25=cf.a.Tna(this.wib,25),this.data.requestDurationPercentile50=cf.a.Tna(this.wib,50),this.data.requestDurationPercentile75=cf.a.Tna(this.wib,75),this.data.requestDurationPercentile95=cf.a.Tna(this.wib,95))}static sod(xa){return 0>xa?0:xa}}Me.ZYh=3E3;Me.aid=1E3;Object(v.a)(Me,"RequestTypeStatistics",null,[]);class oa{constructor(xa,
wa,Ic,Zd,Ke,Te,If,Ef){this.mode=null;this.dirtySessionOnLastRecordedRequest=this.endedBySplashScreen=this.ocsCapable=!1;this.maxCoauthorsCount=this.loadOnDemandCount=0;this.everConnectedToOcs=!1;this.requests=null;this.mode=xa;this.ocsCapable=wa;this.endedBySplashScreen=Ic;this.dirtySessionOnLastRecordedRequest=Zd;this.loadOnDemandCount=Ke;this.maxCoauthorsCount=Te;this.everConnectedToOcs=If;xa=[];for(let ta in Ef)wa=Ef[ta],wa.Tld(),xa.push(wa.data);this.requests=xa}}Object(v.a)(oa,"SessionStatisticsData",
null,[]);class vb{constructor(xa){this.dirtySessionOnLastRecordedRequest=this.y5d=!1;this.NBf=0;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.$=xa;this.ytb={};this.xtb={};this.Ofd={}}De(){var xa=this.avh();if(sc.a.aia()){var wa={};wa.xlendJson=xa;this.$.fsa($e.a.wpk,wa,!1)}else tf.N(this.$.qa.ua,xa,null,null,null,null,null);xa=this.bvh();sc.a.aia()?(wa={},wa.xlenoJson=xa,this.$.fsa($e.a.xpk,wa,!1)):x.ULS.sendTraceTag(388776782,0,50,xa);xa=this.Gph();sc.a.aia()?(wa={},wa.xlencJson=xa,this.$.fsa($e.a.vpk,
wa,!1)):x.ULS.sendTraceTag(388776770,0,50,xa);this.VFj()}Isc(){this.everConnectedToOcs=this.$.ea.Pcb||this.everConnectedToOcs;V.Health.instance&&V.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.everConnectedToOcs.toString())}Lh(){const xa=new Jb.a;let wa="";const Ic=!this.$.isAnonymousUser(),Zd=xa.Vh();if(Zd){if(Ic){xa.sUb("UMI_Linkable","true");return}wa=xa.XPa("UMI_Linkable")}Ic||x.ULS.sendTraceTag(537153870,0,50,`SessionStatistics.OnCommandUIGeneratedAndGridInteractive: IsLocalStorageSupported:${Zd}, UMIIsLinkable:${!!wa}`)}uib(){this.y5d=
!0}EEj(xa){this.dirtySessionOnLastRecordedRequest=xa}f2g(xa){this.maxCoauthorsCount=Math.max(this.maxCoauthorsCount,xa.coauthorsCount);V.Health.instance&&V.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.maxCoauthorsCount.toString())}zTg(xa){if(!(xa.requestName in this.ytb)){const wa=new Me(xa.requestName);this.ytb[xa.requestName]=wa}this.ytb[xa.requestName].lFj(xa)}yTg(xa){if(!(xa.name in this.xtb)){const wa=new Id(xa.name,xa.isUserOperation);this.xtb[xa.name]=wa}this.xtb[xa.name].nf(xa)}VW(xa){this.Ofd[xa.reportName]=
xa}VFj(){this.dirtySessionOnLastRecordedRequest=this.y5d=!1;this.NBf=this.$.ea.gGd;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.ytb={};this.xtb={};this.Ofd={}}avh(){const xa=new oa(this.$.isEditMode?"edit":"view",this.$.ea.ocsCapable,this.y5d,this.dirtySessionOnLastRecordedRequest,this.$.ea.gGd-this.NBf,this.maxCoauthorsCount,this.everConnectedToOcs,this.ytb);return Sys.Serialization.JavaScriptSerializer.serialize(xa)}bvh(){var xa=new ub.a;const wa=this.xtb;for(let Ic in wa){const Zd=
wa[Ic];Zd.Tld();xa.add(Zd.data)}xa=xa.toArray();return Sys.Serialization.JavaScriptSerializer.serialize(xa)}Gph(){return Sys.Serialization.JavaScriptSerializer.serialize(this.Ofd)}}Object(v.a)(vb,"SessionStatistics",null,[]);class Ac extends Nb.a{constructor(xa){super();this.Sra=this.$qa=null;this.iVe=Array(1);this.SXc=this.yHd=null;this.xj=(wa,Ic)=>{Ha.EwaSettings.Ea(39)&&(this.Sra=this.Sra||new Ye(this.$,this.IL,this.mqa),this.Sra.xj(wa,Ic))};this.So=(wa,Ic)=>{Ha.EwaSettings.Ea(39)&&(this.Sra=this.Sra||
new Ye(this.$,this.IL,this.mqa),this.Sra.So(wa,Ic))};this.De=(wa,Ic)=>{Ha.EwaSettings.Ea(39)&&this.IL.De(wa,Ic)};this.Lh=(wa,Ic)=>{Ha.EwaSettings.Ea(39)&&this.IL.Lh(wa,Ic)};this.Isc=(wa,Ic)=>{Ha.EwaSettings.Ea(39)&&this.IL.Isc(wa,Ic)};this.$=xa;Ha.EwaSettings.Ea(39)&&(cf.a.wpf(this.$),this.CQ=new nd(this.$),this.zrh(),Ha.EwaSettings.Ea(505)&&this.Tdb&&(this.yHd=new bb(this.$,this.Tdb)),this.IL=new vb(this.$),this.mqa=new Ia(this.$),this.$.gk(this.De),this.$.qa.St(this.xj),this.$.qa.aA(this.So),this.$.ea.gCe(this.Isc),
Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.Fl(this.Lh))}get Tdb(){return this.SXc}dispose(){this.$&&Ha.EwaSettings.Ea(39)&&(this.$.Hn(this.De),this.$.qa.mv(this.xj),this.$.qa.hB(this.So),this.$.ea.X6f(this.Isc),Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.xo(this.Lh));Eb.a.Ma(this.mqa);Eb.a.Ma(this.Tdb);this.SXc=null;Eb.a.Ma(this.CQ);this.CQ=null;Eb.a.Ma(this.yHd);this.$=this.yHd=null;super.dispose()}uib(){Ha.EwaSettings.Ea(39)&&
this.IL.uib()}bEc(xa,wa,Ic,Zd,Ke,Te,If,Ef,ta,zb,qc,Kc,Xc,Sd){Ha.EwaSettings.Ea(39)&&(this.Sra=this.Sra||new Ye(this.$,this.IL,this.mqa),this.Sra.bEc(xa,wa,Ic,Zd,Ke,Te,If,Ef,ta,zb,qc,Kc,Xc,Sd))}bSb(xa,wa){Ha.EwaSettings.Ea(39)&&(this.$qa=this.$qa||new cd(this.$,this.IL,this,this.CQ),this.$qa.bSb(xa,wa))}RDc(){Ha.EwaSettings.Ea(39)&&(this.$qa=this.$qa||new cd(this.$,this.IL,this,this.CQ),this.$qa.RDc())}YDc(){Ha.EwaSettings.Ea(39)&&(this.$qa=this.$qa||new cd(this.$,this.IL,this,this.CQ),this.$qa.YDc())}VW(xa){Ha.EwaSettings.Ea(39)&&
this.IL.VW(xa)}vpd(xa){return Ha.EwaSettings.Ea(39)?this.iVe[xa]:null}afg(xa){xa&&(this.iVe[xa.type]=xa)}h$a(){return this.mqa.h$a()}zrh(){z.a.Sp&&void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&(this.SXc=new Af(this.$,this.CQ))}}Object(v.a)(Ac,"SessionStatisticsManager",Nb.a,[14]);var jd=a(104),Ud=a(1115),ke=a(133),Pe=a(148);class ze{constructor(xa,wa){this.hadConnectivityIssuesDuringUnload=this.wasOfflineDuringUnload=!1;this.timestamp=0;this.dataLossInfo=null;this.wasDataLostDuringUnload=
!1;this.inactivityDurationBeforeUnloadSeconds=0;this.workbookHashedId=null;this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=null;this.timeFromLastStatusCode0=this.timeFromLastDisconnectionStart=this.timeFromLastConnectivity=0;this.wasUpdatedOnBeforeUnload=this.wasUpdatedOnUnload=!1;this.lastSilentReopenEndTime=this.lastSilentReopenStartTime=this.disconnectionSource=null;this.workbookHashedId=xa;this.wasUpdatedOnUnload=this.wasDataLostDuringUnload=this.apiBeforeCloseNotificationEnabledOnUnload=
this.dialogPromptedOnUnload=!1;this.wacSessionId=wa}Z7d(){return je.a.He(this)}}Object(v.a)(ze,"AppUnloadInfo",null,[]);var Ue=a(730),hg=a(124),of=a(574);class Gf{constructor(xa){this.lostOperationsCount=0;this.mostCommonOperationName=null;this.mostCommonOperationCount=0;this.dataLossReason=null;this.lostOperationsCount=xa.JOe+xa.vtg;this.dataLossReason=xa.QKe;this.gch(xa.Kae)}gch(xa){const wa=new Ue.a(of.a.tN());let Ic=0,Zd=0;for(const Ke of xa)wa.kd(Ke)||wa.fa(Ke,0),xa=wa.fa(Ke,wa.ma(Ke)+1),xa>
Ic&&(Ic=xa,Zd=Ke);Ic>this.mostCommonOperationCount&&(this.mostCommonOperationName=hg.a(Zd),this.mostCommonOperationCount=Ic)}}Object(v.a)(Gf,"DataLossInfo",null,[]);var Wf=a(65);class bg{constructor(xa){this.T6c="AppUnloadInfo";this.Wo=this.$=this.workbookHashedId=this.KB=null;this.Dee=this.aie=!1;this.Ah=null;this.Sof=0;this.Tga=(wa,Ic)=>{this.Sof=Ic.KKc};this.IVf=(wa,Ic)=>{Ic.Kae.length&&this.$.CN&&(this.KB.dataLossInfo=new Gf(Ic),this.KB.wasDataLostDuringUnload=!0,this.Zib())};this.Lh=()=>{this.xdg();
this.$.ea.xo(this.Lh)};this.jUa=()=>{this.KB.wasUpdatedOnBeforeUnload=!0;this.KB.inactivityDurationBeforeUnloadSeconds=this.Ah.hlb<bg.IXi?this.Sof:this.Ah.hlb;this.$vg()};this.GOb=()=>{this.KB.wasUpdatedOnUnload=!0;this.$vg();Sys.Application.remove_unload(this.GOb)};this.Vyc=()=>{this.KB.lastSilentReopenStartTime=qa.a.$b.ke;this.KB.lastSilentReopenEndTime=null;this.Zib();this.$.Zm(this.wOb)};this.wOb=()=>{this.KB.lastSilentReopenEndTime=qa.a.$b.ke;this.Zib();this.$.co(this.wOb)};this.localStorage=
new Jb.a;this.localStorage.Vh()&&(this.$=xa,this.workbookHashedId=Wf.a(this.$),this.KB=new ze(this.workbookHashedId,this.$.xa.UserSessionId),this.Wo=Pe.a.instance.UM(),this.Wo.la("beforeunload",this.jUa),this.$.userOperationManager.b1g(this.IVf),xa.ea.nh?this.xdg():this.$.ea.Fl(this.Lh),this.Ah=this.$.ea.Ah,this.Ah.Wwa(this.Tga),Sys.Application.add_unload(this.GOb),this.$.ea.Iub(this.Vyc))}get dialogPromptedOnUnload(){return this.aie}set dialogPromptedOnUnload(xa){this.aie=xa;this.KB?(this.KB.dialogPromptedOnUnload=
xa,this.Zib()):this.localStorage.Vh()&&x.ULS.sendTraceTag(537151058,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.Vh()}`)}get apiBeforeCloseNotificationEnabledOnUnload(){return this.Dee}set apiBeforeCloseNotificationEnabledOnUnload(xa){this.Dee=xa;this.KB?(this.KB.apiBeforeCloseNotificationEnabledOnUnload=xa,this.Zib()):this.localStorage.Vh()&&x.ULS.sendTraceTag(537151057,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.Vh()}`)}dispose(){this.$&&
this.$.userOperationManager&&this.$.userOperationManager.tDj(this.IVf);this.Ah&&(this.Ah.FEa(this.Tga),this.Ah=null);this.Wo.MH();this.$=this.Wo=null}$vg(){this.dUj();this.Zib()}dUj(){this.KB.wasOfflineDuringUnload=this.$.Ug.G9;this.KB.timeFromLastConnectivity=ke.a(qa.a.$b,this.$.Ug.BAf);this.KB.timeFromLastDisconnectionStart=ke.a(qa.a.$b,this.$.Ug.aOi);this.KB.disconnectionSource=Enum.toString(Ud.a,this.$.Ug.disconnectionSource);this.KB.hadConnectivityIssuesDuringUnload=this.$.Ug.gpa;this.KB.timeFromLastStatusCode0=
ke.a(qa.a.$b,this.$.Ug.AAf)}Zib(){this.KB.timestamp=Date.now();this.localStorage.sUb(this.T6c,this.KB.Z7d())}xdg(){const xa=this.localStorage.XPa(this.T6c);if(xa)try{const wa=je.a.Fk(xa);this.localStorage.eVd(this.T6c);const Ic=this.QVi(wa);x.ULS.sendTraceTag(574677456,0,50,Ic)}catch(wa){x.ULS.sendTraceTag(537151056,0,15,`AppUnloadTelemetryManager.SendLogFromLocalStorage: Exception message: ${wa.message}`)}else x.ULS.sendTraceTag(574677457,0,50,"AppUnloadTelemetryManager.SendLogFromLocalStorage: No previous app-unload information")}QVi(xa){const wa=
{};wa.WACSessionID=xa.wacSessionId;wa.wasRefreshed=this.agh(xa,this.$.xa.MaxAppReloadDurationIndicatingRefresh);wa.closedWithDialogConfirmation=xa.dialogPromptedOnUnload;wa.wasOfflineDuringUnload=xa.wasOfflineDuringUnload;wa.TimeFromLastConnectivityMs=xa.timeFromLastConnectivity;wa.TimeFromLastDisconnectionStart=xa.timeFromLastDisconnectionStart;wa.wasDataLostDuringUnload=xa.wasDataLostDuringUnload;wa.DataLossInfo=xa.dataLossInfo;wa.flushedOnUnload=xa.wasUpdatedOnUnload;wa.flushedOnBeforeUnload=xa.wasUpdatedOnBeforeUnload;
wa.InactivityDurationBeforeUnload=xa.inactivityDurationBeforeUnloadSeconds;wa.DisconnectionSource=xa.disconnectionSource;wa.hadConnectivityIssuesDuringUnload=xa.hadConnectivityIssuesDuringUnload;wa.TimeFromLastStatusCode0=xa.timeFromLastStatusCode0;wa.LastSilentReopenStartTime=xa.lastSilentReopenStartTime;wa.LastSilentReopenEndTime=xa.lastSilentReopenEndTime;Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5144186_LogBeforeCloseNotificationApiStatusOnUnload")&&(wa.ApiBeforeCloseNotificationEnabledOnUnload=
xa.apiBeforeCloseNotificationEnabledOnUnload);return Z.c(wa)}agh(xa,wa){const Ic=window.performance.timing.navigationStart-xa.timestamp;(xa=this.workbookHashedId===xa.workbookHashedId&&Ic<wa)&&x.ULS.sendTraceTag(537151055,0,50,"AppUnloadTelemetryManager.CheckRefresh: Session is after refresh");return xa}static la(xa){xa.ea.te.inWebPart||xa.ga.Qa(410,new bg(xa))}}bg.IXi=10;Object(v.a)(bg,"AppUnloadTelemetryManager",null,[539,5]);var Dg=a(16);class Gg{constructor(xa){this.VVe=!1;this.WVe=null;this.uf=
()=>{this.mJj();Ld.h(this.$).ha&&Ld.h(this.$).ha.m4(this.uf)};this.om=(wa,Ic)=>{Ic.na&&!this.w7d.has(Ic.na.name)&&(this.w7d.add(Ic.na.name),Ld.h(this.$).ha&&(Ld.h(this.$).ha.m4(this.uf),Ld.h(this.$).ha.S0(this.uf)))};this.$=xa;this.Xpg=new Set;this.w7d=new Set;this.$.va&&this.$.va.na&&this.w7d.add(this.$.va.na.name);Ld.h(this.$).ha.S0(this.uf);this.$.va.Ri(this.om)}dispose(){this.$=null}mJj(){this.WVe||this.qch();const xa=Ld.d(Ld.h(this.$));if(!this.VVe){const wa=Dg.a.instance.Ia(281).split(",");
xa.push(...wa);this.VVe=!0}for(const wa of xa)wa&&!this.Xpg.has(wa)&&(this.zSi(wa),this.Xpg.add(wa))}zSi(xa){this.zdh(xa)}qch(){this.WVe=Gg.$za("monospace");Gg.$za("sans-serif");Gg.$za("serif")}zdh(xa){Gg.$za(`${xa},${"monospace"}`);Gg.$za(`${xa},${"sans-serif"}`);Gg.$za(`${xa},${"serif"}`)}static la(xa){if(Ha.EwaSettings.Ea(61)){const wa=new Gg(xa);xa.ga.Qa(210,wa)}}static $za(xa){const wa=document.createElement("div"),Ic=document.createElement("div");wa.style.cssText="position: absolute; overflow: auto; visibility: hidden;";
Gg.STj(Ic,xa);document.body.appendChild(wa);wa.appendChild(Ic);Ic.innerText="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+";xa=Ic.offsetWidth+"x"+Ic.offsetHeight;document.body.removeChild(Ic.parentNode);return xa}static STj(xa,wa){xa.style.cssText="display: inline; visibility: hidden;";xa.style.fontSize="100px";xa.style.fontWeight="normal";xa.style.fontStyle="normal";xa.style.letterSpacing="normal";xa.style.lineHeight="normal";xa.style.whiteSpace="nowrap";xa.style.fontFamily=
wa}}Object(v.a)(Gg,"FontTelemetryManager",null,[5]);var Rf=a(243),Eg=a(180),vh;(function(xa){xa[xa.legacyMultiLineRibbon=0]="legacyMultiLineRibbon";xa[xa.reactSingleLineRibbon=1]="reactSingleLineRibbon";xa[xa.reactMultiLineRibbon=2]="reactMultiLineRibbon";xa[xa.invalid=3]="invalid"})(vh||(vh={}));Object(v.b)("RibbonMode",vh);var Og=a(115);let e=class extends xd.a{constructor(){super();this.bP=!1;this.Une=this.Tne=null;this.JMd=()=>{this.Nvg()};this.$bj=()=>{Eb.a.Ma(this.K1);Eb.a.Ma(this.Wo)};this.K1=
Pe.a.instance.nNa();this.Wo=Pe.a.instance.UM();this.K1.la("visibilitychange",this.JMd);this.Wo.la("pagehide",this.$bj);this.Nvg()}get hj(){return this.bP}get Nzf(){return this.Tne}get otc(){return this.Une}P0(xa){this.addHandler("ekdh",xa)}zWa(xa){this.removeHandler("ekdh",xa)}YW(xa){this.addHandler("ekduh",xa)}DEa(xa){this.removeHandler("ekduh",xa)}aG(xa){return this.hj?!0:this.otc?Ba.getElapsedMilliseconds(this.otc,qa.a.$b.ke)<xa:!1}dispose(){Eb.a.Ma(this.K1);Eb.a.Ma(this.Wo);super.dispose()}Nvg(){this.bP=
"hidden"===window.document.visibilityState;this.hj?(this.raiseEvent("ekdh"),this.Tne=qa.a.$b.ke):(this.raiseEvent("ekduh"),this.Une=qa.a.$b.ke)}};e=Object(lb.a)([Object(Mb.d)(Aa.O)],e);Object(v.a)(e,"DocumentVisibilityObserver",xd.a,[459,5]);var sa=a(131);class Ya{constructor(){this.longFramesOverThresholdOpsPercentage=this.longFramesOverThresholdOps=this.fpsUnderThresholdOpsPercentage=this.fpsUnderThresholdOps=0;this.maxLongFrameDuration=-1}}Object(v.a)(Ya,"FramePerformanceData",null,[]);class Fb{constructor(xa){this.name=
null;this.count=0;this.minFPS=-1;this.maxFPS=0;this.l1FramePerformanceData=new Ya;this.l2FramePerformanceData=new Ya;this.l3FramePerformanceData=new Ya;this.name=xa}}Object(v.a)(Fb,"FramePerformanceDataGroup",null,[]);class pc{constructor(){this._reportName=null;this.operationsGroups=[];this._reportName="FramePerformanceCanvas"}get reportName(){return this._reportName}}Object(v.a)(pc,"FramePerformanceSessionEndsReport",null,[527]);class Uc{constructor(xa){this.hPd={};this.nla=null;this.hmb=(wa,Ic)=>
{wa.longFramesOverThresholdOps++;wa.maxLongFrameDuration=Math.max(wa.maxLongFrameDuration,Ic)};this.Og=new pc;this.ish();xa.ga.qd(276,()=>{Rd.a(xa).VW(this.Og)})}ish(){this.nla=new Fb("AllGridOperationsData");this.Og.operationsGroups.push(this.nla);this.Fyb("Selection","SelectingRange_keyboard SelectingRange_mouse WidgetSelectAll SelectAll ExtendDown ExtendEnd ExtendLeft ExtendRight ExtendRowEnd ExtendRowStart ExtendScreenDown ExtendScreenUp ExtendSelectionToA1 ExtendSelectionToUsedRangeEnd ExtendStart ExtendToBottomEdge ExtendToLeftEdge ExtendToRightEdge ExtendToTopEdge ExtendUp MoveRight MoveUp MoveLeft MoveDown MoveToRightEdge MoveToLeftEdge MoveToBottomEdge Goto GotoA1 GotoRowStart GotoUsedRangeEnd MoveRightWithinSelectionOrFunctionAutoComplete MoveLeftWithinSelection".split(" "));
this.Fyb("DragScroll",["DragScroll"]);this.Fyb("Scroll",["ViewportVerticalScroll","ViewportHorizontalScroll"]);this.Fyb("Typing",["GridTypingKeyPressed","FormulaBarTypingKeyPressed","EditBoxStartEdit"]);this.Fyb("FloatingObjects",["SelectingFloatingObject","FloatingObjectMove","FloatingObjectResize"])}eFj(xa,wa,Ic,Zd){const Ke=this.W8h(xa);Ke&&(sa.b(this.Og.operationsGroups,Te=>Na.a.equals(Te.name,Ke.name,!1))||this.Og.operationsGroups.push(Ke),Ke.count++,this.HMc(wa,Ke),this.DMc(Ic,Ke),this.nla.count++,
this.HMc(wa,this.nla),this.DMc(Ic,this.nla),0<Zd&&this.Jik(Zd,Ke),0<=wa&&this.Xhk(wa,Ke))}kjk(){for(const xa of this.Og.operationsGroups)Uc.dik(xa)}Fyb(xa,wa){xa=new Fb(xa);for(const Ic of wa)this.hPd[Ic]=xa}W8h(xa){return xa in this.hPd?this.hPd[xa]:null}Xhk(xa,wa){30>xa&&this.e$d(Ic=>{Ic.l1FramePerformanceData.fpsUnderThresholdOps++},wa);15>xa&&this.e$d(Ic=>{Ic.l2FramePerformanceData.fpsUnderThresholdOps++},wa);5>xa&&this.e$d(Ic=>{Ic.l3FramePerformanceData.fpsUnderThresholdOps++},wa)}Jik(xa,wa){100<=
xa&&(this.imb(wa.l1FramePerformanceData,xa,this.hmb),this.imb(this.nla.l1FramePerformanceData,xa,this.hmb));300<=xa&&(this.imb(wa.l2FramePerformanceData,xa,this.hmb),this.imb(this.nla.l2FramePerformanceData,xa,this.hmb));600<=xa&&(this.imb(wa.l3FramePerformanceData,xa,this.hmb),this.imb(this.nla.l3FramePerformanceData,xa,this.hmb))}e$d(xa,wa){wa&&(xa(wa),xa(this.nla))}imb(xa,wa,Ic){xa&&Ic(xa,wa)}HMc(xa,wa){wa.minFPS=-1===wa.minFPS?xa:Math.min(wa.minFPS,xa)}DMc(xa,wa){wa.maxFPS=Math.max(wa.maxFPS,
xa)}static dik(xa){Uc.K$d(xa.l1FramePerformanceData,xa.count);Uc.K$d(xa.l2FramePerformanceData,xa.count);Uc.K$d(xa.l3FramePerformanceData,xa.count)}static K$d(xa,wa){xa.fpsUnderThresholdOpsPercentage=100*xa.fpsUnderThresholdOps/wa;xa.longFramesOverThresholdOpsPercentage=100*xa.longFramesOverThresholdOps/wa}}Object(v.a)(Uc,"FramePerformanceSessionEndsReportManager",null,[]);class Sc{constructor(){this.f=null}}Object(v.a)(Sc,"FpsDataWrapper",null,[]);class Nd{constructor(xa,wa){this.duration=this.startSecond=
0;this.startSecond=void 0===xa?-1:xa;this.duration=void 0===wa?-1:wa}}Object(v.a)(Nd,"LongFrameData",null,[]);var ne=a(359);class ye{constructor(xa,wa,Ic,Zd,Ke,Te,If,Ef,ta,zb){this.Op=null;this.Min=this.Max=this.Avg=this.end=this.start=this.count=0;this.LFrame=null;this.tfAppInt=this.coauth=this.longFrameCount=0;this.Props=null;this.Op=void 0===xa?null:xa;this.count=void 0===wa?0:wa;this.start=void 0===Ic?-1:Ic;this.end=void 0===Zd?-1:Zd;this.Avg=void 0===Ke?0:Ke;this.Max=void 0===Te?-1:Te;this.Min=
ne.a.BBg;this.longFrameCount=void 0===If?0:If;this.coauth=(void 0===Ef?-1:Ef)||1;this.tfAppInt=void 0===ta?-1:ta;this.Props=void 0===zb?null:zb;this.LFrame=null}}Object(v.a)(ye,"OperationFPSData",null,[]);var bf=a(36),uf=a(811);class Qf extends Nb.a{constructor(xa){super();this.bvb=-1;this.VEd=0;this.kCa=new Date(0);this.h1=null;this.Dma={};this.Xya=new ub.a;this.rYd=this.ldb=!1;this.j9a=null;this.zKc=this.Neb=0;this.isSynthetic=!1;this.A9e=()=>{const wa=new Date;var Ic=wa.getMinutes();const Zd=wa.getSeconds();
this.qKb&&wa.getTime()-this.qKb.getTime()>this.v9j?(this.stop(),this.Gmd(wa)):(Ic!==this.VEd&&(this.Gmd(wa),this.VEd=Ic),this.ldb&&(this.Zf.hj?this.h1[Zd]=Qf.hfc:(this.DXe(Zd),this.ldb=!1,this.Xya.clear(),this.Dma={})),this.h1[Zd]!==Qf.hfc&&(this.h1[Zd]++,Ic=wa.getTime()-this.kCa.getTime(),Ic>this.bEf&&this.WSi(this.kCa,Ic)),this.bvb=window.requestAnimationFrame(this.A9e),this.kCa=wa)};this.BI=()=>{this.ldb=!0};this.cLf=()=>{this.pause()};this.dLf=()=>{this.rYd&&this.resume()};this.ek=()=>{this.ya.k9()&&
this.Sik()};this.qKb=new Date;this.Zf=new e;this.Zf.P0(this.BI);n.AFrameworkApplication.e5c(this.cLf);n.AFrameworkApplication.f5c(this.dLf);this.$=xa;this.bEf=xa.xa.LongFrameThresholdMs;this.HUi="MoreThan_"+this.bEf.toString()+"_Ms";this.u9j=xa.xa.ThresholdToEndOperationTrackingSeconds;this.v9j=xa.xa.ThresholdToStopFPSTrackingMS;this.ya=Ld.h(this.$).ya;n.AFrameworkApplication.Yd&&n.AFrameworkApplication.Yd.IsSynthetic&&(this.isSynthetic=Na.a.compare(n.AFrameworkApplication.Yd[Bd.a.isSynthetic],"True",
!0)?!1:!0);this.ya.Ws(this.ek);this.FXd()}start(){this.rYd=!0;this.resume()}stop(){this.rYd=!1;this.pause()}dispose(){this.stop();this.Zf.zWa(this.BI);n.AFrameworkApplication.q6f(this.cLf);n.AFrameworkApplication.r6f(this.dLf);Eb.a.Ma(this.Zf);this.ya.Bs(this.ek);super.dispose()}h5j(xa,wa){const Ic=xa in this.Dma?this.Dma[xa]:null;this.qKb=new Date;this.start();const Zd=this.qKb.getSeconds(),Ke=Zd+this.u9j;Ic&&Zd<=Ic.end?(Ic.count++,Ic.end=Ke):(Ic&&Zd>Ic.end&&this.Xya.add(Ic),this.Dma[xa]=new ye(xa,
1,Zd,Ke,void 0,void 0,void 0,this.$.ea.Vp.length,Yd.PageLoadTrackingInfo.instance.foa(this.qKb),wa))}Dqh(){this.j9a||(this.Gmd(new Date),this.j9a=new Uc(this.$))}resume(){this.Dtf()||!this.ya.sR||this.isSynthetic||(this.ldb=this.Zf.hj,this.kCa=new Date,this.VEd=this.kCa.getMinutes(),this.FXd(),this.DXe(this.kCa.getSeconds()),this.bvb=window.requestAnimationFrame(this.A9e))}Dtf(){return 0<=this.bvb}pause(){this.Dtf()&&(this.ldb||(this.EXe((new Date).getSeconds()),x.ULS.sendTraceTag(21280654,0,50,`FPS : ${this.h1.toString()}`)),
window.cancelAnimationFrame(this.bvb),this.bvb=-1)}Gmd(xa){if(xa.getTime()-this.kCa.getTime()<Qf.uYi&&(this.ldb&&this.EXe(this.kCa.getSeconds()),this.FFh(),0<this.Xya.count&&(xa={},xa.NonEmptyCellsCount=this.Neb,xa.TextCellsCount=this.zKc,xa.xlfpsJson=Object(Vc.a)(new Sc,{f:this.Xya.toArray()}),xa.memoryInfo=this.TXi(),xa.zoom=bf.a(this.$)?bf.a(this.$).zoom:1,xa.RibbonMode=Eg.a(this.$)?vh[Eg.a(this.$).wR]:Qf.invalid,xa.deviceMemory=navigator.deviceMemory||0,xa.hardwareConcurrency=navigator.hardwareConcurrency||
0,xa=JSON.stringify(xa),x.ULS.sendTraceTag(537151044,0,50,`FPS : ${this.h1.toString()}`),!this.isSynthetic))){if(sc.a.aia()){var wa={};wa.xlfpsJson=xa;this.$.fsa($e.a.ypk,wa,!1)}else x.ULS.sendTraceTag(388781010,0,50,`${xa}`);for(let Ic of this.Xya){wa=1E3>=this.Neb?"0_1000":3E3>=this.Neb?"1000_3000":"3000_inf";const Zd=new Map;Zd.set("Operation",Ic.Op);Zd.set("BucketOfRenderedCells",wa);V.Health.instance.recordKpiUsage(kf.a.longFrame,0,pf.a.canvas,Zd);0<Ic.longFrameCount&&V.Health.instance.recordKpiFailure(kf.a.longFrame,
"LongFrame",!1,!0,Object(Vc.a)(new ba.a,{extendedProperties:Zd}));3E4<Ic.tfAppInt&&(0<Ic.longFrameCount?Jd.b().E8f(0,this.HUi,Zd):Jd.b().F8f(0,Zd))}x.ULS.sendTraceTag(537151043,0,50,`Operations message length: ${xa.length}`)}this.reset()}TXi(){const xa={};if(window.performance){const wa=window.performance.memory;wa&&(xa.jsHeapSizeLimit=wa.jsHeapSizeLimit,xa.usedJSHeapSize=wa.usedJSHeapSize,xa.totalJSHeapSize=wa.totalJSHeapSize)}return xa}reset(){this.Xya.clear();this.Dma={};this.FXd()}FFh(){var xa=
!0;xa=void 0===xa?!0:xa;if(this.h1){for(const wa of uf.a(this.Dma)){const Ic=this.Dma[wa];Ic.end=Math.min(this.h1.length-1,Ic.end);this.Xya.add(Ic)}this.Hch(this.Xya,this.h1,xa)}}Hch(xa,wa,Ic){Ic=void 0===Ic?!0:Ic;for(let Zd of xa){let Ke=xa=0;if(Zd.end<wa.length){for(let Te=Zd.start;Te<=Zd.end;Te++){const If=wa[Te];0<=If&&(Zd.Max=Math.round(Math.max(Zd.Max,If)),Zd.Min=Math.round(Math.min(Zd.Min,If)),xa+=If,Ke++)}0<Ke&&(Zd.Avg=Math.round(xa/Ke));Ic&&this.j9a&&this.j9a.eFj(Zd.Op,Zd.Min,Zd.Max,Zd.LFrame?
Zd.LFrame.duration:-1);Zd.Props&&(this.Jdk(Zd),Zd.Props=null)}}Ic&&this.j9a&&this.j9a.kjk()}FXd(){this.h1=Array(60).fill(0)}DXe(xa){xa++;for(let wa=0;wa<xa;wa++)this.h1[wa]=Qf.hfc}EXe(xa){for(;60>xa;xa++)this.h1[xa]=Qf.hfc}WSi(xa,wa){xa=xa.getSeconds();var Ic=uf.a(this.Dma);if(0<Ic.length)for(const Zd of Ic)if(Ic=this.Dma[Zd],xa>=Ic.start&&xa<Ic.end)Ic.LFrame?Ic.LFrame.duration<wa&&(Ic.LFrame.startSecond=xa,Ic.LFrame.duration=wa,Ic.longFrameCount++):(Ic.LFrame=new Nd(xa,wa),Ic.longFrameCount++)}Sik(){this.zKc=
this.Neb=0;for(const xa of Ld.h(this.$).Xp){const wa=xa.ZGa;for(let Ic in wa){const Zd=this.ya.Zj(wa[Ic].hashCode);if(null===Zd||void 0===Zd?0:Zd.sl)this.Neb+=Zd.Sf.NonEmptyCellsCount,this.zKc+=Zd.Sf.TextValueCellsCount}}}Jdk(xa){const wa=xa.Props;if(Dd.a.aVb in wa&&wa[Dd.a.aVb]&&Dd.a.UWb in wa){let Ic;(Ic=Object(S.a)(Rf.a,wa[Dd.a.UWb]))&&Ic.continueWith(Zd=>{Og.TextEditorTelemetry.instance.PVg(xa.Op,xa.Min,!!xa.LFrame,xa.LFrame?xa.LFrame.duration:0,Zd.result)})}}}Qf.hfc=-1;Qf.uYi=6E4;Qf.invalid=
"Invalid";Object(v.a)(Qf,"FramePerformanceTracker",Nb.a,[502,5]);class Yf extends gc.a{constructor(xa){super();this.$=xa;this.je()}create(){let xa=this.$.ga.Da(263);xa||(xa=this.$.ga.Qa(263,new Qf(this.$)));this.Ld(xa)}static la(xa){xa.ga.Qa(264,new Yf(xa))}}Object(v.a)(Yf,"FramePerformanceTrackerFactory",gc.a,[]);var Of=a(1210),eg=a(1E3);class gf{fi(xa,wa){return new eg.a(xa,wa)}Ze(xa,wa){xa=this.fi(xa,wa);xa.start();return xa}}Object(v.a)(gf,"DefaultStopwatchBuilder",null,[157]);class Vg{constructor(){this.$ua=
new gf}fi(xa,wa){return this.$ua.fi(xa,wa)}Ze(xa,wa){return this.$ua.Ze(xa,wa)}}Object(v.a)(Vg,"StopwatchBuilder",null,[157]);var Jh=a(355),Nh=a(968),Qg=a(969),bh;(function(xa){xa[xa.actions=0]="actions";xa[xa.correlationStart=1]="correlationStart";xa[xa.reorderSheetOp=2]="reorderSheetOp";xa[xa.formatCellOp=3]="formatCellOp";xa[xa.copyOp=4]="copyOp";xa[xa.pasteOp=5]="pasteOp";xa[xa.getNumberViewModelDataOp=6]="getNumberViewModelDataOp";xa[xa.instantaneousSetData=7]="instantaneousSetData";xa[xa.immediateSetData=
8]="immediateSetData";xa[xa.dependentCellsCalc=9]="dependentCellsCalc";xa[xa.dependentCellsGraphStat=10]="dependentCellsGraphStat";xa[xa.dependentCellsGraphSectionStat=11]="dependentCellsGraphSectionStat";xa[xa.getRangeContentPrefetchFailures=12]="getRangeContentPrefetchFailures";xa[xa.gridBlockUpdates=13]="gridBlockUpdates";xa[xa.browserAppStart=14]="browserAppStart";xa[xa.linkedObjects=15]="linkedObjects";xa[xa.longFrames=16]="longFrames";xa[xa.task=17]="task";xa[xa.conflictInEditing=18]="conflictInEditing";
xa[xa.incomingPresenceData=19]="incomingPresenceData";xa[xa.editorTableDelay=20]="editorTableDelay";xa[xa.presenceStartup=21]="presenceStartup";xa[xa.presenceDelete=22]="presenceDelete";xa[xa.editorEvent=23]="editorEvent";xa[xa.editorTime=24]="editorTime";xa[xa.gridScreenReaderOps=25]="gridScreenReaderOps";xa[xa.sendPresenceToService=26]="sendPresenceToService";xa[xa.IME=27]="IME";xa[xa.freezePaneFloatingObjects=28]="freezePaneFloatingObjects";xa[xa.customizeStatusBar=29]="customizeStatusBar";xa[xa.clientWebRequests=
30]="clientWebRequests";xa[xa.showCommentTaskPane=31]="showCommentTaskPane";xa[xa.applyThreadedCommentChange=32]="applyThreadedCommentChange";xa[xa.upgradeLegacyCommentsChange=33]="upgradeLegacyCommentsChange";xa[xa.findNextOrPreviousComment=34]="findNextOrPreviousComment";xa[xa.goto=35]="goto";xa[xa.launchOfficeAddInDialog=36]="launchOfficeAddInDialog";xa[xa.richApiInvocation=37]="richApiInvocation";xa[xa.fxLibrary=38]="fxLibrary";xa[xa.embeddedApiSession=39]="embeddedApiSession";xa[xa.numberFormattingCalculator=
40]="numberFormattingCalculator";xa[xa.requestDataAfterSend=41]="requestDataAfterSend";xa[xa.floatingObjectsStopwatchData=42]="floatingObjectsStopwatchData";xa[xa.copy=43]="copy";xa[xa.paste=44]="paste";xa[xa.dragDrop=45]="dragDrop";xa[xa.clearCopyState=46]="clearCopyState";xa[xa.webWorkerRecalcStats=47]="webWorkerRecalcStats";xa[xa.dataValidationEditOpenDialog=48]="dataValidationEditOpenDialog";xa[xa.dataValidationEditSubmitRule=49]="dataValidationEditSubmitRule";xa[xa.customSort=50]="customSort";
xa[xa.namedSheetViewUserAction=51]="namedSheetViewUserAction";xa[xa.namedSheetViewTeachingCallout=52]="namedSheetViewTeachingCallout";xa[xa.namedSheetViewTeachingDialog=53]="namedSheetViewTeachingDialog";xa[xa.namedSheetViewOptionsDialog=54]="namedSheetViewOptionsDialog";xa[xa.namedSheetViewTempViewSaveDialog=55]="namedSheetViewTempViewSaveDialog";xa[xa.temporaryViewStartedDataRestore=56]="temporaryViewStartedDataRestore";xa[xa.temporaryViewFetchedVersion=57]="temporaryViewFetchedVersion";xa[xa.raiseEventsAndGenerateBlockRequests=
58]="raiseEventsAndGenerateBlockRequests";xa[xa.launchMakerCodeEditor=59]="launchMakerCodeEditor"})(bh||(bh={}));Object(v.b)("UsageTable",bh);var Yg=a(432),kh=a(483),qh=a(616),nh=a(668),Zg=a(282);class Rg extends Sys.EventArgs{constructor(){super();this.Q_i=0;this.operation="DOMUpdate";this.sender=this.target=null}}Object(v.a)(Rg,"CalculatedAverageUpdatedEventArgs",Sys.EventArgs,[]);class Eh{constructor(xa,wa){this.eZd=void 0===wa?1:wa;this.total=xa}get average(){return this.total/this.eZd}djh(xa){return new Eh(this.total+
xa.total,this.eZd+xa.eZd)}static C$g(xa,wa){return`${xa}_${wa}`}}Object(v.a)(Eh,"StopwatchAverage",null,[]);var hh;(function(xa){xa[xa.longFrame=0]="longFrame";xa[xa.longGetRange=1]="longGetRange";xa[xa.longJsTask=2]="longJsTask";xa[xa.viewportCalculationLoops=3]="viewportCalculationLoops"})(hh||(hh={}));Object(v.b)("UtrKpiVeto",hh);class ch{static C$a(xa){return Enum.toString(hh,xa)}}ch.RGa="UTR";Object(v.a)(ch,"KpiConstants",null,[]);class qg{}qg.Jxg="UTRVetoName";qg.Bxg="UTRErrorName";qg.Fxg="UTROperationName";
qg.nNc="UTRDuration";qg.Hxg="UTREndedInPhase";qg.Oae="UTRMessage";qg.Ixg="UtrUnavailabilityType";qg.operationName="OperationName";qg.duration="Duration";qg.message="Message";Object(v.a)(qg,"UtrAdditionalData",null,[]);class zg{}zg.znk="VetoLike";zg.DZe="E2EOperationPerf";zg.KFj="RequestPerf";zg.Eek="UnavailabilityDurations";Object(v.a)(zg,"UtrTypes",null,[]);class wh{ZRb(xa,wa,Ic){Ic=void 0===Ic?null:Ic;Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Ic=Ic?Object(Vc.a)(new ba.a,
{extendedProperties:Ic}):null,xa=ch.C$a(xa),V.Health.instance.recordKpiImpliedFailure("UTR_Veto_"+xa,wa,!1,!0,"",Ic))}NTb(xa,wa,Ic,Zd,Ke,Te){Te[ch.RGa]=zg.znk;Te[qg.Jxg]=ch.C$a(Zd);Te[qg.Bxg]=Ke;x.ULS.sendTraceTag(xa,wa,Ic,je.a.He(Te));delete Te[ch.RGa];delete Te[qg.Jxg];delete Te[qg.Bxg]}}Object(v.a)(wh,"UtrKpiVetoReporter",null,[]);class Ag{eSb(xa,wa){wa=void 0===wa?null:wa;Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||V.Health.instance.recordKpiUsage("UTR_Veto_Usage_"+
ch.C$a(xa),0,"",wa)}ZRb(xa,wa,Ic){Ic=void 0===Ic?null:Ic;Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(xa=ch.C$a(xa),V.Health.instance.recordKpiFailure("UTR_Veto_Usage_"+xa,wa,!1,!0,this.Ldd(Ic)))}SEj(xa,wa){wa=void 0===wa?null:wa;Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||V.Health.instance.recordKpiImpliedSuccess("UTR_Veto_Usage_"+ch.C$a(xa),"",this.Ldd(wa))}REj(xa,wa,Ic){Ic=void 0===Ic?null:Ic;Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
(xa=ch.C$a(xa),V.Health.instance.recordKpiImpliedFailure("UTR_Veto_Usage_"+xa,wa,!1,!0,"",this.Ldd(Ic)))}Ldd(xa){return xa?Object(Vc.a)(new ba.a,{extendedProperties:xa}):null}}Object(v.a)(Ag,"UtrKpiVetoUsageReporter",null,[]);class Sg{SDc(xa,wa,Ic){Ic=void 0===Ic?null:Ic;Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||V.Health.instance.recordKpiImpliedSuccess("UTR_Perf_E2EOperation_"+xa,"",Object(Vc.a)(new ba.a,{extendedProperties:Ic,durationMs:wa}))}ZDc(xa,wa,Ic){Ic=void 0===
Ic?null:Ic;Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(wa?V.Health.instance.recordKpiImpliedSuccess("UTR_Perf_Request_"+xa,"",Object(Vc.a)(new ba.a,{extendedProperties:Ic})):V.Health.instance.recordKpiImpliedFailure("UTR_Perf_Request_"+xa,"",!1,!1,"",Object(Vc.a)(new ba.a,{extendedProperties:Ic})))}KTb(xa,wa,Ic,Zd,Ke,Te,If,...Ef){If=String.format(If,...Ef);Ef={};Ef[ch.RGa]=zg.DZe;Ef[qg.Fxg]=Zd;Ef[qg.Hxg]=Ke;Ef[qg.nNc]=Te;Ef[qg.Oae]=If;x.ULS.sendTraceTag(xa,wa,Ic,je.a.He(Ef))}TFc(xa,
wa,Ic,Zd,Ke,Te,If){const Ef={};Ef[ch.RGa]=zg.DZe;Ef[qg.Fxg]=Zd;Ef[qg.Hxg]=Ke;Ef[qg.nNc]=Te;Ef[qg.Oae]=If;x.ULS.sendTraceTag(xa,wa,Ic,je.a.He(Ef))}MTb(xa,wa,Ic,Zd,Ke,Te){this.ihg(Te,Zd,Ke);x.ULS.sendTraceTag(xa,wa,Ic,je.a.He(Te));this.lyh(Te)}LTb(xa,wa,Ic,Zd,Ke,Te,...If){Te=String.format(Te,...If);If={};this.ihg(If,Zd,Ke,Te);x.ULS.sendTraceTag(xa,wa,Ic,je.a.He(If))}UFc(xa,wa,Ic,Zd){Zd[ch.RGa]=zg.KFj;x.ULS.sendTraceTag(xa,wa,Ic,je.a.He(Zd));delete Zd[ch.RGa]}ihg(xa,wa,Ic,Zd){Zd=void 0===Zd?null:Zd;
xa[ch.RGa]=zg.Eek;xa[qg.Ixg]=wa;xa[qg.nNc]=Ic;Zd&&(xa[qg.Oae]=Zd)}lyh(xa){delete xa[ch.RGa];delete xa[qg.Ixg];delete xa[qg.nNc]}}Object(v.a)(Sg,"UtrOperationPerfReporter",null,[]);class dh extends xd.a{constructor(xa,wa,Ic,Zd,Ke,Te){Ic=void 0===Ic?null:Ic;Zd=void 0===Zd?null:Zd;Ke=void 0===Ke?null:Ke;Te=void 0===Te?!1:Te;super();this.WRh=[Dd.a.TIe,Dd.a.l1e,Dd.a.m1e,Dd.a.soc,Dd.a.muc,Dd.a.TQi,Dd.a.renderCachedContent,Dd.a.renderServerContent,Dd.a.udc,Dd.a.rKj,Dd.a.Qbg,Dd.a.Rbg,Dd.a.ZNj];this.asb=this.eIa=
this.sYb=this.umb=this.ape=this.YHe=this.X1a=this.bwe=null;this.NXf=this.RIe=!1;this.Exg=this.Dxg=this.Gxg=this.sXd=this.Syg=null;this.eJi=Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:7971370_ResourceTimingFontStatus");this.aTf=(If,Ef)=>{for(If=0;If<Ef.entries.length;If++){const Kc=Ef.entries[If];Kc.url=E.a.removeParameter(Kc.url,n.AFrameworkApplication.SJ);var ta=E.a.j4(Kc.url);!Ha.EwaSettings.Ea(426)&&this.UIi(Kc.url,ta)&&(Kc.behavior=1);if("img"===Kc.Lt.initiatorType&&ta.endsWith(Nh.a.gid)){var zb=
E.a.u2(Kc.url,Nh.a.fid),qc=E.a.u2(Kc.url,Nh.a.hid);Kc.HX=`${Kc.HX}imageID=${zb}, imgStateID=${qc}`}this.eJi&&"css"===Kc.Lt.initiatorType&&"responseStatus"in Kc.Lt&&(zb=`responseStatus=${Kc.Lt.lsk}`,Kc.HX=Kc.HX?`${Kc.HX},${zb}`:zb);zb=Kc.Lt.transferSize;let Xc;qc=Kc.Lt.decodedBodySize;void 0!==zb&&null!==zb&&void 0!==qc&&null!==qc?Xc=0===zb&&0<qc:void 0!==zb&&null!==zb&&(Xc=0===zb);Yd.PageLoadTrackingInfo.instance.VWg(ta,Math.round(Kc.Lt.fetchStart),Math.round(Kc.Lt.responseEnd),Xc,this.DKi);Na.a.contains(ta,
Dd.a.richTextEditor,!0)&&(ta=Og.TextEditorTelemetry.instance,ta.hH(Dd.a.iHj,Math.round(Kc.Lt.fetchStart)),ta.hH(Dd.a.kHj,Math.round(Kc.Lt.responseEnd)))}};this.BI=()=>{const If=this.jba;for(let Ef in If)If[Ef].h=!0};this.userSessionId=xa;this.H6a=Ic=Ic||new qh.a;this.zj=Zd||qa.a.$b;this.b6j=Ke||this;this.DKi=Te;this.PVe=Ic.eeb();Ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Mb.a.resolve(Aa.O).then(If=>{this.Zf=If;this.Zf.P0(this.BI)}):
(this.Zf=new e,this.Zf.P0(this.BI),wa.Qa(291,this.Zf))}get jba(){return this.bwe||(this.bwe={})}get VUe(){return this.umb||this.PVe}get eVe(){return this.eIa||dh.aJf}get i6d(){return this.YHe=this.YHe||{}}get hAc(){return this.X1a||"undefined"===typeof Stw?this.X1a:this.X1a=Stw.swpc}get WDf(){return this.ape=this.ape||{}}get OEa(){return this.asb||(this.asb=wb.a.instance.Qd("Common.NetworkTiming.IResourceTimingLogger"))}get Cxg(){return this.Dxg||(this.Dxg=new wh)}get c_a(){return this.Gxg||(this.Gxg=
new Sg)}get oNc(){return this.Exg||(this.Exg=new Ag)}gJc(xa,wa,Ic,Zd,Ke){Ke=void 0===Ke?null:Ke;if(this.jba[Ic])throw Error.invalidOperation("The specified stopwatchId is already in use.");this.jba[Ic]=this.rUe(xa,wa,Ic,Zd,Ke)}tgc(xa,wa){const Ic=this.jba[xa];Ic&&(this.bQe(Ic,wa),this.Cgk(Ic),delete this.jba[xa])}e6f(xa){delete this.jba[xa]}lng(xa,wa){this.umb||this.$mg(xa,wa)}Vmg(){this.lng(dh.cud,this.zj.og)}$_e(xa,wa){wa=void 0===wa?!1:wa;if(this.umb){if(this.eIa===dh.zPd||this.eIa===dh.cud){const Ic=
M.a.instance;Ic.userSessionId=this.userSessionId;if(this.eIa===dh.zPd){this.RIe||(this.Vpa(xa.m,Object(Ua.a)(Ic,Ic.hvj,"recordContentFetchEnd")),this.RIe=!0);if(wa){this.NXf||(this.Vpa(xa.m,Object(Ua.a)(Ic,Ic.tvj,"recordPerceivedContentDisplayed")),this.NXf=!0);return}this.Vpa(xa.m,Object(Ua.a)(Ic,Ic.gvj,"recordContentDisplayed"))}else this.eIa===dh.cud&&(wa=this.jba[this.sYb])&&this.Vpa(Zg.a(xa,wa.s),Object(Ua.a)(Ic,Ic.ovj,"recordInteractivityContentDisplayed"),!1)}this.tgc(this.sYb,xa);this.sYb=
this.eIa=this.umb=null}}Vpa(xa,wa,Ic){Ic=void 0===Ic?!0:Ic;M.a.aT&&Object(Jh.a)(nh.PerformanceClock,qa.a.$b)&&Ic&&(xa+=window.performance.timing.navigationStart);wa(xa)}zl(xa){return Yg.a(xa)}ih(xa,wa,Ic){Ic=void 0===Ic?!1:Ic;try{if(this.WDf[bh[xa]]=!0,Ic){var Zd=x.ULS,Ke=Zd.sendTraceTag;const ld={};let Mg=null;switch(xa){case 0:Mg="Actions";var Te=wa.a;null!=Te&&(ld.Id=Te);var If=null==wa.b?null:wa.b;null!=If&&(ld.Operation=If);var Ef=wa.c;null!=Ef&&(ld.Target=Ef);var ta=null==wa.d?null:wa.d.toString();
null!=ta&&(ld.StartTime=ta);var zb=null==wa.e?null:wa.e.toString();null!=zb&&(ld.Duration=zb);var qc=wa.f;null!=qc&&(ld.CorrelationId=qc);var Kc=wa.g;null!=Kc&&(ld.ParentAction=Kc);var Xc=null==wa.h?null:wa.h.toString();null!=Xc&&(ld.DocumentHidden=Xc);break;case 1:Mg="CorrelationStart";var Sd=wa.a;null!=Sd&&(ld.CorrelationId=Sd);var me=wa.b;null!=me&&(ld.UserSessionId=me);var Le=wa.c;null!=Le&&(ld.UserAction=Le);break;case 2:Mg="ReorderSheetOp";var Xe=wa.a;null!=Xe&&(ld.UserSessionId=Xe);var rf=
null==wa.b?null:wa.b.toString();null!=rf&&(ld.IsDragReorder=rf);var Ff=null==wa.c?null:wa.c.toString();null!=Ff&&(ld.DocumentUp=Ff);var Kf=null==wa.d?null:wa.d.toString();null!=Kf&&(ld.OldIndex=Kf);var Pf=null==wa.e?null:wa.e.toString();null!=Pf&&(ld.NewIndex=Pf);var ya=null==wa.f?null:wa.f.toString();null!=ya&&(ld.TotalSheets=ya);break;case 3:Mg="FormatCellOp";var Db=wa.a;null!=Db&&(ld.UserSessionId=Db);var lc=null==wa.b?null:wa.b.toString();null!=lc&&(ld.TaskId=lc);var zc=null==wa.c?null:wa.c.toString();
null!=zc&&(ld.NumberOfRanges=zc);var id=wa.d;null!=id&&(ld.Ranges=id);var Vd=wa.e;null!=Vd&&(ld.ActiveCell=Vd);var de=null==wa.f?null:wa.f.toString();null!=de&&(ld.ActionId=de);var Je=wa.g;null!=Je&&(ld.CommandParameters=Je);var Ze=wa.h;null!=Ze&&(ld.UserActionStopwatchId=Ze);break;case 4:Mg="CopyOp";var yf=wa.a;null!=yf&&(ld.UserSessionId=yf);var Lf=null==wa.b?null:wa.b.toString();null!=Lf&&(ld.IsChrome=Lf);var aa=null==wa.c?null:wa.c.toString();null!=aa&&(ld.IsIE=aa);var db=null==wa.d?null:wa.d.toString();
null!=db&&(ld.IsFromUI=db);var N=null==wa.e?null:wa.e.toString();null!=N&&(ld.IsCopyInLoadedRange=N);var pa=null==wa.f?null:wa.f.toString();null!=pa&&(ld.IsRepeatedCopy=pa);var Ib=null==wa.g?null:wa.g.toString();null!=Ib&&(ld.IsClipboarAccessSupported=Ib);var nc=null==wa.h?null:wa.h.toString();null!=nc&&(ld.IsClipboarAccessInstallationSupported=nc);var kd=null==wa.i?null:wa.i.toString();null!=kd&&(ld.RibbonCommand=kd);var Wd=null==wa.j?null:wa.j.toString();null!=Wd&&(ld.CutCopyPasteFlags=Wd);var Ae=
null==wa.k?null:wa.k.toString();null!=Ae&&(ld.IsDrag=Ae);var Oe=null==wa.l?null:wa.l.toString();null!=Oe&&(ld.IsIeBeforeAlowDenyPopUp=Oe);var sf=wa.m;null!=sf&&(ld.IsPasteMatchCopy=sf);var ff=wa.n;null!=ff&&(ld.WaitMessageInClipboard=ff);var cg=null==wa.o?null:wa.o.toString();null!=cg&&(ld.CallCount=cg);break;case 5:Mg="PasteOp";var jg=wa.a;null!=jg&&(ld.UserSessionId=jg);var pg=null==wa.b?null:wa.b.toString();null!=pg&&(ld.IsChrome=pg);var Wg=null==wa.c?null:wa.c.toString();null!=Wg&&(ld.IsIE=Wg);
var ih=null==wa.d?null:wa.d.toString();null!=ih&&(ld.IsCopyActive=ih);var Ah=null==wa.e?null:wa.e.toString();null!=Ah&&(ld.IsFromUI=Ah);var ki=null==wa.f?null:wa.f.toString();null!=ki&&(ld.IsClipboarAccessSupported=ki);var ai=null==wa.g?null:wa.g.toString();null!=ai&&(ld.IsClipboarAccessInstallationSupported=ai);var fg=null==wa.h?null:wa.h.toString();null!=fg&&(ld.RibbonCommand=fg);var Bi=null==wa.i?null:wa.i.toString();null!=Bi&&(ld.CutCopyPasteFlags=Bi);var Wi=wa.j;null!=Wi&&(ld.WaitMessageInClipboard=
Wi);var Pi=wa.k;null!=Pi&&(ld.PopupDialog=Pi);var Qi=wa.l;null!=Qi&&(ld.SimplePopupMessage=Qi);var zh=wa.m;null!=zh&&(ld.DialogCloseButton=zh);var Ri=wa.n;null!=Ri&&(ld.UserPressedInstallLink=Ri);var Jg=null==wa.o?null:wa.o.toString();null!=Jg&&(ld.CallCount=Jg);break;case 6:Mg="GetNumberViewModelDataOp";var hj=wa.a;null!=hj&&(ld.UserSessionId=hj);var Ci=wa.b;null!=Ci&&(ld.NumberFormatOptionsPreviousOutputJson=Ci);var ij=wa.c;null!=ij&&(ld.NumberFormatOptionsNewInputJson=ij);break;case 7:Mg="InstantaneousSetData";
var yi=wa.a;null!=yi&&(ld.Id=yi);var Th=null==wa.b?null:wa.b.toString();null!=Th&&(ld.WasEmpty=Th);var Uh=null==wa.c?null:wa.c.toString();null!=Uh&&(ld.ValueNotChanged=Uh);var lj=wa.d;null!=lj&&(ld.Source=lj);var pi=null==wa.e?null:wa.e.toString();null!=pi&&(ld.ProcessingCompleted=pi);break;case 8:Mg="ImmediateSetData";var jh=wa.a;null!=jh&&(ld.ClientStopwatchId=jh);var Qe=wa.b;null!=Qe&&(ld.Operation=Qe);var F=wa.c;null!=F&&(ld.Parameters=F);var ea=null==wa.d?null:wa.d.toString();null!=ea&&(ld.WasUpdatedByImmediate=
ea);var Ma=null==wa.e?null:wa.e.toString();null!=Ma&&(ld.areHtmlElementsEqualClientComparison=Ma);var Cb=null==wa.f?null:wa.f.toString();null!=Cb&&(ld.WasDecisionMadeByHtmlComparison=Cb);var mc=null==wa.g?null:wa.g.toString();null!=mc&&(ld.IsNumeric=mc);var Pc=null==wa.h?null:wa.h.toString();null!=Pc&&(ld.IsDateTime=Pc);var Rc=null==wa.i?null:wa.i.toString();null!=Rc&&(ld.HasCurrencySymbol=Rc);var ud=null==wa.j?null:wa.j.toString();null!=ud&&(ld.HasPercentSymbol=ud);var od=null==wa.k?null:wa.k.toString();
null!=od&&(ld.IsFunc=od);var Ed=null==wa.l?null:wa.l.toString();null!=Ed&&(ld.DiffInWrappingWhitespace=Ed);var oe=wa.m;null!=oe&&(ld.ImmediatePattern=oe);var Ne=null==wa.n?null:wa.n.toString();null!=Ne&&(ld.TextAlignmentMatch=Ne);var ef=null==wa.o?null:wa.o.toString();null!=ef&&(ld.FontColorMatch=ef);var Mf=null==wa.p?null:wa.p.toString();null!=Mf&&(ld.FormulaTextMatch=Mf);var nf=null==wa.q?null:wa.q.toString();null!=nf&&(ld.isFormula=nf);var Df=wa.r;null!=Df&&(ld.FormulaText=Df);var wg=wa.s;null!=
wg&&(ld.InstantaneousPattern=wg);var Sf=null==wa.t?null:wa.t.toString();null!=Sf&&(ld.AreHtmlInnerTextElementsEqualClientComparison=Sf);var gg=wa.u;null!=gg&&(ld.HtmlComparisonDecision=gg);break;case 9:Mg="DependentCellsCalc";var dg=wa.a;null!=dg&&(ld.CalcStatus=dg);var kg=null==wa.b?null:wa.b.toString();null!=kg&&(ld.SuccessfullyCalculatedRanges=kg);var Zf=null==wa.c?null:wa.c.toString();null!=Zf&&(ld.RangesSkipped=Zf);var qd=null==wa.d?null:wa.d.toString();null!=qd&&(ld.TotalErrors=qd);var ie=null==
wa.e?null:wa.e.toString();null!=ie&&(ld.Partial=ie);var og=null==wa.f?null:wa.f.toString();null!=og&&(ld.Canceled=og);var ah=null==wa.g?null:wa.g.toString();null!=ah&&(ld.Aggregate=ah);var vi=null==wa.h?null:wa.h.toString();null!=vi&&(ld.Unknown=vi);var Xg=null==wa.i?null:wa.i.toString();null!=Xg&&(ld.UnavailableData=Xg);var wi=null==wa.j?null:wa.j.toString();null!=wi&&(ld.Cycle=wi);var uh=null==wa.k?null:wa.k.toString();null!=uh&&(ld.NotImplemented=uh);var Ai=null==wa.l?null:wa.l.toString();null!=
Ai&&(ld.InvalidInput=Ai);var gj=null==wa.m?null:wa.m.toString();null!=gj&&(ld.AreDepCells=gj);break;case 10:Mg="DependentCellsGraphStat";var xi=null==wa.a?null:wa.a.toString();null!=xi&&(ld.ParsedFormulas=xi);var nj=null==wa.b?null:wa.b.toString();null!=nj&&(ld.GraphNodes=nj);var jj=null==wa.c?null:wa.c.toString();null!=jj&&(ld.GraphArcs=jj);var Yi=null==wa.d?null:wa.d.toString();null!=Yi&&(ld.AnalyzedBlocks=Yi);var uj=null==wa.e?null:wa.e.toString();null!=uj&&(ld.IterationId=uj);var oj=wa.f;null!=
oj&&(ld.UniqueId=oj);var Bh=null==wa.g?null:wa.g.toString();null!=Bh&&(ld.Aborted=Bh);break;case 11:Mg="DependentCellsGraphSectionStat";var rh=null==wa.a?null:wa.a.toString();null!=rh&&(ld.IterationId=rh);var Ji=wa.b;null!=Ji&&(ld.BlockHash=Ji);var Ki=wa.c;null!=Ki&&(ld.Functions=Ki);var Ig=wa.d;null!=Ig&&(ld.Operators=Ig);var Ti=null==wa.e?null:wa.e.toString();null!=Ti&&(ld.CrossDocRefs=Ti);var ii=null==wa.f?null:wa.f.toString();null!=ii&&(ld.CrossSheetRefs=ii);var di=null==wa.g?null:wa.g.toString();
null!=di&&(ld.ErrRefs=di);var ng=null==wa.h?null:wa.h.toString();null!=ng&&(ld.LargeRanges=ng);var Zi=null==wa.i?null:wa.i.toString();null!=Zi&&(ld.NameRefs=Zi);var Rh=null==wa.j?null:wa.j.toString();null!=Rh&&(ld.ParserErrors=Rh);var Lh=null==wa.k?null:wa.k.toString();null!=Lh&&(ld.RowRefs=Lh);var Xh=null==wa.l?null:wa.l.toString();null!=Xh&&(ld.ColumnRefs=Xh);var qi=null==wa.m?null:wa.m.toString();null!=qi&&(ld.TableRefs=qi);var Tg=wa.n;null!=Tg&&(ld.UniqueId=Tg);var mi=null==wa.o?null:wa.o.toString();
null!=mi&&(ld.UnreachableReferences=mi);break;case 12:Mg="GetRangeContentPrefetchFailures";var Ih=wa.a;null!=Ih&&(ld.UserSessionId=Ih);var ei=wa.b;null!=ei&&(ld.ClientStopwatchId=ei);var aj=null==wa.c?null:wa.c.toString();null!=aj&&(ld.StateId=aj);break;case 13:Mg="GridBlockUpdates";var vj=wa.a;null!=vj&&(ld.UserSessionId=vj);var kj=wa.b;null!=kj&&(ld.CorrelationId=kj);var Nj=wa.c;null!=Nj&&(ld.Operation=Nj);var wj=null==wa.d?null:wa.d.toString();null!=wj&&(ld.PerformanceType=wj);var Cg=wa.e;null!=
Cg&&(ld.BlockHash=Cg);var Ei=null==wa.f?null:wa.f.toString();null!=Ei&&(ld.DurationInMs=Ei);break;case 14:Mg="BrowserAppStart";var pj=null==wa.a?null:Qg.a.Wxa(wa.a.getTime());null!=pj&&(ld.ScriptExecutionStart=pj);var Gj=wa.b;null!=Gj&&(ld.UserSessionId=Gj);var rj=wa.c;null!=rj&&(ld.ClockMechanism=rj);var Li=null==wa.d?null:wa.d.toString();null!=Li&&(ld.ScreenDPI=Li);var Mi=null==wa.e?null:wa.e.toString();null!=Mi&&(ld.NavigationToScriptExecutionDelta=Mi);break;case 15:Mg="LinkedObjects";var si=wa.a;
null!=si&&(ld.ChildId=si);var bj=wa.b;null!=bj&&(ld.ParentId=bj);var $i=wa.c;null!=$i&&(ld.ChildTable=$i);var Ni=wa.d;null!=Ni&&(ld.ParentTable=Ni);break;case 16:Mg="LongFrames";var ti=null==wa.a?null:Qg.a.Wxa(wa.a.getTime());null!=ti&&(ld.StartTime=ti);var xj=null==wa.b?null:wa.b.toString();null!=xj&&(ld.DurationInMs=xj);break;case 17:Mg="Task";var Bg=wa.a;null!=Bg&&(ld.StopwatchId=Bg);var sh=null==wa.b?null:wa.b.toString();null!=sh&&(ld.Status=sh);var Oi=null==wa.c?null:wa.c.toString();null!=Oi&&
(ld.CreateTime=Oi);var ji=null==wa.d?null:wa.d.toString();null!=ji&&(ld.TaskId=ji);break;case 18:Mg="ConflictInEditing";var ui=wa.a;null!=ui&&(ld.OtherUserState=ui);var fi=wa.b;null!=fi&&(ld.UserSessionId=fi);var ri=null==wa.c?null:Qg.a.Wxa(wa.c.getTime());null!=ri&&(ld.ConflictTime=ri);break;case 19:Mg="IncomingPresenceData";var sj=wa.a;null!=sj&&(ld.UserSessionId=sj);var cj=wa.b;null!=cj&&(ld.UserId=cj);var Gi=null==wa.c?null:wa.c.toString();null!=Gi&&(ld.Disconnected=Gi);var xh=null==wa.d?null:
Qg.a.Wxa(wa.d.getTime());null!=xh&&(ld.ReceivedTime=xh);break;case 20:Mg="EditorTableDelay";var tj=wa.a;null!=tj&&(ld.UserSessionId=tj);var Mh=wa.b;null!=Mh&&(ld.UserId=Mh);var A=null==wa.c?null:wa.c.toString();null!=A&&(ld.Received=A);var ca=null==wa.d?null:wa.d.toString();null!=ca&&(ld.DurationInMs=ca);var Ra=null==wa.e?null:wa.e.toString();null!=Ra&&(ld.NotAloneAtLogTime=Ra);var Zb=null==wa.f?null:Qg.a.Wxa(wa.f.getTime());null!=Zb&&(ld.Time=Zb);break;case 21:Mg="PresenceStartup";var wc=wa.a;null!=
wc&&(ld.UserSessionId=wc);var Jc=null==wa.b?null:wa.b.toString();null!=Jc&&(ld.EverReceived=Jc);var fd=null==wa.c?null:wa.c.toString();null!=fd&&(ld.NotAloneOnOpen=fd);var $d=null==wa.d?null:wa.d.toString();null!=$d&&(ld.NotAloneAtLogTime=$d);var Be=null==wa.e?null:wa.e.toString();null!=Be&&(ld.EditorCount=Be);var Re=null==wa.f?null:wa.f.toString();null!=Re&&(ld.WorkbookOpenToFirstReceivedInMs=Re);break;case 22:Mg="PresenceDelete";var lf=wa.a;null!=lf&&(ld.UserSessionId=lf);var xf=wa.b;null!=xf&&
(ld.UserId=xf);var $f=wa.c;null!=$f&&(ld.Context=$f);var tg=wa.d;null!=tg&&(ld.Reason=tg);var Vf=null==wa.e?null:Qg.a.Wxa(wa.e.getTime());null!=Vf&&(ld.Time=Vf);break;case 23:Mg="EditorEvent";var ug=wa.a;null!=ug&&(ld.UserSessionId=ug);var lh=wa.b;null!=lh&&(ld.UserId=lh);var ni=wa.c;null!=ni&&(ld.Context=ni);var oi=null==wa.d?null:Qg.a.Wxa(wa.d.getTime());null!=oi&&(ld.Time=oi);break;case 24:Mg="EditorTime";var Oj=wa.a;null!=Oj&&(ld.UserSessionId=Oj);var Hi=wa.b;null!=Hi&&(ld.UserId=Hi);var yj=null==
wa.c?null:wa.c.toString();null!=yj&&(ld.DurationInMs=yj);break;case 25:Mg="GridScreenReaderOps";var P=wa.a;null!=P&&(ld.UserSessionId=P);var Qa=wa.b;null!=Qa&&(ld.CommandTaskId=Qa);var mb=null==wa.c?null:wa.c.toString();null!=mb&&(ld.CommandId=mb);var fc=null==wa.d?null:wa.d.toString();null!=fc&&(ld.ClientSideOnly=fc);var Ec=null==wa.e?null:wa.e.toString();null!=Ec&&(ld.DurationInMS=Ec);var td=null==wa.f?null:wa.f.toString();null!=td&&(ld.ReachedMaxReadoutCells=td);var rd=null==wa.g?null:wa.g.toString();
null!=rd&&(ld.RequstedCellCount=rd);var Qd=null==wa.h?null:wa.h.toString();null!=Qd&&(ld.NonEmptyCellCount=Qd);var Mc=null==wa.i?null:wa.i.toString();null!=Mc&&(ld.Succeeded=Mc);var Hd=null==wa.j?null:wa.j.toString();null!=Hd&&(ld.Canceled=Hd);var xe=wa.k;null!=xe&&(ld.ErrorType=xe);break;case 26:Mg="SendPresenceToService";var ee=wa.a;null!=ee&&(ld.UserSessionId=ee);var ve=null==wa.b?null:wa.b.toString();null!=ve&&(ld.TotalCount=ve);var af=null==wa.c?null:wa.c.toString();null!=af&&(ld.SendCount=af);
break;case 27:Mg="IME";var wf=wa.a;null!=wf&&(ld.UserSessionId=wf);break;case 28:Mg="FreezePaneFloatingObjects";var Hf=wa.a;null!=Hf&&(ld.UserSessionId=Hf);var ig=null==wa.b?null:wa.b.toString();null!=ig&&(ld.ObjectType=ig);var Bf=wa.c;null!=Bf&&(ld.ObjectID=Bf);var Uf=null==wa.d?null:wa.d.toString();null!=Uf&&(ld.SpannedPanesCount=Uf);break;case 29:Mg="CustomizeStatusBar";var Xf=wa.a;null!=Xf&&(ld.UserSessionId=Xf);var Lg=wa.b;null!=Lg&&(ld.UIControlName=Lg);var Ng=null==wa.c?null:wa.c.toString();
null!=Ng&&(ld.IsControlVisible=Ng);break;case 30:Mg="ClientWebRequests";var mh=wa.a;null!=mh&&(ld.Path=mh);var Gh=wa.b;null!=Gh&&(ld.ProxyStopwatchId=Gh);var Vh=wa.c;null!=Vh&&(ld.RequestStatus=Vh);var bi=null==wa.d?null:wa.d.toString();null!=bi&&(ld.ResponseSizeInBytes=bi);var Zh=wa.e;null!=Zh&&(ld.ClientRequestId=Zh);var Ii=null==wa.f?null:wa.f.toString();null!=Ii&&(ld.StateId=Ii);break;case 31:Mg="ShowCommentTaskPane";var $h=wa.a;null!=$h&&(ld.UserSessionId=$h);var Di=null==wa.b?null:wa.b.toString();
null!=Di&&(ld.IsFromKeyboardShortcut=Di);var Fg=null==wa.c?null:wa.c.toString();null!=Fg&&(ld.IsShowPane=Fg);var mg=null==wa.d?null:wa.d.toString();null!=mg&&(ld.ShowForDeepLink=mg);var rg=null==wa.e?null:wa.e.toString();null!=rg&&(ld.DeepLinkFound=rg);break;case 32:Mg="ApplyThreadedCommentChange";var Nf=wa.a;null!=Nf&&(ld.UserSessionId=Nf);var Kg=null==wa.b?null:wa.b.toString();null!=Kg&&(ld.Operation=Kg);var sg=wa.c;null!=sg&&(ld.CommentId=sg);var Pg=null==wa.d?null:wa.d.toString();null!=Pg&&(ld.CommentsCount=
Pg);break;case 33:Mg="UpgradeLegacyCommentsChange";var Fh=wa.a;null!=Fh&&(ld.UserSessionId=Fh);var ci=null==wa.b?null:wa.b.toString();null!=ci&&(ld.OperationSuccessful=ci);break;case 34:Mg="FindNextOrPreviousComment";var Si=wa.a;null!=Si&&(ld.UserSessionId=Si);var zi=null==wa.b?null:wa.b.toString();null!=zi&&(ld.Succeeded=zi);break;case 35:Mg="Goto";var Fi=wa.a;null!=Fi&&(ld.UserSessionId=Fi);var li=null==wa.b?null:wa.b.toString();null!=li&&(ld.IsSucceeded=li);var gi=null==wa.c?null:wa.c.toString();
null!=gi&&(ld.IsNOVMode=gi);break;case 36:Mg="LaunchOfficeAddInDialog";var Hg=wa.a;null!=Hg&&(ld.UserSessionId=Hg);var yg=wa.b;null!=yg&&(ld.SourceId=yg);var hi=wa.c;null!=hi&&(ld.SourceLabel=hi);var oh=wa.d;null!=oh&&(ld.Flight=oh);var Wh=wa.e;null!=Wh&&(ld.Experiment=Wh);var Hh=wa.f;null!=Hh&&(ld.UICultureTag=Hh);var Oh=null==wa.g?null:wa.g.toString();null!=Oh&&(ld.UICultureTagLcid=Oh);var Xi=null==wa.h?null:wa.h.toString();null!=Xi&&(ld.WacHostId=Xi);break;case 37:Mg="RichApiInvocation";var mj=
wa.a;null!=mj&&(ld.UserSessionId=mj);var rk=null==wa.b?null:wa.b.toString();null!=rk&&(ld.Succeeded=rk);var Hj=wa.c;null!=Hj&&(ld.ErrorType=Hj);var Ui=wa.d;null!=Ui&&(ld.ResultInfo=Ui);var jk=wa.e;null!=jk&&(ld.Source=jk);break;case 38:Mg="FxLibrary";var Yj=wa.a;null!=Yj&&(ld.EntityName=Yj);var fk=null==wa.b?null:wa.b.toString();null!=fk&&(ld.EntryPoint=fk);var dj=null==wa.c?null:wa.c.toString();null!=dj&&(ld.Action=dj);var kk=null==wa.d?null:wa.d.toString();null!=kk&&(ld.InsertLocation=kk);break;
case 39:Mg="EmbeddedApiSession";var lk=wa.a;null!=lk&&(ld.UserSessionId=lk);break;case 40:Mg="NumberFormattingCalculator";var gk=wa.a;null!=gk&&(ld.Id=gk);var mk=wa.b;null!=mk&&(ld.CounterName=mk);var nk=wa.c;null!=nk&&(ld.Values=nk);break;case 41:Mg="RequestDataAfterSend";var fh=wa.a;null!=fh&&(ld.ClientStopwatchId=fh);var Ij=wa.b;null!=Ij&&(ld.RequestStatus=Ij);var Pj=null==wa.c?null:wa.c.toString();null!=Pj&&(ld.SendDuration=Pj);var Qj=null==wa.d?null:wa.d.toString();null!=Qj&&(ld.RequestId=Qj);
break;case 42:Mg="FloatingObjectsStopwatchData";var zj=wa.a;null!=zj&&(ld.StopMessage=zj);var Rj=null==wa.b?null:wa.b.toString();null!=Rj&&(ld.Type=Rj);var Jj=wa.c;null!=Jj&&(ld.GUID=Jj);var Aj=null==wa.d?null:wa.d.toString();null!=Aj&&(ld.Pane=Aj);var Sj=null==wa.e?null:wa.e.toString();null!=Sj&&(ld.IsAboveGrid=Sj);var qj=wa.f;null!=qj&&(ld.StartCorrelation=qj);var Zj=wa.g;null!=Zj&&(ld.LoadImageCorrelation=Zj);var Tj=null==wa.h?null:wa.h.toString();null!=Tj&&(ld.SkippedGetEffectsExtents=Tj);var Kj=
null==wa.i?null:wa.i.toString();null!=Kj&&(ld.Version=Kj);break;case 43:Mg="Copy";var ok=wa.a;null!=ok&&(ld.UserSessionId=ok);var pk=wa.b;null!=pk&&(ld.Trigger=pk);var Uj=wa.c;null!=Uj&&(ld.RibbonCommandName=Uj);var wk=wa.d;null!=wk&&(ld.SourceItem=wk);var ak=null==wa.e?null:wa.e.toString();null!=ak&&(ld.SourceRangeCellCount=ak);var Vj=wa.f;null!=Vj&&(ld.ClientSideStopwatchId=Vj);var Bj=wa.g;null!=Bj&&(ld.CopyOperationId=Bj);var bk=null==wa.h?null:wa.h.toString();null!=bk&&(ld.IsAsync=bk);var Lj=
null==wa.i?null:wa.i.toString();null!=Lj&&(ld.IsFromCache=Lj);var ck=null==wa.j?null:wa.j.toString();null!=ck&&(ld.IsSuccessiveCopy=ck);var Cj=null==wa.k?null:wa.k.toString();null!=Cj&&(ld.IsSelectionAllowed=Cj);var Wj=null==wa.l?null:wa.l.toString();null!=Wj&&(ld.IsSuccess=Wj);var sk=null==wa.m?null:wa.m.toString();null!=sk&&(ld.IsExpectedError=sk);var Dj=wa.n;null!=Dj&&(ld.ExpectedErrorReason=Dj);var Xj=wa.o;null!=Xj&&(ld.ErrorMessage=Xj);var tk=null==wa.p?null:wa.p.toString();null!=tk&&(ld.ClientSideCopyTimeInMs=
tk);var uk=null==wa.q?null:wa.q.toString();null!=uk&&(ld.TotalTimeInMs=uk);var xg=null==wa.r?null:wa.r.toString();null!=xg&&(ld.PlainTextPayloadSize=xg);var qk=wa.s;null!=qk&&(ld.CopyPasteTargetType=qk);var K=null==wa.t?null:wa.t.toString();null!=K&&(ld.ShadowWorkbookPayloadSize=K);var Da=null==wa.u?null:wa.u.toString();null!=Da&&(ld.HtmlPayloadSize=Da);var xb=null==wa.v?null:wa.v.toString();null!=xb&&(ld.HtmlSizeExceedsLimit=xb);var kc=null==wa.w?null:wa.w.toString();null!=kc&&(ld.CopyTotalSizeExceedsLimit=
kc);var Nc=null==wa.x?null:wa.x.toString();null!=Nc&&(ld.ErrorReason=Nc);var md=wa.y;null!=md&&(ld.ErrorName=md);var Cd=null==wa.z?null:wa.z.toString();null!=Cd&&(ld.IsSucceededWithAlert=Cd);var Td=null==wa.ba?null:wa.ba.toString();null!=Td&&(ld.EncounteredDeploymentErrors=Td);var we=null==wa.bb?null:wa.bb.toString();null!=we&&(ld.ShadowWorkbookSizeExceedsLimit=we);var Fe=wa.bc;null!=Fe&&(ld.CopyPasteTargetName=Fe);var vf=wa.bd;null!=vf&&(ld.CCPSliceName=vf);var Jf=wa.be;null!=Jf&&(ld.SyncClipboardItemsKeys=
Jf);var lg=wa.bf;null!=lg&&(ld.AsyncClipboardItemsKeys=lg);var ph=wa.bg;null!=ph&&(ld.CopyPasteHandlerName=ph);var eh=wa.bh;null!=eh&&(ld.SucceededPopulatingSystemClipboardSync=eh);var $g=wa.bi;null!=$g&&(ld.SucceededPopulatingSystemClipboardAsync=$g);var Ug=wa.bj;null!=Ug&&(ld.Location=Ug);var Ch=wa.bk;null!=Ch&&(ld.CopyContextId=Ch);var Yh=null==wa.bl?null:wa.bl.toString();null!=Yh&&(ld.ServerRequestTimeInMs=Yh);var Dh=null==wa.bm?null:wa.bm.toString();null!=Dh&&(ld.EcsOperationDuration=Dh);var Ph=
null==wa.bn?null:wa.bn.toString();null!=Ph&&(ld.EcsRequestDuration=Ph);var ej=null==wa.bo?null:wa.bo.toString();null!=ej&&(ld.WfeRequestDuration=ej);var Ej=null==wa.bp?null:wa.bp.toString();null!=Ej&&(ld.OriginalSourceRangesCountExceedsLimit=Ej);var Bk=null==wa.bq?null:wa.bq.toString();null!=Bk&&(ld.UploadToClipServiceAttempted=Bk);var xk=null==wa.br?null:wa.br.toString();null!=xk&&(ld.FloatingObjectType=xk);break;case 44:Mg="Paste";var yk=wa.a;null!=yk&&(ld.UserSessionId=yk);var Ck=wa.b;null!=Ck&&
(ld.Trigger=Ck);var vk=wa.c;null!=vk&&(ld.RibbonCommandName=vk);var D=null==wa.d?null:wa.d.toString();null!=D&&(ld.PasteTypeFlagValue=D);var ha=wa.e;null!=ha&&(ld.PasteOperationId=ha);var fb=wa.f;null!=fb&&(ld.CopyOperationId=fb);var Vb=wa.g;null!=Vb&&(ld.ClientSideStopwatchId=Vb);var Gc=wa.h;null!=Gc&&(ld.OriginalDestinationRange=Gc);var zd=wa.i;null!=zd&&(ld.ExpandDestinationRange=zd);var ae=wa.j;null!=ae&&(ld.SourceItem=ae);var He=null==wa.k?null:wa.k.toString();null!=He&&(ld.SourceRangeCellCount=
He);var hf=null==wa.l?null:wa.l.toString();null!=hf&&(ld.IsSuccess=hf);var zf=null==wa.m?null:wa.m.toString();null!=zf&&(ld.IsExpectedError=zf);var vg=wa.n;null!=vg&&(ld.ClipboardFormatReadTimeInMs=vg);var gh=wa.o;null!=gh&&(ld.ClipboardFormatReadStatus=gh);var Kh=null==wa.p?null:wa.p.toString();null!=Kh&&(ld.ClipboardReadPermissionPromptShown=Kh);var th=null==wa.q?null:wa.q.toString();null!=th&&(ld.AsyncApiReadTimedOut=th);var Qh=wa.r;null!=Qh&&(ld.ExpectedErrorReason=Qh);var dk=wa.s;null!=dk&&(ld.ErrorMessage=
dk);var ek=null==wa.t?null:wa.t.toString();null!=ek&&(ld.TotalTimeInMs=ek);var hk=null==wa.u?null:wa.u.toString();null!=hk&&(ld.PlainTextPayloadSize=hk);var fj=null==wa.v?null:wa.v.toString();null!=fj&&(ld.ShadowWorkbookPayloadSize=fj);var Fj=null==wa.w?null:wa.w.toString();null!=Fj&&(ld.HtmlPayloadSize=Fj);var Vi=wa.x;null!=Vi&&(ld.CopyPasteTargetType=Vi);var Mj=null==wa.y?null:wa.y.toString();null!=Mj&&(ld.IsLastCopyWasExternal=Mj);var ik=null==wa.z?null:wa.z.toString();null!=ik&&(ld.IsClipboardDataContainShadowWorkbook=
ik);var zk=null==wa.ba?null:wa.ba.toString();null!=zk&&(ld.IsShadowWorkbookParsedSuccessfully=zk);var Ak=wa.bb;null!=Ak&&(ld.ActiveSelectionType=Ak);var Ik=wa.bc;null!=Ik&&(ld.PasteResult=Ik);var Jk=null==wa.bd?null:wa.bd.toString();null!=Jk&&(ld.ErrorReason=Jk);var Kk=wa.be;null!=Kk&&(ld.ErrorName=Kk);var Lk=null==wa.bf?null:wa.bf.toString();null!=Lk&&(ld.IsSucceededWithAlert=Lk);var Mk=null==wa.bg?null:wa.bg.toString();null!=Mk&&(ld.IsAfterCut=Mk);var Nk=null==wa.bh?null:wa.bh.toString();null!=
Nk&&(ld.EncounteredDeploymentErrors=Nk);var Ok=null==wa.bi?null:wa.bi.toString();null!=Ok&&(ld.IsCrossSession=Ok);var Pk=null==wa.bj?null:wa.bj.toString();null!=Pk&&(ld.ShadowWorkbookSizeExceedsLimit=Pk);var Qk=null==wa.bk?null:wa.bk.toString();null!=Qk&&(ld.ClipboardContainXLOPayload=Qk);var Rk=wa.bl;null!=Rk&&(ld.CopyPasteTargetName=Rk);var Sk=wa.bm;null!=Sk&&(ld.ChromeExtensionId=Sk);var Tk=wa.bn;null!=Tk&&(ld.PayloadOrigin=Tk);var Uk=wa.bo;null!=Uk&&(ld.PayloadType=Uk);var Vk=wa.bp;null!=Vk&&
(ld.CCPSliceName=Vk);var Wk=wa.bq;null!=Wk&&(ld.ClipboardItemsKeys=Wk);var Xk=wa.br;null!=Xk&&(ld.CopyPasteHandlerName=Xk);var Yk=null==wa.bs?null:wa.bs.toString();null!=Yk&&(ld.IsSourceItemOriginSameSession=Yk);var Zk=wa.bt;null!=Zk&&(ld.Location=Zk);var $k=wa.bu;null!=$k&&(ld.ExternalAppSource=$k);var al=wa.bv;null!=al&&(ld.PasteContextId=al);var bl=null==wa.bw?null:wa.bw.toString();null!=bl&&(ld.ServerRequestTimeInMs=bl);var cl=null==wa.bx?null:wa.bx.toString();null!=cl&&(ld.IndicationDisplayScheduled=
cl);var dl=wa.by;null!=dl&&(ld.PasteIndicationDisplayStatus=dl);var el=null==wa.bz?null:wa.bz.toString();null!=el&&(ld.PasteRecoveryUIDisplayed=el);var fl=null==wa.ca?null:wa.ca.toString();null!=fl&&(ld.IsFromPasteRecoveryUI=fl);var gl=null==wa.cb?null:wa.cb.toString();null!=gl&&(ld.EcsOperationDuration=gl);var hl=null==wa.cc?null:wa.cc.toString();null!=hl&&(ld.EcsRequestDuration=hl);var il=null==wa.cd?null:wa.cd.toString();null!=il&&(ld.WfeRequestDuration=il);var jl=null==wa.ce?null:wa.ce.toString();
null!=jl&&(ld.OriginalSourceRangesCountExceedsLimit=jl);var kl=wa.cf;null!=kl&&(ld.PasteRecoveryUndoStopwatchId=kl);var ll=null==wa.cg?null:wa.cg.toString();null!=ll&&(ld.PasteRecoveryUndoTimeInMs=ll);var ml=null==wa.ch?null:wa.ch.toString();null!=ml&&(ld.PasteCSEPerformed=ml);var nl=null==wa.ci?null:wa.ci.toString();null!=nl&&(ld.CSEStatus=nl);var ol=null==wa.cj?null:wa.cj.toString();null!=ol&&(ld.IsFromEnterShortcut=ol);var pl=null==wa.ck?null:wa.ck.toString();null!=pl&&(ld.pasteDestinationHasMergedCells=
pl);break;case 45:Mg="DragDrop";var ql=wa.a;null!=ql&&(ld.UserSessionId=ql);var rl=wa.b;null!=rl&&(ld.Trigger=rl);var sl=wa.c;null!=sl&&(ld.RibbonCommandName=sl);var tl=wa.d;null!=tl&&(ld.OperationId=tl);var ul=wa.e;null!=ul&&(ld.ClientSideStopwatchId=ul);var vl=wa.f;null!=vl&&(ld.SourceRange=vl);var wl=wa.g;null!=wl&&(ld.DestinationRange=wl);var xl=wa.h;null!=xl&&(ld.CutCopyType=xl);var yl=null==wa.i?null:wa.i.toString();null!=yl&&(ld.IsShiftKeyDown=yl);var zl=null==wa.j?null:wa.j.toString();null!=
zl&&(ld.IsDragInsert=zl);var Al=null==wa.k?null:wa.k.toString();null!=Al&&(ld.IsSuccess=Al);var Bl=null==wa.l?null:wa.l.toString();null!=Bl&&(ld.IsExpectedError=Bl);var Cl=wa.m;null!=Cl&&(ld.ExpectedErrorReason=Cl);var Dl=wa.n;null!=Dl&&(ld.ErrorMessage=Dl);var El=null==wa.o?null:wa.o.toString();null!=El&&(ld.TotalTimeInMs=El);var Fl=wa.p;null!=Fl&&(ld.ErrorName=Fl);var Gl=null==wa.q?null:wa.q.toString();null!=Gl&&(ld.IsSucceededWithAlert=Gl);var Hl=wa.r;null!=Hl&&(ld.CopyPasteTargetType=Hl);var Il=
null==wa.s?null:wa.s.toString();null!=Il&&(ld.EncounteredDeploymentErrors=Il);break;case 46:Mg="ClearCopyState";var Jl=wa.a;null!=Jl&&(ld.UserSessionId=Jl);var Kl=wa.b;null!=Kl&&(ld.ClientSideStopwatchId=Kl);var Ll=wa.c;null!=Ll&&(ld.Trigger=Ll);var Ml=null==wa.d?null:wa.d.toString();null!=Ml&&(ld.IsClearClipboard=Ml);var Nl=null==wa.e?null:wa.e.toString();null!=Nl&&(ld.IsExplicit=Nl);var Ol=null==wa.f?null:wa.f.toString();null!=Ol&&(ld.IsSuccess=Ol);var Pl=wa.g;null!=Pl&&(ld.ErrorMessage=Pl);var Ql=
wa.h;null!=Ql&&(ld.ErrorName=Ql);var Rl=null==wa.i?null:wa.i.toString();null!=Rl&&(ld.TotalTimeInMs=Rl);var Sl=wa.j;null!=Sl&&(ld.CopyPasteTargetType=Sl);break;case 47:Mg="WebWorkerRecalcStats";var Tl=null==wa.a?null:wa.a.toString();null!=Tl&&(ld.SuccessCount=Tl);var Ul=null==wa.b?null:wa.b.toString();null!=Ul&&(ld.FailureCount=Ul);var Vl=null==wa.c?null:wa.c.toString();null!=Vl&&(ld.ValueTypeMismatchCount=Vl);var Wl=null==wa.d?null:wa.d.toString();null!=Wl&&(ld.CellValueMismatchCount=Wl);var Xl=
null==wa.e?null:wa.e.toString();null!=Xl&&(ld.IfmtMismatchCount=Xl);var Yl=null==wa.f?null:wa.f.toString();null!=Yl&&(ld.FormattedTextMismatchCount=Yl);var Zl=null==wa.g?null:wa.g.toString();null!=Zl&&(ld.CellValueStringMismatchCount=Zl);var $l=null==wa.h?null:wa.h.toString();null!=$l&&(ld.CellValueNumberMismatchCount=$l);var am=null==wa.i?null:wa.i.toString();null!=am&&(ld.CellValueBooleanMismatchCount=am);var bm=null==wa.j?null:wa.j.toString();null!=bm&&(ld.CellValueBlankMismatchCount=bm);var cm=
null==wa.k?null:wa.k.toString();null!=cm&&(ld.CellValueErrorMismatchCount=cm);var dm=null==wa.l?null:wa.l.toString();null!=dm&&(ld.FormattedTextStringMismatchCount=dm);var em=null==wa.m?null:wa.m.toString();null!=em&&(ld.FormattedTextNumberMismatchCount=em);var fm=null==wa.n?null:wa.n.toString();null!=fm&&(ld.FormattedTextBooleanMismatchCount=fm);var gm=null==wa.o?null:wa.o.toString();null!=gm&&(ld.FormattedTextBlankMismatchCount=gm);var hm=null==wa.p?null:wa.p.toString();null!=hm&&(ld.FormattedTextErrorMismatchCount=
hm);var im=null==wa.q?null:wa.q.toString();null!=im&&(ld.StringMismatchCount=im);var jm=null==wa.r?null:wa.r.toString();null!=jm&&(ld.NumericMismatchCount=jm);var km=null==wa.s?null:wa.s.toString();null!=km&&(ld.ErrorMismatchCount=km);var lm=null==wa.t?null:wa.t.toString();null!=lm&&(ld.StringValuesCount=lm);var mm=null==wa.u?null:wa.u.toString();null!=mm&&(ld.NumericValuesCount=mm);var nm=null==wa.v?null:wa.v.toString();null!=nm&&(ld.BooleanValuesCount=nm);var om=null==wa.w?null:wa.w.toString();
null!=om&&(ld.BlankValuesCount=om);var pm=null==wa.x?null:wa.x.toString();null!=pm&&(ld.ErrorValuesCount=pm);var qm=null==wa.y?null:wa.y.toString();null!=qm&&(ld.NumericValuesDiffAverage=qm);var rm=wa.z;null!=rm&&(ld.NumericEvaluatedValuesMismatchSamples=rm);var sm=wa.ba;null!=sm&&(ld.NumericFormattedTextMismatchSamples=sm);var tm=wa.bb;null!=tm&&(ld.NumericMismatchSamples=tm);var um=wa.bc;null!=um&&(ld.CellValueTypeMismatchSamples=um);var vm=wa.bd;null!=vm&&(ld.IfmtMismatchSamples=vm);var wm=wa.be;
null!=wm&&(ld.BlockHashCode=wm);break;case 48:Mg="DataValidationEditOpenDialog";var xm=wa.a;null!=xm&&(ld.ServerCommand=xm);var ym=null==wa.b?null:wa.b.toString();null!=ym&&(ld.SubDialogOpened=ym);var zm=wa.c;null!=zm&&(ld.SubDialogButtonClicked=zm);var Am=null==wa.d?null:wa.d.toString();null!=Am&&(ld.DialogOpened=Am);var Bm=wa.e;null!=Bm&&(ld.RuleType=Bm);var Cm=wa.f;null!=Cm&&(ld.ConditionType=Cm);var Dm=null==wa.g?null:wa.g.toString();null!=Dm&&(ld.LowerBoundaryFilled=Dm);var Em=null==wa.h?null:
wa.h.toString();null!=Em&&(ld.UpperBoundaryFilled=Em);var Fm=null==wa.i?null:wa.i.toString();null!=Fm&&(ld.IgnoreBlank=Fm);var Gm=null==wa.j?null:wa.j.toString();null!=Gm&&(ld.InCellDropdown=Gm);var Hm=null==wa.k?null:wa.k.toString();null!=Hm&&(ld.ShowInputMessage=Hm);var Im=null==wa.l?null:wa.l.toString();null!=Im&&(ld.InputTitleFilled=Im);var Jm=null==wa.m?null:wa.m.toString();null!=Jm&&(ld.InputMessageFilled=Jm);var Km=null==wa.n?null:wa.n.toString();null!=Km&&(ld.ShowErrorAlert=Km);var Lm=null==
wa.o?null:wa.o.toString();null!=Lm&&(ld.AlertBlocking=Lm);var Mm=null==wa.p?null:wa.p.toString();null!=Mm&&(ld.AlertTitleFilled=Mm);var Nm=null==wa.q?null:wa.q.toString();null!=Nm&&(ld.AlertMessageFilled=Nm);var Om=wa.r;null!=Om&&(ld.StopWatchId=Om);break;case 49:Mg="DataValidationEditSubmitRule";var Pm=wa.a;null!=Pm&&(ld.RuleType=Pm);var Qm=wa.b;null!=Qm&&(ld.ConditionType=Qm);var Rm=null==wa.c?null:wa.c.toString();null!=Rm&&(ld.LowerBoundaryFilled=Rm);var Sm=null==wa.d?null:wa.d.toString();null!=
Sm&&(ld.UpperBoundaryFilled=Sm);var Tm=null==wa.e?null:wa.e.toString();null!=Tm&&(ld.IgnoreBlank=Tm);var Um=null==wa.f?null:wa.f.toString();null!=Um&&(ld.InCellDropdown=Um);var Vm=null==wa.g?null:wa.g.toString();null!=Vm&&(ld.ShowInputMessage=Vm);var Wm=null==wa.h?null:wa.h.toString();null!=Wm&&(ld.InputTitleFilled=Wm);var Xm=null==wa.i?null:wa.i.toString();null!=Xm&&(ld.InputMessageFilled=Xm);var Ym=null==wa.j?null:wa.j.toString();null!=Ym&&(ld.ShowErrorAlert=Ym);var Zm=null==wa.k?null:wa.k.toString();
null!=Zm&&(ld.AlertBlocking=Zm);var $m=null==wa.l?null:wa.l.toString();null!=$m&&(ld.AlertTitleFilled=$m);var an=null==wa.m?null:wa.m.toString();null!=an&&(ld.AlertMessageFilled=an);var bn=null==wa.n?null:wa.n.toString();null!=bn&&(ld.ClearAllPressed=bn);var cn=wa.o;null!=cn&&(ld.ActionStatus=cn);var dn=wa.p;null!=dn&&(ld.Error=dn);var en=wa.q;null!=en&&(ld.StopWatchId=en);var fn=null==wa.r?null:wa.r.toString();null!=fn&&(ld.InsertDropdownButton=fn);break;case 50:Mg="CustomSort";var gn=wa.a;null!=
gn&&(ld.RangeType=gn);var hn=null==wa.b?null:wa.b.toString();null!=hn&&(ld.HasHeaders=hn);var jn=null==wa.c?null:wa.c.toString();null!=jn&&(ld.SortTopToBottom=jn);var kn=null==wa.d?null:wa.d.toString();null!=kn&&(ld.ColumnCount=kn);var ln=null==wa.e?null:wa.e.toString();null!=ln&&(ld.RowCount=ln);var mn=null==wa.f?null:wa.f.toString();null!=mn&&(ld.RangeLimitExceeded=mn);var nn=null==wa.g?null:wa.g.toString();null!=nn&&(ld.CaseSensitive=nn);var on=null==wa.h?null:wa.h.toString();null!=on&&(ld.GetSortInfoDuration=
on);var pn=null==wa.i?null:wa.i.toString();null!=pn&&(ld.LevelCount=pn);var qn=null==wa.j?null:wa.j.toString();null!=qn&&(ld.SortOnValuesCount=qn);var rn=null==wa.k?null:wa.k.toString();null!=rn&&(ld.SortOnCellColorCount=rn);var sn=null==wa.l?null:wa.l.toString();null!=sn&&(ld.SortOnFontColorCount=sn);var tn=null==wa.m?null:wa.m.toString();null!=tn&&(ld.SortOnIconCount=tn);var un=null==wa.n?null:wa.n.toString();null!=un&&(ld.CustomOrderCount=un);var vn=null==wa.o?null:wa.o.toString();null!=vn&&(ld.AvgCellColorCount=
vn);var wn=null==wa.p?null:wa.p.toString();null!=wn&&(ld.MaxCellColorCount=wn);var xn=null==wa.q?null:wa.q.toString();null!=xn&&(ld.AvgFontColorCount=xn);var yn=null==wa.r?null:wa.r.toString();null!=yn&&(ld.MaxFontColorCount=yn);var zn=null==wa.s?null:wa.s.toString();null!=zn&&(ld.AvgIconsCount=zn);var An=null==wa.t?null:wa.t.toString();null!=An&&(ld.MaxIconsCount=An);var Bn=null==wa.u?null:wa.u.toString();null!=Bn&&(ld.Executed=Bn);break;case 51:Mg="NamedSheetViewUserAction";var Cn=wa.a;null!=Cn&&
(ld.UserSessionId=Cn);var Dn=wa.b;null!=Dn&&(ld.UserActionName=Dn);var En=null==wa.c?null:wa.c.toString();null!=En&&(ld.UserActionSource=En);var Fn=wa.d;null!=Fn&&(ld.UserActionData=Fn);var Gn=wa.e;null!=Gn&&(ld.OtherData=Gn);break;case 52:Mg="NamedSheetViewTeachingCallout";var Hn=wa.a;null!=Hn&&(ld.UserSessionId=Hn);var In=null==wa.b?null:wa.b.toString();null!=In&&(ld.TeachingCalloutSequence=In);var Jn=null==wa.c?null:wa.c.toString();null!=Jn&&(ld.TeachingCalloutIndex=Jn);var Kn=null==wa.d?null:
wa.d.toString();null!=Kn&&(ld.UserActionName=Kn);var Ln=wa.e;null!=Ln&&(ld.UserActionData=Ln);var Mn=null==wa.f?null:wa.f.toString();null!=Mn&&(ld.DurationInMs=Mn);break;case 53:Mg="NamedSheetViewTeachingDialog";var Nn=wa.a;null!=Nn&&(ld.UserSessionId=Nn);var On=wa.b;null!=On&&(ld.UserActionName=On);var Pn=wa.c;null!=Pn&&(ld.ButtonClicked=Pn);var Qn=null==wa.d?null:wa.d.toString();null!=Qn&&(ld.DurationInMs=Qn);var Rn=null==wa.e?null:wa.e.toString();null!=Rn&&(ld.IsNewTeachingDialog=Rn);break;case 54:Mg=
"NamedSheetViewOptionsDialog";var Sn=wa.a;null!=Sn&&(ld.UserSessionId=Sn);var Tn=null==wa.b?null:wa.b.toString();null!=Tn&&(ld.OptionsAction=Tn);var Un=wa.c;null!=Un&&(ld.OptionsActionData=Un);var Vn=wa.d;null!=Vn&&(ld.OptionsOtherData=Vn);var Wn=null==wa.e?null:wa.e.toString();null!=Wn&&(ld.DurationInMs=Wn);break;case 55:Mg="NamedSheetViewTempViewSaveDialog";var Xn=wa.a;null!=Xn&&(ld.UserSessionId=Xn);var Yn=wa.b;null!=Yn&&(ld.TriggeredFrom=Yn);var Zn=wa.c;null!=Zn&&(ld.ButtonClicked=Zn);var $n=
null==wa.d?null:wa.d.toString();null!=$n&&(ld.NameUpdated=$n);var ao=null==wa.e?null:wa.e.toString();null!=ao&&(ld.DurationInMs=ao);break;case 56:Mg="TemporaryViewStartedDataRestore";var bo=wa.a;null!=bo&&(ld.UserSessionId=bo);var co=null==wa.b?null:wa.b.toString();null!=co&&(ld.CountOfTempViews=co);break;case 57:Mg="TemporaryViewFetchedVersion";var eo=wa.a;null!=eo&&(ld.UserSessionId=eo);var fo=null==wa.b?null:wa.b.toString();null!=fo&&(ld.NumberOfBytes=fo);break;case 58:Mg="RaiseEventsAndGenerateBlockRequests";
var go=null==wa.a?null:wa.a.toString();null!=go&&(ld.ReturnContentStatus=go);var ho=null==wa.b?null:wa.b.toString();null!=ho&&(ld.CacheState=ho);var io=null==wa.c?null:wa.c.toString();null!=io&&(ld.FromXhrCallback=io);var jo=null==wa.d?null:wa.d.toString();null!=jo&&(ld.AreGeneralErrorsPresent=jo);var ko=wa.e;null!=ko&&(ld.BlockCacheItemHash=ko);var lo=wa.f;null!=lo&&(ld.StopwatchId=lo);var mo=wa.g;null!=mo&&(ld.BlockCacheItemProcessingStopwatchId=mo);var no=null==wa.h?null:wa.h.toString();null!=
no&&(ld.StateId=no);var oo=null==wa.i?null:wa.i.toString();null!=oo&&(ld.IsHighPriority=oo);var po=null==wa.j?null:wa.j.toString();null!=po&&(ld.CalcComplete=po);var qo=null==wa.k?null:wa.k.toString();null!=qo&&(ld.EditedCellsUpdatedByCse=qo);var ro=null==wa.l?null:wa.l.toString();null!=ro&&(ld.DependentCellsUpdatedByCse=ro);var so=null==wa.m?null:wa.m.toString();null!=so&&(ld.Revision=so);var to=null==wa.n?null:wa.n.toString();null!=to&&(ld.SheetProcessedDataVersion=to);var uo=null==wa.o?null:wa.o.toString();
null!=uo&&(ld.RefCount=uo);var vo=null==wa.p?null:wa.p.toString();null!=vo&&(ld.ExistsInView=vo);var wo=null==wa.q?null:wa.q.toString();null!=wo&&(ld.ContentSource=wo);break;case 59:Mg="LaunchMakerCodeEditor";var xo=wa.a;null!=xo&&(ld.SessionId=xo);var yo=wa.b;null!=yo&&(ld.Command=yo);var zo=null==wa.c?null:wa.c.toString();null!=zo&&(ld.IsPreviewGallery=zo);var Ao=wa.d;null!=Ao&&(ld.MenuItemId=Ao);var Bo=wa.e;null!=Bo&&(ld.ScriptId=Bo);var Co=wa.f;null!=Co&&(ld.ShareId=Co);var Do=null==wa.g?null:
wa.g.toString();null!=Do&&(ld.IsOwner=Do);var Eo=null==wa.h?null:wa.h.toString();null!=Eo&&(ld.PublishedScriptCount=Eo);var Fo=null==wa.i?null:wa.i.toString();null!=Fo&&(ld.RecentScriptCount=Fo);var Go=null==wa.j?null:wa.j.toString();null!=Go&&(ld.WorkbookScriptCount=Go)}ld.Table=Mg;var Mo=Sys.Serialization.JavaScriptSerializer.serialize(ld);Ke.call(Zd,3704927,0,50,Mo)}}catch(ld){x.ULS.sendTraceTag(3704928,0,10,`Error when serializing usage table: ${xa} exception: ${ld}`)}}Zid(xa,wa,Ic){if(this.hAc){const Zd=
this.X1a[xa+wa];Zd&&(Zd.e=Ic,this.Uld(Zd));delete this.X1a[xa+wa]}}wGd(xa,wa){bh[xa]in this.WDf||this.ih(xa,wa)}Kkj(){this.zj.appStart&&this.$mg(dh.zPd,this.zj.appStart)}jUi(xa){const wa={};wa.a=xa.i;wa.b=xa.o;wa.c=xa.t;wa.d=Zg.a(xa.s,xa.p||this.zj.appStart);wa.e=Zg.a(xa.e,xa.s);wa.f=xa.c;wa.g=xa.a;wa.h=xa.h;this.ih(0,wa,this.EHi(wa.b,wa.c))}EHi(xa,wa){return["CommandTask","QueuedTask","Task"].includes(xa)&&!this.WRh.includes(wa)?!1:!0}uD(xa,wa,Ic,Zd,Ke){if(xa&&wa){const Te={};Te.a=xa;Te.b=wa;Te.c=
Ic.toString();Te.d=Zd.toString();this.ih(15,Te,void 0===Ke?!0:Ke)}}EDf(xa,wa,Ic,Zd){const Ke={};xa&&(Ke.c=Zg.a(xa,this.zj.appStart));Ke.b=wa;Ke.a=Ic;Ke.d=Zd;this.ih(17,Ke)}dispose(){this.OEa.execute(xa=>{xa.deactivate(!0);xa.bBj(this.aTf)});this.Zf&&this.Zf.zWa(this.BI);super.dispose()}njf(){return this.Syg=this.Syg||new Vg}rUe(xa,wa,Ic,Zd,Ke){const Te={};Te.o=xa;Te.t=wa;Te.p=void 0===Ke?null:Ke;Te.s=(void 0===Zd?null:Zd)||this.zj.og;this.Sxd(Te,void 0===Ic?null:Ic);return Te}bQe(xa,wa){xa&&(xa.e=
(void 0===wa?null:wa)||this.zj.og,xa.i=xa.i||this.H6a.eeb(),xa.c=xa.c||this.VUe,xa.a=xa.a||this.eVe,xa.h=void 0!==xa.h&&null!==xa.h?xa.h:this.Zf?this.Zf.hj:!1,this.Uld(xa))}LDf(xa){const wa=xa.context;xa.duration>dh.jDh&&(wa.methodName===Bd.a.nEb||wa.methodName===Bd.a.nAa)&&this.VDc(1,dh.Eei);if("GetSessionStatus"!==wa.methodName){const Ic={};Ic.a=wa.methodName;Ic.b=wa.stopwatch.id;Ic.c=xa.gEc;Ic.d=xa.responseSize;Ic.e=wa.IMa;Ic.f=xa.Cf?xa.Cf.StateId:Bd.a.E9d;this.ih(30,Ic,!0);this.uD(Ic.b,xa.Cf.ServerCorrelationId,
"clientWebRequests","ServerActions")}}Png(){if(this.hAc){const xa=this.X1a.LoadingUIShownSplashScreen;xa&&Yd.PageLoadTrackingInfo.instance.TRj(xa.s)}}VDc(xa,wa){this.Cxg.ZRb(xa,wa,null)}F8f(xa,wa){this.oNc.SEj(xa,void 0===wa?null:wa)}E8f(xa,wa,Ic){this.oNc.REj(xa,wa,void 0===Ic?null:Ic)}G8f(xa){this.oNc.eSb(xa,null)}H8f(xa,wa){this.oNc.ZRb(xa,wa,null)}SDc(xa,wa,Ic){this.c_a.SDc(xa,wa,void 0===Ic?null:Ic)}ZDc(xa,wa,Ic){this.c_a.ZDc(xa,wa,void 0===Ic?null:Ic)}KTb(xa,wa,Ic,Zd,Ke,Te,If,...Ef){this.c_a.KTb(xa,
wa,Ic,Zd,Ke,Te,If,...Ef)}TFc(xa,wa,Ic,Zd,Ke,Te,If){this.c_a.TFc(xa,wa,Ic,Zd,Ke,Te,If)}MTb(xa,wa,Ic,Zd,Ke,Te){this.c_a.MTb(xa,wa,Ic,Zd,Ke,Te)}LTb(xa,wa,Ic,Zd,Ke,Te,...If){this.c_a.LTb(xa,wa,Ic,Zd,Ke,Te,...If)}NTb(xa,wa,Ic,Zd,Ke,Te){this.Cxg.NTb(xa,wa,Ic,Zd,Ke,Te)}UFc(xa,wa,Ic,Zd){this.c_a.UFc(xa,wa,Ic,Zd)}Uld(xa){this.b6j.jUi(xa)}Lkj(){if(this.hAc){Stw.swpc=null;const xa=this.hAc;for(let wa in xa)this.Sxd(xa[wa])}}cVh(){const xa=window[kh.a.namespace];if(xa){const wa=xa[kh.a.fPe];wa&&(delete xa[kh.a.fPe],
wa.forEach(Ic=>{this.Sxd(Ic);this.Uld(Ic)}))}}UIi(xa,wa){if("about:blank"===xa||"renamehandler.ashx"===wa&&"2"===E.a.gw(xa,"u"))return!0;for(xa=0;xa<this.sXd.length;xa++)if(wa.endsWith(this.sXd[xa]))return!0;return!1}FRi(){this.OEa.execute(xa=>{xa.Xj(dh.S6g,0);xa.dZg(this.aTf);xa.activate()})}xRi(){const xa={};xa.a=new Date(Lc.EcmaDateClock.instance.appStart.m);xa.b=this.userSessionId;xa.c=this.zj.Lqg;xa.d=dh.Qwh*y.devicePixelRatio;xa.e=qa.a.$b.appStart.m;this.ih(14,xa,!0);this.Vpa(qa.a.$b.appStart.m,
Object(Ua.a)(M.a.instance,M.a.instance.Yuj,"recordAppInitStart"))}$mg(xa,wa){this.umb=this.H6a.eeb();this.sYb=this.H6a.eeb();this.eIa=xa;this.gJc("UserAction",xa,this.sYb,wa);this.ECf(xa,this.umb)}v8j(){const xa=window[kh.a.namespace];xa&&!dh.ySe&&(xa[kh.a.b5j]=(wa,Ic)=>this.rUe(wa,Ic),xa[kh.a.HFh]=wa=>{this.bQe(wa)},dh.ySe=!0)}Cgk(xa){const wa=Eh.C$g(xa.o,xa.t),Ic=new Eh(Zg.a(xa.e,xa.s)),Zd=wa in this.i6d?this.i6d[wa].djh(Ic):Ic;this.i6d[wa]=Zd;if(Ic===Zd||Ic.average!==Zd.average)xa=Object(Vc.a)(new Rg,
{operation:xa.o,target:xa.t,Q_i:Zd.average,sender:this}),this.raiseEvent(wa,xa)}ECf(xa,wa){const Ic={};Ic.a=wa;Ic.b=this.userSessionId;Ic.c=xa;this.ih(1,Ic,!0)}pwi(){this.sXd=[Bd.a.Jyj,Bd.a.getSessionStatus,Bd.a.nAa,Bd.a.Tih,Bd.a.Lfh,Bd.a.mmb,Bd.a.llc,Bd.a.getObjectMetadata,Bd.a.qci,Bd.a.setRichTextCell,Bd.a.rAa,Bd.a.Kkk,Bd.a.pollSessionStatus,Bd.a.Khi,Bd.a.Lfi,Bd.a.t$h]}Sxd(xa,wa){xa.i=(void 0===wa?null:wa)||this.H6a.eeb();xa.a=this.eVe;xa.c=this.VUe;xa.h=this.Zf?this.Zf.hj:!1}static la(xa){const wa=
new dh(xa.xa.UserSessionId,xa.ga,void 0,void 0,void 0,!0);wa.ECf(dh.aJf,wa.PVe);x.ULS.sendTraceTag(524166239,0,50,"TelemetryManager: Activating BrowserResourceTiming Telemetry logs");wa.FRi();wa.v8j();wa.Kkj();wa.xRi();wa.cVh();wa.Lkj();wa.pwi();dh.zPj(xa);jd.a.Xn.Qa(41,wa)}static zPj(xa){const wa=y.devicePixelRatio;1<wa&&xa.te.Hz(!0,2<=wa?8388608:4194304)}}dh.aJf="UnassignedUserAction";dh.zPd="PageLoad";dh.cud="GridUpdateOperation";dh.jDh=5E3;dh.Eei="MoreThan_5000_Ms";dh.Qwh=96;dh.S6g=30;dh.ySe=
!1;Object(v.a)(dh,"TelemetryManager",xd.a,[12,13,483,484]);var Sh=a(211),Tf=a(111);class ag{constructor(xa,wa,Ic){this.Zmk=xa;this.eY=wa;this.name=Ic}}Object(v.a)(ag,"Validation",null,[]);var Cf;let yh=Cf=class{constructor(xa){this.cfb=()=>{this.TXf(this.o8e)};this.ek=()=>{this.TXf(this.a8g)};this.$=xa;this.a8g=new ub.a;this.o8e=new ub.a;Ld.h(this.$).ya.Ws(this.ek);Ld.h(this.$).ya.yBe(this.cfb)}E4c(xa,wa,Ic,Zd,Ke){if(xa&&Zd){const Te=Sh.a.SB(wa,Ic);this.m7b(()=>!!Tf.a(xa).qt(Te),Zd.StateId,Ke)}}m7b(xa,
wa,Ic){this.UXg(this.o8e,xa,wa,Ic)}UXg(xa,wa,Ic,Zd){xa&&wa&&Ic!==Bd.a.lg&&xa.add(new ag(wa,Ic,Zd))}TXf(xa){if(xa){var wa=new ub.a;for(let Ic of xa){if(Ic.eY===this.$.ea.xg)try{Ic.Zmk()||x.ULS.sendTraceTag(537151010,0,15,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation result is false. Validation Name: [${Ic.name}]`)}catch(Zd){x.ULS.sendTraceTag(537151009,0,10,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation has caused an exception to be thrown. Validation Name: [${Ic.name}]. Exception: [${Zd}]`)}wa.add(Ic)}for(let Ic of wa)xa.remove(Ic)}else x.ULS.shipAssertTag(537151011,
0,!!xa,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation list is null")}dispose(){Ld.h(this.$)&&Ld.h(this.$).ya&&(Ld.h(this.$).ya.Bs(this.ek),Ld.h(this.$).ya.AVd(this.cfb));this.$=null}static la(xa){const wa=new Cf(xa);xa.ga.Qa(277,wa)}};yh=Cf=Object(lb.a)([Object(Mb.d)(Aa.cd),Object(lb.b)(0,Object(Aa.W)())],yh);Object(v.a)(yh,"ValidationTelemetryManager",null,[458,5]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.BrowserInfoLogger");G.main();Type.registerNamespace("CNT");
Xa.main();Type.registerNamespace("CACPU");vc.main();Type.registerNamespace("Common.App.EventsCacheManager");Ja.main();(()=>{Hb.a.Ga(xa=>{xa.ga.Qa(137,new ua(xa))})})();(()=>{Hb.a.Ga(xa=>{xa.ga.Qa(37,new Bc(xa))})})();(()=>{Hb.a.Ga(xa=>{Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:8082961_TrackerAndProfilerServicesWithNewInfra")||Fc.la(xa)})})();(()=>{Hb.a.Ga(xa=>{Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:8082961_TrackerAndProfilerServicesWithNewInfra")||Xb.la(xa)})})();(()=>{Hb.a.Ga(xa=>{xa.ga.Qa(40,
new Se(xa,new Pa.a(()=>We.GetServiceTaskFactory.create(xa.ga,137,xa.ka,1))))})})();(()=>{Hb.a.Ga(xa=>{xa.ga.Qa(276,new Ac(xa))})})();(()=>{Hb.a.Ga(xa=>{jd.a.Xn.qd(135,()=>{dh.la(xa);Gg.la(xa);Ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateValidationTelemetryManager",!1)||yh.la(xa);Yf.la(xa);bg.la(xa);Of.RenderingFidelityTracker.la(xa)})})})();String(d);String(f);String(k);String(h);String(u);String(r);String(t);window.___1689695406738_closurehack=d;window.___1689695406738_closurehack=
f;window.___1689695406738_closurehack=k;window.___1689695406738_closurehack=h;window.___1689695406738_closurehack=u;window.___1689695406738_closurehack=r;window.___1689695406738_closurehack=t},737:function(w,C,a){a.d(C,"a",function(){return b});const b=(c,h,k)=>c.Da(h)||c.Qa(h,k())},764:function(w,C,a){w=a(0);var b=a(79),c=a(5),h=a(64),k=a(32),d=a(31),f=a(175);class u{constructor(l,n){this.message=l;this.dza=n}}Object(w.a)(u,"CrossDocumentEventArgs",null,[]);var r=a(778),t=a(385),v=a(268),x=a(777);
a.d(C,"a",function(){return m});class m{constructor(l,n,z,y){this._name="";this.xv={};this.Z5=null;this.MJ=[];this.zJ=[];this.AJ=[];this.JJ=[];this.pwa=l;this.nwa=n;this.Iq={};this.Bv={};this.GJ=z;m._id++;y&&y();this.Eq=this.enable()}get targetOrigin(){return this.nwa}get YFa(){return this.pwa}enable(){if(!v.a())return x.a.sendTraceTag(5018251,2,"Not supported for current browser."),!1;this.PGb();x.a.sendTraceTag(5018252,2,"Enabled.");return!0}isEnabled(){return this.Eq}PGb(){x.a.debugAssertTag(5018253,
!!this.GJ,null);this.Z5=Object(b.a)(this,this.dMb,"messageListener");this.GJ.JLa(this.Z5,null)}disable(){this.Eq=!1;this.MJ=[];this.zJ=[];this.AJ=[];this.JJ=[];this.pwa=null;this.nwa="";this.GJ.ONa(this.Z5);this.Iq={};this.Bv={}}dispose(){this.disable()}CBa(l){return!!this.MJ&&Array.contains(this.MJ,l)||this.BBa(l)}BBa(l){return!!this.zJ&&Array.contains(this.zJ,l)}Rn(l){x.a.debugAssertTag(5018259,!!this.MJ,null);Array.add(this.MJ,l);x.a.sendTraceTag(5018260,2,"Allow receiving : {0}",l)}q3a(l){x.a.debugAssertTag(5018261,
!!this.zJ,null);Array.add(this.zJ,l);x.a.sendTraceTag(5018262,2,"Allow free receiving: {0}",l)}EIb(l){return!!this.AJ&&Array.contains(this.AJ,l)}KS(l){x.a.debugAssertTag(5018263,!!this.AJ,null);Array.add(this.AJ,l);x.a.sendTraceTag(5018264,2,"Allow free sending: {0}",l)}OIb(l){l=h.a.rN(l);return!!l&&!!this.JJ&&Array.contains(this.JJ,l)}LS(l){x.a.debugAssertTag(5018265,!!this.JJ,null);if(l===m.DM)return x.a.debugAssertTag(5018266,!1,null),!1;let n=h.a.rN(l);if(!n)return x.a.sendTraceTag(5018267,4,
"Get origin fail:{0}",l),!1;c.AFrameworkApplication.da.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.NormalizePostMessageOrigin")&&(n=d.a.Tm(n));Array.add(this.JJ,n);x.a.sendTraceTag(5018268,2,"Add origin:{0}",n);return!0}send(l,n){n=void 0===n?null:n;let z=this.targetOrigin;if(n){n=h.a.rN(n);if(!n)return!1;z=n}return this.Paa(l,this.YFa,z)}sendMessage(l,n,z){z=(z=void 0===z?"":z)&&""!==z?z:f.a.create().toString();return this.send(this.T$(l,n,z,c.AFrameworkApplication.userSessionId))}postMessage(l){const n=
f.a.create().toString();if(!c.AFrameworkApplication.da.pa("RetryablePostMessagingIsEnabled")||!l.shouldRetry)return this.send(this.T$(l.messageId,l.values,n,l.userSessionId));if(!this.Iq[l.H0]){this.Rn(l.H0);const z=Object(b.a)(this,this.ackMessageHandler,"ackMessageHandler");this.fm(l.H0,z)}this.xv[n]="";return this.$Da(l,n,1)}$Da(l,n,z){if(""!==n&&n in this.xv&&"ACK_RECEIVED"===this.xv[n])return delete this.xv[n],!0;if(z>l.uI)return x.a.sendTraceTag(40716250,4,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',
l.H0,n),delete this.xv[n],!1;x.a.sendTraceTag(40716251,1<z?4:2,'Sending postmessage. Attempts remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',l.uI-z,l.messageId,n);z++;window.setTimeout(()=>{this.$Da(l,n,z)},l.w3c);l.values[t.a.u3c]=!0;return this.send(this.T$(l.messageId,l.values,n,l.userSessionId))}ackMessageHandler(l){l=l.CorrelationId;""!==l&&l in this.xv&&(x.a.sendTraceTag(42783044,2,"Received Ack for Message {0} CorrelationId: {1}",this.xv[l],l),this.xv[l]="ACK_RECEIVED")}T$(l,n,z,
y){l=new r.a(l);l.CorrelationId=z;n&&(l.Values=n);l.Values.wdUserSession=y;return l}Paa(l,n,z){x.a.debugAssertTag(5018269,!!l,null);if(!this.Eq)return!1;x.a.debugAssertTag(5018270,!!n,null);x.a.debugAssertTag(5018271,!!z,null);if(!n||!z)return x.a.debugAssertTag(5018272,!1,null),!1;if(z===m.DM&&!this.EIb(l.MessageId))return x.a.sendTraceTag(5018273,1,"Got unregistered message {0}",{["id"]:l.MessageId}),!1;l.SendTime=(new Date).getTime();let y="";try{y=Sys.Serialization.JavaScriptSerializer.serialize(l)}catch(B){return x.a.sendTraceTag(5018274,
4,"JSON Ser failed {0}",{["Exception"]:B.message}),!1}n=m.sendMessage(n,y,z);x.a.sendTraceTag(5018275,2,"Send {0}. {1}",n?"succeeded":"failed",{["id"]:l.MessageId,["origin"]:z});return n}fm(l,n){x.a.debugAssertTag(5018304,!!n,null);x.a.debugAssertTag(5018305,!!this.Iq&&!!this.Bv,null);if(!this.Eq)return!1;if(!this.CBa(l))return x.a.sendTraceTag(5018306,2,"Not allow receiving {0}",{["id"]:l}),!1;this.Iq[l]!==n&&(x.a.debugAssertTag(5018307,!this.Iq[l]&&!this.Bv[l],null),this.Iq[l]=n,delete this.Bv[l]);
return!0}NV(l){this.Eq&&(this.Iq[l]&&delete this.Iq[l],this.Bv[l]&&delete this.Bv[l])}dMb(l){const n=this.TDb(l);if(!n)return!1;if(this.Iq[n.MessageId])return this.GJ.eBa(this.Iq[n.MessageId],n),!0;if(this.Bv[n.MessageId]){const z=this.Bv[n.MessageId];l=new u(n,l);this.GJ.XGb(z,l);return!0}return!1}TDb(l){const n=new Date;this.hLb(l);if(!l.origin||!l.source||void 0===l.data||null===l.data)return x.a.sendTraceTag(5018308,4,"eventArgs missing required properties."),null;const z=this.WJb(l.data);if(!z)return null;
if(!this.OIb(l.origin)){if(!this.BBa(z.MessageId))return x.a.sendTraceTag(5018309,1,"{0}",{["id"]:z.MessageId}),null;if(!k.a.TY&&l.source!==this.YFa)return x.a.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),null}x.a.debugAssertTag(5018311,!!z.Values,null);z.Values.m_Source=l.source;z.Values.m_Origin=l.origin;z.Values.m_ReceivedTime=n.getTime();return z}WJb(l){if(!l)return null;let n=null;try{n=Sys.Serialization.JavaScriptSerializer.deserialize(l,!0)}catch(B){return 2>
m.Pua&&(x.a.sendTraceTag(5018312,2,"Deser failed"),m.Pua++),null}if(!n)return x.a.debugAssertTag(5018313,!1,null),null;for(l=0;l<m.tT.length;l++)if(!n[m.tT[l]])return"MessageId"!==m.tT[l]&&x.a.sendTraceTag(41502555,2,"Cannot find required message field: {0}",m.tT[l]),null;if(n.Values)try{n.Values}catch(B){return x.a.sendTraceTag(5018314,4,"Not a valid dictionary: {0}",B.message),null}else x.a.sendTraceTag(41502556,2,"No values in message");l=n.MessageId;if(!this.CBa(l))return x.a.sendTraceTag(5018315,
1,"Ignore recvd {0}",{["id"]:l}),null;const z=n.SendTime,y=(new Date).getTime()-z;if(0>z)return x.a.sendTraceTag(520435660,2,"{0}",{["t"]:z,["id"]:l}),null;6E4<y&&x.a.sendTraceTag(520435659,2,"{0}",{["t"]:z,["delta"]:y,["id"]:l});-300>y&&x.a.sendTraceTag(520435658,2,"{0}",{["t"]:z,["delta"]:y,["id"]:l});l=new r.a;l.MessageId=n.MessageId;l.SendTime=n.SendTime;l.CorrelationId=n.CorrelationId;n.Values&&(l.Values=n.Values);x.a.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",
l.MessageId,l.SendTime,l.CorrelationId);return l}hLb(l){x.a.sendTraceTag(5018318,1,String.format("Received: {0}",{["origin"]:l.origin,["data"]:l.data,["source"]:l.source}))}static sendMessage(l,n,z){if(!v.a())return x.a.debugAssertTag(5018319,!1,null),!1;try{return l.postMessage(n,z),!0}catch(y){x.a.sendTraceTag(5018320,4,"{0}",{["exception"]:y.message})}return!1}}m.tT=["MessageId","SendTime"];m.DM="*";m._id=0;m.Pua=0;Object(w.a)(m,"CrossDocumentMessenger",null,[5,268])},769:function(w,C,a){a.d(C,
"a",function(){return k});w=a(0);var b=a(1),c=a(137),h=a(15);class k{static wpf(d){k.$=d;b.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void c.a.resolve(h.O).then(f=>{k.Zf=f}):k.$.ga.qd(291,f=>{k.Zf=f})}static Tna(d,f){return d[Math.round((d.length-1)*f/100)]}static aG(d){return k.Zf?k.Zf.aG(d):!1}}k.Zf=null;k.$=null;Object(w.a)(k,"SessionStatisticsManagerHelper",null,[])},777:function(w,C,a){a.d(C,"a",function(){return b});w=a(0);class b{static JTb(){}static xzb(){}}
b.sendTraceTag=b.JTb;b.debugAssertTag=b.xzb;Object(w.a)(b,"BULS",null,[])},778:function(w,C,a){a.d(C,"a",function(){return b});w=a(0);class b{constructor(c){this.MessageId=c;this.SendTime=0;this.CorrelationId="";this.Values={}}}Object(w.a)(b,"CrossDocumentMessage",null,[])},811:function(w,C,a){a.d(C,"a",function(){return b});const b=c=>{if(Object.keys)c=Object.keys(c);else{const h=[];for(const k in c)h.push(k);c=h}return c}},906:function(w,C,a){w=a(0);var b=a(14),c=a(764),h=a(79),k=a(562),d=a(5),
f=a(13),u=a(112);class r{constructor(m,l,n,z){this.origin=m;this.data=l;this.source=n;this.Ba=void 0===z?null:z}}Object(w.a)(r,"MessageEventArgs",null,[]);class t{constructor(m,l){this.s6=null;this.ptb=m;this.fg=l;this.wS=null}get w_(){return this.ptb.value}get taskManager(){return this.fg.value}JLa(m,l){this.wS=m;this.s6=Object(h.a)(this,this.HPb,"postMessageEventHandler");this.w_.addHandler(f.a.message,this.s6,l)}ONa(){this.wS=null;this.w_.removeHandler(f.a.message,this.s6)}eBa(m,l){const n=new u.a(0,
1,1,()=>{m(l)},7);this.taskManager.Sh(n)}XGb(m,l){const n=new u.a(0,1,1,()=>{m(l)},7);this.taskManager.Sh(n)}HPb(m){return this.wS?this.wS(new r(m.origin,m.data,m.source,m.Ba)):!1}static get instance(){return t.Ina()}static Ina(){return new t(new k.a(()=>d.AFrameworkApplication.w_),new k.a(()=>d.AFrameworkApplication.Vj))}}Object(w.a)(t,"MessageEventHandler",null,[296]);var v=a(777);a.d(C,"a",function(){return x});class x extends c.a{constructor(m,l,n){super(m,l,(void 0===n?null:n)||t.instance,x.GGb)}static GGb(){v.a.sendTraceTag=
x.ITb;v.a.debugAssertTag=x.wzb}static ITb(m,l,n,...z){b.ULS.sendTraceTag.apply(null,[m,204,x.Xyb(l),n].concat(z))}static wzb(){}static Xyb(m){switch(m){case 0:return 200;case 1:return 100;case 2:return 50;case 4:return 15;case 3:return 10;default:return 100}}}x.YPb="wdPreviousSession";x.hzb="wdUserSession";Object(w.a)(x,"CommonCrossDocumentMessenger",c.a,[])},968:function(w,C,a){a.d(C,"a",function(){return b});w=a(0);class b{}b.hid="stid";b.fid="iid";b.gid="DynamicImageProvider.aspx";Object(w.a)(b,
"WebServiceConstants",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.tm.js.map/ea6475876fce07bf940c57c8a5d1d0e8/EwaTS.tm.js.map