'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[34],{1336:function(w,C,a){a.r(C);var b={};a.r(b);a.d(b,"EwaNotificationFocusManager",function(){return y});var c={};a.r(c);a.d(c,"LineageDiscoverabilityCallout",function(){return nb});var h={};a.r(h);a.d(h,"ShowCalloutCommandHandler",function(){return Bc});var k={};a.r(k);a.d(k,"OptimizeWorkbookManager",function(){return lb});var d=a(0),f=a(233),u=a(731),r=a(2),t=a(14),v=a(275),x=a(260),m=a(147),l=a(1086),n=a(137),
z=a(15);let y=class{constructor(Dc){this.f9c=this.Rmd=null;this.W_a=this.isFocused=!1;this.$=Dc}dispose(){}get Ce(){return null}get zi(){return this.W_a}get jg(){return x.a.ZKd}Pi(Dc,Wa){Wa||this.isFocused||!this.Rmd||this.Rmd();return!Wa}Nj(Dc){return Dc===document.activeElement&&this.isFocused}Ll(){this.isFocused=!0}lm(){this.isFocused&&this.f9c&&(this.f9c(),this.isFocused=!1)}ywi(){t.ULS.shipAssertTag(537169939,0,m.b("initializeNotificationFocusManagement"),"EwaNotificationFocusManager.InitializeFocusActions: initializeNotificationFocusManagement Api doesnt exist in AppChrome");
const Dc=Object(r.a)(new l.a,{onFirstActionableAppear:()=>{v.a(this.$).vk(this);this.W_a=!0},onLastActionableDisappear:()=>{v.a(this.$).gB(this);this.W_a=!1},onFocus:()=>{this.isFocused=!0},onBlur:()=>{this.isFocused=!1}});appChrome.initializeNotificationFocusManagement(Dc).then(Wa=>{this.Rmd=()=>{Wa.focus()};this.f9c=()=>{Wa.blur()};return null})}};y=Object(u.a)([Object(n.d)(z.X),Object(u.b)(0,Object(z.W)())],y);Object(d.a)(y,"EwaNotificationFocusManager",null,[237,5,56]);class B extends f.a{constructor(Dc){super();
this.$=Dc;this.je()}create(){this.Ld(this.$.ga.Da(357)||new y(this.$))}static la(Dc){Dc.ga.Qa(358,new B(Dc))}}Object(d.a)(B,"EwaNotificationFocusManagerFactory",f.a,[]);var G=a(1),E=a(1254),J=a(917),I=a(918),R=a(179),X=a(189);class H{constructor(Dc){this.WN=null;this.$=Dc}show(){const Dc=this.Qza();t.ULS.shipAssertTag(537169938,0,!!Dc,"EwaReactCallout.Show: Cannot retrieve the Callout Parameters");X.UISurfaces.BK().then(Wa=>{const Qb=Wa.callout(Dc);this.WN=Wa.addNotification(Qb)},Wa=>{t.ULS.sendTraceTag(537169936,
0,15,`EwaReactCallout.Show: Failed to GetNotificationsAPIAsync: ${Wa}`);return null})}dismiss(){this.WN&&X.UISurfaces.BK().then(Dc=>{Dc.removeNotification(this.WN);return this.WN=null})}OZa(Dc){X.UISurfaces.BK().then(Wa=>{Wa.updateNotification(this.WN,Wa.callout(Object.assign(new J.a,Dc)))},Wa=>{t.ULS.sendTraceTag(522782336,0,15,`EwaReactCallout.Update: Failed to GetNotificationsAPIAsync: ${Wa}`);return null})}}Object(d.a)(H,"EwaReactCallout",null,[270]);class M{static fJb(Dc){return!!(Dc&1)}static zCd(Dc){return!!(Dc&
2)}static xlk(Dc){return!!(Dc&M.fui)}}M.fui=6;Object(d.a)(M,"EwaReactCalloutModeUtil",null,[]);class O{constructor(){this.v1=0;this.hKb=null;this.MJc=!0}}Object(d.a)(O,"EwaReactShowOrDismissCalloutMetadata",null,[]);var L=a(63),S=a(38),T=a(120),V=a(836);class la{constructor(Dc,Wa,Qb){this.indexedDB=null;this.$=Dc;this.zP=Wa;this.qMa=Qb}LBf(){const Dc=new R.a;let Wa=new O;S.TaskExtensions.za(this.t0e(),Qb=>{Qb.result?S.TaskExtensions.za(this.indexedDB.OPa(this.zP),Lc=>{if(Lc=Lc.result){Lc=L.a.Fk(Lc);
if(!Lc){this.t6e(Dc);return}if(M.fJb(this.qMa)){const Ba=Lc.NumberOfDisplays;Wa.v1=Ba?Number.parseLocale(Ba):0}M.zCd(this.qMa)&&(Lc=Lc.LastDisplay,Wa.hKb=Lc?new Date(Number.parseLocale(Lc)):null)}Dc.setResult(Wa)},this.$.ka):this.t6e(Dc)},this.$.ka,3);return Dc.task}Ebg(Dc){const Wa=new R.a;S.TaskExtensions.za(this.t0e(),Qb=>{Qb.result||Wa.setResult(!1);Qb={};M.fJb(this.qMa)&&(Qb.NumberOfDisplays=Dc.v1.toString());M.zCd(this.qMa)&&(Qb.LastDisplay=T.toTimestamp(Dc.hKb).m.toString());Qb=L.a.He(Qb);
S.TaskExtensions.za(this.indexedDB.mXa(new V.a(this.zP,Qb)),Lc=>{Wa.setResult(Lc.result)},this.$.ka,3)},this.$.ka,3)}t0e(){const Dc=new R.a;this.indexedDB?Dc.setResult(!0):void n.a.resolve(z.Cb,{Ja:1}).then(Wa=>{Wa.Vh()?(Wa.initialize("Callouts","EwaCallouts"),this.indexedDB=Wa,Dc.setResult(!0)):(t.ULS.sendTraceTag(573609248,0,50,"EwaReactShowOrDismissCalloutIndexedDBLoaderSaver.EnsureIndexedDB: IndexedDb is not supported."),Dc.setResult(!1))});return Dc.task}t6e(Dc){const Wa=new O;Wa.MJc=!1;Dc.setResult(Wa)}}
Object(d.a)(la,"EwaReactShowOrDismissCalloutIndexedDBLoaderSaver",null,[269]);class Z{constructor(Dc,Wa,Qb,Lc,Ba,qa){this.dac=Wa;this.fac=Qb;this.qMa=Lc;this.zP=Ba;this.localStorage=qa;this.$=Dc}LBf(){const Dc=new R.a,Wa=new O;if(M.fJb(this.qMa)){let Qb=0;Wa.MJc=(()=>{let Lc=this.qdk();({Fga:Qb}=Lc);return Lc})().returnValue&&Wa.MJc;Wa.v1=Qb}Dc.setResult(Wa);return Dc.task}Ebg(Dc){const Wa=new R.a;var Qb=!0;if(M.fJb(this.qMa)){const Lc=this.Raf();Lc&&(Qb=Number.parseLocale(Lc),Qb=this.$dk((Qb&~this.fac|
Dc.v1<<this.dac).toString()))}Wa.setResult(Qb)}qdk(){var Dc;return(Dc=this.Raf())?(Dc=(Number.parseLocale(Dc)&this.fac)>>this.dac,t.ULS.sendTraceTag(537169932,0,50,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver - Callout ${this.zP} already appeared. Found the callout in storage.`),{returnValue:!0,Fga:Dc}):{returnValue:!1,Fga:0}}$dk(Dc){try{if(!this.localStorage.Vh())return!1;try{return this.localStorage.setItem("CalloutIds",Dc),!0}catch(Wa){t.ULS.sendTraceTag(537169931,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.TrySaveCalloutIdsToCache: Failed to set item to cache. reason: ${Wa.message||
"Unknown"}`)}}catch(Wa){t.ULS.sendTraceTag(537169930,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.TrySaveCalloutIdsToCache: Got Exception when trying to save calloutIds to cache. e.Message: ${Wa.message}`)}return!1}Raf(){try{if(!this.localStorage.Vh())return t.ULS.sendTraceTag(537169929,0,50,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: Local storage is not supported and display count (if any) won't be saved for ${this.zP}.`),null;const Dc=this.localStorage.getItem("CalloutIds");
return Dc?Dc:(t.ULS.sendTraceTag(537169928,0,15,"EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: item doesn't exist in local storage"),"0")}catch(Dc){return t.ULS.sendTraceTag(537169927,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: Got Exception when trying to get calloutIds. e.Message: ${Dc.message}`),null}}}Object(d.a)(Z,"EwaReactShowOrDismissCalloutLocalStorageLoaderSaver",null,[269]);var da=a(77),ba=a(142),na=a(195),Y=a(143),Ga=a(584);
class ma extends H{constructor(Dc,Wa,Qb,Lc,Ba,qa,gb,Bb,ic,Cc,hd,Pd,ue,Ee,Se,cf,mf,ac){Cc=void 0===Cc?!1:Cc;hd=void 0===hd?!1:hd;Pd=void 0===Pd?!1:Pd;ue=void 0===ue?!1:ue;Ee=void 0===Ee?!1:Ee;Se=void 0===Se?!0:Se;cf=void 0===cf?!1:cf;mf=void 0===mf?null:mf;ac=void 0===ac?!1:ac;super(Dc);this.v1=0;this.P3d=this.TNc=this.Xyg=!1;this.tSf=()=>{this.Roc()};this.sGg=Wa;this.h_j=Qb;this.zAh=Lc;this.Qv=Ba;this.Pv=qa;this.localStorage=ic;this.rGg=gb;this.qGg=Bb;this.IPi=Cc;this.Yvd=hd;this.CAh=Pd;this.setInitialFocus=
ue;this.useCoachmark=Ee;this.gFc=!1;this.vRj=Se;this.lHf=this.$ai();this.pMa=mf;this.P3d=ac;this.hasDynamicSizing=cf}get Qub(){return{}}set ZAg(Dc){this.Qv=Dc}Xce(){}HPa(){return 1}ppd(){return 0}get Fga(){return 1}get b_f(){return!0}get zP(){return this.sGg}get fac(){return this.rGg}get dac(){return this.qGg}show(){S.TaskExtensions.za(this.bba(),Dc=>{Dc.result&&this.A_j()},this.$.ka)}GCf(){Y.b(this.$).nf(ba.a.u2e,this.bjf("dismiss"),void 0,!0)}ADf(){Y.b(this.$).nf(ba.a.u2e,this.bjf("show"),void 0,
!0)}Qza(){const Dc=Object(r.a)(new E.a,{label:this.zAh,onExecute:()=>{this.Xce();this.GCf();this.TNc=!0;this.Roc()}});let Wa=null;this.Yvd||(Wa=Object(r.a)(new E.a,{label:this.h_j,onExecute:()=>{this.TNc=!0;this.ADf();const Qb=na.c({["InputMethod"]:da.a.Bd},this.Qub);this.$.Ha.Ad(this.ribbonCommandInfo,Qb);this.Roc()}}));return Object(r.a)(new J.a,{target:this.DEb(),content:this.Pv,title:this.Qv,primaryButtonProps:this.Yvd?Dc:Wa,secondaryButtonProps:this.Yvd?null:Dc,showCloseIcon:this.P3d,preventLightDismiss:!this.IPi,
hasDynamicSizing:this.hasDynamicSizing,calloutProps:Object(r.a)(new I.a,{onDismiss:()=>{this.Roc()},directionalHint:this.pMa,preventDismissOnScroll:!0,preventDismissOnResize:!this.CAh,isBeakVisible:this.vRj,setInitialFocus:this.setInitialFocus}),useTeachingStyles:!0,hasFocusableControls:!0,useCoachmark:this.useCoachmark})}Roc(){this.Xyg=!0;const Dc=this.$.ga.Da(418);Dc&&Dc.zCj(this.tSf);(this.b_f&&this.TNc||this.P3d)&&this.Xsg(!0);this.TNc||t.ULS.sendTraceTag(537169935,0,50,`EwaReactShowOrDismissCallout - Callout ${this.zP} was dismissed without user interaction`);
this.dismiss()}bba(){const Dc=new R.a;this.Toa()?S.TaskExtensions.za(this.lHf.LBf(),Wa=>{var Qb=this.HPa();Wa=Wa.result;if(Wa.MJc)if(this.v1=Wa.v1,M.fJb(Qb)&&(this.gFc||Wa.v1>=this.Fga))t.ULS.sendTraceTag(573609250,0,50,`EwaReactShowOrDismissCallout - Callout ${this.zP} already appeared. Found the callout in storage.`),this.gFc=!0,Dc.setResult(!1);else{if(M.zCd(Qb)&&Wa.hKb&&(Qb=T.getElapsedSeconds(Wa.hKb,new Date),(Wa=this.ppd())||t.ULS.shipAssertTag(537169933,0,!1,`GetCooldownPeriodInSeconds returned 0 callout ${this.zP} with mode RestrictedBycooldown`),
Qb<Wa)){Dc.setResult(!1);return}Qb=!this.WN&&!!this.DEb()&&!Ga.a(this.$);Dc.setResult(Qb)}else Dc.setResult(!1),t.ULS.sendTraceTag(537169934,0,50,`EwaReactShowOrDismissCallout.ShouldShowCallout: Failed to retrieve metadata for callout ${this.zP}.`)},this.$.ka):Dc.setResult(!1);return Dc.task}Toa(){return!0}DEb(){if(document.querySelector(this.eV))return this.eV;if(document.querySelector(this.dV))return this.dV;if(document.querySelector(this.JU))return this.JU;t.ULS.shipAssertTag(592528907,0,!1,`EwaReactShowOrDismissCallout.GetTargetObject: Cannot retrieve the Callout Target Object, Callout: ${this.zP}`);
return null}Xsg(Dc){Dc=void 0===Dc?!1:Dc;this.gFc=!0;this.HPa();const Wa=new O;Wa.v1=Dc?this.Fga:this.v1+1;Wa.hKb=new Date;this.lHf.Ebg(Wa)}A_j(){this.gFc=!0;this.Xsg();t.ULS.sendTraceTag(593494082,0,50,`EwaReactShowOrDismissCallout - Showing ${this.zP} callout, current number of displayes: ${this.v1}`);this.$.ga.qd(418,Dc=>{this.Xyg||Dc.Z_g(this.tSf)});super.show()}$ai(){const Dc=this.HPa();return M.xlk(Dc)?new la(this.$,this.zP,Dc):new Z(this.$,this.dac,this.fac,Dc,this.zP,this.localStorage)}bjf(Dc){return{["selection"]:Dc,
["callout"]:this.zP,["Location"]:"floatie",["displayCount"]:this.v1}}}Object(d.a)(ma,"EwaReactShowOrDismissCallout",H,[]);var fa=a(93),Xa=a(276),Ua=a(16),ka;let nb=ka=class extends ma{constructor(Dc){super(Dc,ka.NPi,Ua.a.instance.Ia(650),Ua.a.instance.Ia(652),Ua.a.instance.Ia(648),Ua.a.instance.Ia(649),3072,10,new Xa.a)}MYj(){return this.bba()}get eV(){return"[data-unique-id=Review]"}get dV(){return"[data-unique-id=pivotOverflowButton]"}get JU(){return'[id="'+this.$.Pd+'Ribbon.Review-title"]'}get b_f(){return!1}get ribbonCommandInfo(){return new fa.a(1834994092,
da.a.Bd,this.$.se,9,null)}get Fga(){return G.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.LineageDiscoverabilityCalloutDisplayLimit",3)}HPa(){return 3}ppd(){return 86400}Toa(){return this.$.ea.Ddb}};nb.NPi="LineageDiscoverabilityCallout";nb=ka=Object(u.a)([Object(n.d)(z.Ib),Object(u.b)(0,Object(z.W)())],nb);Object(d.a)(nb,"LineageDiscoverabilityCallout",ma,[238]);class Ea extends f.a{constructor(Dc){super();this.$=Dc;this.je()}create(){const Dc=new nb(this.$);this.Ld(this.$.ga.Da(456)||this.$.ga.Qa(456,
Dc))}static la(Dc){Dc.ga.Qa(457,new Ea(Dc))}}Object(d.a)(Ea,"LineageDiscoverabilityCalloutFactory",f.a,[]);var sb=a(734),Oa=a(8);const La='[id="'+Oa.a.sng+'"]';class ia extends ma{constructor(Dc,Wa,Qb,Lc,Ba,qa,gb,Bb,ic,Cc){super(Dc,Wa,null,Qb,Lc,Ba,qa,gb,new Xa.a,Bb,!0,!0,ic,!1,!1,void 0,Cc)}get eV(){return La}get dV(){return La}get JU(){return La}get ribbonCommandInfo(){return new fa.a(-847286761,da.a.Bd,this.$.se,0,null)}Toa(){return!(this.$.isMobileMode||this.$.ea.te.inEmbedView||this.$.ea.te.inWebPart)}}
Object(d.a)(ia,"ZoomTeachingCallout",ma,[]);class Sa extends ia{constructor(Dc){super(Dc,"AdjustZoomTeachingCallout",Ua.a.instance.Ia(694),null,Ua.a.instance.Ia(693),2,1,!1,!0,2)}}Object(d.a)(Sa,"AdjustZoomTeachingCallout",ia,[]);class Za extends ma{constructor(Dc){super(Dc,"ConditionalFormattingManageRulesTeachingCallout",Ua.a.instance.Ia(643),Ua.a.instance.Ia(644),Ua.a.instance.Ia(641),Ua.a.instance.Ia(642),2,1,new Xa.a)}get eV(){return"[data-unique-id=Ribbon-ConditionalFormatting]"}get dV(){return'[data-unique-id="RibbonOverflowMenu"]'}get JU(){return'[id="m_excelWebRenderer_ewaCtl_Styles.CondFmt-Large"]'}get ribbonCommandInfo(){return new fa.a(-20558303,
da.a.Bd,this.$.se,0,null)}}Object(d.a)(Za,"ConditionalFormattingManageRulesTeachingCallout",ma,[]);var Ab;(function(Dc){Dc[Dc.overrideBrowserShortcuts=0]="overrideBrowserShortcuts";Dc[Dc.conditionalFormattingManageRules=1]="conditionalFormattingManageRules";Dc[Dc.linkedEntityBlankCellConvert=2]="linkedEntityBlankCellConvert";Dc[Dc.linkedEntityNoCuratedData=3]="linkedEntityNoCuratedData";Dc[Dc.lineageDiscoverability=4]="lineageDiscoverability";Dc[Dc.lineageTeachingCallout=5]="lineageTeachingCallout";
Dc[Dc.linkedEntityFirstOrganizationData=6]="linkedEntityFirstOrganizationData";Dc[Dc.adjustZoomTeachingCallout=7]="adjustZoomTeachingCallout";Dc[Dc.linkedEntityGallery=8]="linkedEntityGallery";Dc[Dc.fixedFreezePane=9]="fixedFreezePane";Dc[Dc.phoneticTeachingCallout=10]="phoneticTeachingCallout";Dc[Dc.powerQueryCallout=11]="powerQueryCallout";Dc[Dc.tableAIConvertToTableCallout=12]="tableAIConvertToTableCallout";Dc[Dc.optimizeWorkbookBusinessBarCallout=13]="optimizeWorkbookBusinessBarCallout";Dc[Dc.tableInNewWorkbook=
14]="tableInNewWorkbook";Dc[Dc.formulaByExampleCurtainLifterCallout=15]="formulaByExampleCurtainLifterCallout";Dc[Dc.dataCleansing=16]="dataCleansing";Dc[Dc.optimizeWorkbookSlowOperationsCallout=18]="optimizeWorkbookSlowOperationsCallout";Dc[Dc.excelBetterEntryTeachingCallout=19]="excelBetterEntryTeachingCallout";Dc[Dc.excelLiveWebEntryPointCallout=20]="excelLiveWebEntryPointCallout";Dc[Dc.functionDialog=21]="functionDialog";Dc[Dc.length=22]="length"})(Ab||(Ab={}));Object(d.b)("EwaCalloutName",Ab);
var pb=a(40);class Tb extends ia{constructor(Dc){super(Dc,"FixedFreezePaneTeachingCallout",Ua.a.instance.Ia(647),Ua.a.instance.Ia(645),Ua.a.instance.Ia(646),65536,16,!0,!1,8)}HPa(){return 0}}Object(d.a)(Tb,"FixedFreezePaneTeachingCallout",ia,[]);class ob extends ma{constructor(Dc){super(Dc,ob.RPi,"",Ua.a.instance.Ia(651),Ua.a.instance.Ia(653),Ua.a.instance.Ia(654),4096,12,new Xa.a,void 0,!0);this.pMa=9}get eV(){return ob.UFd}get dV(){return ob.UFd}get JU(){return ob.UFd}get ribbonCommandInfo(){return null}}
ob.RPi="LineageTeachingCallout";ob.UFd="#LineagePaneFilterButton";Object(d.a)(ob,"LineageTeachingCallout",ma,[]);var va=a(103),Pa=a(6),jb=a(56),Ob=a(22),kb=a(988);class ra extends kb.a{constructor(Dc){super("TextAboveImage");this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=Dc.paragraphs;this.image=Dc.image;this.imageWidth=Dc.imageWidth;this.imageHeight=Dc.imageHeight}}Object(d.a)(ra,"TextAboveImage",kb.a,[]);class rb{constructor(Dc,Wa){this.imageHeight=this.imageWidth=
this.image=this.paragraphs=null;this.paragraphs=Dc;this.image=Wa}}Object(d.a)(rb,"TextAboveImageCustomProps",null,[]);var Kb=a(896);class Sb extends H{constructor(Dc){super(Dc);this.Xdg=0;this.AYa=this.target=null;this.cNc=!1;this.Pv=this.Qv=null;this.S8c=0}YF(Dc,Wa,Qb,Lc,Ba,qa){if(!this.wq()){switch(Lc){case "DataTypes_PBI":this.S8c=1;break;default:this.S8c=0}this.target=Dc;this.Qv=String.format(Ua.a.instance.Ia(676),Wa);this.Pv=String.format(Ua.a.instance.Ia(677),Qb);this.Xdg=qa;this.FOj(Lc,Ba)}}FOj(Dc,
Wa){const Qb=!!this.$.xa&&Ob.a.equals(this.$.xa.UICultureTag,"en-us",!0);this.cNc=Wa&&Qb;Wa&&!Qb?this.AYa="BlankCell":Dc?this.AYa=Dc:(t.ULS.sendTraceTag(537169926,0,15,"LinkedEntityBlankCellConvertTeachingCallout.SetActionButtonAndSidePaneId: Callout BlankCellResourceId was null"),this.AYa="BlankCell")}show(){t.ULS.shipAssertTag(537169925,0,!!this.target&&!!this.Pv&&!!this.Qv,"LinkedEntityBlankCellConvertTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.wq()||(t.ULS.sendTraceTag(537169924,0,50,"LinkedEntityBlankCellConvertTeachingCallout.Show() - Showing LinkedEntityBlankCellConvertTeachingCallout callout."),super.show())}wq(){return!!this.WN}Qza(){const Dc=Object(r.a)(new E.a,{label:Ua.a.instance.Ia(682),ariaDescription:Ua.a.instance.Ia(683),onExecute:()=>{t.ULS.sendTraceTag(537169923,0,50,'LinkedEntityBlankCellConvertTeachingCallout - clicked "Got it" button');this.dismiss()}}),Wa=Object(r.a)(new E.a,{label:this.cNc?Ua.a.instance.Ia(680):
Ua.a.instance.Ia(678),ariaDescription:this.cNc?Ua.a.instance.Ia(681):Ua.a.instance.Ia(679),onExecute:()=>{t.ULS.sendTraceTag(537169922,0,50,'LinkedEntityBlankCellConvertTeachingCallout - clicked "'+(this.cNc?"Try sample data":"Learn more")+'" button');var qa=new Map;qa.set("Domain",this.Xdg.toString());va.Health.instance.recordKpiUsage("LinkedEntityBlankCellCalloutActionUsed",0,"ropari",qa);qa=new fa.a(-859308420,da.a.Bd,this.$.se,9,null);this.$.Ha.Ad(qa,{[da.a.Th]:"HelpID="+this.AYa,["InputMethod"]:da.a.Bd,
["ShouldCanvasTakeFocus"]:!0,[da.a.We]:Pa.a.xN});this.dismiss()}});var Qb=!!this.$&&!!this.$.frame&&!!this.$.frame.WF&&this.$.frame.WF.uQ;switch(this.S8c){case 1:var Lc=Qb?126:123;break;default:Lc=Qb?125:120}Lc=Object(r.a)(new Kb.a(jb.a.current.tq(Lc)),{alt:Ua.a.instance.xd(184)});const Ba=this.Pv.split("\n\n");Qb=Object(r.a)(new rb(Ba,Lc),{imageWidth:280,imageHeight:Qb?142:192});Qb=new ra(Qb);return Object(r.a)(new J.a,{target:this.target,content:Qb,title:this.Qv,primaryButtonProps:Wa,secondaryButtonProps:Dc,
showCloseIcon:!0,calloutProps:Object(r.a)(new I.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!0})}}Object(d.a)(Sb,"LinkedEntityBlankCellConvertTeachingCallout",H,[]);class cb extends ma{constructor(Dc){super(Dc,"LinkedEntityFirstOrganizationDataCallout",Ua.a.instance.Ia(672),Ua.a.instance.Ia(674),Ua.a.instance.Ia(670),Ua.a.instance.Ia(671),8192,13,new Xa.a,
void 0,void 0,!0,!0);this.target=null;this.AYa="DataTypes_PBI"}get eV(){return this.target.toString()}get dV(){return this.target.toString()}get JU(){return'[id="'+this.$.Pd+'Ribbon.Data.LinkedEntity"]'}get ribbonCommandInfo(){return new fa.a(-859308420,da.a.Bd,this.$.se,9,null)}get Qub(){return{[da.a.Th]:"HelpID="+this.AYa,["ShouldCanvasTakeFocus"]:!0,[da.a.We]:Pa.a.xN}}YF(Dc){this.wq()||(this.target=Dc,this.AYa="DataTypes_PBI")}wq(){return!!this.WN}Toa(){t.ULS.shipAssertTag(537169921,0,!!this.target,
"LinkedEntityFirstOrganizationDataTeachingCallout.InternalShouldShowCallout(): Cannot retrieve the callout target. InitializeCalloutProperties should be called before InternalShouldShowCallout");return!this.wq()}}Object(d.a)(cb,"LinkedEntityFirstOrganizationDataTeachingCallout",ma,[]);class cc extends ma{constructor(Dc){super(Dc,"LinkedEntityGalleryTeachingCallout","",Ua.a.instance.Ia(682),Ua.a.instance.Ia(684),Ua.a.instance.Ia(685),49152,14,new Xa.a,void 0,!0,!0,!0,!0);this.target=null;this.pMa=
5}get Fga(){return 2}get eV(){return this.target.toString()}get dV(){this.pMa=7;return"[data-unique-id=Ribbon-ConvertToLinkedEntityGallery]"}get JU(){return""}get ribbonCommandInfo(){return new fa.a(-847286761,da.a.Bd,this.$.se,0,Pa.a.xQb)}show(){t.ULS.shipAssertTag(537169920,0,!!this.target,"LinkedEntityGalleryTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.wq()||(t.ULS.sendTraceTag(558690322,0,50,"LinkedEntityGalleryTeachingCallout.Show() - LinkedEntityGalleryTeachingCallout Coachmark was shown."),
super.show())}YF(Dc){this.wq()||(this.target=Dc)}wq(){return!!this.WN}Toa(){t.ULS.shipAssertTag(537168099,0,!!this.target,"LinkedEntityGalleryTeachingCallout.InternalShouldShowCallout(): Cannot retrieve the callout target. InitializeCalloutProperties should be called before InternalShouldShowCallout");return!this.wq()}}Object(d.a)(cc,"LinkedEntityGalleryTeachingCallout",ma,[]);var Ub=a(11);class wb extends H{constructor(Dc){super(Dc);this.Pv=this.Qv=this.target=null}YF(Dc,Wa,Qb){this.wq()||(this.target=
Dc,this.Qv=String.format(Ua.a.instance.xd(186),Wa),this.Pv=String.format(Ua.a.instance.xd(188),Qb))}show(){t.ULS.shipAssertTag(537168098,0,!!this.target&&!!this.Pv&&!!this.Qv,"LinkedEntityNoCuratedDataTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.wq()||(t.ULS.sendTraceTag(537168097,0,50,"LinkedEntityNoCuratedDataTeachingCallout.Show() - Showing LinkedEntityNoCuratedDataTeachingCallout callout."),super.show())}wq(){return!!this.WN}Qza(){const Dc=
Object(r.a)(new E.a,{label:Ua.a.instance.ia(1806),ariaDescription:Ua.a.instance.ia(1807),onExecute:()=>{t.ULS.sendTraceTag(537168096,0,50,'LinkedEntityNoCuratedDataTeachingCallout - clicked "Learn how" button');va.Health.instance.recordKpiUsage("LinkedEntityNoCuratedDataCalloutActionUsed",0,"ropari",null);Ub.HelperMethods.Sg("https://go.microsoft.com/fwlink/?linkid=2134990",void 0,void 0,"NoCuratedDataCallout.NoCuratedDataFWLink");this.dismiss()}});var Wa=Object(r.a)(new Kb.a(jb.a.current.tq(this.$&&
this.$.frame&&this.$.frame.WF&&this.$.frame.WF.uQ?127:124)),{alt:Ua.a.instance.xd(189)});Wa=Object(r.a)(new rb([this.Pv],Wa),{imageWidth:280,imageHeight:142});Wa=new ra(Wa);return Object(r.a)(new J.a,{target:this.target,content:Wa,title:this.Qv,primaryButtonProps:Dc,showCloseIcon:!0,calloutProps:Object(r.a)(new I.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!0})}}
Object(d.a)(wb,"LinkedEntityNoCuratedDataTeachingCallout",H,[]);var vc=a(176),Lb=a(357);class Ja extends H{constructor(Dc){super(Dc);this.Pv=this.Qv=null}YF(Dc){this.wq()||(this.target=Dc,this.hPj())}show(){t.ULS.shipAssertTag(526234880,0,!!this.target&&!!this.Pv&&!!this.Qv,"OptimizeWorkbookBusinessBarCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.wq()||(t.ULS.sendTraceTag(526234851,0,50,"OptimizeWorkbookBusinessBarCallout.Show() - Showing OptimizeWorkbookBusinessBarCallout callout."),
vc.a.sendTelemetryEvent(Object(r.a)(new Lb.a,{name:"Office.Excel.Online.OptimizeWorkbook.BigHammerBusinessBarCalloutShown"})),super.show())}wq(){return!!this.WN}Qza(){return Object(r.a)(new J.a,{target:this.target,title:this.Qv,content:this.Pv,showCloseIcon:!0,calloutProps:Object(r.a)(new I.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!1,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!1})}hPj(){let Dc=
-1,Wa=0;const Qb=G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2OptimizeWorkbookManager",!1)?n.a.zg(z.bc):this.$.ga.Da(465);Qb&&(Dc=Qb.prb,Wa=Qb.Xob);switch(Wa){default:this.Qv=Ua.a.instance.Ia(722);this.Pv=Ua.a.instance.Ia(725);break;case 1:this.Qv=String.format(Ua.a.instance.Ia(723),Dc);this.Pv=Ua.a.instance.Ia(726);break;case 2:this.Qv=String.format(Ua.a.instance.Ia(724),Dc),this.Pv=Ua.a.instance.Ia(726)}}}Object(d.a)(Ja,"OptimizeWorkbookBusinessBarCallout",H,[]);var Hb=a(140);
class gc extends ma{constructor(Dc,Wa,Qb,Lc,Ba,qa,gb,Bb,ic){Bb=void 0===Bb?!1:Bb;super(Dc,void 0===ic?"OverrideBrowserShortcutsTeachingCallout":ic,Wa,Qb,Lc,Ba,qa,gb,new Xa.a,Bb)}get eV(){return"[data-unique-id=Help]"}get dV(){return"[data-unique-id=pivotOverflowButton]"}get JU(){return'[id="'+this.$.Pd+'Ribbon.Help-title"]'}get ribbonCommandInfo(){return new fa.a(-1018439626,da.a.Bd,this.$.se,0,Pa.a.d4)}Toa(){return!Hb.a.get(Pa.a.RUb)}}Object(d.a)(gc,"OverrideBrowserShortcutsTeachingCallout",ma,[]);
class ec extends gc{constructor(Dc,Wa,Qb,Lc,Ba,qa,gb,Bb){super(Dc,Wa,Qb,Lc,Ba,qa,gb,void 0===Bb?!1:Bb,"OverrideBrowserShortcutsTeachingCalloutOptInByDefault")}get ribbonCommandInfo(){return new fa.a(-901364793,da.a.Bd,this.$.se,0,Pa.a.d4)}get Qub(){return{[Pa.a.tPd]:!1}}}Object(d.a)(ec,"OverrideBrowserShortcutsTeachingCalloutOptInByDefault",gc,[]);var Ta=a(41);class ib extends ma{constructor(Dc,Wa,Qb,Lc,Ba,qa,gb,Bb,ic,Cc,hd,Pd,ue,Ee,Se,cf,mf,ac,bd){super(Dc,Wa,Qb,Lc,Ba,qa,Bb,ic,Cc,void 0===hd?!1:
hd,void 0===Pd?!1:Pd,void 0===ue?!1:ue,void 0===Ee?!1:Ee,void 0===Se?!1:Se,void 0===cf?!0:cf,void 0===mf?!1:mf,void 0===ac?null:ac,void 0===bd?!1:bd);this.learnMoreUrl=null;this.learnMoreUrl=gb}Chj(){try{Ta.a.f2(this.learnMoreUrl)}catch(Dc){}}Xce(){null!=this.learnMoreUrl&&this.Chj()}}Object(d.a)(ib,"EwaReactShowOrLearnMoreCallout",ma,[]);const bc='[id="'+Oa.a.sng+'"]';class jc extends ib{constructor(Dc){super(Dc,"PhoneticTeachingCallout",Ua.a.instance.Ia(695),Ua.a.instance.Ia(698),Ua.a.instance.Ia(697),
Ua.a.instance.Ia(696),"https://go.microsoft.com/fwlink/?linkid=2194045",131072,17,new Xa.a,void 0,void 0,void 0,void 0,void 0,void 0,!0,3,!0)}get eV(){return bc}get dV(){return bc}get JU(){return bc}get ribbonCommandInfo(){return new fa.a(1455037301,da.a.Bd,this.$.se,0,null)}GCf(){t.ULS.sendTraceTag(545837391,1,50,"PhoneticTeachingCallout - click learn more")}ADf(){t.ULS.sendTraceTag(545837390,1,50,"PhoneticTeachingCallout - click show")}}Object(d.a)(jc,"PhoneticTeachingCallout",ib,[]);var sc=a(180);
class Fa extends ma{constructor(Dc,Wa,Qb,Lc,Ba,qa){super(Dc,Wa,Ua.a.instance.Ia(708),Ua.a.instance.Ia(707),Ua.a.instance.Ia(703),Qb,Lc,Ba,new Xa.a,!0,!1,void 0,void 0,void 0,!0,!0);this.pMa=5;this.Pwb=qa}get Fga(){return 2}get eV(){return 1===sc.a(this.$).wR?"[data-unique-id=Ribbon-Refresh]":"[data-unique-id=Ribbon-RefreshAll]"}get dV(){return"[data-unique-id=Connections_MLR"}Toa(){return this.Pwb}get JU(){return'[id="'+this.$.Pd+'Ribbon.Data.RefreshAll"]'}get ribbonCommandInfo(){return new fa.a(-859308420,
da.a.Bd,this.$.se,9,null)}get Qub(){return{[da.a.Th]:"HelpID=PowerQuery_Refresh",["ShouldCanvasTakeFocus"]:!0,[da.a.We]:Pa.a.xN}}BFa(){return this.bba()}show(){this.DEb()?super.show():t.ULS.sendTraceTag(509677597,0,10,"PowerQueryRefreshTeachingCalloutBase.Show: Target object is null.")}}Object(d.a)(Fa,"PowerQueryRefreshTeachingCalloutBase",ma,[]);class Ha extends Fa{constructor(Dc){super(Dc,"PowerQueryRefreshFromTableTeachingCallout",Ua.a.instance.Ia(705),3145728,20,G.EwaSettings.isChangeGateEnabled("OfficeVSO:7847555_PowerQueryTaskPaneSwitchToNewFeatureGateAPI")?
G.EwaSettings.isChangeGateEnabled("OfficeVSO:7111771_PowerQueryRefreshWeb"):G.EwaSettings.$Hi())}}Object(d.a)(Ha,"PowerQueryRefreshFromTableTeachingCallout",Fa,[]);class Na extends ma{constructor(Dc){super(Dc,"QueriesTaskPaneTeachingCallout",Ua.a.instance.Ia(702),Ua.a.instance.Ia(701),Ua.a.instance.Ia(G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryConnectionsTaskPane",!1)?849:699),Ua.a.instance.Ia(G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryConnectionsTaskPane",
!1)?850:700),12582912,22,new Xa.a,!0,void 0,void 0,void 0,void 0,!0,!0);this.pMa=5;this.Pwb=G.EwaSettings.isChangeGateEnabled("OfficeVSO:7847555_PowerQueryTaskPaneSwitchToNewFeatureGateAPI")?G.EwaSettings.isChangeGateEnabled("OfficeVSO:7095227_PowerQueryTaskPaneGroupsOperations"):G.EwaSettings.pIi()}get Fga(){return 2}get eV(){return"[data-unique-id=Ribbon-OpenQueriesTaskPane]"}get dV(){return"[data-unique-id=Connections_MLR]"}get JU(){return'[id="'+this.$.Pd+'Ribbon.Data.Queries"]'}BFa(){return this.bba()}show(){this.DEb()?
super.show():t.ULS.sendTraceTag(537168092,0,10,"QueriesTaskPaneTeachingCallout.Show: Target object is null.")}Toa(){return this.Pwb}get ribbonCommandInfo(){return new fa.a(1156885807,da.a.Bd,this.$.se,0,Pa.a.xQb)}}Object(d.a)(Na,"QueriesTaskPaneTeachingCallout",ma,[]);var W=a(431),U=a(200),za=a(585),ua=a(248),$a=a(247);class Va extends Fa{constructor(Dc){super(Dc,"PowerQueryAuthenticatedRefreshTeachingCallout",Ua.a.instance.Ia(706),805306368,28,G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",
!1))}}Object(d.a)(Va,"PowerQueryAuthenticatedRefreshTeachingCallout",Fa,[]);class hb extends ma{constructor(Dc){super(Dc,"PowerQueryClearAllPermissionsTeachingCallout",Ua.a.instance.Ia(708),Ua.a.instance.Ia(701),Ua.a.instance.Ia(852),Ua.a.instance.Ia(853),3,32,new Xa.a,!0,!1,void 0,void 0,void 0,!0,!0);this.pMa=5;this.Pwb=G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryClearAllCredentialTaskPane",!1)}get Fga(){return 2}get eV(){return"[data-unique-id=Ribbon-OpenQueriesTaskPane]"}get dV(){return"[data-unique-id=Connections_MLR]"}get JU(){return'[id="'+
this.$.Pd+'Ribbon.Data.Queries"]'}BFa(){return this.bba()}show(){this.DEb()?super.show():t.ULS.sendTraceTag(508687132,0,10,"PowerQueryClearAllPermissionsTeachingCallout.Show: Target object is null.")}Toa(){return this.Pwb}get ribbonCommandInfo(){return new fa.a(-859308420,da.a.Bd,this.$.se,9,null)}get Qub(){return{[da.a.Th]:"HelpID=PowerQuery_Refresh",["ShouldCanvasTakeFocus"]:!0,[da.a.We]:Pa.a.xN}}}Object(d.a)(hb,"PowerQueryClearAllPermissionsTeachingCallout",ma,[]);var qb=a(91);class Nb{constructor(Dc){this.hvd=
this.tvd=!1;this.bba=!0;this.x9i=Wa=>{if(Wa&&!ua.a(Wa))try{const Qb=Wa.Result,Lc=Qb.QueryGroups;if(0<Qb.Queries.length||0<Lc.length)this.tvd=!0,this.hvd=Qb.PowerQueryDataSources?Qb.PowerQueryDataSources.includes("Excel.CurrentWorkbook")||Qb.PowerQueryDataSources.includes("OData.Feed"):!1,G.EwaSettings.isChangeGateEnabled("OfficeVSO:7971437_RefactorShowCalloutIfNeeded")?void this.t0j():this.iIc()}catch(Qb){t.ULS.sendTraceTag(537168095,0,10,`PowerQueryCallout.OnGetQueriesSuccess: QueryInfoList retrieval encountered exception ${Qb}.`)}};
this.Qxc=()=>{t.ULS.sendTraceTag(537168094,0,15,"PowerQueryCallout.OnGetQueriesFailure")};this.$=Dc;this.pBc=new Na(Dc);this.powerQueryClearAllPermissionsCallout=new hb(Dc);this.Lgb=G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)?new Va(Dc):new Ha(Dc)}show(){this.bba&&this.eNj()}eNj(){this.$.userOperationManager.enqueueOperation(new U.a(587,0,(Dc,Wa,Qb)=>za.d(this.$.qa.ua,$a.b(Dc,this.x9i),$a.a(Wa,this.Qxc),Qb,null),80,()=>new W.a),null)}iIc(){this.pBc.BFa().continueWith(Dc=>
{Dc.result&&this.tvd?(this.pBc.show(),this.bba=!1):this.Lgb.BFa().continueWith(Wa=>{Wa.result&&(this.Lgb instanceof Va||this.hvd)?(this.Lgb.show(),this.bba=!1):this.powerQueryClearAllPermissionsCallout.BFa().continueWith(Qb=>{Qb.result&&this.powerQueryClearAllPermissionsCallout.show();this.bba=!1})})})}t0j(){const Dc=this;return Io(function*(){(yield qb.c(Dc.pBc.BFa()))&&Dc.tvd?Dc.pBc.show():(yield qb.c(Dc.Lgb.BFa()))&&(Dc.Lgb instanceof Va||Dc.hvd)?Dc.Lgb.show():(yield qb.c(Dc.powerQueryClearAllPermissionsCallout.BFa()))&&
Dc.powerQueryClearAllPermissionsCallout.show();Dc.bba=!1})}}Object(d.a)(Nb,"PowerQueryCallout",null,[270]);class yb extends H{constructor(Dc){super(Dc);this.MKd=this.qdd=this.Pv=this.Qv=this.target=null}YF(Dc,Wa,Qb){this.wq()||(this.target=Dc,this.qdd=Wa,this.MKd=Qb,this.Qv=Ua.a.instance.Ia(710),this.Pv=Ua.a.instance.Ia(711))}show(){t.ULS.shipAssertTag(537168091,0,!!this.target&&!!this.Pv&&!!this.Qv&&!!this.qdd&&!!this.MKd,"TableAIConvertToTableCallout.Show() - Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.wq()||(t.ULS.sendTraceTag(0,0,50,"TableAIConvertToTableCallout.Show() - Showing TableAIConvertToTableCallout callout."),super.show())}wq(){return!!this.WN}Qza(){const Dc=Object(r.a)(new E.a,{label:Ua.a.instance.Ia(712),ariaDescription:Ua.a.instance.Ia(714),onExecute:()=>{t.ULS.sendTraceTag(0,0,50,'TableAIConvertToTableCallout - clicked "Format as table" button');this.qdd();this.dismiss()}}),Wa=Object(r.a)(new E.a,{label:Ua.a.instance.Ia(713),ariaDescription:Ua.a.instance.Ia(715),onExecute:()=>
{t.ULS.sendTraceTag(0,0,50,'TableAIConvertToTableCallout - clicked "No thanks" button');this.MKd();this.dismiss()}});return Object(r.a)(new J.a,{target:this.target,content:this.Pv,title:this.Qv,primaryButtonProps:Dc,secondaryButtonProps:Wa,showCloseIcon:!0,calloutProps:Object(r.a)(new I.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!1,hasFocusableControls:!0})}}Object(d.a)(yb,
"TableAIConvertToTableCallout",H,[]);var ja=a(183),Ka=a(84);class Pb{constructor(Dc){this.Obk=Dc}show(){Ka.a.instance.Qd("Common.ISystemInitiatedFeedback").execute(Dc=>{Dc.logActivity(this.Obk,null)})}}Object(d.a)(Pb,"EwaLppCallout",null,[270]);var rc=a(45);class $c extends Pb{constructor(Dc){super("ExcelTableInNewWorkbook");this.Jzd=this.UBa=!1;this.createTable=()=>{const Wa=rc.v(new ja.a(1,1,8,3,Oa.a.yh,Oa.a.xh),this.$),Qb={};Qb.TableRange=Wa;Qb.HasHeader=!1;this.$.Me(71074531,da.a.Bd,9,Qb)};this.bUe=
()=>{this.createSampleTable("0")};this.cUe=()=>{this.createSampleTable("2")};this.dUe=()=>{this.createSampleTable("1")};this.$=Dc;(this.UBa=G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableInNewWorkbook",!1))&&window.addEventListener("ExcelCreateSampleTable",this.createTable,!0);if(this.Jzd=G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateSampleTableCallout",!1))window.addEventListener("ExcelCreateSampleTableBlank",this.bUe,!0),window.addEventListener("ExcelCreateSampleTableContact",
this.cUe,!0),window.addEventListener("ExcelCreateSampleTableToDo",this.dUe,!0)}dispose(){this.UBa&&window.removeEventListener("ExcelCreateSampleTable",this.createTable,!0);this.Jzd&&(window.removeEventListener("ExcelCreateSampleTableBlank",this.bUe,!0),window.removeEventListener("ExcelCreateSampleTableContact",this.cUe,!0),window.removeEventListener("ExcelCreateSampleTableToDo",this.dUe,!0))}createSampleTable(Dc){const Wa={};Wa[da.a.We]=Dc;this.$.Me(1371713064,da.a.Bd,9,Wa)}}Object(d.a)($c,"TableInNewWorkbookCallout",
Pb,[]);var Dd=a(979);class Jd extends H{constructor(Dc){super(Dc);this.tIc=5E3;this.Qv=Dd.a.Title;this.currentState=0}DT(Dc,Wa){Dd.c.get(this.currentState).includes(Dc)&&(6===Dc?window.requestAnimationFrame(()=>this.l8a(Dc,Wa)):this.l8a(Dc,Wa))}jYb(Dc){this.target=Dc}show(){super.dismiss();this.O9f();super.show()}dismiss(){this.DT(0);window.clearTimeout(this.k5f);super.dismiss()}Qza(){return Object(r.a)(new J.a,{target:this.target,title:this.Qv,content:this.Pv,showCloseIcon:!0,calloutProps:{setInitialFocus:!1,
preventDismissOnResize:!0,preventDismissOnScroll:!0,preventDismissOnLostFocus:!0,isBeakVisible:!0,directionalHint:12,onDismiss:void 0},useTeachingStyles:!1,hasFocusableControls:!1})}update(){this.O9f();super.OZa({message:this.Pv})}l8a(Dc,Wa){const Qb=Dd.b.get(Dc);this.Kgk(this.uCh(Dc)?`${Qb}${Wa}`:Qb);this.currentState=Dc;0!=this.currentState?(this.update(),this.show()):this.dismiss()}uCh(Dc){switch(Dc){case 5:case 6:return!0;default:return!1}}O9f(){window.clearTimeout(this.k5f);this.k5f=window.setTimeout(()=>
this.dismiss(),this.tIc)}Kgk(Dc){this.Pv=Dc}}Object(d.a)(Jd,"FormulaByExampleCurtainLifterCallout",H,[]);var Kd=a(186);class ce extends ma{constructor(Dc){super(Dc,"DataCleansingTeachingCallout",Kd.a.ia(1952),Kd.a.ia(1953),"",Kd.a.ia(1954),16777216,24,new Xa.a,!0,!1,!1,!1,!0,!0,!0,5,!0);this.$5d="[id=DataCleansingTaskPane]";this.szg=!1}YF(Dc,Wa){this.ZAg=String.format(Ua.a.instance.xd(213),Dc);this.szg=Wa}HPa(){return G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverabilityCallout",
!1)&&this.szg?0:2}ppd(){return 2592E3}get eV(){return this.$5d}get dV(){return this.$5d}get JU(){return this.$5d}get ribbonCommandInfo(){return new fa.a(-1190551534,da.a.Bd,this.$.se,0,null)}}Object(d.a)(ce,"DataCleansingTeachingCallout",ma,[]);var ge=a(118);class uc extends H{constructor(Dc){super(Dc);this.Pv=this.Qv=this.target=null;this.duration=0}YF(Dc,Wa,Qb){this.wq()||(this.target=Dc,this.Qv=this.M3h(Wa),this.Pv=Ua.a.instance.Ia(737),this.operation=Wa,this.duration=Qb)}show(){t.ULS.shipAssertTag(512304648,
0,!!this.target&&!!this.Pv&&!!this.Qv,"OptimizeWorkbookSlowOperationsCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");if(!this.wq()){t.ULS.sendTraceTag(512304647,0,50,"OptimizeWorkbookSlowOperationsCallout.Show() - Showing OptimizeWorkbookSlowOperationsCallout callout.");var Dc={["Operation"]:this.operation,["Duration"]:this.duration};vc.a.sendTelemetryEvent(Object(r.a)(new Lb.a,{name:"Office.Excel.Online.OptimizeWorkbook.BigHammerSlowOperationsCalloutShown",
dataFields:ge.a.$k(Dc)}));super.show()}}wq(){return!!this.WN}Qza(){return Object(r.a)(new J.a,{target:this.target,title:this.Qv,content:this.Pv,showCloseIcon:!0,calloutProps:Object(r.a)(new I.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!1,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!1})}M3h(Dc){switch(Dc){case 0:return Ua.a.instance.Ia(727);case 1:return Ua.a.instance.Ia(728);case 2:return Ua.a.instance.Ia(729);
case 3:return Ua.a.instance.Ia(730);case 4:return Ua.a.instance.Ia(731);case 5:return Ua.a.instance.Ia(732);case 6:return Ua.a.instance.Ia(733);case 7:return Ua.a.instance.Ia(734);case 8:return Ua.a.instance.Ia(735);case 9:return Ua.a.instance.Ia(736);default:return""}}}Object(d.a)(uc,"OptimizeWorkbookSlowOperationsCallout",H,[]);class dd extends H{constructor(){super(...arguments);this.kCg="ClickOnLaunch";this.DBg="ClickOnDismiss";this.eDg="Show";this.QBg="BetterEntryPoint_InsertTab";this.sDg=500;
this.eCg=280;this.dCg=192;this.NCg="[data-unique-id=Ribbon-InsertAddinTransitionEntry]";this.XBg="[data-unique-id=Home]";this.gCg="InsertAddinTransitionEntry";this.YBg="Home";this.fCg="InsertAddInFlyout";this.PCg="RibbonOverflowMenu-overflow"}YF(){}show(){this.kC(this.eDg);t.ULS.sendTraceTag(509367621,0,50,"ExcelBetterEntryTeachingCallout.Show() - Showing ExcelBetterEntryTeachingCallout callout.");super.show()}Qza(){let Dc=this.NCg;var Wa=document.getElementById(this.gCg),Qb=Wa?window.getComputedStyle(Wa,
null):null;if(null==Wa||Qb&&"none"===Qb.display)Dc=this.XBg;Wa=CommonUIStrings.l_BetterEntryPointTUI_Title;var Lc=CommonUIStrings.l_BetterEntryPointTUI_Content;Qb=new Kb.a("https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE5elF8");Lc=Lc.split("\n");Qb=Object.assign(new rb(Lc,Qb),{imageWidth:this.eCg,imageHeight:this.dCg});Qb=new ra(Qb);Lc=Object.assign(new E.a,{label:CommonUIStrings.l_BetterEntryPointTUI_ButtonText1,ariaDescription:CommonUIStrings.l_BetterEntryPointTUI_ButtonText1,onExecute:()=>
{this.uoi();this.kC(this.kCg);this.dismiss()}});const Ba=Object.assign(new E.a,{label:CommonUIStrings.l_BetterEntryPointTUI_ButtonText2,ariaDescription:CommonUIStrings.l_BetterEntryPointTUI_ButtonText2,onExecute:()=>{this.kC(this.DBg);this.dismiss()}});return Object.assign(new J.a,{target:Dc,content:Qb,title:Wa,primaryButtonProps:Lc,secondaryButtonProps:Ba,showCloseIcon:!0,hasDynamicSizing:!1,preventLightDismiss:!1,useTeachingStyles:!0,calloutProps:Object.assign(new I.a,{onDismiss:()=>{this.dismiss()},
setInitialFocus:!0})})}uoi(){appChrome.api.dispatch(appChrome.actions.setCurrentTab(this.YBg));window.setTimeout(()=>{this.xFd()},this.sDg)}xFd(){const Dc=document.getElementById(this.fCg),Wa=Dc?window.getComputedStyle(Dc,null):null;if(null==Dc||Wa&&"none"===Wa.display){const Qb=document.getElementById(this.PCg);null!=Qb?(Qb.onclick=function(){window.setTimeout(()=>{const Lc=document.querySelector("[data-unique-id='Overflow-InsertAddInFlyout']");null!=Lc&&(Lc.click(),t.ULS.sendTraceTag(509367620,
0,50,"Launch flyout in overflow"))},500);Qb.onclick=function(){}},Qb.click()):t.ULS.sendTraceTag(509367619,0,10,"Neither ribbon nor overflow can launch flyout")}else Dc.click(),t.ULS.sendTraceTag(509367618,0,50,"Launch flyout in ribbon button")}kC(Dc){Dc={["AppTeachingUICalloutAction"]:Dc,["AppTeachingUICalloutGoal"]:this.QBg};vc.a.sendTelemetryEvent(Object.assign(new Lb.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ge.a.$k(Dc)}))}}Object(d.a)(dd,"ExcelBetterEntryTeachingCallout",
H,[]);class Rd extends ma{constructor(Dc){super(Dc,"FunctionDialogTeachingCallout",void 0,Ua.a.instance.Ia(763),Ua.a.instance.Ia(760),Ua.a.instance.Ia(761),1073741824,30,new Xa.a,!0,!0,!1,!1,!0,!0,!0,5,!0)}YF(Dc){this.H6c=`[id=${"CellEdit"===Dc?this.$.Pd+Pa.a.bjc:"InsertFunction"}]`}HPa(){return 1}get eV(){return this.H6c}get dV(){return this.H6c}get JU(){return this.H6c}get ribbonCommandInfo(){return null}}Object(d.a)(Rd,"FunctionDialogTeachingCallout",ma,[]);class Yd extends Pb{constructor(Dc){super("ExcelLiveWebEntryPointCallout");
this.rBa=!1;this.Omg=()=>{this.$.Me(327119921,da.a.Bd,9,null)};this.$=Dc;(this.rBa=G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelLiveWebEntryPointCalloutEnabled",!1))&&window.addEventListener("TryCoEditInTeams",this.Omg,!0)}dispose(){this.rBa&&window.removeEventListener("TryCoEditInTeams",this.Omg,!0)}}Object(d.a)(Yd,"ExcelLiveWebEntryPointCallout",Pb,[]);class Md{constructor(Dc){this.$=Dc;this.My=new pb.a(!1)}Fci(Dc){if(!this.My.kd(Ab[Dc]))switch(Dc){case 0:this.hoh(Dc);break;
case 2:this.My.add(Ab[Dc],new Sb(this.$));break;case 3:this.My.add(Ab[Dc],new wb(this.$));break;case 6:this.My.add(Ab[Dc],new cb(this.$));break;case 1:this.My.add(Ab[Dc],new Za(this.$));break;case 4:this.My.add(Ab[Dc],new nb(this.$));break;case 5:this.My.add(Ab[Dc],new ob(this.$));break;case 7:this.My.add(Ab[Dc],new Sa(this.$));break;case 8:this.My.add(Ab[Dc],new cc(this.$));break;case 9:this.My.add(Ab[Dc],new Tb(this.$));break;case 13:this.My.add(Ab[Dc],new Ja(this.$));break;case 10:this.My.add(Ab[Dc],
new jc(this.$));break;case 11:this.My.add(Ab[Dc],new Nb(this.$));break;case 12:this.My.add(Ab[Dc],new yb(this.$));break;case 14:this.My.add(Ab[Dc],new $c(this.$));break;case 15:this.My.add(Ab[Dc],new Jd(this.$));break;case 16:this.My.add(Ab[Dc],new ce(this.$));break;case 18:this.My.add(Ab[Dc],new uc(this.$));break;case 20:this.My.add(Ab[Dc],new Yd(this.$));break;case 19:this.My.add(Ab[Dc],new dd(this.$));break;case 21:this.My.add(Ab[Dc],new Rd(this.$));break;default:return null}return this.My.getItem(Ab[Dc])}hoh(Dc){this.My.add(Ab[Dc],
new ec(this.$,Ua.a.instance.Ia(640),Ua.a.instance.Ia(637),Ua.a.instance.Ia(638),Ua.a.instance.Ia(639),16,4,!0))}}Object(d.a)(Md,"EwaCalloutFactory",null,[]);var ad=a(60),Mb=a(62),Aa=a(160);let Bc=class{constructor(Dc){this.$=Dc;this.sIh=new Md(this.$)}Pe(){return!1}Ue(){return!1}Be(Dc,Wa,Qb){Dc=Qb.CalloutName;this.tZj=G.EwaSettings.isChangeGateEnabled("OfficeVSO:6189760_SuppressTeachingCalloutForLiveMeetings")&&Object(Aa.c)(this.$)&&!this.UBi(Dc);return!!Wa&&-847286761===Wa.command&&ad.a.Bi.wU&&!this.tZj}UBi(Dc){return this.$.rx&&
9===Dc}executeCommand(Dc,Wa,Qb){Dc=Qb.CalloutName;if(Wa=this.sIh.Fci(Dc)){switch(Dc){case 2:Wa.YF(Qb.Target,Qb.RibbonButtonLabel,Qb.ExampleEntities,Qb.BlankCellResourceId,Qb.HasBlankCellWalkthrough,Qb.ServiceDomain);break;case 3:Wa.YF(Qb.Target,Qb.RibbonButtonLabel,Qb.ExampleEntities);break;case 6:Wa.YF(Qb.Target);break;case 8:Wa.YF(Qb.Target);break;case 13:Wa.YF(Qb.Target);break;case 15:return Wa.jYb(Qb.Target),Wa.DT(Qb.NewState,Qb.Reason),Mb.Task.Wa(!0);case 12:Wa.YF(Qb.Target,Qb.ConvertToTableCallback,
Qb.NoThanksCallback);break;case 16:Wa.YF(Qb.SuggestionsCount,Qb.WithoutCoolDown);break;case 18:Wa.YF(Qb.Target,Qb.Operation,Qb.Duration);break;case 19:Wa.YF();break;case 21:Wa.YF(Qb.Trigger)}Wa.show();return Mb.Task.Wa(!0)}return Mb.Task.Wa(!1)}};Bc=Object(u.a)([Object(n.d)(z.Mc),Object(u.b)(0,Object(z.W)())],Bc);Object(d.a)(Bc,"ShowCalloutCommandHandler",null,[203]);class Vc extends sb.a{constructor(Dc){super(Dc)}dispose(){super.dispose()}Uf(){this.Lf([new Bc(this.$)])}static la(Dc){sb.a.qg(378,
new Vc(Dc))}}Object(d.a)(Vc,"ShowCalloutCommandHandlerFactory",sb.a,[]);var hc=a(10),xc=a(83),ab=a(53),Wb=a(59);const Yc=(Dc,Wa,Qb,Lc,Ba,qa,gb)=>{gb=Dc.Pa(1,void 0===gb?null:gb);gb.sheetName=Wa;return Wb.g(Dc,"EvaluateSheetOptimizableContent",gb,Qb,Lc,Ba,qa,4)};var Tc=a(19),ed=a(42),be=a(138);class Fc{constructor(Dc,Wa){this.sessionID=null;this.GWf=Qb=>{if(Qb){let Lc=ed.d(Qb.data);({Mu:Qb}=Lc);if(Lc.returnValue&&(Qb=Object(be.a)(Object,Qb))&&"OptimizeWorkbookTaskPane"===Qb.Origin)if(this.sessionID!==
Qb.SessionId)t.ULS.sendTraceTag(509748062,0,10,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(Qb.Event){case "Error_LoadBookData":this.optimizeWorkbookManager.SRj();t.ULS.sendTraceTag(509673560,0,50,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Load book data error Event.");break;case "OptimizeTriggered":this.optimizeWorkbookManager.qSj();t.ULS.sendTraceTag(509688027,
0,50,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Optimize Event.");break;case "TriggerFeedback":this.optimizeWorkbookManager.S_j();t.ULS.sendTraceTag(509748061,0,50,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Feedback Event.");break;default:t.ULS.sendTraceTag(509748060,0,10,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Unhandled Event.")}}};this.optimizeWorkbookManager=Dc;this.sessionID=
Wa}initialize(){window.addEventListener("message",this.GWf,!1)}dispose(){window.removeEventListener("message",this.GWf,!1)}}Object(d.a)(Fc,"OptimizeWorkbookTaskPaneListener",null,[]);var vd=a(155);let lb=class extends xc.a{constructor(Dc){super();this.businessBar=null;this.Xob=2;this.prb=-1;this.hFc=!1;this.QOb=null;this.FBf=this.ypg=this.Nvf=this.FWf=!1;this.f7i=Wa=>{this.$&&((Wa=Wa.Result)?Wa.HasSignificantOptimizableContent?(t.ULS.sendTraceTag(539870352,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation completed with significant optimizable content"),
Wa.OptimizableRangesOrPercentage&&(this.prb=Wa.OptimizableRangesOrPercentage),0>=this.prb&&0!==this.Xob&&(t.ULS.sendTraceTag(512349446,0,50,"OptimizeWorkbookManager.OptimizableRangesOrPercentage Range count or percentage must return valid value"),this.Xob=0),this.oVb()):t.ULS.sendTraceTag(537154764,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation completed without significant optimizable content"):t.ULS.sendTraceTag(537154763,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Null result object"))};
this.udj=(Wa,Qb,Lc)=>{(Wa=Wa.Result)?Wa.HasSignificantOptimizableContent?(t.ULS.sendTraceTag(512304643,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Operation completed with significant optimizable content"),this.hFc=!0,this.E1j(Qb,Lc)):t.ULS.sendTraceTag(512304644,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Operation completed without significant optimizable content"):t.ULS.sendTraceTag(512304645,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Null result object")};this.$=Dc;this.R4j();
this.hFc=!1;this.iDh=G.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SlowOperationDurationThreshold",2E3);this.QOb=new Fc(this,this.$.ea.sessionId)}dispose(){this.RQa();this.$=this.businessBar=null;this.nYe();super.dispose()}Nxi(){this.QOb&&this.QOb.initialize()}nYe(){this.QOb&&this.QOb.dispose()}RQa(){this.businessBar&&this.businessBar.jpa(62)&&this.businessBar.removeEntry(62)}R4j(){Ka.a.instance.Qd("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Dc=>{Dc.isFeatureEnabled("ExcelOptimizeCellTableBigHammer",
!1).then(Wa=>{if(Wa){var Qb=this.$.qa.ua,Lc=this.Xob,Ba=this.f7i;const qa=Qb.Pa(1,null);qa.businessBarMessageType=Lc;Wb.g(Qb,"EvaluateOptimizableContentV2",qa,Ba,null,null,null,4)}return Wa})})}oVb(){const Dc=Object(vd.a)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(qb.d)(n.a.resolve(z.m,{Ja:1})):ab.GetServiceTaskFactory.ud(this.$.ga,5,4,1);S.TaskExtensions.za(Dc,()=>{const Wa=Dc.result;Wa&&(Wa.yi(62,null,null,this.p3h()),this.businessBar=Wa)},this.$.ka,3)}p3h(){switch(this.Xob){default:return Ua.a.instance.ia(2239);
case 1:return String.format(Ua.a.instance.Ia(720),this.prb);case 2:return String.format(Ua.a.instance.Ia(721),this.prb)}}Xxi(){!G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableClosePaneFeedback",!1)||!this.Nvf||this.FWf||this.ypg||this.FBf||(Ka.a.instance.Qd("Common.ISystemInitiatedFeedback").execute(Dc=>{Dc.logActivity("Office_Excel_OptimizeWorkbook_InitializeClosePaneFloodgate",null)}),t.ULS.sendTraceTag(509688028,0,50,"OptimizeWorkbookManager.initiateClosePaneFeedback() - Feedback Triggered."))}BRj(Dc){this.Nvf=
Dc}qSj(){this.FWf=!0}SRj(){this.FBf=!0}uba(Dc,Wa,Qb){if(Wa&&Wa.RequestTelemetryData&&!(Wa.RequestTelemetryData.EcsOperationDuration<this.iDh)&&this.businessBar&&this.businessBar.jpa(62)&&!this.hFc){var Lc=Qb?Qb:this.$.na.sheetName;if(6===Dc||7===Dc||8===Dc||9===Dc)this.evaluateSheetOptimizableContent(Lc,Dc,Wa.RequestTelemetryData.EcsOperationDuration);else{const Ba=()=>{Tc.h(this.$).ya.Bs(Ba);this.evaluateSheetOptimizableContent(Lc,Dc,Wa.RequestTelemetryData.EcsOperationDuration)};Tc.h(this.$).ya.Ws(Ba)}}}evaluateSheetOptimizableContent(Dc,
Wa,Qb){Yc(this.$.qa.ua,Dc,Lc=>{this.udj(Lc,Wa,Qb)},null,null,null)}E1j(Dc,Wa){const Qb=new fa.a(-847286761,da.a.Bd,this.$.se,0,null),Lc={CalloutName:18};Lc.Target=this.businessBar.Hod(62);Lc.Operation=Dc;Lc.Duration=Wa;this.$.Ha.Ad(Qb,Lc)}S_j(){this.$.Me(802602464,da.a.Bd,12,{[Pa.a.SH]:"OptimizeWorkbookTaskPane"});this.ypg=!0}};lb=Object(u.a)([Object(n.d)(z.bc),Object(u.b)(0,Object(z.W)())],lb);Object(d.a)(lb,"OptimizeWorkbookManager",xc.a,[305]);var Eb=a(737);class Hc extends f.a{constructor(Dc){super();
this.$=Dc;this.je()}create(){const Dc=Object(Eb.a)(this.$.ga,465,()=>new lb(this.$));this.Ld(Dc)}static la(Dc){Dc.ga.Qa(466,new Hc(Dc))}}Object(d.a)(Hc,"OptimizeWorkbookManagerFactory",f.a,[]);var Bd=a(175),he=a(765),je=a(738);class Fd extends he.a{constructor(){super();this.range=null;this.H_=Object.assign(new je.a,{T_:Fd.getTypeName(),B_:Fd.getBaseTypes()})}static getTypeName(){return"AugLoop_Excel_ExcelRangeWrapperAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(d.a)(Fd,
"ExcelRangeWrapperAnnotation",he.a,[]);class Oc extends Fd{constructor(){super();this.hasMergedcells=this.tableName=this.interpretations=null;this.H_=Object.assign(new je.a,{T_:Oc.getTypeName(),B_:Oc.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableAi_ExcelRecognizedTableNew"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeWrapperAnnotation","AugLoop_Core_Annotation"]}}Object(d.a)(Oc,"ExcelRecognizedTableNew",Fd,[]);class Ad extends Oc{constructor(){super();this.requestId=null;
this.H_=Object.assign(new je.a,{T_:Ad.getTypeName(),B_:Ad.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_ExcelRangeMetadata"}static getBaseTypes(){return["AugLoop_ExcelTableAi_ExcelRecognizedTableNew","AugLoop_Core_Annotation"]}}Object(d.a)(Ad,"ExcelRangeMetadata",Oc,[]);var Gb=a(1010);class Wc extends Gb.a{constructor(){super();this.value=null;this.type=0;this.H_=Object.assign(new je.a,{T_:Wc.getTypeName(),B_:Wc.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_ExtendedExcelCell"}static getBaseTypes(){return["AugLoop_Excel_ExcelCell",
"AugLoop_Core_GridCell"]}}Object(d.a)(Wc,"ExtendedExcelCell",Gb.a,[]);var pd=a(873);class fe extends pd.a{constructor(){super();this.mergeCellAddresses=this.requestId=this.cells=this.range=null;this.H_=Object.assign(new je.a,{T_:fe.getTypeName(),B_:fe.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_RangeDataSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(d.a)(fe,"RangeDataSignal",pd.a,[]);var le=a(1217),te=a(106),Ce=a(39);class Xb extends Sys.EventArgs{constructor(Dc){super();
this.EQb=Dc}}Object(d.a)(Xb,"RecognizedTableUpdateEventArgs",Sys.EventArgs,[]);var oc=a(198),Zc=a(26),yd=a(356);class Od{constructor(Dc,Wa,Qb,Lc,Ba){this.wD=Dc;this.interpretations=Wa;this.tableName=Qb;this.id=Lc;this.kmf=Ba}}Object(d.a)(Od,"RecognizedTable",null,[]);class dc{constructor(Dc,Wa,Qb){this.classification=Dc;this.aggregations=Wa;this.headerReferences=Qb}}Object(d.a)(dc,"TableField",null,[]);var gd=a(1136);const wd=Dc=>{var Wa=new yd.a(Ld(Dc.range),Dc.range.worksheetId);var Qb=Dc.interpretations;
var Lc=new oc.a;if(Qb&&Qb.length)for(const cf of Qb){b:switch(cf.orientation.toLowerCase()){case "columnmajor":Qb=2;break b;case "rowmajor":Qb=1;break b;default:t.ULS.sendTraceTag(537151256,0,50,"Invalid value for table orientaion."),Qb=0}const mf=Qb;if(0===mf)t.ULS.sendTraceTag(537151257,0,50,"Invalid value for table orientaion. Skipping current interpretation.");else{Qb=gd.a;var Ba=Ld(cf.location),qa=cf.confidence,gb=cf.headerRowCount,Bb=cf.headerColumnCount;var ic=cf.fields;var Cc=new oc.a;if(ic)for(const ac of ic){ic=
Cc;var hd=ic.add;c:switch(ac.classification.toLowerCase()){case "dimension":var Pd=1;break c;case "measure":Pd=2;break c;default:t.ULS.sendTraceTag(537151255,0,50,"Invalid value %s for field classification."),Pd=0}var ue=ac.aggregations;var Ee=new oc.a;if(ue)for(const bd of ue)switch(bd.toLowerCase()){case "sum":Ee.add(0);break;case "count":Ee.add(1);break;case "average":Ee.add(2);break;case "min":Ee.add(3);break;case "max":Ee.add(4);break;case "distinctcount":Ee.add(5);break;case "stddev":Ee.add(6);
break;case "variance":Ee.add(7);break;default:t.ULS.sendTraceTag(537151254,0,50,"Invalid value for aggregation type.")}ue=Ee;var Se=ac.headerReferences;Ee=new oc.a;if(Se)for(const bd of Se)Se=new Zc.Range(bd.top,bd.left,bd.top,bd.left,!1,!1),Ee.add(Se);hd.call(ic,new dc(Pd,ue,Ee))}Qb=new Qb(Ba,qa,gb,Bb,mf,Cc);Lc.add(Qb)}}return new Od(Wa,Lc,Dc.tableName,Dc.id,Dc.hasMergedcells)},Ld=Dc=>new Zc.Range(Dc.top,Dc.left,Dc.bottom,Dc.right,!1,!1);var Xd=a(1E3);class Ie{constructor(Dc,Wa){this.xNc=0;this.fB=
new Map;this.yyd=!1;this.tableIntelligenceManager=Dc;this.Ti=Wa;G.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&(this.cgc=new Xd.a("WebServiceCall","TableIntelligenceQueryManagerE2ELatency"),this.cgc.start(),this.vJc=!0);this.tableIntelligenceManager.w3a("Valid",this.vgj.bind(this));this.tableIntelligenceManager.w3a("Invalid",this.baj.bind(this));G.EwaSettings.isChangeGateEnabled("OfficeVSO:7408706_QueryManagerCoauthVersionChecking")&&this.Ti.NUg(this.i5i.bind(this))}fQa(Dc,
Wa,Qb){if(!this.fB)return t.ULS.sendTraceTag(521025344,306,10,"Recognized table is null"),[];let Lc=Wa;G.EwaSettings.isChangeGateEnabled("OfficeVSO:7408706_QueryManagerCoauthVersionChecking")&&void 0!==Qb&&this.xNc>Qb&&(t.ULS.sendTraceTag(509681793,306,50,`getRecognizedTables: maxRevisions: ${Qb}, versionChanges: ${this.xNc}`),Lc=Wa^4);return this.fB.has(Dc.sheetId)?(Wa=this.fB.get(Dc.sheetId).filter(Ba=>Ba.table.wD.range.hf(Dc.range)&&(Lc&Ba.fMb)==Ba.fMb),t.ULS.sendTraceTag(509681792,306,50,`getRecognizedTables: foundRecords: ${Wa.length}`),
Wa):[]}vgj(Dc,Wa){if(this.fB){if(!this.yyd){G.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&this.vJc&&(this.cgc.stop(),t.ULS.sendTraceTag(509089223,0,15,"Elapsed time since annotation invalidation: {0}",this.cgc.Te),this.vJc=!1);for(const Qb of this.fB){const [Lc,Ba]=Qb;Ba.every(qa=>4===qa.fMb)?this.fB.delete(Lc):this.fB.set(Lc,Ba.filter(qa=>4!==qa.fMb))}this.yyd=!0}Dc=Wa.EQb;this.fB.has(Dc.wD.sheetId)||this.fB.set(Dc.wD.sheetId,[]);this.fB.get(Dc.wD.sheetId).push({table:Dc,
fMb:2});this.xNc=0}else t.ULS.sendTraceTag(521025315,306,10,"Recognized table is null")}baj(Dc,Wa){this.yyd=!1;G.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&!this.vJc&&(this.cgc.start(),this.vJc=!0);Dc=Wa.EQb;if(!this.fB)t.ULS.sendTraceTag(521025314,306,10,"Recognized table is null");else if(this.fB.has(Dc.wD.sheetId))for(const Qb of this.fB.get(Dc.wD.sheetId))Qb.table.id===Wa.EQb.id&&(Qb.fMb=4)}i5i(){this.xNc++}}Object(d.a)(Ie,"TableIntelligenceQueryManager",null,[359]);class We{}
Object(d.a)(We,"RecognizedTableLog",null,[]);class jf{}Object(d.a)(jf,"Interpretation",null,[]);class tc{constructor(Dc){this.fB=new Map;this.V8b=void 0;this.dvb=new Set;this.pNb=void 0;this.tableIntelligenceManager=Dc}nCg(){this.pNb?t.ULS.shipAssertTag(522303246,306,!1,"LogXlimRecognizedTables should not be called twice."):(this.pNb=this.oNb.bind(this),this.tableIntelligenceManager.w3a("Valid",this.pNb))}GTi(Dc){Dc=this.sanitize(Dc);t.ULS.sendTraceTag(521233111,306,15,`${JSON.stringify(Dc)}`)}oNb(Dc,
Wa){Dc=Wa.EQb;G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.dvb&&this.fB?(this.dvb.has(Dc.id)||(this.KXg(Dc),this.dvb.add(Dc.id)),this.V8b||(this.V8b=window.setTimeout(this.O$.bind(this),2E3))):t.ULS.sendTraceTag(522303245,306,15,`AnnotationId set or recognized table store is null. annotationIdSet = ${!!this.dvb}, recognizedTableStore = ${!!this.fB}`))}O$(){for(const Dc of this.fB){const [,Wa]=Dc;t.ULS.sendTraceTag(521233110,306,15,JSON.stringify(Wa))}window.clearTimeout(this.V8b);
this.dvb=this.V8b=void 0;this.fB.clear();this.fB=void 0;this.tableIntelligenceManager.Tzj(this.pNb);this.pNb=void 0}KXg(Dc){const Wa=Dc.wD.sheetId;this.fB.has(Wa)||this.fB.set(Wa,[]);this.fB.get(Wa).push(this.sanitize(Dc))}sanitize(Dc){const Wa=[];for(const Qb of Dc.interpretations){let Lc=0,Ba=0;for(const qa of Qb.fields)1===qa.classification?Lc++:2===qa.classification&&Ba++;Wa.push({confidence:Qb.confidence,headerRowCount:Qb.headerRowCount,headerColumnCount:Qb.headerColumnCount,orientation:Qb.orientation,
measureCount:Ba,dimensionCount:Lc})}return{interpretations:Wa,range:{top:Dc.wD.range.top,bottom:Dc.wD.range.bottom,left:Dc.wD.range.left,right:Dc.wD.range.right},isTable:!!Dc.tableName,annotationId:Dc.id}}}Object(d.a)(tc,"RecognizedTableLogger",null,[]);class Qc extends Ce.a{constructor(Dc,Wa){super();this.eqc=this.xtf=!1;this.instantaneousSupportInformationManager=null;this.NTd=void 0;this.XDf=!1;this.RRh=(Qb,Lc)=>{var Ba;if(1===Lc.operationType){const gb=Lc.annotation;if(gb){t.ULS.sendTraceTag(537151251,
306,50,`TableIntelligenceManager::ExcelRangeMetadataHandler called for requestID = ${gb.requestId}`);Qb=wd(gb);G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(null===(Ba=this.NTd)||void 0===Ba?void 0:Ba.GTi(Qb));var qa=null;(()=>{let Bb=this.L4d.kf(gb.requestId);({value:qa}=Bb);return Bb})().returnValue?(this.L4d.remove(gb.requestId),qa(Qb)):t.ULS.sendTraceTag(537151250,306,10,`TableIntelligenceManager::ExcelRangeMetadataHandler Callback not found for requestId = ${gb.requestId}`)}else t.ULS.sendTraceTag(537151252,
306,10,"TableIntelligenceManager::ExcelRangeMetadataHandler excelRangeMetadata is null.")}};this.oUg=(Qb,Lc)=>{this.R_f("RecognizedTableUpdate",Lc)};this.Ti=Dc;this.$=Wa;this.L4d=new te.a;this.$.ga.Qa(20,this);G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.NTd=new tc(this));this.Ti.register(this.Ti.j2().E4("TableIntelligence").C4(()=>{}).build())}joa(){this.Tkb||(this.Tkb=new Ie(this,this.Ti));return this.Tkb}Zai(Dc,Wa){if(G.EwaSettings.isChangeGateEnabled("OfficeVSO:6648526_LimitCellsInSignal")&&
1E4<Dc.range.Uw)return t.ULS.sendTraceTag(520501002,306,15,`Signal with range size of ${Dc.range.Uw} exceeds limit of ${1E4}`),4;this.KTg();if(this.wIi(Dc.range))return this.Dei(Dc,Wa);t.ULS.sendTraceTag(537151253,306,15,"Range is not completely contained within the viewport");return 2}a0g(Dc){this.LTg();this.addHandler("RecognizedTableUpdate",Dc);this.Spf()}BCj(Dc){this.removeHandler("RecognizedTableUpdate",Dc)}ded(Dc){return(Wa,Qb)=>{this.R_f(this.sId(Dc),Qb)}}w3a(Dc,Wa){var Qb,Lc;G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThreshold",
!1)&&(null===(Lc=null===(Qb=this.$)||void 0===Qb?void 0:Qb.va)||void 0===Lc?0:Lc.count)&&this.$.va.count>G.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThresholdValue",100)?t.ULS.sendTraceTag(520720838,306,15,`TableIntelligenceManager::addRecognizedTableAnnotationCallback Exceeded max sheet count threshold. SheetCount ${this.$.va.count}`):(this.eqc||(this.Ti.Cha("TableIntelligence",{iu:!0,annotationType:Oc.getTypeName(),JQ:this.ded("New"),UGa:this.ded("Valid"),
Uoc:this.ded("Invalid")}),this.eqc=!0),this.OWg(Dc,Wa),this.Spf())}Tzj(Dc){this.removeHandler(this.sId("Valid"),Dc)}OWg(Dc,Wa){this.addHandler(this.sId(Dc),Wa)}Kwj(){G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligence",!1)&&this.Ti.Cha("TableIntelligence",{annotationType:Oc.getTypeName(),iu:!0,JQ:this.oUg})}Jwj(){this.Ti.Cha("TableIntelligence",{annotationType:Ad.getTypeName(),iu:!1,JQ:this.RRh})}LTg(){var Dc,Wa;G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThreshold",
!1)&&(null===(Wa=null===(Dc=this.$)||void 0===Dc?void 0:Dc.va)||void 0===Wa?0:Wa.count)&&this.$.va.count>G.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThresholdValue",100)?t.ULS.sendTraceTag(520720837,306,15,`TableIntelligenceManager::addRecognizedTableAnnotationCallback Exceeded max sheet count threshold. SheetCount ${this.$.va.count}`):this.eqc||(this.Kwj(),this.eqc=!0)}KTg(){this.xtf||(this.xtf=!0,this.Jwj())}R_f(Dc,Wa){1===Wa.operationType&&((Wa=Wa.annotation)?
(Wa=wd(Wa),this.raiseEvent(Dc,new Xb(Wa))):t.ULS.sendTraceTag(523772681,306,10,"TableIntelligenceManager::processAndRaiseExcelRecognizedTableAnnotationReceivedEvent ExcelRecognizedTable is null."))}sId(Dc){return`${"RecognizedTableUpdate"}_${Dc}`}Dei(Dc,Wa){t.ULS.sendTraceTag(537151248,306,15,"On-Demand Metadata Triggered");const Qb=Dc.range,Lc=Tc.h(this.$).Kk("TableIntelligence",Qb,1),Ba=[],qa=[];let gb=0;const Bb=G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",
!1);for(this.instantaneousSupportInformationManager||this.$.ga.qd(268,ic=>{this.instantaneousSupportInformationManager=ic});Lc.$$mn();){const ic=Lc.$$cu();if(!ic)continue;if(0===ic.Cl.type&&Ob.a.ns(ic.Cl.value))continue;ic.UK&&ic.range&&qa.push(Object(r.a)(new le.a,{worksheetId:Dc.sheetId,left:ic.range.left-1,top:ic.range.top-1,right:ic.range.right-1,bottom:ic.range.bottom-1}));const Cc=ic.range.top-1,hd=ic.range.left-1;let Pd=null,ue=null;({category:ue}=this.instantaneousSupportInformationManager.zta(ic.cell.Ei,
!0));ic.text!=ic.Cl.value&&(Pd=ic.text,Bb&&gb++);Ba.push(Object.assign(new Wc,{row:Cc,column:hd,value:ic.Cl.value,type:ic.Cl.type,displayText:Pd,Urk:ue}))}Bb&&t.ULS.sendTraceTag(526260166,306,50,`TableIntelligenceManager::getRangeDataFromGrid requests non-null displayText: ${gb}, number of values: ${Ba.length}, range size: ${Qb.height} rows by ${Qb.width} columns`);if(0<Ba.length)return this.$sh(Ba,Dc,qa,Wa),qa.length?5:0;t.ULS.sendTraceTag(537151247,306,15,"All cells in range were empty");return 3}$sh(Dc,
Wa,Qb,Lc){var Ba=Wa.range;Ba=Object(r.a)(new le.a,{top:Ba.top,left:Ba.left,bottom:Ba.bottom,right:Ba.right,worksheetId:Wa.sheetId});Wa=Bd.a.create().toString();Dc=Object(r.a)(new fe,{cells:Dc,range:Ba,mergeCellAddresses:Qb,requestId:Wa});this.Ti.Kkb(Dc);this.L4d.add(Wa,Lc)}wIi(Dc){const Wa=Tc.h(this.$);if(G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)){const Qb=Wa.Ona();t.ULS.sendTraceTag(520501001,306,50,`viewportWidth: ${Qb.width}, viewportHeight: ${Qb.height}`)}return Wa.ya.xU(4,
this.$.na)&&!!Wa.Hd(Dc.topLeft)&&!!Wa.Hd(Dc.bottomLeft)&&!!Wa.Hd(Dc.topRight)&&!!Wa.Hd(Dc.bottomRight)}Spf(){var Dc;!this.XDf&&G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.XDf=!0,null===(Dc=this.NTd)||void 0===Dc?void 0:Dc.nCg())}}Object(d.a)(Qc,"TableIntelligenceManager",Ce.a,[5,346]);class xd extends f.a{constructor(Dc){super();this.$=Dc;this.je()}create(){S.TaskExtensions.za(Object(qb.d)(n.a.resolve(z.i,{Ja:1})),Dc=>{if(Dc=Dc.result){let Wa=this.$.ga.Da(20);
Wa||(Wa=new Qc(Dc,this.$),this.$.ga.Qa(20,Wa));this.Ld(Wa)}else t.ULS.sendTraceTag(537151246,306,10,"AugmentationLoopManager instance null. Can not create TableIntelligenceManager instance. Creating null service event."),this.Ld(null)},this.$.ka,3)}static la(Dc){Dc.ga.Qa(404,new xd(Dc))}}Object(d.a)(xd,"TableIntelligenceManagerFactory",f.a,[]);class Gd{constructor(Dc,Wa){this.yEe=!1;this.tableIntelligenceManager=Dc;G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableGridHighlights",
!1)&&void ab.GetServiceTaskFactory.cQa(Wa.ga,510,511,1);this.tableIntelligenceManager.w3a("Valid",()=>{this.yEe||(t.ULS.sendTraceTag(526979921,0,15,"Received annotation with interpretations"),this.yEe=!0)})}}Object(d.a)(Gd,"TableIntelligenceDarkActivationManager",null,[332]);class pe extends f.a{constructor(Dc){super();this.$=Dc;this.je()}static la(Dc){Dc.ga.Qa(481,new pe(Dc))}create(){const Dc=ab.GetServiceTaskFactory.ud(this.$.ga,20,404,1);S.TaskExtensions.za(Dc,()=>{const Wa=Dc.result,Qb=Object(Eb.a)(this.$.ga,
480,()=>new Gd(Wa,this.$));this.Ld(Qb)},this.$.ka,3)}}Object(d.a)(pe,"TableIntelligenceDarkActivationManagerFactory",f.a,[]);(()=>{hc.a.Ga(Dc=>{G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateServices1",!1)||Vc.la(Dc)});hc.a.Ga(Dc=>{G.EwaSettings.isChangeGateEnabled("OfficeVSO:8072598_MigrateSmallServices")||B.la(Dc)});hc.a.Ga(Dc=>{G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateLineageDiscoverabilityCallout",!1)||Ea.la(Dc)})})();(()=>{hc.a.Ga(Dc=>{G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2OptimizeWorkbookManager",
!1)||Hc.la(Dc)})})();(()=>{hc.a.Ga(Dc=>{xd.la(Dc);pe.la(Dc)})})();String(h);String(b);String(k);String(c);window.___1689695406711_closurehack=h;window.___1689695406711_closurehack=b;window.___1689695406711_closurehack=k;window.___1689695406711_closurehack=c}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.pid.js.map/aed3c30ea7114c5bdec9eecef0246526/EwaTS.pid.js.map