'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[19],{1337:function(w,C,a){a.r(C);var b={};a.r(b);a.d(b,"SheetTabBarControl",function(){return Yc});var c={};a.r(c);a.d(c,"OAuthManagerWrapper",function(){return Ve});var h={};a.r(h);var k={};a.r(k);a.d(k,"IndexedDB",function(){return Af});var d=a(0),f=a(14),u=a(900),r=a(989),t=a(5),v=a(103),x=a(429),m=a(261),l=a(42),n=a(64),z=a(41),y=a(32),B=a(113),G=a(84),E=a(174);class J{get name(){return"Common.App.OAuth.OAuthPackage"}Xj(eb){eb.register(222,
"Common.App.OAuth.IOAuthManager").Ee().Le(()=>new u.OAuthManager)}init(){const eb=G.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.jek(eb);this.iek(eb)}iek(eb){if(t.AFrameworkApplication.da&&!t.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CAETokenTestEnabled",!1)){var bb=t.AFrameworkApplication.da.Sa("FileSource");if(t.AFrameworkApplication.da.pa("IsO365ConsumerHost")||t.AFrameworkApplication.da.pa("IsO365CommercialHost")||"WopiTest"===bb){var Rb=x.OAuthManagerSettings.jNa;
if(Rb&&Rb.IsEnabled){var Q=Rb.Application,Ia=x.OAuthManagerSettings.authority;if(void 0!==Q&&null!==Q&&Q.length&&void 0!==Ia&&null!==Ia&&Ia.length){var ub=r.a[eb.mJ],Yb=y.a.Bda,Ca=eb.cw(),tb=z.a.Of();eb.$C("CAETest",Q).then($b=>{const cd=Math.floor(z.a.Of()-tb);ub=r.a[eb.mJ];Yb=y.a.Bda;Ca=eb.cw();f.ULS.sendTraceTag(508950355,3E3,50,'OAuthManager attempted to get a CAE test token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
cd,$b.IsSuccess,ub,$b.ErrorCode,bb,Yb,Ca);if($b.IsSuccess){$b="Bearer "+$b.Token;t.AFrameworkApplication.tf.Omb=$b;var sd=Rb.Endpoint;if(sd){var re=z.a.Of();$b={["Authorization"]:$b};sd=n.a.um(sd,"ReturnRawToken","1");sd=n.a.um(sd,"EnforceCAE","1");t.AFrameworkApplication.tf.Pwa(sd,1,null,$b,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(De=>{var Ye=Math.floor(z.a.Of()-re),$e=null;De.qj?De="Canceled":De.Kh?De="Faulted":($e=De.result,De=$e.succeeded?"Completed":"Failed");Ye={["TaskResult"]:De,
["BrowserTokenDurationMS"]:cd,["BrowserValidationDurationMS"]:Ye};$e&&(Ye.HttpStatus=$e.qh.data.httpStatus,$e.succeeded&&($e=l.a($e.qh.data.Tf),Ye.ServerValidationDurationMS=$e.ElapsedMilliseconds,Ye.ServerValidationResult=$e.ValidatedToken,Ye.KMSI=$e.KMSI,Ye.Scopes=$e.Scopes,Ye.TokenExpirationS=Math.floor(parseInt($e.Expiration)-(new Date).getTime()/1E3)));f.ULS.sendTraceTag(508950354,3E3,"Completed"===De?50:15,B.a.toJSON(Ye))})}}else f.ULS.sendTraceTag(508950353,3E3,15,"ValidateAccess Failed: ErrorCode: {0}, ErrorMessage: {1}",
$b.ErrorCode,$b.ErrorMessage)}).catch($b=>{const cd=Math.floor(z.a.Of()-tb);f.ULS.sendTraceTag(508950352,3E3,15,"UNEXPECTED CATCH: {0}, duration: {1}",$b.toString(),cd)})}}}}}jek(eb){const bb=t.AFrameworkApplication.da.Sa("FileSource");if(t.AFrameworkApplication.da.pa("IsO365ConsumerHost")||t.AFrameworkApplication.da.pa("IsO365CommercialHost")||"WopiTest"===bb){var Rb=x.OAuthManagerSettings.jNa;if(Rb&&Rb.IsEnabled){var Q=Rb.Application,Ia=x.OAuthManagerSettings.authority;if(void 0!==Q&&null!==Q&&
Q.length&&void 0!==Ia&&null!==Ia&&Ia.length){var ub=r.a[eb.mJ],Yb=y.a.Bda,Ca=eb.cw();try{var tb=new Map;void 0!==tb&&null!==tb?(tb.set("SupportStatus",ub),tb.set("Browser",Yb),tb.set("AuthStrategy",Ca)):tb=null}catch(cd){tb=null}v.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",tb);var $b=z.a.Of();eb.$C("Core",Q).then(cd=>{const sd=Math.floor(z.a.Of()-$b);ub=r.a[eb.mJ];Yb=y.a.Bda;Ca=eb.cw();f.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
sd,cd.IsSuccess,ub,cd.ErrorCode,bb,Yb,Ca);tb&&(tb.set("SupportStatus",ub),tb.set("Browser",Yb),tb.set("AuthStrategy",Ca));var re=Object.assign(new E.a,{durationMs:sd,extendedProperties:tb});if(cd.IsSuccess){if(v.Health.instance.recordKpiSuccess("WacCorePFT",re),cd="Bearer "+cd.Token,t.AFrameworkApplication.tf.Omb=cd,re=Rb.Endpoint){var De=z.a.Of();t.AFrameworkApplication.tf.Pwa(re,1,null,{["Authorization"]:cd},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(Ye=>{var $e=Math.floor(z.a.Of()-
De),tf=null;Ye.qj?Ye="Canceled":Ye.Kh?Ye="Faulted":(tf=Ye.result,Ye=tf.succeeded?"Completed":"Failed");$e={["TaskResult"]:Ye,["BrowserTokenDurationMS"]:sd,["BrowserValidationDurationMS"]:$e};tf&&($e.HttpStatus=tf.qh.data.httpStatus,tf.succeeded&&(tf=l.a(tf.qh.data.Tf),$e.ServerValidationDurationMS=tf.ElapsedMilliseconds,$e.ServerValidationResult=tf.ValidatedToken,$e.KMSI=tf.KMSI,$e.Scopes=tf.Scopes,$e.TokenExpirationS=Math.floor(parseInt(tf.Expiration)-(new Date).getTime()/1E3)));f.ULS.sendTraceTag(520632322,
3E3,"Completed"===Ye?50:15,B.a.toJSON($e))})}}else v.Health.instance.recordKpiFailure("WacCorePFT",cd.ErrorCode,!1,!1,re)}).catch(cd=>{var sd=Math.floor(z.a.Of()-$b);sd=Object.assign(new E.a,{durationMs:sd,extendedProperties:tb});v.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+cd.toString(),!1,!1,sd)})}}}}dispose(){}static main(){m.a.instance.Tk(new J)}}Object(d.a)(J,"OAuthPackage",null,[2,3]);var I=a(521),R=a(10),X=a(233),H=a(38),M=a(1),O=a(300),L=a(224);class S{}S.L2e="ewa-svg-icon";
Object(d.a)(S,"CssClassNames",null,[]);var T=a(12),V=a(326),la=a(137),Z=a(15);class da{constructor(eb,bb){this.Zd=null;this.Lh=()=>{this.CBf();this.$.ea.xo(this.Lh)};this.$=eb;this.Xog={};this.S6d={};this.Zd=bb;(bb=this.Ydf("excelInitialAppSprite"))?(this.eBe(bb),this.$.ea.nh?this.CBf():eb.ea.Fl(this.Lh),this.$.ga.Qa(388,this)):f.ULS.sendTraceTag(537151263,0,15,"window[excelInitialAppSprite].icons returned null.")}dispose(){this.S6d=null;this.$.ea.xo(this.Lh)}tQa(eb,bb,Rb,Q){Rb=void 0===Rb?null:Rb;
Q=void 0===Q?null:Q;let Ia;(Ia=this.S6d[eb])||(this.S6d[eb]=Ia=this.Jjj(this.Xog[eb]));if(!Ia)return f.ULS.shipAssertTag(537151262,0,!1,`SvgIconProvider.GetSvgElement: id ${eb} was not found in loaded SVG sprites.`),null;const ub=Ia.cloneNode(!0);if(!ub.style){const Yb=V.b(Ia),Ca=V.b(ub),tb={};tb.iconId=eb;tb.isOriginalNodeStyleNull=void 0===Ia.style||null===Ia.style;tb.isOriginalNodeCurrentStyleNull=void 0===Ia.currentStyle||null===Ia.currentStyle;tb.isClonedNodeCurrentStyleNull=void 0===ub.currentStyle||
null===ub.currentStyle;tb.originalNode=Yb.substring(0,Yb.indexOf(">")+1);tb.clonedNode=Ca.substring(0,Ca.indexOf(">")+1);f.ULS.sendTraceTag(537151261,0,10,`SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: ${JSON.stringify(tb)}`)}ub.setAttribute("style",`height: ${bb}px; width: ${bb}px;`);Q&&(eb=document.createElement("title"),this.Zd?this.Zd.Tj(eb,Q):eb.textContent=Q,ub.insertBefore(eb,ub.childNodes[0]));if(Rb)for(const Yb of Rb)Sys.UI.DomElement.addCssClass(ub,Yb);return ub}Bfa(eb,
bb,Rb,Q,Ia,ub,Yb,Ca){Ia=void 0===Ia?0:Ia;ub=void 0===ub?0:ub;Yb=void 0===Yb?null:Yb;Ca=void 0===Ca?null:Ca;Ia&&ub||(ub=T.DOMElementExtensions.getBoundingClientRect(Q),Ia=ub.height,ub=ub.width);if(Yb=this.tQa(eb,bb,Yb,Ca))Q.appendChild(Yb),(Q=T.DOMElementExtensions.i2(Yb,"style",null))?Yb.setAttribute("style",Q+` margin: ${(Ia-bb)/2}px ${(ub-Rb)/2}px;`):f.ULS.sendTraceTag(537151260,0,10,`SvgIconProvider.InsertAndCenterSvgElement: svgElement's GetAttribte("styl") returned null. Icon ID: ${eb}`);return Yb}CBf(){void la.a.resolve(Z.S,
{Ja:0}).then(eb=>eb("excel-uiSlice20-sprite")).then(()=>this.sXg())}sXg(){const eb=this.Ydf("excelUiSlice20Sprite");eb?this.eBe(eb):f.ULS.sendTraceTag(537151259,0,15,"window[excelUiSlice20Sprite].icons returned null.")}eBe(eb){for(const bb of eb)bb.type===L.a.Q6d&&(this.Xog[bb.id]=bb)}Jjj(eb){if(!eb)return null;const bb=eb.viewBox;eb=eb.children;const Rb=document.createElementNS(O.a.T6d,L.a.Q6d);Sys.UI.DomElement.addCssClass(Rb,S.L2e);Rb.setAttribute("focusable","false");Rb.setAttribute("viewBox",
bb);this.tXg(Rb,eb);return Rb}tXg(eb,bb){for(const Q of bb){const Ia=document.createElementNS(O.a.T6d,Q.type);for(let ub in Q){bb=ub;var Rb=Q[ub];"className"===bb?Ia.setAttribute("class",Rb):Ia.setAttribute(bb,Rb)}eb.appendChild(Ia)}}Ydf(eb){return(eb=window[eb])?eb.icons:null}}Object(d.a)(da,"SvgIconProvider",null,[354,5]);var ba=a(91);class na extends X.a{constructor(eb){super();this.$=eb;this.je()}create(){const eb=[this.jQi()];let bb=null;M.EwaSettings.isChangeGateEnabled("OfficeVSO:7982896_TooltipSanitizationImprovementWithSvgIcons")||
(bb=Object(ba.d)(la.a.resolve(Z.Ab,{Ja:0})),eb.push(bb));H.TaskExtensions.za(H.TaskExtensions.Wf(eb,this.$.ka),()=>{window.excelInitialAppSprite?this.Ld(this.$.ga.Da(388)||new da(this.$,null===bb||void 0===bb?void 0:bb.result)):f.ULS.sendTraceTag(537151258,0,50,"window.[excelInitialAppSprite] returned null.")},this.ka,3)}jQi(){return Object(ba.d)(la.a.resolve(Z.S,{Ja:this.Ta}).then(eb=>Io(function*(){return eb("excel-app-intl")})))}static la(eb){eb.ga.Qa(387,new na(eb))}}Object(d.a)(na,"SvgIconProviderFactory",
X.a,[]);var Y=a(734),Ga=a(53),ma=a(199),fa=a(62);class Xa{constructor(eb){this.$Ch=eb}Pe(){return!1}executeCommand(eb,bb){eb=bb.command;bb=null;switch(eb){case 1243860697:this.$Ch.jak();break;default:bb=ma.a(eb)}return bb||fa.Task.Wa(!0)}Be(eb,bb){return 1243860697===bb.command}Ue(){return!1}}Object(d.a)(Xa,"SheetDropdownMenuCommandHandler",null,[203]);class Ua extends Y.a{constructor(eb){super(eb)}Uf(){void la.a.resolve(Z.tc,{Ja:this.Ta}).then(()=>{H.TaskExtensions.za(M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSheetTabBar",
!1)?Object(ba.d)(la.a.resolve(Z.Lc,{Ja:this.Ta})):Ga.GetServiceTaskFactory.ud(this.$.ga,32,33,this.Ta),eb=>{this.Lf([new Xa(eb.result.aWj)])},this.$.ka)})}static la(eb){Y.a.qg(392,new Ua(eb))}}Object(d.a)(Ua,"SheetDropdownMenuCommandHandlerFactory",Y.a,[]);var ka=a(6),nb=a(86),Ea=a(182),sb=a(13),Oa=a(96),La=a(47),ia=a(250),Sa=a(172),Za=a(117),Ab=a(355),pb=a(138),Tb=a(16),ob=a(40);class va{constructor(){this.MXe=new ob.a(!0);this.xSc=0}get dhd(){return this.xSc}get navigationButtonsDisabled(){return!!(this.dhd&
1)}get operationButtonsDisabled(){return!!(this.dhd&2)}e4g(eb,bb){this.MXe.add(eb,bb);this.RV()}RV(){this.xSc=0;ob.a.forEach(this.MXe.dv,eb=>{this.xSc=this.dhd|eb.value})}}Object(d.a)(va,"SheetTabBarDisabledStateManager",null,[]);var Pa=a(249),jb=a(35);class Ob{}Ob.jNh="ewa-stb-uir";Ob.WMh="ewa-stb-navarea";Ob.XMh="ewa-stb-navarea-dimensions";Ob.ZMh="ewa-stb-navbutton";Ob.AX="cui-disabled";Ob.YMh="ewa-stb-navareaextra";Ob.Ama="cui-img-container";Ob.QMh="ewa-stb-contentarea";Ob.D2e="ewa-stb-left-scrollable";
Ob.I2e="ewa-stb-right-scrollable";Ob.hNh="ewa-stb-tabarea";Ob.gNh="ewa-stb-sheettabmoveindicator";Ob.K2e="ewa-stb-tabs";Ob.O7j="tab-active";Ob.W7j="tab-inactive";Ob.V7j="tab-hover";Ob.iNh="ewa-stb-tabs-ghost";Ob.Q7j="tab-anchor-text";Ob.dark="dark";Ob.light="light";Ob.P7j="tab-active-text";Ob.T7j="tab-content-container";Ob.Y7j="tab-text";Ob.aNh="ewa-stb-nsv-inactive-svg";Ob.$Mh="ewa-stb-nsv-active-svg";Ob.JLh="ewa_nsv_margin";Ob.RMh="ewa-stb-disable-scrollbar";Ob.lPi="leave-size-fixed-on-tab-hover-old";
Ob.kPi="leave-size-fixed-on-tab-hover";Ob.E2e="ewa-stb-locked-sheet-svg-16px";Ob.SMh="ewa-stb-dropdown-menu-button";Ob.KHh="ewa-active-sheet-menu-item";Object(d.a)(Ob,"CssClassNames",null,[]);var kb=a(774),ra=a(18),rb=a(275),Kb=a(94),Sb=a(200),cb=a(30),cc=a(260),Ub=a(48),wb=a(299),vc=a(56),Lb=a(75),Ja=a(281),Hb=a(11),gc=a(107),ec=a(360),Ta=a(19),ib=a(187),bc=a(384),jc=a(380),sc=a(46),Fa=a(234),Ha=a(92);class Na extends Pa.a{constructor(eb,bb,Rb){Rb=void 0===Rb?!1:Rb;super(eb);this.Pgb=this.yxa=null;
this.$=bb;this.b0=Rb}get disabled(){return this.b0}dispose(){this.Pgb=this.yxa=this.$=null;super.dispose()}JV(eb){this.b0=eb;this.domElement.setAttribute(ka.a.GLa,eb.toString());T.DOMElementExtensions.toggleCssClass(this.domElement,kb.a.AX,eb)}}Object(d.a)(Na,"SheetBarButton",Pa.a,[]);var W=a(747);class U extends Na{constructor(eb,bb,Rb,Q){Q=void 0===Q?!1:Q;super(document.createElement("a"),bb,Q);this.mf=Ia=>{this.disabled||this.$.Me(-1935155518,Ia.Gd,30,null);return!0};this.FNd=Ia=>{Ia="mouseover"===
Ia.type||"focus"===Ia.type;const ub=bc.a(this.$)?this.Pgb:this.yxa;Hb.HelperMethods.brg(ub,U.Qla,U.Qla+ka.a.Cwd,Ia&&!Ta.h(this.$).inRangePicker)};this.kk=()=>{this.JV(!0)};this.wj=()=>{Ta.h(this.$).cellTextEditBox.ld||this.JV(!1)};this.yxa=Rb.od(this.domElement,Tb.a.instance.ia(509),0,U.Qla,Tb.a.instance.ia(510),W.a.kcd,Q);eb.appendChild(this.domElement);this.Xe.la("contextmenu",Ia=>{Lb.g(Ia)});Fa.a.instance.ta(sb.a.click,this.domElement,this.mf);this.Jpa=Za.KeyInputManager.instance.zx(this.domElement,
this.mf,Ha.a.xk,Ha.a.l5);Ta.h(this.$).cellTextEditBox.Gp(this.kk);Ta.h(this.$).cellTextEditBox.Uwa(this.wj)}dispose(){Fa.a.instance.Aa(sb.a.click,this.domElement,this.mf);Za.KeyInputManager.instance.uB(this.domElement,this.Jpa);Ta.h(this.$)&&Ta.h(this.$).cellTextEditBox&&(Ta.h(this.$).cellTextEditBox.zp(this.kk),Ta.h(this.$).cellTextEditBox.cib(this.wj));super.dispose()}JV(eb){const bb=U.Oig(this.$);super.JV(eb||bb)}static Oig(eb){return!eb.isEditMode||!eb.va.count}}U.Qla=ra.a.gkd;Object(d.a)(U,"InsertSheetButton",
Na,[]);class za extends Na{constructor(eb,bb,Rb){super(document.createElement("a"),bb);this.mf=Q=>{this.$.Me(-684145703,Q.Gd,0,null);return!0};this.FNd=Q=>{Hb.HelperMethods.brg(this.ZJe,za.Qla,za.Qla+ka.a.Cwd,("mouseover"===Q.type||"focus"===Q.type)&&!Ta.h(this.$).inRangePicker)};this.$=bb;this.ZJe=Rb.od(this.domElement,Tb.a.instance.ia(511),0,za.Qla,Tb.a.instance.ia(512),W.a.kcd);eb.appendChild(this.domElement);this.Xe.la("contextmenu",Q=>{Lb.g(Q)});this.Xe.la("mouseover",this.FNd);this.Xe.la("mouseout",
this.FNd);Fa.a.instance.ta(sb.a.click,this.domElement,this.mf);this.Jpa=Za.KeyInputManager.instance.zx(this.domElement,this.mf,Ha.a.xk,Ha.a.l5)}dispose(){Fa.a.instance.Aa(sb.a.click,this.domElement,this.mf);Za.KeyInputManager.instance.uB(this.domElement,this.Jpa);this.ZJe=null;super.dispose()}}za.Qla=ra.a.gkd;Object(d.a)(za,"InsertTemplateButton",Na,[]);class ua{constructor(eb,bb){this.sheetName=null;this.newSheetIndex=0;this.sheetName=eb;this.newSheetIndex=bb}getSheetName(){return this.sheetName}}
Object(d.a)(ua,"MacroRecorderSheetReorderedPayload",null,[135]);var $a=a(93);class Va extends Pa.a{constructor(eb,bb){super(document.createElement("div"));this.YU=()=>{f.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");this.Y7f(!1,"OnSheetsChanged")};this.M6i=()=>{this.il()};this.L6i=()=>{this.Jk()};this.$=eb;this.w8j=bb;this.dY=!1;this.iXb=0}dispose(){this.Jk();super.dispose()}jak(){this.Y7f(!0,"TogglerSheetDropdownMenu")}Y7f(eb,bb){f.ULS.sendTraceTag(537153795,0,50,`SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: ${bb}, toggle: ${eb}, toggleStateId: ${this.iXb}`);
eb&&(this.iXb+=1);const Rb=this.$.Sd.Ze("UserAction",`SheetDropdownMenu.RenderSheetMenuInternal: caller: ${bb}, toggle: ${eb}, toggleStateId: ${this.iXb}, sheetCount: ${this.$.va.count}`);eb=this.Tth();appChrome.renderSheetDropdownMenu(this.domElement,this.w8j,eb,this.iXb,this.M6i,this.L6i,()=>{Rb.stop()},bc.a(this.$))}Tth(){const eb=this.$.va,bb=[];for(let Q=0;Q<eb.count;Q++){var Rb=Object(pb.a)(gc.a,eb.getItem(Q));0===Rb.TC&&(Rb=this.Sth(Rb),bb.push(Rb))}return bb}Sth(eb){const bb={};bb.key=eb.name;
bb.text=eb.name;bb.onClick=this.Uth(eb);eb.active&&(bb.className=bc.a(this.$)?"ewa-active-sheet-menu-item-present-mode":Ob.KHh);return bb}Uth(eb){return()=>{const bb=new $a.a(-1876836819,0,this.$.se,30,null);this.$.Ha.Ad(bb,{[ka.a.w2d]:eb.name})}}il(){if(!this.dY){const eb=this.$.va;eb.Ri(this.YU);eb.k5c(this.YU);eb.R0(this.YU);eb.cla(this.YU);eb.WKa(this.YU);eb.kCe(this.YU);eb.H3a(this.YU);this.dY=!0}}Jk(){if(this.dY){const eb=this.$.va;eb.uj(this.YU);eb.DVd(this.YU);eb.uaa(this.YU);eb.Lra(this.YU);
eb.AWa(this.YU);eb.a7f(this.YU);eb.BRb(this.YU);this.dY=!1}}}Object(d.a)(Va,"SheetDropdownMenu",Pa.a,[315,5]);var hb=a(333);class qb extends Na{constructor(eb,bb,Rb){super(document.createElement("a"),eb,!0);this.Lh=()=>{this.JV(!1);this.$.ea.xo(this.Lh)};this.mf=Q=>{this.crg(Q.Gd);return!0};this.onKeyDown=Q=>13===Q.Ba.keyCode||32===Q.Ba.keyCode?(this.crg(Q.Gd),!0):!1;this.yxa=bb.od(this.domElement,Tb.a.instance.ia(513),0,ra.a.PMh,Tb.a.instance.ia(513),W.a.lmi,this.disabled);this.domElement.classList.add(Ob.SMh);
Rb.appendChild(this.domElement);this.lFh();this.Fwj()}dispose(){this.tfk();super.dispose()}JV(eb){super.JV(eb||!this.$.ea.iBa)}lFh(){const eb=this.$.ea;eb.nh?this.JV(!1):eb.Fl(this.Lh)}crg(eb){this.disabled||(f.ULS.sendTraceTag(537153793,0,50,`SheetDropdownMenuAnchor.ToggleMenu: inputMethod: ${hb.a[eb]}`),this.$.Ha.Ad(new $a.a(1243860697,eb,this.$.se,30,null)))}Fwj(){Fa.a.instance.ta(sb.a.click,this.domElement,this.mf);Za.KeyInputManager.instance.ta(sb.a.me,this.domElement,this.onKeyDown)}tfk(){Fa.a.instance.Aa(sb.a.click,
this.domElement,this.mf);Za.KeyInputManager.instance.Aa(sb.a.me,this.domElement,this.onKeyDown)}}Object(d.a)(qb,"SheetDropdownMenuAnchor",Na,[]);var Nb=a(59),yb=a(189),ja=a(140),Ka=a(198),Pb=a(142),rc=a(60),$c=a(219),Dd=a(210),Jd=a(184),Kd=a(143);class ce{constructor(eb){this.sheet=eb;this.altText=Tb.a.instance.ia(1994)}FN(){return this.sheet.active}VAd(){return this.sheet.isLockPausedInSession}$sa(){return this.sheet.Oj?W.a.y0f:W.a.efk}R6d(){return 16}Gxa(){return null}Hxa(){return Ob.E2e}r8d(){return null}vu(){return null}U6c(){return!0}}
Object(d.a)(ce,"LockPausedSheetIconDataSource",null,[345]);class ge{constructor(eb){this.sheet=eb;this.altText=Tb.a.instance.ia(1993)}FN(){return this.sheet.active}VAd(){return this.sheet.Oj}$sa(){return W.a.y0f}R6d(){return 16}Gxa(){return null}Hxa(){return Ob.E2e}r8d(){return null}vu(){return null}U6c(){return!0}}Object(d.a)(ge,"LockedSheetIconDataSource",null,[345]);class uc{constructor(eb,bb,Rb){this.sheet=eb;this.altText=Tb.a.instance.ia(1908);this.zak=bb;this.NZj=Rb}FN(){return this.sheet.active}VAd(){return this.sheet.ng.$D}Gxa(){return this.FN()?
Ob.$Mh:Ob.aNh}$sa(){return!this.FN()&&this.NZj()?W.a.lWj:W.a.kWj}R6d(){return 14}Hxa(){return Ob.JLh}r8d(){return this.sheet.ng.Mtb}vu(){return this.zak}U6c(){return!1}}Object(d.a)(uc,"NamedSeetViewSheetIconDataSource",null,[345]);var dd=a(179),Rd=a(148);class Yd{constructor(eb,bb){this.DXc=this.K5=this.VFa=this.Ar=null;this.awf=!1;this.q1c=this.$sa=this.Hxa=this.Gxa=null;this.WQ=()=>{this.dataSource.FN()&&H.TaskExtensions.za(this.WBf,()=>{dialogControls.renderToolTip(this.dataSource.vu(),"SheetIconTooltip",
this.dataSource.r8d(),this.EV,10,!1,!1,1)},this.$.ka,3)};this.VQ=()=>{this.dataSource.FN()&&this.clearToolTip()};this.$=eb;this.dataSource=bb}get Xe(){return this.K5||(this.K5=Rd.a.instance.kg(this.EV))}get WBf(){if(this.DXc)return this.DXc;const eb=new dd.a;this.$.DK(bb=>{H.TaskExtensions.za(bb.GBf(),()=>{eb.setResult(!0)},this.$.ka,3)});return this.DXc=eb.task}get EV(){return this.q1c}Jvg(){if(this.EV&&(this.Ar||this.VFa)){var eb=this.dataSource.$sa();this.$sa!==eb&&(this.VFa&&this.VFa.parentNode.removeChild(this.VFa),
this.hqf(),this.$sa=eb);eb=this.dataSource.Gxa();this.Gxa!==eb&&(this.XDj(this.VFa,this.Gxa,eb),this.Gxa=eb);eb=this.dataSource.Hxa();this.Hxa!==eb&&(this.WDj(this.EV,this.Hxa,eb),this.Hxa=eb);this.dataSource.vu()&&!this.dataSource.FN()&&this.clearToolTip()}}k0j(eb,bb,Rb){this.Dxi(eb,bb,Rb);T.DOMElementExtensions.setVisible(this.EV,this.dataSource.VAd())}clearToolTip(){H.TaskExtensions.za(this.WBf,()=>{dialogControls.clearToolTip(this.dataSource.vu())},this.$.ka,3)}Dxi(eb,bb,Rb){this.EV&&this.awf!==
eb&&(this.EV.parentNode.removeChild(this.EV),this.Hxa=this.Gxa=this.$sa=this.q1c=null,this.dataSource.vu()&&(this.Xe.detach("mouseover",!0),this.Xe.detach("mouseout",!0)));this.EV||(this.q1c=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.EV,kb.a.Ama),Sys.UI.DomElement.addCssClass(this.EV,ra.a.hK),eb===this.dataSource.U6c()?bb.appendChild(this.EV):bb.insertBefore(this.EV,Rb),this.hqf(),this.dataSource.vu()&&(this.Xe.la("mouseover",this.WQ,!0),this.Xe.la("mouseout",this.VQ,!0)),this.awf=
eb)}XDj(eb,bb,Rb){eb&&(Sys.UI.DomElement.removeCssClass(eb,bb),Sys.UI.DomElement.addCssClass(eb,Rb))}WDj(eb,bb,Rb){bb&&Sys.UI.DomElement.removeCssClass(eb,bb);Rb&&Sys.UI.DomElement.addCssClass(eb,Rb)}dispose(){Oa.a.Ma(this.K5)}hqf(){const eb=this.$.ga.Da(388);eb?(this.VFa=eb.tQa(this.dataSource.$sa(),this.dataSource.R6d()))?this.EV.appendChild(this.VFa):f.ULS.shipAssertTag(537153763,0,!1,`Sheeticon.InsertCurrentSvgIcon: Svg with id ${this.dataSource.$sa()} was not found.`):f.ULS.shipAssertTag(537153792,
0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")}}Object(d.a)(Yd,"SheetIcon",null,[5]);var Md=a(366),ad=a(101),Mb=a(185);class Aa extends ad.a{constructor(eb,bb){super(eb.domElement);this.onKeyDown=Rb=>{121===Rb.keyCode&&Rb.shiftKey&&!this.Dsa.disabled&&(this.showContextMenu(new Sys.UI.Point(0,0),1,this.Dsa.anchor),Lb.g(Rb))};this.Mga=Rb=>{if(!this.$.isEditMode||this.Dsa.disabled)return!0;this.rename(!1,Rb.Gd);return!0};this.uo=Rb=>this.Dsa.disabled?!0:this.showContextMenu(Rb.clientPoint,
Rb.Gd,Rb.$d);this.kve=eb;this.$=bb;Fa.a.instance.ta(sb.a.ym,eb.domElement,this.Mga);Md.a.instance.ta(eb.domElement,this.uo);this.Xe.la("keydown",this.onKeyDown)}get Dsa(){return this.kve}dispose(){this.Dsa&&(Fa.a.instance.Aa(sb.a.ym,this.Dsa.domElement,this.Mga),Md.a.instance.Aa(this.Dsa.domElement,this.uo),this.kve=null);this.$=null;super.dispose()}showContextMenu(eb,bb,Rb){this.Dsa.activate(bb,cb.a.Kxf());bb=new $a.a(-1075099431,bb,this.$.se,30,null);let Q;return!Mb.a(Q=this.$.Ha.Ad(bb,{[ka.a.kig]:eb,
[Aa.bWj]:this.Dsa.sheet,[ka.a.lig]:Rb}))&&(6!==Q.status||Q.result)}rename(eb,bb){this.$.Me(817296323,bb,eb?19:0,null)}}Aa.bWj="Sheet";Object(d.a)(Aa,"SheetOpsSheetClickHelper",ad.a,[]);var Bc=a(58);class Vc extends Na{constructor(eb,bb,Rb,Q,Ia){super(document.createElement("li"),eb);this.ZVj=100;this.$Vj=500;this.hPe=this.gPe=0;this.$Ue=.5;this.dY=this.u2d=!1;this.color=this.iSc=this.QM=this.BMb=this.VR=null;this.zrc=this.Xuf=!1;this.Tdc="#BEBBB8";this.FPc=null;this.onKeyDown=ub=>13!==ub.Ba.keyCode||
this.disabled?!1:(this.activateSheet(1),!0);this.tC=ub=>32!==ub.Ba.charCode||this.disabled?!1:(this.activateSheet(1),!0);this.WQ=()=>{this.disabled||this.XI.yU||this.vsa(!0,void 0,"OnMouseOver")};this.VQ=()=>{this.disabled||this.vsa(!1,void 0,"OnMouseOut")};this.$Nb=()=>{this.XI.yU||(this.U4j(),Object(Bc.c)(this.sheet.sheetProcessedData)||Ta.h(this.$).Rra(this.sheet.sheetName,"sheetTabButton.onMouseEnter"));return!1};this.H$=()=>{this.Q_e(!1);return!1};this.mf=ub=>{if(this.disabled)return!0;const Yb=
Ta.h(this.$);this.sheet.active||3!==ub.Gd||!cb.a.ISa()&&!this.LJb||Yb.ld||Yb.fl||Yb.Vzb();this.activateSheet(ub.Gd);return 3!==ub.Gd};this.onPointerDown=ub=>{if(this.disabled)return!0;this.Q_e(!0);Ta.h(this.$).inRangePicker&&f.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");var Yb=3===ub.Gd;if(2===ub.Gd||Yb&&this.KBa)this.vsa(!0,!Yb,"OnPointerDown"),Yb=fa.Task.delay(Yb?this.$Vj:this.ZVj).Vr(()=>!0),this.dJb&&
(this.zrc=!0,this.XI.MDc=H.TaskExtensions.za(Yb,()=>{this.zrc&&this.XI.Kej(this,ub)},this.ka,11));return!1};this.Yi=ub=>{if(this.disabled||!this.dJb&&M.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;this.zrc=!1;this.vsa(2===ub.Gd,void 0,"OnPointerUp");this.XI.MDc&&(H.TaskExtensions.za(this.XI.MDc,()=>{this.XI.Jej()},this.ka,11),this.XI.MDc=null);return!1};this.aR=()=>{this.zrc=!1;this.u2d||this.vsa(!1,void 0,"OnTouchMove");return!1};this.aOe=new Aa(this,
eb);this.LJb=cb.a.LJb();this.gPe=18;this.hPe=20;this.$=eb;this.U4b=Q;this.XI=Ia;this.dJb=Ia.dEe();this.buh();this.foh();this.Bwd=eb.Sd.fi("UserAction",this.name);this.UAd=!1;T.DOMElementExtensions.Gz(this.domElement,ka.a.Ut,null,null);this.domElement.appendChild(this.anchor);this.anchor.appendChild(this.QM);this.Csa=new Ka.a;eb=new ge(this.sheet);this.Csa.add(new Yd(this.$,eb));this.$.ea.NUb&&(eb=new ce(this.sheet),this.Csa.add(new Yd(this.$,eb)));eb=new uc(this.sheet,this.XI.nHc,()=>this.color?Vc.G3d(this.color):
!1);this.BMb=new Yd(this.$,eb);this.Csa.add(this.BMb);this.KBa=this.XI.KBa;this.smb();this.cyj();this.fJe=new wb.a(this.domElement,1);bb.insertBefore(this.domElement,Rb);bc.a(this.$)&&this.Awg(!0)}get uxh(){return this.iSc||(this.iSc=Dd.a.tr("#F5F5F5"))}get name(){return this.VR.innerText}set name(eb){this.VR&&(this.VR.innerText=eb,this.aMc(),this.Bwg())}get sheet(){return this.U4b}get anchor(){return this.FPc}get tabIndex(){return this.anchor.tabIndex}set tabIndex(eb){this.anchor.tabIndex=eb}G8h(){return T.DOMElementExtensions.zi(this.anchor)?
this.anchor:null}dispose(){if(this.dY){ia.a.instance.Aa(sb.a.pointerDown,this.domElement,this.onPointerDown);Za.KeyInputManager.instance.Aa(sb.a.me,this.domElement,this.onKeyDown);Za.KeyInputManager.instance.Aa(sb.a.Sq,this.domElement,this.tC);Fa.a.instance.Aa(sb.a.click,this.domElement,this.mf);ia.a.instance.Aa(sb.a.FZ,this.domElement,this.$Nb);ia.a.instance.Aa(sb.a.oE,this.domElement,this.H$);if(this.dJb||M.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))ia.a.instance.Aa(sb.a.Gi,
this.domElement,this.Yi),this.KBa&&(Sa.a.instance.Aa(sb.a.sg,this.domElement,this.Yi),Sa.a.instance.Aa(sb.a.Ki,this.domElement,this.aR));this.dY=!1;this.Tdc="#BEBBB8"}Oa.a.Fe([this.aOe,this.fJe]);this.VR=this.QM=this.FPc=this.XI=this.fJe=this.aOe=null;if(this.Csa){for(let eb of this.Csa)eb.dispose();this.Csa=null}this.color=this.U4b=null;super.dispose()}JV(eb){eb&&this.vsa(!1,!1);super.JV(eb)}Pkg(eb){rc.a.Bi.wU&&(this.TXe(),void la.a.resolve(Z.Pb,{Ja:1}).then(bb=>{yb.UISurfaces.BK().then(Rb=>{bb.hSj(Rb);
bb.show(eb);return null},Rb=>{f.ULS.sendTraceTag(537153688,0,15,`SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: ${Rb}`);return null})}))}SWg(){if(this.sheet.active&&this.$.Qr){var eb=this.$.Qr,bb=Ta.h(this.$),Rb=bb.uk;if(this.sheet.ng.$D){if(!this.BMb){const Q=new uc(this.sheet,this.XI.nHc,()=>this.color?Vc.G3d(this.color):!1);this.BMb=new Yd(this.$,Q);this.Csa.add(this.BMb)}Rb&&bb.fmb(1);eb.classList.add(ra.a.S4e);eb=Vc.eff(ka.a.oIf);bb=Vc.eff(ka.a.YJd);"true"===
eb&&"true"===bb?this.$.ea.t3d&&this.$.ea.hVb&&(this.sheet.ng.AQ?(eb=1,ja.a.py(ka.a.YJd,"false",ja.a.pZ),this.$.ea.hVb=!1):eb=0,ja.a.py(ka.a.oIf,"false",ja.a.pZ),this.$.ea.t3d=!1,this.Pkg(eb)):this.sheet.ng.AQ&&"true"===bb&&this.$.ea.hVb&&(ja.a.py(ka.a.YJd,"false",ja.a.pZ),this.$.ea.hVb=!1,this.Pkg(2))}else this.TXe(),Rb&&bb.fmb(0),eb.classList.remove(ra.a.S4e)}}TXe(){const eb=la.a.zg(Z.Pb);eb&&eb.dismiss()}smb(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.Ybb()?Ob.O7j:
Ob.W7j;M.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.VR.parentNode.classList.add(Ob.kPi):this.VR.parentNode.classList.add(Ob.lPi);this.Bwg();this.l0j();this.Hwg();this.aMc();this.SWg()}Iej(){this.u2d=!0;this.vsa(!0,!0,"OnSheetReorderStarted")}Hej(){this.u2d=!1;this.vsa(!1,void 0,"OnSheetReorderEnded")}activate(eb,bb){eb=void 0===eb?0:eb;bb=void 0===bb?!1:bb;this.Pac()||(this.sheet.activate({scenario:"switchSheet"}),bb&&Ta.h(this.$).focus(),eb={["InputMethod"]:hb.a[eb],
["AppMode"]:this.$.se,["Location"]:"canvas"},Kd.b(this.$).nf(Pb.a.WVj,eb))}Awg(eb){this.Tdc=eb?"#797775":"#BEBBB8";this.$Ue=eb?-.5:.5;this.iSc=eb?Dd.a.tr("#3B3A39"):Dd.a.tr("#F5F5F5");this.Hwg()}MOj(eb){this.dJb=eb}AMd(eb){eb.Acd();this.sMe(eb)}sMe(eb){eb.r6a();this.sheet.activate({scenario:"switchSheet"})}RTg(eb){eb=new $a.a(-1876836819,eb,this.$.se,30,null);return this.$.Ha.Ad(eb,{[ka.a.w2d]:this.sheet.name})}Bwg(){this.VR.parentNode.setAttribute("sheet-title",this.VR.innerText)}aMc(){const eb=
this.i2h();this.anchor.setAttribute(ka.a.Pw,eb);this.anchor.setAttribute(ka.a.uda,this.sheet.active.toString())}i2h(){const eb=this.sheet.ng.$D,bb=this.sheet.ng.Mtb,Rb=this.sheet.Oj,Q=this.sheet.isLockPausedInSession;return eb&&Rb?String.format(Tb.a.instance.xd(20),this.name,bb):eb&&Q?String.format(Tb.a.instance.xd(22),this.name,bb):eb?String.format(Tb.a.instance.xd(19),this.name,bb):Rb?String.format(Tb.a.instance.xd(18),this.name):Q?String.format(Tb.a.instance.xd(21),this.name):this.name}activateSheet(eb){eb=
void 0===eb?0:eb;if(cb.a.Kxf()){if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&this.Pac())return fa.Task.Wa(!1);Jd.a.current.yR="ActivateSheet";Ta.h(this.$).Hmb.navigationStart("SwitchSheet");this.sheet.activate({scenario:"switchSheet"});return fa.Task.Wa(!0)}return this.RTg(eb)}Hwg(){const eb=this.sheet.tabColor;this.color=eb?Dd.a.tr(eb):this.uxh;this.Xuf=Vc.G3d(this.color);this.vsa(!1,void 0,"UpdateTabColor")}vsa(eb,bb,Rb){bb=void 0===bb?!1:bb;Rb=void 0===
Rb?null:Rb;if(this.sheet){Rb=this.sheet.active;var Q=this.Ybb(),Ia=!!this.sheet.tabColor,ub=Dd.a.WL(Rb||Q?$c.a.white:this.color);this.QM.style.background="";Rb||Q?(Ia&&(M.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.VQa?this.VTj():this.UTj()),this.QM.style.height=this.gPe.toString()+"px"):(this.QM.style.filter="",this.QM.style.backgroundColor=ub,this.QM.style.height=this.hPe.toString()+"px");this.VR.className=Rb?Ob.P7j:Q?Ob.dark:this.Xuf?Ob.light:
Ob.dark;for(let Yb of this.Csa)Yb.Jvg();eb&&!Ia&&(this.QM.style.backgroundColor="#E1DFDD");T.DOMElementExtensions.toggleCssClass(this.domElement,Ob.V7j,eb);bb?(Ia||(this.QM.style.backgroundColor=this.Tdc),this.domElement.style.backgroundColor=this.Tdc):(Ia||(this.QM.style.backgroundColor=""),this.domElement.style.backgroundColor="");this.VR.style.fontWeight=Rb||Q?"600":""}else f.ULS.sendTraceTag(537153687,0,15,`SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: ${Rb}`)}UTj(){const eb=
this.QM.style,bb=Dd.a.WL(Vc.$eh(this.color,this.$Ue));eb.background=bb}VTj(){this.QM.style.background="transparent"}foh(){this.FPc=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className=Ob.Q7j;T.DOMElementExtensions.Gz(this.anchor,ka.a.Bvb,null,null);this.tabIndex=-1}buh(){this.QM=document.createElement("span");this.QM.className=Ob.T7j;this.VR=document.createElement("span");this.VR.className=Ob.Y7j;this.VR.dir=this.sheet.rtlName?"rtl":"ltr";this.QM.appendChild(this.VR)}l0j(){const eb=
this.$.mP;for(let bb of this.Csa)bb.k0j(eb,this.QM,this.VR)}Ybb(){return Ta.h(this.$).Ybb(this.sheet)}U4j(){this.Bwd.start();this.UAd=!0}Q_e(eb){this.UAd&&(this.Bwd.stop(),f.ULS.sendTraceTag(537153686,0,50,l.c({["Sheet index"]:this.sheet.index,["Active Sheet"]:this.sheet.active,["Hovering time"]:this.Bwd.Te,["Has been clicked"]:eb})),this.UAd=!1)}cyj(){ia.a.instance.ta(sb.a.pointerDown,this.domElement,this.onPointerDown);Za.KeyInputManager.instance.ta(sb.a.me,this.domElement,this.onKeyDown);Za.KeyInputManager.instance.ta(sb.a.Sq,
this.domElement,this.tC);this.Xe.la("mouseover",this.WQ);this.Xe.la("mouseout",this.VQ);ia.a.instance.ta(sb.a.FZ,this.domElement,this.$Nb);ia.a.instance.ta(sb.a.oE,this.domElement,this.H$);if(this.dJb||M.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))ia.a.instance.ta(sb.a.Gi,this.domElement,this.Yi),this.KBa&&(Sa.a.instance.ta(sb.a.sg,this.domElement,this.Yi),Sa.a.instance.ta(sb.a.Ki,this.domElement,this.aR));Fa.a.instance.ta(sb.a.click,this.domElement,this.mf);
this.dY=!0}Pac(){const eb=this.$.ga.Da(65);return eb&&eb.cpa()?(eb.bFc(),this.sMe(eb),!0):!1}static eff(eb){let bb=ja.a.get(eb);bb||(ja.a.py(eb,"true",ja.a.pZ),bb=ja.a.get(eb));return bb}static $eh(eb,bb){if(1<bb||-1>bb)return eb;let Rb=eb.r,Q=eb.g;eb=eb.b;0<bb?(Rb=Rb*(1-bb)+255*bb,Q=Q*(1-bb)+255*bb,eb=eb*(1-bb)+255*bb):(Rb*=1+bb,Q*=1+bb,eb*=1+bb);return $c.a.yCb(Math.round(Rb),Math.round(Q),Math.round(eb))}static G3d(eb){return 128>=(222*eb.r+707*eb.g+71*eb.b)/1E3}}Object(d.a)(Vc,"SheetTabButton",
Na,[]);class hc extends Na{constructor(eb,bb,Rb){super(document.createElement("a"),bb);this.Qla=ra.a.gkd;Rb.od(this.domElement,Tb.a.instance.ia(713),0,this.Qla,Tb.a.instance.ia(713),W.a.kcd,!0);eb.appendChild(this.domElement);this.Xe.la("contextmenu",Q=>{Lb.g(Q)})}}Object(d.a)(hc,"WorkbookProtectionButton",Na,[]);var xc=a(55),ab=a(49),Wb=a(65);class Yc extends Pa.a{constructor(eb,bb,Rb){Rb=void 0===Rb?null:Rb;super(bb);this.sheetTabActivatePreviousHidden=Tb.a.instance.ia(722);this.sheetTabActivateNextHidden=
Tb.a.instance.ia(724);this.svgIconProvider=null;this.Ej=[];this.GQ=Array(6);this.fKd=Array(6);this.cYa=this.MGb=this.kU=this.Tjb=this.C2d=this.B2d=this.Uo=null;this.isRtl=!1;this.fZ=this.XB=0;this.Mfc=this.LDc=!1;this.vAc=this.csa=0;this.QP=this.V7=this.xea=this.Vfc=null;this.nmc=this.UF=0;this.yWb=null;this.gKb=-1;this.I7=null;this.yzc=0;this.hJc=-1;this.ura=0;this.Fya=new va;this.rWc=!1;this.MDc=this.Vjb=this.Ujb=this.ive=this.z3=null;this.cne=!1;this.hve=null;this.rG=(Q,Ia)=>{this.nUf(Ia.item)};
this.FDa=(Q,Ia)=>{Q=this.$.va.na.index;for(let ub=0,Yb=this.Ej.length;ub<Yb;ub++){const Ca=this.zY(ub);if(Ca.name===Ia.oldName){Ca.name=Ia.newName;this.h4();ub===Q&&this.Wha(6);break}}};this.rUf=(Q,Ia)=>{(Q=this.MBb(Ia.item))&&Q.smb()};this.sUf=(Q,Ia)=>{Ia.visible?(this.YXa(!1),this.oUf(Ia.item)):this.nUf(Ia.item)};this.Dqa=Q=>{this.yU?(this.I7=Q,this.TXb()):(this.I7&&(this.vAc+=this.I7.clientPoint.x-Q.clientPoint.x),this.I7=Q,Math.abs(this.vAc)>=this.SCh&&this.TXb());return!0};this.aR=Q=>{Q.Ba.preventDefault();
return!1};this.Hcg=Q=>{this.Ecg(Q,!0)};this.Gcg=Q=>{this.Ecg(Q,!1)};this.Eqa=Q=>{if(this.yU){this.Mfc=this.fEi(Q);let Ia;Q=(Ia=this.zY(this.UF+1))?Ia.sheet:null;this.reorderSheets(Q,this.UF+1===this.z2d,!0)}this.XX();return!0};this.om=(Q,Ia)=>{Ia.rE&&this.mae(Ia.rE);this.vGc(!1);this.h4();Ia.na&&(this.mae(Ia.na),this.Wha(6),this.ea.Yqa())};this.MKf=(Q,Ia)=>{this.SMc(Ia.item)};this.NKf=(Q,Ia)=>{this.SMc(Ia.item)};this.OKf=(Q,Ia)=>{this.SMc(Ia.item)};this.tUa=(Q,Ia)=>{this.SMc(Ia.item)};this.kDa=()=>
{this.Zad()};this.wf=()=>{this.isVisible=!this.ea.isNamedObjectViewMode;this.Zad();this.afd();if(Wb.d(this.$)||Wb.e(this.$))ab.PageLoadTrackingInfo.instance.Aaa(ka.a.$aa,["sheetTabBar"]),ab.PageLoadTrackingInfo.instance.zaa(ka.a.$aa,["sheetTabBar"]);this.Fed();this.h4();this.YXa(!0);this.Wha(6)};this.Rk=()=>{this.isVisible&&(this.h4(),this.Wha(6))};this.Nh=()=>{Object(Ab.a)(U,this.kU)===Kb.m(this.$.Fg)&&this.Fed();for(const Q of this.Ej)Q.MOj(!Kb.m(this.$.Fg))};this.qUf=(Q,Ia)=>{this.NDj(Ia.item,
Ia.isUserOperation)};this.sOb=(Q,Ia)=>{this.oUf(Ia.item)};this.onKeyDown=Q=>{switch(Q.keyCode){case 9:var Ia=this.domElement.querySelectorAll(T.DOMElementExtensions.Uu);const ub=T.DOMElementExtensions.vr(Ia);Ia=T.DOMElementExtensions.aQ(Ia);T.DOMElementExtensions.oFa(Q,ub,Ia);break;case 39:case 37:T.DOMElementExtensions.Efg(Q,this.domElement.querySelectorAll(T.DOMElementExtensions.Uu),39===Q.keyCode?!this.isRtl:this.isRtl)}f.ULS.sendTraceTag(537153691,0,50,`SheetTabBarControl.OnKeyDown: Press on ${Q.keyCode}`)};
this.onScroll=()=>{this.Uo.scrollLeft!==this.csa&&this.A9j()};this.YQ=Q=>{if(Q.ctrlKey||Q.p7)return!1;this.Uo.scrollLeft+=Math.floor(30*Q.Xta);if(this.yU){const Ia=this.xdf("OnMouseWheel");Ia&&this.U6d(0<Q.Xta,Ia.x+Ia.width/2)}return!0};this.ZQ=(Q,Ia)=>{if(this.Fya)this.plf("PartialInteractivity",Ia.JS?3:0);else{this.XX(!1);this.$0d(Ia.JS);for(const ub of this.cIe)ub&&ub.JV(Ia.JS);for(const ub of this.Ej)ub&&ub.JV(Ia.JS)}};this.yNb=(Q,Ia)=>{Q=0;Ia.fze&&(Q=2|(Ia.cWj?1:0));this.plf("ComponentRangePicker",
Q)};this.$=eb;this.ea=this.$.ea;this.bgc=!M.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");this.pxf=!this.$.rx;this.cne=!y.a.fC;this.TFi=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InSheetTemplates",!1);this.r_i=this.$.xa.SheetTabNavigateButtonLongKeyPressPeriodMS;this.q_i=this.$.xa.SheetTabNavigateButtonIntervalPeriodMS;this.SCh=this.$.xa.SheetTabDragStartPixelThreshold;this.iVa=this.jVa=-1;this.bdd=!1;this.svgIconProvider=Rb;
this.nF=new wb.a(this.domElement,3);this.domElement.classList.add(Ob.jNh);this.Qrh();this.uph();this.Rrh();document.getElementById(ka.a.lfa)||this.Tsh();this.vGc(!0);this.wf(null,null);eb=this.$.va;eb.Ri(this.om);eb.k5c(this.kDa);eb.R0(this.rG);eb.cla(this.sOb);eb.WKa(this.FDa);eb.kCe(this.qUf);eb.H3a(this.sUf);eb.SZg(this.rUf);eb.y5c(this.MKf);eb.hCe(this.NKf);eb.iCe(this.OKf);eb.jCe(this.tUa);this.$.Zm(this.wf);this.$.IB(this.Rk);rb.a(this.$).vk(this);M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSheetTabBar",
!1)||this.$.ga.Qa(32,this);M.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&this.$.ea.Mw(this.Nh);this.pHc=this.vg.kg(this.domElement);this.pHc.la("keydown",this.onKeyDown);sc.a(this.$).Br()&&this.ZQ(null,new jc.a(!0));sc.a(this.$).ti.ela(this.ZQ);Ta.h(this.$).IBe(this.yNb);this.pHc.la("mousedown",Q=>{Q.preventDefault()});Ea.a.instance.ta(sb.a.kG,this.domElement,this.YQ);this.A2d=this.vg.kg(this.Uo);this.A2d.la("scroll",this.onScroll);this.A9j=Ja.b(()=>{this.h4()},
200,this.$.ka,Ub.a.iWj,!0);this.$.bI(ka.a.x2j);this.pxf&&(this.hve=new Va(this.$,this.cYa.domElement));ab.PageLoadTrackingInfo.instance.Mha(ka.a.$aa,["sheetTabBar"])}get Ce(){return this.domElement}get zi(){return this.isVisible}get jg(){return cc.a.y2d}get yU(){return this.rWc}get z2d(){return this.Ej.length}get nHc(){return this.ive}get KBa(){return this.cne}get navigationButtonsDisabled(){return!!this.Fya&&this.Fya.navigationButtonsDisabled}get operationButtonsDisabled(){return!!this.Fya&&this.Fya.operationButtonsDisabled}get D_i(){return this.$.mP?
[ra.a.C2e,ra.a.G2e,ra.a.H2e,ra.a.B2e,ra.a.bhc,ra.a.bhc]:[ra.a.B2e,ra.a.H2e,ra.a.G2e,ra.a.C2e,ra.a.bhc,ra.a.bhc]}get gKd(){return this.$.mP?[null,W.a.RPe,W.a.PPe]:[null,W.a.PPe,W.a.RPe]}get QZf(){return this.$.mP?[null,W.a.SPe,W.a.QPe]:[null,W.a.QPe,W.a.SPe]}get KKb(){if(this.isRtl){if(y.a.dE)return 0;if(y.a.vh)return-1*(this.Uo.scrollWidth-this.Uo.clientWidth);if(y.a.fC)return this.Uo.scrollWidth-this.Uo.clientWidth;f.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}get HSb(){if(this.isRtl){if(y.a.dE)return this.Uo.scrollWidth-
this.Uo.clientWidth;if(y.a.vh||y.a.fC)return 0;f.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.Uo.scrollWidth-this.Uo.clientWidth}get cIe(){return this.Fya?[this.kU,this.MGb]:[this.kU,this.MGb,this.cYa]}get X7j(){return this.Ej.concat(this.cYa)}get aWj(){return this.hve}od(eb,bb,Rb,Q,Ia,ub,Yb){Yb=void 0===Yb?!1:Yb;eb.removeAttribute("Href");eb.setAttribute(ka.a.Mf,ka.a.Ow);eb.className=Ob.ZMh;eb.title=bb;eb.tabIndex=0;ub?Rb=this.svgIconProvider.Bfa(ub,
12,12,eb,24,24):(bb=document.createElement("span"),bb.className=ra.a.Rhh,bb.classList.add(kb.a.Ama),bb.tabIndex=-1,eb.appendChild(bb),ub=document.createElement("img"),ub.src=vc.a.Ci(Rb),ub.className=Q,ub.alt=Ia,ub.tabIndex=-1,bb.appendChild(ub),Rb=ub);Yb&&eb.classList.add(kb.a.AX);return Rb}dispose(){if(this.$){var eb=this.$.va;eb.uj(this.om);eb.DVd(this.kDa);eb.uaa(this.rG);eb.Lra(this.sOb);eb.AWa(this.FDa);eb.a7f(this.qUf);eb.BRb(this.sUf);eb.FBj(this.rUf);eb.SVd(this.MKf);eb.Y6f(this.NKf);eb.Z6f(this.OKf);
eb.$6f(this.tUa);this.$.co(this.wf);this.$.vE(this.Rk);sc.a(this.$)&&sc.a(this.$).ti.Mra(this.ZQ);this.Fya&&Ta.h(this.$).D6f(this.yNb);Ea.a.instance.Aa(sb.a.kG,this.domElement,this.YQ)}Oa.a.Fe(this.fKd);this.fKd=null;if(this.GQ)for(eb=0;eb<this.GQ.length;eb++){const bb=T.DOMElementExtensions.YH(this.GQ[eb],this.domElement,!1,"a");bb&&La.a.Hra(bb)}Oa.a.Ma(this.nF);Oa.a.Ma(this.pHc);Oa.a.Ma(this.A2d);this.A2d=this.pHc=this.MGb=this.kU=this.nF=null;this.$&&this.XX(!1);this.xea=null;this.t0d(null,"Dispose");
this.yWb=this.QP=this.Vfc=null;this.Zad();this.Tjb=this.C2d=this.B2d=this.Uo=this.GQ=this.$=this.ea=null;super.dispose()}Pi(eb,bb){if(!bb){f.ULS.shipAssertTag(537153760,0,0<this.Ej.length,"There is no sheet tab button.");if(!this.Ej.length)return!1;eb=null;for(const Rb of this.Ej)if(eb=Rb.G8h())break;if(!eb)return f.ULS.shipAssertTag(537153759,0,!1,"There is no focusable tab element."),!1;T.DOMElementExtensions.setFocus(eb)}return!bb}Nj(eb){return T.DOMElementExtensions.mi(this.Ce,eb)}Ll(){}lm(){}reorderSheets(eb,
bb,Rb){if(this.z3&&this.z3!==eb){const Q=this.z3.index;this.MDj(this.z3,eb,bb);eb=eb?eb.index-1:bb?this.$.va.count-1:0;Q!==eb&&(this.LTi(Q,eb,Rb),this.WFh(this.z3.name,eb))}}vki(eb){eb=this.ona(eb);return-1!==eb&&this.XB<=eb&&eb<=this.fZ?this.Ej[eb].domElement:null}zwg(eb){for(var bb=0;bb<this.GQ.length;bb++){const Rb=this.GQ[bb];if(Rb&&this.svgIconProvider){const Q=Rb.parentNode;this.f6f(Rb);Q&&(this.GQ[bb]=this.svgIconProvider.Bfa(eb?this.QZf[bb]:this.gKd[bb],12,12,Q,24,24))}}for(bb=0;bb<this.Ej.length;bb++)this.Ej[bb].Awg(eb);
this.cYa&&this.cYa.yxa&&this.ywg(W.a.mmi,this.cYa,eb);this.kU&&this.kU.yxa&&this.ywg(W.a.Vjh,this.kU,eb)}ywg(eb,bb,Rb){bb.Pgb||(bb.Pgb=this.svgIconProvider.Bfa(eb,12,12,bb.yxa.parentNode,24,24));bb.Pgb&&(T.DOMElementExtensions.setVisible(bb.yxa,!Rb),T.DOMElementExtensions.setVisible(bb.Pgb,Rb))}Kej(eb,bb){var Rb=Ta.h(this.$);const Q=Rb.inRangePicker,Ia=Hb.HelperMethods.pt(bb);if(Rb.ld&&!Q){const ub=Rb.ks?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed";let Yb;Yb=[Object(ib.a)(Rb.cellTextEditBox.textBox.aGa)];
ib.b(this.$).sGa(Ia.rawEvent,ub,Yb);Rb.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}Rb=this.KBa&&3===bb.Gd;!(2===bb.Gd&&Ia.button===Sys.UI.MouseButton.leftButton||Rb)||Q||this.yU||sc.a(this.$).Br()||(Rb&&eb.Iej(),this.gKb=bb.clientPoint.x,this.I7=bb,this.J7g(eb))}Jej(){this.h4()}dEe(){return this.$.isEditMode&&!Kb.m(this.$.Fg)}h4(){const eb=Hb.HelperMethods.SU(()=>{this.Jhk();this.ATj();this.$0d()});f.ULS.sendTraceTag(537153757,0,50,`SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = ${eb}`)}ATj(){const eb=
this.fZ===this.Ej.length-1;T.DOMElementExtensions.toggleCssClass(this.Tjb,this.$.mP?Ob.I2e:Ob.D2e,!!this.XB);T.DOMElementExtensions.toggleCssClass(this.Tjb,this.$.mP?Ob.D2e:Ob.I2e,!eb)}$0d(eb){eb=void 0===eb?!1:eb;const bb=!this.XB,Rb=this.fZ===this.Ej.length-1;this.hgg(4,this.sheetTabActivatePreviousHidden,!bb);this.hgg(5,this.sheetTabActivateNextHidden,!Rb);this.LGc(0,bb||eb);this.LGc(1,bb||eb);this.LGc(2,Rb||eb);this.LGc(3,Rb||eb)}hgg(eb,bb,Rb){if(eb=this.GQ[eb]){T.DOMElementExtensions.setVisible(eb,
Rb);var Q=this.iff(eb);Q.title="img"===eb.nodeName?eb.alt=0<this.Ej.length&&Rb?bb:"":eb.title=0<this.Ej.length&&Rb?bb:"";Q.tabIndex=Rb?0:-1}}iff(eb){return eb.parentNode}LGc(eb,bb){if(eb=this.GQ[eb])eb=this.iff(eb),void 0!==eb&&null!==eb&&(!this.Ej.length||bb?(eb.classList.add(kb.a.AX),eb.setAttribute(ka.a.GLa,"true")):(eb.classList.remove(kb.a.AX),eb.setAttribute(ka.a.GLa,"false")))}YXa(eb){const bb=this.$.mP?this.Ej.length-1:0;let Rb=this.Ohf(this.$.mP?0:this.Ej.length-1);Rb&&(Rb.borderRightWidth=
eb?"1px":"0");this.XB!==this.fZ&&(Rb=this.Ohf(bb))&&(Rb.borderRightWidth="0")}aBe(eb,bb){this.Ej||(this.Ej=[]);-1===bb?this.Ej.push(eb):this.Ej.splice(bb,0,eb)}pdc(eb,bb){let Rb=-1,Q=null;bb||(Rb=this.Ubi(eb.index),-1!==Rb&&(Q=this.qQa(Rb)));eb=new Vc(this.$,this.Uo,Q,eb,this);this.aBe(eb,Rb);T.DOMElementExtensions.setVisible(eb.domElement,!0)}Wha(eb){const bb=Hb.HelperMethods.SU(()=>{switch(eb){case 0:this.sFc(0);break;case 1:this.sFc(this.XB-1);break;case 2:this.sFc(this.XB+1);break;case 3:this.scrollIntoView(this.Ej.length-
1);break;case 4:this.XB&&1<=this.Ej.length&&(this.Rye(this.XB-1),this.GZd());break;case 5:this.fZ!==this.Ej.length-1&&1<=this.Ej.length&&(this.Rye(this.fZ+1),this.GZd());break;case 6:this.GZd()}});this.bgc&&this.yU&&this.TXb();f.ULS.sendTraceTag(537153755,0,50,`SheetTabBarControl.ScrollSheetTabs: operation = ${eb}, duration = ${bb}`)}Rye(eb){(eb=this.zY(eb))&&eb.activate()}aWh(eb){if(0===eb.TC){const bb=this.$.va;let Rb=0;for(let Q=0,Ia=bb.count;Q<Ia;Q++){const ub=Object(pb.a)(gc.a,bb.getItem(Q));
if(ub===eb)return Rb;0===ub.TC&&Rb++}}return-1}OVh(eb){const bb=this.$.va;for(let Rb=eb.index+1,Q=bb.count;Rb<Q;Rb++)if(eb=Object(pb.a)(gc.a,bb.getItem(Rb)),0===eb.TC)return eb;return null}ona(eb){for(let bb=0;bb<this.Ej.length;bb++){const Rb=this.zY(bb);if(!Rb)f.ULS.sendTraceTag(537153754,0,15,`SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[${bb}] is null even though index is not out of bounds!`);else if(Rb.sheet===eb)return bb}return-1}MBb(eb){eb=this.ona(eb);return this.zY(eb)}LTi(eb,
bb,Rb){const Q={};Q.a=this.$.xa.UserSessionId;Q.b=Rb;Q.c=this.Mfc;Q.d=eb;Q.e=bb;Q.f=this.$.va.count;xc.b().ih(2,Q,Rb)}MDj(eb,bb,Rb){const Q=Object(pb.a)(ec.a,this.$.va);bb?(bb=bb.index,bb=eb.index<bb?bb-1:bb):bb=Rb?Q.count-1:0;Q.reorderSheet(eb,bb,!0)}aRj(eb){Ta.h(this.$).gj.Hr(eb)}J7g(eb){if(!this.LDc){const bb=this.domElement.ownerDocument.body;ia.a.instance.ta(sb.a.Fn,document.documentElement,this.Dqa);this.KBa&&(Sa.a.instance.ta(sb.a.Ki,document.documentElement,this.Dqa),Sa.a.instance.ta(sb.a.Ki,
this.domElement,this.aR));ia.a.instance.ta(sb.a.Gi,document.documentElement,this.Eqa);Sa.a.instance.ta(sb.a.sg,bb,this.Eqa);this.LDc=!0}this.z3=eb.sheet;this.Mfc=!1;this.QP=null;this.Vfc=eb;this.xea=eb.domElement;this.t0d(T.DOMElementExtensions.getBoundingClientRect(this.xea),"BeginSheetTabButtonDrag")}XX(eb){eb=void 0===eb?!0:eb;if(this.LDc){this.aRj(ka.a.BY);const bb=this.domElement.ownerDocument.body;ia.a.instance.Aa(sb.a.Fn,document.documentElement,this.Dqa);this.KBa&&(Sa.a.instance.Aa(sb.a.Ki,
document.documentElement,this.Dqa),Sa.a.instance.Aa(sb.a.Ki,this.domElement,this.aR));ia.a.instance.Aa(sb.a.Gi,document.documentElement,this.Eqa);Sa.a.instance.Aa(sb.a.sg,bb,this.Eqa);this.rWc=this.LDc=!1}this.vAc=0;this.Mfc=!1;this.z3=null;this.xea&&(this.xea.style.visibility="visible",this.xea=null);this.Vfc=null;this.t0d(null,"EndSheetTabButtonDrag");this.QP&&(this.QP.parentNode&&this.QP.parentNode.removeChild(this.QP),this.QP=null);this.hGj(eb)}hGj(eb){this.g6d(eb);this.UF=this.gKb=-1}WFh(eb,
bb){const Rb=this.$.qa,Q=Rb?Rb.ua:null;this.$.userOperationManager.enqueueOperation(new Sb.a(557,0,(Ia,ub,Yb)=>{const Ca=Q.Pa(9,null);Ca.sheetName=eb;Ca.newSheetIndex=bb;return Nb.g(Q,"ReorderSheets",Ca,Ia,ub,Yb,null,0)},64,()=>new ua(eb,bb)),null)}zY(eb){return 0<=eb&&eb<this.Ej.length?this.Ej[eb]:null}bhi(eb){return(eb=this.zY(eb))?eb.sheet:null}qQa(eb){return(eb=this.zY(eb))?eb.domElement:null}Ohf(eb){return(eb=this.qQa(eb))?eb.style:null}Ubi(eb){const bb=this.$.va;eb+=1;let Rb=-1;const Q=this.Ej?
this.Ej.length:0;for(;eb<bb.count;){const Ia=Object(pb.a)(gc.a,bb.getItem(eb));if(0===Ia.TC){for(Rb=0;Rb<Q&&this.bhi(Rb)!==Ia;Rb++);break}eb++}return-1===Rb||Rb===Q?-1:Rb}nUf(eb){var bb=this.MBb(eb);bb&&(this.yU&&(f.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),M.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.XX()),this.Uo.removeChild(bb.domElement),
bb=Array.indexOf(this.Ej,bb),this.Ej.splice(bb,1),this.h4(),(!this.isRtl&&bb===this.Ej.length||this.isRtl&&!bb)&&this.YXa(!0),this.bgc&&this.yU?eb===this.z3?(this.XX(),this.Wha(6)):this.TXb():this.Wha(6))}oUf(eb){const bb=Object(pb.a)(gc.a,eb);this.yU&&(f.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),M.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.XX());if(0===bb.TC){this.YXa(!1);var Rb=this.ona(eb);-1===Rb&&(f.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.pdc(bb,!1),Rb=this.ona(eb));this.wlf(Rb,!0)}}NDj(eb,bb){const Rb=this.MBb(eb);Rb&&(this.yU&&!bb&&(f.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),M.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.XX()),eb=this.J7j(eb,Rb),!M.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&eb&&bb&&eb.Hej())}J7j(eb,bb){var Rb=Array.indexOf(this.Ej,bb);const Q=this.aWh(Object(pb.a)(gc.a,eb));if(-1===Q||-1===Rb)return null;this.YXa(!1);({FWh:this.XB,lOi:this.fZ}=Yc.JDj(Rb,Q,this.XB,this.fZ));bb&&bb.domElement.parentNode===this.Uo&&(this.Uo.removeChild(bb.domElement),this.Ej.splice(Rb,1));bb=this.OVh(eb);Rb=this.ona(bb);bb=new Vc(this.$,this.Uo,this.qQa(Rb),Object(pb.a)(gc.a,
eb),this);this.aBe(bb,Rb);Rb=this.ona(eb);this.wlf(Rb,!1);return bb}LGh(){const eb=this.Ej?this.Ej.length:0,bb=this.XB,Rb=this.fZ;for(let Q=0;Q<eb;Q++){const Ia=this.zY(Q),ub=Q>=bb;Ia&&(Ia.tabIndex=ub&&Q<=Rb?0:-1)}}wgk(){const eb=this.Ej?this.Ej.length:0;for(let bb=0;bb<eb;bb++){const Rb=this.zY(bb);Rb&&Rb.smb()}}wlf(eb,bb){bb&&eb<=this.XB&&this.XB++;this.LGh();this.YXa(!0);this.h4();this.bgc&&this.yU&&this.TXb()}vGc(eb){const bb=this.$.mP;if(eb||this.isRtl!==bb)this.isRtl=bb,this.domElement.classList.remove(this.isRtl?
ra.a.F2e:ra.a.J2e),this.domElement.classList.add(this.isRtl?ra.a.J2e:ra.a.F2e),this.domElement.dir=this.isRtl?"rtl":"ltr",this.wgk();eb||this.YXa(!0);for(eb=0;eb<this.GQ.length;eb++)0!==eb&&3!==eb&&4!==eb&&5!==eb&&this.igg(eb)}Qrh(){const eb=this.B2d=document.createElement("div");eb.className=Ob.WMh;eb.classList.add(Ob.XMh);this.domElement.appendChild(eb);this.wTe(eb,1,717,716);this.wTe(eb,2,719,718);this.pxf&&(this.cYa=new qb(this.$,this,eb))}Rrh(){const eb=this.C2d=document.createElement("div");
eb.className=Ob.YMh;this.domElement.appendChild(eb);this.Fed()}Tsh(){const eb=document.getElementById(ka.a.XVj),bb=document.getElementById(ka.a.YVj);eb&&!bb&&f.ULS.sendTraceTag(537153746,0,50,`CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: ${eb.parentNode.id}. progressBar div has child: ${!!eb.firstChild}. ProgressBarMessage div exists: ${!!document.getElementById(ka.a.r2d)}`);const Rb=cb.a.uxf(this.$);if(Rb&&eb&&bb)this.domElement.appendChild(eb),
this.Ujb=eb.firstChild,this.Vjb=document.getElementById(ka.a.r2d),bb.style.visibility="visible";else{const Q=document.createElement("div"),Ia=document.createElement("div");Q.className=ra.a.eNh;Ia.className=ra.a.cNh;Ia.id=ka.a.q2d;Ia.style.display="none";const ub=document.createElement("div");ub.className=ra.a.fNh;const Yb=document.createElement("div");Yb.className=ra.a.dNh;const Ca=document.createElement("div");Ca.className=ra.a.bNh;Ia.appendChild(ub);Ia.appendChild(Yb);Ia.appendChild(Ca);Q.appendChild(Ia);
this.domElement.appendChild(Q);this.Ujb=Ia;this.Vjb=Yb;f.ULS.sendTraceTag(512275475,0,50,"SheetTabBarControl.createProgressBarArea: Create the progress bar in this function, because isSkeletonProgressBarEnabled = {0}, skeletonProgressBar={1}, skeletonProgressBarSeperator={2}.",Rb,eb,bb)}}igg(eb){var bb=this.GQ[eb];if(bb){const Rb=bb.parentNode;this.f6f(bb);bb=bc.a(this.$)?this.QZf[eb]:this.gKd[eb];this.GQ[eb]=this.svgIconProvider.Bfa(bb,12,12,Rb,24,24)}}f6f(eb){(null===eb||void 0===eb?0:eb.parentNode)&&
eb.parentNode.removeChild(eb)}uph(){const eb=this.Tjb=document.createElement("div");eb.className=Ob.QMh;this.domElement.appendChild(eb);this.Vth(eb)}Vth(eb){const bb=document.createElement("div");bb.className=Ob.hNh;bb.classList.add(Ob.RMh);this.$.printingEnabled||bb.classList.add(jb.a.K4e);eb.appendChild(bb);this.Uo=document.createElement("ul");T.DOMElementExtensions.Gz(this.Uo,ka.a.G7c,null,null);this.Uo.className=jb.a.K2e;bb.appendChild(this.Uo);this.Krh();this.ive=document.createElement("div");
this.nHc.id="SheetIconTooltipContainer";bb.appendChild(this.nHc)}Krh(){const eb=document.createElement("div"),bb=document.createElement("div"),Rb=vc.a.ubf(ra.a.dOh);bb.className=ra.a.Vhh;bb.appendChild(Rb);eb.appendChild(bb);eb.className=Ob.gNh;T.DOMElementExtensions.setVisible(eb,!1);this.Uo.appendChild(eb)}afd(){const eb=this.$.va;for(let bb=0,Rb=eb.count;bb<Rb;bb++){const Q=Object(pb.a)(gc.a,eb.getItem(bb));0===Q.TC&&(this.pdc(Q,!0),Q.active&&Q.activate({scenario:"createSheetTabs"}))}}Zad(){Oa.a.Fe(this.Ej);
this.Ej=[];this.fZ=this.XB=0}wTe(eb,bb,Rb,Q){const Ia=document.createElement("a");eb.appendChild(Ia);eb=this.gKd[bb];this.GQ[bb]=this.od(Ia,Tb.a.instance.ia(Q),0,this.D_i[bb],Tb.a.instance.ia(Rb),eb);if(5===bb||4===bb)T.DOMElementExtensions.YH(this.GQ[bb],Ia,!1,"span").style.marginTop="10px";this.igg(bb);Rb=this.fKd[bb]=this.vg.kg(Ia);ia.a.instance.ta(sb.a.pointerDown,Ia,Yb=>Yb.ctrlKey&&this.c6i(bb)?!0:this.zRf(bb));ia.a.instance.ta(sb.a.Gi,Ia,()=>this.ARf());Sa.a.instance.ta(sb.a.sg,Ia,()=>this.ARf());
ia.a.instance.ta(sb.a.pointerOut,Ia,()=>this.Rad());Za.KeyInputManager.instance.ta(sb.a.me,Ia,Yb=>13!==Yb.Ba.keyCode&&32!==Yb.Ba.keyCode||this.bdd?!1:(this.bdd=!0,this.zRf(bb)));Za.KeyInputManager.instance.ta(sb.a.Vf,Ia,Yb=>13===Yb.Ba.keyCode||32===Yb.Ba.keyCode?(this.bdd=!1,this.Rad()):!1);const ub=this.dEe();Q=Yb=>{"mouseup"===Yb.type&&this.yU||Lb.g(Yb);!Ia.classList.contains(kb.a.AX)&&ub&&this.pbj(Yb,bb)};Rb.la("mouseover",Q);Rb.la("mouseout",Q);Rb.la("focus",Q);Rb.la("blur",Q);ub&&Rb.la("mouseup",
Q)}fEi(eb){let bb=!1;const Rb=this.$.Eh;Rb&&(bb=z.a.tU(T.DOMElementExtensions.getBoundingClientRect(Rb),eb.clientPoint));return bb}TXb(){if(!this.QP){f.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");this.QP=this.xea.cloneNode(!0);if(!this.gbg(this.QP,this.xea,!0,"UpdateDragAndDropState"))return;this.xea.style.visibility="hidden";this.QP.classList.add(Ob.iNh);this.QP.style.borderRightWidth="";this.nmc=this.I7.clientPoint.x-this.V7.width/
2;this.QP.style.left=this.nmc+"px";this.UF=this.ona(this.z3);0>this.UF&&f.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.bgc&&(this.UF=this.ona(this.z3));var eb=T.DOMElementExtensions.getBoundingClientRect(this.Uo);const bb=eb.x;eb=eb.x+eb.width;let Rb=this.I7.clientPoint.x-this.V7.width/2;Rb=Math.min(Rb,eb-this.V7.width);Rb=Math.max(Rb,bb);this.QP.style.transform="translateX("+Math.abs(Rb-this.nmc)*(this.nmc<Rb?1:-1)+"px)";const Q=this.I7.clientPoint.x>
this.gKb;let Ia=this.I7.clientPoint.x;Rb>=eb-this.V7.width?(Ia=eb-this.V7.width/2,this.CZd()||this.ura||(f.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.yzc=this.Uo.scrollLeft,this.ura=window.requestAnimationFrame(this.Hcg))):Rb<=bb?(Ia=bb+this.V7.width/2,this.BZd()||this.ura||(f.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),
this.yzc=this.Uo.scrollLeft,this.ura=window.requestAnimationFrame(this.Gcg))):this.ura&&(f.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.g6d());this.I7.clientPoint.x!==this.gKb&&(this.U6d(Q,Ia),this.gKb=this.I7.clientPoint.x);this.rWc=!0}U6d(eb,bb){let Rb;for(;(()=>{let Q=this.TCh(bb,eb);({qac:Rb}=Q);return Q})().returnValue;)this.yWb=Rb,this.V2g(eb)}V2g(eb){if(this.yWb){var bb=(eb?1:-1)*this.V7.width;if(eb&&
!this.$.mP||!eb&&this.$.mP){var Rb=this.xea;var Q=this.UF+1;var Ia=!0}else Rb=(Q=this.zY(this.UF+1))?Q.domElement:null,Q=this.UF-1,Ia=!1;if(this.gbg(this.yWb,Rb,Ia,"AnimateSheetSwap")){f.ULS.sendTraceTag(537153738,0,50,`SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index ${this.UF} and other sheet-index ${Q}. amount of sheets in the bar: ${this.z2d} isMovingRight: ${eb}`);0<=this.UF&&this.UF<this.Ej.length&&0<=Q&&Q<this.Ej.length?(eb=this.Ej[Q],this.Ej[Q]=this.Ej[this.UF],this.Ej[this.UF]=
eb):(f.ULS.sendTraceTag(537153737,0,15,`SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: ${this.Ej.length}, ghostIndex: ${this.UF}, swappedSheetIndex: ${Q}`),this.XX());this.UF=Q;var ub=this.yWb;ub.style.transform="translateX("+bb+"px)";window.requestAnimationFrame(()=>{ub.style.transform="translateX(0px)"})}}}gbg(eb,bb,Rb,Q){const Ia=ub=>ub?`Node ID: ${ub.id} , Node class: ${ub.className}, Node name: ${ub.nodeName},`:null;try{return this.Uo.insertBefore(eb,bb),!0}catch(ub){return eb=
this.MBb(this.z3),f.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",eb?eb!==this.Vfc?"Changed":"NoChange":"Removed",Q,Ia(bb),Ia(bb.parentNode),Ia(this.Uo),Rb,this.UF,this.z2d,ub),this.XX(),
!1}}TCh(eb,bb){var Rb=this.$.mP===bb?this.zY(this.UF-1):this.zY(this.UF+1);if(!Rb)return{returnValue:!1,qac:null};Rb=Rb.domElement;const Q=T.DOMElementExtensions.getBoundingClientRect(Rb);return this.V7?bb?{returnValue:eb+this.V7.width/2>=Q.x+.5*Q.width,qac:Rb}:{returnValue:eb-this.V7.width/2<=Q.x+.5*Q.width,qac:Rb}:(f.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),this.XX(),
{returnValue:!1,qac:Rb})}Ecg(eb,bb){let Rb;Rb=bb?this.Hcg:this.Gcg;if(-1===this.hJc)this.hJc=eb,this.ura=window.requestAnimationFrame(Rb);else{eb=Math.floor((eb-this.hJc)/1E3*300);var Q=this.HSb>this.KKb?1:-1;this.scrollLeft(Math.abs(this.Uo.scrollLeft-(bb?this.yzc+eb*Q:this.yzc-eb*Q))*(bb?-1:1));if(eb=this.xdf("ScrollStep"))this.U6d(bb,eb.x+eb.width/2),bb&&!this.CZd()||!bb&&!this.BZd()?this.ura=window.requestAnimationFrame(Rb):(f.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.g6d())}}CZd(){const eb=this.HSb>this.KKb;return eb&&this.csa>=this.HSb||!eb&&this.csa<=this.HSb}BZd(){const eb=this.HSb>this.KKb;return eb&&this.csa<=this.KKb||!eb&&this.csa>=this.KKb}g6d(eb){eb=void 0===eb?!0:eb;this.Uo&&(this.csa=this.Uo.scrollLeft);window.cancelAnimationFrame(this.ura);this.ura=0;this.hJc=-1;eb&&this.h4()}t0d(eb,bb){eb||f.ULS.sendTraceTag(537153733,0,50,`SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by ${bb}`);this.V7=eb}c6i(eb){return 2===
eb?(this.Wha(3),!0):1===eb?(this.Wha(0),!0):!1}zRf(eb){f.ULS.shipAssertTag(537153732,0,-1===this.jVa&&-1===this.iVa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.jVa&&(window.clearTimeout(this.jVa),this.jVa=-1);-1!==this.iVa&&(window.clearInterval(this.iVa),this.iVa=-1);this.Wha(eb);this.jVa=window.setTimeout(()=>{this.j5j(eb)},this.r_i);return!0}j5j(eb){this.iVa=window.setInterval(()=>{this.Wha(eb)},
this.q_i)}ARf(){this.Rad();return!this.yU}Rad(){window.clearTimeout(this.jVa);window.clearInterval(this.iVa);this.iVa=this.jVa=-1;return!0}pbj(eb,bb){const Rb=this.Bqc(bb),Q=5===bb;"mouseup"!==eb.type||!Q&&4!==bb||(Rb||this.reorderSheets(null,Q,!1),this.XX())}Bqc(eb){return!!T.DOMElementExtensions.Wcf(this.GQ[eb],"a").title}SMc(eb){this.mae(eb);this.h4()}mae(eb){(eb=this.MBb(eb))&&eb.smb()}GZd(){var eb=this.$.va;if(eb.na&&(!Wb.e(this.$)||eb.count))if(eb=this.ona(eb.na),-1===eb)f.ULS.sendTraceTag(537153729,
0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var bb=this.qQa(eb);eb<this.XB?this.sFc(eb):eb>this.XB&&!this.uDd(bb)&&this.scrollIntoView(eb)}}Jhk(){this.XB=0;this.fZ=this.Ej.length-1;let eb=!1;for(let bb=0;bb<this.Ej.length;bb++){const Rb=this.zY(bb);if(!Rb)break;const Q=this.uDd(Rb.domElement);Rb.tabIndex=Q?0:-1;if(!eb&&Q)this.XB=bb,eb=!0;else if(eb&&!Q){this.fZ=bb-1;break}}}sFc(eb){this.$.va.count&&(this.Ej.length||this.afd(),this.weg(this.qQa(Math.max(0,
Math.min(eb,this.Ej.length-1)))),this.h4())}scrollIntoView(eb){f.ULS.shipAssertTag(537153697,0,eb>=this.XB,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visible sheet tab index!");if(this.$.va.count){this.Ej.length||this.afd();var bb=this.qQa(Math.max(0,Math.min(eb,this.Ej.length-1))),Rb=this.qQa(this.XB);if(!this.uDd(bb)){bb=T.DOMElementExtensions.getBoundingClientRect(bb);var Q=T.DOMElementExtensions.getBoundingClientRect(this.Tjb);bb=this.isRtl?Q.x-bb.x:bb.x+
bb.width-(Q.x+Q.width);for(Q=0;Rb&&Q<bb;){const Ia=T.DOMElementExtensions.getBoundingClientRect(Rb);Q+=Ia.width;Rb=Rb.nextSibling}Rb?this.weg(Rb):f.ULS.sendTraceTag(537153696,0,15,`SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = ${this.XB}, lastVisibleSheetTabIndex = ${this.fZ}, scroll to index: ${eb}`)}this.h4()}}weg(eb){const bb=T.DOMElementExtensions.getBoundingClientRect(this.Uo);eb=T.DOMElementExtensions.getBoundingClientRect(eb);this.isRtl?this.scrollLeft(Math.floor(bb.x+
bb.width-(eb.x+eb.width+.5))):this.scrollLeft(Math.ceil(bb.x-eb.x-.5))}scrollLeft(eb){(0>eb&&this.CZd()||0<eb&&this.BZd())&&f.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");const bb=this.Uo.scrollLeft;if(this.isRtl){if(y.a.dE||y.a.vh){this.Uo.scrollLeft=this.csa=bb-eb;return}if(y.a.TK){this.Uo.scrollLeft=this.csa=bb+eb;return}f.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.Uo.scrollLeft=
this.csa=bb-eb}uDd(eb){eb=T.DOMElementExtensions.getBoundingClientRect(eb);const bb=T.DOMElementExtensions.getBoundingClientRect(this.Tjb);return eb&&bb?eb.x>=bb.x-1&&eb.x+eb.width<=bb.x+bb.width+1:(f.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)}ksh(){const eb=this.C2d;U.Oig(this.$)?(Oa.a.Ma(this.kU),this.kU=new U(eb,this.$,this,!0)):(Oa.a.Ma(this.kU),Kb.m(this.$.Fg)?this.kU=new hc(eb,this.$,this):this.kU=new U(eb,
this.$,this))}FTe(eb,bb){var Rb=this.$.va;if(!this.$.isEditMode||!Rb.count)Oa.a.Ma(bb),bb=null;else if(!bb)if(Rb=this.B2d,Kb.m(this.$.Fg))bb=new hc(Rb,this.$,this);else switch(eb){case 0:bb=new U(Rb,this.$,this);break;case 1:bb=new za(Rb,this.$,this);break;default:f.ULS.sendTraceTag(537153692,0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return bb}Fed(){this.TFi?
(this.kU=this.FTe(0,this.kU),this.MGb=this.FTe(1,this.MGb)):this.ksh()}xdf(eb){const bb=T.DOMElementExtensions.getBoundingClientRect(this.QP);bb||(f.ULS.sendTraceTag(537153689,0,50,`SheetTabBarControl.${eb}: GetBoundingClientRect returned null for the dragged sheet.`),this.XX());return bb}plf(eb,bb){this.Fya.e4g(eb,bb);this.XX(!1);this.$0d(this.navigationButtonsDisabled);for(const Rb of this.X7j)Rb&&Rb.JV(this.navigationButtonsDisabled);for(const Rb of this.cIe)Rb&&Rb.JV(this.operationButtonsDisabled)}static JDj(eb,
bb,Rb,Q){eb<Rb?(bb>Rb&&Rb--,bb>Q&&Q--):eb>Q?(bb<Rb&&Rb++,bb<Q&&Q++):bb<Rb&&Rb++;return{FWh:Rb,lOi:Q}}}Object(d.a)(Yc,"SheetTabBarControl",Pa.a,[306,5,56]);var Tc=a(484);Object(la.b)(Z.Lc,{yt:"singleton"})(eb=>Io(function*(){const bb=yield la.a.resolve(Z.W,eb);var Rb=bb.Pd;if(nb.a(bb.xa,1))return ab.PageLoadTrackingInfo.instance.JWa(ka.a.$aa,["sheetTabBar"]),null;Rb=document.getElementById(Rb+ka.a.jec);if(!Rb)return ab.PageLoadTrackingInfo.instance.JWa(ka.a.$aa,["sheetTabBar"]),null;ab.PageLoadTrackingInfo.instance.cia(ka.a.$aa);
const Q=yield la.a.resolve(Tc.SvgIconProviderService,eb);return new Yc(bb,Rb,Q)}));class ed extends X.a{constructor(eb){super();this.$=eb;this.je()}create(){const eb=this.$.Pd;if(nb.a(this.$.xa,1))ab.PageLoadTrackingInfo.instance.JWa(ka.a.$aa,["sheetTabBar"]);else{var bb=document.getElementById(eb+ka.a.jec);if(bb){ab.PageLoadTrackingInfo.instance.cia(ka.a.$aa);var Rb=Ga.GetServiceTaskFactory.ud(this.$.ga,388,387,this.Ta);H.TaskExtensions.za(H.TaskExtensions.Wf([Rb],this.$.ka),()=>{this.Ld(this.$.ga.Da(32)||
new Yc(this.$,bb,Rb.result))},this.$.ka,3)}else ab.PageLoadTrackingInfo.instance.JWa(ka.a.$aa,["sheetTabBar"])}}static la(eb){eb.ga.Qa(33,new ed(eb))}}Object(d.a)(ed,"SheetTabBarFactory",X.a,[]);var be=a(31),Fc=a(332),vd=a(359),lb=a(383),Eb=a(34),Hc=a(248),Bd=a(247);class he{constructor(eb,bb,Rb,Q){this.red=eb;this.green=bb;this.blue=Rb;this.alpha=Q}toString(){return this.red.toString()+this.green.toString()+this.blue.toString()+this.alpha.toString()}}Object(d.a)(he,"ColorObject",null,[]);class je{constructor(eb){this.B0=
this.DJ=null;this.y$c=eb}get head(){return this.DJ}get h7d(){return this.B0}xWe(eb){this.head&&(eb.pre?eb.next?(eb.pre.next=eb.next,eb.next.pre=eb.pre):(this.B0=eb.pre,this.h7d.next=null):eb.next?(this.DJ=eb.next,this.head.pre=null):this.B0=this.DJ=null,eb.next=null,eb.pre=null)}GXg(eb){this.head?(eb.next=this.head,this.DJ=eb,eb.next.pre=this.head):this.B0=this.DJ=eb}Zqd(){if(!this.head)return null;const eb=new Ka.a;let bb=this.head;for(;bb;)if(eb.add(bb.value),bb=bb.next,eb.count>this.y$c){f.ULS.sendTraceTag(537155399,
0,10,"CustomLinkedList.GetItems - Size of Linked List exceeded max capacity.");break}return eb}}Object(d.a)(je,"CustomLinkedList",null,[]);class Fd{constructor(eb){this.pre=this.next=null;this.value=eb}}Object(d.a)(Fd,"CustomLinkedListNode",null,[]);class Oc{constructor(eb){this.y$c=eb;this.dwc={};this.Fdb=new je(eb);this.count=0}add(eb,bb){eb&&bb?(bb=new Fd(bb),this.contains(eb)?this.Fdb.xWe(this.dwc[eb]):this.count<this.y$c?this.count++:(delete this.dwc[this.Fdb.h7d.value.toString()],this.Fdb.xWe(this.Fdb.h7d)),
this.Fdb.GXg(bb),this.dwc[eb]=bb):f.ULS.sendTraceTag(537155358,0,15,`MRUCache.Add: Key ${eb} or Value ${bb} is null.`)}Zqd(){return this.Fdb.Zqd()}contains(eb){return eb?eb in this.dwc:!1}}Object(d.a)(Oc,"MRUCache",null,[]);var Ad=a(151);class Gb extends Ad.a{constructor(eb,bb,Rb,Q){Q=void 0===Q?null:Q;super(!1,!1,!0);this.moreColorsHelper=null;this.Wih=(Ia,ub)=>{this.kPe(Ia,ub)};this.$=eb;this.wui=bb;this.uxd=Rb;this.lPe=Q}ri(){const eb=Tb.a.instance.ia(1346),bb={};bb[Gb.bCg]=this.wui;bb[Gb.oAg]=
Gb.sZb;bb[Gb.VBg]=Gb.sZb;bb[Gb.lDg]=Gb.sZb;bb[Gb.cDg]=Gb.sZb;bb[Gb.HCg]=Tb.a.instance.ia(2105);bb[Gb.OBg]=Tb.a.instance.ia(2089);bb[Gb.vAg]=Tb.a.instance.ia(2076);bb[Gb.TBg]=Tb.a.instance.ia(1347);bb[Gb.pAg]=Tb.a.instance.ia(1348);this.uxd!==Gb.qAg&&(bb[Gb.rAg]=Gb.ALPHA,bb[Gb.ALPHA]=this.uxd,f.ULS.sendTraceTag(537155398,0,50,`More Colors:: Initial Alpha Value : ${this.uxd}`));this.initializeAndShow(eb,this.Wih,{[Gb.yBg]:Gb.WAg,[Gb.wAg]:bb})}kPe(eb,bb){bb=bb[Gb.GOc];1===eb&&this.xJf(Dd.a.Rha(bb));
this.lPe&&this.lPe(1===eb,1===eb?bb:null)}xJf(eb){this.moreColorsHelper||(this.moreColorsHelper=this.$.ga.Da(398));eb=$c.a.XH(Dd.a.tK(eb,!1));this.moreColorsHelper.lZd(eb.r,eb.g,eb.b,vd.a.vOc)}}Gb.bCg="initColor";Gb.yBg="id";Gb.WAg="ColorPickerDialog";Gb.wAg="bodyControls";Gb.GOc="selectedColorText";Gb.VBg="hueAriaLabel";Gb.lDg="transparencyAriaLabel";Gb.cDg="svAriaLabel";Gb.sZb="Use left & right arrows keys to change values in color picker & hue slider";Gb.ALPHA="alpha";Gb.uOc="alphaValue";Gb.oAg=
"alphaAriaLabel";Gb.rAg="alphaSliderType";Gb.qAg=-1;Gb.sCg=100;Gb.HCg="redLabel";Gb.vAg="blueLabel";Gb.OBg="greenLabel";Gb.TBg="hexLabel";Gb.pAg="alphaLabel";Object(d.a)(Gb,"MoreColorsDialog",Ad.a,[]);var Wc=a(530);class pd extends Gb{constructor(eb,bb,Rb,Q,Ia){super(eb,Q,Ia);this.commandName=null;this.vrf=!1;this.command=bb;this.Bf=Rb;this.mui=Ia}ri(){super.ri();this.commandName=xc.b().zl(this.Bf.command);f.ULS.sendTraceTag(545051016,0,50,`More Colors:: Dialog Opened From Entry Point: ${this.commandName}, Command SourceUILocation: ${this.Bf.Tg}`)}kPe(eb,
bb){if(1===eb)if(eb=this.$.Sd.fi("UserAction",this.commandName),eb.start(),Wc.a(eb),bb)if(Gb.GOc in bb){var Rb=bb[Gb.GOc];if(eb=Dd.a.Rha(Rb)){Rb=new $a.a(this.command,this.Bf.method,this.Bf.mode,this.Bf.Tg,this.Bf.tabName?this.Bf.tabName:1378078823===this.command||-400966242===this.command?ka.a.pEa:ka.a.nR);var Q={};Q.Color=eb;Q.UILocation=this.Bf.Tg;Gb.uOc in bb&&(this.mui!==bb[Gb.uOc]&&(this.vrf=!0),Q.Alpha=(bb[Gb.uOc]/Gb.sCg).toString(),f.ULS.sendTraceTag(508822752,0,50,"Alpha Value selected from the MoreColors Dialog."));
this.$.Ha.Ad(Rb,Q);this.$.Qh();this.xJf(eb);bb={["Command"]:this.commandName,["Location"]:this.Bf.Tg};bb.AlphaApplied=this.vrf.toString();Kd.b(this.$).nf(Pb.a.iZi,bb,null,!0)}else this.hide(),f.ULS.sendTraceTag(537155360,0,10,`Color picker dialog did not return the color in expected format RRGGBB. Color returned: ${Rb}, Command: ${this.commandName}`)}else this.hide(),f.ULS.sendTraceTag(537155361,0,10,`Dictionary does not contain color, Command: ${this.commandName}`);else this.hide(),f.ULS.sendTraceTag(537155362,
0,10,`Dictionary is null Command: ${this.commandName}`)}}Object(d.a)(pd,"MoreColorsRibbonDialog",Gb,[]);class fe{constructor(eb,bb){this.ete="00FFFF";this.fte="0000FF";this.k3f="00FFFF";this.l3f="BF7000";this.VVa=null;this.Oef=!1;this.Moe=null;this.e9i=Rb=>{if(!Hc.a(Rb)){Rb=Rb.Result;this.VVa=new Oc(10);for(let Ia=Rb.length-1;0<=Ia;Ia--){var Q=Rb[Ia];Q=new he(Q.Red,Q.Green,Q.Blue,Q.Alpha);this.VVa.add(Q.toString(),Q)}this.EYf();f.ULS.sendTraceTag(537155395,0,50,"MoreColorsHelper.OnGetMRUColorsSuccessCallback : Successfully fetched Recent colors ")}};
this.d9i=()=>{f.ULS.sendTraceTag(537155394,0,50,"MoreColorsHelper.OnGetMRUColorsFailureCallback - Webservice call failed")};this.oG=()=>{this.Ild()};this.$=eb;this.VKb=bb;this.$.ga.Qa(398,this);this.$.ea.nh?this.Ild():this.$.ea.Fl(this.oG)}get RKb(){return this.Moe}get WVa(){return this.ete}set WVa(eb){this.ete=eb}get Ihb(){return this.fte}set Ihb(eb){this.fte=eb}get WBc(){return this.k3f}set WBc(eb){this.k3f=eb}get XBc(){return this.l3f}set XBc(eb){this.l3f=eb}GKb(eb,bb,Rb,Q){Q=void 0===Q?-1:Q;return this.VKb?
H.TaskExtensions.za(this.VKb,()=>{(new pd(this.$,eb,bb,Rb,Q)).ri()},this.$.ka):null}TOi(eb,bb){var Rb=void 0;Rb=void 0===Rb?-1:Rb;bb=void 0===bb?null:bb;this.VKb&&H.TaskExtensions.za(this.VKb,()=>{(new Gb(this.$,eb,Rb,bb)).ri()},this.$.ka)}Uei(eb){let bb=null;switch(eb){case "QueryRecentFillColor":bb=this.WVa;break;case "QueryRecentFontColor":bb=this.Ihb;break;case "QueryRecentShapesFillColor":bb=this.WBc;break;case "QueryRecentShapesOutlineColor":bb=this.XBc}return bb?be.a.r$a(bb):null}dispose(){this.VKb=
null;this.$&&this.$.ea.xo(this.oG)}Ild(){if(this.$.isEditMode)if(this.VVa)this.EYf();else{this.Oef&&f.ULS.sendTraceTag(575939106,0,15,"MoreColorsHelper.FetchMRUColors : Recent Colors not shown since data not available from GetMRUColors operation");var eb=this.$.qa.ua;this.$.userOperationManager.enqueueOperation(new Sb.a(1009,0,(bb,Rb,Q)=>{bb=Bd.b.call(null,bb,this.e9i);Rb=Bd.a.call(null,Rb,this.d9i);const Ia=eb.Pa(1,null);return Nb.g(eb,"GetMRUColors",Ia,bb,Rb,Q,null,4)},80),null);this.Oef=!0}}EYf(){var eb=
this.VVa.Zqd();if(eb){this.Moe=new Ka.a;for(let bb of eb)eb=bb,eb=new $c.a(eb.red,eb.green,eb.blue),this.RKb.add(Dd.a.WL(eb))}}lZd(eb,bb,Rb,Q){this.VVa||(this.VVa=new Oc(10));const Ia=new he(eb,bb,Rb,Q);this.VVa.add(Ia.toString(),Ia);this.saveMRUColor(null,eb,bb,Rb,Q)}wha(eb,bb,Rb){(eb||this.$.isEditMode)&&this.ujg(eb.SqmControlId)&&(eb=$c.a.XH(Dd.a.tK(bb,!1)))&&(this.lZd(eb.r,eb.g,eb.b,vd.a.vOc),Rb={["Command"]:xc.b().zl(Rb.command),["Location"]:Fc.a[Rb.Tg],["InputMethod"]:hb.a[Rb.method]},Kd.b(this.$).nf(Pb.a.wha,
Rb,null,!0))}ujg(eb){return!!eb&&eb.startsWith("RecentColorPicker")}saveMRUColor(eb,bb,Rb,Q,Ia){return lb.a(this.$.userOperationManager,(ub,Yb,Ca)=>{var tb=this.$.qa.ua;ub=Bd.b(ub,fe.Mdj());Yb=Bd.a(Yb,fe.Ldj());const $b=tb.Pa(9,null);$b.bRed=bb;$b.bGreen=Rb;$b.bBlue=Q;$b.bAlpha=Ia;return Nb.g(tb,"SaveMRUColor",$b,ub,Yb,Ca,null,0)},ub=>new Sb.a(1008,0,ub),eb)}static Mdj(){return eb=>{Eb.a.ph(eb.Errors)?f.ULS.sendTraceTag(537155393,0,10,"MoreColorsHelper.OnSaveMRUColorFailure - Webservice call failed with errors"):
f.ULS.sendTraceTag(537155392,0,50,"MoreColorsHelper.OnSaveMRUColorSuccess - Successfully saved color to workbook")}}static Ldj(){return()=>{f.ULS.sendTraceTag(537155363,0,10,"MoreColorsHelper.OnSaveMRUColorFailure - Webservice call failed.")}}}Object(d.a)(fe,"MoreColorsHelper",null,[353,5]);class le extends X.a{constructor(eb){super();this.$=eb;this.je()}create(){const eb=new dd.a;this.$.DK(Rb=>{Rb=Rb.GBf();H.TaskExtensions.za(Rb,()=>{eb.setResult(!0)},this.$.ka)});const bb=eb.task;this.Ld(this.$.ga.Da(398)||
new fe(this.$,bb))}static la(eb){eb.ga.Qa(397,new le(eb))}}Object(d.a)(le,"MoreColorsHelperFactory",X.a,[]);var te=a(2),Ce=a(571),Xb=a(568),oc=a(386),Zc=a(622);class yd{constructor(){this.Alt=this.DisplayColor=this.Color=null}}Object(d.a)(yd,"ColorCellProps",null,[]);var Od=a(237),dc=a(220),gd=a(272),wd=a(22);class Ld{constructor(eb){this.sQc=null;this.$=eb;this.grid=Ta.h(this.$)}get borderFormatManager(){this.sQc||(this.sQc=this.$.ga.Da(296));return this.sQc}R9h(eb){let bb=null;switch(eb){case 467002767:eb=
{};this.$.Kl(eb);bb=Object(pb.a)(ec.a,this.$.va).Phf(eb.SheetName,!0);break;case -236759591:bb=this.Y2h();break;case 1970784898:bb=this.ldf(0);break;case 1650812936:case 1378078823:bb=this.ldf(1);break;case -400966242:bb=this.getShapeOutlineColor();break;default:f.ULS.sendTraceTag(537154460,0,50,`ColorHighlighterHelper.GetHighlightColorBasedOnCommand: HighlightColor is not supported for ribbon command '${eb}'`)}return bb}Y2h(){let eb=null;this.borderFormatManager&&(eb=this.borderFormatManager.E7);
(eb="black"===eb?"000000":eb)&&(eb=be.a.r$a(eb));return eb}getShapeOutlineColor(){let eb=null;if(this.grid.ha.Va&&this.grid.ha.Va.pe){const bb=this.grid.ha.Va.pe.floatingObject;5===bb.type&&bb.Jd&&-1!==bb.Jd.ShapeOutlineColor&&(eb=Dd.a.fJ(bb.Jd.ShapeOutlineColor),eb=eb.toUpperCase())}return eb}ldf(eb){let bb=null;if(this.grid.ha.Va&&this.grid.ha.Va.pe){var Rb=this.grid.ha.Va.pe.floatingObject;5===Rb.type&&Rb.Jd?1===eb&&-1!==Rb.Jd.ShapeFillColor?(bb=Dd.a.fJ(Rb.Jd.ShapeFillColor),bb=bb.toUpperCase()):
f.ULS.sendTraceTag(537154459,0,50,"ColorHighlighterHelper.GetFontOrFillColor: HighlightColor for Font ColorPicker is not supported for Shapes."):f.ULS.sendTraceTag(537154458,0,50,"ColorHighlighterHelper.GetFontOrFillColor: HighlightColor for Font or Fill ColorPicker is not supported for Floating Object other than Shapes.");return bb}Rb=this.grid.A7("ColorHighlighterHelper.GetFontOrFillColor",this.grid.ha.ra.selectedRanges,1,!0);try{for(Rb.$$rst();Rb.$$mn();){const Q=Rb.$$cu().cell;if(!Q)continue;
let Ia="#000000";if(0===eb){Ia=Q.color;if(M.EwaSettings.Fd()&&this.grid.ld)return this.J8h();Q.hasRichText&&(Ia=this.K8h(Q))}else if(1===eb){const ub=Q.backgroundColor;Ia=wd.a.compare(ub,"transparent",!0)&&ub?Q.backgroundColor:null}if(!bb)bb=Ia;else if(bb!==Ia){bb=null;break}}}finally{Rb&&Rb.dispose()}return bb}J8h(){var eb=null,bb=this.grid.he,Rb=this.grid.cellTextEditBox.formattedText;if(Rb){eb=Rb.TextRuns;const Q=Od.a.map(eb,Ia=>Ia.StartIndex);Rb=Rb.Fonts;bb=bb.textBox.caretPosition;bb=Hb.HelperMethods.r7e(new dc.a(Q),
Q.length,bb,Hb.HelperMethods.yI);eb=Rb[eb[bb].FontID].Color}return eb?eb.toUpperCase():null}K8h(eb){eb=gd.a(eb.formattedText.Fonts);if(gd.e(eb,32))(eb=Dd.a.Rha(Dd.a.fJ(eb.FontColor)))&&(eb="#"+eb.toUpperCase());else return null;return eb}}Object(d.a)(Ld,"ColorHighlighterHelper",null,[391]);var Xd=a(325);class Ie{constructor(eb,bb,Rb){this.VBc=this.cWb=this.dGa=null;this.bdg="-1";this.$=eb;this.moreColorsHelper=bb;this.Cq=Rb;this.iPe=new Ld(eb);this.eG=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",
!1)}Tef(eb,bb,Rb,Q,Ia,ub,Yb,Ca,tb){bb=void 0===bb?null:bb;Rb=void 0===Rb?null:Rb;Q=void 0===Q?null:Q;Ca=void 0===Ca?null:Ca;return this.rT(null!=bb,null!=Rb,null!=Q,null!=Ca,!0,eb,bb,Rb,Q,void 0===Ia?null:Ia,void 0===ub?null:ub,void 0===Yb?null:Yb,Ca,void 0===tb?null:tb)}Chi(eb,bb,Rb,Q){return this.rT(eb,bb,Rb,Q,!1)}Uef(eb,bb,Rb,Q,Ia,ub){const Yb=[];eb=this.Tef(eb,void 0===bb?null:bb,void 0===Rb?null:Rb,void 0===Q?null:Q,void 0,void 0,void 0,void 0===Ia?null:Ia,void 0===ub?null:ub);for(let Ca=0,tb=
eb.length;Ca<tb;Ca++)Yb.push(Xd.r(eb[Ca]));return Yb}rT(eb,bb,Rb,Q,Ia,ub,Yb,Ca,tb,$b,cd,sd,re,De){ub=void 0===ub?null:ub;Yb=void 0===Yb?null:Yb;Ca=void 0===Ca?null:Ca;tb=void 0===tb?null:tb;$b=void 0===$b?null:$b;cd=void 0===cd?null:cd;sd=void 0===sd?null:sd;re=void 0===re?null:re;De=void 0===De?null:De;f.ULS.shipAssertTag(537154456,0,!Ia||null!=ub,"ColorPickerBuilder: must provide value for applyColorCommand if created for ribbon.");const Ye=[];let $e=null,tf=3,Jb=null,yc=null,Id=null;this.MGh();
if(M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.$&&this.$.isEditMode&&!this.xmj(De))return f.ULS.sendTraceTag(537154455,0,50,`Theme Info not present at the time of ${De} menu opening`),Ye;eb&&(Ia&&null==Yb?f.ULS.shipAssertTag(537154454,0,!1,"ColorPickerBuilder: must provide automaticColorCommand when addAutomaticSection is true."):Ye.push(this.oQa(Ie.$6g,this.PZh(Ie.UHe,Yb,sd,cd))));Ia&&null!=ub&&this.iPe&&(yc=Jb="-1",$e=this.iPe.R9h(ub))&&(f.ULS.sendTraceTag(537154453,
0,50,`ColorPickerBuilder: Highlighter color for the command ${ub} is not null .`),$e=Dd.a.Rha($e),tf=this.Sdf($e),Jb=this.vsd($e,tf,0,!0),yc=this.vsd($e,tf,1,!1));Ye.push(this.oQa(Ie.p9j,this.Wnd(Ie.gqg,Jb,this.dGa,ub,$b,cd),1341));Ye.push(this.oQa(Ie.D4j,this.Wnd(Ie.C4j,yc,this.cWb,ub,$b,cd),1342));this.$&&this.$.isEditMode&&this.moreColorsHelper&&(this.vmj(),Ia&&(Id="-1",$e&&(Id=this.vsd($e,tf,2,!0))),this.moreColorsHelper&&this.moreColorsHelper.RKb&&0<this.moreColorsHelper.RKb.count&&Ye.push(this.oQa(Ie.Suj,
this.Wnd(Ie.Ruj,Id,this.VBc,ub,$b,cd),1349)));bb&&(Ia&&null==Ca?f.ULS.shipAssertTag(537154452,0,!1,"ColorPickerBuilder: must provide clearColorCommand when addClearColorSection is true."):Ye.push(this.oQa(Ie.o0i,this.RZh(Ie.CNe,Ca,this.o4h(Ca),sd,cd))));!Rb||M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&this.$.isMobileMode&&this.$.isEditMode||(t.AFrameworkApplication.KN("XLS-HighlightWhenCFExperiment-Treatment;XLS-HighlightWhenCFExperiment-Control"),M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HighlightWhenCFExperiment",
!1)&&t.AFrameworkApplication.da.pa("IsO365ConsumerHost")&&(Ia&&!tb?f.ULS.shipAssertTag(520668946,0,!1,"ColorPickerBuilder: must provide highlightWhenCommand when addHighlightWhenSection is true."):Ye.push(this.oQa(Ie.osi,this.u_h(Ie.Bnf,tb)))));Q&&(Ia&&null==re?f.ULS.shipAssertTag(537154451,0,!1,"ColorPickerBuilder: must provide moreColorsCommand when addMoreColorsSection is true."):Ye.push(this.oQa(Ie.jZi,this.R_h(Ie.FHf,re,this.lbi(re)))));return Ye}vsd(eb,bb,Rb,Q){3===bb&&(bb=this.Sdf(eb));return this.eG&&
0===Rb&&bb===Rb?this.bdg.toLowerCase():bb===Rb?Q?eb.toLowerCase():eb:"-1"}Sdf(eb){if(!eb)return 3;const bb=eb.toLowerCase();if(this.eG){if(this.dGa&&this.rLi(bb,this.dGa))return 0}else if(this.dGa&&this.zzd(bb,this.dGa))return 0;return this.cWb&&this.zzd(eb,this.cWb)?1:this.VBc&&this.zzd(bb,this.VBc)?2:3}oQa(eb,bb,Rb){Rb=void 0===Rb?null:Rb;eb=Object(te.a)(new Xb.a,{Id:eb,Title:null!=Rb?Tb.a.instance.ia(Rb):"",ControlList:[],ControlsId:eb+".Controls"});eb.ControlList.push(bb);return eb}RZh(eb,bb,
Rb,Q,Ia){return this.e$e(eb,bb,Rb,ra.a.P2e,"transparent",void 0===Q?null:Q,void 0===Ia?null:Ia)}u_h(eb,bb){return Object(te.a)(new oc.a,{Command:null!=bb?bb.toString():null,LabelText:Tb.a.instance.ia(1433),Id:eb,ExternalId:this.W9a(eb,bb),ExternalImageId:"JotNotebookColor2_20"})}PZh(eb,bb,Rb,Q){return this.e$e(eb,bb,542,ra.a.O2e,"000000",void 0===Rb?null:Rb,void 0===Q?null:Q)}e$e(eb,bb,Rb,Q,Ia,ub,Yb){ub=void 0===ub?null:ub;Yb=void 0===Yb?null:Yb;return Object(te.a)(new oc.a,{Command:null!=bb?bb.toString():
null,CommandPreviewId:null!=ub?ub.toString():null,CommandRevertId:null!=Yb?Yb.toString():null,MenuItemsStatefulData:this.Vai(eb,bb,Ia),LabelText:Tb.a.instance.ia(Rb),Id:eb,ExternalId:this.W9a(eb,bb),Image16by16:vc.a.Ci(1),Image16by16Class:Q})}Vai(eb,bb,Rb){const Q={};eb=this.W9a(eb,bb);Q[eb]={};Q[eb].iconColor=Rb;return Q}zzd(eb,bb){for(let Rb=0;Rb<bb.length;Rb++)if(eb===bb[Rb].Color)return!0;return!1}HJi(eb,bb){eb=Dd.a.tr(eb);bb=Dd.a.tr(bb);return 1>=Math.abs(eb.r-bb.r)&&1>=Math.abs(eb.g-bb.g)&&
1>=Math.abs(eb.b-bb.b)?!0:!1}rLi(eb,bb){for(let Rb=0;Rb<bb.length;Rb++){const Q=bb[Rb].Color;if(this.HJi(eb,Q))return this.bdg=Q.toLowerCase(),!0}return!1}Wnd(eb,bb,Rb,Q,Ia,ub){Ia=void 0===Ia?null:Ia;ub=void 0===ub?null:ub;return Object(te.a)(new Zc.a,{McuLayout:!0,Command:null!=Q?Q.toString():null,CommandPreviewId:null!=Ia?Ia.toString():null,CommandRevertId:null!=ub?ub.toString():null,Width:10,Id:`${eb}.ColorPicker`,SelectedColorId:bb,Colors:Rb,Stateful:!0,ExternalId:this.W9a(eb,Q),McuExternalId:`${this.W9a(eb,
Q)}.MCU`})}W9a(eb,bb){return`${eb}.${null!=bb?bb.toString():""}`}njc(...eb){const bb=[];for(let Rb=0,Q=eb.length;Rb<Q;Rb+=2)bb.push(Object(te.a)(new yd,{Color:eb[Rb],DisplayColor:Dd.a.WL($c.a.XH(parseInt(String("0x"+eb[Rb]),16))),Alt:Object(Ab.a)(String,eb[Rb+1])&&this.$?eb[Rb+1]:Tb.a.instance.ia(eb[Rb+1])}));return bb}R_h(eb,bb,Rb){const Q=ra.a.f3e;eb=Object(te.a)(new oc.a,{Command:null!=bb?bb.toString():null,LabelText:Tb.a.instance.ia(Rb),Id:eb,ExternalId:this.W9a(eb,bb),Image16by16:vc.a.Ci(1),
Image16by16Class:Q});eb.ShouldTakeFocus=!1;return eb}MGh(){this.dGa||(this.dGa=this.njc("ffffff",1360,"000000",1361,"e6e6e7",1362,"6a5444",1363,"c47244",1364,"317ded",1365,"a5a5a5",1366,"00c0ff",1367,"d59b5b",1368,"47ad70",1369,"f2f2f2",1370,"808080",1371,"ceced0",1372,"e4dcd6",1373,"f2e1d9",1374,"d6e4fc",1375,"ededed",1376,"ccf2ff",1377,"f7ebdd",1378,"daefe2",1379,"d9d9d9",1380,"595959",1381,"aaaaae",1382,"cab9ac",1383,"e7c6b4",1384,"adcbf8",1385,"dbdbdb",1386,"99e6ff",1387,"eed7bd",1388,"b4e0c6",
1389,"bfbfbf",1390,"404040",1391,"717175",1392,"b09784",1393,"dba98e",1394,"84b0f4",1395,"c9c9c9",1396,"66d9ff",1397,"e6c29b",1398,"8ed0a9",1399,"a6a6a6",1400,"262626",1401,"38383a",1402,"4f3f33",1403,"965430",1404,"1159c6",1405,"7b7b7b",1406,"008fbf",1407,"b5752f",1408,"358254",1409,"808080",1410,"0d0d0d",1411,"161616",1412,"352b22",1413,"643720",1414,"0c3c83",1415,"525252",1416,"006080",1417,"784e1f",1418,"235637",1419));this.cWb||(this.cWb=this.njc("0000C0",1355,"0000FF",1352,"00C0FF",1354,"00FFFF",
1356,"50D092",1357,"50B000",1358,"F0B000",1359,"C07000",1351,"602000",1350,"A03070",1353))}vmj(){this.moreColorsHelper.Ild();if(this.moreColorsHelper.RKb){var eb=this.moreColorsHelper.RKb;const bb=[];for(let Rb of eb)eb=Dd.a.Rha(Rb.substr(1)),bb.push(eb,Rb);this.VBc=this.njc(...bb)}}xmj(eb){this.Cq.DBb(eb);if(this.Cq.dlb&&this.Cq.hqg&&!this.Cq.dyf){eb=this.Cq.dlb;const bb=this.Cq.hqg,Rb=[];for(let Q=0;Q<eb.count;Q++)Rb.push(eb.ma(Q),bb.ma(Q));this.dGa=this.njc(...Rb);return!0}return!1}lbi(eb){switch(eb){case -458147525:eb=
1344;break;case 1610379174:eb=1345;break;default:eb=1343}return eb}o4h(eb){switch(eb){case 1549407384:eb=541;break;case -1744769642:eb=539;break;default:eb=540}return eb}}Ie.o0i="NoColor";Ie.$6g="Automatic";Ie.p9j="ThemeColors";Ie.D4j="StandardColors";Ie.Suj="RecentColors";Ie.CNe="ClearColor";Ie.osi="HighlightWhen";Ie.Bnf="HighlightWhen";Ie.UHe="AutomaticColor";Ie.gqg="ThemeColorPicker";Ie.C4j="StandardColorPicker";Ie.jZi="MoreColors";Ie.FHf="MoreColors";Ie.Ruj="RecentColorPicker";Object(d.a)(Ie,
"ColorPickerBuilder",null,[]);class We{constructor(){this.sections=null}}Object(d.a)(We,"ColorPickerButtonMenuProps",null,[]);class jf{constructor(){this.title=null;this.type=0;this.buttonProps=this.colorSwatchProps=null}}Object(d.a)(jf,"ColorPickerButtonMenuSection",null,[]);class tc{constructor(){this.id=this.label=this.color=null;this.index=0}}Object(d.a)(tc,"ColorPickerColorProps",null,[]);class Qc{constructor(){this.type=0;this.label=null}}Object(d.a)(Qc,"ColorPickerSectionButtonProps",null,
[]);class xd{constructor(){this.colors=null;this.isThemeColorSection=this.notifyOnColorUsed=!1}}Object(d.a)(xd,"ColorPickerSectionColorSwatchProps",null,[]);class Gd{constructor(){this.row=this.index=0}}Object(d.a)(Gd,"ThemeColorInfo",null,[]);class pe{constructor(eb,bb,Rb,Q){this.$=eb;this.pE=bb;this.moreColorsHelper=Rb;this.Cq=Q;this.qLi=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)}getColorPickerButtonMenuProps(eb){eb=this.pE.cif(eb.automaticColor,eb.clearColor,eb.highlightWhen,
eb.moreColors);const bb=new We;bb.sections=this.Nei(eb);return bb}showMoreColorsDialog(eb,bb){this.moreColorsHelper.TOi(eb,bb)}onColorUsed(eb){eb=$c.a.XH(Dd.a.tK(Dd.a.Rha(eb),!1));this.moreColorsHelper.lZd(eb.r,eb.g,eb.b,vd.a.vOc)}getThemeColor(eb){const bb=Dd.a.Rha(eb);let Rb,Q;if(!(()=>{let Ia=this.Cq.getThemeColor(bb);({themeIndex:Rb,eGa:Q}=Ia);return Ia})().returnValue)return f.ULS.shipAssertTag(538514630,0,!1,"ColorPickerButtonController: invalid theme color in GetThemeColor."),null;eb=new Gd;
eb.index=Rb;eb.row=Q;return eb}Nei(eb){const bb=[];for(let Q=0;Q<eb.length;Q++){var Rb=Object(pb.a)(Xb.a,eb[Q]);const Ia=new jf;Ia.title=Rb.Title;const ub=Object(pb.a)(Zc.a,Rb.ControlList[0]);ub?(Ia.type=1,Ia.colorSwatchProps=this.C4h(ub),bb.push(Ia)):(Rb=Object(pb.a)(oc.a,Rb.ControlList[0]))&&null!=this.wbf(Rb.Id)?(Ia.type=2,Ia.buttonProps=new Qc,Ia.buttonProps.type=this.wbf(Rb.Id),Ia.buttonProps.label=Rb.LabelText,bb.push(Ia)):f.ULS.shipAssertTag(542200588,0,!1,"ColorPickerButtonController: Unknown color menu control type")}return bb}C4h(eb){const bb=
new xd,Rb=eb.Colors;bb.colors=Array(Rb.length);bb.notifyOnColorUsed=this.moreColorsHelper.ujg(eb.ExternalId);bb.isThemeColorSection=this.qLi&&!!eb.ExternalId&&eb.ExternalId.includes(Ie.gqg);for(eb=0;eb<Rb.length;eb++)bb.colors[eb]=new tc,bb.colors[eb].id=Rb[eb].DisplayColor,bb.colors[eb].color=Rb[eb].DisplayColor,bb.colors[eb].label=Rb[eb].Alt,bb.colors[eb].index=eb;return bb}wbf(eb){switch(eb){case Ie.FHf:return 1;case Ie.CNe:return 2;case Ie.UHe:return 3;case Ie.Bnf:return 4}return null}}Object(d.a)(pe,
"ColorPickerButtonController",null,[360]);class Dc{constructor(eb,bb,Rb){this.vs=this.hm=null;this.$=eb;this.moreColorsHelper=bb;this.Xah();this.Wah();this.Cq=Rb;this.Gbc=new Ie(eb,bb,Rb)}Xah(){this.hm={};this.hm.style0=1535;this.hm.style1=1536;this.hm.style2=1537;this.hm.style3=1538;this.hm.style4=1539;this.hm.style5=1540;this.hm.style6=1541;this.hm.style7=1542;this.hm.style8=1543;this.hm.style9=1544;this.hm.style10=1545;this.hm.style11=1546;this.hm.style12=1547;this.hm.style13=1548;this.hm.style14=
1549;this.hm.style15=1550;this.hm.style16=1551;this.hm.style17=1552;this.hm.style18=1553;this.hm.style19=1554;this.hm.style20=1555;this.hm.style21=1556;this.hm.style22=1557;this.hm.style23=1558;this.hm.style24=1559;this.hm.style25=1560;this.hm.style26=1561;this.hm.style27=1562;this.hm.style28=1563;this.hm.style29=1564;this.hm.style30=1565;this.hm.style31=1566;this.hm.style32=1567;this.hm.style33=1568;this.hm.style34=1569;this.hm.style35=1570;this.hm.style36=1571;this.hm.style37=1572;this.hm.style38=
1573;this.hm.style39=1574;this.hm.style40=1575;this.hm.style41=1576}Wah(){this.vs={};this.vs.style0=1507;this.vs.style1=1508;this.vs.style2=1509;this.vs.style3=1510;this.vs.style4=1511;this.vs.style5=1512;this.vs.style6=1513;this.vs.style7=1514;this.vs.style8=1515;this.vs.style9=1516;this.vs.style10=1517;this.vs.style11=1518;this.vs.style12=1519;this.vs.style13=1520;this.vs.style14=1521;this.vs.style15=1522;this.vs.style16=1523;this.vs.style17=1524;this.vs.style18=1525;this.vs.style19=1526;this.vs.style20=
1527;this.vs.style21=1528;this.vs.style22=1529;this.vs.style23=1530;this.vs.style24=1531;this.vs.style25=1532;this.vs.style26=1533;this.vs.style27=1534}xbf(eb){return Xd.i(this.Gbc.Uef(eb,null,null,null,null,null))}bkc(eb,bb,Rb,Q,Ia,ub,Yb,Ca,tb){bb=void 0===bb?null:bb;Rb=void 0===Rb?null:Rb;Q=void 0===Q?null:Q;Ia=void 0===Ia?null:Ia;ub=void 0===ub?null:ub;Yb=void 0===Yb?null:Yb;Ca=void 0===Ca?null:Ca;tb=void 0===tb?null:tb;return Object(te.a)(new Ce.a,{MenuSectionList:this.Gbc.Tef(eb,bb,Rb,Q,Ia,ub,
Yb,Ca,tb),UpdateDynamically:!0})}cif(eb,bb,Rb,Q){return this.Gbc.Chi(eb,bb,Rb,Q)}D4h(eb,bb,Rb,Q,Ia,ub){return this.Gbc.Uef(eb,void 0===bb?null:bb,void 0===Rb?null:Rb,void 0===Q?null:Q,void 0===Ia?null:Ia,void 0===ub?null:ub)}Qlc(eb,bb){return(void 0===bb?0:bb)?this.vs[eb]:this.hm[eb]}hph(){return new pe(this.$,this,this.moreColorsHelper,this.Cq)}}Object(d.a)(Dc,"PopulateDynamicHelper",null,[348]);class Wa extends X.a{constructor(eb,bb){super();this.pE=null;this.$=bb;eb.Qa(111,this);this.je()}create(){if(M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",
!1)||M.EwaSettings.Zn()){const eb=Ga.GetServiceTaskFactory.ud(this.$.ga,398,397,this.Ta),bb=Object(ba.d)(la.a.resolve(Z.Yc,{Ja:this.Ta}));H.TaskExtensions.za(H.TaskExtensions.Wf([eb,bb],this.ka),()=>{this.Ld(this.pE||(this.pE=new Dc(this.$,eb.result,bb.result)))},this.ka,3)}else H.TaskExtensions.za(Ga.GetServiceTaskFactory.ud(this.$.ga,398,397,this.Ta),eb=>{this.Ld(this.pE||(this.pE=new Dc(this.$,eb.result,null)))},this.ka,3)}}Object(d.a)(Wa,"PopulateDynamicHelperFactory",X.a,[]);var Qb=a(935);class Lc{constructor(eb,
bb,Rb,Q,Ia,ub,Yb,Ca,tb){this.YFe=bb;this.THe=void 0===Rb?null:Rb;this.BNe=void 0===Ia?null:Ia;this.Anf=void 0===ub?null:ub;this.EHf=void 0===Ca?null:Ca;this.pE=eb;this.menuId=void 0===tb?null:tb}c1(){let eb="";const bb=this.pE.D4h(this.YFe,this.THe,this.BNe,this.Anf,this.EHf,this.menuId);for(const Rb of bb)eb+=Rb;return eb}rH(){return this.pE.bkc(this.YFe,this.THe,this.BNe,this.Anf,void 0,void 0,void 0,this.EHf,this.menuId)}}Object(d.a)(Lc,"RibbonColorPicker",null,[366]);var Ba=a(577);class qa{constructor(eb,
bb){this._id=eb;this.hF=void 0===bb?"":bb}get id(){return this._id}get text(){return this.hF}get label(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Label property");}set label(eb){throw Error.notImplemented("RibbonLabel doesn't have set implementation for the Label property");}get alt(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Alt property");}get disabled(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Disabled property");
}c1(){return`<Label id="${this._id}" LabelText="${this.hF}" />`}xV(){throw Error.notImplemented("RibbonLabel doesn't have SetImage implementation ");}gUb(){throw Error.notImplemented("RibbonLabel doesn't have SetCustomizedImage implementation ");}g_(){throw Error.notImplemented("RibbonLabel doesn't have SetAlt implementation ");}gbc(){throw Error.notImplemented("RibbonLabel doesn't have ClearImage implementation ");}Ola(){return Object(te.a)(new Ba.a,{Id:this.id,LabelText:this.text})}}Object(d.a)(qa,
"RibbonLabel",null,[371,364,366]);class gb{constructor(eb){this.XMg=[];this.id=eb}get Ae(){return this.XMg}c1(){return Xd.q(this.rH())}rH(){const eb=Object(te.a)(new Ce.a,{Id:this.id,UpdateDynamically:!0,MenuSectionList:[]});for(const bb of this.Ae)Object(Ab.a)(Lc,bb)?eb.MenuSectionList.push(...Object(pb.a)(Lc,bb).rH().MenuSectionList):eb.MenuSectionList.push(bb.z$b());return eb}}Object(d.a)(gb,"RibbonMenu",null,[367,366]);class Bb{constructor(){this.title=null;this.U_=[];this.kt="Menu16";this.Nqg=
this.Alg=this.Blg=!0}get buttons(){return this.U_}c1(){return Xd.r(this.z$b())}z$b(){const eb=Object(te.a)(new Xb.a,{ControlList:[]});if(1===this.buttons.length&&Object(Ab.a)(363,this.buttons[0]))eb.ControlList.push(this.buttons[0].y$b());else{let Rb="";for(let Q=0;Q<this.buttons.length;Q++){var bb=Object(pb.a)(364,this.buttons[Q]);bb&&(bb=bb.Ola(),eb.ControlList.push(bb),Rb+=bb.Id)}eb.ControlsId=Rb+".Controls"}eb.Title=this.title;eb.DisplayMode=this.kt;eb.ShowMenuSectionTitleIcon=this.Blg;eb.ShowMenuSectionTitleBackground=
this.Alg;eb.MenuSectionTitleFocusable=this.Nqg;return eb}}Object(d.a)(Bb,"RibbonMenuSection",null,[365,366]);class ic{constructor(eb,bb,Rb,Q,Ia,ub,Yb,Ca,tb,$b,cd,sd,re){re=void 0===re?null:re;this.id=eb;this.command=Rb;this.HYf=Q;this.populateOnlyOnce=Ia;this.HVa=ub;this.smj=Yb;this.alt=Ca;this.O8b=tb;this.width=$b;this.y2g=cd;this.US=sd;this.Fva=new gb(bb);this.QGe=re;Q&&Yb&&(eb=new Bb,eb.kt="MenuLoading",bb=new qa(bb+"LoadingLabel"),eb.buttons.push(bb),this.menu.Ae.push(eb))}c1(){return this.$9g()}get menu(){return this.Fva}$9g(){let eb=
Xd.d(this.id,this.command,this.HYf,this.populateOnlyOnce,this.HVa,this.smj,this.alt,this.O8b,this.width);const bb=eb.indexOf(" />");eb=eb.substring(0,bb);eb+=` ${"AllowDefaultContent"}="${this.y2g.toString()}"`;eb+=` ${"AutoComplete"}="${this.US?"true":"false"}"`;this.QGe&&(eb+=` ${"ArrowImgId"}="${this.QGe}"`);eb=eb+">"+this.menu.c1();return eb+"</ComboBox>"}}Object(d.a)(ic,"RibbonComboBox",null,[374,366]);var Cc=a(1057),hd=a(936);class Pd extends hd.a{constructor(eb,bb,Rb,Q,Ia,ub,Yb,Ca,tb,$b,cd,
sd,re){sd=void 0===sd?null:sd;re=void 0===re?null:re;super(eb,bb,Rb,Ia,ub,Yb,Ca,cd,0);this.opb=null;this.J5=0===tb?null:Tb.a.instance.ia(tb);this.lYc=$b;this.i_c=Q;this.iRg=sd;this.Yo=re}get description(){return this.J5}get KCb(){return this.opb}get menuItemId(){return this.lYc}get HVa(){return this.i_c}get styles(){return this.iRg}get data(){return this.Yo}c1(){return Xd.n(this.Ola())}s0d(eb){this.J5=eb}toString(){this.KCb||(this.opb=this.c1());return this.KCb}Ola(){const eb=new Cc.a;this.iic(eb);
eb.MenuItemId=this.menuItemId;eb.QueryCommand=this.HVa;eb.Description=this.description;eb.Styles=this.styles;eb.Data=this.data;return eb}}Object(d.a)(Pd,"RibbonComboBoxItem",hd.a,[373,364,366]);var ue=a(576);class Ee extends hd.a{constructor(eb,bb,Rb,Q,Ia,ub,Yb,Ca){super(eb,Rb,Q,Ia,ub,Yb,Ca,!1,0);this.populateOnlyOnce=!1;this.ZJb=this.menuCloseCommand=this.menuOpenCommand=this.xz=null;this.Fva=new gb(bb);this.Iof=!0}get menu(){return this.Fva}c1(){return Xd.o(this.Ola())}Ola(){const eb=new ue.a;this.iic(eb);
eb.PopulateOnlyOnce=this.populateOnlyOnce;eb.MenuCloseCommand=null==this.menuCloseCommand?null:this.menuCloseCommand.toString();eb.MenuOpenCommand=null==this.menuOpenCommand?null:this.menuOpenCommand.toString();eb.PopulateQueryCommand=this.xz;eb.KeyTip=this.ZJb;eb.Menu=this.menu.rH();eb.ImageIsVisible=this.Iof;return eb}}Object(d.a)(Ee,"RibbonFlyoutAnchor",hd.a,[372,364,366]);var Se=a(1229),cf=a(596);class mf{constructor(){this.o9a=[];this.id=null;this.width=0;this.title=this.Vma=null}c1(){return Xd.p(this.y$b())}Kv(eb,
bb,Rb,Q,Ia,ub,Yb,Ca,tb,$b){Q=void 0===Q?0:Q;Ia=void 0===Ia?null:Ia;ub=void 0===ub?null:ub;Yb=void 0===Yb?null:Yb;Ca=void 0===Ca?null:Ca;$b=void 0===$b?null:$b;this.jqf(this.o9a.length,eb,bb,Rb,0===Q?void 0===tb?null:tb:Tb.a.instance.ia(Q),Ia,ub,Yb,Ca,$b)}jqf(eb,bb,Rb,Q,Ia,ub,Yb,Ca,tb,$b){ub=void 0===ub?null:ub;Yb=void 0===Yb?null:Yb;Ca=void 0===Ca?null:Ca;tb=void 0===tb?null:tb;$b=void 0===$b?null:$b;(eb>this.o9a.length||0>eb)&&Error.argumentOutOfRange("Invalid Index");this.o9a.splice(eb,0,Object(te.a)(new Se.a,
{Id:bb,Command:Rb.toString(),QueryCommand:null!==Q&&void 0!==Q?Q:null,Alt:Ia,MenuItemId:ub,Icon:Yb,Image:Ca?vc.a.Ci(Ca):null,ImageClass:tb,LabelText:$b}))}y$b(eb){eb=void 0===eb?!1:eb;let bb=null,Rb=null;switch(this.Vma){case "Size120by20":bb=this.pwb(120,20,eb);Rb=this.nwb(130,30,eb);break;case "Size90by21":bb=this.pwb(90,21,eb);Rb=this.nwb(100,33,eb);break;case "Size24by24With7Options":bb=this.pwb(24,24,eb);Rb=this.nwb(34,34,eb);break;case "Size24by24":bb=this.pwb(28,28,eb);Rb=this.nwb(38,38,eb);
break;case "Size112by64":bb=this.pwb(24,24,eb),Rb=this.nwb(112,64,eb)}for(eb=0;eb<this.o9a.length;eb++)this.o9a[eb].FullIconStyle=bb;return Object(te.a)(new cf.a,{Id:this.id,ExternalId:this.id,Type:4,Title:this.title,Width:this.width,ElementDimensions:this.Vma,GalleryItems:this.o9a,GalleryStyle:Rb})}pwb(eb,bb,Rb){const Q={},Ia={};Ia.width=eb;Ia.height=bb;Rb&&(Ia.alignSelf="center",Ia.marginBottom="4px");Q.root=Ia;return Q}nwb(eb,bb,Rb){const Q={},Ia={},ub={};ub.width=eb;ub.height=bb;Ia.root=ub;Rb&&
(Ia.flexContainer={display:"flex",flexDirection:"column",alignItems:"stretch"});Q.galleryButtonInExpanded=Ia;return Q}}Object(d.a)(mf,"RibbonGallery",null,[363,366]);var ac=a(1048);class bd{constructor(eb){this.pE=void 0===eb?null:eb}ft(eb){return new gb(void 0===eb?null:eb)}Ne(){return new Bb}od(eb){var bb=ob.a.kf(bd.q5a,eb.toString());if(bb)return bb;switch(eb){case 236:return this.fp(eb,"ContextMenu.Show.IdeasNLPane",-1336341324,743);case 237:return this.fp(eb,"ContextMenu.Show.IdeasNLPane",-1336341324,
744);case 238:return this.fp(eb,"ContextMenu.Show.IdeasNLPane",-1336341324,745);case 249:return this.Ve(eb,"ContextMenu.Show.ChartTaskPane",1221897806,ra.a.h4e,4,983);case 287:return this.Ve(eb,"ContextMenu.Show.ChartTaskPaneData",1930653487,null,4,890,void 0,void 0,"ChartSourceData_20");case 141:return this.pk(eb,"DataLabels.None.BoxWhisker",374300079,ra.a.Q3e,929,930,1600);case 0:return this.pk(eb,"DataLabels.None.Column",374300079,ra.a.P3e,929,930,1600);case 1:return this.pk(eb,"DataLabels.None.Line",
374300079,ra.a.R3e,929,930,1600);case 2:return this.pk(eb,"DataLabels.None.Pie",374300079,ra.a.S3e,929,930,1600);case 3:return this.pk(eb,"DataLabels.Show.Column",-1809877936,ra.a.khc,931,932,1601);case 143:return this.pk(eb,"DataLabels.Show.Funnel",-1809877936,ra.a.khc,931,934,1601);case 144:return this.pk(eb,"DataLabels.Show.Treemap",-1809877936,ra.a.wkd,931,938,1601);case 145:return this.pk(eb,"DataLabels.Show.Sunburst",-1809877936,ra.a.vkd,931,934,1601);case 4:return this.pk(eb,"DataLabels.Center.Column",
-1996266048,ra.a.khc,933,934,1602);case 5:return this.pk(eb,"DataLabels.Center.Line",-1996266048,ra.a.K3e,933,934,1602);case 6:return this.pk(eb,"DataLabels.Center.Pie",-1996266048,ra.a.vkd,933,934,1602);case 7:return this.pk(eb,"DataLabels.InsideEnd.Column",493396546,ra.a.L3e,935,936,1603);case 8:return this.pk(eb,"DataLabels.InsideEnd.Pie",493396546,ra.a.M3e,935,936,1603);case 9:return this.pk(eb,"DataLabels.InsideBase.Column",1599247052,ra.a.wkd,937,938,1604);case 10:return this.pk(eb,"DataLabels.OutsideEnd.Column",
342855531,ra.a.T3e,939,940,1605);case 11:return this.pk(eb,"DataLabels.OutsideEnd.Pie",342855531,ra.a.U3e,939,940,1605);case 140:return this.pk(eb,"DataLabels.Left.BoxWhisker",-472675112,ra.a.O3e,941,942,1606);case 12:return this.pk(eb,"DataLabels.Left.Line",-472675112,ra.a.N3e,941,942,1606);case 142:return this.pk(eb,"DataLabels.Right.BoxWhisker",-1774499423,ra.a.W3e,943,944,1607);case 13:return this.pk(eb,"DataLabels.Right.Line",-1774499423,ra.a.V3e,943,944,1607);case 138:return this.pk(eb,"DataLabels.Above.BoxWhisker",
-204160914,ra.a.G3e,945,946,1608);case 14:return this.pk(eb,"DataLabels.Above.Line",-204160914,ra.a.X3e,945,946,1608);case 139:return this.pk(eb,"DataLabels.Below.BoxWhisker",-87783054,ra.a.H3e,947,948,1609);case 15:return this.pk(eb,"DataLabels.Below.Line",-87783054,ra.a.J3e,947,948,1609);case 16:return this.pk(eb,"DataLabels.BestFit.Pie",1650379138,ra.a.I3e,949,950,1610);case 17:return this.pk(eb,"Axes.Horizontal.None",895828731,ra.a.v3e,929,951,1613);case 18:return this.pk(eb,"Axes.Horizontal.ShowLTR",
683614408,ra.a.tkd,952,953,1614);case 19:return this.pk(eb,"Axes.Horizontal.NoLabels",-1612014670,ra.a.u3e,956,957,1615);case 20:return this.pk(eb,"Axes.Horizontal.ShowRTL",1259259728,ra.a.w3e,958,959,1616);case 21:return this.pk(eb,"Axes.Horizontal.Default",683614408,ra.a.tkd,954,955,1617);case 22:return this.pk(eb,"Axes.Horizontal.Thousands",-220179662,ra.a.x3e,960,961,1618);case 23:return this.pk(eb,"Axes.Horizontal.Millions",1534680966,ra.a.t3e,962,963,1619);case 24:return this.pk(eb,"Axes.Horizontal.Billions",
-238895611,ra.a.r3e,964,965,1620);case 25:return this.pk(eb,"Axes.Horizontal.LogScale",-892714755,ra.a.s3e,966,967,1621);case 26:return this.pk(eb,"Axes.Vertical.None",2006508979,ra.a.C3e,929,951,1613);case 27:return this.pk(eb,"Axes.Vertical.Default",252405382,ra.a.E3e,954,955,1617);case 28:return this.pk(eb,"Axes.Vertical.Thousands",670842692,ra.a.F3e,960,961,1618);case 29:return this.pk(eb,"Axes.Vertical.Millions",-572426128,ra.a.A3e,962,963,1619);case 30:return this.pk(eb,"Axes.Vertical.Billions",
-806496391,ra.a.y3e,964,965,1620);case 31:return this.pk(eb,"Axes.Vertical.LogScale",-1700998151,ra.a.z3e,966,967,1621);case 32:return this.pk(eb,"Axes.Vertical.NoLabels",2104548628,ra.a.B3e,956,957,1615);case 33:return this.pk(eb,"Axes.Vertical.ShowRTL",1717508862,ra.a.D3e,958,959,1616);case 34:return this.pk(eb,"Gridlines.Horizontal.None",80515665,ra.a.b4e,929,970,1624);case 35:return this.pk(eb,"Gridlines.Horizontal.Major",-306129902,ra.a.Z3e,972,973,1625);case 36:return this.pk(eb,"Gridlines.Horizontal.Minor",
2147076534,ra.a.$3e,975,976,1626);case 37:return this.pk(eb,"Gridlines.Horizontal.MajorMinor",-1253752845,ra.a.a4e,978,979,1627);case 38:return this.pk(eb,"Gridlines.Vertical.None",1711257557,ra.a.g4e,929,971,1624);case 39:return this.pk(eb,"Gridlines.Vertical.Major",-1772953364,ra.a.d4e,972,974,1625);case 40:return this.pk(eb,"Gridlines.Vertical.Minor",680253336,ra.a.e4e,975,977,1626);case 41:return this.pk(eb,"Gridlines.Vertical.MajorMinor",-215161981,ra.a.f4e,978,980,1627);case 135:return this.Ve(eb,
"ContextMenu.NumberFormating",2105621672,ra.a.kkd,1,476,135!==eb);case 300:return this.Ve(eb,"ContextMenu.FormatCells",2055979337,null,1,477,300!==eb,void 0,"PaintBrushandBucket_20");case 136:return this.Ve(eb,"ContextMenu.NumberFormatingApplyToPivotField",-168056295,ra.a.kkd,1,476,136!==eb);case 42:return this.Ve(eb,"ContextMenu.Cut",-1985798686,ra.a.T2e,1,12);case 43:return this.Ve(eb,"ContextMenu.Copy",-911352779,ra.a.S2e,1,11);case 212:return this.Ve(eb,"ContextMenu.InsertCopiedCells",-160032004,
ra.a.Nkd,3,15);case 213:return this.Ve(eb,"ContextMenu.InsertCutCells",-1065525230,ra.a.Nkd,3,21);case 44:case 57:return this.Ve(eb,"ContextMenu.Paste",237279923,ra.a.okd,1,13,44!==eb,"Paste");case 248:return this.Ve(eb,"PasteAdvancedOptionsGallery",237279923,ra.a.okd,1,13,44!==eb,"Paste");case 45:case 120:return this.Ve(eb,"ContextMenu.EditHyperlink",-1583422759,ra.a.Ckd,8,1140,45!==eb,"EditHyperlink");case 46:case 121:return this.Ve(eb,"ContextMenu.InsertHyperlink",-1583422759,ra.a.Ckd,8,1141,46!==
eb,"InsertHyperlink");case 47:case 122:return this.Ve(eb,"ContextMenu.RemoveHyperlink",-1253126584,ra.a.Fkd,8,1142,47!==eb,"RemoveHyperlink");case 48:case 123:return this.Ve(eb,"ContextMenu.RemoveHyperlinks",-1253126584,ra.a.Fkd,8,1143,48!==eb,"RemoveHyperlinks");case 250:return this.fp(eb,"ContextMenu.ContextMenuSmartLookup",-983891024,1810);case 187:case 188:case 165:case 173:return this.Ve(eb,"ContextMenu.InsertCellsShiftRight",1035996630,ra.a.b3e,1,165===eb||173===eb?341:342,173===eb||188===eb,
"InsertCellsShiftRight");case 166:case 174:return this.Ve(eb,"ContextMenu.InsertCellsShiftDown",1035996630,ra.a.a3e,1,344,166!==eb,"InsertCellsShiftDown");case 189:case 190:case 167:case 175:return this.Ve(eb,"ContextMenu.DeleteCellsShiftLeft",1035996630,ra.a.W2e,1,167===eb||175===eb?342:341,175===eb||190===eb,"DeleteCellsShiftLeft");case 168:case 176:return this.Ve(eb,"ContextMenu.DeleteCellsShiftUp",1035996630,ra.a.X2e,1,343,168!==eb,"DeleteCellsShiftUp");case 177:case 181:return this.Ve(eb,"ContextMenu.InsertRowsSheet",
-1113896058,ra.a.lkd,1,429,177!==eb,"InsertRows");case 49:case 116:return this.Ve(eb,"ContextMenu.InsertRows",-1113896058,ra.a.lkd,1,346,49!==eb,"InsertRows");case 161:case 169:return this.Ve(eb,"ContextMenu.InsertRowsTable",942362098,ra.a.d3e,1,421,161!==eb,"InsertRowsTable");case 50:case 117:return this.Ve(eb,"ContextMenu.InsertColumns",1415868706,ra.a.lBb,1,406,50!==eb,"InsertColumns");case 288:case 289:return this.Ve(eb,"ContextMenu.InsertColumns",1415868706,ra.a.lBb,1,408,288!==eb,"InsertColumns");
case 178:case 182:return this.Ve(eb,"ContextMenu.InsertColumnsSheet",1415868706,ra.a.lBb,1,426,178!==eb,"InsertColumns");case 290:case 291:return this.Ve(eb,"ContextMenu.InsertColumnsSheet",1415868706,ra.a.lBb,1,428,290!==eb,"InsertColumns");case 191:case 192:case 162:case 170:return this.Ve(eb,"ContextMenu.InsertColumnsTable",622604322,ra.a.c3e,1,162===eb||170===eb?419:420,170===eb||192===eb,"InsertColumnsTable");case 179:case 183:return this.Ve(eb,"ContextMenu.DeleteRowsSheet",1554436520,ra.a.hhc,
1,429,179!==eb,"DeleteRows");case 51:case 118:return this.Ve(eb,"ContextMenu.DeleteRows",1554436520,ra.a.hhc,1,410,51!==eb,"DeleteRows");case 163:case 171:return this.Ve(eb,"ContextMenu.DeleteRowsTable",1405456548,ra.a.hhc,1,418,163!==eb,"DeleteRowsTable");case 180:case 184:return this.Ve(eb,"ContextMenu.DeleteColumnsSheet",674605324,ra.a.ghc,1,426,180!==eb,"DeleteColumns");case 52:case 119:return this.Ve(eb,"ContextMenu.DeleteColumns",674605324,ra.a.ghc,1,411,52!==eb,"DeleteColumns");case 164:case 172:return this.Ve(eb,
"ContextMenu.DeleteColumnsTable",284490184,ra.a.ghc,1,417,164!==eb,"DeleteColumnsTable");case 53:case 124:return this.fp(eb,"ContextMenu.OpenHyperlink",-1396319072,1144,53!==eb,"OpenHyperlink");case 263:return this.Ve(eb,"SheetOpsContextMenu.ShowChanges",1834994092,ra.a.Gkd,8,443,void 0,ka.a.r_j);case 264:return this.Ve(eb,"GridContextMenu.ZoomFitToScreen",1409187195,null,8,1154,void 0,void 0,"FitToScreen_16");case 265:return this.Ve(eb,"GridContextMenu.ZoomFitToScreenUndo",-1836771825,null,8,1155,
void 0,void 0,"RevertZoom_16");case 262:return this.Ve(eb,"GridContextMenu.ShowChanges",1834994092,ra.a.Gkd,8,443,void 0,ka.a.Zjg);case 54:return this.Ve(eb,"ContextMenu.InsertSheet",-1935155518,ra.a.e3e,1,514);case 56:case 127:return this.Ve(eb,"ContextMenu.DeleteSheet",1880294140,ra.a.Z2e,1,515,56!==eb,"DeleteSheet");case 55:return this.fp(eb,"ContextMenu.RenameSheet",817296323,516);case 125:case 126:return this.fp(eb,"ContextMenu.ReorderSheet",-383100692,517,125!==eb,"ReorderSheet");case 158:return this.fp(eb,
"ContextMenu.DuplicateSheet",-1254662242,441);case 112:case 114:return this.fp(eb,"ContextMenu.HideSheet",1458540255,519,112!==eb,"HideSheet");case 113:case 115:return this.fp(eb,"ContextMenu.UnhideSheet",1129633328,520,113!==eb,"UnhideSheet");case 277:return this.Ve(eb,"ContextMenu.ManageProtection",1723441034,null,8,1995,void 0,void 0,"ProtectSheet_20");case 278:return this.Ve(eb,"ContextMenu.PauseProtection",-278145964,null,8,1996,void 0,void 0,"UnlockVariant_20");case 279:return this.Ve(eb,"ContextMenu.ResumeProtection",
-278145964,null,8,1998,void 0,void 0,"ProtectForm_20");case 242:return this.fp(eb,"ContextMenu.PivotExpandCollapse",589118293,1167);case 243:return this.Ve(eb,"ContextMenu.PivotExpand",-1687560254,ra.a.qkd,9,1168);case 244:return this.Ve(eb,"ContextMenu.PivotCollapse",1176256599,ra.a.pkd,9,1169);case 245:return this.Ve(eb,"ContextMenu.PivotExpandEntireField",-1751201991,ra.a.qkd,9,1170);case 246:return this.Ve(eb,"ContextMenu.PivotCollapseEntireField",-232434744,ra.a.pkd,9,1171);case 247:return this.Ve(eb,
"ContextMenu.PivotShowDetails",1771091375,null,17,1172,void 0,void 0,"PivotShowDetails_20");case 301:return this.Ve(eb,"ContextMenu.DeletePivotTable",1885005049,null,17,2292,void 0,void 0,W.a.dlj);case 306:return this.Ve(eb,"ContextMenu.ManualUngroup",-1683649734,null,17,2347,void 0,void 0);case 307:return this.Ve(eb,"ContextMenu.ManualGroup",660506187,null,17,2346,void 0,void 0);case 59:return this.Ve(eb,"ContextMenu.PivotFieldListShow",2140436015,ra.a.rkd,9,1173);case 58:return this.Ve(eb,"ContextMenu.PivotFieldListHide",
-1006032470,ra.a.rkd,9,1174);case 258:return this.Ve(eb,"ContextMenu.PivotSettingsPaneShow",1529441790,ra.a.nBb,17,636);case 257:return this.Ve(eb,"ContextMenu.PivotSettingsPaneHide",1529441790,ra.a.nBb,17,637);case 259:return this.fp(eb,"ContextMenu.PivotTableNoSubtotal",-2016405815,638);case 260:return this.fp(eb,"ContextMenu.PivotTableSubtotalOnTop",671485366,639);case 261:return this.fp(eb,"ContextMenu.PivotTableSubtotalOnBottom",772221736,640);case 60:case 64:return bb=60!==eb,this.fp(eb,bb?
"ContextMenu.FieldWellMoveUpDisabled":"ContextMenu.FieldWellMoveUp",-1170196828,1089,bb,null);case 61:case 65:return bb=61!==eb,this.fp(eb,bb?"ContextMenu.FieldWellMoveDownDisabled":"ContextMenu.FieldWellMoveDown",-889576107,1090,bb,null);case 62:case 66:return bb=62!==eb,this.fp(eb,bb?"ContextMenu.FieldWellMoveToBeginningDisabled":"ContextMenu.FieldWellMoveToBeginning",389774337,1091,bb,null);case 63:case 67:return bb=63!==eb,this.fp(eb,bb?"ContextMenu.FieldWellMoveToEndDisabled":"ContextMenu.FieldWellMoveToEnd",
2033235475,1092,bb,null);case 68:case 72:return bb=68!==eb,this.Ve(eb,bb?"ContextMenu.FieldWellMoveToReportFilterDisabled":"ContextMenu.FieldWellMoveToReportFilter",-96230454,ra.a.chc,9,1093,bb,null);case 69:case 73:return bb=69!==eb,this.Ve(eb,bb?"ContextMenu.FieldWellMoveToRowLabelsDisabled":"ContextMenu.FieldWellMoveToRowLabels",74086617,ra.a.B8a,9,1094,bb,null);case 70:case 74:return bb=70!==eb,this.Ve(eb,bb?"ContextMenu.FieldWellMoveToColumnLabelsDisabled":"ContextMenu.FieldWellMoveToColumnLabels",
1529312473,ra.a.A8a,9,1095,bb,null);case 71:case 75:return bb=71!==eb,this.Ve(eb,bb?"ContextMenu.FieldWellMoveToValuesDisabled":"ContextMenu.FieldWellMoveToValues",563292088,ra.a.dhc,9,1098,bb,null);case 76:return this.Ve(eb,"ContextMenu.FieldWellRemoveField",-1092351914,ra.a.U2e,9,1099);case 77:return this.Ve(eb,"ContextMenu.FieldWellValueFieldSettings",-2141589616,ra.a.q3e,9,1100);case 79:case 83:return this.Ve(eb,"ContextMenu.FieldListMoveToReportFilter",359279088,ra.a.chc,9,1082,79!==eb,null);
case 80:case 84:return this.Ve(eb,"ContextMenu.FieldListMoveToRowLabels",-67292059,ra.a.B8a,9,1083,80!==eb,null);case 81:case 85:return this.Ve(eb,"ContextMenu.FieldListMoveToColumnsLabels",745182485,ra.a.A8a,9,1084,81!==eb,null);case 82:case 86:return this.Ve(eb,"ContextMenu.FieldListMoveToValues",926905850,ra.a.dhc,9,1087,82!==eb,null);case 95:case 97:return bb=95!==eb,this.Ve(eb,bb?"ContextMenu.FieldWellMoveToRowChartLabelsDisabled":"ContextMenu.FieldWellMoveToRowChartLabels",74086617,ra.a.B8a,
9,1096,bb,null);case 96:case 98:return bb=96!==eb,this.Ve(eb,bb?"ContextMenu.FieldWellMoveToColumnChartLabelsDisabled":"ContextMenu.FieldWellMoveToColumnChartLabels",1529312473,ra.a.A8a,9,1097,bb,null);case 78:return this.Ve(eb,"ContextMenu.FieldListAddAsSlicer",547535945,ra.a.hkd,9,1088);case 91:case 93:return this.Ve(eb,"ContextMenu.FieldListMoveToRowChartLabels",-67292059,ra.a.B8a,9,1085,91!==eb,null);case 92:case 94:return this.Ve(eb,"ContextMenu.FieldListMoveToColumnChartLabels",745182485,ra.a.A8a,
9,1086,92!==eb,null);case 99:return this.Ve(eb,"ContextMenu.BIExploreShowCallout",1529658657,ra.a.ehc,9,1193);case 100:return this.Ve(eb,"ContextMenu.ContextMenuRefresh",2054778433,ra.a.l3e,9,1181);case 102:return this.Ve(eb,"ContextMenu.EditCell",324156914,ra.a.Ekd,8,579);case 101:return this.Ve(eb,"Contextenu.DeleteChart",2045211913,ra.a.Akd,8,578);case 146:return this.Ve(eb,"Contextenu.AltText",1804967129,ra.a.Bkd,8,817);case 302:return this.Ve(eb,"ContextMenu.CellImageAltText",1516436924,ra.a.Bkd,
8,817);case 147:return this.Ve(eb,"ContextMenu.EditShapeText",-445658892,ra.a.q4e,8,818);case 186:return this.Ve(eb,"ContextMenu.ExitEditShapeText",1166778132,null,8,819);case 281:return this.Ve(eb,"ContextMenu.BringForward",-1024854261,null,8,820,!1,"ContextMenu.BringForward",W.a.bringForward);case 282:return this.Ve(eb,"ContextMenu.BringToFront",-1480025782,null,8,822,!1,"ContextMenu.BringToFront",W.a.bringToFront);case 283:return this.Ve(eb,"ContextMenu.SendBackWard",565697619,null,8,821,!1,"ContextMenu.SendBackWard",
W.a.sendBackward);case 284:return this.Ve(eb,"ContextMenu.SendToBack",-884976206,null,8,823,!1,"ContextMenu.SendToBack",W.a.sendToBack);case 273:return this.Ve(eb,"ContextMenu.OfficeScriptsViewScript",-585097204,ra.a.N2e,8,2151);case 160:return this.Ve(eb,"ContextMenu.InsertComment",-1667294294,ra.a.s4e,8,1146);case 221:return this.Ve(eb,"ContextMenu.DeleteComment",467845448,ra.a.p4e,8,1162);case 159:return this.Ve(eb,"ContextMenu.InsertReply",-1667294294,ra.a.t4e,8,1145);case 226:return this.Ve(eb,
"ContextMenu.NewNote",2041505397,null,8,1156,void 0,void 0,"AddNoteboardNote_20");case 227:return this.Ve(eb,"ContextMenu.EditNote",2041505397,null,8,1157,void 0,void 0,"EditNote_20");case 228:return this.Ve(eb,"ContextMenu.DeleteNote",-865270283,null,8,1158,void 0,void 0,"DeleteNote_20");case 229:return this.Ve(eb,"ContextMenu.ShowOrHideNote",1627476102,null,8,1159,void 0,void 0,"OLNoteYellow_20");case 230:return this.fp(eb,"ContextMenu.ConvertNote",-1565161385,1161);case 103:return this.xX(eb,"Form.InsertForm",
1305810481,ra.a.nkd,1,"Image16by16",1267,0,null,!1,1595);case 107:return this.xX(eb,"Form.ViewForm",330035228,ra.a.nkd,1,"Image16by16",1269,0,null,!1,1596);case 104:return this.xX(eb,"Form.EditForm",1305810481,ra.a.$2e,1,"Image16by16",1268,0,null,!1,1597);case 105:return this.xX(eb,"Form.DeleteForm",-509039657,ra.a.V2e,1,"Image16by16",1270,0,null,!1,1598);case 106:return this.xX(eb,"Form.ShareForm",1334518759,ra.a.m3e,1,"Image16by16",1271,0,null,!1,1599);case 148:case 149:return this.fp(eb,"ContextMenu.ClearContent",
-848953656,445,148!==eb);case 150:case 151:return this.Ve(eb,"ContextMenu.RowHeight",2040891415,ra.a.u4e,8,434,151===eb);case 152:case 153:return this.Ve(eb,"ContextMenu.ColumnWidth",957527587,ra.a.o4e,8,433,153===eb);case 108:case 154:return this.fp(eb,"ContextMenu.HideRows",1051390410,432,154===eb);case 110:case 156:return this.fp(eb,"ContextMenu.UnhideRows",1542466017,439,156===eb);case 109:case 155:return this.fp(eb,"ContextMenu.HideColumns",-706918724,438,155===eb);case 111:case 157:return this.fp(eb,
"ContextMenu.UnhideColumns",369708605,440,157===eb);case 216:return this.fp(eb,"ContextMenu.ShowCard",-843616717,1786,216!==eb);case 217:return this.fp(eb,"ContextMenu.ShowImageDetails",-843616717,1787);case 303:return this.Ve(eb,"ContextMenu.PlaceInCell",-700002548,null,8,2300,void 0,void 0,"PictureInCell_20");case 304:return this.Ve(eb,"ContextMenu.PlaceOverCell",2000316912,null,8,2301,void 0,void 0,"InsertPictureSimple_20");case 305:return this.Ve(eb,"ContextMenu.CreateReference",1983877126,null,
8,2302,void 0,void 0,"PictureLinked_20");case 215:case 268:return this.fp(eb,"ContextMenu.ConvertLinkedEntityToText",311599363,1784,268===eb);case 218:case 269:return this.fp(eb,"ContextMenu.RefreshLinkedEntities",439914789,1788,269===eb);case 220:case 271:return this.fp(eb,"ContextMenu.ShowLinkedEntityRefreshPane",-1753056834,1785,271===eb);case 219:case 270:return this.fp(eb,"ContextMenu.ChangeLinkedEntityObject",2127195269,1796,270===eb);case 234:return this.Ve(eb,"ContextMenu.FilterClear",-1977666927,
null,1,220,void 0,void 0,"DeleteFilter_20");case 235:return this.Ve(eb,"ContextMenu.FilterReapply",1549396389,null,1,221,void 0,void 0,"XLReapplyFilter_20");case 233:return this.Ve(eb,"ContextMenu.FilterByValue",1803952894,null,1,222);case 223:return this.Ve(eb,"ContextMenu.SortAscending",-1010737776,ra.a.o3e,1,228);case 292:return this.fp(eb,"ContextMenu.PutSelectedCellColorOnTop",-1032691499,230);case 293:return this.fp(eb,"ContextMenu.PutSelectedFontColorOnTop",-764711886,231);case 294:return this.fp(eb,
"ContextMenu.PutSelectedFormattingIconOnTop",-2016161444,232);case 224:return this.Ve(eb,"ContextMenu.SortDescending",2123420468,ra.a.p3e,1,229);case 225:return this.Ve(eb,"ContextMenu.SortCustom",-207540907,ra.a.jhc,1,233);case 232:return this.Ve(eb,"ContextMenu.ConvertToRange",323142015,ra.a.R2e,1,740);case 272:return this.Ve(eb,"ContextMenu.ShowOpenInAppDialogOnMobile",213236505,ra.a.Ekd,8,661);case 239:return this.Ve(eb,"ContextMenu.IgnoreError",886009118,ra.a.Dkd,8,2112,239!==eb);case 240:return this.Ve(eb,
"ContextMenu.IgnoreErrors",886009118,ra.a.Dkd,8,2113,240!==eb);case 241:return this.fp(eb,"ContextMenu.ShowError",-1779556985,2114,241!==eb);case 251:return this.Ve(eb,"ContextMenu.SlicerRefresh",-231711729,ra.a.k3e,0,2177,251!==eb);case 252:return this.Ve(eb,"ContextMenu.SlicerClearFilter",-1909381757,ra.a.Y2e,0,2178,252!==eb);case 254:return this.fp(eb,"ContextMenu.SlicerDelete",2045211913,2181,254!==eb);case 253:return this.Ve(eb,"ContextMenu.SlicerMultiSelect",2108047455,ra.a.mkd,0,2180,253!==
eb);case 255:return this.Ve(eb,"ContextMenu.SlicerSortAscending",-923375148,ra.a.lhc,8,2183,255!==eb);case 256:return this.Ve(eb,"ContextMenu.SlicerSortDescending",1164937340,ra.a.mhc,8,2182,256!==eb);case 267:return this.Ve(eb,"ContextMenu.SlicerSettingsPaneShow",522377926,ra.a.nBb,17,636);case 266:return this.Ve(eb,"ContextMenu.SlicerSettingsPaneHide",522377926,ra.a.nBb,17,637);case 128:return this.Yxa(eb,-619033944,1,1438);case 129:return this.Yxa(eb,-619033944,2,1440);case 130:return this.Yxa(eb,
-619033944,3,1442);case 131:return this.Yxa(eb,-619033944,4,1443);case 132:return this.x7(eb,-1736601456,7,1447);case 133:return this.x7(eb,-1736601456,8,1449);case 134:return this.x7(eb,-1736601456,0,1450);case 196:return this.Yxa(eb,-2136556471,1,1438);case 198:return this.Yxa(eb,-2136556471,2,1440);case 200:return this.Yxa(eb,-2136556471,3,1442);case 201:return this.Yxa(eb,-2136556471,4,1443);case 204:return this.x7(eb,1201641489,0,1447);case 205:return this.x7(eb,1201641489,1,1448);case 206:return this.x7(eb,
1201641489,7,1449);case 207:return this.x7(eb,1201641489,2,1450);case 208:return this.x7(eb,1201641489,4,1451);case 209:return this.x7(eb,1201641489,3,1452);case 210:return this.x7(eb,1201641489,5,1453);case 211:return this.x7(eb,1201641489,6,1454);case 274:return this.Ve(eb,"ContextMenu.ShareChart",353606613,null,1,2261,void 0,void 0,"ShareSectionEntry_20");case 275:return this.Ve(eb,"ContextMenu.ShareRange",-1099009678,null,1,2262,void 0,void 0,"ShareSectionEntry_20");case 276:return this.Ve(eb,
"ContextMenu.ShareTable",192430811,null,1,2263,void 0,void 0,"ShareSectionEntry_20");case 299:return this.Ve(eb,"ContextMenu.ShareSheet",783415632,null,1,2264,void 0,void 0,"ShareSectionEntry_20");case 285:return this.Ve(eb,"ContextMenu.ToggleTotalRow",2128797448,null,1,741,void 0,void 0,"ToggleTotalRow_20");case 286:return this.Ve(eb,"ContextMenu.TableAltText",-723113214,null,1,817,void 0,void 0,"ShowTableAltTextDlg_20")}return null}xX(eb,bb,Rb,Q,Ia,ub,Yb,Ca,tb,$b,cd,sd){bb=new Qb.a(bb,Yb,Rb,null,
Ia,Q,ub,Yb,Ca,tb,$b,cd,!0,void 0===sd?null:sd);return bd.q5a[eb.toString()]=bb}Ve(eb,bb,Rb,Q,Ia,ub,Yb,Ca,tb){tb=void 0===tb?null:tb;return this.xX(eb,bb,Rb,tb?null:Q,Ia,"Image16by16",ub,0,void 0===Ca?null:Ca,void 0===Yb?!1:Yb,0,tb)}Oed(eb,bb,Rb,Q,Ia,ub){return new Pd(eb,0,-1006427574,null,Rb,bb,Q,0,0,Ia,!1,null,void 0===ub?null:ub)}lTe(eb,bb){return new qa(eb,void 0===bb?"":bb)}loh(eb,bb,Rb,Q){return new ac.a(eb,0,bb,null,8,null,"None",0,0,null,!1,0,Rb,Q)}lNa(eb,bb,Rb,Q,Ia,ub,Yb,Ca,tb){Ca=void 0===
Ca?null:Ca;tb=void 0===tb?!1:tb;let $b=ob.a.kf(bd.q5a,eb);if($b)return $b;$b=new Qb.a(eb,0,Rb,null,3,null,"None",0,0,ub,Yb,0);$b.g_(bb);$b.label=bb;$b.s0d(tb?null:bb);$b.gUb(Ia,Q,Ca);return bd.q5a[eb]=$b}VUd(eb){this.jzd(eb)&&delete bd.q5a[eb]}jzd(eb){return eb in bd.q5a}Vx(eb,bb,Rb,Q){eb=new Ee(eb,bb,0,Q,3,null,"None",0);eb.g_(Rb);eb.label=Rb;return eb}$dd(eb,bb,Rb,Q,Ia,ub){eb=new Ee(eb,bb,0,Q,Ia,ub,"Image16by16",0);eb.g_(Rb);eb.label=Rb;return eb}Wdd(eb,bb,Rb,Q,Ia){return new Lc(this.pE,eb,null,
null,void 0===bb?null:bb,null,void 0===Rb?null:Rb,void 0===Q?null:Q,void 0===Ia?null:Ia)}DF(eb,bb,Rb,Q){Rb=void 0===Rb?null:Rb;Q=void 0===Q?null:Q;return Object(te.a)(new mf,{id:eb,width:bb,Vma:Rb,title:Q})}pk(eb,bb,Rb,Q,Ia,ub,Yb){return this.xX(eb,bb,Rb,Q,4,"Image32by32",Ia,ub,null,!1,Yb)}fp(eb,bb,Rb,Q,Ia,ub){return this.xX(eb,bb,Rb,null,1,"None",Q,0,void 0===ub?null:ub,void 0===Ia?!1:Ia,0)}cSe(eb,bb,Rb,Q,Ia,ub){return this.xX(eb,bb,Rb,Q,4,"Image16by16",Ia,0,ub.toString(),!1,0)}x7(eb,bb,Rb,Q){return this.cSe(eb,
"OutlineDashStylePresent,"+Rb,bb,ra.a.fhc,Q,Rb)}Yxa(eb,bb,Rb,Q){return this.cSe(eb,"OutlineWidthPresent,"+Rb,bb,ra.a.ihc,Q,Rb)}}bd.q5a={};Object(d.a)(bd,"RibbonControlsManager",null,[350]);class nd extends X.a{constructor(eb){super();this.Ya=null;this.$=eb;this.je()}create(){var eb=this.$;const bb=Ga.GetServiceTaskFactory.create(eb.ga,111,this.ka,this.Ta);eb=M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(ba.d)(la.a.resolve(Z.z,{Ja:this.Ta})):Ga.GetServiceTaskFactory.create(eb.ga,
155,this.ka,this.Ta);H.TaskExtensions.za(H.TaskExtensions.Wf([bb,eb],this.ka),()=>{this.Ld(this.Ya||(this.Ya=new bd(bb.result)))},this.ka,3)}static la(eb){eb.ga.Qa(102,new nd(eb))}}Object(d.a)(nd,"RibbonControlsFactory",X.a,[]);var se=a(731),Ge=a(897);let Ve=class{constructor(eb){this.bDa=eb}$C(eb,bb){return this.bDa?this.bDa.$C(eb,bb).then(Rb=>{Rb.IsSuccess||f.ULS.sendTraceTag(51401292,0,15,"Error retrieving auth token. Message: "+Rb.ErrorMessage+" Error code: "+Rb.ErrorCode+" App name: "+eb);return Object(te.a)(new Ge.a,
{IsSuccess:Rb.IsSuccess,Token:Rb.Token,ErrorCode:Rb.ErrorCode,ErrorMessage:Rb.ErrorMessage})}):(f.ULS.sendTraceTag(537154971,0,10,"Oauth manager is null"),Promise.resolve(Object(te.a)(new Ge.a,{IsSuccess:!1,Token:null,ErrorCode:"FailedToResolve",ErrorMessage:"Failed to resolve IOAuthManager from the container."})))}Zab(){return this.bDa?this.bDa.Zab():null}};Ve=Object(se.a)([Object(la.d)(Z.Vb),Object(se.b)(0,Object(Z.Ub)())],Ve);Object(d.a)(Ve,"OAuthManagerWrapper",null,[308]);Object(la.b)(Z.Ub)(()=>
G.a.instance.resolve("Common.App.OAuth.IOAuthManager"));var df=a(191),pf=a(33);class kf{constructor(eb){this.keyPath=eb}}Object(d.a)(kf,"KeyPathClass",null,[]);let Af=class extends df.a{constructor(eb){super();this.Ikb=this.agd=null;this.wVe=1;this.b1a=null;this.$=eb}get indexedDBFactory(){this.b1a||(window.indexedDB?this.b1a=window.indexedDB:window.webkitIndexedDB?this.b1a=window.webkitIndexedDB:window.mozIndexedDB?this.b1a=window.mozIndexedDB:window.msIndexedDB&&(this.b1a=window.msIndexedDB));return this.b1a}get initialized(){return!!this.agd&&
!!this.Ikb}initialize(eb,bb,Rb){this.agd=eb;this.Ikb=bb;this.wVe=Rb}Vh(){try{return M.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&y.a.uSa||y.a.vh&&91===y.a.RBb?!1:!!this.indexedDBFactory&&"undefined"!==typeof this.indexedDBFactory.open}catch(eb){return f.ULS.sendTraceTag(537157640,0,15,`IndexedDB.IsSupported() failed. Exception: ${eb.message}`),!1}}mXa(eb){return this.Vh()&&this.initialized?H.TaskExtensions.v7(this.$Od(),bb=>{if(void 0===bb.result&&M.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash"))return!1;
bb=bb.result;this.$cc(bb);const Rb=pf.a.$b.og.m;this.Qsd(bb,!1).put(eb);f.ULS.sendTraceTag(537157638,0,50,`IndexedDB.SaveToIndexedDB takes ${pf.a.$b.og.m-Rb} Millisecond.`);return!0},this.ka):(f.ULS.sendTraceTag(537157639,0,15,"IndexedDB.SaveToIndexedDB: not supported or wasn't initilized."),fa.Task.Wa(!1))}Jgd(eb){return this.Vh()&&this.initialized?H.TaskExtensions.v7(this.$Od(),bb=>{if(void 0===bb.result&&M.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash"))return!1;
bb=bb.result;this.$cc(bb);const Rb=pf.a.$b.og.m;this.Qsd(bb,!1)["delete"](eb);f.ULS.sendTraceTag(537157636,0,50,`IndexedDB.DeleteFromIndexedDB takes ${pf.a.$b.og.m-Rb} Millisecond.`);return!0},this.ka):(f.ULS.sendTraceTag(537157637,0,15,"IndexedDB.DeleteFromIndexedDB: not supported or wasn't initilized."),fa.Task.Wa(!1))}OPa(eb){return this.Vh()&&this.initialized?H.TaskExtensions.smh(this.$Od(),bb=>void 0===bb.result&&M.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash")?
fa.Task.Wa(""):this.Z8h(bb.result,eb),this.ka):(f.ULS.sendTraceTag(537157635,0,15,"IndexedDB.DeleteFromIndexedDB: not supported or wasn't initilized."),fa.Task.Wa(""))}$cc(eb){eb.objectStoreNames.contains(this.Ikb)||eb.createObjectStore(this.Ikb,new kf("key"))}$Od(){const eb=new dd.a;let bb;bb=this.indexedDBFactory.open(this.agd,this.wVe);bb.onsuccess=()=>{const Rb=bb.result;f.ULS.sendTraceTag(537157634,0,50,`OpenIndexedDB ${Rb.name} success`);eb.setResult(Rb)};bb.onupgradeneeded=()=>{const Rb=bb.result;
f.ULS.sendTraceTag(520902218,0,50,`OpenIndexedDB ${Rb.name} upgrade needed`);try{this.$cc(Rb),f.ULS.sendTraceTag(520902217,0,50,`OpenIndexedDB ${Rb.name} upgrade done`)}catch(Q){f.ULS.sendTraceTag(520902216,0,10,`OpenIndexedDB upgrade failed: ${Q}`),M.EwaSettings.isChangeGateEnabled("OfficeVSO:6463223_Bug6241905")?eb.setResult(void 0):eb.setException(Error.create("Failed to upgrade IndexedDB"))}};bb.onerror=Rb=>{f.ULS.sendTraceTag(588288084,0,50,`OpenIndexedDB ${Rb} failed`);eb.setResult(void 0)};
return eb.task}Qsd(eb,bb){return eb.transaction([this.Ikb],bb?"readonly":"readwrite").objectStore(this.Ikb)}Z8h(eb,bb){const Rb=new dd.a;this.$cc(eb);const Q=pf.a.$b.og.m,Ia=this.Qsd(eb,!0).get(bb);Ia.onsuccess=ub=>{(ub=ub.target.result)?(Rb.setResult(ub.value),f.ULS.sendTraceTag(537157633,0,50,`IndexedDB.GetFromIndexedDB takes ${pf.a.$b.og.m-Q} Millisecond.`)):Rb.setResult("")};Ia.onerror=()=>{Rb.setException(Error.create(Ia.error?Ia.error.message:"DB error"))};return Rb.task}};Af=Object(se.a)([Object(la.d)(Z.Cb,
{yt:"transient"}),Object(se.b)(0,Object(Z.W)())],Af);Object(d.a)(Af,"IndexedDB",df.a,[307]);Type.registerNamespace("Common.App.OAuth");J.main();I.a.Dk(".ewa-svg-icon{height:100%;width:100%}");R.a.Ga(na.la);I.a.Dk('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}');
(()=>{R.a.Ga(eb=>{M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSheetTabBar",!1)||ed.la(eb);Ua.la(eb)})})();(()=>{R.a.Ga(eb=>{le.la(eb)})})();(()=>{R.a.Ga(eb=>{new Wa(eb.ga,eb)})})();R.a.Ga(nd.la);String(c);String(h);String(k);String(b);window.___1689695406777_closurehack=c;window.___1689695406777_closurehack=h;window.___1689695406777_closurehack=k;window.___1689695406777_closurehack=b},900:function(w,C,a){a.r(C);w=a(0);var b=a(14),c=a(1325),h=a(989),k;(function(Y){Y[Y.external=
0]="external";Y[Y.msa=1]="msa";Y[Y.aad=2]="aad"})(k||(k={}));Object(w.b)("AuthorityType",k);var d=a(807);class f{constructor(Y){this.$Mg=Y}initialize(){return Promise.resolve(0)}juc(){return Promise.resolve(0)}$C(){b.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new d.a,{IsSuccess:!0,Token:this.$Mg}))}wLc(){return Promise.resolve(Object.assign(new d.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}TJc(){return!1}AEb(){return"MockAuthTokenStrategy"}}
Object(w.a)(f,"MockAuthTokenStrategy",null,[302]);var u=a(1005);class r{static get(Y,Ga,ma){if(!ma)return Y;let fa=0;return Promise.race([Y,new Promise(Xa=>{fa=window.setTimeout(()=>{Xa(Ga)},ma)})]).then(Xa=>{window.clearTimeout(fa);return Promise.resolve(Xa)}).catch(()=>{window.clearTimeout(fa);return Promise.resolve(Ga)})}}Object(w.a)(r,"PromiseWithTimeout",null,[]);var t=a(5),v=a(429);class x{constructor(Y,Ga,ma,fa,Xa){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=
null;this.resource=Y;this.scope=Ga;this.silentLogin=ma;this.options=fa;this.correlationId=Xa}}Object(w.a)(x,"TokenRequestParameters",null,[312]);var m=a(32),l=a(84);class n{constructor(){this.jye=null;let Y=t.AFrameworkApplication.da.Sa(t.AFrameworkApplication.xba),Ga=t.AFrameworkApplication.da.Sa(t.AFrameworkApplication.rtg);this.H2a=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",Y&&""!==Y?Y:"Unspecified",Ga&&""!==Ga?Ga:"Unspecified")}initialize(){return new Promise(Y=>
{l.a.instance.Qd("Common.App.WopiIdentity.IWopiIdentity").execute(Ga=>{this.jye=Ga;Y(0)})})}am(Y){const Ga=["HTTPS:","API:"];let ma=!1;const fa=Y.toLocaleUpperCase();for(const Xa of Ga)if(fa.startsWith(Xa)){ma=!0;break}return ma||this.sFi(Y)?Y+"/.default":Y}sFi(Y){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(Y)}juc(){return Promise.resolve(0)}$C(Y,Ga,ma,fa,Xa,Ua,ka){if(m.a.VBa){Xa=v.OAuthManagerSettings.cok;if(!Xa)return Ga=Object.assign(new d.a,
{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(Ga);if(!Array.contains(Xa,Y))return Ga=Object.assign(new d.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+Y}),Promise.resolve(Ga)}Y=this.am(ma);ma=new x(ma,Y,!fa,null,t.AFrameworkApplication.userSessionId);return this.jye.getAccessToken(ma,Ga,ka).then(nb=>Object.assign(new d.a,{IsSuccess:!0,Token:nb.accessToken}),nb=>Object.assign(new d.a,{IsSuccess:!1,ErrorCode:nb}))}wLc(){return Promise.resolve(Object.assign(new d.a,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}TJc(){return!1}AEb(){return this.H2a}}Object(w.a)(n,"ParentFrameTokenStrategy",null,[302]);var z=a(79),y=a(908),B=a(198);class G{constructor(){this.reject=this.resolve=null;this.startTime=0;this.v0f=this.eIe=null}}Object(w.a)(G,"PromiseWrapper",null,[]);class E{constructor(Y){Y=void 0===Y?0:Y;this.VE=0;this.Arb=!1;this.lq=new B.a;this._timeout=
Y}enqueue(Y){return new Promise((Ga,ma)=>{this.lq.add(Object.assign(new G,{v0f:Y,resolve:Ga,reject:ma}));this.process()})}process(){if(this.Arb||this.VE===this.lq.count)return!1;const Y=this.lq.ma(this.VE++);try{this.Arb=!0,Y.v0f().then(Ga=>{this.Arb=!1;this.scd(Y,Ga,null,!0)}).catch(Ga=>{this.Arb=!1;this.scd(Y,null,Ga,!1)})}catch(Ga){this.Arb=!1,this.scd(Y,null,Ga,!1)}return!0}scd(Y,Ga,ma,fa){if(fa){const Xa=()=>{Y.resolve(Ga);this.process()};0<this._timeout?window.setTimeout(()=>{Xa()},this._timeout):
Xa()}else{const Xa=()=>{Y.reject(ma);this.process()};0<this._timeout?window.setTimeout(()=>{Xa()},this._timeout):Xa()}}}Object(w.a)(E,"PromiseQueue",null,[]);class J{constructor(){this.correlationId=this.resolve=null}}Object(w.a)(J,"ResolveWithCorrelation",null,[]);var I=a(138),R=a(151),X=a(778),H=a(181);class M extends R.a{constructor(Y,Ga,ma,fa,Xa,Ua){super(!1,!1,!0);this.bie=this.E5=null;this.y0=Y;this.EOg=ma;this.zy=fa;this.pSg=Xa;this.UIa=Ua;this.Gv=document.createElement("iframe");this.Gv.id=
"SharedAuthInteractiveFrame";this.Gv.setAttribute("name","SharedAuthInteractiveFrame");this.Gv.setAttribute("title","SharedAuthInteractiveFrame");this.Gv.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.Gv.style.border="0";this.Gv.style.height="48px";this.Gv.style.width="190px";$addHandler(this.Gv,"error",Object(z.a)(this,this.Fej,"onSharedAuthFrameError"));Y=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.y0,Ga,"?replyUrl=",window.location.protocol,"//",window.location.host,
"&interactive=1","&WacUserType=",t.AFrameworkApplication.userType);this.Gv.src=Y;this.fIg=new Promise(ka=>{this.bie=ka});this.cie=!1}ZHc(){this.E5={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.EOg,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:t.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(z.a)(this,this.Cqh,"createFrame"),["resolveDialogStyles"]:this.bie}};this.Rd=5;this.initializeAndShow(CommonUIStrings.l_SignIn,Object(z.a)(this,this.NVj,
"sharedAuthConsentDialogHandler"),this.E5)}OZa(Y,Ga,ma){Y=void 0===Y?!1:Y;Ga=void 0===Ga?!1:Ga;ma=void 0===ma?5:ma;this.E5&&this.E5.bodyControls&&(Y!==Object(I.a)(Object,this.E5.bodyControls).frameLoaded&&(Object(I.a)(Object,this.E5.bodyControls).frameLoaded=Y),Ga!==Object(I.a)(Object,this.E5.bodyControls).frameLoadSuccess&&(Object(I.a)(Object,this.E5.bodyControls).frameLoadSuccess=Ga),ma!==this.E5.dialogButtonsOption&&(this.E5.dialogButtonsOption=null,this.Rd=ma),this.update(this.E5))}B1j(Y,Ga){const ma=
new X.a(H.a.RVj);ma.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:t.AFrameworkApplication.isRtl,["messageCorrelationId"]:Y,["dialogStyles"]:Ga};this.zy.Paa(ma,this.Gv.contentWindow,this.y0)}Z8e(){this.OZa(!0,!1,6)}get Xhg(){return this.Gv}get Ozh(){return this.fIg.then(Y=>{this.cie=!0;return Y})}get Pzh(){return this.cie}Fej(){this.Z8e()}Cqh(){return this.Gv}NVj(Y){0===Y&&(this.pSg.reject(Object.assign(new d.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),
this.UIa(null))}}Object(w.a)(M,"SharedAuthConsentDialog",R.a,[313]);var O=a(906),L=a(103),S=a(145),T=a(41),V=a(175),la=a(174);class Z{constructor(){this.Gv=null;this.v1b=0;this.Nqb=this.W2a=this.XPc=this.UIa=this.iP=this.axe=null;this.zy=new O.a(null,null);this.H2a="SharedAuthTokenStrategy Unloaded";this.y0=v.OAuthManagerSettings.PVj;this.eve=v.OAuthManagerSettings.OVj;this.Uie=v.OAuthManagerSettings.enableConsoleLogging;this.zIg=t.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",
!1);this.NQg=t.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.DSg=t.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedWebWorkerEnabled",!1);this.Vva={};this.VKg=new E(1500)}AEb(){return this.H2a}initialize(){var {OAuthManager:Y}=a(900);if("loadFrame"in this.Vva)return this.Vva.loadFrame.eIe;if(!this.y0)return L.Health.instance.recordKpiFailure(Y.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),b.ULS.sendTraceTag(562381581,
3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);Y=this.xJc("loadFrame");this.v1b=T.a.Of();var Ga=this.y0+this.eve+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+t.AFrameworkApplication.userSessionId+"&WacUserType="+t.AFrameworkApplication.userType;this.DSg&&(Ga+="&webworker=1");this.Gv=document.createElement("iframe");this.pRa(this.Gv);this.Gv.style.cssText="height:0;width:0;display:none;";this.Gv.id="SharedAuthFrame";this.Gv.setAttribute("name",
"SharedAuthFrame");this.Gv.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.Gv.setAttribute("title","SharedAuthFrame");this.Gv.src=Ga;document.body.appendChild(this.Gv);Ga=T.a.Of()-this.v1b;b.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",Ga,this.Gv.src);return Y}juc(Y){this.XPc=Y;const Ga=new X.a(H.a.$hg);Ga.Values=this.zHe(Y);Y=this.xJc("initFrame");this.zy.Paa(Ga,this.Gv.contentWindow,
this.y0);b.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return Y}$C(Y,Ga,ma,fa,Xa,Ua){const ka=new X.a(H.a.SVj),nb=this.Rgf();ka.Values=this.Fsg(Y,Ga,ma,fa,Xa,Ua,nb);Y=this.xJc(nb);fa&&t.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.VKg.enqueue(()=>new Promise(Ea=>{this.Adk(Ua,ka,Ea,nb)})):(this.zy.Paa(ka,this.Gv.contentWindow,this.y0),b.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",
Ga));return Y}Adk(Y,Ga,ma,fa){const Xa=this.Vva[fa];Xa&&(this.W2a=Ga,this.UIa=Object.assign(new J,{resolve:ma,correlationId:fa}),this.iP=new M(this.y0,this.eve,Y,this.zy,Xa,ma),this.iP.ZHc())}Rgf(){return V.a.create().toString()}Fsg(Y,Ga,ma,fa,Xa,Ua,ka){const nb={};nb.appName=Y;nb.appId=Ga;nb.target=ma;nb.withPopup=fa;nb.claims=Xa;nb.promptMessage=Ua;nb.messageCorrelationId=ka;return nb}pRa(Y){$addHandler(Y,"load",Object(z.a)(this,this.x$i,"onIFrameLoaded"));$addHandler(Y,"error",Object(z.a)(this,
this.Wxc,"onIFrameError"));this.zy.LS(this.y0);this.zy.Rn(H.a.dig);this.zy.fm(H.a.dig,Object(z.a)(this,this.Xdj,"onScriptLoaded"));this.zy.Rn(H.a.cig);this.zy.fm(H.a.cig,Object(z.a)(this,this.Wdj,"onScriptInitialized"));this.zy.Rn(H.a.Yhg);this.zy.fm(H.a.Yhg,Object(z.a)(this,this.W9i,"onGetTokenResponse"));this.zy.Rn(H.a.eig);this.zy.fm(H.a.eig,Object(z.a)(this,this.Raj,"onLoginResponse"));this.zy.Rn(H.a.aig);this.zy.fm(H.a.aig,Object(z.a)(this,this.T$i,"onInteractiveFlowReady"));this.zy.Rn(H.a.Zhg);
this.zy.fm(H.a.Zhg,Object(z.a)(this,this.q$i,"onHideDialog"));this.zy.Rn(H.a.Whg);this.zy.fm(H.a.Whg,Object(z.a)(this,this.d5i,"onCloseDialog"))}xJc(Y){const Ga=new G;Ga.startTime=T.a.Of();const ma=new Promise((fa,Xa)=>{Ga.resolve=fa;Ga.reject=Xa});Ga.eIe=ma;this.Vva[Y]=Ga;return ma}x$i(){const Y=T.a.Of()-this.v1b;b.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",Y)}Wxc(Y){const {OAuthManager:Ga}=a(900),ma=T.a.Of()-this.v1b,fa=Object.assign(new la.a,{durationMs:ma});
L.Health.instance.recordKpiFailure(Ga.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,fa);b.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",ma,this.Uie?JSON.stringify(Y):"")}Xdj(Y){const {OAuthManager:Ga}=a(900),ma=this.Vva.loadFrame;var fa=T.a.Of()-ma.startTime,Xa=Y.Values.AuthLibrary.toString();Y=Y.Values.Success.toString();b.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",Y,Xa,fa);Xa&&
(this.H2a="SharedAuthTokenStrategy "+Xa);Xa=Boolean.parse(Y);Xa||(Y=S.a.Zt(),void 0!==Y&&null!==Y&&(Y.set("AuthLibrary",this.AEb()),fa=Object.assign(new la.a,{durationMs:fa,extendedProperties:Y}),L.Health.instance.recordKpiFailure(Ga.kpiName,"SharedAuthStrategyInitFailed",!1,!0,fa)));ma.resolve(Xa?0:1)}Wdj(Y){if(Y.Values.interactive&&this.W2a&&this.W2a.Values.messageCorrelationId){const ma=this.W2a.Values.messageCorrelationId.toString();if(Y.Values.interactive&&this.iP){this.iP.Ozh.then(fa=>{this.zy.Paa(this.W2a,
this.iP.Xhg.contentWindow,this.y0);this.iP.B1j(ma,fa);this.iP.OZa(!0,!0);this.W2a=null});return}}Y=this.Vva.initFrame;const Ga=T.a.Of()-Y.startTime;b.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",Ga);Y.resolve(0)}W9i(Y){if(Y.Values.messageCorrelationId&&Y.Values.messageCorrelationId.toString()){var Ga=Y.Values.messageCorrelationId.toString(),ma=this.Vva[Ga];if(ma){var fa=T.a.Of()-ma.startTime;b.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",
fa);Y.Values.isSuccess&&Y.Values.isSuccess?ma.resolve(Y.Values.response):ma.reject(Y.Values.response);this.Vsg(Ga)}else b.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else b.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}T$i(){if(this.iP.Pzh)this.iP.Z8e();else if(this.XPc&&this.iP){const Y=new X.a(H.a.$hg);Y.Values=this.zHe(this.XPc,!0);this.zy.Paa(Y,
this.iP.Xhg.contentWindow,this.y0)}}q$i(){this.iP&&this.iP.fab()}d5i(Y){Y.Values.cancelled&&Y.Values.cancelled&&Y.Values.messageCorrelationId&&this.Vsg(Y.Values.messageCorrelationId.toString());this.iP&&this.iP.hide()}zHe(Y,Ga){Ga=void 0===Ga?!1:Ga;const ma={};ma.appIds=this.Z1h();ma.upn=Y.loginHint;ma.authority=Y.authority;ma.authorityType=Object(c.a)(k,Y.authorityType);ma.tenantId=Y.tenantId;ma.correlationId=t.AFrameworkApplication.userSessionId;ma.enableConsoleLogging=this.Uie;ma.enablePopupFlash=
this.zIg;ma.skipUpnCheck=this.NQg;ma.interactive=Ga;return ma}Z1h(){const Y=[],Ga=v.OAuthManagerSettings.R6c;for(const fa in Ga){var ma=Ga[fa];Array.contains(Y,ma)||Array.add(Y,ma)}return Y}wLc(Y,Ga,ma,fa,Xa,Ua){const ka=new X.a(H.a.QVj),nb=this.Rgf();ka.Values=this.Fsg(Y,Ga,ma,fa,Xa,Ua,nb);this.axe=ka;Y=this.xJc(nb);b.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",Ga);this.g_j();return Y}TJc(){return!0}g_j(){this.Nqb||(this.Nqb=new y.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,
CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.Nqb.id=16,this.Nqb.wBd=!1,this.Nqb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{b.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.zy.Paa(this.axe,this.Gv.contentWindow,this.y0)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),b.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}Raj(Y){if(Y.Values.messageCorrelationId&&
Y.Values.messageCorrelationId.toString()){var Ga=this.Vva[Y.Values.messageCorrelationId.toString()];if(Ga){var ma=T.a.Of()-Ga.startTime;b.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",ma);Y.Values.isSuccess&&Y.Values.isSuccess?Ga.resolve(Y.Values.response):Ga.reject(Y.Values.response)}else b.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else b.ULS.sendTraceTag(555049439,3E3,10,
"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}Vsg(Y){this.UIa&&this.UIa.correlationId===Y&&(this.UIa.resolve(null),this.UIa=null)}}Object(w.a)(Z,"SharedAuthTokenStrategy",null,[302]);class da{constructor(Y){this.v_c=Y;this.H2a="UnsupportedAuthTokenStrategy Reason="+h.a[this.v_c]}initialize(){return Promise.resolve(0)}juc(){return Promise.resolve(0)}$C(){return Promise.resolve(Object.assign(new d.a,{IsSuccess:!1,ErrorCode:h.a[this.v_c],ErrorMessage:"Unable to get a token. Reason: ["+
h.a[this.v_c]+"]"}))}wLc(){return Promise.resolve(Object.assign(new d.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}TJc(){return!1}AEb(){return this.H2a}}Object(w.a)(da,"UnsupportedAuthTokenStrategy",null,[302]);var ba=a(753);a.d(C,"OAuthManager",function(){return na});class na{constructor(Y){Y=void 0===Y?null:Y;this.mJ=0;this.NO=null;this.lPg=0;this.Tme=!!window.location.search.match(RegExp("wdpa=1",
"gi"));const Ga=T.a.Of();this.KKg=this.azh(Y).then(ma=>ma?this.sui():(b.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.cw(),Math.floor(T.a.Of()-Ga)),ma=S.a.Zt(),void 0!==ma&&null!==ma&&(ma.set("AuthLibrary",this.cw()),ma=Object.assign(new la.a,{durationMs:Math.floor(T.a.Of()-Ga),extendedProperties:ma}),L.Health.instance.recordKpiFailure(na.kpiName,"StrategyPickFailed",!1,!0,ma)),Promise.resolve(1))).then(ma=>0!==
ma?Promise.resolve(ma):this.cQi())}bzh(){if(this.Tme)this.mJ=5,this.NO=new da(this.mJ);else{var Y=v.OAuthManagerSettings.VYi;Y&&0<Y.length?(this.mJ=1,this.NO=new f(Y)):t.AFrameworkApplication.da.pa("IsO365ConsumerHost")||t.AFrameworkApplication.da.pa("IsO365CommercialHost")?t.AFrameworkApplication.da.pa("IsAnonymousUser")?(this.mJ=2,this.NO=new da(this.mJ)):(Y=u.a.getAuthContext().loginHint)&&Y.length?v.OAuthManagerSettings.UFb?(this.mJ=1,this.NO=new n):(this.mJ=1,this.NO=new Z):(this.mJ=3,this.NO=
new da(this.mJ)):(this.mJ=4,this.NO=new da(this.mJ))}}cw(){return this.NO?this.NO.AEb()||"Unknown":"None"}azh(Y){Y=void 0===Y?null:Y;b.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const Ga=T.a.Of();return t.AFrameworkApplication.da.wqd().then(ma=>{ma?(this.bzh(),Y&&(this.NO=Y),b.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",v.OAuthManagerSettings.clientVersion,v.OAuthManagerSettings.appVersion,
v.OAuthManagerSettings.fCh,this.cw(),Math.floor(T.a.Of()-Ga))):b.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(T.a.Of()-Ga));return Promise.resolve(ma)},()=>{b.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(T.a.Of()-Ga));return Promise.resolve(!1)})}sui(){b.ULS.sendTraceTag(573390991,
3E3,50,"Initializing {0}",this.cw());const Y=T.a.Of();return r.get(this.NO.initialize(),2,v.OAuthManagerSettings.pSd).then(Ga=>{if(0===Ga)b.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.cw(),Math.floor(T.a.Of()-Y));else if(1===Ga){b.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.cw(),Math.floor(T.a.Of()-Y));var ma=S.a.Zt();void 0!==ma&&null!==ma&&(ma.set("AuthLibrary",this.cw()),ma=
Object.assign(new la.a,{durationMs:Math.floor(T.a.Of()-Y),extendedProperties:ma}),L.Health.instance.recordKpiFailure(na.kpiName,"StrategyInitFailed",!1,!0,ma))}else 2===Ga&&(b.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.cw(),Math.floor(T.a.Of()-Y)),ma=S.a.Zt(),void 0!==ma&&null!==ma&&(ma.set("AuthLibrary",this.cw()),ma=Object.assign(new la.a,{durationMs:Math.floor(T.a.Of()-Y),extendedProperties:ma}),L.Health.instance.recordKpiFailure(na.kpiName,
"StrategyInitTimedOut",!1,!0,ma)));return Promise.resolve(Ga)},()=>{b.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.cw(),Math.floor(T.a.Of()-Y));return Promise.resolve(1)})}cQi(){b.ULS.sendTraceTag(562128581,3E3,50,"Loading {0}",this.cw());const Y=T.a.Of();return r.get(this.NO.juc(u.a.getAuthContext()),2,v.OAuthManagerSettings.pSd).then(Ga=>{if(0===Ga)b.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",
this.cw(),Math.floor(T.a.Of()-Y));else if(1===Ga){b.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.cw(),Math.floor(T.a.Of()-Y));var ma=S.a.Zt();void 0!==ma&&null!==ma&&(ma.set("AuthLibrary",this.cw()),ma=Object.assign(new la.a,{durationMs:Math.floor(T.a.Of()-Y),extendedProperties:ma}),L.Health.instance.recordKpiFailure(na.kpiName,"StrategyLoadFailed",!1,!0,ma))}else 2===Ga&&(b.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.cw(),Math.floor(T.a.Of()-Y)),ma=S.a.Zt(),void 0!==ma&&null!==ma&&(ma.set("AuthLibrary",this.cw()),ma=Object.assign(new la.a,{durationMs:Math.floor(T.a.Of()-Y),extendedProperties:ma}),L.Health.instance.recordKpiFailure(na.kpiName,"StrategyLoadTimedOut",!1,!0,ma)));return Promise.resolve(Ga)},()=>{b.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.cw(),Math.floor(T.a.Of()-Y));return Promise.resolve(1)})}$C(Y,Ga,ma){return this.uLc(Y,
Ga,!1,null,"",void 0===ma?null:ma)}Gsg(Y,Ga,ma,fa,Xa){return this.uLc(Y,Ga,!0,ma,fa,void 0===Xa?null:Xa)}uLc(Y,Ga,ma,fa,Xa,Ua,ka){ka=void 0===ka?0:ka;ka+=1;b.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",Y,this.jXa(Y,Ga),this.cw(),ka);var nb=S.a.Zt();void 0!==nb&&null!==nb&&(nb.set("AuthLibrary",this.cw()),nb.set("AppName",Y),nb.set("Target",this.jXa(Y,Ga)),L.Health.instance.recordKpiUsage(na.kpiName,0,"WacOAuthFC",nb));
if(!v.OAuthManagerSettings.isEnabled||this.Tme){var Ea;return this.CGd((Ea=new d.a,Ea.IsSuccess=!1,Ea.Token=null,Ea.ErrorCode="NotEnabled",Ea.ErrorMessage="OAuthManager is disabled.",Ea),Y)}const sb=v.OAuthManagerSettings.R6c[Y];if(void 0===sb||null===sb){b.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",Y);var Oa;return this.CGd((Oa=new d.a,Oa.IsSuccess=!1,Oa.Token=null,Oa.ErrorCode="DisallowedApp",Oa.ErrorMessage=
"Disallowed appName: "+Y,Oa),Y)}const La=T.a.Of();let ia=La;const Sa=this;nb=this.KKg.then(Tb=>{ia=T.a.Of();return Sa.qAi(Y,sb,Ga,ma,fa,Xa,Ua,Tb)});Ea=ma?0:v.OAuthManagerSettings.pSd;let Za;Oa=(Za=new d.a,Za.IsSuccess=!1,Za.Token=null,Za.ErrorCode="authTokenStrategy_timeout",Za.ErrorMessage="Auth Strategy timed out after ["+Ea+"] ms when fetching token",Za);const Ab=this,pb=this;return r.get(nb,Oa,Ea).then(Tb=>ka<=na.EXi&&(Tb.ErrorCode===na.Kqg||Tb.ErrorCode===na.q6j)?(b.ULS.sendTraceTag(573175516,
3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",ka,Math.floor(T.a.Of()-La)),Ab.uLc(Y,Ga,ma,fa,Xa,Ua,ka)):Tb.ErrorCode===na.Ryf&&!ma&&(b.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",ka,na.D_e),na.tFh&&Ab.NO.TJc()&&Ab.NO.wLc(Y,sb,Ga,ma,fa,Xa).then(ob=>Promise.resolve(Ab.Cuc(ob,Y,Ga,sb,La,ia))).catch(()=>{let ob;const va=(ob=new d.a,ob.IsSuccess=!1,ob.Token=null,ob.ErrorCode="authTokenStrategy_failure",ob.ErrorMessage=
"LoginPopup failed, GetToken could not be called",ob);return Promise.resolve(Ab.Cuc(va,Y,Ga,sb,La,ia))}),na.D_e)?Ab.uLc(Y,Ga,!0,fa,Xa,Ua,ka):Promise.resolve(Ab.Cuc(Tb,Y,Ga,sb,La,ia))).catch(()=>{let Tb;const ob=(Tb=new d.a,Tb.IsSuccess=!1,Tb.Token=null,Tb.ErrorCode="authTokenStrategy_failure",Tb.ErrorMessage="Auth Strategy failed with an unknown error",Tb);return Promise.resolve(pb.Cuc(ob,Y,Ga,sb,La,ia))})}qAi(Y,Ga,ma,fa,Xa,Ua,ka,nb){return 1===nb||2===nb?this.CGd(Object.assign(new d.a,{IsSuccess:!1,
Token:null,ErrorCode:1===nb?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),Y):this.NO.$C(Y,Ga,ma,fa,Xa,Ua,ka).then(Ea=>Promise.resolve(this.hJf(Ea,!0,Y))).catch(Ea=>Promise.resolve(this.hJf(Ea,!1,Y)))}Cuc(Y,Ga,ma,fa,Xa,Ua){const ka={},nb=T.a.Of()-Ua;ka.IsSuccess=Y.IsSuccess;ka.ErrorCode=Y.IsSuccess?"Success":Y.ErrorCode||"";ka.ErrorMessage=Y.IsSuccess?"Success":this.jXa(Ga,Y.ErrorMessage||"");ka.Target=this.jXa(Ga,ma||"");ka.TimeInMS=Math.floor(nb);ka.LoadTimeInMS=
Math.floor(Ua-Xa);ka.AuthLibrary=this.cw();ka.AppName=Ga;ka.AuthorityType=Object(c.a)(k,u.a.Kjc());ka.UserType=this.$ji(u.a.getAuthContext());ka.IsAuthSupportedInSession=h.a[this.mJ];ka.RequestCount=++this.lPg;ka.AppId=fa;b.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(ka));Y.IsSuccess||(ma=S.a.Zt(),void 0!==ma&&null!==ma&&(ma.set("AppName",Ga),ma.set("AuthLibrary",this.cw()),ma.set("ErrorCode",Y.ErrorCode),ma.set("ErrorMessage",this.jXa(Ga,Y.ErrorMessage)),Ga=Object.assign(new la.a,{durationMs:nb,
extendedProperties:ma}),L.Health.instance.recordKpiFailure(na.kpiName,"TryGetTokenFailure",!1,!0,Ga)));return Y}CGd(Y,Ga){b.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",Ga,this.jXa(Ga,Y.ErrorMessage));const ma=S.a.Zt();void 0!==ma&&null!==ma&&(ma.set("AppName",Ga),ma.set("AuthLibrary",this.cw()),ma.set("ErrorCode",Y.ErrorCode),ma.set("ErrorMessage",this.jXa(Ga,Y.ErrorMessage)),Ga=Object.assign(new la.a,{extendedProperties:ma}),L.Health.instance.recordKpiFailure(na.kpiName,
"FailureBeforeGetToken",!1,!0,Ga));return Promise.resolve(Y)}Wtf(Y){return Y===ba.a.GKc}jXa(Y,Ga){return this.Wtf(Y)&&Ga?"REDACTED":Ga}$ji(Y){return t.AFrameworkApplication.da.pa("IsAnonymousUser")?"anonymous":!Y.loginHint||1>Y.loginHint.length?"empty":-1<Y.loginHint.indexOf("guest#")?"guest":-1<Y.loginHint.indexOf("ext#")?"external":0>Y.upn.indexOf("@")?"no-at":"supported"}Zab(){return 1===this.mJ}hJf(Y,Ga,ma){let fa=null,Xa=null,Ua=null,ka=null;Y?Y.ErrorCode||Y.ErrorMessage?(Xa=Y.ErrorCode?Y.ErrorCode:
na.s5e,Ua=Y.ErrorMessage?Y.ErrorMessage:"No message"):Y.Token?Ga?fa=Y.Token:(Xa=na.zyj,Ua="A rejected promise returned a token."):(Xa=na.s5e,Ua=JSON.stringify(Y)):(Xa=na.r0i,Ua="No result came from Auth Token Strategy");Y&&Y.Telemetry&&!this.Wtf(ma)&&(ka=Y.Telemetry,b.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(ka)));if(Xa===na.eZi||Xa===na.qak)Xa=na.Kqg,Ua="Auth Library Timed Out";Xa===na.B6g&&-1<Ua.indexOf(na.hTg)&&(Xa=na.Ryf);if(Xa||Ua)fa=null;return Object.assign(new d.a,{IsSuccess:!!fa,
Token:fa,ErrorCode:Xa,ErrorMessage:Ua,Telemetry:ka})}static get D_e(){return t.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get tFh(){return t.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",!1)}}na.qak="token_renewal_error";na.s5e="Exception";na.r0i="NoResult";na.zyj="RejectToken";na.eZi="monitor_window_timeout";na.Kqg="Timeout";na.q6j="authTokenStrategy_timeout";na.B6g=
"login_required";na.hTg="AADSTS50058";na.Ryf="Cookies Disabled";na.kpiName="OAuthManager";na.EXi=2;Object(w.a)(na,"OAuthManager",null,[222])},989:function(w,C,a){a.d(C,"a",function(){return b});w=a(0);var b;(function(c){c[c.unknown=0]="unknown";c[c.supported=1]="supported";c[c.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";c[c.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";c[c.hostUnsupported=4]="hostUnsupported";c[c.perfAutomation=5]="perfAutomation"})(b||(b={}));Object(w.b)("SupportStatus",
b)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.vrs.js.map/34c10c1f670167b42a4d1b07eb27a932/EwaTS.vrs.js.map