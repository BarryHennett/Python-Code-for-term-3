'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1001:function(w,C,a){a.r(C);w=a(731);var b=a(0),c=a(14),h=a(5),k=a(96),d=a(32),f=a(39),u=a(83),r;(function(Z){Z[Z.unableToRefreshLock=0]="unableToRefreshLock";Z[Z.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";Z[Z.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";Z[Z.workbookTooLarge=3]="workbookTooLarge";Z[Z.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";Z[Z.externalWorkbookLinksShowError=
5]="externalWorkbookLinksShowError";Z[Z.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";Z[Z.unsupportedFeatures=7]="unsupportedFeatures";Z[Z.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";Z[Z.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";Z[Z.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";Z[Z.lastGenericStatusError=11]="lastGenericStatusError";Z[Z.scratchPadWarning=12]="scratchPadWarning";Z[Z.authenticationLost=
13]="authenticationLost";Z[Z.odfCompatibilityIssues=14]="odfCompatibilityIssues";Z[Z.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";Z[Z.workbookIsIrmProtected=16]="workbookIsIrmProtected";Z[Z.biFeatureNotAvailable=17]="biFeatureNotAvailable";Z[Z.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";Z[Z.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";Z[Z.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";Z[Z.transientServerCommunicationFailures=
21]="transientServerCommunicationFailures";Z[Z.editAttemptInReadOnly=22]="editAttemptInReadOnly";Z[Z.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";Z[Z.unsupportedBrowser=24]="unsupportedBrowser";Z[Z.readOnlyPermissions=25]="readOnlyPermissions";Z[Z.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";Z[Z.policyWarningMessage=27]="policyWarningMessage";Z[Z.workingOnIt=28]="workingOnIt";Z[Z.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";
Z[Z.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";Z[Z.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";Z[Z.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";Z[Z.legacyConnectionsBB=33]="legacyConnectionsBB";Z[Z.tooManyLoadBlockingFloatingObjectsBB=34]="tooManyLoadBlockingFloatingObjectsBB";Z[Z.groupedSlicersBB=35]="groupedSlicersBB";Z[Z.thirdPartyAddinDisabled=36]="thirdPartyAddinDisabled";Z[Z.financeLinkedEntityDisclaimerBar=37]="financeLinkedEntityDisclaimerBar";
Z[Z.wolframDeprecationAlertBar=38]="wolframDeprecationAlertBar";Z[Z.wacGdprNotice=39]="wacGdprNotice";Z[Z.automaticSensitivityLabel=40]="automaticSensitivityLabel";Z[Z.recommendedSensitivityLabel=41]="recommendedSensitivityLabel";Z[Z.mandatorySensitivityLabel=42]="mandatorySensitivityLabel";Z[Z.localStorageDisabled=43]="localStorageDisabled";Z[Z.autoRefreshDisabled=44]="autoRefreshDisabled";Z[Z.corruptedFileRepaired=45]="corruptedFileRepaired";Z[Z.corruptedOdsFileRepaired=46]="corruptedOdsFileRepaired";
Z[Z.minorVersionLimitReached=47]="minorVersionLimitReached";Z[Z.sensitivityApplicationGenericError=48]="sensitivityApplicationGenericError";Z[Z.sensitivityApplicationTooLargeFileError=49]="sensitivityApplicationTooLargeFileError";Z[Z.sensitivityApplicationLabelNotSupportedError=50]="sensitivityApplicationLabelNotSupportedError";Z[Z.sensitivityApplicationLabelDisabledError=51]="sensitivityApplicationLabelDisabledError";Z[Z.sensitivityApplicationMandatoryConflictError=52]="sensitivityApplicationMandatoryConflictError";
Z[Z.sensitivityApplicationMinorVersionLimitReachedError=53]="sensitivityApplicationMinorVersionLimitReachedError";Z[Z.sensitivityApplicationSetLabelError=54]="sensitivityApplicationSetLabelError";Z[Z.promptEnableExternalLinks=55]="promptEnableExternalLinks";Z[Z.networkDown=56]="networkDown";Z[Z.defaultToViewDueToCogs=57]="defaultToViewDueToCogs";Z[Z.refreshLinkedEntityErrorBar=58]="refreshLinkedEntityErrorBar";Z[Z.promptEnableLinkedEntitiesUntrustedImages=59]="promptEnableLinkedEntitiesUntrustedImages";
Z[Z.canvasHealth=60]="canvasHealth";Z[Z.mismatchedFileFormatConverted=61]="mismatchedFileFormatConverted";Z[Z.optimizeWorkbook=62]="optimizeWorkbook";Z[Z.novModePostDepreciation=63]="novModePostDepreciation";Z[Z.officeScriptsRunning=64]="officeScriptsRunning";Z[Z.powerQueryRefreshDataSourceNotSupported=65]="powerQueryRefreshDataSourceNotSupported";Z[Z.readOnlyPivotTable=66]="readOnlyPivotTable";Z[Z.powerQueryRefreshHostNotSupported=67]="powerQueryRefreshHostNotSupported";Z[Z.refreshPageAfterEnablingTheExtension=
68]="refreshPageAfterEnablingTheExtension";Z[Z.msFormsDataSyncStatus=69]="msFormsDataSyncStatus";Z[Z.dataCleansingSuggestions=70]="dataCleansingSuggestions";Z[Z.editInMiniWAC=71]="editInMiniWAC";Z[Z.powerQueryUnsupportedTeams=72]="powerQueryUnsupportedTeams";Z[Z.powerQueryEnableThirdPartyCookies=73]="powerQueryEnableThirdPartyCookies";Z[Z.count=74]="count"})(r||(r={}));Object(b.b)("EwaBusinessBarEntryType",r);var t=a(6),v=a(1118);class x extends Sys.EventArgs{constructor(Z,da,ba){ba=void 0===ba?null:
ba;super();this.p5a=Z;this.uhd=da;this.data=ba}}Object(b.a)(x,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var m=a(1121),l=a(1119),n=a(1123);a(1122);var z=a(1116),y=a(485),B=a(53),G=a(38),E=a(667),J=a(34),I=a(1),R=a(19),X=a(65),H=a(76),M=a(965),O=a(137),L=a(15),S=a(1120),T=a(91);a.d(C,"BusinessBarManager",function(){return la});var V;let la=V=class extends u.a{constructor(Z,da){da=void 0===da?!Z.O2:da;super();this.Ua=new f.a;this.bT=null;this.LSc=[];this.exc=()=>{this.$.qa.BRa?this.removeEntry(13):
this.yi(13,null)};this.xj=(ba,na)=>{for(let Y=0,Ga=V.fmc().length;Y<Ga;Y++)ba=V.fmc()[Y],this.removeEntry(ba);na.context&&0<na.context.communicationErrorRetryCount&&(c.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),this.removeEntry(21));this.qEj()};this.So=(ba,na)=>{var Y;ba=this.QUh(na.errors);let Ga=[];for(let fa=0,Xa=ba.length;fa<Xa;++fa){const Ua=ba[fa];if(1===Ua.Type&&
Ua.Appearance&32)Ga=this.Yoi(Ua,Ga);else if(na.jOj){c.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");var ma=(null===(Y=na.context)||void 0===Y?0:Y.stopwatch)?na.context.stopwatch.Te:-1;5E3>ma?c.ULS.sendTraceTag(537170208,0,50,`OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = ${ma}ms).`):h.AFrameworkApplication.CKi()||
this.QXg(Ua,na.context.methodName)}ma=[...V.fmc()];for(let ka=0,nb=Ga.length;ka<nb;++ka){const Ea=Ga[ka];this.yi(Ea,Ua);Array.remove(ma,Ea)}for(let ka=0,nb=ma.length;ka<nb;++ka)this.removeEntry(ma[ka])}};this.ff=(ba,na)=>{this.De(ba,na)};this.De=()=>{const ba=this.$.ea;ba.oe||ba.ni()||(this.QUd(),this.LSc.length=0)};this.wf=(ba,na)=>{this.$.ea.ni()&&!na.YY||this.epf(na.YY)};this.KOb=()=>{const ba=this.$.userOperationManager.Tlc();ba&&ba.operation.flags&1&&this.zkg()};this.CPf=()=>{this.zkg()};this.Nh=
()=>{this.LMe();this.Jkg()};this.UQ=()=>{if(this.$.J9&&this.$.ea.ni()&&this.$.ea.oe)if(this.$.ea.isEditMode)this.removeEntry(45),this.removeEntry(12),this.removeEntry(29),this.removeEntry(30),this.removeEntry(31),this.removeEntry(32),this.removeEntry(34),this.removeEntry(22),this.removeEntry(57);else{const ba=this.$.ga.Da(331);ba&&ba.NOa||this.removeEntry(55);this.removeEntry(5)}};this.$=Z;this.f4a=da;this.B5g();h.AFrameworkApplication.tf&&h.AFrameworkApplication.tf.kub(this);this.k3a=Array(74);for(let ba=
0;74>ba;ba++)this.k3a[ba]=null;this.zj=E.EcmaDateClock.instance;this.Gzf=this.zj.ke.getTime();da&&(da=Z.qa,da.aA(this.So),da.St(this.xj),da.qub(this.exc),da.B3a(this.exc),Z.ea.Zl(this.ff),Z.ea.Mw(this.Nh),Z.Zm(this.wf),Z.gk(this.De),Z.ea.N0(this.UQ),Z.userOperationManager.Pr(this.KOb),I.EwaSettings.Ea(158)&&Z.ea.pj.get(45)&&h.AFrameworkApplication.da.pa("SupportsPolicies")||this.hlf(),this.epf(X.c(Z)));I.EwaSettings.isChangeGateEnabled("OfficeVSO:8010793_ConvertBusinessBarManagerServiceStage2")||
Z.ga.Qa(5,this)}hlf(){J.a.Rr(this.$.ea.DI)&&this.So(this,new y.a(this.$.ea.DI,null,!1,-1,-1,-1,-1,"",-1,"",-1))}CBe(Z){this.Ua.addHandler("bBarAttachedOrDetached",Z)}get Jid(){return this.LSc}get domElement(){return this.bT?this.bT.domElement:null}dispose(){if(this.$){const Z=this.$,da=Z.qa;da.hB(this.So);da.mv(this.xj);da.XCc(this.exc);da.xRb(this.exc);Z.ea.gm(this.ff);Z.ea.ny(this.Nh);Z.co(this.wf);Z.Hn(this.De);Z.ea.k4(this.UQ);Z.userOperationManager.Ap(this.KOb);R.h(Z).he.zp(this.CPf)}k.a.Ma(this.bT);
this.$=this.bT=null;super.dispose()}MBi(Z){switch(Z){case 4:case 5:case 11:case 55:case 59:case 7:case 37:case 38:case 71:return!0;default:return!1}}yi(Z,da,ba,na,Y){ba=void 0===ba?null:ba;na=void 0===na?null:na;Y=void 0===Y?null:Y;if(!this.$.isMobileMode||this.MBi(Z))this.f4a&&!this.yH(Z)&&(this.k3a[Z]=this.zj.Xia,this.bT.tD(Z,da,na,Y),this.Ua.raiseEvent("bBarAttachedOrDetached",new x(Z,!0,ba))),da&&32===da.Appearance&&H.a(this.$).rf.uga(da)}g0j(Z,da,ba,na){c.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");
z.a.initialize(Z,da,ba,na);this.yi(39,null)}b_j(Z,da,ba,na){v.a.initialize(Z,da,ba,na);this.yi(40,null)}r1j(Z,da,ba,na){l.a.initialize(Z,da,ba,na);this.yi(41,null)}E_j(Z,da,ba,na){S.a.initialize(Z,da,ba,na);this.yi(70,null)}H0j(Z,da,ba,na){m.a.initialize(Z,da,ba,na);this.yi(42,null)}x1j(Z,da,ba,na){n.a.initialize(Z,da,ba,na);this.yi(54,null)}removeEntry(Z){this.f4a&&(I.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170251,0,50,`Removing entry from BB: ${Enum.toString(r,
Z)}`),this.k3a[Z]=null,this.bT.removeEntry(Z)&&this.Ua.raiseEvent("bBarAttachedOrDetached",new x(Z,!1)))}jpa(Z){return this.f4a?this.bT.jpa(Z):!1}yH(Z){return this.f4a?this.bT.yH(Z):!1}Feb(){c.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")}HMb(){c.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)}B5g(){const {BusinessBarControl:Z}=a(1173);
if(this.f4a&&!this.bT){R.h(this.$).he.Gp(this.CPf);var da=document.getElementById(this.$.Pd+t.a.SJe);this.bT=new Z(this.$,da)}}QUd(){this.f4a&&this.bT.QUd()}qEj(){if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){const da=this.zj.Xia;if(3E5<=da-this.Gzf){this.Gzf=da;for(let ba=0;74>ba;ba++){var Z=this.k3a[ba];if(Z&&(Z=da-Z,3E5<=Z)){const na=Enum.toString(r,ba);c.ULS.sendTraceTag(537170241,0,50,`${"OnWebMethodSuccess"}: entry [${na}] was activated but not turned off for ${Z} Millis`)}}}}}QUh(Z){const da=
[];for(const ba of Z)switch(ba.MessageId){case -113742550:const na=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941];(this.$.ea.isNamedObjectViewMode||J.a.nj(Z,na))&&da.push(-113742550)}return J.a.uE(Z,da)}Yoi(Z,da){switch(Z.MessageId){case 2113407564:const ba=J.a.l5a([1821390342,-943219229,-502303485,1437034227]);for(let na=0;na<ba.length;na++)ba[na].HelpTopicId=Z.HelpTopicId,ba[na].HelpDescription=Z.HelpDescription,this.LSc.push(ba[na])}switch(Z.MessageId){case -395951567:this.yi(6,
Z);break;case 1643490758:this.yi(4,Z);break;case -907264831:this.yi(5,Z);break;case 757111532:case 2113407564:this.yi(7,Z);break;case 2010656511:this.yi(15,Z);break;case 1321660996:this.$.Xfd=!0;this.yi(8,Z);break;case 526339737:this.$.Xfd=!0;this.yi(9,Z);break;case -407088521:this.yi(10,Z);break;case 1756116017:this.yi(14,Z);break;case -1703455218:this.yi(17,Z);break;case 1393475740:this.yi(25,Z);break;case -949523941:this.yi(26,Z);break;case 1779381952:this.yi(44,Z);break;case 1421575100:this.yi(45,
Z);break;case 613676060:this.yi(46,Z);break;case 1233668252:this.yi(61,Z);break;case 1911608588:Z=!!(this.$.If&64);!this.$.ea.ni()&&Z&&da.push(29);break;case 1544494907:break;case -655555355:da.push(this.EDd()?1:0);break;case -1221382671:da.push(2);break;case 1662282929:da.push(3);break;case 104919273:this.$.ea.ni()||da.push(30);break;case -689453604:Z=!!(this.$.If&64);this.$.ea.qmf=!0;!this.$.ea.ni()&&Z&&da.push(31);break;case 157762400:this.$.ea.Lqc=!0;!this.$.ea.ni()&&this.$.If&64&&!this.$.isEditMode&&
da.push(32);break;case -1125398042:!this.$.ea.ni()&&this.$.If&64&&!this.$.isEditMode&&da.push(34);break;case -73730134:!this.$.ea.ni()&&this.$.If&64&&da.push(33);break;case -293349236:da.push(65);break;case 1580811823:da.push(67);break;case -37299333:break;case 136737622:da.push(47);break;case -1780327030:this.yi(55,Z);break;case -113742550:this.yi(57,Z);break;case -260312420:this.$.ea.ni()||da.push(66);break;case 784737213:this.$.ea.ni()||da.push(70);break;default:this.yi(11,Z)}return da}Jvi(){if(h.AFrameworkApplication.da.pa("WildFireExcelBizBar")&&
!M.a.AGi(M.a.yaf(1))&&(d.a.Rp||d.a.Xi)){const Z=I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(T.d)(O.a.resolve(L.z,{Ja:1})):B.GetServiceTaskFactory.create(this.$.ga,155,this.$.ka,1);G.TaskExtensions.za(Z,()=>{this.yi(20,null)},this.ka,3)}}Xui(Z){Z||3!==this.$.workbookContext.WorkbookNovType||this.yi(63,null)}get ggk(){return h.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UnsupportedBrowserVersionSoftBlockIsEnabled",
!1)}Gvi(){this.ggk&&d.a.JLi&&this.yi(24,null)}epf(Z){(!Z&&!this.$.printingEnabled||this.$.mg.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&(c.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.yi(16,null));this.Jvi();this.LMe();this.Jkg();this.Xui(Z);this.Gvi()}LMe(){this.$.workbookContext.Options&32768&&this.W_j()}W_j(){this.k3a[37]||this.yi(37,null)}b2j(){this.k3a[38]||this.yi(38,null)}Jkg(){this.$.workbookContext.Options&
524288&&this.yi(59,null)}jlg(Z,da){this.yi(58,Z,null,da)}O4c(Z,da){var ba=null,na=null;ba=void 0===ba?null:ba;na=void 0===na?null:na;da=void 0===da?null:da;this.bT.yH(Z)?this.bT.UXb(Z,da):this.yi(Z,null,ba,na,da)}zkg(){this.$.If&8&&this.yi(12,null)}EDd(){const Z=this.$.ga.Da(38);return Z?Z.tokenExpired:!1}QXg(Z,da){if(!this.yH(21)&&-1387426400!==Z.MessageId){c.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");const ba={};ba.FailedMethod=da;
this.yi(21,Z,ba)}}static fmc(){return V.WDe||(V.WDe=[0,1,2,3])}Hod(Z){return this.bT.Hod(Z)}};la.WDe=null;la=V=Object(w.a)([Object(O.d)(L.m),Object(w.b)(0,Object(L.W)())],la);Object(b.a)(la,"BusinessBarManager",u.a,[638,5,95])},1113:function(w,C,a){a.d(C,"a",function(){return b});w=a(0);class b{}b.tOc="b-ring_Apc_Trans";b.zAg="cdn_static_resource_ewa_image";Object(w.a)(b,"ResourceHosts",null,[])},1114:function(w,C,a){a.d(C,"a",function(){return h});w=a(0);var b=a(63),c=a(1214);class h{static cod(k,
d,f,u){u=void 0===u?null:u;h.pwc||(h.pwc=Array.isArray(b.a.Fk(f.xa.NetworkMeasurementUrlList))?b.a.Fk(f.xa.NetworkMeasurementUrlList):null);const r=[];for(let t=0;t<h.pwc.length;t++){const v=h.pwc[t];let x=v.key;x||(x=v.Key);if(u&&!u.includes(x))continue;let m=v.value;m||(m=v.Value);x&&m&&r.push(new c.a(f,x,m,k,d))}return r}}h.pwc=null;Object(w.a)(h,"NetworkConnectionHelpers",null,[])},1116:function(w,C,a){a.d(C,"a",function(){return k});w=a(0);var b=a(14),c=a(41),h=a(64);a=a(745);class k extends a.a{constructor(d,
f){super(d,f);b.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");this.title="";this.message=k.zCa;this.HAa=!0}get linkText(){return k.lFf}Mqa(d){super.Mqa(d);c.a.openWindow(4,h.a.zK(k.kFf))}pG(d){super.pG(d);k.MHd&&k.MHd(null)}static initialize(d,f,u,r){b.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");k.zCa=d;k.lFf=f;k.kFf=u;k.MHd=r}}k.zCa=null;k.lFf=null;k.kFf=null;k.MHd=null;Object(w.a)(k,"WacGdprNoticeBusinessBarEntry",
a.a,[])},1117:function(w,C,a){a.d(C,"a",function(){return b});w=a(0);class b{}b.QHh="ewa-bb";b.SHh="ewa-bb-entry";b.$Hh="ewa-bb-react";b.THh="ewa-bb-entry-body";b.ZHh="ewa-bb-icon";b.VHh="ewa-bb-entry-icon";b.YHh="ewa-bb-entry-title";b.XHh="ewa-bb-entry-message";b.n1e="ewa-bb-entry-button";b.WHh="ewa-bb-entry-link";b.UHh="ewa-bb-entry-close";b.o1e="ewa-bb-entry-button-holder";b.RHh="ewa-bb-content";Object(w.a)(b,"CssClassNames",null,[])},1118:function(w,C,a){a.d(C,"a",function(){return b});w=a(0);
a=a(745);class b extends a.a{constructor(c,h){super(c,h);this.gu=!0;this.title=b.q5;this.message=b.p5}get actionButton(){return b.O_}to(c){super.to(c);(c=b.YV)&&c(null)}static initialize(c,h,k,d){b.q5=c;b.p5=h;b.O_=k;b.YV=d}}b.q5=null;b.p5=null;b.O_=null;b.YV=null;Object(w.a)(b,"AutomaticSensitivityLabelBusinessBarEntry",a.a,[])},1119:function(w,C,a){a.d(C,"a",function(){return b});w=a(0);a=a(745);class b extends a.a{constructor(c,h){super(c,h);this.gu=!0;this.title=b.q5;this.message=b.p5}get actionButton(){return b.O_}to(c){super.to(c);
(c=b.YV)&&c(null)}static initialize(c,h,k,d){b.q5=c;b.p5=h;b.O_=k;b.YV=d}}b.q5=null;b.p5=null;b.O_=null;b.YV=null;Object(w.a)(b,"RecommendedSensitivityLabelBusinessBarEntry",a.a,[])},1120:function(w,C,a){a.d(C,"a",function(){return b});w=a(0);a=a(884);class b extends a.a{constructor(c,h,k){super(c,h,k);b.O_&&b.YV&&(this.gu=!0);this.title=b.q5;this.message=b.p5}get actionButton(){return b.O_}static initialize(c,h,k,d){b.q5=c;b.p5=h;b.O_=k;b.YV=d}to(c){super.to(c);b.YV&&b.YV(null)}}b.q5=null;b.p5=null;
b.O_=null;b.YV=null;Object(w.a)(b,"DataCleansingBusinessBarEntry",a.a,[])},1121:function(w,C,a){a.d(C,"a",function(){return b});w=a(0);a=a(745);class b extends a.a{constructor(c,h){super(c,h);this.gu=!0;this.title=b.q5;this.message=b.p5}get actionButton(){return b.O_}to(c){super.to(c);(c=b.YV)&&c(null)}static initialize(c,h,k,d){b.q5=c;b.p5=h;b.O_=k;b.YV=d}}b.q5=null;b.p5=null;b.O_=null;b.YV=null;Object(w.a)(b,"MandatorySensitivityLabelBusinessBarEntry",a.a,[])},1122:function(w,C,a){a.d(C,"a",function(){return b});
w=a(0);a=a(745);class b extends a.a{constructor(c,h){super(c,h);this.gu=!0;this.title=b.HLb;this.message=b.zCa}get actionButton(){return b.Xdb}to(c){super.to(c);b.BCa&&b.BCa(null)}static initialize(c,h,k,d){b.HLb=c;b.zCa=h;b.Xdb=k;b.BCa=d}}b.HLb=null;b.zCa=null;b.Xdb=null;b.BCa=null;Object(w.a)(b,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",a.a,[])},1123:function(w,C,a){a.d(C,"a",function(){return b});w=a(0);a=a(745);class b extends a.a{constructor(c,h){super(c,h);b.Xdb&&b.BCa&&(this.gu=
!0);this.title=b.HLb;this.message=b.zCa}get actionButton(){return b.Xdb}to(c){super.to(c);b.BCa&&b.BCa(null)}static initialize(c,h,k,d){b.HLb=c;b.zCa=h;b.Xdb=k;b.BCa=d}}b.HLb=null;b.zCa=null;b.Xdb=null;b.BCa=null;Object(w.a)(b,"SensitivityApplicationSetLabelErrorBusinessBarEntry",a.a,[])},1125:function(w,C,a){a.d(C,"a",function(){return b});const b=c=>{const h=Array(c.length);for(let k=0,d=c.length;k<d;k++)h[k]=c[k].cloneNode(!0);return h}},1173:function(w,C,a){a.r(C);w=a(0);var b=a(14),c=a(92),h=
a(117),k=a(13),d=a(96),f=a(57),u=a(31),r=a(32),t=a(12),v=a(249),x=a(1117),m=a(6),l=a(275),n=a(1118),z=a(745),y=a(1001),B=a(884);class G extends B.a{constructor(Fa,Ha,Na){super(Fa,Ha,Na)}pG(Fa){super.pG(Fa)}}Object(w.a)(G,"EditAttemptReadOnlyBusinessBarEntry",B.a,[]);var E=a(46);class J extends z.a{constructor(Fa,Ha,Na,W){super(Fa,Ha);this.error=Na;this.options=W;this.error&&this.options&2&&(this.message=this.error.Description);this.error&&this.options&1&&(this.title=this.error.Caption);this.gu=!(W&
4)}to(Fa){super.to(Fa);this.error.Appearance&=-33;E.a(this.businessBar.$).pv([this.error])}}Object(w.a)(J,"ErrorBusinessBarEntry",z.a,[]);var I=a(93);class R extends J{constructor(Fa,Ha,Na,W,U){super(Fa,Ha,Na,W);this.command=U;this.GY=!0}sZ(Fa){super.sZ(Fa);this.businessBar.$.Ha.Ad(new I.a(this.command,Fa,this.businessBar.$.se,10,null))}}Object(w.a)(R,"ErrorAndCommandBusinessBarEntry",J,[]);var X=a(16);class H{constructor(Fa,Ha,Na,W,U,za,ua,$a,Va,hb){this.mM=this.Kba=this.lS=0;this.iGg=Fa;this.E$j=
Ha;this.nM=Na;this.wKg=ua;this.wpb=u.a.Ly(Va);this.EIg=Va;this.Dfe=$a;this.xKg=hb;0!==W&&(this.lS=W);0!==U&&(this.Kba=U);0!==za&&(this.mM=za)}get title(){return H.ia(this.E$j)}get message(){return H.ia(this.nM)}get messageId(){return this.nM}get iconName(){return this.xKg}get p5a(){return this.iGg}get actionButton(){return H.ia(this.lS)}get sLa(){return H.ia(this.Kba)}get link(){return H.ia(this.mM)}get Bn(){return this.wKg}get businessBarType(){return this.Dfe}get hash(){return this.wpb}get alt(){const {BusinessBarControl:Fa}=
a(1173);switch(this.Bn){case Fa.Zma:return H.ia(26);case Fa.wy:return H.ia(25);case Fa.tk:return H.ia(24);default:return H.ia(0)}}get aza(){return this.EIg}set businessBarType(Fa){this.Dfe=Fa}static ia(Fa){return X.a.instance.ia(Fa)}}Object(w.a)(H,"EwaBusinessBarEntry",null,[]);class M extends H{constructor(Fa,Ha,Na,W,U,za,ua,$a,Va){super(Fa,0,Ha,Na,W,U,za,ua,$a,Va)}get title(){return""}}Object(w.a)(M,"EwaNoTitleBusinessBarEntry",H,[]);var O=a(75);class L extends z.a{constructor(Fa,Ha){super(Fa,Ha);
this.GY=this.gu=!0}to(Fa){super.to(Fa);this.set_visible(!1);this.businessBar.$.xL();this.businessBar.$.Ha.Ad(new I.a(1038998010,Fa,this.businessBar.$.se,10,null))}sZ(Fa){super.sZ(Fa);this.businessBar.$.Ha.Ad(new I.a(-722953877,Fa,this.businessBar.$.se,10,null))}pG(Fa){this.businessBar.removeEntry(55);O.g(Fa)}}Object(w.a)(L,"ExternalLinksEnableContentBusinessBarEntry",z.a,[]);class S extends z.a{constructor(Fa,Ha){super(Fa,Ha);this.gu=!0;this.GY=!1}to(Fa){super.to(Fa);this.businessBar.$.Ha.Ad(new I.a(-722953877,
Fa,this.businessBar.$.se,10,null))}pG(Fa){this.businessBar.removeEntry(5);O.g(Fa)}}Object(w.a)(S,"ExternalLinksShowErrorBusinessBarEntry",z.a,[]);var T=a(11);class V extends z.a{constructor(Fa,Ha,Na){super(Fa,Ha);this.JFb=Na;this.gu=!0}to(Fa){super.to(Fa);T.HelperMethods.ZU(this.businessBar.$.GG,this.JFb,this.businessBar.$.eS)}}Object(w.a)(V,"HelpButtonBusinessBarEntry",z.a,[]);class la extends z.a{constructor(Fa,Ha,Na){super(Fa,Ha);this.JFb=Na;this.HAa=!0}Mqa(Fa){super.Mqa(Fa);T.HelperMethods.ZU(this.businessBar.$.GG,
this.JFb,this.businessBar.$.eS)}}Object(w.a)(la,"HelpTextBusinessBarEntry",z.a,[]);var Z=a(77);class da extends z.a{constructor(Fa,Ha,Na,W){super(Fa,Ha);this.JFb=Na;this.command=W;this.HAa=!0;this.gu=1461300262!==W}to(Fa){super.to(Fa);this.businessBar.$.Ha.Ad(new I.a(this.command,Fa,this.businessBar.$.se,10,null))}Mqa(Fa){super.Mqa(Fa);const Ha=new I.a(-859308420,Fa,this.businessBar.$.se,12,null);this.businessBar.$.Ha.Ad(Ha,{[Z.a.Th]:"HelpID="+this.JFb,["InputMethod"]:Fa,[Z.a.We]:m.a.xN,[m.a.Eia]:!0})}}
Object(w.a)(da,"HelpTextTaskPaneAndCommandBusinessBarEntry",z.a,[]);class ba extends z.a{constructor(Fa,Ha){super(Fa,Ha);this.GY=this.gu=!0}to(Fa){super.to(Fa);this.set_visible(!1);this.businessBar.$.xL();this.businessBar.$.Ha.Ad(new I.a(-1081442996,Fa,this.businessBar.$.se,10,null))}sZ(Fa){super.sZ(Fa);this.businessBar.$.Ha.Ad(new I.a(1702917262,Fa,this.businessBar.$.se,10,null))}pG(Fa){this.businessBar.removeEntry(59);O.g(Fa)}}Object(w.a)(ba,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",
z.a,[]);var na=a(1121);class Y extends z.a{constructor(Fa,Ha){super(Fa,Ha);(this.policyManager=Fa.$.ga.Da(274))?(this.message=this.policyManager.xAc,this.title=this.policyManager.title,this.HAa=!0):b.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered.")}get linkText(){return this.policyManager.linkText}Mqa(Fa){super.Mqa(Fa);(Fa=this.policyManager.Iaj)&&Fa(null)}}Object(w.a)(Y,"PolicyBusinessBarEntry",z.a,[]);var Ga=a(1119),ma=
a(1123),fa=a(1122);a(428);var Xa=a(110),Ua=a(27);class ka extends z.a{constructor(Fa,Ha){super(Fa,Ha);this.gu=!0;this.title=""}to(Fa){super.to(Fa);Xa.c(Ua.a.R_i);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")}}Object(w.a)(ka,"UnsupportedBrowserBusinessBarEntry",z.a,[]);var nb=a(1116),Ea=a(79),sb=a(908),Oa=a(965),La=a(1187);class ia{constructor(){this.KPc=new La.a;this.IPc=new La.a;this.HPc=new La.a;this.C9g(this.KPc);this.B9g(this.IPc);this.A9g(this.HPc);this.PUc=new La.a;
this.OUc=new La.a;this.NUc=new La.a;this.cbh(this.PUc);this.bbh(this.OUc);this.abh(this.NUc);this.bRc=new La.a;this.V9g(this.bRc);this.NKa(this.bRc);this.NKa(this.HPc);this.NKa(this.IPc);this.NKa(this.KPc);this.NKa(this.OUc);this.NKa(this.PUc);this.NKa(this.NUc)}Uhi(Fa,Ha){switch(Fa){case 1:return this.nli(Ha);case 2:return this.W1h(Ha)}return Oa.a.D3d?this.bRc:null}C9g(Fa){Fa.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);Fa.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
Fa.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}B9g(Fa){Fa.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);Fa.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);Fa.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}A9g(Fa){Fa.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);Fa.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);Fa.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}cbh(Fa){Fa.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);Fa.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);Fa.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);Fa.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);Fa.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);Fa.add("OverlayBig","Get the Word app");Fa.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");Fa.add("OverlaySmallSplit1",
"Discover Word");Fa.add("OverlaySmallSplit2","designed for the iPad.");Fa.add("SkipButton","Skip for now")}V9g(Fa){Fa.add("Headline","Get the Office Online extension for Chrome");Fa.add("UseAppButton","Get the extension");Fa.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}bbh(Fa){Fa.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);Fa.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);Fa.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);
Fa.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);Fa.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);Fa.add("OverlayBig","Get the PowerPoint app");Fa.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");Fa.add("OverlaySmallSplit1","Discover PowerPoint");Fa.add("OverlaySmallSplit2","designed for the iPad.");Fa.add("SkipButton","Skip for now")}abh(Fa){Fa.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);
Fa.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);Fa.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);Fa.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);Fa.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}NKa(Fa){Fa.add("Corporation","Microsoft Corporation")}nli(Fa){switch(Fa){case 3:return this.PUc;case 2:return this.OUc;case 1:return this.NUc}return null}W1h(Fa){switch(Fa){case 3:return this.KPc;case 2:return this.IPc;
case 1:return this.HPc}return null}static get instance(){ia.La||(ia.La=new ia);return ia.La}}ia.La=null;Object(w.a)(ia,"WildFireStringFactory",null,[]);var Sa=a(5),Za=a(41);class Ab{constructor(Fa,Ha,Na,W,U,za){this.jZc=null;this._id=Fa;this.UZc=Ha;this.QJg=void 0===U?null:U;this.Spb=W;this.isb=void 0===za?null:za;this.zHa=null;this.Z2a=Na;this.Msb=ia.instance.Uhi(Ha,Fa)}qSe(){this.zHa=new sb.a(this.title,this.message,null);this.zHa.addButton(this.aKe,Object(Ea.a)(this,this.RLf,"onButtonOneClick"),
"");this.Z2a&&this.zHa.$Wg(this.cKe,Object(Ea.a)(this,this.ULf,"onButtonTwoClick"));this.zHa.Uda=Object(Ea.a)(this,this.QXe,"dismissBar");this.zHa.image=3;this.zHa.id=16;this.zHa.closeable=!0}get title(){return this.Msb.ma("Headline")}get message(){return this.Msb.ma("CallToAction")}get Zkk(){return this.Z2a}get aKe(){return this.Z2a?this.Msb.ma("InstallButton"):this.Msb.ma("UseAppButton")}get cKe(){return this.Z2a?this.Msb.ma("OpenAppButton"):""}RLf(){this.Z2a?this.Oyi():this.Pkk()}ULf(){this.Z2a&&
this.jhj()}get openUrl(){this.jZc||(this.jZc=this.QJg());return this.jZc}Oyi(){b.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.Spb&&this.isb&&this.isb();Oa.a.K3f(this._id,this.UZc)}jhj(){this.openUrl&&(b.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Spb&&this.isb&&this.isb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(Oa.a.$Ee(this._id),this.openUrl,0,!1))}Pkk(){Oa.a.D3d?this.hbh():(b.ULS.sendTraceTag(17109255,
306,50,"AppBusinessBarNav"),Oa.a.B1d("BizBarClicked"),1!==this.UZc&&2!==this.UZc||Oa.a.Lhh(this.openUrl,this.Spb,this._id,this.isb))}hbh(){this.Spb?b.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):b.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");Za.a.f2(Sa.AFrameworkApplication.da.appSettings.WildFireChromeExtensionUrl.toString())}yAh(){this.Spb?b.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):b.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");Oa.a.B1d(Oa.a.wgh)}QXe(){Oa.a.D3d?
this.yAh():(Oa.a.B1d(Oa.a.yaf(this._id)),b.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static Wuh(){const Fa=Sa.AFrameworkApplication.sa.Ra,Ha=new Ab(Fa.kj,Oa.a.rjf(),8<r.a.YFb,1===Fa.cDa,()=>Fa.Ju,Fa.NJj());b.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return Ha}}Object(w.a)(Ab,"WildFireBusinessBar",null,[]);class pb extends z.a{constructor(Fa,Ha){super(Fa,Ha);this.gHa=Ab.Wuh();this.gu=!0;this.GY=this.gHa.Zkk;this.title=this.gHa.title;this.message=this.gHa.message}get actionButton(){return this.gHa.aKe}get sLa(){return this.gHa.cKe}to(Fa){super.to(Fa);
this.gHa.RLf(null)}sZ(Fa){super.sZ(Fa);this.gHa.ULf(null)}pG(Fa){super.pG(Fa);this.gHa.QXe(null)}}Object(w.a)(pb,"WildFireMobileAppBusinessBarEntry",z.a,[]);var Tb=a(260),ob=a(22),va=a(192),Pa=a(171),jb=a(49),Ob=a(2),kb=a(175),ra=a(1124),rb=a(73),Kb=a(142),Sb=a(565),cb=a(1);class cc extends z.a{constructor(Fa,Ha,Na,W){super(Fa,Ha);this.officeScriptsCommandManager=Na.ga.Da(519);b.ULS.shipAssertTag(512276321,0,!!this.officeScriptsCommandManager);this.id=kb.a.create();this.$=Na;this.title=X.a.instance.ia(2282);
this.message="";this.c6d=X.a.instance.ia(2278);this.Byg=X.a.instance.ia(2279);this.zyg=X.a.instance.ia(2280);this.FQe=X.a.instance.ia(2281);this.update(W)}update(Fa){this.scriptLink=Fa.scriptLink;this.runStatus=Fa.runStatus;this.buttonText=Fa.buttonText||"";this.BRi(Fa.clickId);this.aGj();"preparing"===this.runStatus?(this.qsa(0),this.message=String.format(X.a.instance.xd(208),this.buttonText),this.gu=!0,this.Fwa=this.c6d,this.Hxb=this.Pka=this.Lfb):"running"===this.runStatus?(this.qsa(0),this.message=
String.format(X.a.instance.xd(207),this.buttonText),this.gu=!0,this.Fwa=this.c6d,this.Hxb=this.Pka=this.Lfb):"succeeded"===this.runStatus?(this.qsa(0),this.message=String.format(X.a.instance.xd(210),this.buttonText),"true"===Fa.hasLogs?(this.gu=!0,this.Fwa=this.zyg,this.Pka=this.LVf,this.GY=!0,this.C6c=this.Byg,this.D6c=this.MVf):(this.gu=!0,this.Fwa=this.Byg,this.Pka=this.MVf)):"runFailed"===this.runStatus?(this.qsa(1),this.message=String.format(X.a.instance.xd(209),this.buttonText),this.sab=sc.Zma,
"true"===Fa.hasLogs?(this.gu=!0,this.Fwa=this.zyg,this.Pka=this.LVf,"false"===Fa.isOwner&&(this.GY=!0,this.C6c=this.FQe,this.D6c=this.$Mf)):"false"===Fa.isOwner&&(this.gu=!0,this.Fwa=this.FQe,this.Pka=this.$Mf)):"fetchFailed"===this.runStatus?(this.qsa(1),this.sab=sc.Zma,this.message=X.a.instance.ia(2284)):"canceled"===this.runStatus?(this.qsa(0),this.sab=sc.wy,this.message=String.format(X.a.instance.xd(212),this.buttonText)):"alreadyRunning"===this.runStatus?(this.qsa(5),this.sab=sc.wy,this.message=
String.format(X.a.instance.xd(211),this.buttonText),this.gu=!0,this.Fwa=this.c6d,this.Hxb=this.Pka=this.Lfb):"initializing"===this.runStatus&&(this.qsa(0),this.sab=sc.tk,this.message=X.a.instance.ia(2283))}get Bn(){return this.sab}get actionButton(){return this.Fwa}get sLa(){return this.C6c}to(Fa){super.to(Fa);this.Pka&&this.Pka()}sZ(Fa){super.sZ(Fa);this.sLa&&this.D6c()}pG(Fa){super.pG(Fa);this.Hxb&&this.Hxb()}aGj(){this.message="";this.sab=sc.tk;this.gu=!1;this.Fwa="";this.Pka=void 0;this.GY=!1;
this.C6c="";this.D6c=void 0;this.hideCloseButton=!1;this.Hxb=void 0}Lfb(){const Fa=kb.a.create().toString();this.officeScriptsCommandManager.Bmi(Fa);this.suc(-2186799,Fa)}LVf(){const Fa=kb.a.create().toString();this.officeScriptsCommandManager.Ami(Fa);this.suc(1036446140,Fa)}MVf(){const Fa=kb.a.create();if(this.scriptLink)if(cb.EwaSettings.getBooleanFeatureGate(Sb.a.eDa,!1))this.officeScriptsCommandManager.Qud(this.id.toString(),this.scriptLink,Fa);else{const Ha=new ra.b(this.scriptLink);this.officeScriptsCommandManager.Qud(this.id.toString(),
JSON.stringify(Ha),Fa)}this.suc(-585097204,Fa.toString())}$Mf(){const Fa=kb.a.create().toString();this.officeScriptsCommandManager.zmi(Fa);this.suc(-639858579,Fa)}BRi(Fa){const Ha=[];Ha.push(Object(Ob.a)(new rb.a,{name:"id",string:this.id.toString()}));Ha.push(Object(Ob.a)(new rb.a,{name:"hasScriptLink",bool:!!this.scriptLink}));Ha.push(Object(Ob.a)(new rb.a,{name:"runStatus",string:this.runStatus}));Ha.push(Object(Ob.a)(new rb.a,{name:"clickId",string:Fa}));Ha.push(Object(Ob.a)(new rb.a,{name:"hasButtonText",
bool:!!this.buttonText&&""!==this.buttonText}));Xa.a(Kb.a.w2i,void 0,void 0,Ha)}suc(Fa,Ha){const Na=[];Na.push(Object(Ob.a)(new rb.a,{name:"id",string:this.id.toString()}));Na.push(Object(Ob.a)(new rb.a,{name:"hasScriptLink",bool:!!this.scriptLink}));Na.push(Object(Ob.a)(new rb.a,{name:"runStatus",string:this.runStatus}));Na.push(Object(Ob.a)(new rb.a,{name:"clickId",string:Ha}));Xa.d(Fa,void 0,void 0,void 0,void 0,void 0,Na)}}Object(w.a)(cc,"OfficeScriptsRunStatusBusinessBarEntry",z.a,[]);var Ub=
a(137),wb=a(15),vc=a(54);class Lb extends B.a{constructor(Fa,Ha,Na,W,U,za){super(Fa,Ha,Na);vc.a.instance.create(()=>{this.showCallout(Ha,W)},U,za,!0,!0)}showCallout(Fa,Ha){if(this.businessBar&&this.businessBar.jpa(Fa.p5a)&&this.YDe()){Fa=new I.a(-847286761,0,this.businessBar.$.se,0,null);var Na={};Na.CalloutName=Ha;cb.EwaSettings.isChangeGateEnabled("OfficeVSO:6947554_RetrieveBusinessBarButtonElementChange")?Na.Target=this.lN():Na.Target=cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",
!1)?this.domElement.getElementsByTagName("button")[0]:this.lS.domElement;this.businessBar.$.Ha.Ad(Fa,Na)}}YDe(){return!0}}Object(w.a)(Lb,"CalloutBusinessBarEntry",B.a,[]);class Ja extends Lb{constructor(Fa,Ha,Na,W,U,za){super(Fa,Ha,Na,W,U,za)}YDe(){if(!cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1))return!0;if(!this.businessBar)return!1;const Fa=cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2OptimizeWorkbookManager",
!1)?Ub.a.zg(wb.bc):this.businessBar.$.ga.Da(465);return Fa&&Fa.hFc?!1:!0}}Object(w.a)(Ja,"OptimizeWorkbookCalloutBusinessBarEntry",Lb,[]);var Hb=a(18),gc=a(118);class ec extends z.a{constructor(Fa,Ha,Na){super(Fa,Ha);this.update(Na)}update(Fa){this.title=Fa.title?Fa.title:"";this.message=Fa.message?Fa.message:"";const Ha=this.dnh(Fa.businessBarType);this.qsa(Ha);this.hideCloseButton=!!Fa.hideCloseButton;if(cb.EwaSettings.isChangeGateEnabled("OfficeVSO:7958899_LogMsFormsDataSyncBizBarShown")){const Na=
[];Na.push(gc.a.Yg("Reason",Fa.reason,2));Na.push(gc.a.Yg("Type",Ha.toString(),2));Xa.a("MsFormsDataSyncBizBarShown",void 0,void 0,Na)}}dnh(Fa){switch(Fa){case "error":return 1;case "blocked":return 2;case "severeWarning":return 3;case "success":return 4;case "warning":return 5;default:return 0}}}Object(w.a)(ec,"MsFormsDataSyncStatusBusinessBarEntry",z.a,[]);class Ta extends z.a{constructor(Fa,Ha,Na,W){super(Fa,Ha);this.GY=this.gu=!0;this.Ioj=Na;this.I2g=W}to(Fa){super.to(Fa);this.businessBar.$.Ha.Ad(new I.a(this.Ioj,
Fa,this.businessBar.$.se,10,null))}sZ(Fa){super.to(Fa);this.businessBar.$.Ha.Ad(new I.a(this.I2g,Fa,this.businessBar.$.se,10,null))}}Object(w.a)(Ta,"DualCommandActionsBusinessBarEntry",z.a,[]);class ib extends z.a{constructor(Fa,Ha,Na,W){super(Fa,Ha);this.host=Na.xa.HostName;this.wsi="OneDriveWOPI"===this.host||"Open From URL"===this.host;"Open From URL"===this.host?appChrome.renderSaveACopyToOneDriveCallout(W,!1):(this.IJi=cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDrive",
!1)||cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDriveB",!1)||cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveACopyToOneDriveC",!1))&&this.wsi&&appChrome.renderSaveACopyToOneDriveCallout(W,!1)}}Object(w.a)(ib,"EditAttemptReadOnlyNoEditPermissionsBusinessBarEntry",z.a,[]);var bc=a(1120),jc=a(328);a.d(C,"BusinessBarControl",function(){return sc});class sc extends v.a{constructor(Fa,Ha){super(Ha);this.P8e=t.DOMElementExtensions.Uu+",div";
this.CX=Array(74);this.$o=!1;this.uZ=Na=>{if(Na.Ba.keyCode===c.a.HE){var W=this.Ce.querySelectorAll(this.P8e);const U=t.DOMElementExtensions.vr(W);W=t.DOMElementExtensions.aQ(W);return t.DOMElementExtensions.oFa(Na.Ba,U,W)}return!1};this.vd=Fa;this.set_visible(!1);this.addCssClass(x.a.QHh);cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&this.addCssClass(x.a.$Hh);h.KeyInputManager.instance.ta(k.a.me,this.Ce,this.uZ);l.a(Fa).vk(this)}get jg(){return Tb.a.G9c}get Ce(){return this.domElement}get zi(){return this.get_visible()}get $(){return this.vd}Pi(Fa,
Ha){cb.EwaSettings.isChangeGateEnabled("OfficeVSO:7627987_BizBarA11yFocusFix")?Ha||t.DOMElementExtensions.setFocus(t.DOMElementExtensions.vr(this.Ce.querySelectorAll(this.P8e))):Ha||t.DOMElementExtensions.setFocus(this.domElement.firstChild);return!Ha}Nj(Fa){return t.DOMElementExtensions.mi(this.Ce,Fa)}Ll(){}lm(){}dispose(){this.$o||(h.KeyInputManager.instance.Aa(k.a.me,this.Ce,this.uZ),d.a.Fe(this.CX),this.CX=Array(74),this.vd=null,super.dispose(),this.$o=!0)}jpa(Fa){if(!this.get_visible())return!1;
Fa=this.CX[Fa];return!!Fa&&Fa.isVisible}Hod(Fa){return this.jpa(Fa)?this.CX[Fa].lN():null}yH(Fa){return!!this.CX[Fa]}UXb(Fa,Ha){if(Fa=this.CX[Fa])Fa.update(Ha),Fa.Ngk()}tD(Fa,Ha,Na,W){Na=void 0===Na?null:Na;W=void 0===W?null:W;let U=!1;if(this.yH(Fa))Na=this.CX[Fa].get_visible();else{this.set_visible(!0);const za=sc.yjf()[Fa];this.CX[Fa]=this.u1(Fa,Ha,Na,W);Na=!1;U=!0;W="";let ua=0;Ha&&(W=Ha.MessageIdName,ua=Ha.MessageId);const $a=za.aza,Va=jb.PageLoadTrackingInfo.instance.foa(new Date);b.ULS.sendTraceTag(537170258,
0,50,`BusinessBarControl.AddEntry of type: ${Fa}, time from app interactive: ${Va}`);cb.EwaSettings.isChangeGateEnabled("OfficeVSO:7232357_AvoidBsqmReportingForSuccessBizBars")&&4===za.businessBarType||Pa.a(this.$).SWd(za.hash,W,ua,f.a.ILc,!0,1,Ha,$a)}Na||!y.BusinessBarManager.fmc().includes(Fa)&&!U||(this.CX[Fa].set_visible(!0),this.$.xL())}removeEntry(Fa){return this.nzj(Fa)}QUd(){d.a.Fe(this.CX);this.CX=Array(74);this.set_visible(!1)}nzj(Fa){if(!this.yH(Fa))return!1;d.a.Ma(this.CX[Fa]);this.CX[Fa]=
null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.xL();return!0}u1(Fa,Ha,Na,W){Na=void 0===Na?null:Na;W=void 0===W?null:W;const U=sc.yjf()[Fa],za=!!(this.$.If&64);switch(Fa){case 23:Fa=new ib(this,U,this.vd,this.Ce);break;case 2:case 4:case 25:case 26:case 36:case 35:Fa=new z.a(this,U);break;case 12:case 29:case 30:case 31:case 32:case 57:Fa=za?new B.a(this,U,-8805455):new z.a(this,U);break;case 34:Fa=za?new Ta(this,U,-8805455,-104572626):new z.a(this,U);break;case 22:Fa=new G(this,
U,-8805455);break;case 46:case 45:Fa=za?new R(this,U,Ha,0,-8805455):new J(this,U,Ha,0);break;case 11:case 43:case 7:case 0:case 1:case 3:case 33:Fa=new J(this,U,Ha,0);break;case 19:Fa=new z.a(this,U);break;case 47:Fa=new J(this,U,Ha,0);break;case 6:case 14:Fa=new V(this,U,Ha.HelpTopicId);break;case 67:case 65:Fa=new la(this,U,Ha.HelpTopicId);break;case 73:Fa=new la(this,U,jc.a.jZf);break;case 72:Fa=new G(this,U,-1698025133);break;case 37:Fa=new la(this,U,m.a.$vh);break;case 38:Fa=new z.a(this,U);
break;case 71:Fa=new z.a(this,U);break;case 68:Fa=new G(this,U,924877417);break;case 16:Fa=new z.a(this,U);Fa.title=u.a.nm(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);Fa.message=u.a.nm(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:Fa=new B.a(this,U,-1762562205);Fa.hideCloseButton=!0;break;case 20:Fa=new pb(this,U);break;case 21:case 56:Fa=new z.a(this,U);break;case 28:Fa=new z.a(this,U);break;case 24:Fa=new ka(this,U);break;case 27:Fa=new Y(this,U);break;
case 39:Fa=new nb.a(this,U);break;case 40:Fa=new n.a(this,U);break;case 41:Fa=new Ga.a(this,U);break;case 42:Fa=new na.a(this,U);break;case 48:Fa=new z.a(this,U);break;case 49:Fa=new z.a(this,U);break;case 50:Fa=new z.a(this,U);break;case 51:Fa=new z.a(this,U);break;case 52:Fa=new z.a(this,U);break;case 53:Fa=new fa.a(this,U);break;case 54:Fa=new ma.a(this,U);break;case 55:Fa=new L(this,U);break;case 5:Fa=new S(this,U);break;case 58:Fa=new B.a(this,U,-1753056834);Ha?(Ha=Ha.Directive,ob.a.ns(Ha)||
"&nbsp;"===Ha||(Fa.message=Ha)):Na&&(Fa.message=Na);break;case 59:Fa=new ba(this,U);break;case 60:Fa=new z.a(this,U);break;case 63:Fa=new la(this,U,m.a.x1i);break;case 61:Fa=new da(this,U,m.a.p7g,-8805455);break;case 66:Fa=new da(this,U,m.a.juj,1461300262);break;case 62:Fa=new Ja(this,U,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout");Fa.message=Na;break;case 70:Fa=new bc.a(this,U,-1190551534);break;case 64:Fa=new cc(this,U,this.$,W);break;case 69:Fa=new ec(this,U,W);break;
default:Fa=new J(this,U,Ha,7)}Fa.qSe();return Fa}static yjf(){let Fa;Fa=va.a.mpa()?261:260;return sc.QJe||(sc.QJe=[new H(0,276,277,278,0,0,sc.Zma,1,"BB_UnableToRefreshLock"),new H(1,276,277,278,0,0,sc.Zma,1,"BB_UnableToRefreshLockExpected"),new H(2,268,269,0,0,0,sc.wy,5,"BB_WorkbookAlmostTooLarge"),new H(3,270,271,272,0,0,sc.Zma,1,"BB_WorkbookTooLarge"),new H(4,259,Fa,0,0,0,sc.wy,5,"BB_ExternalWorkbookLinksDisabled"),new H(5,263,262,264,0,0,sc.Zma,5,"BB_ExternalWorkbookLinksShowError","Warning_MessageBar_16"),
new H(6,265,266,267,0,0,sc.tk,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new H(7,251,252,253,0,0,sc.tk,5,"BB_UnsupportedFeatures"),new H(8,0,0,0,0,0,sc.tk,0,"BB_CollabDataAndDataStringsLocaleMismatch"),new H(9,0,0,0,0,0,sc.tk,0,"BB_CollabDataStringsLocaleMismatch"),new H(10,0,0,0,0,0,sc.tk,0,"BB_CollabDataLocaleMismatch"),new H(11,279,280,281,0,0,sc.Zma,1,"BB_LastGenericStatusError"),new H(12,282,283,284,0,0,sc.wy,5,"BB_ScratchPadWarning"),new H(13,285,286,287,0,0,sc.Zma,1,"BB_AuthenticationLost"),
new H(14,288,289,290,0,0,sc.wy,5,"BB_OdfCompatibilityIssues"),new H(15,0,575,0,0,0,sc.wy,5,"BB_PivotChartInteractivityMissingWarning"),new H(16,0,0,0,0,0,sc.tk,2,"BB_WorkbookIsIrmProtected"),new H(17,0,0,0,0,0,sc.tk,0,"BB_BIFeatureNotAvailable"),new H(18,291,292,287,0,0,sc.wy,5,"BB_AnonymousCreateMode"),new H(19,254,255,0,0,0,sc.wy,5,"BB_UnsupportedInteractiveReportEditing"),new H(20,0,0,0,0,0,sc.tk,0,"BB_MobileAppCampaignBizBar"),new H(21,297,298,0,0,0,sc.tk,0,"BB_TransientServerCommunicationFailures"),
new H(22,1643,1654,1655,0,0,sc.tk,5,"BB_EditAttemptInReadOnly"),new H(23,1643,1654,0,0,0,sc.tk,5,"BB_EditAttemptInReadOnlyNoEditPermissions"),new H(24,0,T.HelperMethods.hgk(),1632,0,0,sc.tk,3,"BB_UnsupportedBrowser"),new H(25,300,301,0,0,0,sc.tk,2,"BB_ReadOnlyPermissions"),new H(26,302,303,0,0,0,sc.tk,2,"BB_DocumentIsIrmProtectedWarning"),new H(27,0,0,0,0,0,sc.wy,5,"BB_PolicyWarningMessage"),new H(28,1285,299,0,0,0,sc.tk,0,"BB_WorkingOnIt"),new H(29,1643,1641,1642,0,0,sc.tk,2,"BB_PasswordProtectedWorkbookLockedForEdit"),
new H(30,1656,1657,1658,0,0,sc.tk,5,"BB_WorkbookIsReadOnlyRecommended"),new H(31,1643,1659,1660,0,0,sc.tk,5,"BB_WorkbookHasPasswordToModify"),new H(32,1643,1661,1664,0,0,sc.tk,3,"BB_LegacySharedWorkbookEditWarning"),new H(33,1651,1662,253,0,0,sc.tk,5,"BB_LegacyConnectionsWarning"),new H(34,1643,1960,1961,1962,0,sc.tk,0,"BB_TooManyLoadBlockingFloatingObjects"),new H(35,1652,1653,0,0,0,sc.tk,2,"BB_GroupedSlicers"),new H(36,313,314,0,0,0,sc.wy,5,"BB_ThirdPartyAddinDisabled"),new H(37,1789,1790,0,0,1791,
sc.tk,5,"BB_FinanceLinkedEntityDisclaimerBar"),new H(38,1818,1819,0,0,0,sc.wy,5,"BB_WolframDeprecationAlertBar"),new H(39,0,0,0,0,0,sc.tk,0,"BB_WacGdprNotice"),new H(40,0,0,0,0,0,sc.tk,0,"BB_AutomaticSensitivityLabel"),new H(41,0,0,0,0,0,sc.tk,0,"BB_RecommendedSensitivityLabel"),new H(42,0,0,0,0,0,sc.tk,0,"BB_MandatorySensitivityLabel"),new H(43,315,316,317,0,0,sc.tk,0,"BB_LocalStorageDisabled"),new H(44,632,633,0,0,0,sc.tk,0,"BB_AutoRefreshDisabled"),new H(45,1014,1012,1016,1314,0,sc.tk,4,"BB_CorruptedFileRepaired"),
new H(46,1015,1013,1016,1314,0,sc.tk,5,"CorruptedOdsFileRepaired"),new H(47,273,274,275,0,0,sc.wy,5,"BB_MinorVersionLimitReached"),new H(48,304,305,0,0,0,sc.wy,5,"BB_SensitivityApplicationGenericError"),new H(49,306,308,0,0,0,sc.wy,5,"BB_SensitivityApplicationTooLargeFileError"),new H(50,307,308,0,0,0,sc.wy,5,"BB_SensitivityApplicationLabelNotSupportedError"),new H(51,309,310,0,0,0,sc.wy,5,"BB_SensitivityApplicationLabelDisabledError"),new H(52,311,312,0,0,0,sc.wy,5,"BB_SensitivityApplicationMandatoryConflictError"),
new H(53,0,0,0,0,0,sc.wy,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new H(54,0,0,0,0,0,sc.wy,5,"BB_SensitivityApplicationSetLabelError"),new H(55,2119,2120,2121,2124,0,sc.tk,5,"BB_ExternalWorkbookLinksPromptEnableContent","Warning_MessageBar_16"),new H(56,297,298,0,0,0,sc.tk,0,"BB_NetworkDown"),new H(57,318,319,320,0,0,sc.tk,2,"BB_DefaultToViewDueToCogs"),new H(58,1815,1816,1817,0,0,sc.tk,1,"BB_RefreshLinkedEntityErrorBar"),new H(59,1792,1793,1794,1795,0,sc.tk,1,"BB_LinkedEntitiesUntrustedImagesDisabled"),
new M(60,250,0,0,0,sc.tk,5,"BB_CanvasHealth"),new H(61,1017,1018,1314,0,1019,sc.tk,5,"BB_MismatchedFileFormatConverted"),new H(62,2238,0,2240,0,0,sc.tk,5,"BB_OptimizeWorkbook"),new H(63,321,322,0,0,323,sc.tk,0,"BB_NovModePostDepreciation"),new H(64,0,0,0,0,0,sc.tk,0,"BB_OfficeScriptsRunning"),new H(65,2214,2215,0,0,2217,sc.tk,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new H(66,324,325,0,0,326,sc.tk,5,"BB_ReadOnlyPivotTable"),new H(67,2214,2216,0,0,2217,sc.tk,0,"BB_PowerQueryRefreshHostNotSupported"),
new H(68,1057,r.a.lrc?1059:1058,1056,0,0,sc.tk,4,"BB_RefreshPageAfterEnablingTheExtension"),new H(69,0,0,0,0,0,sc.tk,0,"BB_MsFormsDataSyncStatus"),new H(70,0,0,0,0,0,sc.wy,5,"BB_DataCleansingSuggestions"),new M(71,2324,0,0,0,sc.tk,4,"BB_EditInMiniWAC","EditExcel_16"),new H(72,2326,2327,2325,0,0,sc.wy,5,"BB_PowerQueryUnsupportedTeams"),new H(73,2326,2328,0,0,2217,sc.wy,5,"BB_PowerQueryEnableThirdPartyCookies")])}}sc.Zma=Hb.a.jLh;sc.wy=Hb.a.lLh;sc.tk=Hb.a.kLh;sc.QJe=null;Object(w.a)(sc,"BusinessBarControl",
v.a,[56])},1194:function(w,C,a){w=a(0);var b=a(2),c=a(14),h=a(32),k=a(96),d=a(13),f=a(138),u=a(355),r=a(83),t=a(8),v=a(70),x=a(15),m=a(137),l=a(470);class n{constructor(Ga,ma){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=this.cardViewManager=null;this.$=ma;this.parentElement=Ga}Noh(){const Ga=this.Ooh();l.a(this.$,243,242,0,ma=>{this.cardViewManager=ma;ma.D_j(this.parentElement,Ga)})}cnf(){this.cardViewManager&&this.cardViewManager.iab(-1,
-1,this.parentElement)}Ooh(){const Ga={layoutId:"AutoDetectTooltip"};Ga.description=this.longDescription;Ga.convertToDomainName=this.convertToDomainName;Ga.longDescription=this.longDescription;Ga.urlValue=this.urlValue;Ga.imageAltText=this.imageAltText;Ga.helpText=this.helpText;Ga.helpId=this.helpId;return Ga}}Object(w.a)(n,"AutoDetectCardManager",null,[]);var z=a(35),y=a(220),B=a(31),G=a(234),E=a(18),J=a(56);class I extends r.a{constructor(Ga,ma,fa){super();this.mf=Xa=>{if(Xa.$d.id===this.YNa.firstChild.id){Xa=
this.IHe;const Ua={};Ua.Id=Xa.Pvb;this.convertToLinkedEntityManager.kdd(Ua,!0,Xa);this.YNa.removeChild(this.YNa.firstChild);return!0}return!1};this.IHe=Ga;this.convertToLinkedEntityManager=ma;this.YNa=document.createElement("div");this.YNa.className="clip16x16";this.XAa=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',B.a.nm("autodetectid"+this.IHe.left),E.a.xkd,J.a.Ci(11));fa.Tj(this.YNa,this.XAa);Ga=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");
G.a.instance.ta(d.a.click,Ga,this.mf)}get domElement(){return this.YNa}dispose(){if(this.YNa){const Ga=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");G.a.instance.Aa(d.a.click,Ga,this.mf)}super.dispose()}static get jbh(){return"clip16x16"}}Object(w.a)(I,"AutoDetectColumnHeaderButton",r.a,[]);var R=a(1),X=a(1125),H=a(11),M=a(19),O=a(212);class L extends r.a{constructor(Ga,ma,fa){super();this.Zd=null;this.$=Ga;this.gridView=M.h(Ga);this.convertToLinkedEntityManager=ma;this.Zd=
fa;this.Obd=new O.a}dispose(){super.dispose()}PAh(Ga){for(let ma of this.gridView.ima)for(let fa of ma){const Xa=fa,Ua=Xa.kx,ka=X.a(Xa.X8);this.QUg(Ga,ka,Ua);Xa.N0d(ka)}}QUg(Ga,ma,fa){if(ma.length){var Xa=fa.length;fa[Xa-1]<Ga.left||(fa=H.HelperMethods.cA(new y.a(fa),0,Xa,Ga.left,H.HelperMethods.yI),0>fa||!(ma=ma[fa]))||(this.gridView.rtl?ma.classList.add(z.a.iPh):ma.classList.add(z.a.hPh),this.Obd.kd(Ga.left)||this.Obd.add(Ga.left,new I(Ga,this.convertToLinkedEntityManager,this.Zd)),Ga=this.Obd.ma(Ga.left).domElement,
!ma.getElementsByClassName(I.jbh).length&&this.R3j(ma)&&ma.appendChild(Ga))}}R3j(Ga){const ma=parseInt(Ga.style.width,10);var fa=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";fa=L.zqh(fa);Ga=gridRenderer.CanvasRendererGlobals.measureTextWidth(this.Zd.cgi(Ga.firstChild.innerHTML),fa,!0,R.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<ma-(ma/2+Ga/2)?!0:!1}static zqh(Ga){return`${"normal"} ${"normal"} ${Ga} ${"10pt"}/${"normal"} ${'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif'}`}}
Object(w.a)(L,"AutoDetectColumnHeaderManager",r.a,[]);var S=a(436),T=a(26),V=a(74),la=a(159),Z=a(12),da=a(16),ba=a(110),na=a(73);a.d(C,"a",function(){return Y});class Y extends r.a{constructor(Ga,ma,fa,Xa,Ua){super();this.isMac=h.a.isMac;this.j3a=-1;this.Bdc=null;this.kya=-1;this.eTa=this.ctc=this.C4d=this.eCa=this.JHe=!1;this.hX=null;this.Mh=()=>{this.gBa&&this.gridView&&this.m_()};this.De=()=>{this.fz()};this.mf=()=>{this.hNa();M.h(this.$).Pi(!0,!1)};this.tDa=(nb,Ea)=>{Ea?(this.Hug(this.Bdc),this.nlg()):
(nb=[29],this.gridView.Kd.cm(nb),this.gridView.Kd.kn(null,nb),this.hX&&this.hX.cnf())};this.Rk=()=>{this.Wbb()&&this.wl.hide();1===this.gridView.ha.Bg&&this.m_()};this.qz=()=>{const nb=this.gridView.ha.Bg;this.gridView.ha.ra.activeCell&&1===nb&&this.m_()};this.onKeyUp=nb=>this.Qtc?this.eCa?!1:17===nb.Ba.keyCode&&this.C4d?(this.eTa?(this.nlg(),this.zib()):this.Dfg(),!0):!1:this.eCa=!1;this.onKeyDown=nb=>{if(!this.Qtc)return this.eCa=!1;this.C4d=!1;this.eCa=nb.ctrlKey;switch(nb.Ba.keyCode){case 27:return this.eTa?
(this.tDa(null,!1),this.zib()):this.hX&&(this.hX.cnf(),this.Dfg()),!0;case 13:if(this.eTa)return this.eTa=!1,this.hNa(),!0;break;case 17:return this.C4d=!0}return!1};const {AutoDetectActionButton:ka}=a(1258);this.$=Ga;this.Qvb=R.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);ma||c.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");this.convertToLinkedEntityManager=Xa;Xa.DPb();this.wl=new ka(Ga,ma,this.mf,
fa,"");this.G6g=new L(this.$,Xa,Ua);this.gridView=M.h(this.$);this.gridView.ha.XJ(this.Mh);this.gridView.he.vub(this.Mh);this.gridView.Fu(this.qz);Ga.gk(this.De);Ga.IB(this.Rk);this.gridBlockManager=Object(f.a)(700,this.gridView.ya);this.ju=Ga.frame.sB;this.m_()}get Ce(){return this.wl.domElement(1)}get Qtc(){const Ga=this.wl.domElement(Y.Uia);return Ga?Z.DOMElementExtensions.isVisible(Ga):!1}get gBa(){return this.$.isEditMode&&R.EwaSettings.Ea(128)&&R.EwaSettings.Ea(131)&&(new la.a(this.$.va)).Oj?
!1:-1!==this.kya}dispose(){this.gridView&&this.gridView.ha.QI(this.Mh);if(this.$){const Ga=this.$;Ga.Hn(this.De);Ga.vE(this.Rk);M.h(Ga).Ax(this.qz)}k.a.Ma(this.wl);this.ju=this.$=this.gridView=this.wl=null;super.dispose()}fz(){this.tDa(null,!1);this.j3a=-1;this.wl.hide();this.Rek();this.eTa=!1}zib(){this.wl.getButton(Y.Uia).hSb();this.eTa=!1}Dfg(){this.wl.getButton(Y.Uia).Hgb();this.Hug(this.Bdc);this.eTa=!0;R.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2AriaLiveNotifier",!1)?
void m.a.resolve(x.f).then(Ga=>{Ga.uha(da.a.instance.ia(1751))}):this.$.ga.qd(211,Ga=>{Ga.uha(da.a.instance.ia(1751))})}onAutoDetectUIShown(){if(this.gBa&&-1!==this.j3a)this.convertToLinkedEntityManager.onAutoDetectUIShown()}H6g(Ga){var ma=new T.Range(1===Ga.top?1:Ga.top-1,Ga.left,Ga.bottom,Ga.right,!0,!1);ma=this.gridView.getRangeInformation(ma);for(const fa of ma)if(Object(u.a)(S.AutoDetectRange,fa)&&this.Cpc(Ga,!1,fa))return!0;return!1}hNa(){if(this.gBa&&-1!==this.j3a){this.wl.getButton(Y.Uia).Hgb();
var Ga={};Ga.Id=this.kya;Ga.StringId=null;this.convertToLinkedEntityManager.kdd(Ga,!0,this.Bdc);c.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");Ga=[Object(b.a)(new na.a,{name:"Domain",int64:this.kya})];ba.a("AssistedAutoConvertMenuConvertClicked",void 0,void 0,Ga);this.kya=-1}}q3h(){let Ga=da.a.instance.ia(1747);if(-1!==this.kya){Ga+=" ";try{Ga+=this.convertToLinkedEntityManager.bKb(this.kya.toString())}catch(ma){c.ULS.sendTraceTag(537166982,
0,10,`AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain ${this.kya}`)}}Ga+=" ";return Ga=this.Qvb?Ga+da.a.instance.ia(1750):Ga+da.a.instance.ia(this.isMac?1749:1748)}nlg(){this.Qvb&&(this.hX||(this.hX=new n(this.Ce,this.$),this.hX.convertToDomainName=da.a.instance.ia(1752),this.hX.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.hX.imageAltText=da.a.instance.ia(1754),this.hX.helpId="HID_DataTypes_Wolfram",this.hX.helpText=
da.a.instance.ia(1753)),this.hX.longDescription=this.convertToLinkedEntityManager.t8d(this.j3a.toString()),this.hX.Noh())}Cpc(Ga,ma,fa){if((new T.Range(fa.top,fa.left,fa.bottom===t.a.yh?fa.bottom:fa.bottom+1,fa.right,!0,!1)).hf(Ga)){if(ma){if(fa&&fa.Pvb!==this.j3a){this.j3a=fa.Pvb;Ga=fa.Pvb.toString();ma=this.Qvb?"":this.convertToLinkedEntityManager.t8d(Ga);const Xa=this.convertToLinkedEntityManager.Zsi(Ga);this.wl.smb(this.convertToLinkedEntityManager.bKb(Ga),ma,Xa,Y.Uia)}this.kya=fa.Pvb;this.Bdc=
fa}return!0}return!1}m_(){if(this.convertToLinkedEntityManager){var Ga=this.gridView.ha.Bg;if(this.gridBlockManager&&this.gridBlockManager.avd){var ma=this.gridView.ha.ra.activeCell,fa=!this.gridBlockManager.du(ma),Xa=this.gridView.getRangeInformation(this.gridView.Ol);for(const Ua of Xa)if(Object(u.a)(S.AutoDetectRange,Ua))switch(Xa=Ua,Xa.Egh){case 3:if(this.Cpc(ma,!0,Xa)){if(1!==Ga||fa){this.fz();return}c.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");
this.AUd();this.wl.mia(ma,this.tDa);this.JHe||(this.JHe=!0,this.onAutoDetectUIShown());return}break;case 2:case 1:(R.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.LoadClassifier",!1)||R.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.PasteClassifier",!1))&&this.G6g.PAh(Xa);break;default:c.ULS.sendTraceTag(537166980,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.fz()}}Hug(Ga){const ma=[29];this.gridView.Kd.kn(Ga,
ma);this.gridView.Kd.Jt(ma)}Wbb(){return this.$.ea.isNamedObjectViewMode&&V.f(this.$.na)}AUd(){this.Qvb&&!this.ctc&&this.ju&&(this.ju.tw(d.a.me,this.$.domElement,this.onKeyDown,!0),this.ju.tw(d.a.Vf,this.$.domElement,this.onKeyUp,!0),this.ctc=!0)}Rek(){this.Qvb&&this.ctc&&this.ju&&(this.ju.zw(d.a.me,this.$.domElement,this.onKeyDown,!0),this.ju.zw(d.a.Vf,this.$.domElement,this.onKeyUp,!0),this.ctc=!1)}static get Uia(){return 1}static o5h(Ga){return da.a.instance.ia(1808)+v.a.space+Ga}}Object(w.a)(Y,
"AutoDetectManager",r.a,[])},1214:function(w,C,a){w=a(0);var b=a(14),c=a(264);class h{constructor(f,u){this.testName=null;this.startTimeMs=0;this.isSuccess=!1;this.caller=this.errorStatusCode=this.errorMessage=null;this.reqTotalDurationMs=0;this.browserResourceTiming=null;this.testIteration=0;this.testName=f;this.caller=u;this.reset()}reset(){this.isSuccess=!1;this.startTimeMs=-1;this.errorStatusCode=this.errorMessage="";this.reqTotalDurationMs=-1;this.browserResourceTiming=null}}Object(w.a)(h,"NetworkTestResult",
null,[]);var k=a(595);a.d(C,"a",function(){return d});class d{constructor(f,u,r,t,v){this.url="";this.Dab=!1;this.klb=-1;this.testIteration=0;this.baseUrl=r;this.OMf=t;this.pwd=u;this.result=new h(u,v)}runTest(){try{if(this.Dab)return b.ULS.sendTraceTag(537155206,0,50,`NetworkTestReq.RunTest: a test for the host ${this.pwd} is already mid way, not starting a new one.`),!1;this.reset();this.Dab=!0;this.result.startTimeMs=Date.now();const f=new c.QueryStringBuilder(this.baseUrl);f.C6("tid",this.result.startTimeMs.toString());
this.url=f.toString();this.KMj();this.testIteration++;this.result.testIteration=this.testIteration;return!0}catch(f){return this.OBb("Exeption: "+f.message),!1}}reset(){this.url="";this.result.reset();this.Dab=!1;this.klb=-1}clearTimeout(){-1!==this.klb&&(window.clearTimeout(this.klb),this.klb=-1)}KMj(){try{const f=new XMLHttpRequest;f.onreadystatechange=()=>{4===f.readyState&&(200===f.status?this.dWh():this.OBb(`Error when downloading resource. status code: ${f.status}, status text: ${f.statusText}`,
f.status.toString()))};f.onerror=()=>{this.OBb(`Client error when attempting to download resource. status code: ${f.status}, response: ${f.statusText}`)};this.klb=window.setTimeout(()=>{this.klb=-1;this.OBb("Request timeout")},1E4);f.open("GET",this.url,!0);f.send(null)}catch(f){this.OBb("Exeption: "+f.message)}}dWh(){this.Dab&&(this.result.reqTotalDurationMs=Date.now()-this.result.startTimeMs,this.clearTimeout(),this.result.browserResourceTiming=k.a(this.url),this.result.isSuccess=!0,this.Rbc())}OBb(f,
u){u=void 0===u?null:u;this.Dab&&(this.clearTimeout(),this.result.errorMessage=f,this.result.isSuccess=!1,this.result.errorStatusCode=u,this.Rbc())}Rbc(){this.Dab=!1;this.OMf&&this.OMf(this.result,this.pwd)}}Object(w.a)(d,"NetworkTestReq",null,[])},1258:function(w,C,a){a.r(C);a.d(C,"AutoDetectActionButton",function(){return d});w=a(0);C=a(83);var b=a(1194),c=a(56),h=a(16),k=a(19);class d extends C.a{constructor(f,u,r,t,v){super();this.$=f;this.oF=t.Lyb(f,u,r,"",c.a.Ci(11),v,"AutoDetectPointerDown",
h.a.instance.ia(1808)+"...")}get dy(){return this.oF.dy}dispose(){this.oF.dispose();this.$=null;super.dispose()}domElement(f){return this.oF.domElement(f)}getButton(f){return this.oF.getButton(f,!1)}smb(f,u,r,t){this.oF.SZa(b.a.o5h(f),u,t);this.oF.vMc(r,u,t)}mia(f,u){const r=k.h(this.$),t=r.jd.$j(f);f=r.Ni(f,t);const v=r.Xh(t).ao;if(f&&0<=f.x&&0<=f.y&&v.width>f.width+160){let x=f.bottomRight.x+this.dy,m=f.topLeft.y+this.dy,l=!1;x+160>v.bottomRight.x&&(x=f.topLeft.x-this.dy,l=!0);if(m<v.topLeft.y+
this.dy){if(r.jd.oGa){this.hide();return}m=v.topLeft.y+this.dy}this.oF.Rid(u,t);this.Vo(x,m,r.rtl,t,l)}else this.hide()}Vo(f,u,r,t,v){this.oF.Vo(f,u,r,t,!1,v)}hide(){this.oF.hide()}}Object(w.a)(d,"AutoDetectActionButton",C.a,[])},1327:function(w,C,a){function b(D,ha){this.ID=D;this.type=ha}function c(D,ha){this.value=D;this.contextId=ha}function h(D,ha,fb,Vb,Gc,zd,ae,He){this.type=D;this.startTime=null==fb||void 0==fb.value?new c(fb,null):fb;this.endTime=null==Vb||void 0==Vb.value?new c(Vb,null):
Vb;null!=Gc&&void 0!=Gc.value||new c(Gc,null);null!=zd&&void 0!=zd.value||new c(zd,null);this.operationType=He}function k(D){this.ID=D}function d(){this.ih=[];this.cvb=[];this.L6c=0;this.duration=this.startTime=null;this.hgc={};this.LId=this.oJd=this.y8c=-1}function f(D){const ha=new bh.StandardDialog;ha.Rd=4;D=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,D)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;
ha.BV(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,D,Nf)}function u(D,ha){return Io(function*(){if(Object(yf.m)(D.na)){const fb=D.na.sheetProcessedData;Object(wf.a)(fb);return ha.map(Vb=>Hj(Vb,!0)).filter(Vb=>fb.value.Zbb(Vb))}return[]})}function r(D){switch(D){case 0:return 1;case 2:return 2;case 1:return 4;default:throw ba.ULS.sendTraceTag(508559903,0,10,`ConvertExtraSpacesTypeToTrimWhitespaceType: Unknown ExtraSpacesPaddingType ${D}`),Error.argument("illegal ExtraSpacesPaddingType");
}}function t(D,ha,fb,Vb,Gc){return Io(function*(){const zd=Object(Gb.u)(D.activeItemName,null,ha),{NNd:ae,MNd:He,fPd:hf}=m();Object(ya.a)(D.userOperationManager,(zf,vg,gh)=>Yj.z(D.qa.ua,Gc,zd,Vb,Object(Bd.b)(zf,ae),Object(Bd.a)(vg,He),gh,null),zf=>new Db.a(258,0,zf),null);yield hf;return fb.length})}function v(D,ha,fb){return Io(function*(){const Vb=Object(Gb.u)(D.activeItemName,null,ha),Gc=D.qa.ua.ie({cqa:!0,Qoa:1}),{NNd:zd,MNd:ae,fPd:He}=m();Object(ya.a)(D.userOperationManager,(hf,zf,vg)=>be.l(D.qa.ua,
Vb,Object(Gb.o)($a.h(D).ha.ra.activeCell,D),fb,!1,null,null,!0,!1,Object(Bd.b)(hf,zd),Object(Bd.a)(zf,ae),vg,null,Gc,null),hf=>new Db.a(11,0,hf),null);yield He;return-1})}function x(D,ha,fb){return Io(function*(){const Vb=Object(Gb.u)(D.activeItemName,null,ha),{NNd:Gc,MNd:zd,fPd:ae}=m(),He=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:8123182_DataCleansingReduceWhitespaceTypes")?fb.reduce((zf,vg)=>zf|vg,0):fb[0];Object(ya.a)(D.userOperationManager,(zf,vg,gh)=>{var Kh=D.qa.ua;zf=Object(Bd.b)(zf,Gc);
vg=Object(Bd.a)(vg,zd);const th=Kh.Pa(9,null);th.ranges=Vb;th.trimWhitespaceType=He;return be.g(Kh,"TrimWhitespace",th,zf,vg,gh,null,0)},zf=>new Db.a(253,0,zf),null);const {Result:hf}=yield ae;return hf})}function m(){const D=new lb.a;return{NNd(ha){ha&&zh.a.ph(ha.Errors)?(ba.ULS.sendTraceTag(509617682,0,10,"DataCleansing onOperationSuccess: Ewa result contains error messages after applying"),D.setResult(null)):ha?(ba.ULS.sendTraceTag(537163359,0,20,"DataCleansing onOperationSuccess: Suggestion applied successfully"),
D.setResult(ha)):(ba.ULS.sendTraceTag(508424517,0,10,"DataCleansing onOperationSuccess: Ewa result is null after applying"),D.setResult(null))},MNd(ha){ba.ULS.sendTraceTag(509617681,0,10,`DataCleansing onOperationFailed: Ewa result contains error messages HttpStatus [${ha.data.httpStatus}]`);D.setResult(null)},fPd:Ve.e(D.task)}}function l(D){return D.filter(zj.typeGuard).reduce((ha,fb)=>{var Vb,Gc;return ha+(null!==(Gc=null===(Vb=null===fb||void 0===fb?void 0:fb.suggestions)||void 0===Vb?void 0:Vb.length)&&
void 0!==Gc?Gc:0)},0)}function n(D,ha,fb){fb=void 0===fb?new Map:fb;return D.reduce((Vb,Gc)=>{Gc=ha(Gc);const zd=Vb.get(Gc);zd?Vb.set(Gc,zd+1):Vb.set(Gc,1);return Vb},fb)}function z(D){const ha=[];D.forEach(fb=>ha.push(...fb));return ha}function y(D){return Array.from(D).reduce((ha,fb)=>{var [Vb,Gc]=fb;return Object.assign({},ha,{[Vb]:Gc})},{})}function B(D){return D.reduce((ha,fb)=>{var Vb=fb.tableRange;fb=fb.suggestions;Vb&&fb&&(Vb=Hj(Vb,!1).EA(!1),ha[Vb]=G(ha[Vb],fb));return ha},{})}function G(D,
ha){return ha.reduce((fb,Vb)=>{({type:Vb}=Vb);Vb in fb?fb[Vb]++:Vb&&(fb[Vb]=1);return fb},null!==D&&void 0!==D?D:{})}function E(D){D=z(D.map(ha=>ha.suggestions.filter(J)));return n(D,ha=>ha.variationsType)}function J(D){return"NumberFormattingInconsistency"===D.type}a.r(C);var I={};a.r(I);a.d(I,"NetworkConnectionStateManager",function(){return mf});var R={};a.r(R);a.d(R,"ProactiveSuggestionManager",function(){return Jh});var X={};a.r(X);a.d(X,"CalcManager",function(){return Ai});var H={};a.r(H);a.d(H,
"UnifiedConsentAdapter",function(){return Xi});var M={};a.r(M);a.d(M,"ExtendedTooltipsManager",function(){return mj});var O={};a.r(O);a.d(O,"DataCleansingHostManager",function(){return ak});var L={};a.r(L);a.d(L,"DataCleansingAnnotationsManager",function(){return Xj});var S={};a.r(S);a.d(S,"SharedUIControlsFactory",function(){return Yh});var T={};a.r(T);a.d(T,"AutoAdjustColumnsManager",function(){return Dh});var V={};a.r(V);var la={};a.r(la);a.d(la,"SdxManifestPrefetcher",function(){return ej});var Z=
{};a.r(Z);a.d(Z,"ThemesManager",function(){return vk});var da=a(0),ba=a(14),na=a(5),Y=a(123),Ga=a(407);class ma extends Ga.a{constructor(D){super(D)}get oyb(){return!1}createElement(){const D=document.createElement("link");D.setAttribute("rel","stylesheet");D.setAttribute("type","text/css");D.setAttribute("href",this.Bx);return D}ped(){return null}yCc(){this.element.setAttribute("href","");this.element.setAttribute("href",this.JC.Bx)}}Object(da.a)(ma,"CssResource",Ga.a,[]);var fa=a(469),Xa=a(269),
Ua=a(31),ka=a(62);class nb{constructor(){this.P3b=this.X0b=null}oQi(){this.X0b||(ba.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),this.X0b=ka.Task.WAA(nb.vQi(),nb.kQi()),this.X0b.continueWith(D=>{ba.ULS.sendTraceTag(21030599,324,10,"{0}",Ua.a.Tpd(D.exception))},5));return this.X0b}qQi(){if(!this.P3b)try{ba.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.P3b=ka.Task.WAA(nb.bjd(Xa.a.create(na.AFrameworkApplication.da.Sa("DimeUrl"),
null,null))),this.P3b.continueWith(D=>{ba.ULS.sendTraceTag(39978391,324,10,"{0}",Ua.a.Tpd(D.exception))},5)}catch(D){ba.ULS.sendTraceTag(594874951,324,10,"{0}",Ua.a.Tpd(D))}return this.P3b}static vQi(){var D=nb.Ylc("inproductmessaging.js");D=Xa.a.create(D,null,null);return nb.bjd(D)}static kQi(){var D=nb.Ylc("inproductmessaging.css");D=new ma(D);return nb.bjd(D)}static Ylc(D){return Y.a.Txb(String.format("ipm/{0}",D))}static bjd(D){fa.a.Yya(D);return D.Jdb}}Object(da.a)(nb,"DependencyDownloader",
null,[532]);class Ea{}Ea.vij="inProductMessagingOverlayDiv";Ea.wlj="PlayButtonImage";Ea.lEj="ReplayButtonImage";Object(da.a)(Ea,"Constants",null,[]);class sb{constructor(){this.zve=this.Spe=this.cfe=!0;this.mEj=this.xlj=null;this.TZi=!1;this.locale=null;this.stg={}}get RHe(){return this.cfe}set RHe(D){this.cfe=D}get zHf(){return this.Spe}set zHf(D){this.Spe=D}get Hkg(){return this.zve}set Hkg(D){(this.zve=D)&&this.DSj()}DSj(){this.nBe(Ea.wlj,this.xlj);this.nBe(Ea.lEj,this.mEj)}nBe(D,ha){ha&&(this.stg[D]=
ha)}}Object(da.a)(sb,"FirstRunExperienceUISettings",null,[531]);class Oa{constructor(){this.completed=this.Iyj=!1}}Object(da.a)(Oa,"FirstRunExperienceViewData",null,[524]);var La=a(79),ia=a(177),Sa=a(116),Za=a(27);class Ab{constructor(D,ha,fb){this.Na=D;this.kh=ha;this.D1b=fb}tj(){this.Na.Rg(Za.a.EWh,Sa.a.frame,Object(La.a)(this,this.CWh,"firstRunExperienceHandler"),64);this.Na.ae(Za.a.Z7e,Sa.a.frame,Object(La.a)(this,this.Iti,"inProductMessagingTabHandler"));this.Na.ae(Za.a.Y7e,Sa.a.frame,Object(La.a)(this,
this.Hti,"inProductMessagingShiftTabHandler"));this.Na.ae(Za.a.Xzh,Sa.a.frame,Object(La.a)(this,this.Yzh,"dimeLaunchHandler"));this.Na.ae(Za.a.w8f,Sa.a.frame,ia.ActionManager.Ai);this.Na.ae(Za.a.NEj,Sa.a.frame,ia.ActionManager.Ai);this.Na.ae(Za.a.OEj,Sa.a.frame,ia.ActionManager.Ai);this.kh&&this.kh.updateCommandUI()}CWh(D,ha,fb,Vb,Gc){2===fb&&this.D1b.NOi(Gc);return 32}Yzh(D,ha,fb,Vb,Gc){2===fb&&this.D1b.KOi(Gc);return 32}Iti(D,ha,fb){return 2===fb?this.D1b.EJd():32}Hti(D,ha,fb){return 2===fb?this.D1b.BJd():
32}}Object(da.a)(Ab,"InProductMessagingActor",null,[]);var pb=a(138);class Tb{constructor(){this.b5f=this.f$f=this.upg=this.Rtc=this.instance=null}}Object(da.a)(Tb,"DimeExperienceUISettings",null,[]);var ob=a(147),va=a(476);class Pa{constructor(D,ha,fb,Vb,Gc){this.fjc=!1;this.Tzb=null;this.Na=D;this.pKa=ha;this.r4b=fb;this.u5=Vb;this.NPc=Gc}Iwi(D){ob.b("getHeaderApi")?D.isFeatureEnabled("MsoPremiumBadge",!0).then(ha=>{const fb=D.isFreemiumUpsellEnabled();fb&&(appChrome.getHeaderApi().then(Vb=>{Vb.updatePremiumStatus(ha,
fb);return null}),D.hWa("MsoPremiumBadge",Vb=>{appChrome.getHeaderApi().then(Gc=>{Gc.updatePremiumStatus(Vb.isEnabled,fb);return null})}));return null}):ba.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")}NOi(D){this.r4b.oQi().continueWith(()=>{this.pKa.U1j(D)})}KOi(D){let ha="gopremium",fb=null,Vb=()=>{};D?(D.experience&&""!==Object(pb.a)(String,D.experience)&&(ha=Object(pb.a)(String,D.experience)),D.onTaskComplete&&(Vb=D.onTaskComplete),D.campaignId&&""!==Object(pb.a)(String,D.campaignId)&&
(fb=Object(pb.a)(String,D.campaignId))):ba.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");this.LAf(ha,Vb,fb)}LAf(D,ha,fb){fb=void 0===fb?null:fb;if(this.fjc&&this.Tzb){const Vb={};Vb.experience=D||"gopremium";Vb.campaignId=fb||va.b(this.u5,this.NPc,Object(pb.a)(String,Vb.experience),!0);this.Na.processAction(Za.a.w8f,2);ba.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+Vb.experience);try{const Gc=Object.assign(new Tb,{instance:this.Tzb,Rtc:Vb,
upg:ha||(()=>{}),f$f:zd=>{ba.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+zd.status)},b5f:()=>{ba.ULS.sendTraceTag(51675406,324,10,"Dime launch error");this.fjc=!1;this.Tzb=null}});this.pKa.f0j(Gc)}catch(Gc){ba.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Gc.message),this.fjc=!1,this.Tzb=null,this.Na.eg(Za.a.gjc,2,{["experience"]:Vb.experience})}}else ba.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),this.Na.eg(Za.a.gjc,2,{["experience"]:D})}HBf(){this.r4b.qQi().continueWith(()=>
{try{var D=Ua.a.Tm(na.AFrameworkApplication.uiCulture);const Vb=va.c(this.u5);if(Vb){var ha={};ha.partnerId=Vb;ha.language=D;ha.sessionId=na.AFrameworkApplication.userSessionId;ha.authHint=na.AFrameworkApplication.da.Sa("UserPrincipalName");var fb=na.AFrameworkApplication.da.Sa("Puid")||"";""!==fb&&(D={},D.puid=fb,ha.userInfo=D);this.Tzb=new Dime(ha);this.fjc=!0;ba.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else ba.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(Vb){ba.ULS.sendTraceTag(51675410,
324,10,"FreemiumUpsellDialogDependencies failed: "+Vb.message)}},3)}EJd(){return this.pKa.EJd()}BJd(){return this.pKa.BJd()}}Object(da.a)(Pa,"InProductMessagingUIManager",null,[505]);class jb{constructor(){this.$we=0;this.E1a=Array(5);this.E1a[0]=10;this.E1a[1]=15;this.E1a[2]=50;this.E1a[3]=100;this.E1a[4]=200}Init(D){this.$we=D}SendTrace(D,ha){ba.ULS.sendTraceTag(34182235,this.$we,this.E1a[D],"{0}",ha)}}Object(da.a)(jb,"DefaultNetworkingManager",null,[523]);var Ob=a(277),kb=a(327),ra=a(102);class rb{constructor(D){this.Re=
D}U1j(D){D&&(InProductMessaging.Networking.NetworkingMgr=new jb,InProductMessaging.Networking.NetworkingMgr.Init(387),InProductMessaging.Init(D.Hkg,D.zHf,D.RHe,D.TZi,D.locale,Object(La.a)(this,this.z6i,"onDismissFirstRunExperience"),D.stg),this.QXa(Ea.vij,!0))}f0j(D){if(D&&D.instance&&D.Rtc){let ha=document.getElementById("wacDimeContainer");ha||(ha=document.createElement("div"),ha.id="wacDimeContainer",document.body.appendChild(ha));na.AFrameworkApplication.da.pa("DimeFocusManagerIsEnabled")&&this.QXa("wacDimeContainer",
!1);D.Rtc.parentElementId="wacDimeContainer";D.instance.launch(D.Rtc,D.upg).then(fb=>{this.kRb();document.body.removeChild(ha);D.f$f(fb)}).catch(fb=>{this.kRb();document.body.removeChild(ha);D.b5f(fb)})}else throw Error.argument("DimeExperienceUISettings");}QXa(D,ha){if(this.Re&&D&&(D=document.getElementById(D),this.Awi(D),D=this.Re.dU("InProductMessagingFocusId"))){const fb=this.Re.hk;fb&&"InProductMessagingFocusId"===fb.name||this.Re.a4("InProductMessagingFocusId",!1);ha&&this.e3f(D.scope)}}Awi(D){var ha=
!1;ha=void 0===ha?!0:ha;const fb=this.Re.am("InProductMessagingFocusId");fb.parent=Ob.AFrame.K6;const Vb=new kb.DOMFocusListing(()=>D);Vb.eRb=ha;Vb.jr(3);Vb.jr(2);Vb.jr(4);ha=this.Re.cMa(()=>D,fb,Vb);ha.zCc();ha.i$=!0;ha.z6a=!0}e3f(D){D.tv(ra.FocusManager.instance().m6);D.tv(ra.FocusManager.instance().n6);D.bindAction(ra.FocusManager.instance().m6,Za.a.Z7e);D.bindAction(ra.FocusManager.instance().n6,Za.a.Y7e)}kRb(){this.Re&&(this.Re.jha("InProductMessagingFocusId"),this.Re.uWa("InProductMessagingFocusId"))}z6i(D,
ha){this.kRb();D=Object.assign(new Oa,{completed:D,Iyj:ha});na.AFrameworkApplication.Dd.eg(Za.a.BWh,2,D)}EJd(){const D=document.activeElement,ha=this.Re.ZT();return D&&ha&&ha.Cj&&D===ha.Cj.jz?(ha.Cj.Kz(D),ha.oMb()?32:8):4}BJd(){const D=document.activeElement,ha=this.Re.ZT();return D&&ha&&ha.Cj&&D===ha.Cj.firstElement?(ha.Cj.Kz(D),ha.veb()?32:8):4}}Object(da.a)(rb,"InProductMessagingUIWrapper",null,[504]);var Kb=a(144),Sb=a(261),cb=a(32);class cc{constructor(){this.hd=null}get name(){return"Common.App.InProductMessaging"}Xj(D){D.register(nb,
"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").Ee().Le(()=>new nb);D.register(rb,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").Ee().Le(()=>new rb(ra.FocusManager.instance()));D.register(Pa,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").Ee().Le(()=>new Pa(na.AFrameworkApplication.Dd,D.resolve("Common.IInProductMessagingUIWrapper"),
D.resolve("Common.App.InProductMessaging.IDependencyDownloader"),na.AFrameworkApplication.sa.Ra.kj,na.AFrameworkApplication.sa.Ra.cDa));D.register(Ab,"Common.App.InProductMessaging.InProductMessagingActor").Ee().Le(()=>new Ab(na.AFrameworkApplication.Dd,na.AFrameworkApplication.sa,D.resolve("Common.IInProductMessagingUIManager")));D.register(sb,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").Ee().Le(()=>new sb);D.register(Oa,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").Ee().Le(()=>
new Oa);this.hd=D}init(){this.hd.resolve("Common.App.InProductMessaging.InProductMessagingActor").tj();na.AFrameworkApplication.da.qx(()=>{na.AFrameworkApplication.sa.Ra.kw&&Kb.a.get_instance().ik(15,()=>{this.hd.Qd("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(D=>{this.hd.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").Iwi(D)})});na.AFrameworkApplication.da.pa("FreemiumUpsellShowDialogIsEnabled")&&va.a()&&!cb.a.ABa&&1!==na.AFrameworkApplication.sa.Ra.kj&&
this.hd.Qd("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(D=>{D.isFeatureEnabled("MsoPremiumBadge",!0).then(ha=>{!ha&&D.isFreemiumUpsellEnabled()&&this.hd.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").HBf();return null})})})}dispose(){}static main(){Sb.a.instance.Tk(new cc)}}Object(da.a)(cc,"InProductMessagingPackage",null,[2,3]);var Ub=a(198),wb=a(42);class vc{constructor(D,ha,fb,Vb,Gc){this.Fy=D;this.MIa=ha;this.ppb=fb;this.qse=void 0===Vb?null:Vb;
this.Hrb=void 0===Gc?null:Gc}bld(D){const ha=new Sys.StringBuilder(this.Fy.JSb);ha.append("RoamingServiceHandler.ashx?action=");ha.append("getFirstRunExperienceSettings");ha.append("&");ha.append(this.$rd(D));ha.append("&");ha.append(na.AFrameworkApplication.Ak);na.AFrameworkApplication.tf.Ho(ha.toString(),1,null,null,!0,2,Object(La.a)(this,this.goa,"getRequestSuccessCallback"),Object(La.a)(this,this.yY,"getRequestFailureCallback"),null)}zhc(D){var ha=new Sys.StringBuilder(this.Fy.JSb);ha.append("RoamingServiceHandler.ashx?action=");
ha.append("saveFirstRunExperienceSettings");ha.append("&");ha.append(na.AFrameworkApplication.Ak);ha=ha.toString();D=wb.c(D);na.AFrameworkApplication.tf.Ho(ha,2,D,null,!0,4,Object(La.a)(this,this.bnj,"postRequestSuccessCallback"),Object(La.a)(this,this.Y$,"postRequestFailureCallback"),null)}goa(D){let ha=!1,fb=null;try{if(0<D.data.Tf.length){const Vb=Object(pb.a)(Object,wb.a(D.data.Tf)),Gc=Vb?Vb[this.Fy.S6c]:null;Gc&&(fb=Object(pb.a)(Object,wb.a(Gc.toString())))}ha=!0}catch(Vb){this.yY(null)}ha&&
this.MIa&&this.MIa(D.data,fb)}yY(D){this.ppb&&this.ppb(D?D.data:null)}bnj(D){this.qse&&this.qse(D?D.data:null)}Y$(D){this.Hrb&&this.Hrb(D?D.data:null)}$rd(D){const ha=new Sys.StringBuilder("requestedsettings=");for(let fb=0;fb<D.count;fb++)ha.append(D.ma(fb)),fb<D.count-1&&ha.append(";");return ha.toString()}}Object(da.a)(vc,"FirstRunExperienceRequestHandler",null,[]);var Lb=a(229),Ja=a(84);class Hb{constructor(){this.hpb=this.Y0b=this.Fy=null}X3d(D){D?(this.Fy=D,this.RGi()&&(ba.ULS.sendTraceTag(51675532,
306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),D=new Ub.a,D.add(this.Fy.S6c),this.Y0b=new vc(this.Fy,Object(La.a)(this,this.goa,"getRequestSuccessCallback"),Object(La.a)(this,this.yY,"getRequestFailureCallback"),null,Object(La.a)(this,this.Y$,"postRequestFailureCallback")),this.Y0b.bld(D)),(this.Fy.Lcb||na.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.Y3d()):ba.ULS.sendTraceTag(51675531,
306,10,"Invalid launcherSettings")}RGi(){try{if(this.Fy.Lcb)return!0;if(!na.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||na.AFrameworkApplication.da.pa("IsAnonymousUser"))return!1;if(this.Fy.lDi||this.Fy.Ncb||na.AFrameworkApplication.da.pa("IsO365ConsumerHost"))return!0;const D=na.AFrameworkApplication.da.Sa("FlightId");return-1!==(D?D.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(D){ba.ULS.sendTraceTag(576582624,
306,10,"Error checking setting {0}",D?D.toString():null)}return!1}Abg(D){const ha={},fb={};fb.FREDisplayedDate=(new Date).toUTCString();fb.VersionDisplayed=D;fb.RemindMeLater=!1;ha[this.Fy.S6c]=wb.c(fb);ba.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.Y0b&&this.Y0b.zhc(ha)}goa(D,ha){D=D?+D.q1-+D.$F:-1;D>this.Fy.lag?ba.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",
D,this.Fy.lag):ha?this.QZj(ha)?(ba.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.Fy.tHf),this.Y3d()):(this.mhd(!1),ba.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(ba.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.Y3d())}yY(D){this.mhd(!1);
ba.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",D?D.httpStatus:-1)}Y$(D){ba.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",D?D.httpStatus:-1)}Y3d(){this.mhd(!0);var D=Ja.a.instance.oi("Common.ISystemInitiatedFeedback");D?this.ukg(D):(ba.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),na.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",
!0)&&((D=Ja.a.instance.Qd("Common.ISystemInitiatedFeedback"))?D.execute(ha=>{this.ukg(ha)}):ba.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}ukg(D){if(D){var ha=this.Fy.PWh;ha&&na.AFrameworkApplication.KN(ha);ba.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",ha);D.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.hpb=Object(La.a)(this,this.C7i,"onFirstRunExperienceCampaignEvent"),
window.addEventListener("FGWebSurfaceEvent",this.hpb,!0),window.addEventListener("FRELaunchedEvent",this.hpb,!0)):(ba.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.Abg(this.Fy.currentVersion))}else ba.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}C7i(D){if(D){var ha=D.detail;D=D.type;var fb=this.Fy&&this.Fy.campaignId?this.Fy.campaignId.split("-")[0]:null;if("FRELaunchedEvent"===D||fb&&ha&&ha.id&&-1!==ha.id.indexOf(fb)){if("FRELaunchedEvent"===
D||ha&&ha.success)ba.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.Abg(this.Fy.currentVersion);window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.hpb,!0),window.removeEventListener("FRELaunchedEvent",this.hpb,!0))}}}QZj(D){if("RemindMeLater"in D&&"FREDisplayedDate"in D){if("true"===D.RemindMeLater.toString()&&(+new Date-+new Date(D.FREDisplayedDate.toString()))/36E5>this.Fy.tHf)return!0}else if(na.AFrameworkApplication.da.pa("WacShowVersionBasedFREToAllUsers")&&
"VersionDisplayed"in D&&D.VersionDisplayed<this.Fy.currentVersion)return ba.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}mhd(D){na.AFrameworkApplication.da.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&Lb.a.dispatch("FREDecisionEvent",{["show"]:D})}}Object(da.a)(Hb,"FirstRunExperienceLauncher",null,[644]);class gc{constructor(){this.hd=null}get name(){return"Common.App.FirstRunExperienceLauncher"}Xj(D){this.hd=
D;this.hd.register(644,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").Ee().Le(()=>new Hb)}init(){}dispose(){}static main(){Sb.a.instance.Tk(new gc)}}Object(da.a)(gc,"FirstRunExperienceLauncherPackage",null,[2,3]);var ec=a(10),Ta=a(233),ib=a(1);class bc{constructor(D){this.$=D}get S6c(){return"Excel"}get campaignId(){return"aed9de6b-d4e7-4878-988a-9dfec66fed9e"}get version(){return 1}get currentVersion(){return 0}get lDi(){return this.isEnabled()&&ib.EwaSettings.Ea(295)}get Ncb(){return this.isEnabled()&&
ib.EwaSettings.Ea(297)}get Lcb(){return ib.EwaSettings.Ea(296)}get PWh(){return null}get tHf(){return 24}get lag(){return 4E3}get JSb(){return this.$.xa.WebServiceBase||""}isEnabled(){if(na.AFrameworkApplication.da?na.AFrameworkApplication.da.pa("IsAnonymousUser"):1)return!1;const D=na.AFrameworkApplication.Yd?Object(pb.a)(String,na.AFrameworkApplication.Yd.AudienceGroup):"";return"Unknown"!==D&&"Automation"!==D}}Object(da.a)(bc,"FirstRunExperienceLauncherSettings",null,[707]);class jc{constructor(D,
ha){this.$7e=D;this.DWh=ha}X3d(){this.$7e&&this.$7e.X3d(this.DWh)}}Object(da.a)(jc,"FirstRunExperienceManager",null,[672]);var sc=a(737);class Fa extends Ta.a{constructor(D){super();this.$=D;this.je()}create(){const D=Object(sc.a)(this.$.ga,311,()=>this.sqh());this.Ld(D)}sqh(){var D=new bc(this.$);D=new jc(Ja.a.instance.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"),D);D.X3d();return D}static la(D){D.ga.Qa(312,new Fa(D))}}Object(da.a)(Fa,"FirstRunExperienceManagerFactory",
Ta.a,[]);var Ha=a(60);class Na extends Ta.a{constructor(D){super();this.jxd=null;this.$=D;this.je()}create(){const D=Object(sc.a)(this.$.ga,361,()=>this.erh());this.Ld(D)}erh(){this.jxd=Ja.a.instance.oi("Common.IInProductMessagingUIManager");Ha.a.Bi.kw?Kb.a.get_instance().ik(16,()=>{this.$pf()}):this.$pf();return this.jxd}$pf(){Ja.a.instance.Qd("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(D=>{D.isFeatureEnabled("MsoPremiumBadge",!0).then(ha=>{!ha&&D.isFreemiumUpsellEnabled()&&
this.jxd.HBf();return null})})}static la(D){D.ga.Qa(362,new Na(D))}}Object(da.a)(Na,"InProductMessagingManagerFactory",Ta.a,[]);var W=a(54),U=a(355),za=a(83),ua=a(541),$a=a(19),Va=a(587);class hb extends ua.a{constructor(D){super(1);this.Lja=!1;this.cMf=()=>{this.refresh()};this.dMf=()=>{this.refresh()};this.gridView=$a.h(D);this.gridView.he.Gp(this.dMf);this.gridView.he.Mq(this.cMf);this.refresh()}get iL(){return this.Mvc(this.Lja)}M1d(D){this.Lja!==D&&(this.Lja=D,this.pQb())}get name(){return Va.a.cellEdit}dispose(){this.gridView.he.zp(this.dMf);
this.gridView.he.$p(this.cMf);this.gridView=null;super.dispose()}pQb(){this.ZSd(this.Lja)}refresh(){this.M1d(!this.gridView.ld)}}Object(da.a)(hb,"CellEditSafeStatePublisher",ua.a,[]);var qb=a(39),Nb=a(131);class yb{constructor(D,ha){this.handler=null;this.publisher=D;this.iL=ha}}Object(da.a)(yb,"SafeStatePublisherState",null,[]);var ja=a(627);const Ka=D=>D?`${D.Current} / ${D.Pending} @${D.SuspensionStartTimestamp}`:null,Pb=D=>(null===D||void 0===D?void 0:D.SuspensionStartTimestamp)&&D.Pending>D.Current;
class rc extends qb.a{constructor(D,ha){super();this.sAf=null;this.ndb=!1;this.YNb=(fb,Vb)=>{3===Vb.dHf&&this.ndb&&ba.ULS.sendTraceTag(520480204,0,15,"ClientStateMonitor.onMergeDidntOccur: Aborted merge occurred after another aborted merge.");this.ndb=!0;this.qhb()};this.hXa=new Ub.a;this.NCa=D;this.fra=ha;this.DHb=ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1);this.pcb=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:7464389_RetryDoPendingMergeAfterBailout");
this.DHb&&(this.fra.J3a(this.vDa.bind(this)),this.pcb?this.NCa.rCe(this.YNb):this.NCa.p_g(this.$Qf.bind(this)))}get Ufk(){return Nb.f(Nb.c(this.hXa.toArray(),D=>0!=D.iL),D=>D.publisher.name)}g8b(D){this.addHandler(rc.gXa,D)}xDc(D){this.removeHandler(rc.gXa,D)}yEa(D,ha){const fb=new yb(D,ha);this.hXa.add(fb);ha=(Vb,Gc)=>{fb.iL=Gc.iL;this.qhb()};D.g8b(ha);fb.handler=ha;this.qhb()}V9d(D){let ha=null;for(let fb of this.hXa)if(fb.publisher===D){this.uug(fb);ha=fb;break}ha&&(this.hXa.remove(ha),this.qhb())}dispose(){for(let D of this.hXa)this.uug(D);
this.hXa.clear();this.DHb&&(this.fra.hib(this.vDa.bind(this)),this.pcb?this.NCa.f7f(this.YNb):this.NCa.bCj(this.$Qf.bind(this)));super.dispose()}Fjc(){let D=te.Fjc(this.hXa.toArray().map(ha=>ha.iL));return this.ndb&&1===D?2:D}uug(D){D.publisher.xDc(D.handler)}qhb(){const D=this.Fjc();D!==this.sAf&&(this.raiseEvent(rc.gXa,new ja.a(D)),this.sAf=D)}$Qf(){this.ndb&&ba.ULS.sendTraceTag(523317957,0,15,"ClientStateMonitor.onMergeWasAborted: Aborted merge occurred after another aborted merge.");this.ndb=
!0;this.qhb()}vDa(D,ha){D=ha.xga;(ha=!Pb(D))||(ha=this.eOi,ha=(null===D||void 0===D?void 0:D.SuspensionStartTimestamp)!==(null===ha||void 0===ha?void 0:ha.SuspensionStartTimestamp));ha&&(this.ndb=!1);this.eOi=D;this.qhb()}}rc.gXa="SSC";Object(da.a)(rc,"ClientStateMonitor",qb.a,[]);var $c=a(7),Dd=a(76);class Jd extends ua.a{constructor(D,ha){ha=void 0===ha?null:ha;super(1);this.Lja=!1;this.TQ=()=>{this.refresh()};this.kNf=()=>{this.refresh()};this.$=D;this.gle=ha||Dd.a(D).VT($c.a.idle);Dd.a(D).m5c(this.kNf);
this.vab.Xs(this.TQ);this.refresh()}get iL(){return this.Mvc(this.Lja)}M1d(D){D!==this.Lja&&(this.Lja=D,this.pQb())}get name(){return Va.a.vab}get vab(){return this.gle}dispose(){Dd.a(this.$).cDc(this.kNf);this.vab.Gt(this.TQ);this.gle=null;super.dispose()}pQb(){this.ZSd(this.Lja)}refresh(){this.M1d(1===this.vab.hx||Dd.a(this.$).Yj===this.vab)}}Object(da.a)(Jd,"IdleActivitySafeStatePublisher",ua.a,[]);var Kd=a(329),ce=a(4),ge=a(22);class uc extends za.a{constructor(){super()}Pe(){return!1}executeCommand(){return ka.Task.Wa(!0)}Be(D,
ha){return 1905775613===ha.command}Ue(){return!1}}Object(da.a)(uc,"ToggleMergeSuspensionSafeState",za.a,[203]);class dd extends qb.a{constructor(D,ha){super();this.statusBarManager=null;this.EKd=!1;this.vDa=(fb,Vb)=>{fb=`${Vb.xga.Current===Vb.xga.Pending?"\u26ad":"\u26ae"}${Vb.xga.Current}`;ge.a.equals(this.twc,fb,!1)||(this.twc=fb,this.pC())};this.EUa=(fb,Vb)=>{fb=0==Vb.iL;this.EKd!==fb&&(this.EKd=fb,this.pC())};this.mergeSuspensionManager=ha;this.mergeSuspensionManager.fra.J3a(this.vDa);this.twc=
"";Kd.a.$ca(1905775613,ce.a.ze,0,1);this.Ha=D.Ha;this.gXb=new uc;D.ga.qd(29,fb=>{this.mergeSuspensionManager&&(this.statusBarManager=fb,fb.zM(this),this.mergeSuspensionManager.$la.g8b(this.EUa))});this.Ha.z6(this.gXb)}Xs(D){this.addHandler(dd.gJd,D)}Gt(D){this.removeHandler(dd.gJd,D)}pC(){this.raiseEvent(dd.gJd)}Up(D){return D===dd.Dqj&&!!this.mergeSuspensionManager}Ru(D,ha){if(!this.Up(D))return!1;this.mergeSuspensionManager&&(ha.LabelText=this.twc,ha.On=this.EKd);return!0}dispose(){this.gXb&&(this.Ha.Yhb(this.gXb),
this.gXb.dispose(),this.gXb=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.fra.hib(this.vDa),this.mergeSuspensionManager.$la.xDc(this.EUa),this.mergeSuspensionManager=null);this.statusBarManager&&(this.statusBarManager.MI(this),this.statusBarManager=null);this.twc=null;super.dispose()}}dd.gJd="MSMSC";dd.Dqj="QueryMergeSuspensionStatus";Object(da.a)(dd,"MergeSuspensionIndicatorManager",qb.a,[295,188,5]);var Rd=a(2),Yd=a(932);class Md extends Sys.EventArgs{constructor(D){super();this.FBa=
D}}Object(da.a)(Md,"TogglePendingMergeBlockedByClientEventArgs",Sys.EventArgs,[]);class ad{}Object(da.a)(ad,"SuspensionState",null,[]);class Mb extends ad{constructor(D){super();this.eEe=!1;this.eEe=D}}Object(da.a)(Mb,"ReadyForPendingMergeState",ad,[]);const Aa=new ad,Bc=new ad,Vc=new Mb(!1),hc=new Mb(!0);var xc=a(933);class ab extends xc.a{constructor(D,ha,fb){super(D);this.E2g=ha;this.H2j=fb}}Object(da.a)(ab,"ReadyForPendingMergesUpdatedEventArgs",xc.a,[]);class Wb extends qb.a{constructor(D,ha,
fb){super();this.vDa=(Vb,Gc)=>{Vb=this.getState();const zd=this.w3;this.w3=Gc.xga;Gc=this.getState();this.pTi(Vb,Gc,zd);this.raiseEvent(Wb.bJd);this.L7e(Vb,Gc)};this.EUa=(Vb,Gc)=>{Vb=this.getState();this.iL=Gc.iL;Gc=this.getState();this.L7e(Vb,Gc)};this.YNb=(Vb,Gc)=>{this.pcb&&4===Gc.dHf&&(ba.ULS.sendTraceTag(520480203,0,50,"MergeSuspensionStateHandler.onMergeDidntOccur: Retry DoPendingMerge after bailout. Current merge counter: {0}, Response merge counter: {1}",Ka(this.w3),Ka(Gc.w3)),this.K1f(this.getState(),
!0))};this.DHb=ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1);this.pcb=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:7464389_RetryDoPendingMergeAfterBailout");this.$la=D;this.$la.g8b(this.EUa);this.fra=ha;this.fra.J3a(this.vDa);this.pcb&&(this.NCa=fb,this.NCa.rCe(this.YNb));this.w3=Object(Rd.a)(new Yd.a,{Pending:0,Current:0,SuspensionStartTimestamp:null});this.iL=this.Tui()}Tui(){return Object(U.a)(rc,this.$la)?Object(pb.a)(rc,this.$la).Fjc():1}l8b(D){this.addHandler(Wb.i8d,
D)}BDc(D){this.removeHandler(Wb.i8d,D)}$_g(D){this.addHandler(Wb.FTd,D)}ACj(D){this.removeHandler(Wb.FTd,D)}o_g(D){this.addHandler(Wb.bJd,D)}aCj(D){this.removeHandler(Wb.bJd,D)}Csj(){this.WSd(this.getState()===Bc)}dispose(){this.$la.xDc(this.EUa);this.$la=null;this.fra.hib(this.vDa);this.fra=null;this.pcb&&(this.NCa.f7f(this.YNb),this.NCa=null);super.dispose()}krd(){return Object(Rd.a)(new Yd.a,{Current:this.w3.Current,Pending:this.w3.Pending,SuspensionStartTimestamp:this.w3.SuspensionStartTimestamp})}getState(){return Pb(this.w3)?
0==this.iL?hc:this.DHb&&1==this.iL?Vc:Bc:Aa}L7e(D,ha){D!==ha&&(ha===Bc?this.WSd(!0):D===Bc&&this.WSd(!1));this.K1f(ha)}K1f(D,ha){D instanceof Mb&&this.raiseEvent(Wb.FTd,new ab(this.w3,D.eEe||!this.DHb,void 0===ha?!1:ha))}pTi(D,ha,fb){D===Aa&&ha!==Aa?(D=ha===Bc,ha=ha===Vc,ba.ULS.sendTraceTag(252760283,0,50,`MergeSuspensionStateHandler.LogPendingMergesStatusChanged: Pending changes exist. IsBlocking: ${ha} publisher: ${ha||D?this.$la.Ufk.join(","):""} counter: ${Ka(this.w3)} isBlockingAllMerges: ${D}`)):
D!==Aa&&ha===Aa&&ba.ULS.sendTraceTag(252760284,0,50,`MergeSuspensionStateHandler.LogPendingMergesStatusChanged: No pending changes. counter: ${Ka(fb)}`)}WSd(D){this.raiseEvent(Wb.i8d,new Md(D))}}Wb.i8d="TPMBBC";Wb.FTd="RFPMU";Wb.bJd="MCC";Object(da.a)(Wb,"MergeSuspensionStateHandler",qb.a,[]);class Yc extends qb.a{constructor(D){super();this.Y5=null;this.vtc=0;this.aMb=(ha,fb)=>{(null===fb||void 0===fb?0:fb.xga)&&this.wUa(fb.xga,Yc.bce)};this.eGc=()=>{this.S9f();this.z1f(this.Y5,Yc.lGj)};this.NMd=
(ha,fb)=>{fb.committed&&this.Y5.SuspensionStartTimestamp&&ba.ULS.sendTraceTag(17318084,0,50,`PendingMergeMonitor.OnEditCellEnded: committed with counter ${Ka(this.Y5)}`)};this.S9f();this.$=D;this.$.ea.Zl(this.eGc);this.$.ea.BM(this.eGc);$a.h(this.$).he.Mq(this.NMd);this.$.ga.qd(292,ha=>{ha.J3a(this.aMb);ba.ULS.sendTraceTag(588276809,0,50,"PendingMergeMonitor initialized")})}J3a(D){this.addHandler("MCU",D)}hib(D){this.removeHandler("MCU",D)}get w3(){return this.Y5}wUa(D,ha){ha=void 0===ha?"":ha;const fb=
this.Y5.Current<D.Current||this.Y5.Pending<D.Pending;if(D.SuspensionStartTimestamp&&this.vtc!==D.SuspensionStartTimestamp){if(this.vtc>D.SuspensionStartTimestamp){fb&&ba.ULS.sendTraceTag(553736149,0,50,`PendingMergeMonitor.OnMergeCounterReceivedFromServer: skipping a higher stale counter received via ${ha}. S: ${Yc.$Lb(D)}, C: ${Yc.$Lb(this.Y5)}`);return}fb||ba.ULS.sendTraceTag(553736148,0,50,`PendingMergeMonitor.OnMergeCounterReceivedFromServer: recovering from a potentially stale counter. S: ${Yc.$Lb(D)}, C: ${Yc.$Lb(this.Y5)}`)}else if(!fb)return;
this.Y5=D;this.z1f(D,ha)}dispose(){this.$.ea.gm(this.eGc);this.$.ea.rR(this.eGc);$a.h(this.$).he.$p(this.NMd);const D=this.$.ga.Da(292);D&&D.hib(this.aMb);super.dispose()}z1f(D,ha){ha=void 0===ha?"":ha;Pb(D)&&D.SuspensionStartTimestamp>this.vtc&&(ba.ULS.sendTraceTag(537155416,0,50,`PendingMergeMonitor.RaiseMergeCounterUpdated: Merge suspension requested. MergeCounter: ${Ka(D)}, Origin: ${ha}`),this.vtc=D.SuspensionStartTimestamp);this.raiseEvent("MCU",new xc.a(D))}S9f(){ba.ULS.sendTraceTag(588276808,
0,50,`PendingMergeMonitor.ResetMergeCounter : Last counter was ${Yc.$Lb(this.Y5)}`);this.Y5=Object(Rd.a)(new Yd.a,{Pending:0,Current:0,SuspensionStartTimestamp:null})}static $Lb(D){return D?`(${D.Current}/${D.Pending} @${D.SuspensionStartTimestamp})`:"null"}}Yc.bce="PMM.RTC";Yc.Zfc="PMM.EwaResult";Yc.lGj="PMM.resetMergeCounter";Object(da.a)(Yc,"PendingMergeMonitor",qb.a,[]);class Tc{}Object(da.a)(Tc,"ClientRevisions",null,[]);var ed=a(48),be=a(59);const Fc=(D,ha,fb,Vb,Gc,zd,ae)=>{ae=D.Pa(1,void 0===
ae?null:ae);ae.suspensionStartTimestamp=ha;return be.g(D,"KeepBlockingPendingMerges",ae,fb,Vb,Gc,zd,0)};class vd extends qb.a{constructor(D,ha,fb,Vb){super();this.UNa=null;this.XJb=0;this.YJb=this.$cb=null;this.KSf=(Gc,zd)=>{this.UNa.q6g(zd.xga,zd.E2g,zd.H2j)};this.DOb=(Gc,zd)=>{zd.FBa?this.X4j():this.rJc()};this.ZQf=()=>{this.XJb=0};this.wdg=()=>{const Gc=this.o$.krd();Fc(this.ua,null!=Gc.SuspensionStartTimestamp?Gc.SuspensionStartTimestamp:0,null,()=>{this.laj(Gc)},null,null,this.ua.ie())};this.eHa=
(Gc,zd)=>{if(zd){zd.Wub.MergeCount=this.o$.krd();let ae;({min:Gc,max:ae}=$a.h(this.$).yYi());ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5524817_LogOnMergeRaceCondition2")?zd.Wub.ClientRevisions=Object(Rd.a)(new Tc,{Min:Gc,Max:ae,MaxFromBlockCache:$a.h(this.$).ya.DGf}):zd.Wub.ClientRevisions=Object(Rd.a)(new Tc,{Min:Gc,Max:ae})}};this.$=D;this.A4a=fb;this.o$=ha;this.o$.$_g(this.KSf);this.o$.l8b(this.DOb);this.o$.o_g(this.ZQf);this.$.qa.hla(this.eHa);this.ua=this.$.qa.ua;this.pXd=this.$.xa.MergeSuspensionRequestThrottlingTimeInMs;
this.zNi=this.$.xa.KeepBlockingPendingMergesRequestIntervalMs;this.UNa=Vb;ba.ULS.sendTraceTag(588276807,0,50,"RequestController initialized")}dispose(){this.$.qa.Nra(this.eHa);this.rJc();this.o$.ACj(this.KSf);this.o$.BDc(this.DOb);this.o$.aCj(this.ZQf);this.o$=null;super.dispose()}X4j(){this.rJc();if(this.qXe()){const D=this.o$.krd();ba.ULS.sendTraceTag(537155414,0,50,`RequestController.StartKeepBlockingPendingMergesTimer: Prevented starting StartKeepBlockingPendingMergesTimer because of repeated failure in counter ${Ka(D)} fail count: ${this.XJb}`)}else this.YJb=
this.A4a.create(this.wdg,this.pXd,ed.a.YJb),this.$cb=this.A4a.CF(this.wdg,this.zNi,ed.a.$cb)}rJc(){this.$cb&&(this.YJb.cancel(),this.$cb.cancel(),this.$cb=this.YJb=null)}laj(D){let ha;ha=" fail count: "+this.XJb;this.XJb++;this.qXe()&&this.rJc();ba.ULS.sendTraceTag(542229773,0,10,`RequestController.OnKeepBlockingPendingMergesRequestFailed: request failed ${Ka(D)}${ha}`)}qXe(){return this.XJb>vd.kXi}}vd.kXi=5;Object(da.a)(vd,"RequestController",qb.a,[]);var lb=a(179),Eb=a(207),Hc=a(33),Bd=a(247);class he extends Sys.EventArgs{constructor(D,
ha){super();this.dHf=D;this.w3=ha}}Object(da.a)(he,"MergeDidntOccurEventArgs",Sys.EventArgs,[]);var je=a(137),Fd=a(15);class Oc extends qb.a{get vRa(){return 0<this.TOd}constructor(D,ha,fb,Vb,Gc){fb=void 0===fb?null:fb;Vb=void 0===Vb?null:Vb;Gc=void 0===Gc?null:Gc;super();this.utc=null;this.TOd=0;this.documentVisibilityObserver=null;this.Hzf=!1;this.Kvc=null;this.ua=D;this.pXd=ha.xa.MergeSuspensionRequestThrottlingTimeInMs;const zd=ha.xa.GetRangeContentPrefetchDelayForMergeInMs;this.iB=()=>{ha.hcg(zd)};
this.zj=fb||Hc.a.$b;this.zxg=0;this.DO=Vb;this.cFa=Gc;ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void je.a.resolve(Fd.O).then(ae=>{this.documentVisibilityObserver=ae}):ha.ga.qd(291,ae=>{this.documentVisibilityObserver=ae})}p_g(D){this.addHandler(Oc.hJd,D)}bCj(D){this.removeHandler(Oc.hJd,D)}rCe(D){this.addHandler(Oc.cJd,D)}f7f(D){this.removeHandler(Oc.cJd,D)}get isDocumentHidden(){return!!this.documentVisibilityObserver&&this.documentVisibilityObserver.hj}q6g(D,
ha,fb){this.lVb(D,ha,void 0===fb?!1:fb)?(new lb.a).setResult(!0):(ha=this.tkj(D,ha),this.utc=D,this.TOd++,ha.continueWith(()=>{this.D6i()},0,Eb.a.none,this.DO))}tkj(D,ha){this.zxg=this.zj.Xia;this.Hzf=ha;ba.ULS.sendTraceTag(554767493,0,50,`DoPendingMergeSender.performDoPendingMergeInternal: Sending DoPendingMerge ${D.Current} / ${D.Pending} @${D.SuspensionStartTimestamp}. allowSelectionAdjustment: ${ha}`);this.isDocumentHidden||this.iB();return this.SMj(ha,D)}lVb(D,ha,fb){fb=void 0===fb?!1:fb;if(this.cFa&&
!ha&&!this.cFa.HKi())return ba.ULS.sendTraceTag(523317956,0,50,"DoPendingMergeSender.shouldThrottle: We can't retrieve selection and selection adjustments are disallowed."),!0;if(!this.utc||D.SuspensionStartTimestamp>this.utc.SuspensionStartTimestamp)return this.vRa&&ba.ULS.sendTraceTag(523551556,0,50,`DoPendingMergeSender.shouldThrottle: Allowing request for new suspension while previous is ongoing, new counter: ${D.Current} / ${D.Pending} @${D.SuspensionStartTimestamp}`),!1;if(this.vRa)return!0;
if(fb)return!1;fb=this.utc;const Vb=this.zj.Xia-this.zxg<this.pXd;ha=this.Hzf===ha;return(D||fb?D&&fb?D.Current===fb.Current&&D.Pending===fb.Pending&&D.SuspensionStartTimestamp===fb.SuspensionStartTimestamp:!1:!0)&&Vb&&ha}SMj(D,ha){const fb=this.ua.ie(),Vb=()=>{ba.ULS.sendTraceTag(588276806,0,10,`DoPendingMergeSender.sendDoPendingMergeRequest: request failed ${ha.Current} / ${ha.Pending} @${ha.SuspensionStartTimestamp}`)};return this.cFa?this.cFa.tJj(this.N6h(D,Vb,fb)):this.NKe(null,!0,void 0,Vb,
fb)}N6h(D,ha,fb){return(Vb,Gc,zd)=>{let ae=void 0;ba.ULS.shipAssertTag(523317955,0,null!=Vb||D,"!allowSelectionAdjustment requires a non-null initialViewportState.");ae=this.E6i.bind(this);Gc&&(ae=Bd.b.call(null,He=>{const hf=He.Result;let zf=null===hf||void 0===hf?void 0:hf.AdjustedViewportState;3===(null===hf||void 0===hf?void 0:hf.MergeResultState)&&(zf=void 0);Gc(zf,He.StateId)},ae));zd&&(ha=Bd.a.call(null,zd,ha));return this.NKe(Vb,D,ae,ha,fb)}}NKe(D,ha,fb,Vb,Gc){var zd=this.ua;Gc=zd.Pa(1,void 0===
Gc?null:Gc);Gc.viewportState=D;Gc.allowViewAdjustment=ha;return be.g(zd,"DoPendingMerge",Gc,fb,Vb,null,null,0)}E6i(D){var ha=D.Result;void 0!=ha&&(ha=ha.MergeResultState,ib.EwaSettings.isChangeGateEnabled("OfficeVSO:7464389_RetryDoPendingMergeAfterBailout")&&2!==ha?this.Kvc=[ha,D.MergeCount]:3===ha&&(ba.ULS.sendTraceTag(523317954,0,50,"DoPendingMergeSender.onDoPendingMergeSucceeded: Aborted merge."),this.asj()))}asj(){this.raiseEvent(Oc.hJd,new Sys.EventArgs)}$rj(D,ha){this.raiseEvent(Oc.cJd,new he(D,
ha))}D6i(){this.TOd--;if(this.Kvc){const D=this.Kvc;this.Kvc=null;this.$rj(...D)}}}Oc.hJd="MWA";Oc.cJd="MDO";Object(da.a)(Oc,"DoPendingMergeSender",qb.a,[687,688]);class Ad{constructor(D){this.divergenceOnResponse=this.adjustedDidntChangeWithDivergence=this.editBoxDivergence=this.differentSheetAdjust=this.parallel=this.errors=this.nonContinuous=this.divergenceOnViewportReady=this.adjusted=this.adjustedDidntChange=0;this.Fti=void 0===D?!1:D}get reportName(){return this.Fti?"SelectionAdjustInHiddenDocument":
"SelectionAdjust"}}Object(da.a)(Ad,"SelectionAdjustSessionEndsReport",null,[527]);var Gb=a(45);class Wc{constructor(D,ha,fb,Vb,Gc,zd){this.vd=D;this.lJ=ha;this.Nca=fb;this.V4b=Vb;this.gee=Gc;this.$O=zd}get activeCell(){return this.lJ}get selectedRanges(){return this.Nca}get tt(){let D=!1;if(null===this.$O||void 0===this.$O)D=!0;else if(this.$O>=this.selectedRanges.length||!this.selectedRanges[this.$O].contains(this.activeCell))ba.ULS.sendTraceTag(521200010,0,50,`SelectionState.indexOfActiveRange: the index of the adjusted active range has changed. indexOfActiveRange: ${this.$O}, selectedRangesLength: ${this.selectedRanges.length}`),
D=!0;D&&(this.$O=this.Cch());return this.$O}get activeRange(){return 0>this.tt?this.activeCell:this.selectedRanges[this.tt]}get sheetName(){return this.V4b}get activeItemName(){return this.gee}get hCg(){return 1===this.selectedRanges.length}Eyg(D){let ha=this.selectedRanges.map(fb=>this.mdk(fb,this.gee));for(let fb of ha)if(fb)for(let Vb of fb)if(Vb.sl&&Vb.dg.Revision<D)return!1;return!0}M$j(){var D;return{SheetName:this.sheetName,ActiveCell:null===(D=this.activeCell)||void 0===D?void 0:D.toString(),
TopLeft:void 0,SelectedRanges:Gb.r(this.selectedRanges,this.vd)}}toString(){var D,ha;return`active cell: ${null!==(ha=null===(D=this.activeCell)||void 0===D?void 0:D.toString())&&void 0!==ha?ha:"null"} selection: ${Nb.f(this.selectedRanges,fb=>{var Vb;return null!==(Vb=null===fb||void 0===fb?void 0:fb.toString())&&void 0!==Vb?Vb:"null"}).join(",")}`}equals(D){return D?this.activeCell.equals(D.activeCell)&&Gb.R(this.selectedRanges,D.selectedRanges)&&this.sheetName===D.sheetName:!1}Cch(){for(let D of this.selectedRanges.entries()){let [ha,
fb]=D;if(null===fb||void 0===fb?0:fb.contains(this.activeCell))return ha}return-1}mdk(D,ha){var fb;const Vb=$a.h(this.vd).ya.yPa(D,ha);Vb||ba.ULS.sendTraceTag(522803340,0,50,`SelectionState.tryGetBlockCacheItemsFromRange: no items found. range: ${null!==(fb=null===D||void 0===D?void 0:D.toString())&&void 0!==fb?fb:"null"} ; activeItemNameIsDefined: ${!!ha}`);return Vb}}Object(da.a)(Wc,"SelectionState",null,[]);var pd=a(223),fe=a(769);class le{constructor(D){this.lJc=0;this.YJ=this.iI=null;this.yee=
new Ad;this.zee=new Ad(!0);this.aL=0;this.V8j=!1;this.DYi=1E4;this.wf=()=>{this.hUe()};this.ek=()=>{this.a8c(!0,!1)};this.ffb=()=>{this.a8c(!1,!1)};this.$=D;this.gridView=$a.h(this.$);this.gridView.ya.Ws(this.ek);this.gridView.ya.Eu(this.ffb);this.gridView.ya.BBe(this.ffb);this.gridView.ya.eda(this.ffb);this.$.Zm(this.wf);this.hUe()}tJj(D){let ha=null,fb=null,Vb=()=>{this.b3i()};this.trf()?(this.NS.parallel++,ba.ULS.sendTraceTag(526390086,0,15,`SelectionAdjustManager.runRequestWithSelectionAdjust: Skipping parallel request. Current adjustedSelection is defined : ${!!this.YJ}`)):
(ha=(Gc,zd)=>{this.c3i(Gc,zd)},fb=this.ISj());return null===D||void 0===D?void 0:D(fb,ha,Vb)}HKi(){return!this.trf()&&this.Xea().hCg}ISj(){var D;ba.ULS.shipAssertTag(525135961,0,0===this.aL,"SelectionAdjustManager.setPreRequestState: unexpected state");this.YJ&&(this.NS.errors++,ba.ULS.sendTraceTag(526960090,0,10,`SelectionAdjustManager.setPreRequestState: About to ignore a defined Adjusted selection: ${this.YJ.toString()}`));this.YJ=null;this.iI=this.Xea();let ha=null;const fb=null===(D=this.iI)||
void 0===D?void 0:D.M$j();fb&&(ha={ActiveSheetName:this.iI.sheetName,SheetViewportStateChanges:[fb]});this.aL=1;return ha}b3i(){ba.ULS.shipAssertTag(525135960,0,1===this.aL,"SelectionAdjustManager.onAdjustedRequestFailed: unexpected state");this.NS.errors++;this.aL=2;this.Xt()}c3i(D,ha){try{ba.ULS.shipAssertTag(525135959,0,1===this.aL,"SelectionAdjustManager.onAdjustedSelectionReady: unexpected state"),this.lJc=ha,ha=2,this.iI?D?(this.YJ=this.mWj(D))?(ha=7,this.iI.equals(this.YJ)?this.iI.equals(this.Xea())?
(this.NS.adjustedDidntChange++,ha=4):(this.NS.adjustedDidntChangeWithDivergence++,ha=5):this.iI.sheetName!=this.YJ.sheetName?(this.NS.differentSheetAdjust++,ha=10):this.iI.equals(this.Xea())||(this.NS.divergenceOnResponse++,ha=6,this.r8f())):this.NS.errors++:(this.NS.errors++,ba.ULS.sendTraceTag(537155412,0,15,`SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted returned null, initialSelection: ${this.iI.toString()}`)):(this.NS.errors++,ba.ULS.sendTraceTag(537155413,0,10,`SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted selection results returned when not waiting for them, adjusted:  ActiveCell: ${null===
D||void 0===D?void 0:D.ActiveCell}`)),this.aL=ha}catch(fb){this.aL=12,ba.ULS.sendTraceTag(525135958,0,10,`SelectionAdjustManager.OnAdjustedSelectionReady: caught Exception ${fb}`)}finally{7!=this.aL?this.Xt():this.a8c(!1,!0)}}dispose(){this.gridView.ya.Bs(this.ek);this.gridView.ya.Ft(this.ffb);this.gridView.ya.w6f(this.ffb);this.gridView.ya.xWa(this.ffb);this.$.co(this.wf)}trf(){return 1===this.aL||7===this.aL}mWj(D){let ha;if(!(()=>{let zd=Gb.ab(D.ActiveCell,this.$.va);({range:ha}=zd);return zd})().returnValue)return ba.ULS.sendTraceTag(537155411,
0,10,`SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract active cell ${D.ActiveCell}`),null;let fb=[];const Vb=this.$.na,Gc=!!Vb&&2===Vb.YI;if(D.SelectedRanges)fb=Gb.g(D.SelectedRanges.Ranges);else if(!Gc)return ba.ULS.sendTraceTag(522826913,0,10,`SelectionAdjustManager.sheetViewportStateToSelectionState: SelectedRanges is null, active sheet exists: ${!!Vb}`),null;return new Wc(this.$,ha,fb,D.SheetName,this.iI.activeItemName,this.iI.tt)}Xea(){const D=this.$.na;if((null===
D||void 0===D?0:D.activeCell)&&D.selectedRanges&&D.sheetName)return new Wc(this.$,D.activeCell,D.selectedRanges,D.sheetName,this.$.activeItemName,D.tt);ba.ULS.sendTraceTag(525135957,0,15,`SelectionAdjustManager.getCurrentSelection: invalid activeItem. activeItem null: ${!D}, activeCell null: ${!(null===D||void 0===D?0:D.activeCell)}, selectedRanges null: ${!(null===D||void 0===D?0:D.selectedRanges)}, sheetName null: ${!(null===D||void 0===D?0:D.sheetName)}`);return null}hUe(){this.$.ga.qd(276,()=>
{const D=pd.a(this.$);D.VW(this.yee);D.VW(this.zee)})}a8c(D,ha){var fb;if(this.LIi(D))if(8===this.aL)ba.ULS.sendTraceTag(523106438,0,15,"SelectionAdjustManager.attemptAdjustSelection: skipping as was already adjusted");else{ha&&ba.ULS.sendTraceTag(524039250,0,50,"SelectionAdjustManager.attemptAdjustSelection: viewport ready on response");try{ba.ULS.shipAssertTag(525135956,0,7===this.aL,"SelectionAdjustManager.attemptAdjustSelection: unexpected state"),this.iI.equals(this.Xea())?(null===(fb=this.gridView)||
void 0===fb?0:fb.ld)?(this.NS.editBoxDivergence++,this.aL=11):(D=0,D=this.YJ.tt,-1==D?(this.NS.errors++,ba.ULS.sendTraceTag(522826912,0,10,"SelectionAdjustManager.attemptAdjustSelection: invalid indexOfActiveRange")):(this.NS.adjusted++,this.aL=8,this.gridView.ha.WI(this.YJ.selectedRanges,D,this.YJ.activeCell,0,void 0,"SelectionAdjust"))):(this.NS.divergenceOnViewportReady++,this.r8f(),this.aL=9)}catch(Vb){this.aL=12,ba.ULS.sendTraceTag(525135955,0,10,`SelectionAdjustManager.attemptAdjustSelection: caught Exception ${Vb}`)}finally{this.Xt()}}}LIi(D){if(!this.YJ)return!1;
if(!this.iI)return ba.ULS.sendTraceTag(537155409,0,10,`SelectionAdjustManager.attemptAdjustSelection: initialSelection is null while adjustedSelection isn't null, adjustedSelection: ${this.YJ.toString()}`),!1;if($a.h(this.$).ya.DGf<this.lJc)return!1;if(D||this.V8j)ba.ULS.sendTraceTag(528590295,0,15,"SelectionAdjustManager.attemptAdjustSelection: got to blockCacheConsistent while pending for selection adjust");else if(!this.iI.Eyg(this.lJc)||!this.YJ.Eyg(this.lJc))return!1;return!0}Xt(){this.iI=this.YJ=
null;this.aL=0}r8f(){const D=this.Xea();ba.ULS.sendTraceTag(537155408,0,50,`SelectionAdjustManager.ReportDivergence: initial: ${this.iI.toString()} current: ${D?D.toString():""} adjusted: ${this.YJ.toString()} sheetSameBetweenInitialAndAdjusted: ${this.iI.sheetName===this.YJ.sheetName} sheetSameBetweenInitialAndCurrent: ${this.iI.sheetName===(D?D.sheetName:null)}`)}get NS(){return fe.a.aG(this.DYi)?this.zee:this.yee}}Object(da.a)(le,"SelectionAdjustManager",null,[686,5]);class te extends za.a{constructor(D,
ha,fb){fb=void 0===fb?null:fb;super();this.SHa=this.noc=this.wab=this.M5a=null;this.$=D;this.W1a=new Yc(D);this.cFa=new le(this.$);this.UNa=new Oc(this.$.qa.ua,this.$,void 0,void 0,this.cFa);this.qvi(D,fb);this.Wja=new Wb(this.SHa,this.W1a,this.UNa);this.jXd=new vd(D,this.Wja,ha,this.UNa);ib.EwaSettings.Ea(230)&&(this.noc=new dd(D,this));ba.ULS.sendTraceTag(588276810,0,50,"MergeSuspensionManager created")}l8b(D){this.Wja.l8b(D)}BDc(D){this.Wja&&this.Wja.BDc(D)}get $la(){return this.SHa}get fra(){return this.W1a}get o$(){return this.Wja}yEa(D,
ha){this.SHa.yEa(D,ha)}V9d(D){this.SHa.V9d(D)}wUa(D,ha){this.W1a.wUa(D,void 0===ha?"":ha)}dispose(){this.noc&&(this.noc.dispose(),this.noc=null);this.cFa&&this.cFa.dispose();this.UNa.dispose();this.jXd&&(this.jXd.dispose(),this.jXd=null);this.Wja&&(this.Wja.dispose(),this.Wja=null);this.W1a.dispose();this.W1a=null;this.SHa.dispose();this.SHa=null;this.M5a&&(this.M5a.dispose(),this.M5a=null);this.wab&&(this.wab.dispose(),this.wab=null);this.$=null;super.dispose()}pQb(){this.Wja.Csj()}static Fjc(D){let ha=
0;for(let fb of D){if(2==fb)return 2;1==fb&&(ha=1)}return ha}qvi(D,ha){this.SHa=new rc(this.UNa,this.W1a);ha?Object(U.a)(Jd,ha)?this.yEa(ha,Object(pb.a)(Jd,ha).iL):Object(U.a)(hb,ha)?this.yEa(ha,Object(pb.a)(hb,ha).iL):this.yEa(ha,0):(this.M5a=new hb(D),this.wab=new Jd(D),this.yEa(this.M5a,this.M5a.iL),this.yEa(this.wab,this.wab.iL))}}Object(da.a)(te,"MergeSuspensionManager",za.a,[671,5]);class Ce extends Ta.a{constructor(D){super();this.pf=D;this.je()}create(){ba.ULS.sendTraceTag(537155419,0,50,
"MergeSuspensionFactory.Create");this.Ld(this.pf.ga.Da(343)||this.pf.ga.Qa(343,new te(this.pf,W.a.instance)))}static la(D){ba.ULS.sendTraceTag(537155418,0,50,"MergeSuspensionFactory.Attach");D.ga.Qa(344,new Ce(D))}}Object(da.a)(Ce,"MergeSuspensionFactory",Ta.a,[]);var Xb=a(731),oc=a(96),Zc=a(103),yd=a(63),Od=a(16);class dc{}dc.$Pi=3;dc.connected=0;Object(da.a)(dc,"ConnectionStateConstants",null,[]);var gd=a(120),wd=a(133),Ld=a(46);class Xd{constructor(D,ha,fb){var Vb;this.type=0;this.startTime=null;
this.blockedOperationsCount=this.durationMs=0;this.blockedActions=null;this.blockedUserOperationsWhileToastShown=this.durationUntilToastShownMs=0;this.toastRaiser=null;this.wasUserActiveOnPIEnd=this.wasUserActiveOnPIStart=this.hasTabbedOut=this.isToastShown=!1;this.durationUntilUserInactive=-1;this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1;this.ILf=(Gc,zd)=>{this.blockedOperationsCount++;Gc=`${zd.componentName}_${zd.actionName}_${zd.details})`;this.blockedActions[Gc]=this.blockedActions[Gc]?
this.blockedActions[Gc]+1:1;this.isToastShown&&this.blockedUserOperationsWhileToastShown++};this.MOd=Gc=>{this.durationUntilUserInactive=gd.getElapsedSeconds(this.startTime,Hc.a.$b.ke);Gc.qWd(this.MOd)};this.BI=()=>{this.hasTabbedOut=!0};this.Uga=(Gc,zd)=>{zd.uXf!==this.type||this.isToastShown||(this.durationUntilToastShownMs=wd.a(Hc.a.$b,this.startTime),this.toastRaiser=zd.toastRaiser,this.isToastShown=!0)};this.startTime=D;this.durationUntilToastShownMs=0;this.blockedActions={};this.isToastShown=
fb;if(null===(Vb=ha.ea)||void 0===Vb?0:Vb.Ah)this.wasUserActiveOnPIStart=ha.ea.Ah.us;this.il(ha);this.isDialogShown=0<ha.yd.cR;D=ha.ga.Da(183);this.isTaskPaneShown=!!D&&D.isVisible&&!D.isCollapsed;this.isTaskPaneCollapsed=!!D&&D.isVisible&&D.isCollapsed}lfg(){this.durationMs=wd.a(Hc.a.$b,this.startTime)}RNd(D){var ha;this.lfg();Ld.a(D).ERb(this.ILf);Ld.a(D).ti.vDc(this.Uga);ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void je.a.resolve(Fd.O).then(fb=>
{fb.zWa(this.BI)}):D.ga.qd(291,fb=>{fb.zWa(this.BI)});if(null===(ha=D.ea)||void 0===ha?0:ha.Ah)D.ea.Ah.qWd(this.MOd),this.wasUserActiveOnPIEnd=D.ea.Ah.us}il(D){Ld.a(D).c8b(this.ILf);this.isToastShown?this.toastRaiser="Immediate":Ld.a(D).ti.K5c(this.Uga);ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void je.a.resolve(Fd.O).then(ha=>{this.hasTabbedOut=ha.hj;ha.P0(this.BI)}):D.ga.qd(291,ha=>{this.hasTabbedOut=ha.hj;ha.P0(this.BI)});this.wasUserActiveOnPIStart&&
D.ea.Ah.aDe(this.MOd)}}Object(da.a)(Xd,"PartialInteractivityData",null,[]);var Ie=a(1115);class We extends Xd{constructor(D,ha,fb,Vb,Gc,zd){super(D,ha,Vb);this.swappedOffline=this.swappedByOffline=!1;this.lastFailedRequestToOnlineTimeGapSec=this.longestDurationBetweenFailedRequestsSec=this.averageDurationBetweenFailedRequestsSec=0;this.errorDataDuringConnectivityIssuesMode=this.disconnectionSource=null;this.failedRequests=[];this.triggeringRequest=null;this.type=4;this.swappedOffline=fb;this.disconnectionSource=
Enum.toString(Ie.a,Gc);this.triggeringRequest=zd}x5i(D,ha){this.swappedByOffline=ha;this.RNd(D)}vQj(D){this.errorDataDuringConnectivityIssuesMode=D}jvj(D){10>this.failedRequests.length&&(D=D+"_"+gd.getElapsedSeconds(this.startTime,Hc.a.$b.ke).toString(),this.failedRequests.push(D))}}Object(da.a)(We,"ConnectivityIssuesData",Xd,[]);var jf=a(171),tc=a(139),Qc=a(122);class xd{}xd.kDh="DuringWork";xd.connectivityIssues="ConnectivityIssues";xd.offline="Offline";Object(da.a)(xd,"UnavailabilityTypes",null,
[]);var Gd=a(55);class pe{constructor(D){this.ptc=this.data=null;this.vld=0;this.DQe=null;this.ZMf=(ha,fb)=>{fb.JS?(this.data=new We(Hc.a.$b.ke,this.$,5===fb.ata,0!==fb.ata,this.$.Ug.disconnectionSource,this.DQe),this.ptc=this.$.Ug.AAf,this.vld=1,this.$.qa.Ug.f1g(this.So),jf.a(this.$).n5c(this.ybg)):(this.data.x5i(this.$,5===fb.ata),this.$.qa.Ug.A7f(this.So),this.data.lastFailedRequestToOnlineTimeGapSec=gd.getElapsedSeconds(this.ptc,Hc.a.$b.ke),ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_7pzab_ConnectivityIssues")?
Gd.b().LTb(557682689,0,50,xd.connectivityIssues,this.data.durationMs,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",yd.a.He(this.data)):ba.ULS.sendTraceTag(557682689,0,50,`ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: ${yd.a.He(this.data)}`),this.data&&this.data.isToastShown&&Zc.Health.instance.recordQosError(tc.a.Fhh,[Qc.a.$tc],!0,!1,!1,!1,null),jf.a(this.$).IVd(this.ybg),this.data=null)};this.ybg=
(ha,fb)=>{this.data.vQj(fb.PH)};this.So=(ha,fb)=>{this.data.jvj(fb.context.methodName);ha=Hc.a.$b.ke;fb=gd.getElapsedSeconds(this.ptc,ha);this.ptc=ha;fb>this.data.longestDurationBetweenFailedRequestsSec&&(this.data.longestDurationBetweenFailedRequestsSec=fb);this.vld++;this.data.averageDurationBetweenFailedRequestsSec=this.kch(fb)};this.WMf=(ha,fb)=>{this.DQe=fb.Jck};this.$=D;Ld.a(this.$).ti.LBe(this.ZMf);this.$.Ug.KBe(this.WMf)}dispose(){this.$&&(Ld.a(this.$).ti.G6f(this.ZMf),this.$.Ug&&this.$.Ug.F6f(this.WMf));
this.data&&this.$.qa.Ug.A7f(this.So);this.$=null}kch(D){const ha=this.vld-1;return(this.data.averageDurationBetweenFailedRequestsSec*(ha-1)+D)/ha}}Object(da.a)(pe,"ConnectivityIssuesTelemetryManager",null,[5]);var Dc=a(909),Wa=a(8),Qb=a(1114),Lc=a(1113);class Ba{constructor(D){this.zag=null;this.UEd=this.pJd=this.cNb=this.dNb=0;this.f3d=!1;this.ucd=this.GYa=this.JIc=this.Geb=null;this.Kcd=0;this.NMj=()=>{if(12E4>this.$.ea.Ah.hlb)for(let ha of this.JIc)ha.runTest();else this.d6d("UserInactive")};this.mFj=
ha=>{ha=Sys.Serialization.JavaScriptSerializer.serialize(ha);ba.ULS.sendTraceTag(388821830,0,50,ha)};this.BEj=ha=>{if(ha){var fb=this.ucd[ha.testIteration.toString()];fb?fb.push(ha):(fb=[ha],this.ucd[ha.testIteration.toString()]=fb);if(fb.length===this.zag.length){fb=Sys.Serialization.JavaScriptSerializer.serialize(fb);if(this.$&&this.$.Ug){if(ha.EstimatedLatency=this.$.Ug.XHe,this.$.Ug.XHe>this.$.LB.ExcelRountripThresholdMs){ba.ULS.sendTraceTag(570712144,0,50,`Periodic ping tests results when network is slow: ${fb}, consequtive slow ping iteration #: ${this.Kcd++}`);
return}}else ba.ULS.sendTraceTag(537155209,0,50,"EwaControl/ConnectivityObserver is null when conducting slow connection speed tests");ba.ULS.sendTraceTag(570712142,0,50,`Periodic ping tests results: ${fb}`);this.Kcd=1}}};this.xj=(ha,fb)=>{ha=fb.context.methodName;if(ha===Wa.a.nEb||ha===Wa.a.nAa)this.cNb++,ha=Date.now(),this.VXj(ha)&&(this.cNb=0,this.UEd=ha,this.p5j())};this.Tga=()=>{this.H5d("OnThrottledUserActivity")};this.BI=()=>{this.d6d("OnDocumentHidden")};this.rC=()=>{this.H5d("OnDocumentUnhidden")};
this.$=D;if(this.g3d=this.Wfh())this.zag=[Lc.a.tOc],this.Kcd=1,this.ucd={},this.$.ea.Ah.Wwa(this.Tga),ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void je.a.resolve(Fd.O).then(ha=>{ha.P0(this.BI);ha.YW(this.rC)}):this.$.ga.qd(291,ha=>{ha.P0(this.BI);ha.YW(this.rC)})}dispose(){this.$&&(this.f3d&&this.$.qa&&0<this.Geb.count&&this.$.qa.mv(this.xj),this.g3d&&(this.d6d("Dispose"),this.$.ea.Ah.FEa(this.Tga)))}Sui(){ib.EwaSettings.Ea(199)&&this.znj();
this.g3d&&this.Anj()}rvi(){this.cNb=this.dNb;this.UEd=0;var D={};if(!this.Geb){this.Geb=new Ub.a;const ha=Qb.a.cod(this.mFj,"InitSampleMeasurement",this.$);for(const fb of ha)D[fb.pwd]=fb.baseUrl,this.Geb.add(fb)}D=Sys.Serialization.JavaScriptSerializer.serialize(D);ba.ULS.sendTraceTag(537155210,0,50,`Init Network measurement: numberOfRequestToWaitPerNetworkMeasurement: ${this.dNb}, numberOfRequestFromTheLastNetworkMeasurement: ${this.cNb}, testParams: ${D} `);0<this.Geb.count&&this.$.qa.St(this.xj)}p5j(){for(let D of this.Geb)D.runTest()}H5d(D){this.GYa&&
this.GYa.Po||(ba.ULS.sendTraceTag(537155208,0,50,`NetworkMeasurement.StartConnectionSpeedTest: starting ping tests. caller: ${D}`),this.GYa=W.a.instance.CF(this.NMj,5E3,ed.a.l3j),this.GYa.oQ())}d6d(D){this.GYa&&this.GYa.Po&&(ba.ULS.sendTraceTag(537155207,0,50,`NetworkMeasurement.StopConnectionSpeedTest: stopping ping tests. caller: ${D}`),this.GYa.cancel())}VXj(D){return this.cNb>=this.dNb&&D-this.UEd>this.pJd}Wfh(){return Ba.nag(this.$.xa.SlowNetworkMeasurementsSamplePercentage)}znj(){this.dNb=this.$.xa.NumberOfRequestToWaitPerNetworkMeasurement;
this.pJd=1E3*this.$.xa.MinTimeBetweenNetworkMeasurementInSec;const D=this.$.xa.NetworkMeasurementsSamplePercentage;0<this.dNb&&0<this.pJd&&(this.f3d=Ba.nag(D))&&this.rvi()}Anj(){if(!this.JIc){this.JIc=new Ub.a;const D=Qb.a.cod(this.BEj,"PrepareAndInitSlowNetworkTests.ConnectionSpeedTest",this.$,[Lc.a.tOc]);for(const ha of D)this.JIc.add(ha);this.$.ea.Ah.us&&this.H5d("PrepareAndInitSlowNetworkTests")}}static nag(D){return 100*Math.random()<D}}Object(da.a)(Ba,"NetworkMeasurement",null,[5]);var qa=a(38),
gb=a(148),Bb=a(836);class ic{constructor(D){this._count=0;this.sessionID=this.allOfflinePartialInteractivitiesDataInSession=null;this.allOfflinePartialInteractivitiesDataInSession=[];this.sessionID=D}get count(){return this._count}get EX(){return this.allOfflinePartialInteractivitiesDataInSession[this.allOfflinePartialInteractivitiesDataInSession.length-1]}ohk(){this.EX&&this.EX.lfg()}vWg(D){this.allOfflinePartialInteractivitiesDataInSession.push(D);this._count++}}Object(da.a)(ic,"OfflinePartialInteractivitiesDataForLog",
null,[]);class Cc extends Xd{constructor(D,ha,fb){super(D,ha,fb);this.timeFromLastOffline=0;this._errorDataDuringOfflineMode=null;this.timeFromLastOffline=-1;this.type=5}ZTj(D){this.timeFromLastOffline=D}wQj(D){this._errorDataDuringOfflineMode=D}}Object(da.a)(Cc,"OfflinePartialInteractivityData",Xd,[]);class hd{constructor(D,ha){this.eUa=this.EX=null;this.KRd=-1;this.hCb=null;this.uAf=ka.Task.delay(0);this.Cfb=(fb,Vb)=>{Vb.JS?this.Sbj(Vb.ata):this.Tbj()};this.Uga=(fb,Vb)=>{5===Vb.uXf&&this.Y8a()};
this.zbg=(fb,Vb)=>{this.EX.wQj(Vb.PH)};this.Y8a=()=>{this.eUa.ohk();this.nKj(hd.JPd,Sys.Serialization.JavaScriptSerializer.serialize(this.eUa))};this.cFj=fb=>{if(fb=fb.result)this.Wyg=!0,ba.ULS.sendTraceTag(576811915,0,50,`OfflineModeTelemetryManager.ReportOfflinePartialInteractivityDataFromIDB: Previous session's offline partial interactivy data: ${fb}`)};this.ezj=()=>{this.Wyg&&(this.$?qa.TaskExtensions.za(this.indexedDB.Jgd(hd.JPd),()=>{ba.ULS.sendTraceTag(537155204,0,50,"OfflineModeTelemetryManager.RemoveDataFromIDB: Previous session's offline partial interactivy data successfuly removed from IDB.")},
this.$.ka):ba.ULS.sendTraceTag(537155203,0,10,"OfflineModeTelemetryManager.RemoveDataFromIDB: EwaControl is null when attempting to remove offline mode data stored in IDB."))};this.jUa=()=>{if(this.eUa&&0<this.eUa.count){const fb=Sys.Serialization.JavaScriptSerializer.serialize(this.eUa);ba.ULS.sendTraceTag(560791644,0,50,`OfflineModeTelemetryManager.OnBeforeUnload: This session's offline partial interactivy data: ${fb}`)}};this.$=D;this.indexedDB=ha;this.Wyg=!1;this.indexedDB.Vh()&&(this.indexedDB.initialize(hd.uGb,
hd.vGb),this.vEj(),this.eUa=new ic(this.$.xa.UserSessionId),Ld.a(this.$).ti.E5c(this.Cfb));this.Wo=gb.a.instance.UM();this.Wo.la("beforeunload",this.jUa)}dispose(){this.$&&Ld.a(this.$)&&Ld.a(this.$).ti.$Vd(this.Cfb);oc.a.Ma(this.hCb);this.$=this.hCb=null}Sbj(D){this.EX=new Cc(Hc.a.$b.ke,this.$,0!==D);this.EX.ZTj(-1!==this.KRd?window.performance.now()-this.KRd:-1);this.eUa.vWg(this.EX);Ld.a(this.$).ti.K5c(this.Uga);this.Y8a();this.hCb=W.a.instance.CF(this.Y8a,hd.lXh,ed.a.Y8a);jf.a(this.$).n5c(this.zbg)}Tbj(){this.EX.RNd(this.$);
this.Y8a();oc.a.Ma(this.hCb);this.hCb=null;this.KRd=window.performance.now();Ld.a(this.$).ti.vDc(this.Uga);jf.a(this.$).IVd(this.zbg);this.CEj()}nKj(D,ha){this.$?this.uAf=qa.TaskExtensions.za(this.uAf,()=>{this.indexedDB.mXa(new Bb.a(D,ha))},this.$.ka):ba.ULS.sendTraceTag(537155205,0,15,"OfflineModeTelemetryManager.SaveToIndexedDBSequential: EwaControl is null when attempting to write to IDB")}vEj(){const D=this.$.ka;qa.TaskExtensions.za(qa.TaskExtensions.za(this.indexedDB.OPa(hd.JPd),this.cFj,D),
this.ezj,D)}CEj(){if(this.EX){const D=Sys.Serialization.JavaScriptSerializer.serialize(this.EX);ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_71qb3_Offline")?Gd.b().LTb(560791645,0,50,xd.offline,this.EX.durationMs,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",D):ba.ULS.sendTraceTag(560791645,0,50,`OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: ${D}`)}this.EX&&
this.EX.isToastShown&&Zc.Health.instance.recordQosError(tc.a.nlk,[Qc.a.$tc],!0,!1,!1,!1,null)}}hd.uGb="NetworkAvailability";hd.vGb="NetworkAvailabilityData";hd.JPd="partialInteractivityData";hd.lXh=3E3;Object(da.a)(hd,"OfflineModeTelemetryManager",null,[5]);var Pd=a(1214);const ue=D=>{D.isSuccess||(D=Sys.Serialization.JavaScriptSerializer.serialize(D),ba.ULS.sendTraceTag(509669840,0,10,D))};class Ee{constructor(D,ha){this.lqa=this.oKd=this.zKf=null;this.$=D;ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&
cb.a.vh||(this.zKf=new hd(D,ha));ib.EwaSettings.Ea(199)&&(this.oKd=new Ba(this.$),this.oKd.Sui());ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&cb.a.vh||(this.lqa=new Dc.NetworkConnectionHealthChecker(this.$));this.olh=new pe(this.$);ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.1CdnDarkTestEnabled",!1)&&(D=this.$,ha=ib.EwaSettings.getStringFeatureGate("Microsoft.Office.Excel.1CdnDarkTestTargetUrl",""),""!==ha&&(new Pd.a(D,"1CDN",ha,ue,"runOneCdnNetworkTest")).runTest())}dispose(){oc.a.Ma(this.zKf);
oc.a.Ma(this.oKd);oc.a.Ma(this.lqa);oc.a.Ma(this.olh);this.$=null}}Object(da.a)(Ee,"NetworkConnectionTelemetryManager",null,[5]);class Se extends Xd{constructor(D,ha,fb,Vb){super(D,ha,fb);this.wasInteruptedByOfflineMode=!1;this.type=Vb;this.wasInteruptedByOfflineMode=!1}Cfb(){this.wasInteruptedByOfflineMode=!0}}Object(da.a)(Se,"SilentReopenData",Xd,[]);class cf{constructor(D){this.hba=null;this.BUf=(ha,fb)=>{this.zUf(fb,3)};this.TQf=(ha,fb)=>{this.zUf(fb,2)};this.$=D;this.ti=Ld.a(this.$).ti;this.ti.oCe(this.TQf);
this.ti.I0g(this.BUf)}dispose(){this.ti.d7f(this.TQf);this.ti.dDj(this.BUf);this.hba=this.ti=this.$=null}zUf(D,ha){D.JS?this.hba=new Se(Hc.a.$b.ke,this.$,0!==D.ata,ha):(5===D.ata&&(this.hba.wasInteruptedByOfflineMode=!0),3!==D.ata&&2!==D.ata||ba.ULS.sendTraceTag(537155202,0,10,"SilentReopenPartialInteractivityTelemetryManager.OnSilentReopen: BackToWork/DuringWork partial interactivity has been swapped to DuringWork/BackToWork."),this.hba.RNd(this.$),2===ha?ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_8dtae_B2W")?
Gd.b().MTb(571289604,0,50,xd.offline,this.hba.durationMs,this.hba):ba.ULS.sendTraceTag(571289604,0,50,yd.a.He(this.hba)):ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_6w9lg_DuringWork")?Gd.b().MTb(542782150,0,50,xd.kDh,this.hba.durationMs,this.hba):ba.ULS.sendTraceTag(542782150,0,50,yd.a.He(this.hba)),this.hba=null)}}Object(da.a)(cf,"SilentReopenPartialInteractivityTelemetryManager",null,[5]);let mf=class extends qb.a{constructor(D,ha,fb){fb=void 0===fb?!0:fb;super();
this.N4=this.ecc=this.fUa=this.Osa=this.BYa=null;this.BIf=0;this.uCc=this.Thb=this.Uhb=!1;this.DIf=this.documentVisibilityObserver=null;this.nva=!1;this.kxd=this.pba=0;this.bJb=!1;this.Rlg=0;this.X2d=!1;this.Y4=null;this.DRf=()=>{ba.ULS.sendTraceTag(537155219,0,50,"NetworkConnectionStateManager.OnNetworkDownEvent: Network down.");this.Uvc(1,!1)};this.rC=()=>{this.gpa||this.qLb?window.setTimeout(()=>{this.h8d()},this.BIf):this.h8d();this.documentVisibilityObserver.DEa(this.rC);this.bJb=!1};this.wj=
()=>{ba.ULS.sendTraceTag(537155218,0,50,`NetworkConnectionStateManager.OnEditEnded: Edit ended. IsInOfflineMode:${this.qLb}, IsInDuringWorkSilentReopenMode:${this.Kuc&&!this.nva}`);this.qLb&&this.Pye();this.Kuc&&!this.nva&&this.Kye();$a.h(this.$).cellTextEditBox.$p(this.wj);this.Uhb=this.Thb=!1};this.ERf=()=>{ba.ULS.sendTraceTag(537155213,0,50,"NetworkConnectionStateManager.OnNetworkResumedEvent: network was resumed.");this.Uvc(1,!0);this.Thb&&!this.Uhb&&$a.h(this.$).cellTextEditBox.$p(this.wj);this.Thb=
!1};this.Tga=(Vb,Gc)=>{this.kxd=this.pba;this.pba=Gc.KKc};this.AUf=()=>{this.$&&(this.uCc||(Dd.a(this.$).VT($c.a.PUa).gZg(this.NRf),this.$.Zm(this.wf),this.uCc=!0),this.nva=this.tBi(),this.Uvc(2,!1))};this.NRf=()=>{var Vb=Dd.a(this.$).Yj;const Gc=Vb.D4g();Vb=Nb.f(Vb.wv.rf.errors,zd=>zd.MessageIdName);ba.ULS.sendTraceTag(545842889,0,50,`NetworkConnectionStateManager.OnOpenWebMethodErrorUserAlertExecuting: IsStateUnrecoverable:${Gc}, IsB2W:${this.nva}, Errors: ${yd.a.He(Vb)}`);Gc&&(this.BYa?(this.nva=
!1,this.EVe(),this.OLc()):this.Osa&&(this.FVe(),this.OLc()))};this.wf=()=>{this.$?(ba.ULS.sendTraceTag(541193955,0,50,"NetworkConnectionStateManager.OnWorkbookOpened: Workbook opened."),this.nva=!1,this.N4&&this.N4.Po&&(oc.a.Ma(this.N4),this.N4=null),this.Y4&&this.Y4.Po&&(oc.a.Ma(this.Y4),this.Y4=null),this.Uvc(2,!0),this.OLc()):ba.ULS.sendTraceTag(537155212,0,10,"NetworkConnectionStateManager.OnWorkbookOpened: bug monitoring: EwaControl is null.")};this.XMf=()=>{this.AHf(!0)};this.YMf=()=>{this.AHf(!1)};
this.N4b=dc.$Pi;this.Fcd=dc.connected;this.$=D;this.Ug=D.qa.Ug;fb&&(this.DIf=new Ee(D,ha));ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void je.a.resolve(Fd.O).then(Vb=>{this.documentVisibilityObserver=Vb}):this.$.ga.qd(291,Vb=>{this.documentVisibilityObserver=Vb});this.BIf=this.$.xa.ExcelNetworkCheckAfterTabActivationDelayMs;this.Ug.uCe(this.DRf);this.Ug.xub(this.ERf);this.Ug.KBe(this.XMf);this.Ug.PYg(this.YMf);new cf(this.$,this);this.cEf=
this.$.xa.LongInactivityTimePeriodSeconds;this.$.ea.Iub(this.AUf);this.$.ea.Ah.Wwa(this.Tga);this.Rlg=this.$.xa.SilentReopenDuringWorkDelayMs}get CDi(){return this.nva}get qLb(){return!(this.N4b&1)}get Kuc(){return!(this.N4b&2)}get gpa(){return!!(this.Fcd&2)}dispose(){this.Ug&&(this.Ug.i7f(this.DRf),this.Ug.DRb(this.ERf),this.Ug.F6f(this.XMf),this.Ug.OAj(this.YMf));this.bJb&&this.documentVisibilityObserver&&(this.documentVisibilityObserver.DEa(this.rC),this.bJb=!1);this.$&&(this.uCc&&this.OLc(),this.$.ea&&
(this.$.ea.zDc(this.AUf),this.$.ea.Ah&&this.$.ea.Ah.FEa(this.Tga)));this.Y4&&(this.Y4.dispose(),this.Y4=null);oc.a.Ma(this.DIf);this.$=null;super.dispose()}aGf(){this.X2d=!0}Kye(){this.Osa||(this.Osa=Ld.a(this.$).ti.FKa(3,"NetworkConnectionStateManager.ActivateDuringWorkSilentReopenPartialInteractivity"))}tBi(){if(this.X2d)return this.X2d=!1,!0;const D=this.pba>this.cEf||this.kxd>this.cEf&&10>this.pba;ba.ULS.sendTraceTag(537155223,0,50,`NetworkConnectionStateManager.IsBackToWorkSilentReopen: Inactivity duration: Time from last activity:${this.pba}, Time gap between last two activities: ${this.kxd}. return value:${D}`);
return D}qFj(){this.Y4=W.a.instance.create(()=>{Zc.Health.instance.recordQosError(tc.a.q3j,[Qc.a.$tc],!0,!0,!1,!1,null)},6E3,"ReportLongSilentReopenBackToWorkVeto",void 0,!0)}QTg(){this.Osa||this.N4?ba.ULS.sendTraceTag(542782155,0,10,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Trying to activate during-work partial interactivity when we are already in this partial interactivity or there is a running timer that's going to do it soon."):this.N4=W.a.instance.create(()=>{this.$?
this.Osa?ba.ULS.sendTraceTag(537155221,0,15,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Tried to activate SilentReopenDuringWork PI when there is already an DuringWorkSilentReopen partial interactivity object"):$a.h(this.$).ld?(this.Thb||($a.h(this.$).cellTextEditBox.Mq(this.wj),ba.ULS.sendTraceTag(541893722,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Registered OnEditEnded while during-work silent reopen")),this.Uhb=!0,ba.ULS.sendTraceTag(537155220,
0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Need to init during-work silent reopen partial interactivity but the user is during a cell edit. Registered to OnEditEnded event.")):this.Kye():ba.ULS.sendTraceTag(537155222,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: EwaControl is null")},this.Rlg,ed.a.j2j,void 0,!0)}AHf(D){this.Fcd=this.uKe(2,D,!0);this.yDe()}Uvc(D,ha){this.N4b=this.uKe(D,ha,!1);this.yDe()}uKe(D,ha,fb){fb=fb?this.Fcd:
this.N4b;return ha?fb|D:fb&~D}h8d(){const D=!!this.fUa,ha=!!this.BYa,fb=!!this.Osa,Vb=!!this.ecc;this.qLb&&!D?this.PTg():!this.qLb&&D&&this.Awh();!this.Kuc||ha||fb?this.Kuc||(ha?this.EVe():(fb||this.N4&&this.N4.Po)&&this.FVe()):this.nva?this.OTg():this.N4||this.QTg();this.gpa&&!Vb?this.Zqg(!0):!this.gpa&&Vb&&this.Zqg(!1)}PTg(){this.$?this.fUa?ba.ULS.sendTraceTag(537155215,0,15,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Tried to activate offline PI when there is already an offline partial interactivity object"):
$a.h(this.$).ld?(this.Uhb||($a.h(this.$).cellTextEditBox.Mq(this.wj),ba.ULS.sendTraceTag(537155217,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Registered OnEditEnded during offline mode")),this.Thb=!0,ba.ULS.sendTraceTag(537155216,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Turned offline while user is editing a cell, registered to OnEditEnded event.")):this.Pye():ba.ULS.sendTraceTag(537155214,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: EwaControl is null")}Pye(){this.fUa||
(this.fUa=Ld.a(this.$).ti.FKa(5,"NetworkConnecStateManager.ActivateOfflinePartialInteractivity"))}Awh(){this.fUa&&(oc.a.Ma(this.fUa),this.fUa=null)}EVe(){this.BYa&&(oc.a.Ma(this.BYa),this.BYa=null);this.Y4&&this.Y4.Po&&this.Y4.cancel();this.Y4=null}FVe(){this.Osa&&(oc.a.Ma(this.Osa),this.Osa=null);this.N4&&(oc.a.Ma(this.N4),this.N4=null);this.Uhb&&!this.Thb&&$a.h(this.$).cellTextEditBox.$p(this.wj);this.Uhb=!1}OTg(){this.BYa||(this.BYa=Ld.a(this.$).ti.FKa(2,"NetworkConnectionStateManager.ActivateLongInactivitySilentReopenPartialInteractivity",
void 0,Od.a.instance.ia(2190)));this.qFj()}Zqg(D){D?(this.ecc=Ld.a(this.$).ti.FKa(4,"NetworkConnectionStateManager.ConnectivityIssues"),this.Eqj()):(oc.a.Ma(this.ecc),this.ecc=null)}Eqj(){if(this.$&&this.$.qa){const D=this.$.qa.ua.ie();be.I(this.$.qa.ua,null,null,null,D)}}OLc(){Dd.a(this.$).VT($c.a.PUa).Gt(this.NRf);this.$.co(this.wf);this.uCc=!1}yDe(){this.documentVisibilityObserver||ba.ULS.sendTraceTag(537155211,0,15,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: Document visibility observer is null while it shouldn't be.");
this.documentVisibilityObserver&&this.documentVisibilityObserver.hj?this.bJb||(this.documentVisibilityObserver.YW(this.rC),this.bJb=!0,ba.ULS.sendTraceTag(541193954,0,50,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: tabbed out user, will update the partial interactivity state when the user will be back.")):this.h8d()}};mf=Object(Xb.a)([Object(je.d)(Fd.Qb),Object(Xb.b)(0,Object(Fd.W)()),Object(Xb.b)(1,Object(Fd.Cb)())],mf);Object(da.a)(mf,"NetworkConnectionStateManager",
qb.a,[622,5]);class ac extends Ta.a{constructor(D){super();this.$=D;this.je()}create(){void je.a.resolve(Fd.Cb,{Ja:this.Ta}).then(D=>{let ha=Object(sc.a)(this.$.ga,400,()=>new mf(this.$,D));this.Ld(ha)})}static la(D){D.ga.Qa(401,new ac(D))}}Object(da.a)(ac,"NetworkConnectionStateManagerFactory",Ta.a,[]);var bd=a(521),nd=a(1001);class se extends Ta.a{constructor(D){super();this.$=D;this.je()}create(){this.Ld(this.$.ga.Da(5)||new nd.BusinessBarManager(this.$,!this.$.O2))}static la(D){D.ga.Qa(4,new se(D))}}
Object(da.a)(se,"BusinessBarManagerFactory",Ta.a,[]);var Ge=a(155);String(nd);window.___1689695361102_closurehack=nd;var Ve=a(91),df=a(53);class pf{constructor(D){this.xYa=!0;pf.Xrf()?pf.EBi()?this.xYa=!1:pf.isf()?(ba.ULS.sendTraceTag(526434368,0,50,`LineageCatchUpExperimentManager is running in hybrid mode. TUI exhausted: ${!D}`),this.xYa=D):this.xYa=!1:this.xYa=!0}Mbb(){return!this.xYa}static isf(){return pf.Xrf()&&ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationTeachingUXTreatmentToControl",
!1)}static Xrf(){return ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationSummaryStringTreatment",!1)}static EBi(){return ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",!1)}}Object(da.a)(pf,"LineageCatchUpExperimentManager",null,[673]);class kf extends Ta.a{constructor(D){super();this.$=D;this.je()}create(){pf.isf()?qa.TaskExtensions.za(ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateLineageDiscoverabilityCallout",!1)?
Object(Ve.d)(je.a.resolve(Fd.Ib,{Ja:this.Ta})):df.GetServiceTaskFactory.ud(this.$.ga,456,457,this.Ta),D=>{qa.TaskExtensions.za(D.result.MYj(),ha=>{this.NSe(ha.result)},this.$.ka,3)},this.$.ka,3):this.NSe(!0)}NSe(D){this.Ld(this.$.ga.Da(458)||this.$.ga.Qa(458,new pf(D)))}static la(D){D.ga.Qa(459,new kf(D))}}Object(da.a)(kf,"LineageCatchUpExperimentManagerFactory",Ta.a,[]);var Af=a(6),eb=a(77),bb=a(93);class Rb{constructor(D,ha){this.qCd=!1;this.Nh=()=>{this.asg()};this.$=D;this.$.ea.Ddb&&!Rb.uFb&&
(ha&&!ha.xYa||this.fnk(),Rb.Olf?ba.ULS.sendTraceTag(537155461,0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):ha&&!ha.xYa||this.nnk());ba.ULS.sendTraceTag(537155460,0,50,"LineageTeachingCalloutTriggerManager is initialized.")}dispose(){this.hVd();this.$=null;ba.ULS.sendTraceTag(537155459,0,50,"LineageTeachingCalloutTriggerManager is disposed.")}disable(){Rb.uFb||(Rb.uFb=!0,ba.ULS.sendTraceTag(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));
this.hVd()}nnk(){this.$.isAnonymousUser()||be.i(this.$.qa.ua,D=>{this.$?(D=D.Result,ba.ULS.sendTraceTag(578557780,0,50,`CheckLineageWywaChanges service call succeeded, hasnewchanges = ${D}.`),Rb.Olf=!0,D&&this.Prg(0)):ba.ULS.sendTraceTag(537155458,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.")},()=>{ba.ULS.sendTraceTag(537155457,0,10,"CheckLineageWywaChanges service call failed.")},null,null)}fnk(){this.asg()||(this.$.ea.Mw(this.Nh),
this.qCd=!0)}asg(){return this.$.ea&&this.$.ea.pp&&this.$.ea.pp.ShouldTriggerLineageCalloutOnMerge?(ba.ULS.sendTraceTag(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),this.Prg(1),!0):!1}Prg(D){Rb.uFb?ba.ULS.sendTraceTag(537155456,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session"):(Rb.uFb=!0,ba.ULS.sendTraceTag(578557776,0,50,`LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason ${D}.`),
this.hVd(),ib.EwaSettings.Ea(418)&&(D=new bb.a(-847286761,eb.a.Bd,this.$.se,0,Af.a.d4),this.$.Ha.Ad(D,{["CalloutName"]:4})))}hVd(){this.qCd&&(this.qCd=!1,this.$.ea.ny(this.Nh))}}Rb.uFb=!1;Rb.Olf=!1;Object(da.a)(Rb,"LineageTeachingCalloutTriggerManager",null,[674,5]);class Q extends Ta.a{constructor(D){super();this.$=D;this.je()}create(){qa.TaskExtensions.za(df.GetServiceTaskFactory.ud(this.$.ga,458,459,this.Ta),D=>{const ha=D.result;D=Object(sc.a)(this.$.ga,403,()=>new Rb(this.$,ha));this.Ld(D)},
this.$.ka,3)}static la(D){D.ga.Qa(402,new Q(D))}}Object(da.a)(Q,"LineageTeachingCalloutTriggerManagerFactory",Ta.a,[]);var Ia=a(803),ub=a(427);class Yb extends Ta.a{constructor(D){super();this.$=D;this.je()}create(){const D=df.GetServiceTaskFactory.create(this.$.ga,102,this.$.ka,this.Ta),ha=Object(Ge.a)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?Object(Ve.d)(je.a.resolve(Fd.m,{Ja:this.Ta})):df.GetServiceTaskFactory.ud(this.$.ga,5,4,this.Ta),fb=df.GetServiceTaskFactory.ud(this.$.ga,388,
387,this.Ta),Vb=Object(Ve.d)(je.a.resolve(Fd.Ab,{Ja:this.Ta})),Gc=df.GetServiceTaskFactory.ud(this.$.ga,257,258,this.Ta),zd=ub.a(this.$);qa.TaskExtensions.za(qa.TaskExtensions.Wf([D,Gc,zd,ha,fb,Vb],this.ka),()=>{this.Ld(Object(sc.a)(this.$.ga,271,()=>new Ia.ConvertToLinkedEntityManager(this.$,D.result,fb.result,Gc.result,zd.result,ha.result,Vb.result)))},this.$.ka,3)}static la(D){D.ga.Qa(272,new Yb(D))}}Object(da.a)(Yb,"ConvertToLinkedEntityManagerFactory",Ta.a,[]);var Ca=a(249),tb=a(275),$b=a(30),
cd=a(260),sd=a(12),re=a(754),De=a(18);const Ye=De.a.ROh;class $e extends Ca.a{constructor(D,ha,fb){super(D);this.rB=0;this.LG=!1;this.De=()=>{this.Ik(!1)};this.$=ha;this.taskPaneManager=fb;tb.a(ha).vk(this);this.$.gk(this.De);$b.a.gg()&&(this.isVisible=!1)}I6(D){this.get_events().addHandler("EnrichmentTaskPaneRemoved",D)}waa(D){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",D)}kH(D){this.addHandler("EnrichmentTaskPaneVilibilityChanged",D)}RI(D){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",
D)}C_g(D){this.addHandler("EnrichmentTaskPaneOnFocus",D)}jCj(D){this.removeHandler("EnrichmentTaskPaneOnFocus",D)}get isVisible(){return super.isVisible}set isVisible(D){super.isVisible=D;this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}get zi(){return this.isVisible}get jg(){return cd.a.aGh}get Bl(){return 10}get Bn(){return Ye}get J2(){return this.titleText}get titleText(){return"Enrichment"}get lw(){return 300}get isResizable(){return!1}get Ce(){return this.domElement}get height(){return this.taskPaneManager.s_.offsetHeight}get DG(){return this.taskPaneManager.sPa(this.Ce,
this.titleText,this.lw,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.lw)}$u(){return this.LG}ey(){return this.LG}M$(){}dispose(){this.$&&this.$.Hn(this.De);this.taskPaneManager=this.$=null;super.dispose()}Pi(D,ha){ha||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!ha}Nj(D){return sd.DOMElementExtensions.mi(this.Ce,D)}Ll(){}lm(){}Ik(D){this.LG=D;const ha=this.taskPaneManager;this.isVisible=D;$b.a.gg()?D?this.taskPaneManager.Wga("EnrichmentTaskPane",
this.DG):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane"):(D&&0<ha.HV.length&&(!ha.Hl||10!==ha.Hl.taskPane.Bl||ha.isCollapsed)&&ha.uV(this,!0),ha.IO());D||($a.h(this.$).Pi(!0,!1),this.$.Qh())}V8(){return!1}static la(D,ha){var fb=D.Pd;let Vb=document.getElementById(fb+Af.a.f0e);Vb||(Vb=re.a("div",D.Pd+Af.a.f0e,"cui-taskpane"),$b.a.gg()||(fb=document.getElementById(fb+Af.a.t$),void 0!==fb&&null!==fb?fb.appendChild(Vb):ba.ULS.sendTraceTag(537166720,0,10,`EnrichmentTaskPane.Attach: couldn't find novTaskPaneBodyDiv. IsAppUnloading: ${D.CN}`)));
fb=D.ga;return fb.Da(257)||fb.Qa(257,new $e(Vb,D,ha))}}Object(da.a)($e,"EnrichmentTaskPane",Ca.a,[665,5,394,56]);class tf extends Ta.a{constructor(D){super();this.Sk=this.qn=null;this.$=D;this.je()}get fR(){this.qn||(this.qn=qa.TaskExtensions.za(ub.a(this.$),D=>{this.Sk=$e.la(this.$,D.result)},this.ka,3));return this.qn}create(){const D=df.GetServiceTaskFactory.create(this.$.ga,203,this.ka,this.Ta),ha=ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(Ve.d)(je.a.resolve(Fd.z,
{Ja:this.Ta})):df.GetServiceTaskFactory.create(this.$.ga,155,this.ka,this.Ta);qa.TaskExtensions.za(qa.TaskExtensions.ts(qa.TaskExtensions.Wf([D,ha],this.ka),()=>this.fR,this.ka),()=>{this.Ld(this.Sk)},this.ka,3)}dispose(){this.Sk=this.qn=this.$=null;super.dispose()}static la(D){D.ga.Qa(258,new tf(D))}}Object(da.a)(tf,"EnrichmentTaskPaneFactory",Ta.a,[]);var Jb=a(1241),yc=a(189);class Id{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=
this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(da.a)(Id,"TaskPaneGroupAppProps",null,[]);var qe=a(224);class Me{constructor(){this.type="ExcelLegacyTaskPaneWacInfraProps";this.isSharedRuntime=!1;this.feedbackTaskPaneProps=this.getContent=null}}Object(da.a)(Me,"ExcelLegacyTaskPaneWacInfraProps",null,[]);var oa=a(306),vb=a(24),Ac=a(21),jd=a(11);class Ud{constructor(D){this.width=D}}Object(da.a)(Ud,"ActiveTaskPaneData",
null,[]);class ke extends qb.a{constructor(D,ha){super();this.isVisible=!1;this.n7d=this.Fia=-1;this.tWe=40;this.KUb=[];this.Hl=this.u_=this.animationManager=this.XRc=null;this.XMd=()=>{this.L9f()};this.lKc=new Set;this.lKc.add("FieldListTaskPane");this.lKc.add("PivotTableSettingsTaskPane");this.lKc.add("SlicerSettingsTaskPane");this.vd=ha;tb.a(this.$).vk(this);this.YC=D;this.seb=this.J$g();$b.a.vl()||na.AFrameworkApplication.sa.Ra.gh||(this.YC.style.bottom=this.$.If&4?jd.HelperMethods.Qe(this.$.yia):
"0");this.Ohc={};this.KWb={};this.iee={};this.k7d=gb.a.instance.kg(this.Ce);this.k7d.la("focusin",this.XMd);this.Mxi()}get $(){return this.vd}get Tka(){return this.iee}get OP(){return this.XRc}get isCollapsed(){return!this.OP}dispose(){tb.a(this.$).gB(this);const D=this.Ohc;for(let ha in D)({key:ha,value:D[ha]}).value();this.KWb=this.iee=this.Ohc=null;this.k7d.MH();this.seb=this.YC=this.k7d=null;super.dispose()}sPa(D,ha,fb,Vb,Gc,zd,ae,He,hf,zf,vg,gh,Kh,th){hf=void 0===hf?ke.xPi:hf;zf=void 0===zf?
ke.wPi:zf;vg=void 0===vg?null:vg;gh=void 0===gh?null:gh;Kh=void 0===Kh?!1:Kh;th=void 0===th?!1:th;const Qh=Object(Rd.a)(new Me,{getContent:()=>D});Qh.isSharedRuntime=Kh;return Object(Rd.a)(new Jb.a,{hideHeader:th||!ib.EwaSettings.isChangeGateEnabled("OfficeVSO:7858326_TaskPaneReactHeader"),contentProps:Qh,title:ha,width:fb,location:2,onOpen:Gc,onClose:zd,onShow:ae,onHide:He,iconUrl:vg,iconId:gh,enableResize:Vb,minResizeWidth:hf,maxResizeWidth:zf})}Wga(D,ha){ib.EwaSettings.isChangeGateEnabled("OfficeVSO:8098320_SDXPreloadFix")&&
this.KUb.indexOf(D)&&(this.KUb[D]=!0);yc.UISurfaces.ul().then(fb=>{D in this.Tka?fb.setSelectedTaskPane(D):fb.showTaskPane(D,ha);return null})}qdc(D,ha){this.KUb[D]=!1;yc.UISurfaces.ul().then(fb=>{fb.initializeHiddenSharedRuntimeTaskPane(D,ha);const Vb=this.$.domElement;Vb.addEventListener("scroll",function zd(){0!=Vb.scrollLeft&&(Vb.scrollLeft=0,Vb.removeEventListener("scroll",zd))})})}updateTaskPane(D,ha){ib.EwaSettings.isChangeGateEnabled("OfficeVSO:8098320_SDXPreloadFix")&&this.KUb.indexOf(D)&&
!this.KUb[D]||yc.UISurfaces.ul().then(fb=>{fb.updateTaskPane(D,ha);return null})}setSelectedTaskPane(D){yc.UISurfaces.ul().then(ha=>{ha.setSelectedTaskPane(D);return null})}hideTaskPane(D){yc.UISurfaces.ul().then(ha=>{ha.hideTaskPane(D,ke.A8j);return null})}get Ce(){return this.YC}get zi(){return this.isVisible}get jg(){return cd.a.jKc}Pi(D,ha){return ha?!1:(this.Wcg(),!0)}Nj(D){return sd.DOMElementExtensions.mi(this.Ce,D)}Ll(){this.$.frame.ii.hq(this.jg)}lm(){}J$g(){const D=document.createElement(qe.a.div);
D.style.height="0px";D.style.width="0px";D.tabIndex=-1;return D}h1h(){var D=sd.DOMElementExtensions.getElementById(this.YC,"tabStripFocusZone");if(D){D=D.getElementsByTagName("button");for(let ha=0;ha<D.length;ha++)if(Boolean.parse(D[ha].getAttribute("aria-selected")))return D[ha].getAttribute("aria-controls")}return null}Ekh(D){return(D=window.getComputedStyle(D,null).getPropertyValue("transition-duration"))?parseInt(D.endsWith("ms")?parseFloat(D):1E3*parseFloat(D),10):0}Owj(){const D=document.getElementById("tabbedTaskPaneContainer");
D&&D.addEventListener("transitionend",()=>this.nMa(-1))}Mxi(){yc.UISurfaces.ul().then(D=>{let ha=new Id;ha.middleContainer=this.seb;ha.onOpen=(fb,Vb)=>{this.isVisible=!0;-1===this.Fia&&(this.Fia=this.Ekh(Vb));$b.a.vl()||(this.Tka[fb]=new Ud(sd.DOMElementExtensions.kT(sd.DOMElementExtensions.getElementById(Vb,ke.wpg))))};ha.onClose=fb=>{this.isVisible=0<D.selectors.getTabbedTaskPaneCount();ba.ULS.sendTraceTag(537014371,0,50,`Closing of ${fb} TaskPane`);if(!this.isVisible)this.I8e(),$b.a.vl()||na.AFrameworkApplication.sa.Ra.gh||
window.requestAnimationFrame(()=>{this.z8b(this.seb)});else if(!$b.a.vl()&&this.OP&&this.OP!==fb){const Vb=1<D.selectors.getTabbedTaskPaneCount()?this.Slc():0,Gc=1===D.selectors.getTabbedTaskPaneCount()?-1*this.Slc():0;this.tDe(fb,this.OP,Vb,Gc)}$b.a.vl()?this.nMa(this.Fia):(na.AFrameworkApplication.sa.Ra.gh&&0>=this.Fia&&this.nMa(this.Fia),delete this.Tka[fb]);delete this.KWb[fb]};ha.onShow=(fb,Vb)=>{null!=this.yj&&(this.yj.stop(),this.yj=null);this.XRc=fb;this.L9f();1!==Vb&&window.requestAnimationFrame(()=>
{window.setTimeout(()=>{this.kJj()},0)});$b.a.vl()?window.requestAnimationFrame(()=>{this.nMa(this.Fia)}):na.AFrameworkApplication.sa.Ra.gh&&0>=this.Fia?window.requestAnimationFrame(()=>{this.nMa(this.Fia)}):window.requestAnimationFrame(()=>{this.MKj(this.seb,this.Fia)})};ha.onHide=(fb,Vb,Gc)=>{const zd=this.h1h();zd!==fb&&(this.yj=this.$.Sd.Ze("UserAction","TaskPaneToggle"),ba.ULS.sendTraceTag(537014370,0,50,`Toggling Pane from ${fb} to ${zd}`));Gc?$b.a.vl()||this.z8b(this.seb):!$b.a.vl()&&zd&&(fb=
1===Object.keys(this.Tka).length?this.Slc():0,this.tDe(this.OP,zd,this.Slc(),fb));this.XRc=null;Gc&&1!==Vb&&this.I8e();$b.a.vl()&&window.requestAnimationFrame(()=>{this.nMa(this.Fia)})};ha.setFocusCallback=(fb,Vb)=>{Vb&&(this.KWb[fb]=Vb)};ha.onResizeStart=()=>{$b.a.vl()||this.n6c(jd.HelperMethods.Qe(0))};ha.onResizeEnd=()=>{$b.a.vl()?this.nMa():(this.z8b(this.seb),this.Tka[this.OP]=this.dtd(this.OP));ba.ULS.sendTraceTag(537014369,0,50,`Resizing of ${this.OP} TaskPane`)};D.renderTaskPaneGroups(null,
this.YC,ha);na.AFrameworkApplication.sa.Ra.gh&&!$b.a.vl()&&this.Owj();return null})}z8b(D){this.n6c(this.$.isChromeRtl?D.style.left:D.style.right)}n6c(D){ba.ULS.sendTraceTag(537014368,0,50,`Grid adjust is triggered for taskPane ${this.OP}`);this.$.fGj(D)}nMa(D){D=void 0===D?0:D;-1<D?ka.Task.delay(D+this.tWe).continueWith(()=>{this.$.lEa(oa.a.p2("ResetContentAreaMargin"))}):this.$.lEa(oa.a.p2("ResetContentAreaMargin"))}tDe(D,ha,fb,Vb){ha=ha.endsWith(ke.l7d)?ha.substring(0,ha.length-ke.l7d.length):
ha;ha=this.qjf(ha);Vb=ha+Vb;D=this.qjf(D);Vb<D&&this.n6c(jd.HelperMethods.Qe(ha+fb))}MKj(D,ha){window.setTimeout(()=>{this.z8b(D)},ha+this.tWe)}Slc(){return-1!==this.n7d?this.n7d:this.n7d=sd.DOMElementExtensions.kT(sd.DOMElementExtensions.getElementById(this.YC,"tabStripFocusZone"))}dtd(D){return sd.DOMElementExtensions.kT(sd.DOMElementExtensions.getElementById(sd.DOMElementExtensions.getElementById(this.YC,D+ke.l7d),ke.wpg))}qjf(D){if(D in this.Tka){const ha=this.Tka[D].width;return 0<ha?ha:this.dtd(D)}return D?
this.dtd(D):0}I8e(){$a.h(this.$).setFocus()}kJj(){if(this.KWb[this.OP]){const D=this.KWb[this.OP];D&&D(null,null)}else this.lKc.has(this.OP)||this.Wcg()}Wcg(){yc.UISurfaces.ul().then(D=>{1<D.selectors.getTabbedTaskPaneCount()?D.focusTabbedTaskPaneArea():(D=sd.DOMElementExtensions.getElementById(this.Ce,"AgaveTaskpaneCloseButtonId"))?D.focus():(D=sd.DOMElementExtensions.vr(this.Ce.querySelectorAll("button")))&&D.focus();return null})}L9f(){this.$.domElement.scrollLeft=0;cb.a.uSa&&window.requestAnimationFrame(()=>
{this.$.domElement.scrollLeft=0;window.setTimeout(()=>{this.$.domElement.scrollLeft=0},0)})}kH(D){this.addHandler(ke.Jmb,D)}RI(D){this.removeHandler(ke.Jmb,D)}get s_(){return this.YC}get HV(){ba.ULS.shipAssertTag(537151112,11,!1,"ReactTaskPaneManager.TaskPaneButtons should not be used with the WAC infra");return null}Eyb(D,ha,fb,Vb,Gc){let zd=D.Da(ha);zd||(zd=Ac.a(vb.a,fb,D,ha),zd.SetScriptLoadFlavor(Gc));Vb&&zd.g5c(Vb);const ae=""+ha;let He=null;const hf=()=>{zd.create();He()};this.Ohc[ae]=He=()=>
{zd.eDc(hf);delete this.Ohc[ae]};zd.O7b(hf)}initialize(){ba.ULS.shipAssertTag(537151111,11,!1,"ReactTaskPaneManager.Initialize should not be used with the WAC infra")}Bkg(){}h9(){ba.ULS.shipAssertTag(537151110,11,!1,"ReactTaskPaneManager.InsertPane should not be used with the WAC infra")}uV(){ba.ULS.shipAssertTag(537151109,11,!1,"ReactTaskPaneManager.SelectPane should not be used with the WAC infra")}fBe(){ba.ULS.shipAssertTag(537151108,11,!1,"ReactTaskPaneManager.AddTaskPane should not be used with the WAC infra")}h9f(){ba.ULS.shipAssertTag(537151107,
11,!1,"ReactTaskPaneManager.RepositionTaskpaneForCurrentMode should not be used with the WAC infra")}z$a(){ba.ULS.shipAssertTag(537151106,11,!1,"ReactTaskPaneManager.GetTaskPane should not be used with the WAC infra");return null}Iod(){ba.ULS.shipAssertTag(537151105,11,!1,"ReactTaskPaneManager.GetButtonsByTaskPaneType should not be used with the WAC infra");return null}gna(){ba.ULS.shipAssertTag(537151104,11,!1,"ReactTaskPaneManager.ExpandOrCollapsePane should not be used with the WAC infra")}IO(){ba.ULS.shipAssertTag(537151075,
11,!1,"ReactTaskPaneManager.UpdateAvailablePanes should not be used with the WAC infra")}setFocusOnToolbarFirstElement(){ba.ULS.shipAssertTag(537151070,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarFirstElement should not be used with the WAC infra")}Cfg(){ba.ULS.shipAssertTag(537151069,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarLastElement should not be used with the WAC infra")}static la(D){const ha=ke.Iah(D.Pd,D.isChromeRtl);ke.h6g(D,ha);return new ke(ha,D)}static Iah(D,ha){const fb=document.createElement("div");
fb.id=D+Af.a.kKc;$b.a.vl()?fb.classList.add(De.a.$nk):(fb.classList.add(ha?De.a.bok:De.a.aok),na.AFrameworkApplication.sa.Ra.gh&&fb.classList.add(De.a.vEa));return fb}static h6g(D,ha){D.isMobileMode&&ha.setAttribute("aria-hidden","true");if(na.AFrameworkApplication.sa.Ra.gh){let fb;(fb=document.getElementById("FarPaneRegion"))?fb.appendChild(ha):ba.ULS.shipAssertTag(509097620,11,!1,`FarPaneRegion is not found, regionComposerRoot found=${!!document.getElementById("regionComposerRoot")}`)}else ib.EwaSettings.isChangeGateEnabled("OfficeVSO:7643983_GridLayoutRemoval")||
$b.a.vl()&&ha.classList.add(De.a.zIh),document.getElementById(D.Pd+Af.a.b6a).insertBefore(ha,D.OFa)}}ke.xPi=300;ke.wPi=950;ke.A8j=2;ke.l7d="-panel";ke.wpg="ExcelTaskPaneContentWrapper";ke.Wlg="rtpSizeChanged";ke.dPe="rtpCollapsed";ke.eXf="rtpAdded";ke.Jmb="rtpVisibility";Object(da.a)(ke,"ReactTaskPaneManager",qb.a,[668,56,5]);var Pe=a(172),ze=a(13),Ue=a(250),hg=a(117),of=a(234),Gf=a(101),Wf=a(774),bg=a(566),Dg=a(56);class Gg extends Sys.EventArgs{constructor(){super()}}Object(da.a)(Gg,"TaskPaneVisibilityChangedEventArgs",
Sys.EventArgs,[]);var Rf=a(47),Eg=a(92);const vh=Wf.a.zLh,Og=Wf.a.BLh,e=`<span class='${De.a.sbc} ${Wf.a.CLh} {3}'><img class='{1}' alt='{0}' src='{2}' {4}/></span>`;class sa extends Ca.a{constructor(D){super(document.createElement("a"));this.Ua=new qb.a;this.Zd=this.Cwe=null;this.mf=()=>{this.enabled&&this.Ua.raiseEvent("tpButtonClicked",null,this);return!0};this.Zd=D}xYg(D){this.Ua.addHandler("tpButtonClicked",D)}x6f(D){this.Ua.removeHandler("tpButtonClicked",D)}get r5a(){return this.domElement}get taskPane(){return this.Cwe}get enabled(){return super.enabled}set enabled(D){D!==
super.enabled&&(this.domElement.classList.toggle(Wf.a.AX),this.domElement.classList.toggle(Og),this.domElement.tabIndex=D?0:-1,super.enabled=D)}get Ar(){return this.domElement.firstChild.firstChild}dispose(){oc.a.Fe([this.Ua]);this.Ua=null;this.domElement&&Rf.a.Hra(this.domElement);super.dispose()}Lxi(D){const ha=6===D.Bl;var fb=ha&&!D.Bn;fb=String.format(e,D.J2,D.Bn,fb?Dg.a.current.tq(100):Dg.a.Ci(10),Wf.a.Ama,fb?String.format('style="width:24px;{0}:0px"',"left"):"");this.Zd.Tj(this.domElement,fb);
this.domElement.classList.add(vh);this.domElement.classList.add(Og);this.domElement.title=D.J2;this.domElement.tabIndex=0;sd.DOMElementExtensions.Gz(this.domElement,Af.a.Ow,null,null);this.Cwe=D;ha&&(D=this.taskPane,null===D||void 0===D?void 0:D.evg());of.a.instance.ta(ze.a.click,this.domElement,this.mf);hg.KeyInputManager.instance.zx(this.domElement,this.mf,Eg.a.xk)}}Object(da.a)(sa,"TaskPaneButton",Ca.a,[706]);class Ya extends Gf.a{constructor(D,ha,fb,Vb){super(D);this.animationManager=this.a$=
this.Ih=null;this.aP=this.W_a=!1;this.rhe=0;this.vd=null;this.XVc=!1;this.Zd=null;this.vC=()=>{this.xFi||(this.IO(),this.$.Qh())};this.eMd=(Gc,zd)=>{this.onButtonClick(Gc,zd)};this.fDa=()=>{this.bMc()};this.$=ha;this.Zd=Vb;tb.a(this.$).vk(this);this.$.Ud.Ri(this.fDa);this.configuration=fb;this.baseName=jd.HelperMethods.hAa(this.domElement,this.configuration.zpg||this.configuration.t_);this.Nhc={};this.Vkb=[];this.Kw=[];this.zwb={};this.Dwe=document.getElementById(this.baseName+this.configuration.j7d);
this.s_||ba.ULS.sendTraceTag(512291722,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.j7d} not found`);this.zRg=document.getElementById(this.baseName+this.configuration.t_);this.YC||ba.ULS.sendTraceTag(512291721,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.t_} not found`);this.ARg=document.getElementById(this.baseName+this.configuration.o8d);this.u_||ba.ULS.sendTraceTag(512291720,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+
this.configuration.o8d} not found`);D=String.format(Ya.B8j,this.baseName+this.configuration.nrg,this.baseName+Ya.JWb);this.Zd.Tj(this.u_,D);this.Ffe=document.getElementById(this.baseName+Ya.JWb);this.VJe||ba.ULS.sendTraceTag(512291719,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+Ya.JWb} not found`);(this.ywb=document.getElementById(this.baseName+Ya.JWb))||ba.ULS.sendTraceTag(512291718,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+Ya.JWb} not found`);this.NGg=
this.iTe(this.configuration.bPe,this.ZOe);this.MGg=this.wSe(this.configuration.$Oe,Od.a.instance.ia(1297),this.vli,this.h6a,!0);this.OIg=this.iTe(this.configuration.U5e,this.DSh);this.NIg=this.wSe(this.configuration.S5e,Od.a.instance.ia(1296),this.wli,this.KOa,!1);sd.DOMElementExtensions.setVisible(this.KOa,!1);of.a.instance.ta(ze.a.click,this.g6a,Object(La.a)(this,this.pxc,"onCollapseIconClicked"));of.a.instance.ta(ze.a.click,this.JOa,Object(La.a)(this,this.Gxc,"onExpandIconClicked"));of.a.instance.ta(ze.a.click,
this.h6a,Object(La.a)(this,this.pxc,"onCollapseIconClicked"));of.a.instance.ta(ze.a.click,this.KOa,Object(La.a)(this,this.Gxc,"onExpandIconClicked"));hg.KeyInputManager.instance.ta(ze.a.me,this.g6a,Object(La.a)(this,this.DMf,"onCollapseIconKeyDown"));hg.KeyInputManager.instance.ta(ze.a.me,this.JOa,Object(La.a)(this,this.jOf,"onExpandIconKeyDown"))}kH(D){this.addHandler(Ya.Jmb,D);D(this,new Gg(this.isVisible,sd.DOMElementExtensions.isVisible(this.u_)))}RI(D){this.removeHandler(Ya.Jmb,D)}get u_(){return this.ARg}get Ce(){return this.u_}get zi(){return this.W_a}set zi(D){this.W_a=
D}get YC(){return this.zRg}get jg(){return cd.a.A1i}get s_(){return this.Dwe}get HV(){return this.Kw}get Hl(){return this.Ih}get OP(){return null}get Tka(){return null}get isCollapsed(){return this.aP}get Cfd(){return this.rhe}get $(){return this.vd}set $(D){this.vd=D}get VJe(){return this.Ffe}get g6a(){return this.MGg}get JOa(){return this.NIg}get h6a(){return this.NGg}get KOa(){return this.OIg}get xFi(){return this.XVc}get wli(){return this.configuration.aPe}get vli(){return this.configuration.T5e}Eyb(D,
ha,fb,Vb,Gc){let zd=D.Da(ha);zd||(zd=Ac.a(vb.a,fb,D,ha),zd.SetScriptLoadFlavor(Gc));Vb&&zd.g5c(Vb);const ae=""+ha;ae in this.Nhc||zd.h8b((zf,vg)=>{this.I$(vg)});let He=null;const hf=()=>{zd.create();He()};this.Nhc[ae]=He=()=>{zd.eDc(hf);delete this.Nhc[ae]};zd.O7b(hf)}dispose(){if(this.Kw)for(let ha=0,fb=this.Kw.length;ha<fb;ha++)this.Kw[ha].x6f(this.eMd),this.Kw[ha].dispose();const D=this.Nhc;for(let ha in D)({key:ha,value:D[ha]}).value();this.$.ea&&this.$.Ud&&this.$.Ud.uj(this.fDa);this.ywb=this.Ffe=
this.Dwe=this.Ih=this.zwb=this.Vkb=this.Kw=null;of.a.instance.Aa(ze.a.click,this.g6a,Object(La.a)(this,this.pxc,"onCollapseIconClicked"));of.a.instance.Aa(ze.a.click,this.JOa,Object(La.a)(this,this.Gxc,"onExpandIconClicked"));of.a.instance.Aa(ze.a.click,this.h6a,Object(La.a)(this,this.pxc,"onCollapseIconClicked"));of.a.instance.Aa(ze.a.click,this.KOa,Object(La.a)(this,this.Gxc,"onExpandIconClicked"));hg.KeyInputManager.instance.Aa(ze.a.me,this.g6a,Object(La.a)(this,this.DMf,"onCollapseIconKeyDown"));
hg.KeyInputManager.instance.Aa(ze.a.me,this.JOa,Object(La.a)(this,this.jOf,"onExpandIconKeyDown"));super.dispose()}Pi(D,ha){if(ha)return!1;this.Ih&&!this.isCollapsed?(D=this.Hl.taskPane,D.zi&&D.Pi(!0,!1)||sd.DOMElementExtensions.setFocus(this.Hl.r5a)):sd.DOMElementExtensions.setFocus(this.JOa);return!0}Nj(D){return this.isVisible?sd.DOMElementExtensions.mi(this.domElement,D)||sd.DOMElementExtensions.mi(this.domElement,sd.DOMElementExtensions.KDb(D)):!1}Ll(){}lm(){this.Ih&&this.Ih.taskPane.lm()}setFocusOnToolbarFirstElement(){this.isCollapsed?
sd.DOMElementExtensions.setFocus(this.JOa):sd.DOMElementExtensions.setFocus(this.g6a)}Cfg(){for(let D=this.Kw.length-1;0<=D;D--)if(this.Kw[D].isVisible){sd.DOMElementExtensions.setFocus(this.Kw[D].r5a);return}this.setFocusOnToolbarFirstElement()}z$a(D){const ha=[];for(let fb=this.Kw.length-1;0<=fb;fb--)this.Kw[fb].taskPane.Bl===D&&ha.push(this.Kw[fb].taskPane);return ha}Iod(D){const ha=[];for(let fb=0;fb<this.Kw.length;fb++)this.Kw[fb].taskPane.Bl===D&&ha.push(this.Kw[fb]);return ha}fBe(D){if(D){let ha;
const fb=Object(pb.a)(482,D);fb?(ha=new sa(this.Zd),ha.domElement.id=this.baseName+"bt_"+D.Bl.toString()+"_"+D.rh.InstanceId,this.ywb.appendChild(ha.domElement),this.zwb["6"]=ha,fb.button=ha):ha=this.zwb[D.Bl.toString()];ha.Lxi(D);ha.xYg(this.eMd);ha.isVisible=D.$u();ha.enabled=D.ey();this.Vkb.push(D);this.Kw.push(ha);Ya.AZi(D,this.s_);this.qGh(ha);this.bMc()}}uV(D,ha){let fb;for(const Vb of this.Kw)fb=Vb.taskPane,fb.Bl===D.Bl&&fb==D&&this.Iac(Vb,ha)}sPa(){ba.ULS.shipAssertTag(512291714,11,!1,"TaskPaneControl.GenerateTaskPaneData: should only be used with WAC infra.");
return null}Wga(){ba.ULS.shipAssertTag(512291713,11,!1,"TaskPaneControl.ShowTaskPane: should only be used with WAC infra.")}qdc(){ba.ULS.shipAssertTag(512291712,11,!1,"TaskPaneControl.createTaskPaneInHidden: should only be used with WAC infra.")}updateTaskPane(){ba.ULS.shipAssertTag(512291683,11,!1,"TaskPaneControl.UpdateTaskPane: should only be used with WAC infra.")}setSelectedTaskPane(){ba.ULS.shipAssertTag(512291682,11,!1,"TaskPaneControl.SetSelectedTaskPane: should only be used with WAC infra.")}hideTaskPane(){ba.ULS.shipAssertTag(512291681,
11,!1,"TaskPaneControl.HideTaskPane: should only be used with WAC infra.")}Bkg(D,ha){D?(this.XVc=!0,this.x1d(!1)):(this.XVc=!1,this.x1d(!0),ha&&(this.IO(),this.$.Qh()))}h9(D){if(!this.Vkb.includes(D)){let fb=null;fb=()=>{this.Yzj(D);D.waa(fb)};D.I6(fb);this.fBe(D);var ha=Object(pb.a)(697,D);ha&&(ha.kH(this.vC),this.vC(ha,Sys.EventArgs.Empty));if(ha=Object(pb.a)(165,D))ha.kH(this.vC),this.vC(ha,Sys.EventArgs.Empty);if(ha=Object(pb.a)(393,D))ha.kH(this.vC),this.vC(ha,Sys.EventArgs.Empty);this.raiseEvent(Ya.eXf,
null,D);this.IO()}}Iac(D,ha){if(D.taskPane.ey()&&D.taskPane.$u()){if(this.Ih){this.Ih.domElement.classList.remove(Ya.Ftb);this.Ih.taskPane.isVisible=!1;if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const fb=Object(pb.a)(482,this.Ih.taskPane);fb&&fb.Dl.rVd(fb.rh.InstanceId)}this.a$=this.Ih}this.Ih=D;this.Ih.taskPane.isVisible=!0;this.Ih.domElement.classList.add(Ya.Ftb);ha&&this.gna(!1,!1);this.rmb()}}onButtonClick(D){let ha=!1;if(this.Ih!==D){ha=!0;const fb=D.taskPane.Ce;
this.animationManager.Znj(fb);if(this.Ih){if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const Vb=Object(pb.a)(482,this.Ih.taskPane);Vb&&Vb.Dl.rVd(Vb.rh.InstanceId)}this.Ih.taskPane.isVisible=!1;this.Ih.domElement.classList.remove(Ya.Ftb)}this.a$=this.Ih;this.Ih=D;this.Ih.domElement.classList.add(Ya.Ftb);this.Ih.taskPane.isVisible=!0;this.rmb();this.animationManager.wSh(fb)}this.gna(!(this.isCollapsed||ha),!1)}rmb(){const D=this.Cfd;let ha=0;this.Ih&&(ha=this.Ih.taskPane.rB?
this.Ih.taskPane.rB:this.Ih.taskPane.lw);ha!==D&&(this.rhe=ha,this.isCollapsed||(this.animationManager&&this.Ih?this.animationManager.T8b(this.YC,D,ha,this.Hl.taskPane):this.YC.style.width=jd.HelperMethods.Qe(ha)),this.LWa(),this.raiseEvent(Ya.Wlg,null,this))}MP(D){const ha=new sa(this.Zd);ha.isVisible=!1;ha.domElement.id=this.baseName+"bt_"+D.toString();this.ywb.appendChild(ha.domElement);this.zwb[D.toString()]=ha}bMc(){if(void 0!==this.Kw&&null!==this.Kw){void 0===this.Ih||null===this.Ih||this.Ih.taskPane.ey()||
(this.Ih.domElement.classList.remove(Ya.Ftb),this.Ih.taskPane.isVisible=!1,this.Ih.taskPane.$u()&&(this.a$=this.Ih),this.Ih=null);var D=null;for(let ha=0;ha<this.Kw.length;ha++)if(this.Vkb[ha].$u()){const fb=this.Vkb[ha].ey();(this.Kw[ha].enabled=fb)&&!D&&(D=this.Kw[ha])}void 0!==this.Ih&&null!==this.Ih||!D||(void 0!==this.a$&&null!==this.a$&&this.a$.taskPane.ey()&&this.a$.taskPane.$u()?this.Iac(this.a$,!1):this.Iac(D,!1));void 0!==bg.a(this.$)&&null!==bg.a(this.$)&&bg.a(this.$).isVisible&&void 0!==
this.Ih&&null!==this.Ih&&1!==this.Ih.taskPane.Bl&&(bg.a(this.$).isVisible=!1);void 0!==this.Ih&&null!==this.Ih&&7!==this.Ih.taskPane.Bl&&(D=this.$.ga.Da(52),null===D||void 0===D?0:D.isVisible)&&(D.isVisible=!1);ib.EwaSettings.Ea(264)&&void 0!==this.Ih&&null!==this.Ih&&12!==this.Ih.taskPane.Bl&&(D=this.$.ga.Da(302))&&(D.isVisible=!1);ib.EwaSettings.Ea(418)&&void 0!==this.Ih&&null!==this.Ih&&15!==this.Ih.taskPane.Bl&&(D=this.$.ga.Da(365))&&(D.isVisible=!1);$b.a.eEd(this.$)&&void 0!==this.Ih&&null!==
this.Ih&&13!==this.Ih.taskPane.Bl&&(D=this.$.ga.Da(334))&&(D.isVisible=!1);void 0!==this.Ih&&null!==this.Ih&&14!==this.Ih.taskPane.Bl&&(D=this.$.ga.Da(346))&&(D.isVisible=!1);void 0!==this.Ih&&null!==this.Ih&&16!==this.Ih.taskPane.Bl&&(D=this.$.ga.Da(371))&&(D.isVisible=!1);void 0!==this.Ih&&null!==this.Ih&&17!==this.Ih.taskPane.Bl&&(D=this.$.ga.Da(408))&&(D.isVisible=!1);this.rmb()}}$Uh(D,ha){sd.DOMElementExtensions.setVisible(this.h6a,!D);sd.DOMElementExtensions.setVisible(this.KOa,D);D&&this.raiseEvent(Ya.dPe,
null,this);this.rmb();ha&&sd.DOMElementExtensions.setFocus(D?this.JOa:this.g6a)}Kmc(D,ha){this.$.Me(D,ha,26,null)}I$(D){D.CR&&this.h9(D.CR)}Yzj(D){if(D){const ha=this.Kw.length;let fb=!1;for(let Vb=0;Vb<ha;Vb++){const Gc=this.Kw[Vb];if(Gc.taskPane===D){this.ywb.removeChild(Gc.r5a);delete this.zwb[D.Bl.toString()];Array.remove(this.Vkb,D);Array.remove(this.Kw,Gc);Gc.x6f(this.eMd);Gc.taskPane.Ce.parentNode.removeChild(Gc.taskPane.Ce);this.Ih&&this.Ih.taskPane===Gc.taskPane&&(this.Ih=null);this.a$&&
this.a$.taskPane===Gc.taskPane&&(this.a$=null);fb=!0;break}}fb&&this.bMc()}}qGh(D){const ha=D.taskPane.Bl,fb=!!this.Ih&&1===this.Ih.taskPane.Bl;(1===ha||!fb&&2===ha)&&this.Iac(D,!1)}static AZi(D,ha){const fb=D.Ce;fb.parentNode&&fb.parentNode.removeChild(fb);ha.appendChild(fb);D.isVisible=!1}wSe(D,ha,fb,Vb,Gc){const zd=document.createElement("a");zd.setAttribute(Af.a.X0,Gc?Af.a.Hm:Af.a.Ov);zd.setAttribute(Af.a.Mf,Af.a.Ow);zd.tabIndex=0;zd.classList.add(De.a.hK);zd.classList.add(D);zd.classList.add(Wf.a.yLh);
D=String.format(Ya.ugh,ha,fb,Dg.a.Ci(10));this.Zd.Tj(zd,D);Vb.appendChild(zd);return zd}}Ya.Jmb="tpVisibility";Ya.B8j=`<div id='{0}' class='${Wf.a.ELh}'><div id='{1}' class='${Wf.a.DLh}'></div></div>`;Ya.ugh="<img title='{0}' class='{1}' alt='{0}' src='{2}'/>";Ya.JWb="novTaskpaneButtonGroup";Ya.Ftb=Wf.a.ALh;Ya.Wlg="tpSizeChanged";Ya.dPe="tpCollapsed";Ya.eXf="tpAdded";Object(da.a)(Ya,"TaskPaneControl",Gf.a,[668,56,5]);var Fb=a(51),pc=a(460),Uc=a(750);class Sc{constructor(){this.T5e=this.aPe=this.S5e=
this.$Oe=this.U5e=this.bPe=this.nrg=this.o8d=this.j7d=this.t_=this.zpg=null}}Object(da.a)(Sc,"Configuration",null,[]);a(441);var Nd=a(309);class ne extends Nd.a{constructor(D){super(5,D)}}Object(da.a)(ne,"ResizeAnimationEvent",Nd.a,[]);var ye=a(482),bf=a(603),uf=a(104);class Qf{constructor(D,ha){this.Bpg=null;this.$=ha;this.taskPane=D}lSh(){this.Bpg=sd.DOMElementExtensions.getElementById(this.taskPane.parentNode,this.$.Pd+Af.a.hLd);const D=Qf.bfd(this.taskPane),ha=Qf.bfd(this.Bpg),fb=bf.a(uf.a.Xn);
fb.animate(D,Af.a.kHc);fb.animate(ha,Af.a.kHc)}Znj(D){D.style.opacity="0"}wSh(D){bf.a(uf.a.Xn).animate(Qf.bfd(D),Af.a.kHc)}T8b(D,ha,fb,Vb){ha||(Vb.isVisible=!0);this.$.LWa(fb);bf.a(uf.a.Xn).animate(Qf.wth(D,ha,fb),Af.a.kHc,null,null,()=>{this.$.LEa();fb||1===Vb.Bl||(Vb.isVisible=!1);Vb.M$(fb<ha)})}static wth(D,ha,fb){D=new ne(D);D.W2g(ha,fb);return D}static bfd(D){D=new ye.a(D);D.rP(0,1);return D}}Object(da.a)(Qf,"TaskPaneAnimationManager",null,[685]);const Yf=`<div id="{0}" class="${Wf.a.ILh}" runat="server"></div></div><div id="{1}" class="${Wf.a.HLh} ${Wf.a.Uy}" runat="server"></div>`,
Of=`<button type="button" id="{0}" class="${Wf.a.FLh}"></button><span><div id="{1}" class="${Wf.a.GLh}"></div></span>`,eg=Wf.a.sLh;class gf extends Ya{constructor(D,ha,fb,Vb){super(D,fb,gf.qph(),Vb);this.Rzc=null;this.yDd=!1;this.GV=null;this.fcj=Gc=>{var zd=!1;if(9===Gc.Ba.keyCode){zd=this.Hl.taskPane.V8(Gc,this.u_);if(!zd){zd=this.$.ga.Da(52);var ae=this.domElement.querySelectorAll(this.Hl.taskPane===zd?zd.Uu:pc.a.Vij);zd=sd.DOMElementExtensions.vr(ae);ae=sd.DOMElementExtensions.aQ(ae);zd=sd.DOMElementExtensions.oFa(Gc.Ba,
zd,ae)}return zd}ae=ra.FocusManager.instance().hk;if(null===ae||void 0===ae?0:ae.FU)return zd;27===Gc.Ba.keyCode&&this.Hl.taskPane.Ik(!1);return zd};this.wf=()=>{this.u_.style.bottom=this.YC.style.bottom=this.$.If&4&&!na.AFrameworkApplication.sa.Ra.gh?jd.HelperMethods.Qe(this.$.yia):"0";this.IO()};this.ZSf=Gc=>{Object(U.a)(482,this.Hl.taskPane)&&(this.Hl.taskPane.nLa.firstChild.style[Af.a.pointerEvents]="none");this.yDd=!0;this.GV=this.YDb(Gc.clientPoint);Pe.a.instance.ta(ze.a.Ki,this.domElement.ownerDocument.body,
this.Hyc);Pe.a.instance.ta(ze.a.sg,this.domElement.ownerDocument.body,this.Iyc);Ue.a.instance.ta(ze.a.Fn,this.domElement.ownerDocument.body,this.Hyc);Ue.a.instance.ta(ze.a.Gi,this.domElement.ownerDocument.body,this.Iyc);return!0};this.Iyc=()=>{Object(U.a)(482,this.Hl.taskPane)&&(this.Hl.taskPane.nLa.firstChild.style[Af.a.pointerEvents]="");this.yDd=!1;Pe.a.instance.Aa(ze.a.Ki,this.domElement.ownerDocument.body,this.Hyc);Pe.a.instance.Aa(ze.a.sg,this.domElement.ownerDocument.body,this.Iyc);Ue.a.instance.Aa(ze.a.Fn,
this.domElement.ownerDocument.body,this.Hyc);Ue.a.instance.Aa(ze.a.Gi,this.domElement.ownerDocument.body,this.Iyc);return!0};this.Hyc=Gc=>{this.yDd&&(Gc=this.YDb(Gc.clientPoint),Gc=Uc.a.SL(Gc,this.GV),this.vEe(Gc.x));return!0};this.ndj=Gc=>{void 0!==Gc.Ba&&null!==Gc.Ba&&(9===Gc.Ba.keyCode?Gc.Ba.shiftKey?(Gc=Object(U.a)(56,this.Hl.taskPane)?this.Hl.taskPane:null)&&Gc.Pi(!1,!1):this.setFocusOnToolbarFirstElement():37!==Gc.Ba.keyCode&&39!==Gc.Ba.keyCode||this.vEe(37===Gc.Ba.keyCode?-20:20));return!0};
this.$.domElement.classList.add(eg);this.xpg=ha;this.initialize();hg.KeyInputManager.instance.ta(ze.a.me,this.domElement,this.fcj);this.LWb=sd.DOMElementExtensions.getElementById(ha.parentNode,this.$.Pd+Af.a.Jwc);this.nKc=sd.DOMElementExtensions.getElementById(ha.parentNode,this.$.Pd+Af.a.EJf);this.LWb.title=Od.a.instance.ia(2233);Pe.a.instance.ta(ze.a.Bh,this.nKc,this.ZSf);Ue.a.instance.ta(ze.a.pointerDown,this.nKc,this.ZSf);hg.KeyInputManager.instance.ta(ze.a.me,this.LWb,this.ndj)}get jg(){return cd.a.jKc}get ZOe(){return this.u_}get DSh(){return this.ZOe}rmb(){super.rmb();
this.LWb&&(this.Hl&&this.Hl.taskPane.isResizable?(this.LWb.style.display="block",this.nKc.style.display="block"):(this.LWb.style.display="none",this.nKc.style.display="none"))}get aLc(){const D=this.u_;return D&&sd.DOMElementExtensions.isVisible(D)?pc.a.aLc:0}h9f(D){D&&(this.animationManager=D);this.xFj();this.animationManager=D||new Qf(this.YC,this.$);this.animationManager.lSh()}dispose(){this.Rzc&&this.Rzc.RI(this.vC);bg.a(this.$)&&bg.a(this.$).RI(this.vC);const D=this.$.ga.Da(52);D&&D.RI(this.vC);
this.$.co(this.wf);oc.a.Fe([this.Rzc]);this.Rzc=null;super.dispose()}initialize(){this.h9f(null);this.MP(0);this.MP(1);this.MP(2);this.MP(7);this.MP(8);this.MP(9);this.MP(10);this.MP(17);ib.EwaSettings.Ea(264)&&this.MP(12);ib.EwaSettings.Ea(418)&&this.MP(15);ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4458651_ExternalLinksEnableDisableRibbonButtonDuringSession")?this.MP(13):$b.a.eEd(this.$)&&this.MP(13);this.MP(14);this.MP(16);ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",
!1)&&this.MP(18);this.IO()}IO(){var D=0;let ha=0;for(let fb=this.HV.length-1;0<=fb;fb--){const Vb=this.HV[fb].taskPane.$u(),Gc=this.HV[fb].taskPane;if(this.HV[fb].isVisible=Vb)ha++,(1!==Gc.Bl&&(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4465901_HideCommentsTaskPaneButtonOnClosePane")||7!==Gc.Bl)&&14!==Gc.Bl&&16!==Gc.Bl||Gc.ey())&&D++}D=0<D;sd.DOMElementExtensions.setVisible(this.u_,D);this.x1d(D);sd.DOMElementExtensions.setVisible(this.KOa,D&&this.isCollapsed);sd.DOMElementExtensions.setVisible(this.h6a,
D&&!this.isCollapsed);sd.DOMElementExtensions.setVisible(this.VJe,1<ha);this.bMc()}gna(D,ha){if(this.isCollapsed!==D){D||(this.xpg.style.display=na.AFrameworkApplication.sa.Ra.gh?"flex":"block");var fb=this.Cfd;this.aP=!this.isCollapsed;var Vb=D?fb:0;fb=D?0:fb;this.Hl&&(this.animationManager.T8b(this.YC,Vb,fb,this.Hl.taskPane),this.LWa());D&&(this.xpg.style.display="none");this.$Uh(D,ha)}}x1d(D){const ha=this.isVisible!==D;this.zi=D;sd.DOMElementExtensions.setVisible(this.domElement,D);ha&&(na.AFrameworkApplication.sa.Ra.gh&&
sd.DOMElementExtensions.toggleCssClass(this.domElement,Wf.a.fLh,D),this.LWa(),this.raiseEvent(Ya.Jmb,new Gg(D,D),this))}pxc(D){if(D.$d===this.h6a&&3!==D.Gd)return!1;this.Kmc(296943390,D.Gd);this.gna(!0,!0);return!0}Gxc(D){if(D.$d===this.KOa&&3!==D.Gd)return!1;this.Kmc(-625072140,D.Gd);this.gna(!1,!0);return!0}DMf(D){return 13===D.Ba.keyCode?(this.Kmc(296943390,D.Gd),this.gna(!0,!0),!0):!1}jOf(D){return 13===D.Ba.keyCode?(this.Kmc(-625072140,D.Gd),this.gna(!1,!0),!0):!1}LWa(){let D=0;this.$.If&262144&&
(D+=this.aLc,sd.DOMElementExtensions.isVisible(this.YC)&&!this.isCollapsed&&(D+=this.Cfd));this.$.LWa(D)}iTe(D,ha){const fb=document.createElement("div");fb.classList.add(D);ha.insertBefore(fb,ha.firstChild);return fb}xFj(){const D=this.domElement;let ha=document.getElementById(this.$.Pd+Af.a.b6a);na.AFrameworkApplication.sa.Ra.gh&&(ha=document.getElementById("FarPaneRegion"));D.parentNode&&D.parentNode!==ha&&D.parentNode.removeChild(D);ha.appendChild(D);this.xpi()}xpi(){const D=this.YC,ha=this.u_,
fb=this.$.ea;D.style.right="0";na.AFrameworkApplication.sa.Ra.gh||(D.style.marginRight=jd.HelperMethods.Qe(pc.a.aLc));D.style.bottom=this.$.If&4&&!na.AFrameworkApplication.sa.Ra.gh?jd.HelperMethods.Qe(this.$.yia):"0";this.s_.style.bottom="0";ha.style.right="0";this.$.Zm(this.wf);fb.YK&&this.wf(null,null)}YDb(D){const ha=new Fb.a(0,0);return Uc.a.ty(ha,this.YC,D,!1)}vEe(D){const ha=this.YC.offsetWidth;D=ha-D;D<this.Hl.taskPane.lw?D=this.Hl.taskPane.lw:950<D&&(D=950);this.Hl.taskPane.rB=D;const fb=
new Qf(this.YC,this.$);fb.T8b(this.YC,ha,D,this.Hl.taskPane);Object(U.a)(482,this.Hl.taskPane)||fb.T8b(this.Hl.taskPane.Ce,ha,D,this.Hl.taskPane);this.$.LWa(this.u_.offsetWidth+D);this.$.lEa(oa.a.p2("AnimateTaskpaneResize"))}static la(D,ha){let fb=null;D.Sd&&(fb=D.Sd.fi("ComponentAttach","AttachTaskPanePickerControl"),fb.start());const Vb=gf.Kah(D.Pd),Gc=gf.Jah(D.Pd,ha),zd=gf.Lah(D.Pd);Vb.appendChild(zd);Vb.appendChild(Gc);gf.i6g(D,Vb);D=new gf(Vb,Gc,D,ha);fb&&fb.stop();return D}static Kah(D){const ha=
document.createElement("div");ha.id=D+Af.a.kKc;return ha}static Jah(D,ha){const fb=document.createElement("div");fb.id=D+Af.a.DJf;fb.className=Wf.a.tLh;let Vb=String.format(Yf,D+Af.a.y1i,D+Af.a.t$);Vb+=String.format(Of,D+Af.a.Jwc,D+Af.a.EJf);ha.Tj(fb,Vb);na.AFrameworkApplication.sa.Ra.gh&&sd.DOMElementExtensions.toggleCssClass(fb,Wf.a.vEa,!0);return fb}static Lah(D){const ha=document.createElement("div");ha.id=D+Af.a.hLd;ha.className=Wf.a.qNh;ha.style.zIndex="100";na.AFrameworkApplication.sa.Ra.gh&&
sd.DOMElementExtensions.toggleCssClass(ha,Wf.a.vEa,!0);return ha}static i6g(D,ha){(na.AFrameworkApplication.sa.Ra.gh?document.getElementById("FarPaneRegion"):document.getElementById(D.Pd+Af.a.b6a)).appendChild(ha)}static qph(){const D=new Sc;D.zpg=Af.a.kKc;D.t_=Af.a.DJf;D.j7d=Af.a.t$;D.o8d=Af.a.hLd;D.nrg=Af.a.z1i;D.bPe=Wf.a.vLh;D.U5e=Wf.a.xLh;D.$Oe=Wf.a.uLh;D.S5e=Wf.a.wLh;D.aPe=Wf.a.v4e;D.T5e=Wf.a.w4e;return D}}Object(da.a)(gf,"TaskPanePickerControl",Ya,[]);class Vg extends Ta.a{constructor(D){super();
this.$=D;this.je()}create(){if($b.a.gg())this.o4f(()=>ke.la(this.$));else{const D=Object(Ve.d)(je.a.resolve(Fd.Ab,{Ja:this.Ta}));qa.TaskExtensions.za(D,()=>{this.o4f(()=>gf.la(this.$,D.result))},this.ka,3)}}static la(D){D.ga.Qa(50,new Vg(D))}o4f(D){D=Object(sc.a)(this.$.ga,183,D);this.Ld(D)}}Object(da.a)(Vg,"TaskPaneManagerFactory",Ta.a,[]);let Jh=class extends qb.a{constructor(){super()}W8d(D,ha){ba.ULS.sendTraceTag(537154185,0,50,`ProactiveSuggestionManager.TriggerProactiveSuggestion: proactive suggestion was triggered. Range: ${D}, TriggerType: ${ha}`);
if(ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1))switch(ha){case 0:this.raiseEvent("pssort",void 0,D);break;case 1:this.raiseEvent("psfilter",void 0,D);break;case 2:this.raiseEvent("pscrttbl",void 0,D)}}};Jh=Object(Xb.a)([Object(je.d)(Fd.qc)],Jh);Object(da.a)(Jh,"ProactiveSuggestionManager",qb.a,[625]);class Nh extends Ta.a{constructor(D){super();this.$=D;this.je()}create(){let D=Object(sc.a)(this.$.ga,476,()=>new Jh);this.Ld(D)}static la(D){D.ga.Qa(475,
new Nh(D))}}Object(da.a)(Nh,"ProactiveSuggestionManagerFactory",Ta.a,[]);var Qg=a(562),bh=a(152);class Yg{constructor(D,ha,fb){this.h4d=this.i4d=this.j4d=!1;this.w4d=!D&&!ha;this.x4d=!D&&!fb;this.w4d||this.x4d||(this.j4d=!D,this.i4d=!ha,this.h4d=!fb)}}Object(da.a)(Yg,"RenameDisabledDialogInfo",null,[]);class kh extends bh.StandardDialog{constructor(D,ha,fb,Vb,Gc){super();this.z7d=[];this.T5=new Yg(D,ha,fb);this.wwa=Vb;this.qva=Gc;this.ug="RenameDisabledDialog";this.Rd=0;this.qe(1,CommonUIStrings.l_DialogClose);
this.YTj();this.GDj()}YTj(){this.T5.w4d?this.FVb(this.wwa?this.qva?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.T5.x4d?this.FVb(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.TVg();this.Xka(this.z7d)}FVb(D){Array.add(this.z7d,D)}TVg(){const D=[];this.T5.j4d||Array.add(D,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.T5.i4d||Array.add(D,CommonUIStrings.l_RenameFileRenameDisabledPermission);
this.T5.h4d||Array.add(D,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<D.length&&Array.add(this.z7d,D)}}Object(da.a)(kh,"ReactRenameDisabledDialogBase",bh.StandardDialog,[]);class qh extends kh{constructor(D,ha,fb,Vb,Gc){super(D,ha,fb,Vb,Gc)}GDj(){this.cMb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(da.a)(qh,"ReactRenameDisabledDialog",kh,[]);var nh=a(151);class Zg{static get di(){return nh.a.sq(Zg.vn,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,
CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}Zg.vn="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(da.a)(Zg,"RenameDisabledDialogHtml",null,[]);class Rg extends nh.a{constructor(D,ha,fb,Vb,Gc){super();this.T5=new Yg(D,ha,fb);this.wwa=Vb;this.qva=Gc;this.ug="RenameDisabledDialog";this.Rd=0;this.qe(1,CommonUIStrings.l_DialogClose);this.di=Zg.di;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.h_("RenameRow")}qfb(){if(this.T5.w4d){let D;D=this.wwa?this.qva?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;Rg.FVb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),D)}else this.T5.x4d?Rg.FVb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.Zri()}Zri(){this.T5.j4d&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.T5.i4d&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.T5.h4d&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static FVb(D,ha,fb){D.style.display="none";ha.innerText=fb}}Object(da.a)(Rg,"RenameDisabledDialog",nh.a,[]);class Eh{constructor(D,ha){this.oJa=0;this.Na=D;this.aca=ha}initialize(D){if(!this.Na||!this.aca)return!1;this.oJa=D;this.tj();return!0}tj(){this.Na.ae(Za.a.mma,Sa.a.frame,Object(La.a)(this,this.mma,"commitNewDocumentTitle"))}mma(D,ha,fb,Vb,Gc){if(1===fb)return this.Na.processAction(Za.a.renameFile,
1);D=Ua.a.ds(this.aca.Ip);Gc=(0,Gc.getNewDocumentTitle)();Gc.length>this.oJa&&(Gc=Gc.substr(0,this.oJa));if(32!==this.Na.eg(Za.a.renameFile,2,Gc))return this.E_(D),8;this.E_(Gc);return 32}E_(D){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(D))}static Vqd(){return new Eh(na.AFrameworkApplication.Dd,na.AFrameworkApplication.Lo)}}Object(da.a)(Eh,"ReactRenameUIHandler",null,[704]);var hh=a(98),ch=a(531),qg=a(564),zg=a(95),wh=a(41);class Ag{constructor(D,ha,fb,Vb,Gc,zd,ae,He,hf,zf,vg,gh){this._initialized=
!1;this._element=null;this.oJa=0;this.C0c=this.UUc=!1;this.Na=D;this.jQc=ha;this.Hg=fb;this.nD=Vb;this.aca=Gc;this.que=zd;this.F4b=ae;this.eRc=He;this.oca=hf;this.Nme=zf;this.k1a=vg;this.PVc=gh}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(D,ha,fb){if(!(this.Na&&this.aca&&this.que&&this.F4b&&this.eRc&&ha)||0>=D)return!1;this._element=ha;this._element.title=fb;this._element.setAttribute(zg.a.Mf,zg.a.Ow);this._element.setAttribute("Unselectable","on");this.oJa=
D;this.uw();return this._initialized=!0}uw(){this.jQc&&(this.jQc.ta(ze.a.blur,this._element,Object(La.a)(this,this.onBlur,"onBlur")),this.jQc.ta(ze.a.paste,this._element,Object(La.a)(this,this.onPaste,"onPaste")));this.Hg.ta(ze.a.me,this._element,Object(La.a)(this,this.onKeyDown,"onKeyDown"));this.nD.ta(ze.a.pointerDown,this._element,Object(La.a)(this,this.onPointerDown,"onPointerDown"));this.nD.ta(ze.a.Gi,this._element,Object(La.a)(this,this.Yi,"onPointerUp"))}onBlur(){this.isActive&&!this.UUc&&
(this.Nme||this.eRc(this._element),this.NPe(),this.mgd(!1));return this.UUc=!1}onPaste(){ba.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(D){return this.isActive?this.paj(D):this.qaj(D)}paj(D){let ha=!1;switch(D.Ba.keyCode){case Sys.UI.Key.enter:this.NPe();this.mgd(this.k1a||this.PVc);ha=!0;break;case Sys.UI.Key.tab:this.Nme&&this.eRc(this._element);break;case Sys.UI.Key.esc:this.jYd(),this.mgd(this.k1a||this.PVc),ha=!0}return ha}qaj(D){let ha=!1;
switch(D.Ba.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.jsg(this.PVc),this.isActive&&this.F4b(this._element),ha=!0}return ha}onPointerDown(){this.isActive||(this.jsg(!1),this.isActive&&(this._element.focus(),this.F4b(this._element),this.C0c=!0));return!1}Yi(){return this.C0c?(this.F4b(this._element),this.C0c=!1,!0):!1}mcb(){return 32===this.Na.processAction(Za.a.renameFile,1)}NPe(){const D=Ua.a.ds(this.aca.Ip);let ha=this._element.innerText.trim();ha.length>this.oJa&&(ha=ha.substr(0,
this.oJa));ha!==D&&""!==ha?32!==this.Na.eg(Za.a.renameFile,2,ha)?this.jYd():this.E_(ha):this.jYd()}jYd(){this.E_(Ua.a.ds(this.aca.Ip))}E_(D){this._initialized&&(this._element.innerText=D,this.que())}jsg(D){this.mcb()?this.isActive||(D&&(this.UUc=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(zg.a.Mf,zg.a.H7c),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,hh.CuiHelper.JZe),
this.oca&&this.oca.execute(ha=>{ha.M1f(!0)}),D&&this._element.focus(),ba.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.Na.processAction(Za.a.okb,2)}mgd(D){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(zg.a.Mf,zg.a.Ow);Sys.UI.DomElement.removeCssClass(this._element,hh.CuiHelper.JZe);this.oca&&this.oca.execute(ha=>{ha.M1f(!1)});D&&(this._element.blur(),this._element.focus())}static NC(){ch.a.NC(na.AFrameworkApplication.isRtl)}static Vqd(){return new Ag(na.AFrameworkApplication.Dd,
qg.a.instance,hg.KeyInputManager.instance,Ue.a.instance,na.AFrameworkApplication.Lo,Ag.NC,wh.a.bMj,wh.a.thh,Ja.a.instance.Qd("Common.App.Header.HeaderEventSource"),cb.a.tpa,cb.a.Xi,cb.a.vh)}}Object(da.a)(Ag,"RenameUIHandler",null,[704]);class Sg{static get instance(){return na.AFrameworkApplication.sa.Ra.kw?Sg.La||(Sg.La=Eh.Vqd()):Sg.La||(Sg.La=Ag.Vqd())}}Sg.La=null;Object(da.a)(Sg,"RenameUIHandlerFactory",null,[]);var dh=a(145);class Sh{constructor(){this.X_i=this.T_i=this.svh=null}}Object(da.a)(Sh,
"RenameMruEntryProperties",null,[]);var Tf=a(385),ag=a(181),Cf=a(665),yh;(function(D){D[D.unknown=-1]="unknown";D[D.success=0]="success";D[D.renameInvalidFileName=1]="renameInvalidFileName";D[D.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";D[D.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";D[D.permissionDenied=4]="permissionDenied";D[D.serverCommunicationFailure=5]="serverCommunicationFailure";D[D.fileNameTooLong=6]="fileNameTooLong"})(yh||(yh={}));Object(da.b)("CommonOperationResult",
yh);class xa{constructor(D,ha,fb,Vb,Gc,zd,ae,He,hf,zf,vg,gh){this.ane=D;this.Na=ha;this.oRc=fb;this.Ay=Vb;this.iJa=Gc;this.FSg=zd;this.wwa=ae;this.qxe=He;this.dPg=hf;this.qva=zf;this.Oa=vg;this.cPg=gh}tj(){na.AFrameworkApplication.sa&&na.AFrameworkApplication.sa.Ra.kw||this.nl.ae(Za.a.JGb,Sa.a.frame,Object(La.a)(this,this.JGb,"initializeRenameUIHandler"));this.nl.ae(Za.a.okb,Sa.a.frame,Object(La.a)(this,this.okb,"showRenameDisabledDialog"));this.nl.ae(Za.a.renameFile,Sa.a.frame,Object(La.a)(this,
this.renameFile,"renameFile"));this.nl.Rg(Za.a.fileNameUpdate,Sa.a.frame,Object(La.a)(this,this.Zvj,"refreshFilename"),64);this.nl.Rg(Za.a.cwc,Sa.a.frame,Object(La.a)(this,this.cwc,"moveToFolderCompleteByHost"),64);this.nl.ae(Za.a.VTa,Sa.a.frame,Object(La.a)(this,this.VTa,"moveToFolder"));(na.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||na.AFrameworkApplication.sa&&(na.AFrameworkApplication.da.pa("PostMessageEmbedded")||na.AFrameworkApplication.da.pa("IsJsApi"))&&
na.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0))&&na.AFrameworkApplication.fU().execute(D=>{D.Rn(ag.a.OHf);D.fm(ag.a.OHf,xa.Ouj);D.Rn(ag.a.Nld);D.fm(ag.a.Nld,xa.Muj)})}mcb(){return 0===this.cPg.Lgf()?32:8}elk(){return this.Oy?this.wwa?this.Oy.GYe:this.Oy.B9a:!0}JGb(){return Sg.instance.initialize(na.AFrameworkApplication.gic,na.AFrameworkApplication.H7a,na.AFrameworkApplication.xWd||CommonUIStrings.l_RenameFileTooltip)?32:8}okb(){const D=this.elk(),
ha=this.FSg();ba.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",this.iJa,ha,D,this.wwa);na.AFrameworkApplication.sa&&na.AFrameworkApplication.sa.Ra.hy&&na.AFrameworkApplication.da.pa("ReactRenameDisabledDialogIsEnabled")?new qh(this.iJa,!ha,!D,this.wwa,this.qva()):new Rg(this.iJa,!ha,!D,this.wwa,this.qva());return 32}renameFile(D,ha,fb,Vb,Gc){if(1===
fb)return this.mcb();if(!na.AFrameworkApplication.Bhc)return 8;if(8===this.mcb())return this.nl.processAction(Za.a.okb,2),8;ba.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");na.AFrameworkApplication.Bhc(Gc,Object(La.a)(this,this.mOb,"onRenameFileSuccess"),Object(La.a)(this,this.gdj,"onRenameFileFailure"));na.AFrameworkApplication.wDj=!0;return 32}mOb(D,ha){D?0!==D.OperationResult?this.Jkf(D.OperationResult):(this.pNj(ha,D.NewName),this.zgk(D,Object(La.a)(na.AFrameworkApplication.sa.Ra,na.AFrameworkApplication.sa.Ra.cwg,
"updateOpenInClientDocumentUrl")),na.AFrameworkApplication.da.pa("DocumentNameInJewelInfoMenuIsEnabled")&&na.AFrameworkApplication.sa.updateCommandUI(),this.dPg.zug()):this.Jkf(5)}pNj(D,ha){const fb={};fb[Tf.a.oUh]=ha;D.sendMessage(ag.a.Nld,fb)}zgk(D,ha){this.Mgk(D);na.AFrameworkApplication.bfc=D.DirectInvokeDavUrl;ha=ha(D.EditDocInClientUrl);const fb=new Sh;fb.X_i=this.Ay.Ip;fb.svh=ha;fb.T_i=D.EditDocInClientUrl;this.nl.eg(Za.a.renameMostRecentlyUsedFileEntry,2,fb)}Jkf(D){switch(D){case 1:D=new bh.StandardDialog,
D.Rd=0,D.BV(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.w$f()}}Mgk(D){this.Ay.Ip=xa.E3g(this.Ay.Ip,D.NewName);D.BreadcrumbFolderName&&(this.Ay.breadcrumbFolderName=D.BreadcrumbFolderName);D.BreadcrumbFolderUrl&&(this.Ay.breadcrumbFolderUrl=D.BreadcrumbFolderUrl);this.qxe(D.NewName)}gdj(D){const ha=new bh.StandardDialog;ha.Rd=0;switch(D){case 1:ba.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");ha.Msa(CommonUIStrings.l_RenameFileInvalidNameTitle,
CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:ba.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");ha.Msa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:ba.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:D}),ha.Msa(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}na.AFrameworkApplication.fU().execute(fb=>{fb.sendMessage(ag.a.nUh,{["FailureMessage"]:yh[D]})});
this.w$f()}Zvj(D,ha,fb){if(1===fb)return this.mcb();if(!na.AFrameworkApplication.HOa)return 8;na.AFrameworkApplication.HOa(Object(La.a)(this,this.Fyc,"onRefreshFilenameSuccess"),Object(La.a)(this,this.Eyc,"onRefreshFilenameFailure"),!1);return 32}VTa(D,ha,fb,Vb,Gc){if(1===fb)return na.AFrameworkApplication.da.pa("UiHostSupportsMoveToFolder")?32:8;if(2===fb){const zd={};D=na.AFrameworkApplication.Xfa;ha=na.AFrameworkApplication.da.pa("UiHostSupportsDocRebootFeatures");D=(!D||D&&ha)&&na.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",
!1);zd[Tf.a.d7j]=D;Gc&&Gc.MoveButtonClickedTime&&(zd[Tf.a.rZi]=Gc.MoveButtonClickedTime.getTime());na.AFrameworkApplication.fU().execute(ae=>{ae.sendMessage(ag.a.VTa,zd)});if(Gc&&Gc.MoveButtonClickedTime){if(D=dh.a.Zt())Gc=(new Date).getTime()-Gc.MoveButtonClickedTime.getTime(),D.set("MovePostDuration",Gc.toString());Zc.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",D)}return 32}return 8}cwc(D,ha,fb,Vb,Gc){if(1===fb)return na.AFrameworkApplication.da.pa("UiHostSupportsMoveToFolder")?this.mcb():
8;if(2===fb){if(!na.AFrameworkApplication.udg)return Zc.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!Gc)return Zc.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(Gc[Tf.a.ZCi])if(Gc[Tf.a.Ywg])if(D=Gc[Tf.a.Ywg].toLowerCase(),ha=na.AFrameworkApplication.da.pa("UiHostSupportsDocRebootFeatures"),fb=na.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),ha&&
na.AFrameworkApplication.Xfa&&fb){const zd={};zd[Tf.a.UVa]="1";zd[Tf.a.documentUrl]=D;zd[Tf.a.reason]=Cf.a.saveAs;Zc.Health.instance.recordKpiSuccess("MoveToFolder",null);na.AFrameworkApplication.fU().execute(ae=>{ae.sendMessage(ag.a.L1,zd)})}else if(!na.AFrameworkApplication.Xfa&&fb)Zc.Health.instance.recordKpiSuccess("MoveToFolder",null),wh.a.Sg(D,wh.a.I_(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return Zc.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,
!1,null),8;else Zc.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else na.AFrameworkApplication.HOa(Object(La.a)(this,this.Fyc,"onRefreshFilenameSuccess"),Object(La.a)(this,this.Eyc,"onRefreshFilenameFailure"),!1),na.AFrameworkApplication.udg(),Zc.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}HZj(D,ha){return D&&ha?D!==this.Ay.breadcrumbFolderName||ha!==this.Ay.breadcrumbFolderUrl:!1}Fyc(D,ha){D&&(D.NewName!==Ua.a.ds(this.Ay.Ip)||this.HZj(D.BreadcrumbFolderName,
D.BreadcrumbFolderUrl))&&this.mOb(D,ha)}Eyc(){}w$f(){this.qxe(Ua.a.ds(this.Ay.Ip))}get nl(){return this.Na.value}get Oy(){return this.oRc.value}static get instance(){return xa.La||(xa.La=xa.Ina())}static Ina(){return new xa(na.AFrameworkApplication.ncb,new Qg.a(()=>na.AFrameworkApplication.Dd),new Qg.a(()=>na.AFrameworkApplication.Oy),na.AFrameworkApplication.Lo,na.AFrameworkApplication.limitedEdit,()=>na.AFrameworkApplication.userCanRename,na.AFrameworkApplication.DDc,Object(La.a)(Sg.instance,Sg.instance.E_,
"updateTitle"),Ja.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>na.AFrameworkApplication.isReadOnlyRecommended,na.AFrameworkApplication.da,Ja.a.instance.resolve("Common.IRenameProps"))}static E3g(D,ha){D=Ua.a.H8(D);return ha+D}static Ouj(D){const ha=D.Values[Tf.a.cHi];ba.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",ha);ha?na.AFrameworkApplication.Dd.eg(Za.a.cwc,2,D.Values):Zc.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",
!1,!1,null)}static Muj(D){na.AFrameworkApplication.Dd.eg(Za.a.renameFile,2,D.Values.NewName)}}xa.La=null;Object(da.a)(xa,"RenameActor",null,[]);a(579);class wa{}Object(da.a)(wa,"ActivityEventName",null,[]);class Ic{}Ic.compatMode="CompatMode";Ic.noSelection="NoSelection";Object(da.a)(Ic,"ActivityEventReason",null,[]);var Zd=a(663);class Ke{constructor(D,ha){this.Na=D;this.r0a=ha}tj(){this.Na.ae(Za.a.llg,Sa.a.frame,Object(La.a)(this,this.t1j,"showRenameDialogAction"))}t1j(D,ha,fb){D=32;if(1===fb)return Zd.SessionStatusManager.instance.U$a||
na.AFrameworkApplication.B9?8:32;2===fb&&(32!==this.Na.processAction(Za.a.renameFile,1)?(this.Na.processAction(Za.a.okb,2),D=8):32===this.Na.processAction(Za.a.EVb,1)?this.Na.processAction(Za.a.EVb,2):this.r0a.value.create().ZHc());return D}}Object(da.a)(Ke,"RenameDialogActor",null,[696]);class Te{constructor(D,ha,fb){this.dialog=null;this.Na=D;this.Ay=ha;this.cva=fb}jfi(){const D={};D.nameInputProps={["type"]:"AppInputProps",["id"]:Te.G7a,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:Ua.a.ds(this.Ay.Ip),
["maxLength"]:this.cva};return D}ZHc(){const D={["id"]:"RenameDialog",["bodyControls"]:this.jfi()};this.dialog=new nh.a(!1,!1,!0);this.dialog.Rd=1;this.dialog.ug="RenameDialog";this.dialog.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(La.a)(this,this.vWd,"renameDialogHandler"),D)}vWd(D,ha){ha&&1===D&&ha[Te.G7a]&&(D=Ua.a.ds(this.Ay.Ip),ha=(ha[Te.G7a]||"").trim(),ha!==D&&""!==ha&&this.Na.eg(Za.a.renameFile,2,ha))}}Te.G7a="txtDocumentName";Object(da.a)(Te,"ReactRenameDialog",null,[705]);
class If{static get di(){return nh.a.sq(If.vn,CommonUIStrings.l_RenameDialogLabel)}}If.vn="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(da.a)(If,"RenameDialogHtml",null,[]);class Ef extends nh.a{constructor(D,ha,fb){super();this.Na=D;this.Ay=ha;this.cva=fb;this.ug="RenameDialog";this.di=If.di}ZHc(){var D={["txtDocumentName"]:Ua.a.ds(this.Ay.Ip)};
this.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(La.a)(this,this.vWd,"renameDialogHandler"),D);D=document.getElementById(Ef.G7a);0<this.cva&&(D.maxLength=this.cva);D.focus()}vWd(D,ha){1===D&&(D=Ua.a.ds(this.Ay.Ip),ha=(ha[Ef.G7a]||"").trim(),ha!==D&&""!==ha&&this.Na.eg(Za.a.renameFile,2,ha))}}Ef.G7a="txtDocumentName";Object(da.a)(Ef,"RenameDialog",nh.a,[705]);class ta{constructor(D){this.aca=null;this.cva=0;this.Na=D;this._initialized=!1}initialize(D,ha){this.aca=D;this.cva=ha;this._initialized=
!0}create(){return this._initialized?na.AFrameworkApplication.sa&&na.AFrameworkApplication.sa.Ra.hy&&na.AFrameworkApplication.da.pa("ReactRenameDialogIsEnabled")?new Te(this.Na,this.aca,this.cva):new Ef(this.Na,this.aca,this.cva):null}}Object(da.a)(ta,"RenameDialogFactory",null,[695]);var zb=a(110),qc=a(112),Kc=a(108);class Xc{constructor(D,ha){this.Na=D;this.Re=ha}tj(){this.Na.ae(Za.a.EVb,Sa.a.frame,Object(La.a)(this,this.u1j,"showRenameFlyoutAction"))}Cdh(){return ob.d("setDocumentTitleFlyoutOpened")&&
na.AFrameworkApplication.sa.Ra.kw}u1j(D,ha,fb){if(1===fb)return this.Cdh()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}gXg(){Xc.kKi&&na.AFrameworkApplication.eSa&&Kc.a.instance.Sh(new qc.a(5,1,5E3,()=>{32===this.Na.processAction(Za.a.EVb,1)&&this.Re&&this.Re.hk.name===Ob.AFrame.S7&&(zb.a("RenameFloatieShownOnNewDocumentLoad",!0),this.Na.processAction(Za.a.EVb,2))}))}static get kKi(){Xc.g2b&&null!=Xc.g2b||(na.AFrameworkApplication.mZ("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),
Xc.g2b=na.AFrameworkApplication.da?na.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return Xc.g2b}}Xc.g2b=null;Object(da.a)(Xc,"RenameFlyoutActor",null,[693]);class Sd{constructor(D,ha,fb,Vb,Gc){this.oRc=Gc;this.bne=fb;this.ane=Vb;this.JSg=D;this.qva=ha}get Oy(){return this.oRc.value}Lgf(){if(!this.ane())return 5;if(this.qva())return 1;if(this.Oy){if(this.bne&&!this.Oy.GYe)return 3;if(!this.bne&&!this.Oy.B9a)return 4}return this.JSg()?
0:2}}Object(da.a)(Sd,"RenameProps",null,[694]);var me=a(106);class Le{constructor(D,ha,fb,Vb,Gc,zd){this.Ey=!1;this.mXc=new me.a;this.y0a=ha;this.UO=fb;this.JGg=Vb;this.Oa=Gc;this.Zve=zd}enable(){this.Ey||(this.zug(),this.S5d(),this.Ey=!0)}generateKey(D,ha,fb){return String.format("{0}/{1}/{2}",fb,D,ha)}R$h(){const D=Ua.a.ds(this.y0a().Ip);return this.generateKey(this.y0a().breadcrumbFolderName,this.y0a().breadcrumbFolderUrl,D)}S$h(D,ha,fb){return D&&ha?this.generateKey(D,ha,fb):fb}Tzh(D,ha,fb){return D&&
D!==this.y0a().breadcrumbFolderName||ha&&ha!==this.y0a().breadcrumbFolderUrl?!0:fb!==Ua.a.ds(this.y0a().Ip)}zug(){const D=this.R$h();this.mXc.fa(D,new Date)}bQd(D){this.cYj(D)&&this.Eye(D)}cYj(D){const ha=this.JGg();return ha?this.Zve&&this.Zve.tIb||!ha.Etf||!na.AFrameworkApplication.HOa?(this.Lng(D),this.Ey=!1):!0:!1}FUf(D,ha,fb,Vb){const Gc=this.Tzh(D,ha,fb),zd=this.S$h(D,ha,fb);D=(()=>this.mXc.kf(zd))().returnValue;Gc&&!D&&(this.Kkf(Vb),ba.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",
this.PGd));Gc||this.mXc.fa(zd,this.UO())}}Object(da.a)(Le,"ARenamedFileChecker",null,[669]);class Xe extends Le{constructor(D,ha,fb,Vb,Gc,zd,ae,He){super(D,ha,fb,Vb,Gc,zd);this.hte=Gc;this.bPg=ae;this.uKg=He}get PGd(){return"RenamedFileCheckerUsingSettingsRefresh"}S5d(){this.hte.J5c(Object(La.a)(this,this.vlf,"handleSettingsRefresh"))}vlf(D,ha){ha&&ha.MMb&&ha.N2i&&(ha.ycb("BreadcrumbDocName")||ha.ycb("BreadcrumbFolderName")||ha.ycb("BreadcrumbFolderUrl")||ha.ycb("DirectInvokeDAVUrl")||ha.ycb("EditDocInClientUrl"))&&
(ba.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.PGd),this.bQd(ha))}Lng(){this.hte.k7f(Object(La.a)(this,this.vlf,"handleSettingsRefresh"))}Eye(D){if(D&&D.MMb){const ha=D.MMb;this.FUf(ha.Sa("BreadcrumbFolderName"),ha.Sa("BreadcrumbFolderUrl"),ha.Sa("BreadcrumbDocName"),D)}}Kkf(D){const ha={OperationResult:0,classId:1};D=D.MMb;ha.BreadcrumbFolderName=D.Sa("BreadcrumbFolderName");ha.BreadcrumbFolderUrl=D.Sa("BreadcrumbFolderUrl");ha.DirectInvokeDavUrl=D.Sa("DirectInvokeDAVUrl");
ha.EditDocInClientUrl=D.Sa("EditDocInClientUrl");D=D.Sa("BreadcrumbDocName");ha.NewName=na.AFrameworkApplication.Jya?D:Ua.a.ds(D);this.uKg.execute(fb=>{this.fAi(ha,fb)})}fAi(D,ha){this.bPg().mOb(D,ha)}}Object(da.a)(Xe,"RenamedFileCheckerUsingSettingsRefresh",Le,[]);class rf extends Le{constructor(D,ha,fb,Vb,Gc,zd,ae,He,hf,zf){super(D,fb,Vb,Gc,zd,hf);this.Yrb=this.m6b=null;this.jOg=ha;this.Na=ae;this.fg=He;zf&&zf.execute(vg=>{this.syj(vg)})}get PGd(){return"RenamedFileCheckerUsingTask"}syj(D){this.m6b=
D;this.m6b.HCe(Object(La.a)(this,this.dFb,"handleVisibilityChange"))}dFb(D,ha){!this.Ey||0!==ha.newState&&1!==ha.newState||this.Yrb||(this.S5d(),this.bQd(this.Yrb))}S5d(){this.Yrb=new qc.a(3,2,this.jOg(),Object(La.a)(this,this.bQd,"performRenameFileCheckTick"),89);this.fg.Sh(this.Yrb)}Lng(D){this.fg.rr(D)}Eye(D){this.m6b&&2===this.m6b.erk?this.xzj(D):na.AFrameworkApplication.HOa(Object(La.a)(this,this.Fyc,"onRefreshFilenameSuccess"),Object(La.a)(this,this.Eyc,"onRefreshFilenameFailure"),!0)}xzj(D){this.fg.rr(D);
this.Yrb=null}Fyc(D){D&&this.FUf(D.BreadcrumbFolderName,D.BreadcrumbFolderUrl,D.NewName,null)}Kkf(){this.Na.processAction(Za.a.fileNameUpdate,2)}Eyc(){}}Object(da.a)(rf,"RenamedFileCheckerUsingTask",Le,[]);class Ff{constructor(){this.Oa=this.hd=null}get name(){return"Common.App.RenameFile"}Xj(D){this.hd=D;this.Oa=na.AFrameworkApplication.da;this.hd.register(Ke,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Le(()=>new Ke(na.AFrameworkApplication.Dd,this.hd.bYd("Common.App.Rename.IRenameDialogFactory"))).Ee();
this.hd.register(ta,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Le(()=>new ta(na.AFrameworkApplication.Dd)).Ee();this.hd.register(669,"Common.App.Rename.IRenamedFileChecker").Le(()=>this.pth()).Ee();this.hd.register(Xc,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Le(()=>new Xc(na.AFrameworkApplication.Dd,ra.FocusManager.instance())).Ee()}pth(){if(this.Oa.pa("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const D=this.hd.oi("Common.IRefreshableAppSettings");
if(D&&D.twf)return new Xe(()=>D.Hf("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>na.AFrameworkApplication.Lo,()=>new Date,()=>na.AFrameworkApplication.Oy,D,this.hd.oi("Common.ISessionStatus"),()=>xa.instance,this.hd.Qd("Postmessage.IHostPostmessenger"))}return new rf(()=>this.Oa.Hf("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.Oa.Hf("RenamedFileCheckerPingIntervalInMs",12E4),()=>na.AFrameworkApplication.Lo,()=>new Date,()=>na.AFrameworkApplication.Oy,na.AFrameworkApplication.da,na.AFrameworkApplication.Dd,
na.AFrameworkApplication.Vj,this.hd.oi("Common.ISessionStatus"),this.hd.Qd("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.Oa.qx(Object(La.a)(this,this.iE,"onFullAppSettingsReady"))}iE(){const D=na.AFrameworkApplication.sa.Ra.kw;na.AFrameworkApplication.ncb()&&Sg.instance.initialize(na.AFrameworkApplication.gic,D?null:na.AFrameworkApplication.H7a,D?null:na.AFrameworkApplication.xWd||CommonUIStrings.l_RenameFileTooltip)&&(this.hd.register(Sd,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Le(()=>
new Sd(()=>na.AFrameworkApplication.userCanRename,()=>na.AFrameworkApplication.isReadOnlyRecommended,na.AFrameworkApplication.DDc,na.AFrameworkApplication.ncb,new Qg.a(()=>na.AFrameworkApplication.Oy))).Ee(),xa.instance.tj(),this.Oa.pa("RenameDialogIsEnabled")&&(this.hd.resolve("Common.App.Rename.RenameDialogFactory").initialize(na.AFrameworkApplication.Lo,na.AFrameworkApplication.gic),this.hd.resolve("Common.App.Rename.IRenameDialogActor").tj()),this.hd.resolve("Common.App.Rename.IRenameFlyoutActor").tj(),
na.AFrameworkApplication.DDc&&this.hd.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.hd.resolve("Common.App.Rename.IRenameFlyoutActor").gXg())}dispose(){}}Object(da.a)(Ff,"PackageManager",null,[2,3]);var Kf=a(238),Pf=a(390),ya=a(383),Db=a(200),lc=a(248);class zc{constructor(D){this.$=D}get Etf(){return this.$.workbookContext.FileCoauthorable}get tIb(){return!1}get B9a(){return this.$.ea.amIAlone}get GYe(){if(this.B9a)return!0;for(const D of this.$.ea.Vp)if(!D.SupportsRename)return!1;
return!0}}Object(da.a)(zc,"EwaCoauthManager",null,[692]);class id extends za.a{constructor(D,ha){super();this.zha=this.wWd=this.D7f=this.tgd=null;this.kfa=()=>{var fb=this.$.ea.pp;if(fb&&fb.WorkbookFileName){var Vb=Ua.a.ds(fb.WorkbookFileName),Gc=!!ge.a.compare(this.$.workbookContext.WorkbookFileName,fb.WorkbookFileName,!1),zd=ib.EwaSettings.Ea(465)&&!!fb.BreadcrumbFolderUrl&&!!ge.a.compare(this.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,fb.BreadcrumbFolderUrl,!1);if(Gc||zd)this.zha={},
this.zha.NewFileName=Vb,this.zha.EditDocInClientUrl=fb.EditDocInClientUrl,this.zha.DirectInvokeDAVUrl=fb.DirectInvokeDAVUrl,this.zha.DownloadACopyUrl=fb.DownloadACopyUrl,ib.EwaSettings.Ea(465)&&fb.BreadcrumbFolderUrl&&(this.zha.BreadcrumbFolderName=fb.BreadcrumbFolderName,this.zha.BreadcrumbFolderUrl=fb.BreadcrumbFolderUrl),fb=na.AFrameworkApplication.Dd.eg(Za.a.fileNameUpdate,2,Vb),this.zha=null,ba.ULS.shipAssertTag(537154064,0,32===fb,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};
this.j7i=(fb,Vb,Gc)=>{this.D7f=Vb;this.wWd=Gc;this.$.Ha.Ad(new bb.a(1897077126,eb.a.Bd,2,3,null),{["newFileName"]:fb})};this.i7i=fb=>{this.zha&&fb(this.Mgf(this.zha),this.uq)};this.mOb=fb=>{lc.a(fb)||!fb.Result?(fb=id.m0h(fb),Dd.a(this.$).rf.oP([-414480287,650565124,-782844485,1223808266,-62451516,1636785843]),this.wWd(fb)):this.D7f(this.Mgf(fb.Result),this.uq)};this.fdj=()=>{this.wWd(5)};this.$=D;this.uq=ha;this.$.ea.Mw(this.kfa)}initialize(){na.AFrameworkApplication.Bhc=this.j7i;na.AFrameworkApplication.HOa=
this.i7i;this.tgd=na.AFrameworkApplication.Oy;na.AFrameworkApplication.Oy=new zc(this.$)}dispose(){na.AFrameworkApplication.Bhc=null;na.AFrameworkApplication.HOa=null;this.$.ea.ny(this.kfa);na.AFrameworkApplication.Oy=this.tgd;this.$=this.tgd=null;super.dispose()}renameFile(D,ha){const fb=D.newFileName;if(fb&&(D=Ua.a.ds(this.$.workbookContext.WorkbookFileName),ge.a.compare(D,fb,!1))){const Vb=this.$.qa.ua.ie();ya.a(this.$.userOperationManager,(Gc,zd,ae)=>{var He=this.$.qa.ua;Gc=Bd.b(Gc,this.mOb);
zd=Bd.a(zd,this.fdj);const hf=He.Pa(9,Vb);hf.newFileName=fb;return be.g(He,"RenameFile",hf,Gc,zd,ae,null,0)},Gc=>new Db.a(134,0,Gc),ha)}}HCi(){return 32===na.AFrameworkApplication.Dd.processAction(Za.a.mma,1)}Mgf(D){var ha=this.$.workbookContext;na.AFrameworkApplication.N1=D.DownloadACopyUrl;const fb=ib.EwaSettings.Ea(465)&&!!D.BreadcrumbFolderUrl;fb&&(na.AFrameworkApplication.Lo.breadcrumbFolderName=D.BreadcrumbFolderName,na.AFrameworkApplication.Lo.breadcrumbFolderUrl=D.BreadcrumbFolderUrl,ha.FullDocumentInfo.BreadcrumbFolderUrl=
D.BreadcrumbFolderUrl,ha.FullDocumentInfo.BreadcrumbFolderName=D.BreadcrumbFolderName);ha.FullDocumentInfo.BreadcrumbDocName=D.NewFileName;Pf.d(ha,D.NewFileName);ha={};ha.NewName=D.NewFileName;ha.DirectInvokeDavUrl=D.DirectInvokeDAVUrl;ha.EditDocInClientUrl=D.EditDocInClientUrl;fb&&(ha.BreadcrumbFolderName=D.BreadcrumbFolderName,ha.BreadcrumbFolderUrl=D.BreadcrumbFolderUrl);ha.OperationResult=0;return ha}static m0h(D){switch(D.Errors[0].MessageId){case -414480287:D=2;break;case 650565124:D=1;break;
case 1636785843:D=6;break;case -782844485:D=4;break;default:D=5}return D}}Object(da.a)(id,"RenameFileManager",za.a,[670,5]);class Vd extends Ta.a{constructor(D){super();this.gya=this.renameFileManager=null;this.$=D;this.je()}create(){if(!this.gya){const D=Kf.a.R6a(Gd.b(),this.ka,"Task","IRenameFileManager");this.gya=D.task;const ha=df.GetServiceTaskFactory.create(this.$.ga,137,this.ka,this.Ta),fb=ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(Ve.d)(je.a.resolve(Fd.z,
{Ja:this.Ta})):df.GetServiceTaskFactory.create(this.$.ga,155,this.ka,this.Ta);qa.TaskExtensions.za(qa.TaskExtensions.Wf([fb,ha],this.ka),()=>{const Vb=new id(this.$,ha.result);this.$.ga.Qa(120,Vb);D.setResult(Vb)},this.ka,3)}this.gya.continueWith(D=>{this.Ld(D.result)})}dispose(){oc.a.Ma(this.renameFileManager);this.$=this.renameFileManager=null;super.dispose()}static la(D){D.ga.Qa(119,new Vd(D))}}Object(da.a)(Vd,"RenameFileManagerServiceFactory",Ta.a,[]);var de=a(36),Je=a(554),Ze=a(180),yf=a(74),
Lf=a(142),aa=a(111),db=a(320),N=a(143),pa=a(384);class Ib{constructor(D){this.Hab=this.yoc=0;this.Cac=null;this.Ntf=!1;this.$=D;this.Ntf=D.Rsc}gFi(){return $a.h(this.$).ld?(ba.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.yd.TA?(ba.ULS.sendTraceTag(537149794,0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),!1):!0}i8i(D){this.Cac=new Sys.UI.Point(Math.round(D.Iza.center.x),Math.round(D.Iza.center.y));
this.yoc=de.a(this.$).zoom;this.Hab=D.Iza.scale;let ha={["InitialZoom"]:this.yoc,["Location"]:"canvas",["InputMethod"]:D.Gd};N.b(this.$).nf(Lf.a.Xkj,ha);ba.ULS.sendTraceTag(537149793,0,50,`PinchToZoomAdapter.OnGestureStart starting gesture. center (${this.Cac.x},${this.Cac.y}), initial zoom ${this.yoc}, initial scale ${this.Hab}`);this.feb(D,"onGestureStart");return!0}h8i(D){if(!this.Hab)return ba.ULS.shipAssertTag(537149792,0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),
this.feb(D,"OnGestureEvent"),!0;if(!isFinite(this.Hab))return ba.ULS.sendTraceTag(537149791,0,15,`PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale=${this.Hab}`),this.feb(D,"OnGestureEvent"),!0;const ha=D.Iza.scale/this.Hab*this.yoc;de.a(this.$).Yzg(ha,this.Cac);ba.ULS.sendTraceTag(537149790,0,50,`PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom ${ha}. Current scale ${D.Iza.scale}`);this.feb(D,"OnGestureEvent");return!0}g8i(D){de.a(this.$).Zzg();
ba.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture");this.feb(D,"OnGestureEnd")}f8i(D){ba.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");this.feb(D,"OnGestureCancel")}feb(D,ha){var fb,Vb,Gc;this.Ntf&&(ba.ULS.sendTraceTag(536990857,0,50,`PinchToZoomAdapter.markGestureEventAsHandled - Invoked from ${ha},        eventArgs non-null: ${isNullOrUndefined(D)}, gestureData non-null: ${isNullOrUndefined(null===D||void 0===D?void 0:D.Iza)},        srcEvent non-null: ${isNullOrUndefined(null===
(fb=null===D||void 0===D?void 0:D.Iza)||void 0===fb?void 0:fb.srcEvent)}`),null===(Gc=null===(Vb=null===D||void 0===D?void 0:D.Iza)||void 0===Vb?void 0:Vb.srcEvent)||void 0===Gc?void 0:Gc.preventDefault())}}Object(da.a)(Ib,"PinchToZoomAdapter",null,[698]);class nc extends qb.a{constructor(){super()}dDe(D){this.addHandler("ZCIEK",D)}C7f(D){this.removeHandler("ZCIEK",D)}c6c(D){this.addHandler("ZCUIK",D)}uWd(D){this.removeHandler("ZCUIK",D)}Msj(){this.raiseEvent("ZCIEK")}Lsj(){this.raiseEvent("ZCUIK")}Nsj(){this.raiseEvent("ZCEK")}}
Object(da.a)(nc,"ZoomEventManager",qb.a,[684]);var kd=a(90);class Wd extends qb.a{constructor(D){super();this.statusBarManager=null;this.z9e=!1;this.$=D;this.$.ga.qd(29,ha=>{this.statusBarManager=ha;ha.zM(this)})}Xs(D){this.addHandler("Zoom",D)}Gt(D){this.removeHandler("Zoom",D)}pC(){this.Up("QueryZoomStatus")&&this.raiseEvent("Zoom")}Ru(D,ha){return"QueryZoomStatus"!==D?!1:this.Eoi(ha)}Up(){return de.a(this.$).XV()}dispose(){this.statusBarManager&&(this.statusBarManager.MI(this),this.statusBarManager=
null);this.$=null;super.dispose()}ujf(D){D=this.Kki(D);if(!D)return null;D=D.getElementsByClassName("cui-ctl-mediumlabel");return 1!==D.length?(ba.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),null):D[0]}Eoi(D){if(!this.$)return!1;const ha=de.a(this.$).mZb;let fb=!1;if($b.a.Yn())ge.a.equals(appChrome.selectors.getControlLabel(kd.a.zoomStatusBarMenuOpen),ha,!1)||(fb=!0);else{const Vb=this.ujf("HandleQueryZoomStatusCommand");Vb?ge.a.equals(D.LabelText.toString(),
ha,!1)||(Vb.innerText="",fb=!0):fb=!0}fb&&this.IRj(D,ha);return!0}IRj(D,ha){D.LabelText=ha;$b.a.Yn()&&(D.Visible=!0)}Kki(D){var ha=sd.DOMElementExtensions.getElementById(this.$.domElement,"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");if(!ha)return ha=(ha=this.$.ea.te)?ha.inEmbedView:!1,cb.a.ls||ha||ba.ULS.sendTraceTag(537149763,0,15,`ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from ${D}`),null;this.z9e||(this.z9e=!0,ba.ULS.sendTraceTag(537149762,0,50,`ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from ${D}`));
return ha}}Object(da.a)(Wd,"ZoomStatusBarManager",qb.a,[5,295,188]);class Ae extends Je.a{constructor(D){super(D);this.zoomEventManager=this.gCa=this.sKb=null;this.zKb=-1;this.Ltf=!1;this.uf=()=>{this.zKb=-1};ba.ULS.sendTraceTag(537149785,0,50,"AppZoom feature is Enabled.");this.Umb=new Wd(D);this.Ykj()&&(ba.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),this.S5g());this.wyj()}dispose(){this.Umb&&(oc.a.Ma(this.Umb),this.Umb=null);this.zoomEventManager&&(this.$.ga.C1(419),
this.zoomEventManager=null);this.Ltf&&this.pzh();super.dispose()}XV(){return!0}Yzg(D,ha){D=this.XOa(D);if($a.h(this.$).rtl){const fb=Math.round(sd.DOMElementExtensions.getBounds(this.$.Eh).width*de.a(this.$).zoom);this.sKb=new Sys.UI.Point(fb-ha.x,ha.y)}else this.sKb=ha;this.UXa(D,!1,"ZoomWithPinch")}oOc(){return!0}nOc(D,ha){var fb=cb.a.isMac?.07:.15;D=this.zoom+(D?fb:-fb);D=this.XOa(D);$a.h(this.$).rtl?(fb=Math.round(sd.DOMElementExtensions.getBounds(this.$.Eh).width*de.a(this.$).zoom),this.gCa=
new Sys.UI.Point(fb-ha.x,ha.y)):this.gCa=ha;ha=this.zoom;this.UXa(D,!0,"ZoomWithMouse");ha={["InitialZoom"]:ha,["FinalZoom"]:D,["Location"]:"canvas"};N.b(this.$).nf(Lf.a.Vpk,ha)}Zzg(){this.sKb=null}pOc(D,ha){this.UXa(this.XOa(D),!1,ha?"ZoomWithDropDownFromRibbon":"ZoomWithDropDown")}$zg(D){isNaN(D)?ba.ULS.sendTraceTag(537149783,0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):this.UXa(this.XOa(D),!1,"ZoomToLevelInExcelLive")}qOc(D,ha){this.UXa(this.XOa(D),
!0,ha?"ZoomWithShortcuts":"ZoomWithButtons")}ohf(D,ha){const fb=$a.h(this.$).rtl,[Vb,Gc]=this.Krd(fb),[zd,ae]=this.Ftd(D,Gc);return this.gCa?(D=this.qrd(this.gCa,D,ha,Gc,Vb,"ZoomWithMouse"),this.gCa=null,D):this.sKb?this.qrd(this.sKb,D,ha,Gc,Vb,"ZoomWithPinch"):$a.h(this.$).ha.Va.rU?this.Upk(D,ha,Gc,Vb,zd,ae,$a.h(this.$).rtl):this.Wpk(D,ha,Gc,Vb,zd,ae,$a.h(this.$).rtl)}Fcg(D,ha,fb){if(D){ba.ULS.sendTraceTag(537149782,0,50,`Zoom To: (${D.x} ${D.y}) (new top-left) from zoom:${ha} to zoom:${fb}`);D=
new Fb.a(D.x,D.y);fb=$a.h(this.$).rtl;[,fb]=this.Krd(fb);const [Vb,Gc]=this.Ftd(ha,fb);$a.h(this.$).GDe(D,Vb,Gc,"ApplicationZoom")}else ba.ULS.sendTraceTag(537149781,0,50,`Zooming top-left: from zoom:${ha} to zoom:${fb}`)}zoomFitToScreen(){const D=this.zoom;var ha=$a.h(this.$).rtl;const [fb,Vb]=this.Krd(ha),[Gc,zd]=this.Ftd(D,Vb);var ae=$a.h(this.$).ha.Va.rU;(ha=ae?this.ddf(this.Yfb,Gc,zd,!1):this.xhf(this.Yfb,Vb,fb,Gc,zd,ha,!1))?(ha=Math.min(Gc/(ha.width+100),zd/(ha.height+100)),ha=this.MWh(ha),
this.UXa(ha,!0,"ZoomWithFitToScreen"),ae?$a.h(this.$).ha.Va.CMa($a.h(this.$).ha.Va.pe,!1):(ae=Gb.v($a.h(this.$).ha.ra.activeRange,this.$),$a.h(this.$).Bj(ae,null,null,null,3,"ZoomManager.ZoomFitToScreen")),this.zKb=D,this.Ltf||this.M5g()):ba.ULS.sendTraceTag(537149780,0,15,`ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: ${ae}`)}zoomFitToScreenUndo(){this.UXa(this.zKb,!1,"ZoomWithFitToScreen")}w3d(){return-1!==this.zKb}M5g(){const D=$a.h(this.$);D&&(D.ha.kr(this.uf),
D.iH(this.uf))}pzh(){const D=$a.h(this.$);D&&(D.ha.Fr(this.uf),D.NI(this.uf))}MWh(D){D=Math.min(D,Wa.a.PXi);D=Math.max(D,Wa.a.EYi);return Math.round(100*D)/100}UXa(D,ha,fb){if(this.lOc()){var Vb=$a.h(this.$).view.visibleArea.toString();D=this.XOa(D);var Gc=yf.d(this.$.va.na);Gc||(Gc=Je.a.fJf);$a.h(this.$).fj.P4(5,db.a.kOc,fb);$a.h(this.$).fj.dqa(db.a.kOc,this.$.ea.xg);ba.ULS.sendTraceTag(537149779,0,50,`ZoomManager.SetNewZoomLevel Setting zoom ${D} to sheet ${Gc} origin ${fb} prevZoom ${this.zoom}`);
this.xUj(Gc,D);this.zoomEventManager.Nsj();this.cck(fb);this.ock(ha);this.zKb=-1;pa.b(this.$,fb);D=$a.h(this.$).view.visibleArea.toString();ba.ULS.sendTraceTag(537149778,0,50,`ZoomManager.SetNewZoomLevel OldGridVisibleArea: ${Vb}, NewGridVisibleArea: ${D}, IsShyRibbonActive: ${this.$.AU}`)}}Z4h(D){return(D=jd.HelperMethods.SF(this.$.Eh,this.$.domElement,D))?D:new Sys.UI.Point(0,0)}Krd(D){const ha=this.Z4h(D);D=this.N9h(ha,D);return[ha,D]}Ftd(D,ha){const fb=sd.DOMElementExtensions.getBounds(this.$.Eh);
return[Math.round((fb.width-ha.x)*D),Math.round((fb.height-ha.y)*D)]}N9h(D,ha){ha=jd.HelperMethods.SF($a.h(this.$).domElement,this.$.domElement,ha);return ha?(D=new Sys.UI.Point(Math.round(ha.x-D.x),Math.round(ha.y-D.y)),D):new Sys.UI.Point(0,0)}Wpk(D,ha,fb,Vb,Gc,zd,ae){return(ae=this.xhf(D,fb,Vb,Gc,zd,ae))?this.hgf(ae,D,ha,fb,Vb,Gc,zd):null}xhf(D,ha,fb,Vb,Gc,zd,ae){ae=void 0===ae?!0:ae;var He=Gb.G($a.h(this.$).ha.ra.selectedRanges);if(ae&&(He=He.wg(Gb.G($a.h(this.$).cmc())),!He))return ba.ULS.sendTraceTag(537149777,
0,50,"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),null;const hf=$a.h(this.$).Hd(He.topLeft);He=$a.h(this.$).Hd(He.bottomRight);if(!hf||!He)return ba.ULS.sendTraceTag(537149776,0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),null;D=hf.cell.hI===He.cell.hI&&hf.cell.gI===He.cell.gI?this.U3h(D,He,ha,fb,Vb,zd):this.tji(D,hf,He,ha,fb,Vb,zd);return D?ae?this.g8e(D,Vb,Gc):D:(ba.ULS.sendTraceTag(537149775,
0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)}g8e(D,ha,fb){if(0>D.x||D.x>ha)D.x=0;if(0>D.y||D.y>fb)D.y=0;D.x+D.width>ha&&(D.width=ha-D.x);D.y+D.height>fb&&(D.height=fb-D.y);return D}tji(D,ha,fb,Vb,Gc,zd,ae){ha=$a.h(this.$).getCellBounds(ha.cell);if(!ha)return null;const He=$a.h(this.$).getCellBounds(fb.cell);if(!He)return null;let hf=Gc.x;ae&&(hf=0,ha.x=Math.round(zd/D)-ha.x-Math.round(ha.width),He.x=Math.round(zd/D)-He.x-Math.round(He.width));D=new Sys.UI.Bounds(Math.round((ha.x-
Vb.x)*D)-hf,Math.round((ha.y-Vb.y)*D-Gc.y),Math.round((He.x+He.width-ha.x)*D),Math.round((He.y+He.height-ha.y)*D));fb=fb.cell.getRange();ba.ULS.sendTraceTag(537149774,0,50,`ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:${fb.top}, b:${fb.bottom}, r:${fb.right}, l:${fb.left}) in bounds (${D.x}, ${D.y}, ${D.width}, ${D.height})`);return D}U3h(D,ha,fb,Vb,Gc,zd){const ae=$a.h(this.$).getCellBounds(ha.cell);if(!ae)return null;let He=Vb.x;zd&&
(He=0,ae.x=Math.round(Gc/D)-ae.x-Math.round(ae.width));D=new Sys.UI.Bounds(Math.round((ae.x-fb.x)*D)-He,Math.round((ae.y-fb.y)*D-Vb.y),Math.round(ae.width*D),Math.round(ae.height*D));ha=ha.cell.getRange();ba.ULS.sendTraceTag(537149773,0,50,`ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:${ha.top}, l:${ha.left}) in bounds (${D.x}, ${D.y}, ${D.width}, ${D.height})`);return D}Upk(D,ha,fb,Vb,Gc,zd){const ae=this.ddf(D,Gc,zd);return ae?this.hgf(ae,D,ha,fb,Vb,Gc,zd):
null}hgf(D,ha,fb,Vb,Gc,zd,ae){D=new Sys.UI.Point(this.Kgf(zd,D.x,D.width),this.Kgf(ae,D.y,D.height));return this.qrd(D,ha,fb,Vb,Gc)}Kgf(D,ha,fb){return D===fb?(ba.ULS.sendTraceTag(537149772,0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),D/2):D*ha/(D-fb)}ddf(D,ha,fb,Vb){Vb=void 0===Vb?!0:Vb;const Gc=$a.h(this.$).ha.Va.pe.domElement;var zd=jd.HelperMethods.SF(Gc,$a.h(this.$).domElement,$a.h(this.$).rtl);if(!zd)return ba.ULS.sendTraceTag(537149771,
0,50,"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;const ae=$a.h(this.$).JEb();zd=new Sys.UI.Point(Math.round((zd.x-ae.topLeft.x)*D),Math.round((zd.y-ae.topLeft.y)*D));D=new Sys.UI.Bounds(zd.x,zd.y,Math.round(Gc.offsetWidth*D),Math.round(Gc.offsetHeight*D));return Vb?this.g8e(D,ha,fb):D}CJf(){this.Umb.pC()}v1i(D){"ZoomToLevelInExcelLive"===D?this.zoomEventManager.Msj():this.zoomEventManager.Lsj()}wyj(){this.zoomEventManager=this.$.ga.Qa(419,new nc)}qrd(D,ha,fb,
Vb,Gc,zd){zd=void 0===zd?"":zd;var ae=$a.h(this.$).rtl?0:Gc.x;Gc="ZoomWithPinch"===zd||"ZoomWithMouse"===zd?new Sys.UI.Point(D.x-ae-Math.round(Vb.x*ha),D.y-Gc.y-Math.round(Vb.y*ha)):D;Gc=new Sys.UI.Point(Math.round(Gc.x/ha),Math.round(Gc.y/ha));ba.ULS.shipAssertTag(537149770,0,!!ha,"Original zoom level must be different than 0");ae=fb/ha;Gc=new Sys.UI.Point(Math.round(Gc.x*(1-1/ae)),Math.round(Gc.y*(1-1/ae)));"ZoomWithMouse"===zd||"ZoomWithPinch"===zd?(Gc.x+=Math.round((Vb.x-$a.h(this.$).qu)*(ae-
1)),Gc.y+=Math.round((Vb.y-$a.h(this.$).MM)*(ae-1))):(ae=Math.round(Vb.x*(fb-ha)),0<ae&&Gc.x>ae&&(Gc.x+=ae),ha=Math.round(Vb.y*(fb-ha)),0<ha&&Gc.y>ha&&(Gc.y+=ha));"ZoomWithMouse"===zd&&(D.x||(Gc.x=0),D.y||(Gc.y=0));D=$a.h(this.$).JEb();return new Sys.UI.Point(Gc.x+D.topLeft.x,Gc.y+D.topLeft.y)}S5g(){const D=[];Ja.a.instance.Qd("Common.IGestureInputManager").execute(ha=>{0===ha.j9h()&&ha.Swj(document.body,new Ib(this.$),D)})}Ykj(){return this.lOc()&&(cb.a.Sp&&cb.a.IRa(67)||this.$.Rsc)}xUj(D,ha){pa.a(this.$)?
this.setZoomLevel(D,ha,this.zce,Wa.a.PZf):this.setZoomLevel(D,ha,this.zoomPerSheetId,this.Yfb)}setZoomLevel(D,ha,fb,Vb){fb.remove(D);ha!==Vb&&fb.add(D,ha)}cck(D){this.Ogg();this.$.lEa(oa.a.p2("TriggerImmediateZoomOperations"));this.Akk();this.v1i(D)}Akk(){this.lJi()?this.$.Qh():this.Umb.pC();const D=this.Umb.ujf("UpdateZoomStatusBar");D&&(D.innerText=this.mZb)}lJi(){const D=Ze.a(this.$);return D?D.Fs.jB===($b.a.nSa(this.$)?Af.a.MBc:this.$.Pd+Af.a.dag):!1}ock(D){$a.h(this.$).Tpk(D);this.N1g()}N1g(){const D=
aa.a(this.$);if(D)for(const ha of $a.h(this.$).ya.Xy()){if(!ha){ba.ULS.sendTraceTag(537149768,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");continue}if(!ha.sl)continue;const fb=ha.jk;if(fb)for(let Vb=0;Vb<fb.count;Vb++)if(2===fb.li(Vb).type){const Gc=D.qt(fb.li(Vb).Wi());Gc?(Gc.Oia(!1),ba.ULS.sendTraceTag(537149766,0,50,`ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom ${this.zoom}`)):ba.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else ba.ULS.sendTraceTag(537149769,
0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")}}Object(da.a)(Ae,"ZoomManager",Je.a,[]);class Oe extends Ta.a{constructor(D){super();this.$=D;this.je()}create(){const D=new Ae(this.$);this.Ckk(D);this.$.ga.Qa(368,D);this.Ld(D)}Ckk(D){const ha=de.a(this.$);if(ha){var fb=ha.Ktd("ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager");D.H1d(fb);D.fFc(ha.ULc)}else ba.ULS.shipAssertTag(537149765,0,!0,"ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager existingZoomManager is missing (expected to find here a DefaultZoomManager to pass zoom-per-sheet state from)")}static la(D){D.ga.Qa(369,
new Oe(D))}}Object(da.a)(Oe,"ZoomManagerFactory",Ta.a,[]);var sf=a(926);class ff extends Ta.a{constructor(){super();this.je()}create(){this.Ld(new sf.a)}}Object(da.a)(ff,"CommonUIJsServiceFactory",Ta.a,[]);var cg=a(1005);class jg{}Object(da.a)(jg,"LokiTokenResult",null,[]);class pg{constructor(D){this.k3b=D}frd(){const D=this.Eai();return D?pg.EBd?new Promise((ha,fb)=>{this.k3b.continueWith(()=>{this.k3b.qj||this.k3b.Kh?fb(Error.create("Error downloading auth library")):this.k3b.result.$C("Loki",
D).then(Vb=>{Vb=na.AFrameworkApplication.da.pa("ForceLokiFallbackToACLPTokenIsEnabled")?this.Hai():Vb.IsSuccess&&Vb.Token?Object.assign(new jg,{isSuccess:!0,token:Vb.Token,errorMessage:null}):Object.assign(new jg,{isSuccess:!1,token:null,errorMessage:JSON.stringify(Vb)});ha(Vb);return Vb})})}):Promise.resolve(Object.assign(new jg,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new jg,{isSuccess:!1,token:null,
errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",cg.a.paf())}))}Hai(){const D=na.AFrameworkApplication.da.Sa("LokiUserDataSignature")||"";return Object.assign(new jg,{isSuccess:!0,token:D,errorMessage:null})}Eai(){let D=null;const ha=cg.a.Kjc();2===ha?D=na.AFrameworkApplication.da.Sa("LokiAADAppId"):1===ha&&(D=na.AFrameworkApplication.da.Sa("LokiMSAAppId"));return D}static get EBd(){return na.AFrameworkApplication.da.pa("IsO365CommercialHost")||na.AFrameworkApplication.da.pa("IsO365ConsumerHost")}}
Object(da.a)(pg,"LokiTokenManager",null,[657]);var Wg=a(528);class ih{get name(){return"Common.App.LivePersonaUtils"}init(){Ja.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}Xj(D){D.register(pg,"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").Ee().Le(()=>new pg(Wg.a.ar(D.Qd("Common.App.OAuth.IOAuthManager"))))}static main(){Sb.a.instance.Tk(new ih)}}Object(da.a)(ih,"LivePersonaUtilsPackage",null,[2,3]);class Ah{constructor(D){this.oka=this.hka=this.tka=this.ska=
null;this.Ake=this.jie=this.Bke=this.aoe=this.Rz=this.bP=!1;this.E_c=this.soe=null;this.ioe=0;this.Oa=this.poe=null;this.L5=D;this.Nz=3;this.f1a=!0}initialize(D,ha,fb){this.ska=this.qsd(D,ha);this.tka=CommonUIStrings.l_SavingStatus;this.hka=CommonUIStrings.l_ReadOnlyStatus;this.oka=CommonUIStrings.l_ReviewModeStatus;this.L5&&this.L5.execute(Vb=>{Vb.F5c(Object(La.a)(this,this.lYb,"updateToSavingStatus"))});this.Rz=!0;this.Oa=fb;this.jie=this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",
!1);return!0}Tia(D,ha){this.bP=D;this.Nz=ha;this.QV(this.f1a)}QV(D){!this.f1a&&D&&(this.poe=new Date);this.f1a=D;this.Ake=!1;D=null;3===this.Nz&&(D=this.f1a?this.ska:this.tka);this.LAh(D)}qsd(D,ha){return D?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):ha&&ha.length?String.format(CommonUIStrings.l_SavedToStatus,ha):CommonUIStrings.l_SavedStatus}lYb(){this.QV(!1)}cbi(){switch(this.Nz){case 1:return this.hka;case 2:return this.oka;default:return null}}getMode(){if(3!==
this.Nz)switch(this.Nz){case 1:return"ReadOnly";case 2:return"ReviewOnly";default:return null}return this.Ake?"FailedToSave":this.f1a?"Saved":"Saving"}wDi(D){return this.aoe===this.bP&&this.ioe===this.Nz&&this.soe===D}lhd(D){appChrome.getHeaderApi().then(ha=>{ha.updateDocumentTitleStatus(this.bP,D,this.cbi(),this.poe,this.f1a,this.jie?ha.getHeaderSaveStatusIconProps(this.getMode()):null);this.Bke=!0;return null});this.E_c=null}LAh(D){this.Rz&&ob.c()&&!this.wDi(D)&&(!this.Bke&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",
!1)?this.lhd(D):wh.a.lXd()?(this.E_c&&ba.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.E_c=window.requestIdleCallback(()=>{this.lhd(D)})):window.requestAnimationFrame(()=>{this.lhd(D)}),this.aoe=this.bP,this.soe=D,this.ioe=this.Nz)}}Object(da.a)(Ah,"ReactSaveStatusUIHandler",null,[682]);class ki{constructor(D,ha){this.uq=null;this.ska=CommonUIStrings.l_SavedStatus;this.tka=CommonUIStrings.l_SavingStatus;this.hka=CommonUIStrings.l_ReadOnlyStatus;
this.oka=CommonUIStrings.l_ReviewModeStatus;this.t1b=ha;this.L5=D;this.Nz=3;this.cwa=!0}uw(){this.L5&&this.L5.execute(D=>{D.F5c(Object(La.a)(this,this.lYb,"updateToSavingStatus"))});this.t1b.execute(D=>{this.uq=D})}Tia(D,ha){this.Nz=ha;3===ha?this.QV(this.cwa):2===ha?this.x9d(this.oka):this.x9d(this.hka)}lYb(){this.QV(!1)}QV(D){this.cwa=D;this.x9d(this.cwa?this.ska:this.tka)}x9d(D){this.uq&&this.uq.sendMessage(ag.a.rek,this.wlh(D))}wlh(D){const ha={};ha.StatusText=D;return ha}}Object(da.a)(ki,"SaveStatusPostMessageHandler",
null,[682]);var ai=a(136),fg=a(61);class Bi{constructor(D,ha,fb,Vb){this.oka=this.hka=this.tka=this.ska=null;this.nJa=0;this.cH=this.r0c=this.AHa=this.OPc=this.mKa=null;this.Xf=D;this.oca=ha;this.L5=fb;this.Xl=Vb;this.pme=!0;this.bP=!1;this.Nz=3;this.cwa=!0}initialize(D,ha){if(!this.Xf)return!1;this.ska=this.qsd(D,ha);this.tka=CommonUIStrings.l_SavingStatus;this.hka=CommonUIStrings.l_ReadOnlyStatus;this.oka=CommonUIStrings.l_ReviewModeStatus;this.uw();return!0}qsd(D,ha){return D?String.format(CommonUIStrings.l_SavedToStatus,
CommonUIStrings.l_OneDriveName):ha&&ha.length?String.format(CommonUIStrings.l_SavedToStatus,ha):CommonUIStrings.l_SavedStatus}uw(){this.oca&&this.oca.execute(D=>{D.R_g(Object(La.a)(this,this.qUe,"createStatusAndModeElements"));D.K_g(Object(La.a)(this,this.n0j,"showHideSaveStatusElement"));D.Nak&&this.qUe(null,null)});this.L5&&this.L5.execute(D=>{D.F5c(Object(La.a)(this,this.lYb,"updateToSavingStatus"))})}vy(){this.cH&&this.Xf&&this.Xf.jJ(this.cH)}n0j(D,ha){this.Tia("true"===ha,this.Nz)}Tia(D,ha){this.bP=
D;this.Nz=ha;this.OPc&&(this.OPc.style.display=this.bP||3===this.Nz||!this.mKa?"none":"");this.AHa&&(this.AHa.style.display=this.bP||3===this.Nz?"none":"",this.AHa.innerText=1===this.Nz?this.hka:this.oka,this.AHa.title=1===this.Nz?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.r0c&&(this.r0c.style.display=this.bP||1===this.Nz||!this.mKa&&!this.AHa?"none":"");this.cH&&(this.cH.style.display=this.bP||1===this.Nz?"none":"",this.QV(this.cwa),this.cH.title=CommonUIStrings.l_SaveStatusTooltip)}qUe(D,
ha){D=document.getElementById(hh.CuiHelper.Lmf);ha&&ha.Fok||!D||""===this.ska||""===this.tka||""===this.hka||""===this.oka||(this.mKa=document.getElementById(hh.CuiHelper.s$b),this.OPc=hh.CuiHelper.Zxa(D,"BreadcrumbAppModeDash","-",null,!1),this.AHa=hh.CuiHelper.Zxa(D,"BreadcrumbAppModeStatus",1===this.Nz?this.hka:this.oka,null,!1),this.ovg(this.AHa),this.r0c=hh.CuiHelper.Zxa(D,"BreadcrumbSaveStatusDash","-",null,!1),this.cH=hh.CuiHelper.Zxa(D,"BreadcrumbSaveStatus",this.ska,null,!1),this.ovg(this.cH),
this.Tia(this.bP,this.Nz))}lYb(){this.QV(!1)}QV(D){this.cwa=D;this.Ejk(this.cwa?this.ska:this.tka)}Ejk(D){!this.cH||3!==this.Nz&&2!==this.Nz||(this.pme&&!this.cwa?(this.nJa=this.cH.offsetWidth<this.nJa?this.nJa:this.cH.offsetWidth,this.ygk(this.tka),this.pme=!1):this.cH.innerText=D)}ovg(D){D.style.direction=this.Xl?"rtl":"ltr";D.style.width="auto";D.style.textAlign=this.Xl?"right":"left";D.style.display=this.bP?"none":"";D.setAttribute("Unselectable","on")}ygk(D){this.cH&&(this.cH.style.width="",
this.cH.innerText=D,this.nJa=this.cH.offsetWidth<this.nJa?this.nJa:this.cH.offsetWidth,D=ai.a.aC(this.cH),this.cH.style.width=this.nJa-fg.a.tG(D.paddingLeft)-fg.a.tG(D.paddingRight)+1+"px")}}Object(da.a)(Bi,"SaveStatusUIHandler",null,[682]);var Wi=a(100);class Pi{constructor(){this.s0c=this.q_c=this.ksb=this.hd=null}get name(){return"Common.App.SaveStatus"}Xj(D){this.hd=D;na.AFrameworkApplication.da.pa("PostMessageEmbedded")&&na.AFrameworkApplication.hideHeaderEmbedded?this.hd.register(ki,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Ee().Le(()=>
new ki(this.hd.Qd("Common.App.HostNotification.EditNotificationEventSource"),this.hd.Qd("Postmessage.IHostPostmessenger"))):na.AFrameworkApplication.sa.Ra.Jxf||(na.AFrameworkApplication.sa.Ra.kw?this.hd.register(Ah,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Ee().Le(()=>new Ah(this.hd.Qd("Common.App.HostNotification.EditNotificationEventSource"))):this.hd.register(Bi,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Ee().Le(()=>
new Bi(Wi.EventHandlerManager.instance,this.hd.Qd("Common.App.Header.HeaderEventSource"),this.hd.Qd("Common.App.HostNotification.EditNotificationEventSource"),na.AFrameworkApplication.isRtl)))}init(){na.AFrameworkApplication.da.qx(Object(La.a)(this,this.iE,"onFullAppSettingsReady"))}iE(){const D=na.AFrameworkApplication.da,ha=!!na.AFrameworkApplication.sa.Ra&&4===na.AFrameworkApplication.sa.Ra.kj;if(D.pa("WordEditorAutoSaveImprovementIsEnabled")||D.pa("PptEditorSaveStatusInHeaderEnabled")||ha&&D.pa("SimplifiedReactRibbonUxIsEnabled")||
D.pa("ExcelSaveStatusInHeaderEnabled")||D.pa("VisioSaveStatusInHeaderEnabled"))na.AFrameworkApplication.da.pa("PostMessageEmbedded")&&na.AFrameworkApplication.hideHeaderEmbedded?(this.s0c=this.hd.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.s0c.uw():na.AFrameworkApplication.sa.Ra.Jxf||na.AFrameworkApplication.hideHeader||(na.AFrameworkApplication.sa.Ra.kw?(this.q_c=this.hd.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.q_c.initialize(D.pa("IsSkyDrive"),D.Sa("HostNameToIncludeInSavedStatus"),
na.AFrameworkApplication.da):(this.ksb=this.hd.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.ksb.initialize(D.pa("IsSkyDrive"),D.Sa("HostNameToIncludeInSavedStatus")))}dispose(){this.ksb&&this.ksb.vy()}}Object(da.a)(Pi,"PackageManager",null,[2,3]);var Qi=a(236),zh=a(34);class Ri{constructor(D,ha){this.nue=this.xVc=!1;this.JDa=(fb,Vb)=>{(null===Vb||void 0===Vb?0:Vb.qK)&&zh.a.U4g([Vb.qK])&&(this.cTb=!0)};this.yp=()=>{this.cTb=!1};this.ff=(fb,Vb)=>{Qi.b(Vb)&&this.Tia(!0);this.cTb=!1};this.wf=
()=>{this.nU=this.$.nU;this.Tia()};this.pTf=()=>{this.QV()};this.wSf=()=>{this.nU=this.$.nU};this.fMd=()=>{$a.h(this.$).ya.Bs(this.fMd);this.nU=this.$.nU};this.Nbg=ha;this.$=D;this.$.userOperationManager.Pr(this.wSf);this.$.Zm(this.wf);this.$.ea.q0g(this.pTf);this.$.ea.Zl(this.ff);this.$.a8b(this.JDa);this.$.ea.BM(this.yp);this.Tia()}get iOi(){return this.$.ea?this.$.ea.vAf:!1}get nU(){return this.xVc}set nU(D){D?this.xVc=!0:$a.h(this.$)&&$a.h(this.$).ya&&($a.h(this.$).ya.k9()?this.xVc=!1:$a.h(this.$).ya.Ws(this.fMd));
this.QV()}get cTb(){return this.nue}set cTb(D){this.nue=D;this.QV()}dispose(){this.$&&(this.$.co(this.wf),this.$.tDc(this.JDa),this.$.userOperationManager&&this.$.userOperationManager.Ap(this.wSf),this.$.ea&&(this.$.ea.PCj(this.pTf),this.$.ea.gm(this.ff),this.$.ea.rR(this.yp)),$a.h(this.$)&&$a.h(this.$).ya&&$a.h(this.$).ya.Bs(this.fMd))}Tia(D){D=!this.$.isEditMode||(void 0===D?!1:D);this.Nbg.Tia(D,this.$.isEditMode?3:1);this.QV()}QV(){this.$.isEditMode&&this.Nbg.QV(!this.nU&&!this.iOi&&!this.cTb)}}
Object(da.a)(Ri,"SaveStatusManager",null,[5]);class Jg extends Ta.a{constructor(D){super();this.pf=D;this.je()}create(){const D=Ja.a.instance;D.Qd("Common.App.SaveStatus.ISaveStatusUIHandler").execute(ha=>{const fb=new Ri(this.pf,ha);D.register(Ri,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").Ee().Le(()=>fb);ha=Object(sc.a)(this.pf.ga,300,()=>D.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"));this.Ld(ha)})}static la(D){D.ga.Qa(299,new Jg(D))}}Object(da.a)(Jg,
"SaveStatusFactory",Ta.a,[]);var hj=a(952),Ci=a(585);class ij extends Sys.EventArgs{constructor(){super()}}Object(da.a)(ij,"NumberFormatsUpdatedEventArgs",Sys.EventArgs,[]);var yi=a(40),Th=a(630),Uh=a(165);class lj{constructor(D){this.data=D}}Object(da.a)(lj,"NumberFormatDataHolder",null,[]);var pi=a(212),jh=a(279);class Qe extends qb.a{constructor(D,ha){super();this.fFd=Wa.a.lg;this.b$c=null;this.Pmb=this.rtc=!1;this.JKf=(fb,Vb)=>{var Gc;(fb=$a.h(this.$))&&(Vb=null!==(Gc=Vb.cell)&&void 0!==Gc?Gc:
fb.Hd(null))&&this.zta(Vb.cell.Ei,!0)};this.p8i=fb=>{this.isActive()&&(zh.a.Rr(fb.Errors)||!fb.Result?(fb=fb.Errors?fb.Errors.map(Vb=>JSON.stringify(Vb)).join(","):"None",ba.ULS.sendTraceTag(537155726,0,50,`GetCategoryFromServer failed, ignoring - server errors: ${fb}`)):(fb=fb.Result,ba.ULS.sendTraceTag(537155725,0,50,`Updating number format category cache, format index = ${fb.Index}, category = ${fb.Category}`),this.jSj(fb.Index,fb.Category),this.raiseEvent(Qe.P$c,new hj.a(fb.Index,fb.Category),
this)))};this.refresh=()=>{ba.ULS.sendTraceTag(537155722,0,50,"InstantaneousSupportInformationManager.Refresh: start refresh");this.oac();this.isActive()&&this.ea.te.allowEdits&&(this.Pmb||this.Tq&&!(this.ea.rI>this.fFd)?this.SNc():(ba.ULS.sendTraceTag(537155721,0,50,"InstantaneousSupportInformationManager.Refresh: getting instantaneous support information."),this.Wqd=Ci.a(this.$.qa.ua,this.Tq?this.Tq.Digest:"",this.Z8i,this.Y8i,null,null)),ba.ULS.sendTraceTag(537155720,0,50,"InstantaneousSupportInformationManager.Refresh: getting functions info."),
this.vdf())};this.iPf=fb=>{ba.ULS.sendTraceTag(537155716,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListFailed failed, status = ${fb.data.status}, HTTP status = ${fb.data.httpStatus}.`);this.QPa=null};this.J3=()=>{this.Pmb=!1;this.ea.OI(this.J3);this.oXa(this.rtc?Qe.D2d:Qe.PKd)};this.ff=(fb,Vb)=>{ba.ULS.sendTraceTag(537155715,0,50,"InstantaneousSupportInformationManager.OnSessionIdChanged called");Qi.a(Vb)&&this.oXa(Qe.D2d)};this.Nh=()=>{ba.ULS.sendTraceTag(537155714,0,50,"InstantaneousSupportInformationManager.OnWorkbookMetadataChanged called");
3!==this.$.workbookContext.CalcMode&&this.$Kd(0===this.$.workbookContext.CalcMode)};this.wf=()=>{ba.ULS.sendTraceTag(537155713,0,50,"InstantaneousSupportInformationManager.OnWorkbookOpened called");this.oXa(Qe.D2d);3!==this.$.workbookContext.CalcMode&&this.$Kd(0===this.$.workbookContext.CalcMode)};this.R8i=(fb,Vb,Gc)=>{ba.ULS.sendTraceTag(537155712,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess called.");this.QPa=null;this.isActive()?fb.StateId===Wa.a.lg?(ba.ULS.sendTraceTag(537155682,
0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: no session, waiting for session."),this.SNc()):!fb.Result||this.g0&&this.g0.length?this.oXa(Qe.PKd):this.RSf(fb,Vb,Gc):ba.ULS.sendTraceTag(537155683,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: manager is inactive, skipping.")};this.RSf=fb=>{this.g0=fb.Result;ba.ULS.sendTraceTag(537155681,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListSuccess refreshing functions info list, returned ${this.g0?
this.g0.length:-1} functions.`);fb=!1;if(this.g0){for(const Vb of this.g0)Vb&&(this.N9e[Vb.NameUI.toLocaleUpperCase()]=Vb.FunctionIndex.toString(),Vb.NameUI!==Vb.NameDataStrings&&(this.N9e[Vb.NameDataStrings.toLocaleUpperCase()]=Vb.FunctionIndex.toString(),fb=!0),this.tZh.fa(Vb.FunctionIndex,Vb.NameUI));this.raiseEvent(Qe.Qnd,Sys.EventArgs.Empty,this)}fb&&ba.ULS.sendTraceTag(537155680,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess NameDataStrings functions names were used.")};
this.Z8i=fb=>{if(this.isActive())if(ba.ULS.shipAssertTag(537155679,0,!!this.$,"null ewaControl"),this.rtc=!1,this.fFd=fb.StateId,this.fFd===Wa.a.lg)this.rtc=!0,this.SNc();else{if(fb.Result){var Vb=this.Tq;this.Tq=fb.Result;ba.ULS.sendTraceTag(537155678,0,50,`InstantaneousSupportInformation updated, new result digest: ${this.Tq.Digest}.`);fb=[];if(Vb)fb=Qe.fbi(Vb.NumberFormats,this.Tq.NumberFormats);else for(Vb=0;Vb<this.Tq.NumberFormats.length;Vb++)this.Nwc.fa(Vb,this.Tq.NumberFormats[Vb].NumberFormatCategory);
for(const Gc of fb)this.Nwc.fa(Gc,this.Tq.NumberFormats[Gc].NumberFormatCategory);this.raiseEvent(Qe.qLd,new ij(fb),this);this.raiseEvent(Qe.hCf)}this.oXa(Qe.PKd)}};this.Y8i=fb=>{this.isActive()&&(10===fb.data.status?ba.ULS.sendTraceTag(537155677,0,50,"Instantaneous support information request cancelled."):(ba.ULS.sendTraceTag(21311555,0,10,`Failed to update instantaneous support information, status = ${fb.data.status}, HTTP status = ${fb.data.httpStatus}.`),this.rtc=!0,this.SNc()))};ba.ULS.sendTraceTag(537155737,
0,50,"InstantaneousSupportInformationManager ctor start");this.ea=D;this.$=ha;this.Tq=this.QPa=this.Wqd=this.OQb=null;this.Nwc=new pi.a;this.XCb=new pi.a;this.g0=[];this.tZh=new pi.a;this.N9e={};this.ea.Zl(this.ff);this.$.Zm(this.wf);$a.h(this.$).ha.Rwa(this.JKf);this.ea.Mw(this.Nh);this.oXa(Qe.Lof);ba.ULS.sendTraceTag(537155736,0,50,"InstantaneousSupportInformationManager ctor end")}vCe(D){this.addHandler(Qe.qLd,D)}ZVd(D){this.removeHandler(Qe.qLd,D)}BYg(D){this.addHandler(Qe.P$c,D)}CAj(D){this.removeHandler(Qe.P$c,
D)}bCe(D){this.addHandler(Qe.Qnd,D)}LVd(D){this.removeHandler(Qe.Qnd,D)}j_g(D){this.addHandler(Qe.hCf,D)}get hh(){return this.Tq?this.Tq.LocaleInformation:null}get $Ca(){return this.Tq?this.Tq.NumberFormats:[]}get Gna(){this.g0&&this.g0.length||this.vdf();return this.g0}get Syi(){return this.Tq&&void 0!==this.Tq.InstantaneousCalcWebWorkerPrecisionSamplingRate&&null!==this.Tq.InstantaneousCalcWebWorkerPrecisionSamplingRate?this.Tq.InstantaneousCalcWebWorkerPrecisionSamplingRate:Qe.bxh}get Vyi(){return this.Tq&&
void 0!==this.Tq.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate&&null!==this.Tq.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate?this.Tq.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate:Qe.fxh}get Uyi(){return this.Tq&&void 0!==this.Tq.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate&&null!==this.Tq.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate?this.Tq.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate:Qe.exh}get Tyi(){return this.Tq&&void 0!==this.Tq.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate&&
null!==this.Tq.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate?this.Tq.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate:Qe.dxh}get lyd(){return this.Tq?this.Tq.InstantaneousCalcWebWorkerRenderingTimeLimitInMs:Qe.cxh}get Ooc(){return null!==this.b$c?this.b$c:!1}udk(D){let ha;if(!D)return{returnValue:!0,category:"General"};let fb;ha="";if(!(()=>{let Vb=this.zta(D,!1);({category:fb}=Vb);return Vb})().returnValue)return{returnValue:!1,category:ha};ha=this.Nmh(fb);return{returnValue:!0,
category:ha}}Nmh(D){let ha="";switch(D){case 0:ha="General";break;case 1:ha="Number";break;case 2:ha="Currency";break;case 3:ha="Accounting";break;case 4:ha="Date";break;case 5:ha="Time";break;case 6:ha="Percentage";break;case 7:ha="Fraction";break;case 8:ha="Scientific";break;case 9:ha="Text";break;case 10:ha="Special";break;case 11:ha="Custom"}return ha}zta(D,ha){let fb,Vb=(()=>{let Gc=this.Nwc.kf(D,0);({value:fb}=Gc);return Gc})().returnValue;!Vb&&0<D&&this.$&&(ba.ULS.sendTraceTag(537155735,0,
50,`InstantaneousSupportInformationManager.TryGetNumberFormatCategory: failed to get category from numberFormatIndexToCategoryCache ${D}`),this.S3h(D),ha&&(fb=this.R3h(D),Vb=!0),Th.a(D,this.$.GG)&&(fb=6));return{returnValue:Vb,category:fb}}PEi(D){let ha=0;if((()=>{let fb=this.zta(D,!0);({category:ha}=fb);return fb})().returnValue)return 6===ha;ba.ULS.sendTraceTag(537155733,0,50,`InstantaneousSupportInformationManager.IsFormatInPercentageCategory: failed to get category from format index ${D}`);return!1}$Xh(D){ba.ULS.sendTraceTag(537155730,
0,50,"InstantaneousSupportInformationManager.ForceRefreshFunctionInfo: Forcing refresh of functions");this.QPa=be.o(this.$.qa.ua,{FilterType:0},Bd.b(this.RSf,D),this.iPf,null,null,null)}Y8e(){this.oXa(Qe.Lof)}fqh(){return ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LocalizedErrorNames",!1)?Object(jh.c)(this.hh.ErrorNames)?(ba.ULS.shipAssertTag(508699781,0,!1,"ErrorNames undefined"),this.dcf()):this.hh.ErrorNames.map((D,ha)=>excelOnlineCalc.calc.errorTypeName(ha+1,D)):this.dcf()}dcf(){const D=
[],ha=Object.keys(Wa.a.errorNames);for(let fb=0;fb<ha.length;fb++){const Vb=excelOnlineCalc.calc.errorTypeName(fb+1,ha[fb]);Vb&&D.push(Vb)}return D}$Kd(D){this.b$c=D}S3h(D){if(this.XCb&&this.$){var ha;if(!(()=>{let Vb=this.XCb.kf(D);({value:ha}=Vb);return Vb})().returnValue||ha.isCompleted){ba.ULS.sendTraceTag(537155728,0,50,`Getting number format category for format index: ${D}`);var fb=Ci.c(this.$.qa.ua,D,this.p8i,null,null,null);fb&&this.XCb.fa(D,fb)}}else ba.ULS.sendTraceTag(537155729,0,15,"GetCategoryFromServerAsync called on disposed InstantaneousSupportInformationManager instance, skipping")}R3h(D){return 1<=
D&&8>=D?1:9<=D&&12>=D?2:13===D||14===D?6:15===D?8:17===D|18===D?7:19===D?4:16===D||20<=D&&29>=D||31===D?11:30===D?9:32<=D&&35>=D?3:0}isActive(){const D=void 0===this.ea||null===this.ea,ha=!D&&this.ea.oe;ba.ULS.sendTraceTag(537155727,0,50,`InstantaneousSupportInformationManager.IsActive: instantaneous support information manager active:${ha} - sessionStateManager IsNullOrUndefined: ${D}`);return ha}jSj(D,ha){this.Nwc.fa(D,ha)}dispose(){oc.a.Ma(this.OQb);this.OQb=null;this.oac();for(let D of this.XCb){const ha=
D.value;ha&&!ha.isCompleted&&na.AFrameworkApplication.tf.Gx(ha.Qw)}this.XCb=null;this.ea&&(this.ea.gm(this.ff),this.Pmb&&this.ea.OI(this.J3),this.Pmb=!1,this.ea.ny(this.Nh));this.ea=null;this.$&&$a.h(this.$)&&$a.h(this.$).ha&&($a.h(this.$).ha.Jra(this.JKf),this.$.co(this.wf));this.$=null;super.dispose()}isFeatureEnabled(D){try{switch(D){case "LocaleLongDateFormat":return ib.EwaSettings.Ea(184);case "GetLocaleDayNames":return ib.EwaSettings.Ea(185);case "CalculateTextWidthIgnoreLetterSpacing":return ib.EwaSettings.Ea(255);
case "OfficeVSO:3657744_CalcFixForDateFormat":return ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3657744_CalcFixForDateFormat");case "OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero":return ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero");case "CalcAutocompleteExperiment":return ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1);case "CalcWebWorker":return!0;case "CalcPreventSpillingHack":return ib.EwaSettings.isChangeGateEnabled("OfficeVSO:7504597_calcPreventSpillingHack");
case "CalcDynamicArrayOperators":return ib.EwaSettings.Ea(101);default:return D.startsWith("OfficeVSO:")?ib.EwaSettings.isChangeGateEnabled(D):!1}}catch(ha){return ba.ULS.sendTraceTag(537155724,0,15,`InstantaneousSupportInformation.IsFeatureEnabled(${D}): feature parsing failed, returning false. Exception: ${ha.toString()}.`),!1}}oXa(D){this.isActive()&&this.ea.te.allowEdits?(oc.a.Ma(this.OQb),this.OQb=null,this.OQb=W.a.instance.create(this.refresh,D,ed.a.Wyi)):ba.ULS.sendTraceTag(537155723,0,50,
`InstantaneousSupportInformationManager.ScheduleRefresh: won't schedule refresh. Edit permission: AllowEdits ${void 0!==this.ea&&null!==this.ea&&void 0!==this.ea.te&&null!==this.ea.te?this.ea.te.allowEdits:!1}, IsEditMode ${void 0===this.ea||null===this.ea?!1:this.$.ea.isEditMode}`)}vdf(){ba.ULS.sendTraceTag(537155719,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync called.");this.QPa?ba.ULS.sendTraceTag(537155718,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync already running, skipping."):
this.isActive()?this.g0&&this.g0.length||(this.QPa=be.o(this.$.qa.ua,{FilterType:0},this.R8i,this.iPf,null,null,null)):ba.ULS.sendTraceTag(537155717,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync session is not yet active, skipping.")}SNc(){this.Pmb||(this.Pmb=!0,this.ea.jH(this.J3))}oac(){this.Gx(this.Wqd);this.Gx(this.QPa);this.QPa=this.Wqd=null}Gx(D){D&&!D.isCompleted&&this.$.qa.ua.Mlb(D.Qw)}static fbi(D,ha){if(!D||!D.length)return[];if(!ha||!ha.length){var fb=Array(D.length);
for(var Vb=0;Vb<D.length;++Vb)fb[Vb]=D[Vb].IfmtIndex;return fb}fb=new pi.a;for(var Gc of D)fb.fa(Gc.IfmtIndex,new lj(Gc));D=new Ub.a;for(Vb of ha)Gc=fb.kf(Vb.IfmtIndex),{value:ha}=Gc,Gc.returnValue&&ha.data.FormatString===Vb.FormatString||D.add(Vb.IfmtIndex);return D.toArray()}}Qe.qLd="isim0";Qe.P$c="isim1";Qe.Qnd="isim2";Qe.hCf="isim3";Qe.Lof=100;Qe.D2d=1E3;Qe.PKd=3E5;Qe.bxh=.001;Qe.fxh=.1;Qe.exh=.2;Qe.dxh=.001;Qe.cxh=50;Object(da.a)(Qe,"InstantaneousSupportInformationManager",qb.a,[666,5]);class F extends Ta.a{constructor(D){super();
this.$=D;this.je()}create(){if(this.$){ba.ULS.sendTraceTag(537155672,0,50,"InstantaneousSupportInformationManagerFactory.Create: Start loading script");var D=Object(sc.a)(this.$.ga,268,()=>new Qe(this.$.ea,this.$));this.Ld(D)}}static la(D){if(!D)throw Error.argumentNull("ewaControl");D.ga.Qa(246,new F(D))}}Object(da.a)(F,"InstantaneousSupportInformationManagerFactory",Ta.a,[]);var ea=a(113);class Ma{}Ma.local="Local";Ma.t9j="Thread";Object(da.a)(Ma,"RecalcServiceCreateMode",null,[]);var Cb=a(190);
class mc{constructor(D){this.Dge=null;this.init(D)}get Vda(){return this.Dge}init(D){this.Dge=new pi.a;if(void 0!==D&&null!==D&&void 0!==D.HeadersList&&null!==D.HeadersList&&0<D.HeadersList.length)for(const ha of D.HeadersList)this.Vda.fa(ha.Index,ha.Name)}}Object(da.a)(mc,"ColHeadersListData",null,[]);var Pc=a(107);class Rc{constructor(D,ha){this.tKe=D;this.sheetName=ha;this.OTb=!1}}Object(da.a)(Rc,"CalcBlockInformation",null,[]);class ud{constructor(D,ha,fb,Vb,Gc){this.type=D;this.fullName=ha;this.range=
fb;this.sheetId=Vb;this.attributes=Gc;this.BH=null}}Object(da.a)(ud,"CalcNamedObject",null,[]);class od{get sm(){return this.mve}constructor(D){this.mxg=D;this.mve=[];this.d$d=[];this.A5a={};this.t2d=new Map}Tgg(D,ha){this.mve[D]=ha;this.mxg&&ha.Zaa&&this.t2d.set(ha.Zaa.sheetName,D)}getSheetIndex(D){if(this.mxg){if(this.t2d.has(D))return this.t2d.get(D)}else for(let ha=1;ha<this.sm.length;ha++)if(ge.a.equals(this.sm[ha].Zaa.sheetName,D,!1))return ha;return-1}}Object(da.a)(od,"GridCache",null,[]);
var Ed=a(712),oe=a(563);class Ne{constructor(D){this.Zaa=D;this.q$=new Ed.a(oe.a.Fh());this.nwc=!1}}Object(da.a)(Ne,"SheetInformation",null,[]);var ef=a(999),Mf;(function(D){D[D.initialization=0]="initialization";D[D.contentReady=1]="contentReady";D[D.cellEdit=2]="cellEdit"})(Mf||(Mf={}));Object(da.b)("UpdateDataTrigger",Mf);class nf{constructor(D){this.JTd=null;this.nGd=this.ITd=this.dOd=!1;this.JRd=0;this.BRd=this.DRd=this.ERd=this.CRd=-1;this.trueName="TRUE";this.falseName="FALSE";this.instantaneousSupportInformationManager=
this.Gr=null;this.av=this.currentStateId=-1;this.lya="";this.mea=null;this.getNameLoc=(ha,fb)=>this.Yqc()?this.fh.ma(this.currentStateId).sm[0].q$.kd(fb)?(ha=excelOnlineCalc.location.nameLoc(ha,fb),excelOnlineCalc.util.success(ha)):excelOnlineCalc.util.success(null):(ha=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ha));this.getContainingTable=ha=>{if(!this.Yqc())return ha=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ha);const fb=ha.range.col,Vb=ha.range.row;
var Gc=this.fh.ma(this.currentStateId).sm[0].q$,zd=null;for(let ae of Gc)if(Gc=ae.value,2===Gc.type&&ge.a.equals(ha.sheet.index.toString(),Gc.sheetId,!0)){const He=Gc.range;fb>=He.left-1&&fb<=He.right-1&&Vb<=He.bottom-1&&Vb>=He.top-1&&(zd=excelOnlineCalc.location.nameScope(this.documentLoc,Gc.sheetId),zd=excelOnlineCalc.location.nameLoc(zd,Gc.fullName))}return zd?excelOnlineCalc.util.success(zd):excelOnlineCalc.util.success(null)};this.getStructRefColumn=(ha,fb)=>{if(!this.Yqc()){var Vb=excelOnlineCalc.util.unavailable([2]);
return excelOnlineCalc.util.failure(Vb)}Vb=ha.name;var Gc=this.fh.ma(this.currentStateId).sm[0].q$;if(Gc.kd(Vb)){Gc=Gc.ma(Vb);const ae=Gc.range;if(2!==Gc.type)return excelOnlineCalc.util.failure(this.ved(5));const He=Gc.BH?Gc.BH.Vda:null;if(!He)return excelOnlineCalc.util.success(null);for(var zd of He)if(ge.a.equals(zd.value,fb,!0))return ha=excelOnlineCalc.location.documentLoc(ha.scope.document.path,ha.scope.document.name),ha=excelOnlineCalc.location.sheetIndex(ha,Gc.sheetId),zd=excelOnlineCalc.location.gridRange(ae.top-
1,zd.key,ae.bottom-ae.top+1,1),zd=excelOnlineCalc.location.sheetGridRange(ha,zd),Vb=excelOnlineCalc.location.structRefColumnLoc(Vb,zd,!!(Gc.attributes&16),!!(Gc.attributes&8)),excelOnlineCalc.util.success(Vb);return ae.right-ae.left+1!==He.count?(Vb=excelOnlineCalc.util.unavailable([17,ha,fb]),excelOnlineCalc.util.failure(Vb)):excelOnlineCalc.util.failure(this.ved(0))}return excelOnlineCalc.util.success(null)};this.getStructRefSpecialRef=(ha,fb)=>{if(!this.Yqc())return fb=excelOnlineCalc.util.unavailable([2]),
excelOnlineCalc.util.failure(fb);var Vb=this.fh.ma(this.currentStateId).sm[0].q$;if(Vb.kd(ha.name)){var Gc=Vb.ma(ha.name);if(2!==Gc.type)return excelOnlineCalc.util.failure(this.ved(5));Vb=!!(Gc.attributes&16);const zd=!!(Gc.attributes&8),ae=Vb?1:0,He=zd?1:0;ha=excelOnlineCalc.location.documentLoc(ha.scope.document.path,ha.scope.document.name);ha=excelOnlineCalc.location.sheetIndex(ha,Gc.sheetId);Gc=Gc.range;let hf={};if(1===fb)hf=excelOnlineCalc.location.gridRange(Gc.top-ae-1,Gc.left-1,Gc.bottom+
He-Gc.top+ae+1,Gc.right-Gc.left+1);else if(2===fb)hf=excelOnlineCalc.location.gridRange(Gc.top-1,Gc.left-1,Gc.bottom-Gc.top+1,Gc.right-Gc.left+1);else if(3===fb)if(Vb)hf=excelOnlineCalc.location.gridRange(Gc.top-2,Gc.left-1,1,Gc.right-Gc.left+1);else return excelOnlineCalc.util.success(null);else if(4===fb)if(zd)hf=excelOnlineCalc.location.gridRange(Gc.bottom,Gc.left-1,1,Gc.right-Gc.left+1);else return excelOnlineCalc.util.success(null);fb=excelOnlineCalc.location.sheetGridRange(ha,hf);return excelOnlineCalc.util.success(fb)}return excelOnlineCalc.util.success(null)};
this.getDocumentLoc=(ha,fb)=>{if((ge.a.equals(ha,this.documentLoc.path,!0)||!ha)&&ge.a.equals(fb,this.documentLoc.name,!0))return excelOnlineCalc.util.success(this.documentLoc);ha=excelOnlineCalc.util.unavailable([0,excelOnlineCalc.location.documentLoc(ha,fb)]);return excelOnlineCalc.util.failure(ha)};this.getSheetIndex=(ha,fb)=>{if(!this.fh.kd(this.currentStateId)||!this.fh.ma(this.currentStateId).sm)return fb=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(fb);ha=this.fh.ma(this.currentStateId).sm;
for(let Vb=1;Vb<ha.length;Vb++)if(ge.a.equals(ha[Vb].Zaa.sheetName,fb,!0))return excelOnlineCalc.util.success(ha[Vb].Zaa.sheetId);return excelOnlineCalc.util.success(null)};this.getSheetName=(ha,fb)=>{if(!this.fh.kd(this.currentStateId)||!this.fh.ma(this.currentStateId).sm)return fb=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(fb);ha=this.fh.ma(this.currentStateId).sm;for(let Vb=1;Vb<ha.length;Vb++)if(ge.a.equals(ha[Vb].Zaa.sheetId,fb,!0))return excelOnlineCalc.util.success(ha[Vb].Zaa.sheetName);
return excelOnlineCalc.util.success(null)};this.getUserDefinedFuncLoc=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetUserDefinedFuncLoc not implemented in main thread"]);this.getSheetRangeIndexes=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetSheetRangeIndexes not implemented in main thread"]);this.KRf=()=>{this.setNumberFormats()};this.wf=()=>{ba.ULS.sendTraceTag(537170081,0,50,"CalcAsyncEngine.OnWorkbookOpened() called");this.fh=new pi.a;this.currentStateId=this.av=-1;this.lya=
"";this.a7a=null;this.ITd=!1;this.Gr&&this.clearCache()};this.pf=D;this.fh=new pi.a;this.a7a=null;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.pf.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.Ata();this.IAd=$b.a.IAd();this.N9=ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetCellEstimationPrefetch",!1)}dispose(){this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.ZVd(this.KRf);this.pf&&this.pf.co(this.wf);this.close()}SXb(D){if(!this.Gr)return!1;
if(!this.instantaneousSupportInformationManager&&(this.instantaneousSupportInformationManager=this.pf.ga.Da(268),!this.instantaneousSupportInformationManager))return ba.ULS.sendTraceTag(537170198,0,50,"CalcAsyncEngine.UpdateData Failed to get instantaneousSupportInformationManager"),!1;2!==D&&(this.currentStateId=this.pf.ea.rI,this.currentStateId===Wa.a.lg&&(this.currentStateId=this.pf.ea.xg));if(1===D&&this.currentStateId<this.av)return ba.ULS.sendTraceTag(537170197,0,50,`CalcAsyncEngine::UpdateData() currentStateId:${this.currentStateId} < lastUpdatedStateId:${this.av} - ignoring update`),
!1;this.VPj();0!==D&&this.ITd||(this.uUj(),this.zRj(),this.oSj(),this.setNumberFormats(),this.instantaneousSupportInformationManager.vCe(this.KRf),this.pf.Zm(this.wf),this.ITd=!0);this.Wuj();let ha=!1;0===D&&(ha=this.Dwi());if(0!==D||ha)this.HTj()?(this.hUj(D),this.gUj(),this.av=this.currentStateId,this.Jgh()):ba.ULS.sendTraceTag(537170196,0,15,`CalcAsyncEngine::UpdateData() for StateId:${this.currentStateId} failed - no Sheets information`);2!==D&&this.resumeRecalc();return!0}evalFormula(D,ha,fb,
Vb){if(!this.Gr)return ba.ULS.sendTraceTag(537170195,0,15,"CalcAsyncEngine.EvalFormula: recalc engine is null"),Promise.resolve({});ha=excelOnlineCalc.calc.sheetCellLocation(null!==fb&&void 0!==fb?fb:yf.d(this.pf.va.na),ha.top-1,ha.left-1);D=this.Gr.evalFormula(this.pf.ea.xg,D,ha,Vb);this.resumeRecalc();return D}vch(D,ha,fb,Vb){Vb=void 0===Vb?null:Vb;const Gc=yf.d(this.pf.va.na);let zd=D.cell.hI-1,ae=D.cell.gI-1;var He=zd,hf=ae;let zf=null;Vb&&(zf=excelOnlineCalc.calc.cellLocation(zd,ae),zd=Vb.top-
1,ae=Vb.left-1,He=Vb.bottom-1,hf=Vb.right-1);fb=this.qNc(D,fb,"SetCell");0>fb||(hf=nf.B7("CalculateFormula.cell",Gc,zd,ae,He,hf),He=[],Vb=this.amc(Gc),ha=excelOnlineCalc.calc.inferredRangeFormulaEdit(hf,ha,zf,Vb),He.push(ha),D=(ha=this.Gtd())?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",Gc,zd,ae,ge.a.xEe(D.cell.text),fb,ha.top-1,ha.left-1,ha.bottom-1,ha.right-1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",
Gc,zd,ae,ge.a.xEe(D.cell.text),fb,"","","",""),ba.ULS.sendTraceTag(537170180,0,50,D),this.Gr.editRangeFormulas(fb,He),this.resumeRecalc())}wch(D,ha){const fb=[];var Vb=yf.d(this.pf.va.na),Gc=this.amc(Vb);ha=this.qNc(D[0].pea,ha,"SetCellBatched");if(0>ha)return!1;for(var zd of D){var ae=zd.pea.cell.hI-1,He=zd.pea.cell.gI-1;ae=nf.B7("CalculateFormulaBatched.cell",Vb,ae,He,ae,He);ae=excelOnlineCalc.calc.inferredRangeFormulaEdit(ae,zd.editText,null,Gc);fb.push(ae)}Gc=this.Gtd();zd=D[0].pea.cell.hI-1;
ae=D[0].pea.cell.gI-1;He=D[D.length-1].pea.cell.hI-1;D=D[D.length-1].pea.cell.gI-1;Vb=Gc?String.format("CalcAsyncEngine::CalculateFormulaBatched() for sheet:{0} range:({1},{2},{3},{4}) stateId:{5} viewport:(({6},{7})-({8},{9}))",Vb,zd,ae,He,D,ha,Gc.top-1,Gc.left-1,Gc.bottom-1,Gc.right-1):String.format("CalcAsyncEngine::CalculateFormulaBatched() for sheet:{0} range:({1},{2},{3},{4}) stateId:{5} viewport:(({6},{7})-({8},{9}))",Vb,zd,ae,He,D,ha,"","","","");ba.ULS.sendTraceTag(508932947,0,50,Vb);this.Gr.editRangeFormulas(ha,
fb);this.resumeRecalc();return!0}bY(D,ha,fb,Vb,Gc){if(!this.Gr)return ba.ULS.sendTraceTag(537170179,0,15,"CalcAsyncEngine::EvalFormulaRangeOnClone recalc engine is null"),Promise.reject("RecalcService is null");if(!fb||!ha)return ba.ULS.sendTraceTag(524120779,0,15,`CalcAsyncEngine::EvalFormulaRangeOnClone inputs are null. originCell null: ${!fb}, outputColumnRange null: ${!ha}`),Promise.reject("CalcAsyncEngine::EvalFormulaRangeOnClone: null inputs");ba.ULS.shipAssertTag(537170178,0,fb.isSingle,"CalcAsyncEngine::EvalFormulaRangeOnClone originCell must be a single cell.");
const zd=yf.d(this.pf.va.na),ae=this.amc(zd);let He=null;if(D){He=[];for(const vg of D)if(vg.column!==fb.left){D=vg.row-1;var hf=vg.column-1;D=nf.B7("EvalFormulaRangeOnClone.cell",zd,D,hf,D,hf);hf=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:7459428_TypedValueInCloneWrite")?Df(vg.Cl,vg.formulaBarText,vg.Ei):excelOnlineCalc.calc.valueCellData(vg.text,vg.text,vg.Ei,null);He.push(excelOnlineCalc.calc.rangeWrite(D,hf))}}fb=excelOnlineCalc.calc.cellLocation(fb.top-1,fb.left-1);ha=nf.B7("EvalFormulaRangeOnClone.outputColumnRange",
zd,ha.top-1,ha.left-1,ha.bottom-1,ha.right-1);let zf;Gc?this.N9&&(Vb=[excelOnlineCalc.calc.inferredRangeFormulaEdit(ha,Vb,fb,ae)],zf=this.Gr.evalOnClonedModel(He,Vb,Gc)):(Gc=[excelOnlineCalc.calc.cellFormulaRangeFormulaEdit(ha,Vb,fb,ae)],zf=this.Gr.evalOnClonedModel(He,Gc));this.resumeRecalc();return zf}DUe(D){let ha=null;try{if(D)if(this.lya=$a.h(this.pf).ya.Kna(D),this.currentStateId=D.TFa,this.currentStateId<this.av||this.currentStateId===Wa.a.lg)ba.ULS.sendTraceTag(537170176,0,50,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() hash:${this.lya} blockRevision:${this.currentStateId} < lastUpdatedStateId:${this.av}`);
else{if(this.Jwi(),1===D.Iy.PaneType&&this.tkk(D.na),!this.n8g())if(ha=this.pf.Sd.Ze("ModelUpdate",`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() Block Hash:${this.lya} StateId:${this.currentStateId}`),this.a7a=this.Q8(D.na.sheetName))if($a.h(this.pf).ya.Zq.I7a(D.sf)){var fb=D.uh;if(fb){var Vb=fb.getCalcBlockModel();if(Vb)if(this.f8g(Vb)){this.fh.ma(this.currentStateId).A5a[this.lya]=new Rc(Vb,D.na.sheetName);var Gc=D.Sf;Gc?this.fWg(Gc.NamedObjects):ba.ULS.sendTraceTag(537170144,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel GetGridBlockContentResponse is null")}else ba.ULS.sendTraceTag(509117971,
0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel block is invalid (might be freeze panes removal)");else ba.ULS.sendTraceTag(537170145,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model for block")}else ba.ULS.sendTraceTag(537170146,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model accessor for block:${this.lya}`)}else ba.ULS.sendTraceTag(509117972,0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel skipping block update because renderStateInfo doesn't have the block");
else{const zd=!!(this.pf.If&32),ae=this.fh.kd(this.currentStateId)&&this.fh.ma(this.currentStateId).sm?this.fh.ma(this.currentStateId).sm.length:0;ba.ULS.sendTraceTag(537170147,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel SheetName not found. Number of existing sheets ${ae}, scratchPad:${zd}, sheetNameLength:${D.na.sheetName?D.na.sheetName.length:-1} Hash:${D.na.hash}`)}}else ba.ULS.shipAssertTag(537170177,0,!1,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() blockCacheItem is null")}finally{ha&&
ha.stop()}}sAa(D){var ha;if(!this.fh.kd(this.currentStateId))return ba.ULS.sendTraceTag(509646790,0,15,`CalcAsyncEngine.getTableHeaders: stateId ${this.currentStateId} not found in gridCache`),null;const fb=null===(ha=this.fh.ma(this.currentStateId))||void 0===ha?void 0:ha.sm;if(!fb||!fb[0])return null;ha=fb[0].q$;if(!ha||!ha.kd(D.name))return ba.ULS.sendTraceTag(509646789,0,15,`CalcAsyncEngine.getTableHeaders: table key found wasn't found in cached named objects list. cached named objects is null: ${null==
ha}`),null;D=ha.ma(D.name);if(!D||!D.BH)return null;ha=new Ub.a;for(let Vb of D.BH.Vda)ha.add(Vb.value);return ha}xch(D,ha,fb){var Vb=$a.h(this.pf),Gc=Vb.Hd(ha);Gc=this.qNc(Gc,null,"CopyPaste");fb=this.qNc(Vb.Hd(D),fb,"CopyPaste");if(0>Gc||0>fb||Gc!==fb)ba.ULS.sendTraceTag(537170143,0,15,`CalcAsyncEngine::CalculateFormulaForCopyPaste(). Revision not valid. sourceRevision:${fb}, targetRevision:${Gc}.`);else{fb=[];Vb=yf.d(this.pf.va.na);var zd=this.amc(Vb);D=nf.B7("CalculateFormulaForCopyPaste.srcRange",
Vb,D.top-1,D.left-1,D.bottom-1,D.right-1);ha=nf.B7("CalculateFormulaForCopyPaste.targetRange",Vb,ha.top-1,ha.left-1,ha.bottom-1,ha.right-1);ha=excelOnlineCalc.calc.copyPasteRangePasteEdit(ha,D,zd);fb.push(ha);ha=zd?String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",Vb,Gc,zd.row,zd.column,zd.lastRow,zd.lastColumn):String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",
Vb,Gc,"","","","");ba.ULS.sendTraceTag(537170142,0,50,ha);this.Gr.editRangePaste(Gc,fb);this.resumeRecalc()}}amc(D){const ha=this.Gtd();let fb=null;ha?fb=nf.B7("GetViewport.viewport",D,ha.top-1,ha.left-1,ha.bottom-1,ha.right-1):ba.ULS.sendTraceTag(537170141,0,50,"CalcAsyncEngine::GetViewport() viewportRange is null, calc will use entire sheet...");return fb}Gtd(){const D=$a.h(this.pf);let ha=D.Ol;if($a.h(this.pf).jd.Ek){ha=D.Xh(1).Ol;if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5497152_JSCrash_At_CalcAsyncEngine_GetViewportRange")&&
!ha)return ba.ULS.sendTraceTag(537170140,0,15,"CalcAsyncEngine::GetViewportRange viewportRange is null."),null;ha.dia(1,1);ha.dia(3,1)}return ha}qNc(D,ha,fb){let Vb;if(!this.Gr||!D)return ba.ULS.sendTraceTag(537170139,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() recalc engine is null:${!this.Gr}, modifiedCell is null:${!D}, operation:${fb}`),-1;const Gc=D.cell.hI-1,zd=D.cell.gI-1;if(D.cell.cy){if(Vb=D.cell.cy.f$b,Vb===Wa.a.lg)return ba.ULS.sendTraceTag(537170138,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() BlockRevision unknown for block:${D.cell.cy.sf}, operation:${fb}`),
-1}else return ba.ULS.sendTraceTag(537170137,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() GridBlockModelProxy is null cell:(${D.cell.hI},${D.cell.gI}), operation:${fb}`),-1;if(Vb<this.av)return ba.ULS.sendTraceTag(537170136,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${Gc},${zd}) - blockRevision:${Vb} < lastUpdatedStateId:${this.av}, operation:${fb}`),-1;if(Vb<this.currentStateId)return ba.ULS.sendTraceTag(537170135,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${Gc},${zd}) - blockRevision:${Vb} < currentStateId:${this.currentStateId}, operation:${fb}`),
-1;ha&&!this.dOd&&(this.Gr.setOnRecalcResults(ha),this.dOd=!0);return this.Wfk()&&!this.SXb(2)?(ba.ULS.sendTraceTag(537170134,0,15,`CalcAsyncEngine.ValidateCalculateFormulaInit: UpdateData failed. operation:${fb}`),-1):Vb}getFormulaBarText(D,ha,fb){return ha&&ha.startsWith("'")?ha:D.cell.formulaBarText||fb.toString()}bth(D,ha,fb){let Vb=null;this.a7a=this.Q8(fb);if(this.dLe()&&this.fh.ma(this.av).A5a){const He=this.fh.ma(this.av).A5a[D];if(null===He||void 0===He?0:He.OTb)Vb=He.tKe}fb=this.BBi(Vb,
ha,fb);const {c2i:Gc,numberOfNonEmptyCells:zd,a2i:ae}=this.ckh(Vb,ha,fb);ba.ULS.sendTraceTag(50671754,0,50,`CalcAsyncEngine::CreateRangeUpdateCommands() completed for Block Hash:${D} StateId:${this.currentStateId} number of formulas ${Gc}, number of non-empty cells ${zd}, number of cells ${ae}`)}BBi(D,ha,fb){let Vb=!1;const Gc=nf.Paf(ha);if(D){const zd=nf.Paf(D);ge.a.equals(zd,Gc,!1)&&(Vb=!0)}Vb?this.KWg(D,this.av,fb):this.MWg(ha,fb);return Vb}dLe(){let D=!1;this.Gr&&-1!==this.av&&(D=this.Gr.stateIdAvailable(this.av));
return D&&this.fh.kd(this.av)&&this.av<this.currentStateId}ckh(D,ha,fb){let Vb=0,Gc=0,zd=0,ae,He;for(ha.reset();ae=ha.getNextCell();)zd++,(ae.value||ae.formula)&&Gc++,Uh.f(ae.formula)&&Vb++,(He=fb?D.getCell(ae.row,ae.col):null)?this.Zjh(ha,ae,He):this.LWg(ha,ae);if(fb)for(D.reset();He=D.getNextCell();)(ae=ha.getCell(He.row,He.col))||this.KAe(D,He);return{c2i:Vb,numberOfNonEmptyCells:Gc,a2i:zd}}oSj(){this.Gr.setOnUpdateRequest(()=>{})}nSj(){this.Gr.setOnUnresponsive((D,ha,fb,Vb)=>{this.ggj(D,ha,fb,
Vb)})}ggj(D,ha,fb,Vb){ba.ULS.sendTraceTag(537170126,0,15,`CalcAsyncEngine.onUnresponsive: worker thread was unresponsive. timeout:${D}, waitTime:${ha}, timeoutCount:${fb}, hasBeenClosed:${Vb}.`);Vb&&(this.GGj(),this.Ata())}GGj(){this.wf(null,null);this.nGd=this.dOd=!1;this.JRd=0;this.BRd=this.DRd=this.ERd=this.CRd=-1}close(){this.Gr.close()}clearCache(){this.Gr.clearCache()}resumeRecalc(){this.Gr.resumeRecalc()}zRj(){this.Gr.setA1ReferenceStyle(!0)}Wuj(){if(this.instantaneousSupportInformationManager){var D=
this.instantaneousSupportInformationManager.Syi;const fb=this.instantaneousSupportInformationManager.Vyi,Vb=this.instantaneousSupportInformationManager.Uyi,Gc=this.instantaneousSupportInformationManager.Tyi;var ha=!1;D!==this.CRd&&(ha=!0,this.CRd=D);fb!==this.ERd&&(ha=!0,this.ERd=fb);Vb!==this.DRd&&(ha=!0,this.DRd=Vb);Gc!==this.BRd&&(ha=!0,this.BRd=Gc);const zd=[];ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled",!1)&&(ha=excelOnlineCalc.calc.runExperiment("ExceLintExperiment",
null),zd.push(ha),ha=!0);ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnitExperiment",!1)&&(ha=excelOnlineCalc.calc.runExperiment("UnitExperiment",null),zd.push(ha),ha=!0);ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1)&&(ha=excelOnlineCalc.calc.runExperiment("AutocompleteExperiment",null),zd.push(ha),ha=!0);ha&&(D=excelOnlineCalc.calc.recalcServiceConfig(null,D,null,fb,null,null,null,Vb,zd,Gc),this.Gr.reconfigure(D))}}hUj(D){let ha=
null;if(this.fh.kd(this.currentStateId))try{this.mea=[],ha=this.pf.Sd.Ze("ModelUpdate",`CalcAsyncEngine::SetUpdatedRanges() StateId:${this.currentStateId} UpdateTriggerData:${Mf[D]}`),ea.a.forEach(this.fh.ma(this.currentStateId).A5a,(fb,Vb)=>{Vb.OTb||(this.bth(fb,Vb.tKe,Vb.sheetName),Vb.OTb=!0)},null),this.Gr.updateRanges(this.currentStateId,this.mea)}finally{ha&&ha.stop()}else ba.ULS.sendTraceTag(537170122,0,15,`CalcAsyncEngine::SetUpdatedRanges StateId:${this.currentStateId} does not exist in GridCache`)}gUj(){const D=
[],ha=this.dLe();var fb=ha&&this.fh.ma(this.av).sm&&this.fh.ma(this.av).sm[0]&&this.fh.ma(this.av).sm[0].nwc?this.fh.ma(this.av).sm[0].q$:null;this.XPe(fb,this.fh.ma(this.currentStateId).sm[0].q$,null,this.av,D);this.fh.ma(this.currentStateId).sm[0].nwc=!0;for(let Vb=1;Vb<this.fh.ma(this.currentStateId).sm.length;Vb++)fb=-1,ha&&this.fh.ma(this.av).sm&&(fb=this.Gsd(this.fh.ma(this.currentStateId).sm[Vb].Zaa.sheetName,this.av)),fb=-1!==fb&&this.fh.ma(this.av).sm[fb].nwc?this.fh.ma(this.av).sm[fb].q$:
null,this.XPe(fb,this.fh.ma(this.currentStateId).sm[Vb].q$,this.fh.ma(this.currentStateId).sm[Vb].Zaa.sheetId,this.av,D),this.fh.ma(this.currentStateId).sm[Vb].nwc=!0;this.Gr.updateNamedObjects(this.currentStateId,D)}XPe(D,ha,fb,Vb,Gc){if(void 0!==fb&&null!==fb){var zd=excelOnlineCalc.calc.undefinedNamesWrite(fb);Gc.push(zd)}if(D){var ae=!1;zd=[];var He=[];if(ha)for(let zf of ha){const vg=zf.value;if(D.kd(zf.key)){var hf=D.ma(zf.key);nf.n0i(hf,vg)?ae=!0:(hf=excelOnlineCalc.calc.namedObject(zf.key,
null),zd.push(hf),nf.I4c(zf.key,vg,He))}else nf.I4c(zf.key,vg,He)}for(let zf of D)ha&&ha.kd(zf.key)||(D=excelOnlineCalc.calc.namedObject(zf.key,null),zd.push(D));ae&&(ha=excelOnlineCalc.calc.namedObjectsPromote(fb,Vb),Gc.push(ha));0<zd.length&&(ha=excelOnlineCalc.calc.namedObjectsWrite(fb,zd),Gc.push(ha));0<He.length&&(fb=excelOnlineCalc.calc.namedObjectsWrite(fb,He),Gc.push(fb))}else if(ha){Vb=[];for(He of ha)nf.I4c(He.key,He.value,Vb);0<Vb.length&&(fb=excelOnlineCalc.calc.namedObjectsWrite(fb,Vb),
Gc.push(fb))}}n8g(){const D=this.fh.ma(this.currentStateId).A5a[this.lya];return D?(ba.ULS.sendTraceTag(509117004,0,50,`CalcAsyncEngine::BlockPreviouslyHandled Block Hash:${this.lya} StateId:${this.currentStateId} previously handled. LastUpdatedStateId: ${this.av}. sentToRecalcEngine: ${null===D||void 0===D?void 0:D.OTb}`),!0):!1}f8g(D){return 1===D.getColumnNumbers().length&&D.getColumnNumbers()[0]===nf.MId+1?!1:!0}Dwi(){let D=!1;$a.h(this.pf).ya.b9a(ha=>{ha.state&1&&this.pf.ea.xg===ha.dg.Revision&&
(this.DUe(ha),D=!0)});return D}nSe(D,ha){var fb=D.getRowNumbers(),Vb=D.getColumnNumbers();D=fb[0]-1;fb=fb[fb.length-1]-1;const Gc=Vb[0]-1;Vb=Vb[Vb.length-1]-1;ha=this.Q8(ha);if(!ha){const zd=this.fh.kd(this.currentStateId)&&this.fh.ma(this.currentStateId).sm?this.fh.ma(this.currentStateId).sm.length:0;ba.ULS.sendTraceTag(537170120,0,15,`CalcAsyncEngine::CreateBlockRangeLocation SheetName not found. Number of existing sheets ${zd}`)}return nf.B7("CreateBlockRangeLocation",ha,D,Gc,fb,Vb)}KWg(D,ha,fb){if(fb=
this.nSe(D,fb)){var Vb=nf.ddc(D.getRowNumbers());D=nf.ddc(D.getColumnNumbers());ha=excelOnlineCalc.calc.rangePromote(fb,ha,Vb,D);this.mea[this.mea.length]=ha}}MWg(D,ha){if(ha=this.nSe(D,ha)){var fb=nf.ddc(D.getRowNumbers());D=nf.ddc(D.getColumnNumbers());D=excelOnlineCalc.calc.rangeWrite(ha,null,fb,D);this.mea[this.mea.length]=D}}Zjh(D,ha,fb){let Vb=null,Gc=0,zd=0;switch(ha.valueType){case 2:Vb=this.Btd(ha);var ae=this.Btd(fb);ae=ge.a.equals(ae,Vb,!1);break;case 1:null===ha.value&&null===fb.value?
ae=!0:(Gc=parseFloat(ha.value),ae=parseFloat(fb.value)===Gc);break;default:null===ha.value&&null===fb.value?ae=!0:(zd=parseFloat(ha.value),ae=zd===parseFloat(fb.value))}ae&&ha.valueType===fb.valueType&&ha.ifmt===fb.ifmt&&ha.formulaType===fb.formulaType&&ge.a.equals(fb.formula,ha.formula,!1)||(void 0!==ha.formula&&null!==ha.formula||void 0!==ha.value&&null!==ha.value||void 0!==ha.text&&null!==ha.text||0!==ha.valueType?this.w7b(D,ha,Vb,Gc,zd):this.KAe(D,ha))}fWg(D){if(this.pf.Ud&&this.pf.Ud.items)for(let zd=
0;zd<this.pf.Ud.count;zd++){var ha=this.pf.Ud.items[zd];if(2!==ha.type&&3!==ha.type)continue;var fb=0,Vb=ha.name,Gc=Vb.lastIndexOf("!");if(0<Gc){fb=Vb.substr(0,Gc);"'"===fb.charAt(0)&&(fb=fb.substr(1,fb.length-2));fb=this.Gsd(fb,this.currentStateId);if(-1===fb){Vb=this.fh.kd(this.currentStateId)&&this.fh.ma(this.currentStateId).sm?this.fh.ma(this.currentStateId).sm.length:0;ba.ULS.sendTraceTag(595096334,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${Vb}`);
continue}Vb=Vb.substr(Gc+1)}Gc=this.fh.ma(this.currentStateId).sm[fb].q$;let ae=ha.usedRange;2===ha.type&&(ae=Cb.a(ha));if(Gc.kd(Vb)){if(fb=Gc.ma(Vb),fb.range=ae,fb.attributes=ha.attributes,2===fb.type)if(Vb=ha.DWb,!fb.BH)fb.BH=new mc(Vb);else if(Vb)for(const He of Vb.HeadersList)fb.BH.Vda.fa(He.Index,He.Name)}else if(fb=this.Q8(ha.sheetName)){fb=new ud(ha.type,ha.name,ae,fb,ha.attributes);if(2===fb.type)if(ha.DWb)fb.BH=new mc(ha.DWb);else if(ha=nf.IVh(ha.name,D))fb.BH=new mc(ha.ColHeadersList);Gc.fa(Vb,
fb)}else Vb=this.fh.kd(this.currentStateId)&&this.fh.ma(this.currentStateId).sm?this.fh.ma(this.currentStateId).sm.length:0,ba.ULS.sendTraceTag(537170117,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${Vb}`)}}w7b(D,ha,fb,Vb,Gc){var zd=D.getRowNumbers()[ha.row]-1;D=D.getColumnNumbers()[ha.col]-1;zd=nf.B7("AddRangeUpdateCommand",this.a7a,zd,D,zd,D);D=null;let ae=ha.formula||ha.text;const He=excelOnlineCalc.calc.blankValue;let hf=null;void 0!==ha.text&&
null!==ha.text||void 0!==ha.value&&null!==ha.value||(fb="",hf="This cell contains blanks only",0===ha.formulaType&&(ae=""));switch(ha.valueType){case 2:null!==fb&&(0===ha.formulaType&&(D=excelOnlineCalc.calc.valueCellData(ae,fb,ha.ifmt,hf)),1===ha.formulaType&&(D=excelOnlineCalc.calc.cellFormulaCellData(ae,fb,ha.ifmt,hf)),2===ha.formulaType&&(D=excelOnlineCalc.calc.valueCellData("",He,0,"This cell is a part of an array")));break;case 1:isNaN(Vb)?ba.ULS.sendTraceTag(537170116,0,50,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ha.row},${ha.col}) invalid numeric value`):
(0===ha.formulaType&&(D=excelOnlineCalc.calc.valueCellData(ae,Vb,ha.ifmt,null)),1===ha.formulaType&&(D=excelOnlineCalc.calc.cellFormulaCellData(ae,Vb,ha.ifmt,null)),2===ha.formulaType&&(D=excelOnlineCalc.calc.valueCellData("",He,0,"This cell is a part of an array")));break;case 3:isNaN(Gc)?ba.ULS.sendTraceTag(537170115,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ha.row},${ha.col}) invalid boolean value`):(fb=1===Gc?!0:!1,0===ha.formulaType&&(D=excelOnlineCalc.calc.valueCellData(ae,fb,ha.ifmt,
null)),1===ha.formulaType&&(D=excelOnlineCalc.calc.cellFormulaCellData(ae,fb,ha.ifmt,null)),2===ha.formulaType&&(D=excelOnlineCalc.calc.valueCellData("",He,0,"This cell is a part of an array")));break;case 4:isNaN(Gc)?ba.ULS.sendTraceTag(537170114,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ha.row},${ha.col}) invalid error value`):(fb=excelOnlineCalc.calc.errorValue(Gc),0===ha.formulaType&&(D=excelOnlineCalc.calc.valueCellData(ae,fb,ha.ifmt,null)),1===ha.formulaType&&(D=excelOnlineCalc.calc.cellFormulaCellData(ae,
fb,ha.ifmt,null)),2===ha.formulaType&&(D=excelOnlineCalc.calc.valueCellData("",He,0,"This cell is a part of an array")));break;default:D=excelOnlineCalc.calc.valueCellData("",He,ha.ifmt,null)}D&&(ha=excelOnlineCalc.calc.rangeWrite(zd,D,null,null),this.mea[this.mea.length]=ha)}LWg(D,ha){switch(ha.valueType){case 2:this.w7b(D,ha,this.Btd(ha),null,0);break;case 1:this.w7b(D,ha,null,parseFloat(ha.value),0);break;default:this.w7b(D,ha,null,null,parseFloat(ha.value))}}KAe(D,ha){var fb=D.getRowNumbers()[ha.row]-
1;D=D.getColumnNumbers()[ha.col]-1;fb=nf.B7("AddRangeUpdateCommandEmptyCell",this.a7a,fb,D,fb,D);ha=excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,ha.ifmt,null);ha=excelOnlineCalc.calc.rangeWrite(fb,ha,null,null);this.mea[this.mea.length]=ha}Q8(D){D=this.Gsd(D,this.currentStateId);return 0<D?this.fh.ma(this.currentStateId).sm[D].Zaa.sheetId:null}Gsd(D,ha){if(!this.fh.kd(ha))return ba.ULS.sendTraceTag(537170113,0,15,`CalcAsyncEngine.GetSheetInternalIndex StateId:${ha} does not exist in GridCache`),
-1;const fb=this.fh.ma(ha);return fb.sm?fb.getSheetIndex(D):(ba.ULS.sendTraceTag(537170112,0,15,`CalcAsyncEngine.GetSheetInternalIndex sheetsInformation == null for StateId:${ha}`),-1)}HTj(){if(!this.fh.kd(this.currentStateId)||!this.fh.ma(this.currentStateId).sm.length)return ba.ULS.sendTraceTag(537170083,0,15,`CalcAsyncEngine::SetSheetNamesAndUsedRanges() No sheets information for StateId:${this.currentStateId} or StateId does not exist in GridCache`),!1;const D=[];for(let ha=1;ha<this.fh.ma(this.currentStateId).sm.length;ha++){const fb=
this.fh.ma(this.currentStateId).sm[ha];fb&&D.push(fb.Zaa)}this.Gr.updateSheetNames(this.currentStateId,D);this.Gr.updateUnusedCells(this.currentStateId,this.fh.ma(this.currentStateId).d$d);return!0}setNumberFormats(){if(this.instantaneousSupportInformationManager){var D=[];for(const ha of this.instantaneousSupportInformationManager.$Ca){const fb=excelOnlineCalc.calc.numberFormat(ha.IfmtIndex,ha.FormatString,ha.Builtin);D.push(fb)}this.Gr.setNumberFormats(D,!0)}}VPj(){if(this.instantaneousSupportInformationManager&&
this.instantaneousSupportInformationManager.hh){var D=this.Hwi();if(!this.nGd||D)this.instantaneousSupportInformationManager.hh.TrueValueString&&(this.trueName=this.instantaneousSupportInformationManager.hh.TrueValueString),this.instantaneousSupportInformationManager.hh.FalseValueString&&(this.falseName=this.instantaneousSupportInformationManager.hh.FalseValueString),D=ef.CalcHelper.qTe(this.instantaneousSupportInformationManager,D),this.Gr.setLocale(D),this.nGd=!0}}uUj(){var D=null;if(void 0!==this.pf.workbookContext.TimeZoneInformation&&
null!==this.pf.workbookContext.TimeZoneInformation){D=null;this.pf.workbookContext.TimeZoneInformation.StandardDate.Month&&(D=excelOnlineCalc.date.dateTime(this.pf.workbookContext.TimeZoneInformation.StandardDate.Year,this.pf.workbookContext.TimeZoneInformation.StandardDate.Month,this.pf.workbookContext.TimeZoneInformation.StandardDate.Day,this.pf.workbookContext.TimeZoneInformation.StandardDate.Hour,this.pf.workbookContext.TimeZoneInformation.StandardDate.Minute,this.pf.workbookContext.TimeZoneInformation.StandardDate.Second,
this.pf.workbookContext.TimeZoneInformation.StandardDate.DayOfWeek+1,this.pf.workbookContext.TimeZoneInformation.StandardDate.Milliseconds,3));let ha=null;this.pf.workbookContext.TimeZoneInformation.DaylightDate.Month&&(ha=excelOnlineCalc.date.dateTime(this.pf.workbookContext.TimeZoneInformation.DaylightDate.Year,this.pf.workbookContext.TimeZoneInformation.DaylightDate.Month,this.pf.workbookContext.TimeZoneInformation.DaylightDate.Day,this.pf.workbookContext.TimeZoneInformation.DaylightDate.Hour,
this.pf.workbookContext.TimeZoneInformation.DaylightDate.Minute,this.pf.workbookContext.TimeZoneInformation.DaylightDate.Second,this.pf.workbookContext.TimeZoneInformation.DaylightDate.DayOfWeek+1,this.pf.workbookContext.TimeZoneInformation.DaylightDate.Milliseconds,3));D=excelOnlineCalc.date.tzData(this.pf.workbookContext.TimeZoneInformation.Bias,D,this.pf.workbookContext.TimeZoneInformation.StandardBias,ha,this.pf.workbookContext.TimeZoneInformation.DaylightBias)}else ba.ULS.sendTraceTag(537170082,
0,15,"CalcAsyncEngine.SetWorkbookProperties: TimeZoneInformation is null");D=excelOnlineCalc.calc.workbookProps(this.pf.workbookContext.F1904,this.pf.workbookContext.FDateCompatibility,D);this.Gr.setWorkbookProps(D)}Ata(){const D=ib.EwaSettings.Ea(570)?Ma.local:Ma.t9j,[ha,fb]=[excelOnlineCalc.x10.PluginSchedulerSingleton.instance(),excelOnlineCalc.x10.GridImportManagerSingleton.instance()];this.JTd=Ve.d(excelOnlineCalc.calc.createRecalcService(D,ha,fb));this.JTd.continueWith(Vb=>{Vb.exception?ba.ULS.sendTraceTag(537170075,
0,50,`CalcAsyncEngine.TryInitialize: Calc web worker failed: ${Vb.exception.toString()}`):(ba.ULS.sendTraceTag(537170078,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker is working as expected"),(this.Gr=this.JTd.result)?this.SXb(0)?this.nSj():ba.ULS.sendTraceTag(537170077,0,15,"CalcAsyncEngine.TryInitialize: UpdateData failed to initialize"):ba.ULS.sendTraceTag(537170076,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker result is null"))})}Hwi(){const D=this.instantaneousSupportInformationManager.Gna;
if(!D||this.JRd===D.length)return null;this.JRd=D.length;return ef.CalcHelper.$Se(D)}Jwi(){if(!(this.fh.kd(this.currentStateId)&&0<this.fh.ma(this.currentStateId).sm.length)){this.fh.fa(this.currentStateId,new od(this.IAd));this.fh.ma(this.currentStateId).Tgg(0,new Ne(null));var D=this.pf.va;for(let Vb=0;Vb<D.count;Vb++){var ha=Object(pb.a)(Pc.a,D.getItem(Vb));if(ha){void 0!==ha.sheetId&&null!==ha.sheetId&&void 0!==ha.name&&null!==ha.name&&ha.sheetId.length&&ha.sheetName.length||ba.ULS.sendTraceTag(537170074,
0,15,`CalcAsyncEngine::InitializeGridForStateId() invalid sheet - index:${Vb} Id:${ha.sheetId} Hash:${ha.hash} NameLength:${ha.name?ha.name.length:-1}`);var fb=void 0;fb=excelOnlineCalc.calc.sheetName(ha.sheetId,ha.name);this.fh.ma(this.currentStateId).Tgg(Vb+1,new Ne(fb));fb=ha.usedRange.YR();fb=excelOnlineCalc.calc.rangeLocation(0,0,fb.LastRow,fb.LastColumn);ha=excelOnlineCalc.calc.unusedCellsUpdate(ha.sheetId,fb);this.fh.ma(this.currentStateId).d$d.push(ha)}else ba.ULS.sendTraceTag(537170073,0,
15,`CalcAsyncEngine.InitializeGridForStateId(): not sheet item for StateId:${this.currentStateId} sheet-index:${Vb}`)}}}tkk(D){if(D instanceof Pc.a){var ha=D.usedRange.YR();ha=excelOnlineCalc.calc.rangeLocation(0,0,ha.LastRow,ha.LastColumn);ha=excelOnlineCalc.calc.unusedCellsUpdate(D.sheetId,ha);this.fh.ma(this.currentStateId).d$d[D.index]=ha}}Jgh(){for(let D of this.fh)D.key<this.av&&this.fh.remove(D.key)}Btd(D){D=D.value||D.text;if(void 0===D||null===D)D="";return D}Wfk(){if(!this.fh.kd(this.currentStateId))return!1;
let D=!1;ea.a.forEach(this.fh.ma(this.currentStateId).A5a,(ha,fb)=>{fb.OTb||(D=!0)},null);return D}ved(D){const ha={};ha.reason=D;ha.kind=1;return ha}Yqc(){return this.fh.kd(this.currentStateId)&&this.fh.ma(this.currentStateId).sm&&this.fh.ma(this.currentStateId).sm[0]&&this.fh.ma(this.currentStateId).sm[0].q$?!0:!1}static iph(D){const ha=[];if(null===D||void 0===D?0:D.Vda)for(let fb of D.Vda)D=excelOnlineCalc.calc.columnData(fb.key,fb.value),ha.push(D);return ha}static n0i(D,ha){if(D.type!==ha.type||
D.attributes!==ha.attributes||!ge.a.equals(D.fullName,ha.fullName,!1)||!D.range.equals(ha.range))return!1;if(!D.BH&&!ha.BH)return!0;if(!D.BH||!ha.BH||D.BH.Vda.count!==ha.BH.Vda.count)return!1;for(let fb of D.BH.Vda){let Vb;if(D=fb.value)D=ha.BH.Vda.kf(fb.key),{value:Vb}=D,D=D.returnValue;if(!(D&&Vb&&ge.a.equals(fb.value,Vb,!1)))return!1}return!0}static I4c(D,ha,fb){var Vb=nf.B7("NamedObject",ha.sheetId,ha.range.top-1,ha.range.left-1,ha.range.bottom-1,ha.range.right-1);if(2===ha.type){const Gc=!!(ha.attributes&
16),zd=!!(ha.attributes&8);ha=nf.iph(ha.BH);Vb=excelOnlineCalc.calc.namedTableData(Vb,Gc,zd,ha);D=excelOnlineCalc.calc.namedObject(D,Vb)}else Vb=excelOnlineCalc.calc.namedRangeData(Vb),D=excelOnlineCalc.calc.namedObject(D,Vb);fb.push(D)}static Paf(D){const ha=Sys.Serialization.JavaScriptSerializer.serialize(D.getRowNumbers());D=Sys.Serialization.JavaScriptSerializer.serialize(D.getColumnNumbers());return ha+D}static ddc(D){let ha=null;if(1<D.length)for(let fb=1;fb<D.length;fb++){let Vb=0;for(;D[fb-
1]+1+Vb<D[fb];)ha=ha||[],ha.push(D[fb-1]+Vb),Vb++}return ha}static IVh(D,ha){if(!ha)return null;for(let fb=0,Vb=ha.length;fb<Vb;++fb)if(ge.a.equals(D,ha[fb].Name,!1))return ha[fb];return null}static B7(D,ha,fb,Vb,Gc,zd){const ae=(He,hf,zf,vg)=>{(0>zf||zf>=vg)&&ba.ULS.sendTraceTag(537170072,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${He} invalid ${hf}:${zf}`)};void 0!==ha&&null!==ha||ba.ULS.sendTraceTag(537170071,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${D} sheetId is null`);
ae(D,"top",fb,nf.GGf);ae(D,"left",Vb,nf.MId);ae(D,"bottom",Gc,nf.GGf);ae(D,"right",zd,nf.MId);return excelOnlineCalc.calc.sheetRangeLocation(ha,fb,Vb,Gc,zd)}}nf.GGf=1048576;nf.MId=16384;Object(da.a)(nf,"CalcAsyncEngine",null,[5]);const Df=(D,ha,fb)=>{switch(D.type){case 2:return excelOnlineCalc.calc.valueCellData(ha,D.value,fb,null);case 1:return excelOnlineCalc.calc.valueCellData(ha,parseFloat(D.value),fb,null);case 3:return excelOnlineCalc.calc.valueCellData(ha,1===parseFloat(D.value),fb,null);
case 4:return excelOnlineCalc.calc.valueCellData(ha,excelOnlineCalc.calc.errorValue(parseFloat(D.value)),fb,null);default:return excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,fb,null)}};class wg{constructor(){this.zN=this.AN=this.lI=this.mI=this.j3=!1}}Object(da.a)(wg,"AbsoluteRelativeReferenceInfo",null,[]);var Sf=a(26);class gg{}gg.gZf="#";Object(da.a)(gg,"Operators",null,[]);var dg=a(1126);class kg{}kg.sheet="Sheet";kg.sheetRange="SheetRange";kg.document="Document";kg.eti=
"Ident";Object(da.a)(kg,"TraverseFormulaQualifierTypes",null,[]);var Zf=a(1127),qd=a(966),ie=a(852),og=a(78),ah=a(298);class vi extends Sys.EventArgs{constructor(D){super();this.Il=D}}Object(da.a)(vi,"EditedCellRecalcCompleteEventArgs",Sys.EventArgs,[]);var Xg=a(281);class wi{constructor(D,ha){this.aOf=(fb,Vb)=>{fb=this.gridView.ha.ra.activeCell;const Gc=this.gridView.Hd(fb);null!=Gc&&this.mnj(fb,Vb.text,Gc.cell.Ei,Gc.cell.cy.f$b,this.gridView.$.activeItemName)};this.GDa=()=>{this.iCa=Object(ah.a)({message:"PrefetchNotStarted"})};
this.calcManager=D;this.gridView=ha;this.iCa=Object(ah.a)({message:"Ctor"});D=ib.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SetCellEstimationPrefetchMsDebounce",100);this.mnj=Xg.a((fb,Vb,Gc,zd,ae)=>this.prefetch({text:Vb,range:fb,ifmt:Gc,stateId:zd,sheetName:ae}),D);this.gridView.he.Gp(this.GDa);this.gridView.Nk.WBe(this.aOf)}dispose(){this.gridView.Nk.O6f(this.aOf);this.gridView.he.zp(this.GDa);this.MNe()}Yaf(D){if(Object(ah.b)(this.iCa))return Object(ah.a)(this.iCa.reason.message);if(wi.P4g(D,
this.iCa.value.key)){for(const ha of this.iCa.value.results.results)if(Object(ah.c)(ha)&&wi.gJi(D,ha))return ha;return Object(ah.a)("RangeNotFoundInPrefetchResult")}return Object(ah.a)("ResultUnavailable")}MNe(){this.iCa=Object(ah.a)({message:"PrefetchResultCleared"})}prefetch(D){this.iCa=Object(ah.a)({message:"EvalInProgress",key:D});this.calcManager.bY([],D.range,D.range,D.text,!0).then(ha=>{this.iCa=Object(ah.d)({key:D,results:ha})}).catch(ha=>{ba.ULS.sendTraceTag(509219811,0,50,`SetCellEstimationPrefetcher.prefetch: evalFormulaRangeOnClonedModel promise rejected with error ${ha}`)})}static P4g(D,
ha){return D.text===ha.text&&D.range.toString()===ha.range.toString()&&D.ifmt===ha.ifmt&&D.stateId===ha.stateId&&D.sheetName===ha.sheetName}static gJi(D,ha){return D.range.top-1===ha.value.cell.row&&D.range.left-1===ha.value.cell.col}}Object(da.a)(wi,"SetCellEstimationPrefetcher",null,[667,5]);var uh;let Ai=uh=class extends qb.a{constructor(D){super();this.Hu=null;this.Yyg=!1;this.dYd=this.instantaneousSupportInformationManager=this.iPb=null;this.nLd=new Map;this.Dqe=null;this.hyc=ha=>{ba.ULS.sendTraceTag(537170005,
0,50,"CalcManager.OnLocaleInformationAvailable() called");ha.ZVd(this.hyc);ha.Gna.length?this.Nxc(ha,Sys.EventArgs.Empty):(ba.ULS.sendTraceTag(537170004,0,50,"CalcManager.OnLocaleInformationAvailable() - waiting for functions information"),ha.bCe(this.Nxc))};this.Nxc=ha=>{ba.ULS.sendTraceTag(537170003,0,50,"CalcManager.OnFunctionsInfoReady called");ha.LVd(this.Nxc);this.Cdk(ha)};this.onContentReady=()=>{this.Hu&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Ooc||
ka.Task.delay(0).continueWith(()=>{this.Hu.SXb(1)},0,null,og.a.current))};this.HLf=(ha,fb)=>{this.Hu&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Ooc||this.Hu.DUe(fb.af.block))};ba.ULS.sendTraceTag(537170067,0,50,"Creating CalcManager");this.ypc=!1;this.vd=D;this.Dv=$a.h(D);this.OQc=null;this.gridView.Fu(this.onContentReady);this.gridView.ya.h5c(this.HLf);this.$.ga.qd(268,ha=>{ha.hh?(ba.ULS.sendTraceTag(537170066,0,50,"CalcManager.ctor: LocaleInformation already available..."),
this.hyc(ha,Sys.EventArgs.Empty)):(ba.ULS.sendTraceTag(537170065,0,50,"CalcManager.ctor: waiting for LocaleInformation..."),ha.vCe(this.hyc))});if(this.N9=ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetCellEstimationPrefetch",!1))this.Zue=new wi(this,this.Dv)}N7b(D){this.addHandler(uh.KZe,D)}tJf(D){this.raiseEvent(uh.KZe,new vi(D))}cYg(D){this.addHandler(uh.R3c,D)}iAj(D){this.removeHandler(uh.R3c,D)}Fwc(D){this.raiseEvent(uh.R3c,D)}get nGc(){return this.Zue}get f1(){return this.OQc}get gridView(){return this.Dv}get $(){return this.vd}get zI(){return this.Dqe}get localeInfo(){return this.f1?
this.f1.config.localeInfo:null}get config(){return this.f1.config}dispose(){ba.ULS.sendTraceTag(537170064,0,50,"CalcManager.Dispose called");this.$.ga.qd(268,D=>{D.ZVd(this.hyc);D.LVd(this.Nxc)});this.gridView&&(this.gridView.Ax(this.onContentReady),this.gridView.ya&&this.gridView.ya.v6f(this.HLf),this.Dv=null);this.OQc=null;this.ypc=!1;this.N9&&(oc.a.Ma(this.nGc),this.Zue=null)}ych(D,ha,fb,Vb){this.Hu&&this.Hu.vch(D,ha,fb,void 0===Vb?null:Vb)}zch(D,ha){return this.Hu?this.Hu.wch(D,ha):!1}evalFormula(D,
ha,fb,Vb){return this.Hu?this.Hu.evalFormula(D,ha,fb,Vb):Promise.reject("calc engine not initialized")}bY(D,ha,fb,Vb,Gc){return this.Hu?this.Hu.bY(D,ha,fb,Vb,Gc):Promise.reject("CalcEngine is null")}sAa(D){if(!D)return ba.ULS.sendTraceTag(509649312,0,100,"CalcManager.GetTableHeaders: table is null"),null;if(!this.Hu)return null;ba.ULS.shipAssertTag(537170059,0,2===D.type,"CalcManager.GetTableHeaders() - ActiveItem is not a table");return this.Hu.sAa(D)}VDe(D,ha){if(!ha||2!==D.type)return!1;D=Cb.a(D);
return D.right-D.left+1===ha.count}n6e(D,ha){if(!this.iPb)return this.Yyg||ba.ULS.sendTraceTag(537170057,0,15,"CalcManager.ExtractReferenceWrappers - parser not initialized"),null;var fb=this.ndd(Sf.Range.Je(1,1));fb=this.iPb.parseFormula(excelOnlineCalc.parse.parseLocals(1,fb.range),D);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(fb))return ba.ULS.sendTraceTag(537170056,0,10,"CalcManager.ExtractReferenceWrappers - ParseFormula failed"),null;try{let Vb;const Gc=null!==ha&&void 0!==ha?ha:
this.gridView.ha.ra.activeCell,zd=excelOnlineCalc.location.gridCell(Gc.top-1,Gc.left-1),ae=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),He=excelOnlineCalc.location.sheetIndex(ae,this.$.va.na.sheetId),hf=this.zth(zd,He);this.dYd||(this.dYd=excelOnlineCalc.util.createResolver(this.yth()));Vb=excelOnlineCalc.parse.parseResultHelper.extractReferences(fb,this.f1.config.localeInfo,ib.EwaSettings.Ea(512),hf,this.dYd);ib.EwaSettings.Ea(101)&&this.pjk(Vb,
D);return Vb}catch(Vb){return ba.ULS.sendTraceTag(537170055,0,10,`CalcManager.ExtractReferenceWrappers - exception: ${Vb.message}`),null}}extractLetVariables(D,ha){if(!this.iPb)return this.Yyg||ba.ULS.sendTraceTag(537170054,0,15,"CalcManager.ExtractLetVariables - parser not initialized"),null;const fb=this.ndd(Sf.Range.Je(1,1));D=this.iPb.parseFormula(excelOnlineCalc.parse.parseLocals(1,fb.range),D);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(D))return ba.ULS.sendTraceTag(537170053,0,10,
"CalcManager.ExtractLetVariables - ParseFormula failed"),null;try{return excelOnlineCalc.parse.parseResultHelper.extractLetVariables(D,ha,this.f1.config.localeInfo)}catch(Vb){return ba.ULS.sendTraceTag(537170052,0,10,`CalcManager.ExtractLetVariables - exception: ${Vb.message}`),null}}extractReferences(D,ha,fb,Vb,Gc){if(!ha)return ba.ULS.sendTraceTag(537170051,0,10,"CalcManager.ExtractReferences - sheetName is null"),null;if(!fb)return ba.ULS.sendTraceTag(537170050,0,10,"CalcManager.ExtractReferences - documentName is null"),
null;const zd=this.n6e(D,Gc);if(!zd)return ba.ULS.sendTraceTag(537170049,0,15,"CalcManager.ExtractReferences - ExtractReferenceWrappers returned null"),null;try{return this.ush(zd,ha,fb,D,Vb,Gc)}catch(ae){return ba.ULS.sendTraceTag(537170048,0,10,`CalcManager.ExtractReferences - exception: ${ae.message}`),null}}ndd(D,ha){ha=void 0===ha?!0:ha;return D&&this.f1?this.f1.Rth(this.f1.xvh(),D.top-1,D.left-1,ha):null}Abb(D,ha){D=this.K8(D);if(!Object(ah.c)(D))return null;ha=this.zI.parseEdit(ha,D.value);
return excelOnlineCalc.util.isSuccess(ha)?ha.value.kind===qd.a.formula:null}wsc(D){D=this.K8(D);return Object(ah.c)(D)?"Text"===D.value.valueType:null}Nsf(D){D=this.K8(D);return Object(ah.c)(D)?"Date"===D.value.valueType&&!D.value.hasTime:null}K8(D){if(null==this.zI)return Object(ah.a)("Number formatter is null");if(null==this.instantaneousSupportInformationManager)return Object(ah.a)("Instantaneous manager is null");if(this.nLd.has(D))return Object(ah.d)(this.nLd.get(D));if("number"===typeof D){var ha=
this.Bff(D);if(null==ha)return Object(ah.a)(`Invalid ifmt=${D}`);var fb=ha.FormatString;ha=ha.Builtin}else fb=D,ha=!1;fb=this.zI.createFormat(fb,ha);return excelOnlineCalc.util.isSuccess(fb)?(this.nLd.set(D,fb.value),Object(ah.d)(fb.value)):Object(ah.a)("Could not create number format")}getWorksheetFuncId(D){return this.localeInfo.getWorksheetFuncId(D)}ush(D,ha,fb,Vb,Gc,zd){const ae={Items:[]};for(let vg=0;vg<D.length;vg++){var He=D[vg];const gh={};gh.Start=He.span.start;gh.End=He.span.end;if(Gc||
He.kind!==dg.a.func)if(Gc||He.kind!==dg.a.ZPi){if(!this.rCh(He,ha,fb))continue;var hf=new wg;const Kh=this.Gei(He,ha,hf,Vb,zd);if(ib.EwaSettings.Ea(512)){var zf=this.qai(He);const th=this.pai(He);if(Kh||th&&0<=zf){let Qh={};Qh.Span=gh;Qh.LetNumber=zf;Qh.LetName=th;Qh.Range=Kh;Qh.IsRangeRef=hf.j3;Qh.IsAbsoluteFirstRow=hf.mI;Qh.IsAbsoluteFirstColumn=hf.lI;Qh.IsAbsoluteSecondRow=hf.AN;Qh.IsAbsoluteSecondColumn=hf.zN;Qh.IsStructRef=He.kind===dg.a.r6d;ae.Items.push(Qh)}}else Kh&&(zf={},zf.Span=gh,zf.Range=
Kh,zf.IsRangeRef=hf.j3,zf.IsAbsoluteFirstRow=hf.mI,zf.IsAbsoluteFirstColumn=hf.lI,zf.IsAbsoluteSecondRow=hf.AN,zf.IsAbsoluteSecondColumn=hf.zN,zf.IsStructRef=He.kind===dg.a.r6d,ae.Items.push(zf))}else He=He.ref.value.oper.kind,hf={},hf.Span=gh,hf.IsString=2===He,hf.IsBoolean=4===He,hf.IsNumber=1===He,ae.Items.push(hf);else gh.End=He.span.start+He.ref.name.length,He={},He.Span=gh,He.IsFunction=!0,He.FunctionId=this.getWorksheetFuncId(Vb.substring(gh.Start,gh.End)),ae.Items.push(He)}ae.Items.sort((vg,
gh)=>vg.Span.Start-gh.Span.Start);return ae}qai(D){return D.kind===dg.a.dBf?D.ref.number:-1}pai(D){return D.kind===dg.a.dBf?D.ref.name:null}Gei(D,ha,fb,Vb,Gc){if(D.kind===dg.a.range)return fb.j3=!0,this.hRe(D,ha,fb,Vb);if(D.kind===dg.a.namedRange){fb=D.ref;(D=this.$.Ud.getItemByName(fb.name))||(D=this.$.Ud.getItemByName(ha+"!"+fb.name));if(!(D&&D.sheetName&&D.usedRange&&ge.a.equals(D.sheetName,ha,!0)))return null;ha=2===D.type?Cb.a(D):D.usedRange;return Gb.m(ha,D)}if(D.kind===dg.a.r6d){let zd=D.ref;
zd.name?(Gc=this.$.Ud.getItemByName(zd.name))||(Gc=this.$.Ud.getItemByName(ha+"!"+zd.name)):Gc=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:7907929_RecognizeTableRangeFromOriginCell")&&Gc?this.gridView.zd.sh(Gc):this.gridView.zd.sh(this.gridView.ha.ra.activeCell);if(!(Gc&&Gc.sheetName&&Gc.usedRange&&ge.a.equals(Gc.sheetName,ha,!0)))return null;fb.j3=!1;return this.hRe(D,ha,fb,Vb)}return null}hRe(D,ha,fb,Vb){D=D.ref;if(D.type){if(D.type===Zf.a.column){var Gc=D.startIndex;D=D.endIndex;fb.lI=Gc.kind===
ie.a.abs;fb.zN=D.kind===ie.a.abs;return this.createRange(0,Gc.index,Wa.a.yh,D.index,ha)}if(D.type===Zf.a.row)return Gc=D.endIndex,fb.mI=D.startIndex.kind===ie.a.abs,fb.AN=Gc.kind===ie.a.abs,this.createRange(D.startIndex.index,0,D.endIndex.index,Wa.a.xh,ha);if(D.type===Zf.a.cell){Gc=D.row;var zd=D.col;fb.mI=fb.AN=Gc.kind===ie.a.abs;fb.lI=fb.zN=zd.kind===ie.a.abs;return this.Aac(D.span.end,Vb)&&(fb=Sf.Range.Je(Gc.index+1,zd.index+1),fb=this.gridView.zd.aif(fb))?Gb.n(fb,ha):this.createRange(Gc.index,
zd.index,Gc.index,zd.index,ha)}if(D.type===Zf.a.range){Gc=D.top;zd=D.left;Vb=D.bottom;D=D.right;const ae=Math.min(Gc.index,Vb.index),He=Math.min(zd.index,D.index),hf=Math.max(Gc.index,Vb.index),zf=Math.max(zd.index,D.index);fb.mI=Gc.kind===ie.a.abs;fb.AN=Vb.kind===ie.a.abs;fb.lI=zd.kind===ie.a.abs;fb.zN=D.kind===ie.a.abs;return this.createRange(ae,He,hf,zf,ha)}ba.ULS.sendTraceTag(537170010,0,10,`CalcManager.CovertFormulaRefToRange: Unsupported formula ref type '${D.type}'`);return null}ba.ULS.sendTraceTag(537170011,
0,15,"CalcManager.CovertFormulaRefToRange: traverseFormulaRef.Type is null");return null}Aac(D,ha){return ha.length>=D&&0<D&&ha.charAt(D-1)===gg.gZf}pch(D,ha,fb){this.Hu&&this.Hu.xch(D,ha,fb)}Bff(D){return this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.$Ca&&this.instantaneousSupportInformationManager.$Ca[D]&&this.zI?this.instantaneousSupportInformationManager.$Ca[D]:null}goi(D){var ha;"number"!==typeof D&&"string"!==typeof D?this.Fwc(null):(D=this.K8(D),Object(ah.c)(D)?
(D=D.value,Object(jh.c)(D)||Object(jh.c)(D.formatString)?this.Fwc(null):this.Fwc({formatString:D.formatString,builtIn:null!==(ha=D.isBuiltIn)&&void 0!==ha?ha:!1})):this.Fwc(null))}toXLNumber(D){if(!this.zI)return null;D=excelOnlineCalc.numfmt.toXLNumber(this.config.mathpack,this.zI,D);return excelOnlineCalc.util.isSuccess(D)?D.value:null}pjk(D,ha){if(D)for(const fb of D)fb.ref.type&&fb.ref.type===Zf.a.cell&&(D=fb.ref,uh.cnj(D,ha)&&(D.span.end+=1,fb.span.end+=1))}createRange(D,ha,fb,Vb,Gc){const zd=
{};zd.FirstRow=D;zd.FirstColumn=ha;zd.LastRow=fb;zd.LastColumn=Vb;zd.SheetName=Gc;return zd}rCh(D,ha,fb){var Vb=D.ref.qualifier;if(!Vb)return!0;switch(D.ref.qualifier.type){case kg.sheet:return D=Vb.document,ge.a.equals(Vb.sheet,ha,!0)&&(!D||ge.a.equals(D.document,fb,!0));case kg.sheetRange:return ha=this.$.va.getItemByName(ha),fb=this.$.va.getItemByName(Vb.sheet1),Vb=this.$.va.getItemByName(Vb.sheet2),!!ha&&!!fb&&!!Vb&&(fb.index<=ha.index&&ha.index<=Vb.index||Vb.index<=ha.index&&ha.index<=fb.index);
case kg.document:return ge.a.equals(Vb.document,fb,!0);case kg.eti:return Vb=Vb.name,ge.a.equals(Vb,ha,!0)||ge.a.equals(Vb,fb,!0);default:return ba.ULS.sendTraceTag(537170009,0,10,`CalcManager.GetQualifierData: Unsupported formula qualifier type '${Vb.type}'`),!1}}Cdk(D){this.instantaneousSupportInformationManager=D;D.$Ca.length&&D.Gna.length?(this.OQc=new ef.CalcHelper(this.gridView.$),this.iPb=this.f1.createParser(),this.Dqe=this.f1.createNumberFormatter(),this.ypc=!0,ba.ULS.sendTraceTag(537170007,
0,50,"CalcManager.TryInitializeInternal: calc initialized"),this.Hu||(ba.ULS.sendTraceTag(537170006,0,50,"CalcManager creating calc engine"),this.Hu=new nf(this.$))):ba.ULS.sendTraceTag(537170008,0,15,`CalcManager.TryInitializeInternal: IInstantaneousSupportInformationManager locale information missing, cannot initialize calc. number formats count = ${D.$Ca.length}, functions info count = ${D.Gna.length}`)}zth(D,ha){const fb={allowUnqualifiedCell:!0,wrapCellReferences:!0};fb.config=this.f1.config;
fb.originGridCell=excelOnlineCalc.util.success(D);fb.originSheet=excelOnlineCalc.util.success(ha);return fb}yth(){const D={};D.config=this.f1.config;D.getNameLoc=this.Hu.getNameLoc;D.getContainingTable=this.Hu.getContainingTable;D.getStructRefColumn=this.Hu.getStructRefColumn;D.getStructRefSpecialRef=this.Hu.getStructRefSpecialRef;D.getDocumentLoc=this.Hu.getDocumentLoc;D.getSheetIndex=this.Hu.getSheetIndex;D.getSheetName=this.Hu.getSheetName;D.getUserDefinedFuncLoc=this.Hu.getUserDefinedFuncLoc;
D.getSheetRangeIndexes=this.Hu.getSheetRangeIndexes;return D}static cnj(D,ha){return ha.length>D.span.end&&ha.charAt(D.span.end)===gg.gZf}};Ai.KZe="ECRC";Ai.R3c="ActiveCellNumberFormatChanged";Ai=uh=Object(Xb.a)([Object(je.d)(Fd.n),Object(Xb.b)(0,Object(Fd.W)()),Object(Xb.b)(1,Object(Fd.Z)())],Ai);Object(da.a)(Ai,"CalcManager",qb.a,[637,5]);class gj extends Ta.a{constructor(D){super();this.$=D;this.je()}create(){if(this.$){ba.ULS.sendTraceTag(537169993,0,50,"CalcManagerFactory.Create: Start loading script");
if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")){var D=75;var ha="Current"}else D=78,ha="Stable";ba.ULS.sendTraceTag(537169992,0,50,`CalcManagerFactory.Create: Calc ${ha} JS was loaded`);qa.TaskExtensions.za(Dg.a.loadScript(D,4,this.Ta,void 0,void 0,265),()=>{ba.ULS.sendTraceTag(537169991,0,50,"CalcManagerFactory.Create: Raised create service event");let fb=this.$.ga.Da(266,!1);fb||(ba.ULS.sendTraceTag(537169990,0,50,"CalcManagerFactory.Create: CalcManager is not registered, creating new CalcManager"),
fb=new Ai(this.$),this.$.ga.Qa(266,fb));this.Ld(fb)},this.ka,3)}else ba.ULS.sendTraceTag(537169994,0,50,"CalcManagerFactory.Create: ewaControl is null, cann't create the service")}static la(D){D&&D.ga&&D.ga.Qa(265,new gj(D))}}Object(da.a)(gj,"CalcManagerFactory",Ta.a,[]);String(X);window.___1689695361234_closurehack=X;var xi=a(576),nj=a(571),jj=a(568),Yi=a(1052);class uj{Ush(D,ha){if(D&&!(1>D.length)&&ha){var fb=Object.assign(new jj.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.vqh(D,fb.ControlList);
ha.push(fb)}}vqh(D,ha){const fb=Object.assign(new xi.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new nj.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(ha,fb);ha=Object.assign(new jj.a,{Title:"",ControlList:[]});Array.add(fb.Menu.MenuSectionList,ha);this.zsh(D,ha.ControlList)}zsh(D,ha){for(let fb=0;fb<D.length;fb++){const Vb=Object.assign(new Yi.a,{ExternalId:String.format("CoauthorPersona_{0}",
fb),Command:"336231556",DisplayName:D[fb].userName,LabelText:D[fb].userName,ImageBackColor:D[fb].color,PersonaId:D[fb].email,IsAnonymous:D[fb].isAnonymous});Array.add(ha,Vb)}}}Object(da.a)(uj,"PresenceContextMenuSectionBuilder",null,[658]);var oj=a(570);class Bh{constructor(D,ha,fb,Vb){this.Cfe=this.x5=this.Yk=this.TG=this.Nba=null;this.l5b=D;this.sQg=Vb;this.l5b.BRa&&(this.Yk=new qc.a(3,2,5E3,Object(La.a)(this,this.C6g,"authenticationCheckTask"),2),na.AFrameworkApplication.Vj.Sh(this.Yk),this.tj(ha,
fb));this.l5b.qub(()=>{this.qLf()});this.l5b.B3a(()=>{this.rLf()})}get businessBar(){return this.x5||(this.x5=Ja.a.instance.oi("CommonUI.IBusinessBar"))}get RJe(){return this.Cfe||(this.Cfe=Ja.a.instance.oi("CommonUI.IBusinessBarEntryFactory"))}tj(D,ha){const fb=na.AFrameworkApplication.Dd;fb.Rg(Za.a.authenticationLost,Sa.a.frame,D,96);fb.Rg(Za.a.CHe,Sa.a.frame,ha,96);fb.ae(Za.a.KLe,Sa.a.frame,ia.ActionManager.Ahd);fb.ae(Za.a.LLe,Sa.a.frame,ia.ActionManager.Ahd);fb.ae(Za.a.zFd,Sa.a.frame,ia.ActionManager.Ahd)}qLf(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);
na.AFrameworkApplication.Dd.processAction(Za.a.authenticationLost,2)}rLf(){this.G8j();na.AFrameworkApplication.Dd.processAction(Za.a.CHe,2)}C6g(){this.l5b.authenticationCheck()}G8j(){this.TG&&(this.TG.hide(),this.TG.dispose(),this.TG=null);this.Nba&&this.businessBar&&(na.AFrameworkApplication.Di||this.businessBar.removeEntry(this.Nba),this.Nba.dispose(),this.Nba=null)}showDialog(D){oc.a.Ma(this.TG);this.TG=new bh.StandardDialog;this.sQg||(this.TG.hw=!1,this.TG.Rd=0);this.TG.qe(1,CommonUIStrings.l_SignIn);
this.TG.BV(CommonUIStrings.l_DefaultDialogTitle,D,Object(La.a)(this,this.dx,"dialogHandler"))}dx(D){1===D?(oj.a.W$(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),na.AFrameworkApplication.Dd.processAction(Za.a.zFd,2)):(this.oVb(),na.AFrameworkApplication.Dd.processAction(Za.a.LLe,2))}oVb(){this.businessBar&&this.RJe&&(this.Nba=this.RJe.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.Nba.closeable=!0,this.Nba.addButton(CommonUIStrings.l_SignIn,
Bh.dbh,""),this.Nba.Uda=Object(La.a)(this,this.fbh,"businessBarEntryCloseHandler"),this.businessBar.tD(this.Nba,!1))}fbh(){this.pAh();na.AFrameworkApplication.Dd.processAction(Za.a.KLe,2)}pAh(){this.Yk&&(na.AFrameworkApplication.Vj.rr(this.Yk),this.Yk=null)}dispose(){this.Yk=this.TG=this.Nba=null}static dbh(){oj.a.W$();na.AFrameworkApplication.Dd.processAction(Za.a.zFd,2)}}Object(da.a)(Bh,"SignOutResponseUI",null,[5]);class rh{get name(){return"Common.App.UI"}Xj(D){D.register(uj,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").Ee()}init(){}dispose(){oc.a.Ma(rh.j6);
rh.j6=null}static main(){Sb.a.instance.Tk(new rh)}}rh.j6=null;Object(da.a)(rh,"CommonAppUIPackage",null,[2,3]);var Ji=a(35),Ki=a(220),Ig=a(1125),Ti=a(182),ii=a(70),di=a(97),ng=a(159);class Zi{constructor(D,ha,fb){this.cTa=1;this.Vca=[];this.active=!1;this.Zd=null;this.onPointerDown=Vb=>{this.gridView.setLastInputMethod(Vb.Ba.rawEvent);return!1};this.uz=()=>{const Vb=this.gridView.rtd();if(!(0>=Vb||Vb===this.cTa||this.gridView.It)){var Gc=!1,zd=[],ae=[];for(var He=this.Vca.length-1;0<=He;He--){var hf=
this.Vca[He];if(this.qtd(hf)>Vb||hf.bottom<Vb)zd.push(hf),this.Vca.splice(He,1),Gc=!0}for(He=this.tableManager.rangeList.length-1;0<=He;He--){hf=this.tableManager.rangeList[He];const zf=this.qtd(hf);zf<=Vb&&hf.bottom>=Vb&&!(zf<=this.cTa&&hf.bottom>=this.cTa)&&hf.Aoa&&(ae.push(hf),Gc=!0)}if(Gc){hf=this.gridView.Lzc;for(let zf of hf)for(let vg of zf)for(let gh of vg)this.Aqc?this.egh(gh,zd,ae):this.fgh(gh,zd,ae,Gc)}else ba.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");
this.cTa=Vb}};this.MPf=(Vb,Gc)=>{Gc.isRow||Gc.$5c(this.knc)};this.NPf=(Vb,Gc)=>{Gc.isRow||(this.tableManager.rangeList.length||this.deactivate(),Gc.pWd(this.knc))};this.knc=(Vb,Gc)=>{if(this.Rf())this.activate();else if(Vb=this.active,this.deactivate(),!Vb){ba.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlock: detected an opportunity for bailing out");return}(Gc=Gc.lx)&&this.smg(Gc.X8,Gc)};this.xSf=(Vb,Gc)=>{!this.gridView.It&&(this.Rf()?this.activate():(Vb=this.active,
this.deactivate(),Vb||ba.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),Gc=Gc.lx)&&(Vb=Ig.a(Gc.X8),this.smg(Vb,Gc)&&Gc.N0d(Vb))};this.hg=()=>{this.gridView.jd.gQ?this.deactivate():this.activate()};this.tableManager=D;this.gridView=ha;this.$=ha.$;this.Zd=fb;D.N5c(this.xSf);ha.CZg(this.MPf);ha.DZg(this.NPf);this.$.va.Ri(this.hg);this.$.Ud.Ri(this.hg);this.dGe(Vb=>{Vb.$5c(this.knc)});this.Rf()&&(this.activate(),this.uz(this,null));
this.$.ga.Qa(68,this)}dispose(){this.deactivate();this.gridView&&(this.tableManager.eWd(this.xSf),this.gridView.vBj(this.MPf),this.gridView.wBj(this.NPf),this.$.va.uj(this.hg),this.$.Ud.uj(this.hg),this.dGe(D=>{D.pWd(this.knc)}));this.gridView=this.tableManager=this.Vca=null}get Aqc(){return this.gridView.YD}UKc(D,ha,fb){if(!yf.b(this.$.na)||this.$.ea.isNamedObjectViewMode||this.gridView.jd.oGa)return ha&&ba.ULS.sendTraceTag(509166923,0,50,"HeaderSnappingFeature.toggleHeaderSnapping: Header snapping should be disabled in named object view or in top row frozen."),
!0;const Vb=fb.Wif();var Gc=Vb.length;if(Vb[Gc-1]<D.left)return!1;var zd=jd.HelperMethods.cA(new Ki.a(Vb),0,Gc,D.left,jd.HelperMethods.yI);if(0>zd)return!1;const ae=D.X7d,He=D.MHe;Gc=Math.min(ae.length+zd,Gc);let hf=0;if(!He)return ba.ULS.sendTraceTag(509220160,0,10,"HeaderSnappingFeature.toggleHeaderSnapping: autoFilterDatas should be initialized."),!1;for(;zd<Gc;zd++){const zf=Vb[zd];ha?(fb.updateCellText(zd,ae[hf]),fb.updateCellAlignment(zd,!0),fb.activateCellAutoFilter(zd,He[hf]),this.wAe(D,hf,
zf)):(fb.updateCellText(zd,Sf.Range.JP(zf)),fb.updateCellAlignment(zd,!1),fb.deactivateCellAutoFilter(zd),this.pZe(zf));ha&&fb.gRj();hf++}fb.Ds("HeaderSnappingFeature::toggleHeaderSnapping");D.JFa=ha;return!0}VKc(D,ha,fb,Vb){if(!yf.b(this.$.na)||this.$.ea.isNamedObjectViewMode||this.gridView.jd.oGa)return!0;if(!fb.length)return!1;var Gc=Vb.length;if(Vb[Gc-1]<D.left)return!1;var zd=jd.HelperMethods.cA(new Ki.a(Vb),0,Gc,D.left,jd.HelperMethods.yI);if(0>zd)return!1;const ae=D.X7d,He=!!D.s5a&&0<D.s5a.length,
hf=!!D.menuModel&&0<D.menuModel.length;for(let gh=zd,Kh=0,th=Math.min(ae.length+zd,Gc);gh<th;gh++,Kh++)if(Gc=fb[gh]){var zf=null;(zd=Gc.getElementsByClassName(Ji.a.Okd))&&(zf=zd[0]);if(zf&&zf.innerText){if(zd=Gc.getElementsByClassName(Ji.a.LDe))for(var vg=zd.length-1;0<=vg;vg--)Gc.removeChild(zd[vg]);zd=Vb[gh];ha?(zf.innerText=ae[Kh],Gc.classList.add(Ji.a.I4e),He&&D.s5a[Kh]&&(zf=document.createElement("div"),this.Zd.Tj(zf,D.s5a[Kh]),vg=D.s5a[Kh].split(ii.a.j3g),3===vg.length?(vg=di.a.mh(vg[1]),this.Tze(zf.firstChild,
vg),Pe.a.instance.ta(ze.a.Bh,zf.firstChild,this.onPointerDown),Ti.a.instance.ta(ze.a.Er,zf.firstChild,this.onPointerDown)):(vg=new ng.a(this.$.va),(vg.Rf(2048)||vg.Rf(4096))&&ba.ULS.sendTraceTag(509678873,0,10,"HeaderSnappingFeature.toggleHeaderSnappingHtml: buttonHtml doesn't contain click/pointer handlers for ShowAutoFilterMenu"),this.Tze(zf.firstChild,null)),hf&&D.menuModel[Kh]&&this.wAe(D,Kh,zd),Gc.appendChild(zf.firstChild))):(Gc.classList.remove(Ji.a.I4e),zf.textContent=Sf.Range.JP(zd),this.pZe(zd))}}D.JFa=
ha;return!0}Tze(D,ha){of.a.instance.ta(ze.a.click,D,fb=>{if(ha){const {row:Vb,col:Gc}=jd.HelperMethods.dhf(ha);this.gridView.AYd(fb.Ba.rawEvent,966232027,ha,this.$.get_id(),Vb,Gc)}return!0})}wAe(D,ha,fb){this.$.ga.qd(8,Vb=>{Vb.kic.n$i(D,ha,fb)})}pZe(D){this.$.ga.qd(8,ha=>{ha.kic.o$i(D)})}fgh(D,ha,fb,Vb){const Gc=D.kx,zd=Ig.a(D.X8);let ae;for(let He=ha.length-1;0<=He;He--)ae=ha[He],this.VKc(ae,!1,zd,Gc)&&ha.splice(He,1);for(ha=fb.length-1;0<=ha;ha--)ae=fb[ha],this.VKc(ae,!0,zd,Gc)&&this.Vca.push(ae);
Vb&&D.N0d(zd)}egh(D,ha,fb){if(D.ndh()){for(var Vb=ha.length-1;0<=Vb;Vb--)this.UKc(ha[Vb],!1,D)&&(ba.ULS.sendTraceTag(509166921,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table deactivation succeeded"),ha.splice(Vb,1));for(ha=fb.length-1;0<=ha;ha--)Vb=fb[ha],this.UKc(Vb,!0,D)&&(ba.ULS.sendTraceTag(509166919,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table activation succeeded"),this.Vca.push(Vb))}else ba.ULS.sendTraceTag(509166922,0,15,"HeaderSnappingFeature.checkTablesForSnapping: headerViewBlock can't be snapped")}smg(D,
ha){const fb=this.Aqc?ha.Wif():ha.kx;var Vb=fb[0];const Gc=fb[fb.length-1],zd=this.Cji(Vb,Gc);let ae=!1;for(let He=this.Vca.length-1;0<=He;He--){const hf=this.Vca[He];Gc>=hf.left&&Vb<=hf.right&&(this.Aqc?this.UKc(hf,!1,ha):this.VKc(hf,!1,D,fb),this.Vca.splice(He,1),ae=!0)}for(let He=0,hf=zd.length;He<hf;He++)if(Vb=zd[He],this.Aqc?this.UKc(Vb,!0,ha):this.VKc(Vb,!0,D,fb))this.Vca.push(zd[He]),ae=!0;return ae}activate(){this.Rf()&&!this.active&&(this.gridView.view.Rt(this.uz),this.active=!0)}deactivate(){this.active&&
(this.gridView.view.Cs(this.uz),this.active=!1)}Rf(){return yf.b(this.$.na)&&!this.$.ea.isNamedObjectViewMode&&0>=this.gridView.jd.hS&&0<this.tableManager.rangeList.length}dGe(D){const ha=this.gridView.Lzc;for(let fb of ha)for(let Vb of fb)for(let Gc of Vb)D(Gc)}Cji(D,ha){const fb=[];if(!this.active)return fb;this.cTa=this.gridView.rtd();for(let Vb=this.tableManager.rangeList.length-1;0<=Vb;Vb--){const Gc=this.tableManager.rangeList[Vb];Gc.bottom>=this.cTa&&this.qtd(Gc)<=this.cTa&&Gc.left>=D&&Gc.right<=
ha&&Gc.Aoa&&fb.push(Gc)}return fb}qtd(D){const ha=this.gridView.zd.sh(D);return ha&&this.tableManager.huf(D,ha.usedRange.topLeft)?D.top+1:D.top}}Object(da.a)(Zi,"HeaderSnappingFeature",null,[5]);class Rh extends Ta.a{constructor(D){super();this.$=D;this.je()}create(){const D=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:8111699_MigrateTableManager")?Object(Ve.d)(je.a.resolve(Fd.Vc,{Ja:this.Ta})):df.GetServiceTaskFactory.create(this.$.ga,134,this.ka,this.Ta),ha=Object(Ve.d)(je.a.resolve(Fd.Ab,{Ja:this.Ta}));
qa.TaskExtensions.za(qa.TaskExtensions.Wf([ha],this.ka),()=>{qa.TaskExtensions.za(qa.TaskExtensions.Wf([D],this.ka),()=>{this.Ld(this.$.ga.Da(68)||new Zi(D.result,$a.h(this.$),ha.result))},this.ka,11)},this.ka,3)}static la(D){D.ga.Qa(67,new Rh(D))}}Object(da.a)(Rh,"HeaderSnappingFactory",Ta.a,[]);var Lh=a(164),Xh=a(617);class qi extends Xh.a{constructor(){super()}dispose(){Lh.WacAirSpace.Pyd()&&Lh.WacAirSpace.SKc()}animate(D,ha,fb,Vb,Gc){ha&&Lh.WacAirSpace.sO(D.element,ha);Lh.WacAirSpace.animate(D,
Vb,Gc);fb&&Lh.WacAirSpace.Ryj(D.element,fb)}}Object(da.a)(qi,"AnimationManager",Xh.a,[5]);new b(0,0,0,0,0,0);new b(1,1,0,0,0,0);new b(2,2,0,0,0,0);new b(3,3,0,0,0,1);new b(4,3,1,0,1,1);new b(5,3,0,0,.42,1);new b(6,3,.83,0,1,1);new b(7,3,0,0,.58,1);new b(8,3,.42,0,.58,1);new b(9,3,.1,.25,.75,.9);new b(10,3,.1,.9,.2,1);new b(11,3,.1,.9,.2,1);new b(12,3,.9,.1,.2,1);new b(13,3,.4,0,0,1);new b(14,3,.13,.21,.1,.7);new b(15,3,.02,.33,.38,.77);new b(16,3,.57,.17,.95,.75);new b(17,3,0,.19,.07,.72);new b(18,
3,0,0,.95,.37);new b(19,3,.66,0,.34,1);new b(20,3,.8,0,.2,1);new b(21,3,.8,0,.2,1);h.prototype={type:0,startTime:new c(0,null),endTime:new c(0,null),rsk:new c(0,null),trk:new c(0,null),operationType:0};var Tg=Array(1);Tg[0]=new c(0,0);new k(0,[new h(5,0,0,0,null,1,1,0)]);new k(1,[new h(5,2,0,0,null,0,2,0),new h(5,2,0,50,null,1,1,0)]);new k(2,[new h(1,3,0,167,null,0,1,1),new h(2,3,0,167,null,0,1,1)]);new k(3,[new h(3,3,0,167,null,0,1,1),new h(4,3,0,167,null,0,1,1)]);new k(4,[new h(5,2,0,0,null,0,2,
0),new h(5,2,0,167,null,1,1,0)]);new k(5,[new h(5,2,0,167,null,0,1,0)]);new k(6,[new h(1,3,0,100,null,0,1,1),new h(2,3,0,100,null,0,1,1)]);new k(7,[new h(3,3,0,100,null,0,1,1),new h(4,3,0,100,null,0,1,1)]);new k(8,[new h(5,2,0,100,null,1,1,0)]);new k(9,[new h(5,2,0,0,null,0,2,0),new h(5,2,0,100,null,1,1,0)]);new k(10,[new h(5,2,0,100,null,0,1,0)]);new k(11,[new h(1,3,0,267,null,0,1,1),new h(2,3,0,267,null,0,1,1)]);new k(12,[new h(3,3,0,267,null,0,1,1),new h(4,3,0,267,null,0,1,1)]);new k(13,[new h(5,
2,0,267,null,1,1,0)]);new k(14,[new h(5,2,0,0,null,0,2,0),new h(5,2,0,267,null,1,1,0)]);new k(15,[new h(5,2,0,267,null,0,1,0)]);new k(16,[new h(6,3,0,267,null,0,1,1),new h(7,3,0,267,null,0,1,1)]);new k(17,[new h(1,3,0,750,null,0,1,1),new h(2,3,0,750,null,0,1,1)]);new k(18,[new h(3,3,0,750,null,0,1,1),new h(4,3,0,750,null,0,1,1)]);new k(19,[new h(5,2,0,750,null,1,1,0)]);new k(20,[new h(5,2,0,0,null,0,2,0),new h(5,2,0,750,null,1,1,0)]);new k(21,[new h(6,3,0,1E3,null,0,1,1),new h(7,3,0,1E3,null,0,1,
1)]);new k(22,[new h(1,3,0,367,null,0,1,1),new h(2,3,0,367,null,0,1,1)]);new k(23,[new h(3,3,0,367,null,0,1,1),new h(4,3,0,367,null,0,1,1)]);new k(24,[new h(5,2,0,367,null,1,1,0)]);new k(25,[new h(5,2,0,0,null,0,2,0),new h(5,2,0,367,null,1,1,0)]);new k(26,[new h(5,2,0,367,null,0,1,0)]);new k(27,[new h(6,2,0,Tg[0],null,0,1,1),new h(7,2,0,Tg[0],null,0,1,1)]);new k(28,[new h(5,2,0,0,null,1,1,0),new h(5,2,0,50,null,0,1,0)]);new k(29,[new h(1,3,0,433,null,0,1,1),new h(2,3,0,433,null,0,1,1)]);new k(30,
[new h(5,2,0,0,null,0,2,0),new h(5,2,0,50,null,1,1,0),new h(2,3,0,0,null,40,1,1),new h(2,3,0,100,null,0,1,1)]);new k(31,[new h(2,0,0,0,null,32,1,1),new h(2,0,0,100,null,32,1,1),new h(2,3,101,350,null,0,1,1),new h(3,0,0,0,null,0,2,1),new h(3,0,0,100,null,0,2,1),new h(3,3,101,350,null,0,1,1),new h(5,0,0,0,null,0,2,0),new h(5,0,0,100,null,1,1,0)]);new k(32,[new h(2,3,0,267,null,32,1,1),new h(3,3,0,267,null,0,2,1),new h(5,2,0,0,null,1,0,0),new h(5,2,0,267,null,0,2,0)]);new k(33,[new h(5,2,0,0,null,0,
2,0),new h(5,2,0,100,null,0,2,0),new h(5,2,101,267,null,1,1,0)]);new k(34,[new h(1,10,0,300,null,0,1,1),new h(2,10,0,300,null,0,1,1)]);new k(35,[new h(3,10,0,300,null,0,1,1),new h(4,10,0,300,null,0,1,1)]);new k(36,[new h(1,8,0,750,null,0,1,1),new h(2,8,0,750,null,0,1,1)]);new k(37,[new h(5,2,0,0,null,0,2,0),new h(5,2,0,200,null,0,2,0),new h(5,3,201,500,null,1,1,0)]);new k(38,[new h(1,2,0,0,null,0,2,1),new h(2,2,0,0,null,0,2,1),new h(1,2,0,200,null,0,2,1),new h(2,2,0,200,null,0,2,1),new h(1,3,201,
267,null,0,1,1),new h(2,3,201,267,null,0,1,1)]);new k(39,[new h(1,3,0,267,null,0,1,1),new h(2,3,0,267,null,0,1,1)]);new k(40,[new h(5,2,0,0,null,0,2,0),new h(5,2,0,267,null,1,1,0)]);new k(41,[new h(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(D){window.setTimeout(D,
16)}}();d.prototype={ih:null,$2g:5,cvb:null,L6c:0,startTime:null,duration:null,hgc:null,y8c:-1,oJd:-1,LId:-1};d.prototype.Start=function(){this.startTime=new Date;this.hgc={}};d.prototype.GetRecentAnimationStats=function(){for(var D=[],ha=0,fb=mi.L6c;fb<mi.$2g;fb++)null!=mi.cvb[fb]&&(D[ha]=mi.cvb[fb],ha++);for(fb=0;fb<mi.L6c;fb++)null!=mi.cvb[fb]&&(D[ha]=mi.cvb[fb],ha++);return D};d.prototype.GetAnimationSqmStats=function(){var D=[];D[0]=0>mi.y8c?0:mi.y8c;D[1]=0>mi.oJd?0:mi.oJd;D[2]=0>mi.LId?0:mi.LId;
return D};var mi=new d,Ih=a(57),ei=a(196);class aj{constructor(){this.Vue=this.I0c=!1;const D=na.AFrameworkApplication.accessTokenTtl;0>=D||(this.accessTokenTtl=D,ba.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.accessTokenTtl,["NowGetTime"]:(new Date).getTime(),["BootTime"]:na.AFrameworkApplication.Ila}),ei.a.instance.U5c(Object(La.a)(this,this.FUa,"onSessionExpiredDetected")),ei.a.instance.S5c(Object(La.a)(this,this.YTf,"onSessionExpiringDetected")))}FUa(){ei.a.instance.kWd(Object(La.a)(this,
this.FUa,"onSessionExpiredDetected"));ba.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.Zoi()}YTf(){ei.a.instance.jWd(Object(La.a)(this,this.YTf,"onSessionExpiringDetected"));this.Vue||this.I0c||(ba.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.Vue=!0,this.z1j())}Zoi(){this.I0c||(na.AFrameworkApplication.pu(Ih.a.$Fc),this.I0c=!0,this.y1j())}}Object(da.a)(aj,"ASessionExpirationManager",null,[]);var vj=a(262),kj=a(87),Nj=a(266);class wj extends aj{constructor(D){super();
this.Ua=new qb.a;this.QH=this.btb=!1;this.$=D}GCe(D){this.Ua.addHandler("SessionExpired",D)}Aub(D){this.Ua.addHandler("TokenRefreshed",D)}sDc(D){this.Ua.removeHandler("TokenRefreshed",D)}get accessTokenExpiringMessage(){const D=(new Date(this.accessTokenTtl)).format(this.$.xa.ShortTimeFormat);return String.format(Od.a.instance.xd(78),D)}get tokenExpired(){return this.btb}get Yjb(){return!1}get Yfa(){return!1}get mUd(){return!1}get W9(){return!1}fnc(){return ei.a.instance.vQ(na.AFrameworkApplication.accessTokenTtl)}dispose(){oc.a.Ma(this.Ua);
this.$=null}z1j(){this.$.isEditMode&&this.Amc(!1)}y1j(){this.btb=!0;this.Amc(!0);this.Ua.raiseEvent("SessionExpired")}Amc(D){ba.ULS.sendTraceTag(537170715,0,15,`EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired ${D}, GotDeploymentOrTimedOutError ${this.$.ea.y2}`);const ha=this.$.yd.qr;D&&ha&&ha.isVisible&&1299163859===ha.error.MessageId&&this.$.yd.qr.Ux();const fb=this.qf(D);Ld.a(this.$).zs(new vj.a($c.a.ix,5,()=>{const Vb=Dd.a(this.$),Gc=Vb.rf.activityState;Gc[kj.a.w6]=
this.$.owb(this.$.isEditMode);Gc[kj.a.nP]=kj.a.Deb;Gc[Nj.a.Lq]=$c.a.accessTokenExpiringWarning;Vb.rf.Us([fb])}))}qf(D){return D?zh.a.Xed():this.Pth()}Pth(){const D=zh.a.qf(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");D.Description=this.accessTokenExpiringMessage;return D}}Object(da.a)(wj,"EwaAccessTokenExpirationManager",aj,[659,172,5]);var Cg=a(175),Ei=a(64),pj=a(662);class Gj{constructor(D,ha){this.PQb=!1;this.correlationID=D;this.mfd=ha;this.$Kc=!1;this.creationTime=Hc.a.$b.ke}}Object(da.a)(Gj,
"RefreshAccessTokenContext",null,[]);var rj=a(161),Li=a(162),Mi=a(37),si=a(130);class bj{}Object(da.a)(bj,"Error",null,[]);class $i{}Object(da.a)($i,"NamedResult",null,[]);class Ni extends $i{}Object(da.a)(Ni,"ErrorInfo",$i,[]);class ti{constructor(D,ha){this.U5b=D;this.vJ=ha}get tokens(){return this.U5b}get errors(){return this.vJ}}Object(da.a)(ti,"TokenRefreshArgs",null,[660]);class xj{constructor(D,ha){this.documentVisibilityObserver=null;this.Ua=new qb.a;this.gA=null;this.Gkb=this.Vrb=!1;this.iCc=
null;this.YQb=!1;this.oHd=!0;this.Zne=this.wne=this.QH=this.btb=!1;this.eW=null;this.glf=()=>{if(this.$.ea.oe)this.Clf(!1);else if(this.oHd){this.oHd=!1;const fb=Dd.a(this.$);ba.ULS.sendTraceTag(537170709,0,50,`EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [${fb.Yj?fb.Yj.activityName:"None"}] TimeUntilTokenExpirationInMin [${this.Hqg()}]`)}};this.ff=(fb,Vb)=>{this.context&&(fb=this.$.ea,Vb.nI&&this.context.PQb&&!this.context.$Kc?
(this.context.$Kc=!0,Vb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},Vb.IsUserActive=fb.Ah.us,Vb.RefreshAccessTokenCorrelationID=this.context.correlationID,Vb=yd.a.He(Vb),ba.ULS.sendTraceTag(537170708,0,50,Vb)):!this.Vrb||fb.oe||this.context.mfd||(Vb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},this.gA&&(this.gA.cancel(),Vb.Aborted=!0,Vb.ResetStopRefreshRetriesUntilTokenExpired=!0,this.Gkb=!1),Vb.TimeUntilTokenExpirationInMin=
this.Hqg(),Vb.RefreshAccessTokenCorrelationID=this.context.correlationID,Vb=yd.a.He(Vb),ba.ULS.sendTraceTag(572019856,0,50,Vb)))};this.ADa=()=>{if(this.context&&this.context.PQb&&!this.context.$Kc){var fb={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};fb.CreatedForExpired=this.context.mfd;fb.RefreshAccessTokenCorrelationID=this.context.correlationID;fb.OpenWorkbookErrors=zh.a.ue(this.$.ea.DI);fb.ExecutionContextErrors=zh.a.ue(Dd.a(this.$).rf.errors);fb.accesstokenTTL=na.AFrameworkApplication.accessTokenTtl;
fb=yd.a.He(fb);ba.ULS.sendTraceTag(537170707,0,15,fb)}};this.Blf=()=>{this.Gkb=!1;this.Clf(!0)};this.KOd=()=>{this.YQb&&(this.$.ea.Ah.FEa(this.KOd),this.YQb=!1);this.ing()};this.$=D;this.l8d=ha;this.jUd=D.Sd.fi("WebServiceCall","refreshToken");ei.a.instance.U5c(this.Blf);ei.a.instance.S5c(this.glf);ha=this.$.ea;ha.Zl(this.ff);ha.b8b(this.ADa);this.CYi=this.$.xa.MinTokenLifetimeForRegularExpirationPromptInMin;this.rig=this.$.xa.ShortAccessTokenExpirationPromptSeconds;this.P3f=this.$.xa.RefreshAccessTokenDurationLimitInSec;
this.Mwg(D.ea.$Wf,na.AFrameworkApplication.accessTokenTtl);D=JSON.stringify({["AccessTokenTtl"]:na.AFrameworkApplication.accessTokenTtl,["NowGetTime"]:(new Date).getTime(),["BootTime"]:na.AFrameworkApplication.Ila,["WopiTokenExpiresAfterMinutes"]:na.AFrameworkApplication.gce,["WopiTokenTaskItemPriority"]:na.AFrameworkApplication.ice});ba.ULS.sendTraceTag(537170714,217,50,`Initializing EwaAccessTokenExpirationRefreshManager. ${D}`);ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",
!1)?void je.a.resolve(Fd.O).then(fb=>{this.documentVisibilityObserver=fb}):this.$.ga.qd(291,fb=>{this.documentVisibilityObserver=fb})}GCe(D){this.Ua.addHandler("SessionExpired",D)}Aub(D){this.Ua.addHandler("TokenRefreshed",D)}sDc(D){this.Ua.removeHandler("TokenRefreshed",D)}get tokenExpired(){return this.btb}get Yfa(){return this.wne}get W9(){return this.Zne}get context(){return this.eW}get Yjb(){return this.W9?!1:this.$.ea.Ah.us?1>si.a.u$:6>si.a.v$}get mUd(){return this.Vrb}fnc(){return ei.a.instance.vQ(na.AFrameworkApplication.accessTokenTtl)}dispose(){ei.a.instance.kWd(this.Blf);
ei.a.instance.jWd(this.glf);const D=this.$.ea;D&&(D.gm(this.ff),D.uDc(this.ADa));oc.a.Ma(this.Ua);this.documentVisibilityObserver=this.$=null}Hqg(){return this.fnc()?0:(na.AFrameworkApplication.accessTokenTtl-(new Date).getTime())/6E4}Mwg(D,ha){if(0<ha&&!this.fnc()){const fb=na.AFrameworkApplication.da.Hf("AccessTokenExpirationPromptSeconds",na.AFrameworkApplication.G0),Vb=(ha-D.getTime())/6E4;ba.ULS.shipAssertTag(537170713,0,0<=Vb,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [${ha}] creationTime [${D.getTime()}] tokenLifetimeInMin [${Vb}]`);
Vb<this.CYi?(ba.ULS.sendTraceTag(537170712,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${this.rig}] tokenLifetimeInMin [${Vb}]`),na.AFrameworkApplication.G0=this.rig):na.AFrameworkApplication.G0!==fb&&(ba.ULS.sendTraceTag(537170711,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${fb}] tokenLifetimeInMin [${Vb}]`),na.AFrameworkApplication.G0=fb)}}ooh(D){return!this.context||
this.context.PQb||this.context.mfd!==D?(D=new Gj(Cg.a.create().toString(),D),this.context&&!this.context.$Kc&&ba.ULS.sendTraceTag(537170710,0,15,`TokenManager.InitContext: creating new context [${D.correlationID}] although previeous one [${this.context.correlationID}] not used successfully, isPreviousOneRefreshedSuccessfully [${this.context.PQb}] `),this.eW=D,!0):!1}iGj(D){D&&this.QH&&!this.Yfa&&this.$.ea.Ah.us&&!this.W9&&(this.QH=!1)}Clf(D){this.iGj(D);if(!(this.Vrb||this.Gkb&&!D||this.QH)&&this.Yjb){this.Vrb=
!0;var ha=this.context?this.context.creationTime:null,fb=this.ooh(D);this.oHd=!0;var Vb=this.$.ea,Gc={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh"};Gc.newContextCreated=fb;Gc.IsUserActive=Vb.Ah.us;Gc.IsSessionActive=Vb.oe;Gc.ContainsChangesWorkbookOperations=this.$.userOperationManager.aNa();Gc.isSessionExpired=D;Gc.stopRefreshRetriesUntilTokenExpired=this.Gkb;Gc.FailedToRefreshExpiredToken=this.QH;Gc.numOfFailuresWhileUserIsActive=si.a.u$;Gc.numOfFailuresWhileUserIsInActive=si.a.v$;
Gc.numOfFailuresWhileOffline=si.a.ZCa;Gc.RefreshAccessTokenCorrelationID=this.context.correlationID;fb&&ha&&(Gc.TimeInMinFromPreviosContextCreation=Math.round(wd.b(Hc.a.$b,ha)/60));ha=yd.a.He(Gc);ba.ULS.sendTraceTag(40416199,0,50,ha);this.jUd.start();this.wne=Vb.Ah.us;this.gA=new pj.a;this.LPi(D);var zd=this.l8d.iwj(!D,this.gA?this.gA.token:null);zd.continueWith(()=>{this.Zgh();const ae=this.l8d.Mpj(zd);this.jUd.stop();const He=this.fnc();if(!ae||ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&
He){const hf=zd.result.errors;ae&&He&&this.sVg(hf);this.Hoi(hf,D)}else this.Gkb=!1,this.Joi(zd.result.tokens,D);this.Vrb=!1},8)}}sVg(D){const ha=[Object(Rd.a)(new bj,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];D.add(Object(Rd.a)(new Ni,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:ha}))}LPi(D){D&&(this.$.ea.Ah.us?this.ing():(this.$.ea.Ah.Wwa(this.KOd),this.YQb=!0))}ing(){this.iCc=rj.AsyncMethodContext.Wr(()=>{this.hwj()},1E3*this.P3f,ed.a.Pvj,this.iCc)}Zgh(){this.iCc&&
this.iCc.cancel();this.YQb&&(this.$.ea.Ah.FEa(this.KOd),this.YQb=!1);this.gA=null}hwj(){ba.ULS.sendTraceTag(537170706,0,15,`EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [${this.P3f}]`);this.gA.cancel()}Hoi(D,ha){this.Gkb=!0;ha&&(this.QH||(this.btb=this.QH=!0),this.l8d.SIb(D)&&(this.Zne=!0));const fb=!ha||this.Yjb&&!si.a.IHc?40380379:39982555;ha=this.GSe(ha);ha.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";ha.FailedToRefreshExpiredToken=
this.QH;ha.LastErrorIsPermanent=this.W9;if(0<D.count){var Vb=D.ma(0);ha.errorName=Vb.Name;0<Vb.Errors.length&&(ha.ErrorId=Vb.Errors[0].Id,Vb=Vb.Errors[0].Details,ha.ErrorDetails=this.pCh(Vb.toString())?"PiiScrubbed":Vb)}ha=yd.a.He(ha);ba.ULS.sendTraceTag(fb,0,15,ha);this.Ua.raiseEvent("TokenRefreshed",new ti(null,D))}pCh(D){return ge.a.contains(D,"makes the internet safe for businesses",!0)}GSe(D){const ha={},fb=this.$.ea;ha.Name="";ha.IsUserActive=fb.Ah.us;ha.IsSessionActive=fb.oe;ha.GotDeploymentOrTimedOutError=
fb.y2;ha.TimeInSecFromLastStatefulSuccessfulRequest=fb.y_;ha.TimeFromLastUserActivityInMs=fb.Ah.hlb;ha.calledFromSessionExpiredFlow=D;ha.RefreshTokenDurationInMS=this.jUd.Te;ha.numOfFailuresWhileUserIsActive=si.a.u$;ha.numOfFailuresWhileUserIsInActive=si.a.v$;ha.numOfFailuresWhileOffline=si.a.ZCa;ha.RefreshAccessTokenCorrelationID=this.context.correlationID;ha.accessTokenTTL=na.AFrameworkApplication.accessTokenTtl;ha.ContainsChangesWorkbookOperations=this.$.userOperationManager.aNa();ha.IsDocumentHidden=
this.documentVisibilityObserver?this.documentVisibilityObserver.hj.toString():"Unknown";ha.TimeFromFirstOpenInHr=Math.floor(wd.b(Hc.a.$b,gd.toUtc(fb.$Wf))/3600);return ha}Joi(D,ha){this.QH=!1;this.nkk();this.Mwg(new Date,na.AFrameworkApplication.accessTokenTtl);const fb=this.$.ea,Vb=!ha&&fb.Ah.us,Gc=!this.$.isEditMode&&fb.Ehb;ha=this.GSe(ha);ha.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";ha.shouldTriggerSilentReloadAfterExpiring=Vb;ha.WopiTokenTaskItemPriority=na.AFrameworkApplication.ice;
ha.isDirtyViewSession=Gc;ha=yd.a.He(ha);ba.ULS.sendTraceTag(39982556,0,15,ha);this.Ua.raiseEvent("TokenRefreshed",new ti(D,null));Gc?fb.Ah.us&&(ba.ULS.sendTraceTag(537170705,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),fb.lnd()):fb.Ah.us?Vb&&(D=Dd.a(this.$).rf.activityState,D[si.a.Glb]=!0,D[Li.a.K0]=!0,D[Mi.a.Bu]=this.$.isEditMode,Ld.a(this.$).zs(new vj.a($c.a.osa,2,null))):fb.oe&&be.j(this.$.qa.ua,
!0,!1,!1,null,null,null,null,null)}nkk(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=Ei.a.UW(this.$.ea.workbookContext.WorkbookUri,na.AFrameworkApplication.SJ,na.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=Ei.a.UW(this.$.ea.workbookContext.WorkbookUri,na.AFrameworkApplication.wM,na.AFrameworkApplication.accessTokenTtl.toString()),this.$.ea.nzc()):ba.ULS.sendTraceTag(537170704,0,15,
"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");this.$.xa.AccessToken=na.AFrameworkApplication.accessToken;this.$.xa.AccessTokenValidTo=na.AFrameworkApplication.accessTokenTtl;void 0!==this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion=Ei.a.UW(this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion,na.AFrameworkApplication.SJ,na.AFrameworkApplication.accessToken),
this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion=Ei.a.UW(this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion,na.AFrameworkApplication.wM,na.AFrameworkApplication.accessTokenTtl.toString()));void 0!==this.$.xa.EmbedConfiguratorUrl&&null!==this.$.xa.EmbedConfiguratorUrl&&(this.$.xa.EmbedConfiguratorUrl=Ei.a.UW(this.$.xa.EmbedConfiguratorUrl,na.AFrameworkApplication.SJ,na.AFrameworkApplication.accessToken),this.$.xa.EmbedConfiguratorUrl=Ei.a.UW(this.$.xa.EmbedConfiguratorUrl,na.AFrameworkApplication.wM,
na.AFrameworkApplication.accessTokenTtl.toString()));this.context.PQb=!0}}Object(da.a)(xj,"EwaAccessTokenExpirationRefreshManager",null,[659,172,5]);class Bg{}Bg.R6b="ActivityDuration";Bg.error="Error";Bg.Hjd="Errors";Bg.failed="Failed";Bg.qWh="FirstActivity";Bg.initialized="Initialized";Bg.YNi="LastActivity";Bg.K$f="RetryOverride";Bg.FFj="RequestGroups";Bg.requests="Requests";Bg.p$f="Responses";Bg.aGc="SessionDuration";Bg.status="Status";Bg.success="Success";Bg.successful="Successful";Bg.tokens=
"Tokens";Object(da.a)(Bg,"SessionExpirationStrings",null,[]);class sh{constructor(D){this.fr={};this.S_={};this.qOg={};this.XCf=15;this.pne=!1;this.ZPg=new Date;this.r2b=new Date;this.fg=D;this.I5b=new qc.a(2,2,6E4*this.XCf,Object(La.a)(this,this.Kzg,"writeMeasures"),135,"SL",!1);this.fg.Sh(this.I5b);this.Ywi()}Kzg(){ba.ULS.sendTraceTag(41964821,217,50,ba.ULS.He({["Aggregate"]:this.S_,["Current"]:this.fr}))}Ywi(){this.S_[Bg.FFj]=0;this.S_[Bg.requests]=0;this.S_[Bg.p$f]=0;this.S_[Bg.status]=Bg.initialized;
this.S_[Bg.qWh]=new Date;this.S_[Bg.aGc]=0;this.S_[Bg.R6b]=0;this.S_[Bg.aGc]=0;this.fr[Bg.aGc]=0;this.S_[Bg.R6b]=0;this.fr[Bg.R6b]=0}oxd(D,ha){var fb=D[ha];fb=fb?fb:0;fb++;D[ha]=fb;this.R0d(D)}R0d(D){const ha=new Date;D[Bg.R6b]=+ha-+this.r2b;this.r2b=ha;D[Bg.aGc]=+this.r2b-+this.ZPg;D[Bg.YNi]=this.r2b}I4(D,ha){this.fr[D]=ha;this.R0d(this.fr)}n0d(D,ha){this.fr[D]=ha;this.R0d(this.fr)}incrementCounter(D){this.oxd(this.fr,D);this.oxd(this.S_,D);this.oxd(this.qOg,D)}flush(){this.pne||(this.S_[Bg.status]=
this.fr[Bg.status],this.Kzg(this.I5b),this.fg.Ura(this.I5b,6E4*this.XCf))}stop(){ba.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.pne=!0;this.fg.rr(this.I5b)}}Object(da.a)(sh,"SessionLogger",null,[683]);var Oi=a(475),ji=a(1E3),ui=a(174),fi=a(119);class ri{constructor(D,ha,fb,Vb,Gc,zd,ae,He,hf,zf){Vb=void 0===Vb?null:Vb;Gc=void 0===Gc?!1:Gc;zd=void 0===zd?null:zd;ae=void 0===ae?!1:ae;He=void 0===He?!1:He;hf=void 0===hf?!1:hf;zf=void 0===zf?!1:zf;this.Kca=
0;this.o6=this.Yk=null;this.U5b=new Ub.a;this.vJ=new Ub.a;this.Gm=null;this.q1a=!1;this.dtb=this.etb=null;this.fg=D;this.rse=ha;this.rse.execute(vg=>{vg.fm(ag.a.vwd,Object(La.a)(this,this.s$i,"onHostResponseReceived"))});this.NJ=fb;this.Vwe=new ji.a("WebServiceCall","TokenRefresh");this.tm=Vb||new sh(D);this.UPg=Gc;this.FW=zd?zd:Zd.SessionStatusManager.instance;this.Vie=ae;this.G0b=He;this.eQg=hf;this.fQg=zf}s$i(D){if(D.MessageId!==ag.a.vwd)fi.a(39408099,306,15,"Unexpected message.");else{var ha=
new Ub.a,fb=new Ub.a;this.tm.incrementCounter(Bg.p$f);var Vb=D.Values[Tf.a.aeg];if(!Vb||0>=Vb.length)fi.a(40122317,306,15,"Found no tokens in the dictionary"),Vb=D.Values;fi.a(40122318,306,100,"The Tokens array contains {0} tokens",Vb.length);this.tm.I4("Correlation",D.CorrelationId);var Gc="";for(let He=0;He<Vb.length;He++){this.tm.n0d(Bg.tokens,Vb.length);var zd=Vb[He],ae=zd;if(!ae||!ae.Name)continue;this.tm.incrementCounter(ae.Name);const hf=zd;if(hf&&hf.Value)fi.a(39408128,306,100,"Received token with name: {0}",
hf.Name),ha.add(hf),this.U5b.add(hf),this.G0b||this.tm.I4(Bg.status,Bg.success),this.Vie&&this.FW&&this.FW.EGj();else if(zd=this.kgi(zd),fi.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",ae.Name,JSON.stringify(zd),this.o6),fb.add(zd),this.G0b||(this.vJ.add(zd),Gc=JSON.stringify(zd),this.tm.I4(Bg.error,JSON.stringify(zd)),this.tm.I4(Bg.status,Bg.failed)),this.Vie)for(const zf of zd.Errors)ae=this.v7h(zf),this.FW&&this.FW.MXg(ae)}this.G0b?(0<fb.count?this.dtb?
this.dtb(new ti(ha,fb)):fi.a(512267295,306,15,"Received errors but the promise has completed"):this.etb?this.etb(new ti(ha,fb)):fi.a(512267294,306,15,"Received valid tokens but the promise has completed"),fi.a(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",ha.count,fb.count,D.CorrelationId,this.o6)):(0<fb.count&&""!==Gc?(Vb=Object.assign(new ui.a,{extendedProperties:new Map}),Vb.extendedProperties.set("Errors",Gc),Vb.extendedProperties.set("RetryCount",
this.Kca.toString()),Vb.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),Vb.extendedProperties.set("IsTokenExpiring",this.q1a.toString()),Zc.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Vb)):Zc.Health.instance.recordKpiSuccess("WACTokenRefresh",null),fi.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",ha.count,fb.count,D.CorrelationId,this.o6),0<fb.count&&!this.SIb(fb)?(D=this.NJ.Wgf(fb),
D!==this.NJ.Mib&&(this.tm.n0d(Bg.K$f,D),this.fg.Ura(this.Yk,D))):(this.tm.flush(),this.Yk&&(fi.a(39408131,306,100,"Deleting task {0} from task manager",this.Yk.name),this.fg.rr(this.Yk)),this.Gm&&!this.Gm.task.isCompleted?this.Gm.setResult(new ti(ha,fb)):fi.a(512267293,306,15,"Received results but the task has completed")))}}kgi(D){if(!D)return null;const ha=Object.assign(new Ni,{Name:D.Name,Errors:[]});for(const fb of D.Errors)D=new bj,D.Id=fb.Id,D.Details=Oi.a.nQa(fb.Details,500),ha.Errors.push(D);
return ha}requestTokensOnce(){this.u9f()}u9f(){na.AFrameworkApplication.mZ("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.Kca>=this.NJ.BGf?(fi.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.o6),this.LSe(this.Gm,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(Zc.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.ldg())}ldg(){const D={};D[Tf.a.aeg]=this.NJ.tokens;
this.eQg&&(D[Tf.a.vOj]=this.fQg);const ha=Cg.a.create().toString();fi.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.NJ.tokens),this.Kca+1,ha,this.o6);this.rse.execute(fb=>{fb.sendMessage(ag.a.VEe,D,ha)});this.Kca++;this.tm.incrementCounter(Bg.requests)}LSe(D,ha,fb){const Vb=new Ub.a;for(let Gc=0;Gc<this.NJ.tokens.length;Gc++){const zd=Object.assign(new Ni,{Name:this.NJ.tokens[Gc],Errors:[Object.assign(new bj,{Id:ha,Details:fb})]});Vb.add(zd);
this.vJ.add(zd)}this.fg.rr(this.Yk);this.tm.I4(Bg.Hjd,JSON.stringify(this.vJ));this.tm.I4(Bg.status,Bg.failed);D&&!D.task.isCompleted&&D.setResult(new ti(new Ub.a,this.vJ))}iwj(D,ha){ha=void 0===ha?null:ha;na.AFrameworkApplication.mZ("ej4if276;fheca743");this.Vwe.start();this.q1a=D;this.o6=Cg.a.create().toString();fi.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.o6,this.q1a);this.Kca=0;this.vJ.clear();this.U5b.clear();const fb=new lb.a;this.Gm=fb;ha&&ha.R(()=>
{const Vb=!!fb&&!fb.task.isCompleted;fi.a(588096223,306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",this.o6,this.q1a,Vb);Vb&&this.LSe(fb,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.G0b?this.v9f(this.NJ.BGf).then(Vb=>{this.Gm&&!this.Gm.task.isCompleted&&this.Gm.setResult(Vb);this.dtb=this.etb=null;this.tm.I4(Bg.Hjd,JSON.stringify(this.vJ));this.tm.I4(Bg.status,Bg.success);this.tm.flush()}).catch(Vb=>{this.Gm&&!this.Gm.task.isCompleted&&
this.Gm.setResult(Object(pb.a)(660,Vb));this.dtb=this.etb=null;this.tm.I4(Bg.Hjd,JSON.stringify(this.vJ));this.tm.I4(Bg.status,Bg.failed);this.tm.flush()}):(this.Yk=new qc.a(this.NJ.priority,2,this.NJ.Mib,Object(La.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,ag.a.VEe,!0),this.UPg&&this.u9f(),this.fg.Sh(this.Yk));return this.Gm.task}v9f(D){const ha=this,fb=new Promise((He,hf)=>{ha.etb=He;ha.dtb=hf;Zc.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);ha.ldg()}),Vb=this,Gc=
new Promise((He,hf)=>{window.setTimeout(()=>{hf(Vb.QSe("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},Vb.NJ.Mib)});let zd=D;const ae=this;return new Promise((He,hf)=>{zd--;Promise.race([fb,Gc]).then(zf=>{Zc.Health.instance.recordKpiSuccess("WACTokenRefresh",null);He(zf)}).catch(zf=>{var vg=ae.NJ.Mib;if(Object(U.a)(660,zf)&&(zf=Object(pb.a)(660,zf),0<zf.errors.count)){ae.iSi(zf.errors);ae.Us(zf.errors);if(ae.SIb(zf.errors)){hf(zf);return}const gh=ae.NJ.Wgf(zf.errors);
gh!==ae.NJ.Mib?(ae.tm.n0d(Bg.K$f,gh),vg=gh):ae.wLi(zf.errors)&&(vg=0)}zd?window.setTimeout(()=>{ae.v9f(zd).then(He).catch(hf)},vg):(vg=ae.QSe("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),ae.Us(vg.errors),hf(vg),fi.a(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",ae.o6))})})}Us(D){for(const ha of D)this.vJ.add(ha)}wLi(D){if(!D.count)return!1;D=D.ma(D.count-1);return D.Errors.length?"TIMEOUT"==D.Errors[0].Id:
!1}QSe(D,ha){const fb=new Ub.a;for(let Vb=0;Vb<this.NJ.tokens.length;Vb++){const Gc=this.dqh(this.NJ.tokens[Vb],D,ha);fb.add(Gc)}return new ti(new Ub.a,fb)}dqh(D,ha,fb){return Object.assign(new Ni,{Name:D,Errors:[Object.assign(new bj,{Id:ha,Details:fb})]})}iSi(D){if(D.count){D=D.ma(D.count-1);D=JSON.stringify(D);var ha=Object.assign(new ui.a,{extendedProperties:new Map});ha.extendedProperties.set("Errors",D);ha.extendedProperties.set("RetryCount",this.Kca.toString());ha.extendedProperties.set("NavigatorOnline",
window.navigator.onLine.toString());ha.extendedProperties.set("IsTokenExpiring",this.q1a.toString());Zc.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,ha);this.tm.I4(Bg.error,D);this.tm.I4(Bg.status,Bg.failed)}}Mpj(D){this.Vwe.stop();const ha=this.bqi(D.result.errors);ba.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!ha,this.o6,this.q1a,this.Kca,this.vJ.count,0<D.result.errors.count?D.result.errors.ma(0).Name:"",0<D.result.errors.count&&0<D.result.errors.ma(0).Errors.length?D.result.errors.ma(0).Errors[0].Id:"",0<D.result.errors.count&&0<D.result.errors.ma(0).Errors.length?D.result.errors.ma(0).Errors[0].Details:"");return ha?!1:this.Lpj(D.result.tokens)}SIb(D){return this.NJ.SIb(D)}Lpj(D){for(let ha=0;ha<D.count;ha++){const fb=D.ma(ha);if(fb.Name===Tf.a.accessToken){const Vb=(new Date).getTime();fb.Expiry>na.AFrameworkApplication.accessTokenTtl?
(ba.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:fb.Expiry,["NowGetTime"]:Vb,["BootTime"]:na.AFrameworkApplication.Ila},"PreviousAccessTokenTtl",na.AFrameworkApplication.accessTokenTtl),na.AFrameworkApplication.accessToken=fb.Value,na.AFrameworkApplication.accessTokenTtl=Math.floor(fb.Expiry),na.AFrameworkApplication.hce=Vb,na.AFrameworkApplication.Cwa=Math.floor(fb.Expiry)):ba.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",
{["AccessTokenTtl"]:fb.Expiry,["NowGetTime"]:Vb,["BootTime"]:na.AFrameworkApplication.Ila},"PreviousAccessTokenTtl",na.AFrameworkApplication.accessTokenTtl)}}return!0}bqi(D){let ha=!1;for(let fb=0;fb<D.count;fb++){ha=!0;const Vb=D.ma(fb);ba.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",Vb.Name,JSON.stringify(Vb.Errors),this.o6)}return ha}v7h(D){let ha=Ih.a.$Fc;D=parseInt(D.Id);if(isNaN(D))ha=Ih.a.Kok;else{switch(D){case 401:ha=Ih.a.Nok;break;case 403:ha=
Ih.a.Iok;break;case 500:ha=Ih.a.Jok;break;case 503:ha=Ih.a.Mok}ha===Ih.a.$Fc&&(ha=500<D?Ih.a.Lok:Ih.a.Hok)}return ha}}Object(da.a)(ri,"TokenRefreshManager",null,[661]);class sj{constructor(){this.Mib=na.AFrameworkApplication.Qok;this.BGf=na.AFrameworkApplication.Ook;this.tokens=na.AFrameworkApplication.lli();this.priority=na.AFrameworkApplication.ice;this.Dte=this.ZSj();this.f3c=na.AFrameworkApplication.kli()}SIb(D){D=JSON.stringify(D);if(this.f3c&&0<this.f3c.length)for(const ha of this.f3c)if(0<
ha.length&&0<=D.indexOf(ha))return!0;return!1}Wgf(D){try{if(D)for(const ha of D)if(ha.Errors)for(const fb of ha.Errors)if(fb.Id in this.Dte)return Number.parseInvariant(this.Dte[fb.Id].toString())}catch(ha){ba.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",ha.toString())}return this.Mib}ZSj(){const D={};try{if(!na.AFrameworkApplication.mmc()||0>=na.AFrameworkApplication.mmc().length||""===na.AFrameworkApplication.mmc()[0])return D;for(const ha of na.AFrameworkApplication.mmc())0<
ha.length&&(D[ha]=na.AFrameworkApplication.Pok)}catch(ha){ba.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",ha.toString())}return D}}Object(da.a)(sj,"TokenRefreshPolicy",null,[655]);class cj extends Ta.a{constructor(D){super();this.$=D;this.je()}create(){na.AFrameworkApplication.da.pa("RefreshAccessTokenSilently")?this.Ld(this.iqh()):this.Ld(this.$.ga.Da(38)||this.$.ga.Qa(38,new wj(this.$)))}iqh(){var D=this.$.ga.Da(38);if(D)return D;D=new ri(na.AFrameworkApplication.Vj,
na.AFrameworkApplication.fU(),new sj);return this.$.ga.Qa(38,new xj(this.$,D))}static la(D){D.ga.Qa(39,new cj(D))}}Object(da.a)(cj,"AccessTokenExpirationManagerFactory",Ta.a,[]);var Gi=a(1129),xh;(function(D){D[D.generalException=0]="generalException";D[D.invalidArgument=1]="invalidArgument";D[D.notAllowed=2]="notAllowed";D[D.apiNotAvailable=3]="apiNotAvailable";D[D.unresolvedPendingRequest=4]="unresolvedPendingRequest";D[D.timeout=5]="timeout";D[D.adalTimeout=6]="adalTimeout";D[D.userNotSignedIn=
7]="userNotSignedIn";D[D.userAborted=8]="userAborted";D[D.silentSignInFailed=9]="silentSignInFailed";D[D.invalidResourceUrl=10]="invalidResourceUrl";D[D.invalidGrant=11]="invalidGrant";D[D.connectionLost=12]="connectionLost";D[D.clientError=13]="clientError";D[D.serverError=14]="serverError"})(xh||(xh={}));Object(da.b)("ErrorCodes",xh);a(1240);class tj{constructor(D,ha){this.requestCallback=this.requestParameters=null;this.requestParameters=D;this.requestCallback=ha}}Object(da.a)(tj,"OutstandingRequest",
null,[]);class Mh{}Mh.w0i="AADSTS50058";Mh.invalidResourceUrl="AADSTS50001";Mh.q0i="AADSTS65001";Mh.I0i="AADSTS70011";Mh.userAborted="13002";Mh.Imj="Popup Window is null";Mh.Hmj="Popup Window closed";Mh.adalTimeout="Token renewal operation failed due to timeout";Mh.sak="tokenRevoked";Object(da.a)(Mh,"WopiHostErrorType",null,[]);var A=a(429),ca=a(581),Ra=a(1239);class Zb{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(da.a)(Zb,"WopiIdentityInfo",
null,[678]);class wc{constructor(D,ha,fb){this.expiration=this.authority=this.accessToken=null;this.accessToken=D;this.authority=ha;this.expiration=fb}}Object(da.a)(wc,"WopiIdentityToken",null,[679]);var Jc=a(176),fd=a(73),$d=a(357);class Be{constructor(D){this._initialized=!1;this.egb={};this.wJc={};this.MR=na.AFrameworkApplication.sa.EG;this.twd=D}h8a(D){this._initialized||(D.Rn(ag.a.XYf),D.fm(ag.a.XYf,Object(La.a)(this,this.Ycj,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(D,ha,
fb){fb=void 0===fb?null:fb;this.wTa(D,ha);return new Promise((Vb,Gc)=>{if(this.Oyd(ha))if(ha in this.egb)Gc("unresolvedPendingRequest");else{var zd=window.setTimeout(()=>{ba.ULS.sendTraceTag(37856032,344,10,wb.c({["error"]:"Request timeout.",["callerId"]:ha}));Gc("timeout")},12E4);this.lod(D,ha,fb,(ae,He)=>{window.clearTimeout(zd);ae?Vb(ae):(ba.ULS.sendTraceTag(37856033,369,15,wb.c({["error"]:xh[He]})),Gc(He))})}else ba.ULS.sendTraceTag(37856034,344,10,wb.c({["error"]:"Caller is not allowed."})),
Gc("notAllowed")})}getPrimaryIdentityInfo(D){return new Promise((ha,fb)=>{this.Oyd(D)?this.Tdi((Vb,Gc)=>{Vb?ha(Vb):(ba.ULS.sendTraceTag(37856064,369,10,wb.c({["error"]:Gc.toString()})),fb(Gc))}):(ba.ULS.sendTraceTag(37856065,344,10,wb.c({["error"]:"Caller is not allowed."})),fb("notAllowed"))})}getAuthContext(D){return new Promise((ha,fb)=>{const Vb=this.getAuthContextSync(D);Vb?ha(Vb):fb("notAllowed")})}getAuthContextSync(D){if(this.Oyd(D)){const ha=new Ra.a;ha.upn=na.AFrameworkApplication.da.Sa("UserPrincipalName");
ha.userId=na.AFrameworkApplication.da.Sa("LoggableUserId");ha.authority=na.AFrameworkApplication.da.Sa("HostAuthAuthority");ha.tenantId=na.AFrameworkApplication.da.Sa("TenantId");ha.isAnonymous=na.AFrameworkApplication.da.pa("IsAnonymousUser");ha.supportsAuthToken=this.Isi(D);D=na.AFrameworkApplication.da.Sa("HostAuthType");ha.authorityType="aad"===D.toLowerCase()?2:"msa"===D.toLowerCase()?1:0;return ha}ba.ULS.sendTraceTag(40751647,344,10,wb.c({["error"]:"Caller is not allowed."}));return null}Isi(D){const ha=
A.OAuthManagerSettings.UFb;return cb.a.VBa?ha&&A.OAuthManagerSettings.Ipg?Array.contains(A.OAuthManagerSettings.Ipg,D.toLowerCase()):!1:ha}lod(D,ha,fb,Vb){var Gc=[];Array.add(Gc,Object.assign(new fd.a,{name:"CallerId",string:ha}));Array.add(Gc,Object.assign(new fd.a,{name:Tf.a.A5d,string:D.correlationId}));Jc.a.sendTelemetryEvent(Object.assign(new $d.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:Gc}));Gc=ca.a.create().toString();const zd="getAccessToken_"+Gc,
ae=this.MR.Ze("ComponentAttach",zd);this.wJc[zd]=ae;const He={};He[Tf.a.B5d]=Gc;He[Tf.a.t4j]=D.resource;He[Tf.a.u4j]=D.scope;He[Tf.a.Lmg]=na.AFrameworkApplication.da.Sa("HostAuthType");He[Tf.a.x4j]=na.AFrameworkApplication.da.Sa("UserPrincipalName");He[Tf.a.v4j]=D.silentLogin;He[Tf.a.q4j]=D.options;He[Tf.a.A5d]=D.correlationId;He[Tf.a.r4j]=ha;fb&&(He[Tf.a.addinName]=fb.AddinName,He[Tf.a.p4j]=fb.AddinTrustId);this.twd.execute(hf=>{this.h8a(hf);hf.sendMessage(ag.a.getAuthToken,He)});this.egb[Gc]=new tj(D,
Vb)}Tdi(D){const ha=na.AFrameworkApplication.da.Sa("UserName"),fb=na.AFrameworkApplication.da.Sa("UserPrincipalName"),Vb=na.AFrameworkApplication.da.Sa("LoggableUserIdSpace"),Gc=new Zb;Gc.email=fb;Gc.displayName=ha;switch(Vb){case "OrgIdPuid":Gc.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":Gc.authority="MicrosoftAccount";break;default:Gc.authority=Vb}D(Gc,null)}Ycj(D){let ha=null;try{const Vb=D.Values[Tf.a.B5d],Gc=D.Values[Tf.a.o4j],zd=D.Values[Tf.a.Lmg],ae=D.Values[Tf.a.w4j];
let He=null,hf=null;const zf=this.egb[Vb];if("undefined"!==typeof zf&&zf){var fb=[];Array.add(fb,Object.assign(new fd.a,{name:Tf.a.A5d,string:zf.requestParameters.correlationId}));Jc.a.sendTelemetryEvent(Object.assign(new $d.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:fb}));ha=zf.requestCallback;delete this.egb[Vb];"undefined"!==typeof Gc&&Gc&&Gc.length?hf=new wc(Gc,zd,ae):He=xh[this.tWi(D)];fb="getAccessToken_"+Vb;fb in this.wJc&&(this.wJc[fb].stop(),delete this.wJc[fb]);
ha(hf,He)}else ba.ULS.sendTraceTag(37856066,344,10,wb.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:Vb}))}catch(Vb){D=D.Values[Tf.a.B5d],D in this.egb&&delete this.egb[D],this.tuc(),ba.ULS.sendTraceTag(37856067,344,10,wb.c({["error"]:Vb.message,["stack"]:Vb.stack})),ha&&ha(null,"generalException")}}Oyd(D){var ha=na.AFrameworkApplication.jli();D=D.toLowerCase();for(const fb of ha)if(D===fb.toLowerCase())return!0;ha=A.OAuthManagerSettings.R6c;for(const fb in ha)if(D===
ha[fb].toLowerCase())return!0;return!1}tWi(D){D=D.Values[Tf.a.s4j];this.tuc();ba.ULS.sendTraceTag(39068821,344,15,wb.c({["error"]:D}));return D?-1<D.indexOf(Mh.w0i)?9:-1<D.indexOf(Mh.Imj)||-1<D.indexOf(Mh.Hmj)?12:-1<D.indexOf(Mh.invalidResourceUrl)?10:-1<D.indexOf(Mh.userAborted)?8:-1<D.indexOf(Mh.I0i)||-1<D.indexOf(Mh.q0i)||D===Mh.sak?11:-1<D.indexOf(Mh.adalTimeout)?6:0:13}wTa(D,ha){D=this.Ovj(D.resource);ba.ULS.sendTraceTag(39921882,344,50,wb.c({["callerId"]:ha,["resource"]:D}))}tuc(){ba.ULS.sendTraceTag(39068822,
344,50,wb.c({["userAgent"]:window.navigator.userAgent}))}Ovj(D){return(D?D:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(da.a)(Be,"WopiIdentityManager",null,[650]);class Re{constructor(){this.hd=null}get name(){return"Common.App.WopiIdentity"}Xj(D){this.hd=D;D.register(Be,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").Ee().Le(()=>new Be(D.Qd("Postmessage.IHostPostmessenger")))}init(){na.AFrameworkApplication.da&&na.AFrameworkApplication.da.qx(Object(La.a)(this,
this.iE,"onFullAppSettingsReady"))}iE(){try{this.hd.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(D){ba.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+D)}}dispose(){}static main(){Sb.a.instance.Tk(new Re)}}Object(da.a)(Re,"WopiIdentityPackage",null,[2,3]);var lf=a(1259),xf=a(1130);class $f{constructor(D,ha,fb,Vb,Gc){this.eUc=this.yJa=null;this.W0a=this.dPc=!1;this.fg=ha;this.g3b=D;this.iva=fb;this.xS=Vb;this.aZc=Gc;this.E4f(null)}E4f(){const D=
document.getElementById(na.AFrameworkApplication.h9b);!this.W0a&&this.xS&&D&&(this.xS.ta(ze.a.PCa,D,Object(La.a)(this,this.zJd,"mouseActivityHandler"),null),this.W0a=!0);this.aZc(()=>{this.dispose()})}zJd(){this.W0a&&(this.xS.Aa(ze.a.PCa,document.getElementById(na.AFrameworkApplication.h9b),Object(La.a)(this,this.zJd,"mouseActivityHandler")),this.W0a=!1);this.jze();return!1}jze(){this.dPc=!0;this.eUc||(this.eUc=new qc.a(3,2,this.g3b,Object(La.a)(this,this.E4f,"registerHandlerTask"),112),this.fg.Sh(this.eUc));
this.yJa||(this.DTb(null),this.yJa=new qc.a(3,2,this.g3b,Object(La.a)(this,this.DTb,"sendPostMessageIfNecessary"),111),this.fg.Sh(this.yJa))}DTb(){this.dPc&&(this.iva.CWR(()=>this.iva.result.sendMessage(ag.a.blk,null)),ba.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.dPc=!1)}dispose(){this.W0a&&(this.xS.Aa(ze.a.PCa,document.getElementById(na.AFrameworkApplication.h9b),Object(La.a)(this,this.zJd,"mouseActivityHandler")),this.W0a=!1)}}
Object(da.a)($f,"UserActivityHostNotificationManager",null,[647,5]);class tg{constructor(){this.hd=null}get name(){return"Common.App.EditNotification"}init(){na.AFrameworkApplication.da&&na.AFrameworkApplication.da.qx(Object(La.a)(this,this.iE,"onFullAppSettingsReady"))}iE(){tg.editNotificationIsEnabled&&0<tg.Aid&&(this.hd.register(lf.a,"Common.App.HostNotification.EditNotificationEventSource").Ee(),this.hd.register($f,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").Ee().Le(()=>
new $f(6E4,Kc.a.instance,Wg.a.ar(this.hd.Qd("Postmessage.IHostPostmessenger")),Ti.a.instance,na.AFrameworkApplication.Lkb)),this.hd.register(xf.a,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").Ee().Le(()=>new xf.a(tg.Aid,Kc.a.instance,Wg.a.ar(this.hd.Qd("Postmessage.IHostPostmessenger")),this.hd.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.hd.oi("Common.Interface.IUserActivityHostNotificationManager"),tg.editNotificationPostMessageIsEnabled,
tg.zDh)),this.hd.resolve("Common.Interface.IEditNotificationManager"),ba.ULS.shipAssertTag(38086291,209,0<tg.Aid,"EditNotification Interval is less than or equal to 0."))}Xj(D){this.hd=D}dispose(){}static get Aid(){return na.AFrameworkApplication.da?parseInt(na.AFrameworkApplication.da.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get zDh(){return na.AFrameworkApplication.da?parseInt(na.AFrameworkApplication.da.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||
"0"):0}static get editNotificationIsEnabled(){return!!na.AFrameworkApplication.da&&na.AFrameworkApplication.da.pa("EditNotificationIsEnabled")}static get editNotificationPostMessageIsEnabled(){return!!na.AFrameworkApplication.da&&na.AFrameworkApplication.da.pa("EditNotificationPostMessageIsEnabled")}static main(){Sb.a.instance.Tk(new tg)}}Object(da.a)(tg,"CommonHostNotificationPackage",null,[2,3]);class Vf{constructor(D,ha,fb){this.eKa=null;this.fg=D;this.Na=ha;this.Pje=fb.create()}Q4f(){this.eKa?
ba.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(ba.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.eKa=new qc.a(2,1,3E4,Object(La.a)(this,this.tVb,"showFloatPane"),67),this.fg.Sh(this.eKa))}tVb(){this.eKa=null;ba.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.Pje.display()}gWa(){this.Na.ae(Za.a.tVb,Sa.a.frame,Object(La.a)(this,this.Z_j,"showFloatPaneHandler"))}Z_j(D,ha,fb,Vb,
Gc){return D!==Za.a.tVb?2:1===fb?32:2===fb&&Gc?(ba.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",Gc),Gc?this.Q4f():(this.eKa?(ba.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),this.fg.rr(this.eKa)):(ba.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.Pje.remove(null)),this.eKa=null),32):8}}Object(da.a)(Vf,"FloatPaneActor",null,[649]);var ug=a(169);class lh{constructor(D,ha,fb,Vb,Gc){this.AXc=
this.Apb=this.m4b=this.jka=this.AS=this.xy=this.zQc=this.cP=this.urb=this.Bqb=this.Cqb=this.zTc=null;this.fg=ha;this.Oa=D;this.Co=fb;this.hd=Gc;this.u5=Vb}Zcc(){this.cP=document.createElement("div");this.cP.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.cP.style.width=this.AS.width+"px";(this.AXc=this.nci(this.u5))?(this.jka=document.createElement("a"),this.jka.setAttribute(zg.a.Mf,zg.a.Ut),this.Co.ta(ze.a.click,this.jka,Object(La.a)(this,this.NSf,"onRedirectClick")),
this.jka.href=this.AXc,this.jka.target="_blank",this.jka.appendChild(this.AS),this.cP.appendChild(this.jka)):this.cP.appendChild(this.AS);this.xy=document.createElement("a");this.xy.setAttribute(zg.a.Mf,zg.a.Ow);this.xy.className="StandardButton WACFloatPaneCloseButton";this.xy.title=CommonUIStrings.l_Close;this.xy.tabIndex=-1;this.zQc=ug.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.zQc.setAttribute(zg.a.Mf,zg.a.Ut);this.xy.appendChild(this.zQc);
this.Co.ta(ze.a.click,this.xy,Object(La.a)(this,this.onClose,"onClose"));this.cP.appendChild(this.xy);this.urb.appendChild(this.cP)}c$h(D){const ha=this.Oa.pa("O365PromotionHasStarted");switch(D){case 2:return Y.a.Mxa(String.format("adppt{0}.png",ha?"sale":""));case 1:return Y.a.Mxa(String.format("adxls{0}.png",ha?"sale":""));case 3:return Y.a.Mxa(String.format("addoc{0}.png",ha?"sale":""))}return null}nci(D){const ha=this.Oa.Sa("O365AdPaneRedirectedURL");switch(D){case 1:return String.format(ha,
"Excel");case 2:return String.format(ha,"PowerPoint");case 3:return String.format(ha,"Word")}return null}hide(D){this.Apb=null;this.cP&&!this.m4b&&((void 0===D?0:D)?ba.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):ba.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.cP.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.cP.style.height="0px",this.m4b=new qc.a(2,1,1E3,Object(La.a)(this,this.remove,"remove"),67),
this.fg.Sh(this.m4b))}remove(){this.cP&&this.urb&&(this.jka&&this.Co.Aa(ze.a.click,this.jka,Object(La.a)(this,this.NSf,"onRedirectClick")),this.Co.Aa(ze.a.click,this.xy,Object(La.a)(this,this.onClose,"onClose")),this.urb.removeChild(this.cP),this.cP=null);this.m4b=null}display(){if(this.zTc=this.hd.oi("Common.IFloatPaneContainer"))if(this.urb=this.zTc.container){var D=this.c$h(this.u5);D?(ba.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",D),this.AS=document.createElement("img"),
this.AS.className="WACFloatPaneImage",this.Cqb=Object(La.a)(this,this.Maj,"onLoadImageFinish"),Rf.a.addHandler(this.AS,ze.a.load,this.Cqb),this.Bqb=Object(La.a)(this,this.Laj,"onLoadImageError"),Rf.a.addHandler(this.AS,ze.a.error,this.Bqb),this.AS.src=D):ba.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else ba.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else ba.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}Maj(){const D=
this.Oa.Hf("O365AdPaneShowingDuration",60);this.Zcc();this.cP.style.display="block";this.cP.style.height=this.AS.height+"px";this.Apb=new qc.a(2,1,1E3*D,Object(La.a)(this,this.hide,"hide"),67);this.fg.Sh(this.Apb);this.L5f()}Laj(){ba.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.L5f();this.AS=null}L5f(){this.Cqb&&this.AS&&Rf.a.removeHandler(this.AS,ze.a.load,this.Cqb);this.Cqb=null;this.Bqb&&this.AS&&Rf.a.removeHandler(this.AS,ze.a.error,this.Bqb);
this.Bqb=null}NSf(){ba.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.Apb&&this.fg.rr(this.Apb);this.hide();return!0}dispose(){this.hide()}}Object(da.a)(lh,"FloatPane",null,[676]);class ni{constructor(D,ha,fb,Vb,Gc){this.fg=ha;this.Oa=D;this.Co=fb;this.hd=Gc;this.u5=Vb}create(){return new lh(this.Oa,this.fg,this.Co,this.u5,this.hd)}}Object(da.a)(ni,"FloatPaneFactory",null,[648]);class oi{constructor(){this.hd=null}get name(){return"Common.App.FloatPane"}get Otf(){return na.AFrameworkApplication.da.pa("O365AdvertisementIsEnabled")&&
na.AFrameworkApplication.da.pa("IsShowAdvertisementPaneEnabled")}init(){this.Otf&&(ba.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.hd.resolve("Common.App.FloatPane.IFloatPaneActor").Q4f(),ba.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.hd.resolve("Common.App.FloatPane.IFloatPaneActor").gWa())}Xj(D){this.hd=D;this.Otf&&(this.hd.register(ni,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").Le(()=>
new ni(na.AFrameworkApplication.da,na.AFrameworkApplication.Vj,of.a.instance,na.AFrameworkApplication.sa.Ra.kj,this.hd)).Ee(),this.hd.register(Vf,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").Le(()=>new Vf(na.AFrameworkApplication.Vj,na.AFrameworkApplication.Dd,this.hd.resolve("Common.App.FloatPane.IFloatPaneFactory"))).Ee())}dispose(){}static main(){Sb.a.instance.Tk(new oi)}}Object(da.a)(oi,"FloatPanePackage",null,[2,3]);var Oj=a(948),Hi=a(755);class yj{constructor(D,
ha){this.Rob=null;this.Na=D;this.Oa=ha}tj(){(this.Rob=this.Oa.Sa("StatusBarEnvironmentNameToUse"))&&""!==this.Rob&&this.Na.Rg(Za.a.J0f,Sa.a.frame,Object(La.a)(this,this.Dhk,"updateEnvironmentName"),96)}Dhk(D,ha,fb,Vb,Gc){if(1===fb)return 32;Gc[Oj.a.Value]=this.Rob;Gc[Hi.a.ak]=this.Rob;Gc[Oj.a.Visible]=!0;return 32}}Object(da.a)(yj,"DisplayEnvironmentName",null,[]);class P{constructor(){this.hd=null}get name(){return"Common.App.DisplayEnvironmentName"}Xj(D){this.hd=D;this.hd.register(yj,"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").Ee().Le(()=>
new yj(na.AFrameworkApplication.Dd,na.AFrameworkApplication.da))}init(){this.hd.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").tj()}dispose(){}static main(){Sb.a.instance.Tk(new P)}}Object(da.a)(P,"DisplayEnvironmentNamePackage",null,[2,3]);var Qa=a(191),mb=a(166);class fc extends Qa.a{constructor(D){super();this.UQ=()=>{this.Uxd()};this.Jga=()=>{this.Uxd()};this.$=D}dispose(){this.$&&mb.a(this.$)&&(mb.a(this.$).BWa(this.Jga),this.$.ea.k4(this.UQ));this.$=null;super.dispose()}DCh(){na.AFrameworkApplication.ncb()&&
!this.Uxd()&&(mb.a(this.$).XKa(this.Jga),this.$.ea.N0(this.UQ))}Uxd(){return this.$.isEditMode&&(na.AFrameworkApplication.H7a||Ha.a.Bi.kw)?(mb.a(this.$).BWa(this.Jga),qa.TaskExtensions.za(df.GetServiceTaskFactory.create(this.$.ga,119,this.ka,1),D=>{D.result.initialize()},this.ka,3),!0):!1}static main(){ec.a.Ga(D=>{(new fc(D)).DCh()})}}Object(da.a)(fc,"FileOpSliceDownloaderBootStraper",Qa.a,[]);var Ec=a(94),td=a(468),rd=a(118);class Qd{constructor(D){this.jY=null;this.QDf=new Set;this.Mxf=!1;this.s3=
(ha,fb)=>{if(!this.QDf.has(ha)){var Vb=[];if(fb){const Gc=$a.h(this.$).zd.sh(fb,!1);if(!Gc){1!==fb.top||1!==fb.left||this.Mxf||(Vb.push(rd.a.Yg("IsTableOnA1","false",1)),zb.a("MsFormsTableUsage",void 0,void 0,Vb),this.Mxf=!0);return}if(1!==Gc.usedRange.top||1!==Gc.usedRange.left)return}fb=Gd.b().zl(ha);Vb.push(rd.a.Yg("Command",fb,2));zb.a("MsFormsTableUsage",void 0,void 0,Vb);this.QDf.add(ha)}};this.N$d=(ha,fb)=>{if(!this.$.ea.pj.get(61)||Ec.k(this.$.Fg))Ec.k(this.$.Fg)&&fb&&fb.item.name===this.jY.kN&&
this.QHe();else if(this.$.va.zm(this.jY.qCb)){const Vb={};Vb.SheetName=this.jY.qCb;Vb.NamedObjectName=this.jY.qCb;Vb.FirstColumn=0;Vb.FirstRow=0;Vb.LastColumn=0;Vb.LastRow=2;const Gc=ae=>{if(!Ec.k(this.$.Fg)){if(null===ae||void 0===ae?0:ae.Result)this.$.workbookContext.MsFormId=ae.Result[0][0],this.jY.kN=ae.Result[1][0],ae=ae.Result[2][0],this.uO(!!this.$.workbookContext.MsFormId&&this.bMi(ae),1024),this.QHe();Ec.c(this.$.Fg)&&(fb?ba.ULS.sendTraceTag(537155357,0,50,`Created MsForm successfully, Form Id:${Ua.a.Ly(this.$.workbookContext.MsFormId).toString()}`):
ba.ULS.sendTraceTag(537155356,0,50,`Reopening workbook that is connected to MsForm, Form Id:${Ua.a.Ly(this.$.workbookContext.MsFormId).toString()}`));Ec.c(this.$.Fg)&&!fb&&ba.ULS.sendTraceTag(537155355,0,50,`reopening workbook that is connected to MsForm, Form Id:${Ua.a.Ly(this.$.workbookContext.MsFormId).toString()}`);!Ec.c(this.$.Fg)&&fb||this.uO(!0,2048)}},zd=this.$.qa.ua.ie();this.$.userOperationManager.OH(new Db.a(159,0,(ae,He,hf)=>be.r(this.$.qa.oz,Vb,!1,Bd.b(ae,Gc),He,hf,null,zd),16))}else fb||
this.uO(!0,2048)};this.lbj=(ha,fb)=>{fb&&fb.item.name===this.jY.qCb&&(this.uO(!1,1024),this.uO(!0,2048))};this.$=D}Ddk(){this.jY=td.a.current;this.N$d(null,null);this.$.va.cla(this.N$d);this.$.va.R0(this.lbj)}dispose(){this.$.va.Lra(this.N$d)}bMi(D){if(!D)return!0;const ha=RegExp("-","g"),fb=this.$.workbookContext.MsFormDocUrl.toLowerCase();return fb.includes(D.toLowerCase())||fb.includes(D.toLowerCase().replace(ha,""))?!0:!1}QHe(){Ec.c(this.$.Fg)&&this.jY.kN&&this.$.va.na&&this.$.va.na.name!==this.jY.kN&&
this.$.va.zm(this.jY.kN)&&this.$.va.getItemByName(this.jY.kN).activate({scenario:"msForm"})}uO(D,ha){this.$.workbookContext.Options=jd.HelperMethods.ER(D,this.$.workbookContext.Options,ha)}}Object(da.a)(Qd,"MsFormInfoUpdatingService",null,[645,5]);class Mc extends Ta.a{constructor(D){super();this.msFormInfoUpdatingService=null;this.$=D;this.je()}create(){this.Ld(Object(sc.a)(this.$.ga,237,()=>this.msFormInfoUpdatingService||(this.msFormInfoUpdatingService=new Qd(this.$))));this.msFormInfoUpdatingService.Ddk()}static la(D){D.ga.Qa(236,
new Mc(D))}}Object(da.a)(Mc,"MsFormInfoUpdatingServiceFactory",Ta.a,[]);var Hd=a(237);class xe extends qb.a{constructor(D,ha,fb){super();this.value=null;this.IEd=D;this.Ey=ha;this.HMg=fb}bZg(D){this.addHandler("EnabledStateChanged",D)}get isEnabled(){return this.Ey}set isEnabled(D){D!==this.Ey&&(this.Ey=D,$b.a.Yn()&&appChrome.api.dispatch(appChrome.actions.toggleButton("Toggle"+this.IEd.replace(" ","")+"Button",D)),this.raiseEvent("EnabledStateChanged"))}get isVisible(){return this.isEnabled&&!!this.value}get ak(){return this.value?
String.format(Od.a.instance.xd(79),this.IEd,this.value):this.IEd}get Iuc(){return this.HMg}}Object(da.a)(xe,"StatusBarAggregateControl",qb.a,[677]);class ee extends qb.a{constructor(){super();this.controls=new yi.a(!1);this.xee=null;this.e1f=()=>{this.raiseEvent("AggregatesChanged")};this.ada(0,415,"Average",!0);this.ada(1,416,"Count",!0);this.ada(2,417,"NumericalCount",!1);this.ada(3,418,"Minimum",!1);this.ada(4,419,"Maximum",!1);this.ada(5,420,"Sum",!0)}jYg(D){this.addHandler("AggregatesChanged",
D)}pAj(D){this.removeHandler("AggregatesChanged",D)}get c4a(){return this.xee||ee.u_e}set c4a(D){D=D||ee.u_e;D!==this.c4a&&(this.kFa(0,D.Average),this.kFa(1,D.Count),this.kFa(2,D.NumericalCount),this.kFa(3,D.Minimum),this.kFa(4,D.Maximum),this.kFa(5,D.Sum),this.xee=D,this.e1f())}dispose(){oc.a.Fe(this.controls.values);this.controls.clear();super.dispose()}Tza(D){return this.controls.getItem(D)}TUg(D,...ha){D=this.Tza(D.toString());for(const fb of ha)this.controls.add(fb,D)}ada(D,ha,fb,Vb){ha=new xe(Od.a.instance.Ia(ha),
Vb,fb);ha.bZg(this.e1f);this.controls.add(D.toString(),ha)}kFa(D,ha){this.Tza(D.toString()).value=ha}static get u_e(){ee.Wua||(ee.Wua={},ee.Wua.Average=ee.Wua.Count=ee.Wua.NumericalCount=ee.Wua.Minimum=ee.Wua.Sum=null);return ee.Wua}}ee.Wua=null;Object(da.a)(ee,"StatusBarAggregateControlCollection",qb.a,[]);var ve=a(199),af=a(81),wf=a(58);const Hf=[{d4a:0,name:"Average",rZa:-1015637685,e4a:1,g9a:!0},{d4a:1,name:"Count",rZa:1957769939,e4a:3,g9a:!1},{d4a:2,name:"NumericalCount",rZa:-1292677035,e4a:2,
g9a:!1},{d4a:3,name:"Minimum",rZa:405783320,e4a:5,g9a:!0},{d4a:4,name:"Maximum",rZa:1210824414,e4a:4,g9a:!0},{d4a:5,name:"Sum",rZa:1265371067,e4a:9,g9a:!0}];class ig{constructor(D,ha,fb){ha=void 0===ha?null:ha;fb=void 0===fb?null:fb;this.Ejc=this.ZLc=this.$Lc=this.YLc=null;this.Zwa=new ee;this.sdb=new yi.a(!0);this.Wpg=0;this.atg=Vb=>{const Gc=this.ha.ra.activeCell.clone(),zd=Gb.d(this.ha.ra.selectedRanges);var ae=this.$.na;const He=null===ae||void 0===ae?void 0:ae.sheetId,hf=null===ae||void 0===
ae?void 0:ae.hash,zf=this.$.ea.xg,vg=this.$.ea.rI;ae=this.$.listSeparator;const gh=Gb.i(Gb.H(zd),ae,this.$,!1),Kh=`=${this.calcManager.config.localeInfo.getWorksheetFuncName(485)}({0}${ae}5${ae}{1})`;Promise.all(Hf.map(th=>this.calcManager.evalFormula(String.format(Kh,th.e4a,gh),Gc,void 0,th.g9a?excelOnlineCalc.calc.evalFormulaFormatAggregate():excelOnlineCalc.calc.evalFormulaFormatKnown(0)))).then(th=>{var Qh;const dk=this.ha.ra.selectedRanges,ek=this.ha.ra.activeCell,hk=null===(Qh=this.$.na)||void 0===
Qh?void 0:Qh.sheetId;if(Gb.R(zd,dk)&&Gc.equals(ek)&&He===hk){Qh=[];for(var fj of th.entries()){[,th]=fj;if(void 0===(null===th||void 0===th?void 0:th.formatted)||!excelOnlineCalc.util.isSuccess(th.formatted)||!excelOnlineCalc.util.isSuccess(th.value)){this.tZd();return}th=this.calcManager.zI.renderValue(th.formatted.value,excelOnlineCalc.numfmt.renderInfiniteWidth);if(!excelOnlineCalc.util.isSuccess(th)){this.tZd();return}th=excelOnlineCalc.numfmt.renderedValueToString(th.value);Qh.push(th)}fj={};
for(var Fj of Hf)fj[Fj.name]="";Fj=Qh[1];th=Qh[2];if(1<+Fj&&(fj.Count=Fj,0<+th))for(const Vi of Hf.entries()){const [Mj,ik]=Vi;fj[ik.name]=Qh[Mj]}this.FUb(fj);this.S8j(fj,Fj,zf,vg,zd,Gc,He,hf,Vb)}}).catch(th=>{ba.ULS.sendTraceTag(537151266,0,10,`TryToCalculateAggregatesUsingCalc: in catch, reason: ${JSON.stringify(th)}`);this.tZd()})};this.uf=()=>{this.Aug()};this.Ng=(Vb,Gc)=>{Vb=Gc.af.hash;Gc=Gc.af.block;const zd=Gc.Aea;if(Gc.state&4&&zd&&zd!==this.sdb.getItem(Vb)){this.sdb.add(Vb,zd);var ae=(Vb=
Gc.uh)?$a.g(Vb.getRowNumbers(),Vb.getColumnNumbers()):null;Hd.a.any(this.ha.ra.selectedRanges,He=>He.hf(ae))&&this.Aug()}};this.vp=(Vb,Gc)=>{this.sdb.remove(Gc.af.hash)};this.wf=()=>{this.$.ga.qd(29,Vb=>{this.statusBarManager=Vb;Vb.zM(this);ba.ULS.sendTraceTag(537151265,0,50,"StatusBarAggregateManager.OnWorkbookOpened: after AddFeatureRootUser")})};this.ff=(Vb,Gc)=>{!Vb.oe&&Qi.b(Gc)&&this.statusBarManager&&(this.statusBarManager.MI(this),this.statusBarManager=null,ba.ULS.sendTraceTag(537151264,0,
50,"StatusBarAggregateManager.OnSessionIdChanged: after RemoveFeatureRootUser"))};this.C9j=()=>{let Vb;const Gc=this.ha.ra.selectedRanges;(()=>{let zd=this.Bdk(Gc);({Z$b:Vb}=zd);return zd})().returnValue?this.FUb(Vb):this.j9f()};this.j9f=()=>{var Vb;const Gc=Gb.d(this.ha.ra.selectedRanges),zd=this.ha.ra.activeCell.clone(),ae=null===(Vb=this.$.na)||void 0===Vb?void 0:Vb.sheetId;this.RFf(zd,Gc,He=>{var hf;const zf=this.ha.ra.selectedRanges,vg=this.ha.ra.activeCell,gh=null===(hf=this.$.na)||void 0===
hf?void 0:hf.sheetId;Gb.R(Gc,zf)&&zd.equals(vg)&&ae===gh&&this.FUb(He.Result)})};this.nsf=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5809185_StatusBarAggregatesCSE");this.qEe=ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AlwaysTestCalcResult",!1);this.$=D;this.gridView=$a.h(this.$);this.l7=ha||na.AFrameworkApplication.tf;this.zj=fb||Hc.a.$b;this.$.ea.Zl(this.ff);this.$.Zm(this.wf);this.ha.kr(this.uf);this.ha.add_activeCellChanged(this.uf);this.ya.Eu(this.Ng);this.ya.WJ(this.vp);
for(const Vb of Hf)this.fUj(Vb.d4a,Vb.name,Vb.rZa);(this.statusBarManager=this.$.ga.Da(29))&&this.statusBarManager.zM(this);this.nsf&&((ib.EwaSettings.ZD()?Vb=>je.a.resolve(Fd.n,{Ja:1}).then(Gc=>setTimeout(()=>Vb(Gc),0)):Vb=>this.$.ga.qd(266,Vb))(Vb=>{this.calcManager=Vb}),this.$.ga.qd(268,Vb=>{this.instantaneousSupportInformationManager=Vb}))}Xs(D){this.Zwa.jYg(D)}Gt(D){this.Zwa.pAj(D)}get c4a(){return this.Zwa.c4a}FUb(D){this.Zwa.c4a=D}get ya(){return this.gridView.ya}get ha(){return this.gridView.ha}dispose(){this.$&&
(this.$.ea.gm(this.ff),this.$.co(this.wf),this.ha.Fr(this.uf),this.ha.remove_activeCellChanged(this.uf),this.ya.Ft(this.Ng),this.ya.uL(this.vp),this.CLe());this.statusBarManager&&(this.statusBarManager.MI(this),this.statusBarManager=null);oc.a.Fe([this.YLc,this.$Lc,this.ZLc,this.Zwa]);this.$=this.Zwa=this.ZLc=this.$Lc=this.YLc=null;this.sdb&&(this.sdb.clear(),this.sdb=null)}Ru(D,ha){return this.Tza(D)&&this.wgf(D,ha)?!0:!1}wgf(D,ha){const fb=this.Tza(D);if(!fb)return!1;let Vb=fb.ak;if(D.endsWith("Label"))ha.Visible=
fb.isVisible,$b.a.Yn()?ha.LabelText=Vb:ha.Value=Vb;else if(D.endsWith("Button"))ha.LabelText=Vb,ha.On=fb.isEnabled,ra.FocusManager.instance().Pm(Ob.AFrame.f4);else return!1;return!0}Up(){return!0}Pe(){return!1}executeCommand(D,ha){D=this.Tza(ha.command);if(!D)return ve.a(ha.command);D.isEnabled=!D.isEnabled;this.XRi(D.Iuc,D.isEnabled);return ka.Task.Wa(!0)}Be(D,ha){return!!this.Tza(ha.command)}Ue(){return!1}RFf(D,ha,fb){var Vb=this.$;this.CLe();if(this.$.ea.oe){var Gc=Vb.qa.ua;D=Gb.o(D,Vb);ha=Gb.r(ha,
Vb);Vb=Gc.Pa(1,null);Vb.activeCell=D;Vb.selectedRanges=ha;this.Ejc=be.g(Gc,"GetStatusBarAggregates",Vb,fb,null,null,null,0)}}Bdk(D){let ha,fb=ig.$sg(D);({Z$b:ha}=fb);return{returnValue:fb.returnValue||this.A4g(D)&&this.x4g(D),Z$b:ha}}S8j(D,ha,fb,Vb,Gc,zd,ae,He,hf){const zf=this.qEe?1:.05,vg=this.qEe?1E3:20;if(hf||!(this.Wpg>vg||Math.random()>zf))this.Wpg++,this.RFf(zd,Gc,gh=>{var Kh,th,Qh,dk;if(!lc.a(gh)){var ek=this.ha.ra.selectedRanges,hk=this.ha.ra.activeCell,fj=null===(Kh=this.$.na)||void 0===
Kh?void 0:Kh.sheetId;Kh=gh.StateId;if(Gb.R(Gc,ek)&&zd.equals(hk)&&ae===fj&&fb===this.$.ea.xg&&Vb===this.$.ea.rI&&fb===Kh){var Fj=gh.Result;Kh={};const zk={};fj=!0;for(var Vi of Hf){var Mj=Fj[Vi.name],ik=D[Vi.name];const Ak=Mj===ik;Kh[Vi.name]=Ak;zk[Vi.name]=[Mj.length,ik.length];fj&&(fj=Ak)}({category:hk}=this.instantaneousSupportInformationManager?this.instantaneousSupportInformationManager.udk(null!==(dk=null===(Qh=null===(th=this.gridView.Hd(hk))||void 0===th?void 0:th.cell)||void 0===Qh?void 0:
Qh.Ei)&&void 0!==dk?dk:0):{category:"uninitialized"});th=ek.length;ek=Gb.b(ek);Qh=this.gridView.hmf()||this.gridView.gmf();Vi=this.gridView.jd;dk=Vi.dPb;Mj=this.gridView.al("StatusBarAggregates");Vi=af.c(zd,Vi.Ok,Vi.tl,this.gridView.rowsPerBlock,this.gridView.columnsPerBlock,Object(wf.c)(Mj)?Mj.value:null);Vi=Vi.X+"_"+Vi.Y+"_"+Vi.PaneType;Fj=Fj.Count;Mj=D.Count;ik=this.gridView.zd.lci(Gc);gh=`StatusBarAggregateManager.testCalcResult: allCorrect: ${fj}, ${JSON.stringify(Kh)}, numberFormatCategory: ${hk}, resLength(server,calc): ${JSON.stringify(zk)}, stateId: ${fb}, latestSuccessfulStateId: ${Vb}, prevSheetId: ${ae}, prevSheetHash: ${He}, numOfRanges: ${th}, numOfCells: ${ek}, prevActiveCell: ${zd}, prevSelectedRanges: ${Gc.join(";")}, sheetHasHidden: ${Qh}, panesState: ${dk}, blockPositionString: ${Vi}, ReportCalcState: ${gh.ReportCalcState}, CalcComplete: ${gh.CalcComplete}, serverCount: ${Fj}, calcCount: ${Mj}, calcCountUnfiltered: ${ha}, enumeratorCount: ${ik}, forceTestResult: ${hf}`;
ba.ULS.sendTraceTag(520426510,0,50,gh);fj||hf||window.setTimeout(()=>{this.atg(!0)},100)}}})}A4g(D){const ha=this.gridView.Ol,fb=this.gridView.Nr;return!!ha&&Hd.a.all(D,Vb=>ha.contains(Vb))&&Hd.a.all(D,Vb=>!fb.Zbb(Vb))}x4g(D){if(500<Gb.b(D))return!1;const ha=this.zj.og;D=this.gridView.A7("StatusBarAggregateManager.AreAllCellsEmpty",D);try{for(let fb=0;D.$$mn();fb++)if(D.$$cu().HG||!(fb%25)&&100<wd.c(this.zj,ha))return!1}finally{D&&D.dispose()}return!0}Tza(D){return this.Zwa.Tza(D)}fUj(D,ha,fb){this.Zwa.TUg(D,
"Query"+ha+"Label","Query"+ha+"Button",fb.toString())}Aug(){var D;if(this.$.If&4&&!this.gridView.ld&&!this.gridView.fl){var ha;(()=>{let fb=ig.$sg(this.ha.ra.selectedRanges);({Z$b:ha}=fb);return fb})().returnValue?this.FUb(ha):(this.FUb(null),this.nsf&&(null===(D=this.calcManager)||void 0===D?0:D.ypc)?this.OKj():this.YLc=rj.AsyncMethodContext.Wr(this.C9j,500,ed.a.I5j,this.YLc))}}OKj(){this.ZLc=rj.AsyncMethodContext.Wr(()=>this.atg(!1),10,ed.a.J5j,this.ZLc)}tZd(){this.$Lc=rj.AsyncMethodContext.Wr(this.j9f,
500,ed.a.H5j,this.$Lc)}CLe(){this.Ejc&&(this.l7.Gx(this.Ejc.Qw),this.Ejc=null)}XRi(D,ha){const fb={};fb.a=this.$.xa.UserSessionId;fb.b=D;fb.c=ha;Gd.b().ih(29,fb)}static initData(){const D=Kd.a.$ca;for(const ha of Hf)D(ha.rZa,$b.a.Yn()?ce.a.hi|8192:ce.a.hi,0,0)}static la(D){ig.initData();const ha=new ig(D);D.Ha.z6(ha);D.ga.Qa(27,ha)}static $sg(D){return{returnValue:1===D.length&&D[0].isSingle,Z$b:null}}}Object(da.a)(ig,"StatusBarAggregateManager",null,[631,5,295,188,203]);var Bf=a(1228),Uf=a(922);
class Xf{}Xf.L9j=864E5;Xf.h1g=3;Xf.P2i=144E5;Object(da.a)(Xf,"AddinConstantsNum",null,[]);var Lg=a(753),Ng=a(837),mh=a(869);class Gh{constructor(D,ha,fb,Vb){this.da=(Vb=void 0===Vb?null:Vb)?Vb:na.AFrameworkApplication.da;this.fVc=2;this.mRa=D;this.GSg=ha;this.Sd=fb}get Joa(){return this.fVc}get flk(){return this.GSg}tYd(D){if(this.da.pa("AgaveSupportsLiveIdSpoofing")){var ha=(new Date).getTime();this.mRa(D,this.Joa,{["ak0"]:ha})}else if(mh.a.zYj(D)){ha=String.format(na.AFrameworkApplication.sa.Ra.rZ+
"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",na.AFrameworkApplication.sa.Ra.kj,this.flk,na.AFrameworkApplication.Ak);const fb=na.AFrameworkApplication.tf;let Vb=null;this.Sd&&(Vb=this.Sd.Ze("ComponentAttach",Ng.a[D]+Uf.a[this.Joa]));fb.Ho(ha,1,null,null,!0,4,Gc=>{this.Kgj(D,Gc.data.Tf);Vb&&Vb.stop()},Gc=>{ba.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",Gc.data.httpStatus);this.Ifb(D,1,"request failed");Vb&&Vb.stop()},null)}else mh.a.Ilf(D)?
(ha=mh.a.R$e(D),this.mRa(D,this.Joa,{["ak0"]:ha})):this.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&(this.PF?this.Ifb(D,1,"no local timestamp"):this.mRa(D,this.Joa,null))}Kgj(D,ha){if(ha&&""!==ha)if(ha=Sys.Net.XMLDOM(ha)){mh.a.zLc(Lg.a.iDe,((new Date).getTime()+Xf.P2i).toString(),D);let fb=ha.getElementsByTagName("update");fb&&fb.length||(fb=ha.getElementsByTagName("o:update"));fb&&0<fb.length?(ha=Date.parse(fb[0].firstChild.nodeValue),mh.a.R$e(D)<
ha||mh.a.Ilf(D)?this.mRa(D,this.Joa,{["ak0"]:ha}):this.Ifb(D,1,"outdate timestamp in reponse")):this.Ifb(D,2,"no timestamp in response")}else this.Ifb(D,1,"response data is invalid");else this.Ifb(D,1,"no responseData")}Ifb(D,ha,fb){this.PF&&this.mRa(D,this.Joa,{["AddinServiceUserState"]:ha,["DiagnosticInfo"]:fb})}get PF(){return this.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",
!1)}}Object(da.a)(Gh,"AddinCommandsAnonymousAPIInitializer",null,[702]);class Vh{constructor(D,ha,fb){this.fVc=fb;this.mRa=D;this.Hj=ha}get Joa(){return this.fVc}tYd(D){let ha=null;this.Hj&&(ha=this.Hj.Ze("ComponentAttach",Ng.a[D]+Uf.a[this.Joa]));if(null==this.p3d(D)?0:this.p3d(D)){const fb=(new Date).getTime()-Xf.h1g*Xf.L9j;this.mRa(D,this.Joa,{["ak0"]:fb})}ha&&ha.stop()}}Object(da.a)(Vh,"AddinCommandsInitializerBase",null,[702]);class bi extends Vh{constructor(D,ha){super(D,ha,5)}p3d(){return!0}}
Object(da.a)(bi,"AddinCommandsInitializer",Vh,[]);class Zh extends Vh{constructor(D,ha){super(D,ha,1)}p3d(D){try{const ha=Lg.a.$cf()+D;return Boolean.parse(this.y3h(ha)||"false")}catch(ha){ba.ULS.sendTraceTag(17306844,220,50,"LocalStorage is not allowed, {0}.",ha.toString())}return null}y3h(D){const ha=localStorage;return void 0!==ha&&null!==ha?ha.getItem(D):null}}Object(da.a)(Zh,"AddinCommandsLocalCacheInitializer",Vh,[]);var Ii=a(567);class $h{constructor(D,ha){ha=void 0===ha?null:ha;this.Sd=D;
this.da=ha?ha:na.AFrameworkApplication.da}get appUILocale(){return Ii.a.pN(na.AFrameworkApplication.lcid).name}Uvi(){if(this.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&this.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",!1)&&this.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableTUIForBEPHomeTab",!1)){var D=
{};D[Lg.a.oDh]="TeachingCallout";this.hBc(Za.a.Hlb,D)}const ha=this.Cod();if(ha)if(this.da.pa("OcpsIsEnabled"))Ja.a.instance.Qd("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(fb=>{fb.isFeatureEnabled("ConnectedServices",!0).then(Vb=>{for(const Gc of ha){if(!Vb&&0===Gc.key){this.PF&&this.Yrg(0,Gc.value,{["AddinServiceUserState"]:3,["DiagnosticInfo"]:"connected services is off"});continue}const zd=this.q$e(Gc.value);zd&&zd.tYd(Gc.key)}return null})});else for(const fb of ha)(D=
this.q$e(fb.value))&&D.tYd(fb.key)}uYd(D,ha,fb){fb&&fb[Lg.a.dLa]?(fb[Lg.a.T0]=D,fb[Lg.a.$W]=ha,this.hBc(Za.a.Vra,fb),mh.a.zLc(Lg.a.dLa,fb[Lg.a.dLa].toString(),D)):this.PF?this.Yrg(D,ha,fb):this.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&0===D&&(fb={},fb[Lg.a.T0]=D,fb[Lg.a.$W]=ha,this.hBc(Za.a.AC,fb))}q$e(D){let ha=null;switch(D){case 1:ha=new Zh(Object(La.a)(this,this.uYd,"retrieveAddinFlagCompleted"),this.Sd);break;case 2:ha=new Gh(Object(La.a)(this,
this.uYd,"retrieveAddinFlagCompleted"),this.appUILocale,this.Sd,this.da);break;case 5:ha=new bi(Object(La.a)(this,this.uYd,"retrieveAddinFlagCompleted"),this.Sd)}return ha}Yrg(D,ha,fb){0===D&&fb&&fb[Lg.a.v8b]&&(fb[Lg.a.T0]=D,fb[Lg.a.$W]=ha,ba.ULS.sendTraceTag(508829835,220,50,"AddinServiceUserState: {0}, addinCommandsInitFlagInfo: {1}",fb[Lg.a.v8b].toString(),JSON.stringify(fb)),this.hBc(Za.a.AC,fb))}get PF(){return this.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&this.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}}Object(da.a)($h,"AddinCommandsInitializerHost",null,[]);var Di=a(276),Fg=a(835),mg=a(267),rg=a(359);let Nf;class Kg extends bh.StandardDialog{constructor(D,ha){super();this.mge=CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;this.hje=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;this.ije=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.orb=!1;this.Wvb=()=>{this.hide();this.orb&&
f(this.sja)};this.J4i=()=>{Fg.a.instance.getItem("optedIntoAddinDeveloperMode")?(Fg.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.orb=!1):(Fg.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.orb=!0)};this.sja=D;Nf=ha}showDialog(D,ha){try{this.ug=void 0===this.ug||null===this.ug?mg.a.MVa(rg.a.o5).toString():this.ug,this.show({["type"]:"StandardDialogProps",["id"]:this.ug,["dialogIcon"]:3,["headerText"]:D,["titleText"]:ha,["resultHandler"]:this.Wvb,["messageAreaLink"]:this.jth(),
["permanentDismissCheckbox"]:this.fth(),["renderMicrosoftLogoInHeader"]:!1})}catch(fb){this.EOc(D,ha)}}jth(){return{["type"]:"AppLinkProps",["id"]:"WACDialogExtraLink",["text"]:this.hje,["handler"]:{["href"]:this.ije,["target"]:"_blank"},["onExecute"]:null}}fth(){return{["type"]:"AppCheckboxProps",["id"]:"WACDialogOptInCheckbox",["label"]:this.mge,["onExecute"]:this.J4i}}EOc(D,ha){const fb=new nh.a(!1,!1,!1);fb.Rd=1;fb.ug=mg.a.MVa(rg.a.o5).toString();fb.di=String.format(this.rY(),ha,this.ije,this.hje,
this.mge);fb.initializeAndShow(D,this.zCg,{optInCheckbox:!1})}zCg(D,ha){1==D&&ha.optInCheckbox&&(Fg.a.instance.getItem("optedIntoAddinDeveloperMode")?(Fg.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.orb=!1):(Fg.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.orb=!0,f(this.sja)))}rY(){return ib.EwaSettings.isChangeGateEnabled("OfficeVSO:7726503_DeveloperModeStyleFix")?"<div style='height:100px;width:400px;border:none;'><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>":
"<div style=\ufffdheight:100px;width:400px;border:none;\ufffd><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>"}}Object(da.a)(Kg,"AppsForOfficeDeveloperModeOptInDialog",bh.StandardDialog,[]);var sg=a(387);class Pg extends $h{constructor(D){super(D.Sd);this.sja=this.j0b=null;this.kJa=new Di.a;this.y4f=ha=>{1===ha&&this.sja&&this.x4f()};this.$=D;Bf.a.TFb=Bf.a.r5e}get appUILocale(){return this.$.xa.UICultureTag}Jsg(){this.Uvi();
this.Udk()}Cod(){const D=new sg.a;this.$.ea.pj.get(27)&&(D.fa(0,2),""!==na.AFrameworkApplication.da.Sa("HostInstallAddIns")&&D.fa(16,5));this.$.ea.pj.get(33)&&D.fa(1,1);ib.EwaSettings.Ea(52)&&D.fa(8,1);this.$.mg.get(35)&&D.fa(10,5);return D}hBc(D,ha){this.kGh(()=>{const fb=new bb.a(D,0,this.$.se,0,null);this.$.Ha.Ad(fb,ha)})}kGh(D){(ha=>{ha=this.$.ga.Da(ha);return!!ha&&Ac.d(ha)})(198)?(new lb.a,this.$.ga.qd(198,ha=>{D(ha)})):D(null)}Udk(){this.sja=na.AFrameworkApplication.da.Sa("DevAddinManifestFileUrl");
this.j0b=na.AFrameworkApplication.da.Sa("DevAddinManifestGuid");var D=na.AFrameworkApplication.da.Sa("IsDevAddinTest");if(this.sja&&this.j0b&&D){D="true"===D;var ha=this.kJa.getItem("optedIntoAddinDeveloperMode");const fb=this.kJa.getItem(this.j0b);ha||D&&na.AFrameworkApplication.da.pa("SuppressDeveloperAddinDialogs")?fb||D&&na.AFrameworkApplication.da.pa("SuppressDeveloperAddinDialogs")?this.x4f():(D=new bh.StandardDialog,D.Rd=4,ha=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+
String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.sja)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl,D.BV(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,ha,this.y4f)):(D=new Kg(this.sja,this.y4f),D.Rd=0,D.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage))}}x4f(){const D=df.GetServiceTaskFactory.create(this.$.ga,106,this.$.ka,1);qa.TaskExtensions.za(D,()=>
{D.result.Vg.validateAndCacheNewDevAddinManifest(this.sja);this.kJa.setItem(this.j0b,"true")},this.$.ka,3)}}Object(da.a)(Pg,"AddinCommandsInitService",$h,[646]);class Fh extends Ta.a{constructor(D){super();this.addinCommandsInitService=null;this.ff=()=>{ba.ULS.sendTraceTag(537170701,0,50,`AddinCommandsInitServiceFactory.OnSessionIdChanged: isSessionActive ${this.$.ea.oe}, isEditMode ${this.$.isEditMode} , showCommandUI [${!!(this.$.If&16384)}] `);this.addinCommandsInitService.Jsg();this.$.ea.gm(this.ff)};
this.$=D;this.je()}create(){this.$.ga.qd(53,()=>{this.Ld(Object(sc.a)(this.$.ga,202,()=>this.addinCommandsInitService||(this.addinCommandsInitService=new Pg(this.$))));this.$.ea.oe?(ba.ULS.sendTraceTag(537170702,0,50,`AddinCommandsInitServiceFactory.Create: calling TryInitializeAddinCommands, isEditMode: [${this.$.isEditMode}], showCommandUI [${!!(this.$.If&16384)}] `),this.addinCommandsInitService.Jsg()):this.$.ea.Zl(this.ff)})}static la(D){D.ga.Qa(201,new Fh(D))}}Object(da.a)(Fh,"AddinCommandsInitServiceFactory",
Ta.a,[]);var ci=a(284);class Si{constructor(D){this.CTa=this.bId=this.GTa=this.Wuc=0;this.VHd=this.pFf=null;D?(this.evc=D,this.vzb=Date.now,this.xsh(),this.Exj()):ba.ULS.sendTraceTag(520955213,209,10,"Can not initialize PenMinutesManager because TaskManager is null")}ygg(){this.pFf="Office.Excel.Online.Data.Activity.PenMinutes"}Exj(){window.document.body.addEventListener("pointerenter",Object(La.a)(this,this.Dyc,"onPointerEnter"));window.document.body.addEventListener("pointerleave",Object(La.a)(this,
this.Sga,"onPointerLeave"));Ja.a.instance.Qd("Common.App.VisibilityManagement.IVisibilityManager").execute(D=>{D.HCe(Object(La.a)(this,this.dFb,"handleVisibilityChange"))})}Dyc(D){"pen"!==D.pointerType||this.GTa||(this.GTa=Math.floor(this.vzb()/1E3),this.GTa<=this.Wuc&&(this.GTa=this.Wuc),this.bId=0)}Sga(){this.llf()}llf(){const D=Math.ceil(this.vzb()/1E3);this.GTa&&D>this.Wuc&&(this.bId=D,this.CTa+=this.bId-this.GTa);this.Wuc=D;this.GTa=0}dFb(D,ha){0!==ha.newState&&this.llf()}xsh(){this.VHd=new qc.a(4,
2,6E4,Object(La.a)(this,this.oTi,"logPenUsage"));this.evc.Sh(this.VHd)}oTi(){0<this.CTa&&this.Cdg(this.CTa);this.CTa=0}Cdg(D){const ha=new ci.a;ha.name=this.pFf;const fb=[];(D=rd.a.Yg("PenInputSec",D.toString(),3))&&Array.add(fb,D);ha.dataFields=fb;Jc.a.sendActivityEvent(ha)}dispose(){0<this.CTa&&this.Cdg(this.CTa);this.evc.rr(this.VHd)}}Object(da.a)(Si,"PenMinutesManager",null,[623]);class zi{constructor(){this.FZc=this.hd=null}get name(){return"Common.App.PenMinutesManager"}Xj(D){this.hd=D;const ha=
na.AFrameworkApplication.Vj;this.hd.register(623,"Common.App.PenMinutesManager.IPenMinutesManager").Ee().Le(()=>new Si(ha))}init(){this.FZc=this.hd.resolve("Common.App.PenMinutesManager.IPenMinutesManager")}dispose(){this.FZc&&this.FZc.dispose()}static main(){Sb.a.instance.Tk(new zi)}}Object(da.a)(zi,"PenMinutesManagerPackage",null,[2,3]);const Fi=()=>{Type.registerNamespace("Common.App.PenMinutesManager");zi.main()};class li extends Ta.a{constructor(D){super();this.$=D;this.je()}static la(D){D.ga.Qa(514,
new li(D))}create(){this.Ld(Object(sc.a)(this.$.ga,513,()=>{Fi();const D=Ja.a.instance.resolve("Common.App.PenMinutesManager.IPenMinutesManager");D.ygg();return D}))}}Object(da.a)(li,"PenMinutesFactory",Ta.a,[]);class gi{static w3h(D){try{return caches.open(gi.Jfe).then(ha=>ha.match(D))}catch(ha){return Promise.reject(null)}}static Pza(D,ha){try{return gi.w3h(D).then(fb=>fb&&Number.parseInvariant(fb.headers.get("cachedTime"))>Date.now()-ha?Promise.resolve(fb.text().toLocaleString()):Promise.reject("Not found")).catch(()=>
Promise.reject("Cache returned undefined"))}catch(fb){return Promise.reject(null)}}static store(D,ha){try{return caches.open(gi.Jfe).then(fb=>{fb.put(D,ha).then(()=>!0);return!1}).catch(()=>Promise.resolve(!1))}catch(fb){return Promise.resolve(!0)}}static g6j(D,ha){const fb={};fb.body=ha;const Vb={};Vb.cachedTime=Date.now().toString();fb.headers=Vb;ha=new Response(ha,fb);gi.store(D,ha).then(()=>!0)}}gi.Jfe="ConsentState";Object(da.a)(gi,"CacheManager",null,[]);class Hg{constructor(){this.message=
null;this.d9=0}}Object(da.a)(Hg,"HttpRequstToPromiseRejectData",null,[]);class yg{constructor(D){this.t0=D}lZ(D,ha,fb,Vb,Gc,zd){Jc.a.sendTelemetryEvent(Object.assign(new $d.a,{name:"Office.Online."+D,dataFields:[Object.assign(new fd.a,{name:"EventMessage",string:ha}),Object.assign(new fd.a,{name:"FormFactor",string:this.t0.formFactor}),Object.assign(new fd.a,{name:"CorrelationId",string:this.t0.correlationId}),Object.assign(new fd.a,{name:"AccountType",string:this.t0.accountType}),Object.assign(new fd.a,
{name:"OSVersion",string:this.t0.osVersion}),Object.assign(new fd.a,{name:"AppId",string:this.t0.appId}),Object.assign(new fd.a,{name:"ConsentSurface",string:"AppStart"}),Object.assign(new fd.a,{name:"ConsentLanguage",string:this.t0.consentLanguage}),Object.assign(new fd.a,{name:"EventCode",string:fb}),Object.assign(new fd.a,{name:"Region",string:this.t0.region}),Object.assign(new fd.a,{name:"ModelType",string:Vb}),Object.assign(new fd.a,{name:"ModelId",string:Gc}),Object.assign(new fd.a,{name:"Platform",
string:this.t0.os}),Object.assign(new fd.a,{name:"ReConsentReason",string:""}),Object.assign(new fd.a,{name:"ConsentType",string:zd})]}))}}Object(da.a)(yg,"TelemetryLogger",null,[]);var hi=a(217);class oh{constructor(D,ha,fb){this.iHg="https://consent.config.office.com/consentcheckin/v1.0/consents";this.Oa=D;this.Qi=ha;this.ywa=fb;this.HS=new yg(fb)}pNa(D,ha){return new Promise((fb,Vb)=>{const Gc=this.Oa.Hf("UCNoticeCheckinCallTimeoutMs",5E3);let zd=this.Oa.Sa("UCNoticeCheckinStateUrl");zd&&zd.length||
(zd=this.iHg);this.Qi.D6(zd,1,null,this.HDb(D),null,!1,0,ae=>{try{if(void 0===ae||null===ae||void 0===ae.data||null===ae.data||void 0===ae.data.Tf||null===ae.data.Tf){this.HS.lZ("UnifiedConsent.ConsentGetFailed","CheckInApi : Invalid response","711",null,null,null);const hf=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}","UnifiedConsent.ConsentGetFailed");Vb(this.EK(hf,ae))}else if(ae.data.httpStatus!==
hi.a.PE){this.HS.lZ("UnifiedConsent.ConsentGetFailed","CheckInApi : HTTP failure",ae.data.httpStatus.toString(),null,null,null);const hf=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",ae.data.httpStatus,"UnifiedConsent.ConsentGetFailed");Vb(this.EK(hf,ae))}else{var He=ha(ae.data.Tf);if(He)fb(He);else{this.HS.lZ("UnifiedConsent.ConsentGetFailed","CheckInApi : Consent values are empty",
"712",null,null,null);const hf=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}","UnifiedConsent.ConsentGetFailed");Vb(this.EK(hf,ae))}}}catch(hf){this.HS.lZ("UnifiedConsent.ConsentGetFailed","CheckInApi : Unexpected failure","713",null,null,null),He=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",hf,"UnifiedConsent.ConsentGetFailed"),Vb(this.EK(He,ae))}},ae=>{this.HS.lZ("UnifiedConsent.ConsentGetFailed",
"CheckInApi : Error in service call ",ae.data.httpStatus.toString(),null,null,null);const He=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, request - {1}",ae.data.httpStatus,"UnifiedConsent.ConsentGetFailed");Vb(this.EK(He,ae))},null,void 0,void 0,2500,Gc)})}EK(D,ha){const fb=new Hg;fb.message=D;fb.d9=ha&&ha.data?ha.data.httpStatus:-1;return fb}HDb(D){const ha={};ha["Accept-Language"]=this.ywa.consentLanguage;ha.consentsurface="AppStart";ha.platform=
"Web";ha.formfactor=cb.a.e3?"Mobile":"Desktop";ha["x-Cid"]=this.ywa.correlationId;ha.Authorization="Bearer "+D;return ha}}Object(da.a)(oh,"HttpRequestToPromiseUtility",null,[]);class Wh{constructor(){this.accountType="MSA";this.modelType=null;this.appEnv=0;this.emailId=this.deviceId=this.consentLanguage=this.appVersion=this.appId=this.appName=null;this.formFactor="Unknown";this.token=this.region=this.osVersion=this.os=null;this.useCache=!1;this.correlationId=this.userId=null;this.isDarkMode=!1}}Object(da.a)(Wh,
"WebSdkAdapterProps",null,[]);class Hh{constructor(D,ha,fb,Vb){this.ble=this.mja=this.a6=this.n0=null;this.N_a=Vb;this.Oa=D;this.FFg=fb;this.Qi=ha;this.ywa=this.getDimensions();this.HS=new yg(this.ywa)}ekg(){"MSA"===(this.Oa.Sa("HostAuthType")||"").toUpperCase()&&gi.Pza(this.ywa.userId,this.Oa.Hf("UCNoticeCheckinCacheTimeMs",862E5)).then(()=>{this.HS.lZ(Hh.eJa,"CacheFound","701",this.n0,this.a6,this.mja);return{}}).catch(()=>{this.FFg.execute(D=>{D.$C("Consent",Hh.sRg).then(ha=>{ha.IsSuccess?(this.HS.lZ(Hh.eJa,
"CheckInTokenSuccess","702",this.n0,this.a6,this.mja),this.Y4h(ha.Token).then(fb=>{this.ebi(fb);this.n0&&""!==this.n0&&D.$C("Consent",Hh.uRg).then(Vb=>{Vb.IsSuccess?(this.HS.lZ(Hh.eJa,"WebTokenSuccess","703",this.n0,this.a6,this.mja),this.O0j(Vb,this.n0)):this.HS.lZ(Hh.eJa,"WebTokenFailed : "+Vb.ErrorMessage,Vb.ErrorCode,this.n0,this.a6,this.mja);return{}});return{}})):this.HS.lZ(Hh.eJa,"CheckInTokenFailed : "+ha.ErrorMessage,ha.ErrorCode,this.n0,this.a6,this.mja);return{}})})})}Y4h(D){this.ble=new oh(this.Oa,
this.Qi,this.ywa);return this.ble.pNa(D,Object(La.a)(this,this.sjj,"parseConsentCheckinState")).then(ha=>Promise.resolve(ha),ha=>Promise.reject("Error while getting result"+ha))}sjj(D){if(void 0===D||null===D)return this.HS.lZ(Hh.eJa,"Checkin response undefined or null","705",this.n0,this.a6,this.mja),null;try{const {Mu:ha}=wb.d(D);return ha}catch(ha){this.HS.lZ(Hh.eJa,"Checkin response parse error : "+ha.message,"706",this.n0,this.a6,this.mja)}return null}ebi(D){for(const ha of D.consentValues)if(ha.needConsent&&
!ha.maxPromptsReached){this.a6=ha.id;this.mja=ha.consentType;this.n0=ha.modelType;return}gi.g6j(this.ywa.userId,wb.c(D))}O0j(D,ha){if(ob.a("showConsentNotice")){const fb=document.createElement("div");document.body.appendChild(fb);appChrome.api.showConsentNotice(this.D6h(D.Token,ha),fb)}else this.HS.lZ(Hh.kMg,"1JS : ShowConsentNotice API not found","704",this.n0,this.a6,this.mja)}D6h(D,ha){const fb=this.ywa;fb.token=D;fb.modelType=ha;return fb}getDimensions(){const D=this.Cxd(this.Oa.Sa("SessionStartInfoJson"));
return Object.assign(new Wh,{emailId:this.Oa.Sa("UserPrincipalName"),userId:this.Oa.Sa("LoggableUserId"),accountType:"AAD"===(this.Oa.Sa("HostAuthType")||"").toUpperCase()?"AAD":"MSA",appId:this.Oa.Sa("OfficeApplicationId"),appVersion:this.Oa.Sa("appVersion"),appName:"Application"in D?D.Application:"",appEnv:this.N_a,consentLanguage:this.Oa.Sa("UICulture")||"en-US",formFactor:cb.a.e3?"Mobile":"Desktop",os:"Os"in D?D.Os:"",osVersion:"OsVersion"in D?D.OsVersion:"",region:this.Oa.Sa("region"),correlationId:Cg.a.create().toString(),
isDarkMode:this.Oa.pa("DarkModeIsOn"),useCache:!0})}Cxd(D){let ha={};try{ha=wb.b(D)}catch(fb){}return ha}}Hh.uRg="https://consentservice.microsoft.com/web";Hh.sRg="https://consentservice.microsoft.com/checkin";Hh.kMg="UnifiedConsent.ConsentGetFailed";Hh.eJa="UnifiedConsent.AuthTokenStatus";Object(da.a)(Hh,"ConsentNoticeManager",null,[689]);class Oh{constructor(){this.hd=null}get name(){return"Common.App.ConsentNoticeDialog"}Xj(D){this.hd=D;D.register(Hh,"Common.App.ConsentNoticeDialog.ConsentNoticeManager").as("Common.App.ConsentNoticeDialog.IConsentNoticeManager").Ee().Le(()=>
new Hh(na.AFrameworkApplication.da,na.AFrameworkApplication.tf,D.Qd("Common.App.OAuth.IOAuthManager"),na.AFrameworkApplication.rOa))}init(){this.hd.resolve("Common.App.ConsentNoticeDialog.IConsentNoticeManager")}dispose(){}static main(){Sb.a.instance.Tk(new Oh)}}Object(da.a)(Oh,"ConsentNoticeDialogPackage",null,[2,3]);let Xi=class{constructor(){Type.registerNamespace("Common.App.ConsentNoticeDialog");Oh.main();Ja.a.instance.Qd("Common.App.ConsentNoticeDialog.IConsentNoticeManager").execute(D=>D.ekg())}};
Xi=Object(Xb.a)([Object(je.d)(Fd.ad)],Xi);Object(da.a)(Xi,"UnifiedConsentAdapter",null,[]);let mj=class{constructor(D){this.NLf=()=>{this.UZa(this.$.ea.GZa,this.$.ea.Lhb);this.uik()};this.$=D;this.shortcutKeyManager=this.$.shortcutKeyManager;this.isMac=cb.a.isMac;this.shortcutKeyManager.vYg(this.NLf)}dispose(){this.shortcutKeyManager.xAj(this.NLf);this.$=null}jRj(){const D=this.Wjh.concat(this.QYi).map(ha=>appChrome.actions.setControlCustomTooltip(ha.commandId,this.A$a(ha)));appChrome.api.dispatch(D)}UZa(D,
ha){this.Pek&&(this.kP[0].title=this.kP[2].title=this.nae(D),this.kP[1].title=this.nwg(ha),this.kP[1].shortcut=this.isMac?this.shortcutKeyManager.en(192):this.shortcutKeyManager.en(154));D=this.A$a(this.kP[1]);ha=this.A$a(this.kP[2]);D=[appChrome.actions.setControlCustomTooltip(this.kP[0].commandId,this.A$a(this.kP[0])),appChrome.actions.setControlCustomTooltip(this.kP[1].commandId,D),appChrome.actions.setControlCustomTooltip(this.kP[2].commandId,ha)];appChrome.api.dispatch(D)}oSi(D,ha){this.jKi(D)&&
zb.b(ha)}jKi(D){return-1502853784===D||-111689794===D||-287251124===D||-1925065947===D||1764140053===D||-1590502662===D||-600086683===D||963349338===D||862890474===D||1220954656===D||1891435765===D||1896159024===D||-1554384558===D||-1985798686===D||-911352779===D||237279923===D||996232352===D?!0:!1}get QYi(){this.HJ||(this.HJ=[],this.HJ.push(this.qk("Paste_MLR",Od.a.instance.Ia(513),Od.a.instance.Ia(767),this.shortcutKeyManager.en(176))),this.HJ.push(this.qk("Cut",Od.a.instance.Ia(511),Od.a.instance.Ia(768),
this.shortcutKeyManager.en(172))),this.HJ.push(this.qk("Copy",Od.a.instance.Ia(512),Od.a.instance.Ia(769),this.shortcutKeyManager.en(174))),this.HJ.push(this.qk("AlignTop_MLR",Od.a.instance.Ia(791),Od.a.instance.Ia(792))),this.HJ.push(this.qk("AlignMiddle_MLR",Od.a.instance.Ia(793),Od.a.instance.Ia(794))),this.HJ.push(this.qk("AlignBottom_MLR",Od.a.instance.Ia(795),Od.a.instance.Ia(796))),this.HJ.push(this.qk("AlignLeft_MLR",Od.a.instance.Ia(797),Od.a.instance.Ia(799))),this.HJ.push(this.qk("AlignCenter_MLR",
Od.a.instance.Ia(800),Od.a.instance.Ia(801))),this.HJ.push(this.qk("AlignRight_MLR",Od.a.instance.Ia(802),Od.a.instance.Ia(803))),this.HJ.push(this.qk("IncreaseIndent",Od.a.instance.Ia(804),Od.a.instance.Ia(805))),this.HJ.push(this.qk("DecreaseIndent",Od.a.instance.Ia(806),Od.a.instance.Ia(807))),this.HJ.push(this.qk("Wrap",Od.a.instance.Ia(808),Od.a.instance.Ia(809))),this.HJ.push(this.qk("Merge",Od.a.instance.Ia(810),Od.a.instance.Ia(811))),this.HJ.push(this.qk("NumberFormatPercentage_MLR",Od.a.instance.ia(453),
Od.a.instance.Ia(814),this.shortcutKeyManager.en(404))),this.HJ.push(this.qk("NumberFormatComma_MLR",Od.a.instance.Ia(815),Od.a.instance.Ia(816))));return this.HJ}get Wjh(){this.Fq||(this.Fq=[],this.Fq.push(this.qk("UndoRedo",Od.a.instance.Ia(83),"",this.isMac?this.shortcutKeyManager.en(191):this.shortcutKeyManager.en(153))),this.Fq.push(this.qk("FormatPainter",Od.a.instance.ia(14),Od.a.instance.Ia(770))),this.Fq.push(this.qk("FontName_New",Od.a.instance.Ia(771),Od.a.instance.Ia(772))),this.Fq.push(this.qk("FontSize",
Od.a.instance.Ia(773),Od.a.instance.Ia(774))),this.Fq.push(this.qk("Bold",Od.a.instance.ia(1333),Od.a.instance.Ia(775),this.isMac?this.shortcutKeyManager.en(180):this.shortcutKeyManager.en(179))),this.Fq.push(this.qk("Italic",Od.a.instance.ia(1334),Od.a.instance.Ia(776),this.isMac?this.shortcutKeyManager.en(184):this.shortcutKeyManager.en(183))),this.Fq.push(this.qk("BordersSplitButtonCompactMenu",Od.a.instance.Ia(777),Od.a.instance.Ia(779),this.isMac?this.shortcutKeyManager.en(190):this.shortcutKeyManager.en(189))),
this.Fq.push(this.qk("FillColor",Od.a.instance.ia(537),Od.a.instance.Ia(780))),this.Fq.push(this.qk("FontColor",Od.a.instance.Ia(781),Od.a.instance.Ia(782))),this.Fq.push(this.qk("GrowFontSize",Od.a.instance.Ia(783),Od.a.instance.Ia(784),this.shortcutKeyManager.en(187))),this.Fq.push(this.qk("ShrinkFontSize",Od.a.instance.Ia(785),Od.a.instance.Ia(786),this.shortcutKeyManager.en(188))),this.Fq.push(this.qk("Underline",Od.a.instance.ia(1335),Od.a.instance.Ia(787),this.isMac?this.shortcutKeyManager.en(182):
this.shortcutKeyManager.en(181))),this.Fq.push(this.qk("Strikethrough",Od.a.instance.ia(1336),Od.a.instance.Ia(788),this.isMac?this.shortcutKeyManager.en(186):this.shortcutKeyManager.en(185))),this.Fq.push(this.qk("DoubleUnderline",Od.a.instance.Ia(789),Od.a.instance.Ia(790))),this.Fq.push(this.qk("NumberFormatNew",Od.a.instance.Ia(812),Od.a.instance.Ia(813))),this.Fq.push(this.qk("NumberFormatAccountingNew",Od.a.instance.ia(449),Od.a.instance.Ia(817))),this.Fq.push(this.qk("IncreaseDecimal",Od.a.instance.Ia(818),
Od.a.instance.Ia(819))),this.Fq.push(this.qk("DecreaseDecimal",Od.a.instance.Ia(820),Od.a.instance.Ia(821))),this.Fq.push(this.qk("ConditionalFormatting",Od.a.instance.Ia(822),Od.a.instance.Ia(823))),this.Fq.push(this.qk("CellStylesGallery",Od.a.instance.Ia(824),Od.a.instance.Ia(825))),this.Fq.push(this.qk("FormatAsTableAlt",Od.a.instance.Ia(826),Od.a.instance.Ia(827))),this.Fq.push(this.qk("Format",Od.a.instance.Ia(828),Od.a.instance.Ia(829))),this.Fq.push(this.qk("AutoSum",Od.a.instance.Ia(830),
Od.a.instance.Ia(831),this.shortcutKeyManager.en(259))),this.Fq.push(this.qk("SortAndFilter",Od.a.instance.Ia(832),Od.a.instance.Ia(833))),this.Fq.push(this.qk("FindAndSelect",Od.a.instance.Ia(834),Od.a.instance.Ia(835),this.shortcutKeyManager.en(85))),this.Fq.push(this.qk("AnalyzeData",Od.a.instance.Ia(836),Od.a.instance.Ia(837))),this.Fq.push(this.qk("Sensitivity",Od.a.instance.Ia(838),Od.a.instance.Ia(839))),this.Fq.push(this.qk("InsertCells",Od.a.instance.ia(345),Od.a.instance.Ia(840),this.shortcutKeyManager.S$?
this.shortcutKeyManager.en(409):"")),this.Fq.push(this.qk("DeleteCells",Od.a.instance.ia(409),Od.a.instance.Ia(841),this.shortcutKeyManager.S$?this.shortcutKeyManager.en(407):"")),this.Fq.push(this.qk("ClearCells",Od.a.instance.Ia(842),Od.a.instance.Ia(843))));return this.Fq}get Pek(){this.kP||(this.kP=[],this.kP.push(this.qk("Undo",this.nae(2),Od.a.instance.Ia(765),this.isMac?this.shortcutKeyManager.en(191):this.shortcutKeyManager.en(153))),this.kP.push(this.qk("Redo",this.nwg(2),Od.a.instance.Ia(766),
this.isMac?this.shortcutKeyManager.en(192):this.shortcutKeyManager.en(154))),this.kP.push(this.qk("UndoRedo",this.nae(2),"",this.isMac?this.shortcutKeyManager.en(191):this.shortcutKeyManager.en(153))));return this.kP}qk(D,ha,fb,Vb){return{commandId:D,title:ha,description:fb,shortcut:Vb,Hqi:Vb?!0:!1}}A$a(D){let ha;ha=D.title;D.Hqi&&(ha+=" "+D.shortcut);"UndoRedo"!==D.commandId&&(ha+="\n\n"+D.description);return ha}nae(D){switch(D){case 1:case 0:return D=Od.a.instance.Ia(81);case 3:return D=Od.a.instance.Ia(84);
case 2:return D=Od.a.instance.Ia(83);case 4:return D=Od.a.instance.Ia(82);default:return D=Od.a.instance.Ia(81)}}nwg(D){switch(D){case 1:case 0:return D=Od.a.instance.Ia(78);case 2:return D=Od.a.instance.Ia(80);case 4:return D=Od.a.instance.Ia(79);default:return D=Od.a.instance.Ia(78)}}uik(){var D=this.qk("InsertCells",Od.a.instance.ia(345),Od.a.instance.Ia(840),this.shortcutKeyManager.S$?this.shortcutKeyManager.en(409):"");const ha=this.qk("DeleteCells",Od.a.instance.ia(409),Od.a.instance.Ia(841),
this.shortcutKeyManager.S$?this.shortcutKeyManager.en(407):"");D=[appChrome.actions.setControlCustomTooltip(D.commandId,this.A$a(D)),appChrome.actions.setControlCustomTooltip(ha.commandId,this.A$a(ha))];appChrome.api.dispatch(D)}};mj=Object(Xb.a)([Object(je.d)(Fd.ab),Object(Xb.b)(0,Object(Fd.W)())],mj);Object(da.a)(mj,"ExtendedTooltipsManager",null,[5]);var rk=a(356);const Hj=(D,ha)=>{ha=void 0===ha?!1:ha;D=new Sf.Range(D.top,D.left,D.bottom,D.right,!1,ha);if(ha&&(1>D.top||D.top>D.maxRows||1>D.bottom||
D.bottom>D.maxRows||D.top>D.bottom||1>D.left||D.left>D.maxColumns||1>D.right||D.right>D.maxColumns||D.left>D.right))throw ba.ULS.sendTraceTag(510247817,0,10,"Range.ValidateRange: range is invalid"),Error.argument("Range.ValidateRange: range is invalid");return D};var Ui=a(886),jk=a(799),Yj=a(324),fk=a(815);const dj={[0]:[45],[1]:[46]};class kk{constructor(D){this.$=D;this.sessionStorage=new Map;this.doUndo=()=>{const ha=this;return Io(function*(){yield Object(Ui.d)(ha.$)})};this.highlightRangesOnGrid=
(ha,fb,Vb)=>{const Gc=this;return Io(function*(){Gc.cC(ha,fb,dj[Vb])})};this.openCustomNumberFormat=()=>{const ha=this;return Io(function*(){return new Promise(fb=>{Object(Ui.a)(ha.$,Vb=>{fb(Vb);ba.ULS.sendTraceTag(509617692,0,50,`HostAppCallbacks.openCustomNumberFormat: resolved with "${Vb?"OK":"Cancel"}"`)})})})};this.openFeedback=ha=>{const fb=this;return Io(function*(){Object(Ui.e)(fb.$,ha)})};this.sendOtelEvent=ha=>Io(function*(){Object(jk.b)(ha)});this.containsHiddenCells=ha=>u(this.$,ha);this.getSessionStorageItem=
(ha,fb)=>{const Vb=this;return Io(function*(){var Gc;return null===(Gc=Vb.sessionStorage.get(ha))||void 0===Gc?void 0:Gc.get(fb)})};this.setSessionStorageItem=(ha,fb,Vb)=>{const Gc=this;return Io(function*(){var zd;Gc.sessionStorage.has(ha)||Gc.sessionStorage.set(ha,new Map);null===(zd=Gc.sessionStorage.get(ha))||void 0===zd?void 0:zd.set(fb,Vb)})};this.replaceMultipleStrings=(ha,fb,Vb,Gc)=>{const zd=this;return Io(function*(){const ae=ha.map(He=>Hj(He,!1));return t(zd.$,ae,fb,Vb,{["SheetName"]:zd.$.na.sheetName,
["MatchCase"]:Gc.matchCase,["MatchEntireCell"]:Gc.matchEntireCell,["SearchAllSheets"]:!1,["ExcludeFormulaResult"]:!1,["SearchUp"]:!1,["SearchStrings"]:fb,["ReplaceWholeWordOnly"]:Gc.replaceWholeWordOnly})})};this.trimWhitespace=(ha,fb)=>{const Vb=this;return Io(function*(){const Gc=ha.map(zd=>Hj(zd,!1));return x(Vb.$,Gc,fb.map(r))})};this.formatCells=(ha,fb)=>{const Vb=this;return Io(function*(){const Gc=ha.map(ae=>Hj(ae,!1)),zd={NumberFormatOptions:Object(Rd.a)(new fk.a,{NumberFormatCategory:-1,
CustomFormatString:fb}),ValidMembers:32,NumberFormat:15};return v(Vb.$,Gc,zd)})}}get grid(){return $a.h(this.$)}cC(D,ha,fb){fb=void 0===fb?[45]:fb;const Vb=this.grid.Kd;Vb.cm(fb,!1,!0);Vb.kn(null,fb,!1);if(null===D||void 0===D?0:D.length){const Gc=rk.a.jGa(yf.d(this.$.na),D.map(zd=>Hj(zd,!1)));Vb.QC(Gc,fb,!0,void 0,!1);ha&&this.DZi(D)}Vb.update(!1)}DZi(D){if(null===D||void 0===D?0:D.length){const ha=this.grid;[D]=D.sort((fb,Vb)=>fb.top<Vb.top?-1:fb.top>Vb.top?1:0);D=Sf.Range.Je(D.top,D.left);ha.dG(D)||
(ba.ULS.sendTraceTag(509617691,0,50,"HostAppCallbacks.moveViewportToRangeIfNeeded moving viewport"),ha.az(D,0,"DataCleansing"))}else ba.ULS.sendTraceTag(509617690,0,10,"HostAppCallbacks.moveViewportToRangeIfNeeded no ranges to move viewport")}}Object(da.a)(kk,"HostAppCallbacks",null,[639]);class lk{constructor(){this.errorState=null;this.isFeedbackAllowed=this.isInCoauthoring=this.isInViewMode=!1}}Object(da.a)(lk,"HostState",null,[]);class gk{constructor(){this.sheetName=this.sheetId=null;this.isProtected=
this.isInNamedSheetView=!1}}Object(da.a)(gk,"WorksheetState",null,[]);class mk{constructor(){this.annotations=[];this.hostState=new lk;this.worksheetState=new gk}}Object(da.a)(mk,"DataCleansingHostState",null,[]);class nk{constructor(D){this.$=D;this.tXe=this.sXe=!1}get isEnabled(){return ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTeachingCallout",!1)||ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverabilityCallout",!1)}show(D,
ha){ha=void 0===ha?!1:ha;const fb=!ha;if(this.isEnabled&&!(ha&&this.tXe||fb&&this.sXe)){if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:7813501_CalloutOneSuggestion")){if(1>D){ba.ULS.sendTraceTag(508913414,0,50,`DataCleansing.showCallout: suggestion count(${D}).`);return}if(2>D&&fb){ba.ULS.sendTraceTag(509720201,0,50,`DataCleansing.showCallout: suggestion count(${D}) is below threshold to show teaching callout`);return}}else if(2>D){ba.ULS.sendTraceTag(509720201,0,50,`DataCleansing.showCallout: suggestion count(${D}) is below threshold to show teaching callout`);
return}ba.ULS.sendTraceTag(508887310,0,50,`DataCleansing.showCallout: dispatchShowCalloutCommand. coolDown:(${fb}).`);Object(Ui.b)(this.$,D,ha);ha?this.tXe=!0:this.sXe=!0}}}Object(da.a)(nk,"TeachingCallout",null,[]);class fh{constructor(D){fh.assign(fh,this,D)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static S8(D){return D&&D.H_?D.H_.T_:void 0}static RCb(D){return D&&D.H_&&D.H_.B_?D.H_.B_:[]}static $$e(D){const ha=fh.S8(D);return ha?[ha,...fh.RCb(D)]:[]}static iG(D,
ha){if(!Array.isArray(ha)||0===ha.length)return!0;const fb=fh.S8(D);D=fh.RCb(D);for(const Vb of ha)if(Vb===fb||0<=D.indexOf(Vb))return!0;return!1}static assign(D,ha,fb){if(fb)for(const Vb of Object.keys(fb))ha[Vb]=fb[Vb];ha.H_=D.H_;return ha}}fh.H_={T_:fh.getTypeName(),B_:fh.getBaseTypes()};class Ij{constructor(D){fh.assign(Ij,this,D)}get metadata(){return this.M_}set metadata(D){this.M_=D}static getTypeName(){return"AugLoop_ExcelCleanData_CleanDataResolverAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(D){return fh.iG(D,
[Ij.getTypeName()])}}Ij.H_={T_:Ij.getTypeName(),B_:Ij.getBaseTypes()};class Pj{constructor(D){fh.assign(Pj,this,D)}get metadata(){return this.M_}set metadata(D){this.M_=D}static getTypeName(){return"AugLoop_Tablelint_TableLintAnnotationBase"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(D){return fh.iG(D,[Pj.getTypeName()])}}Pj.H_={T_:Pj.getTypeName(),B_:Pj.getBaseTypes()};class Qj{constructor(D){fh.assign(Qj,this,D)}get metadata(){return this.M_}set metadata(D){this.M_=
D}static getTypeName(){return"AugLoop_Tablelint_TableLintAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(D){return fh.iG(D,[Qj.getTypeName()])}}Qj.H_={T_:Qj.getTypeName(),B_:Qj.getBaseTypes()};class zj{constructor(D){fh.assign(zj,this,D)}get metadata(){return this.M_}set metadata(D){this.M_=D}static getTypeName(){return"AugLoop_Tablelint_TableLintColumnAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase",
"AugLoop_Core_Annotation"]}static typeGuard(D){return fh.iG(D,[zj.getTypeName()])}}zj.H_={T_:zj.getTypeName(),B_:zj.getBaseTypes()};class Rj{constructor(D){fh.assign(Rj,this,D)}get metadata(){return this.M_}set metadata(D){this.M_=D}static getTypeName(){return"AugLoop_Tablelint_TableLintErrorAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(D){return fh.iG(D,[Rj.getTypeName()])}}Rj.H_={T_:Rj.getTypeName(),B_:Rj.getBaseTypes()};
class Jj{constructor(D){fh.assign(Jj,this,D)}get metadata(){return this.M_}set metadata(D){this.M_=D}static getTypeName(){return"AugLoop_Tablelint_TableLintUnsupportedFeatureAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(D){return fh.iG(D,[Jj.getTypeName()])}}Jj.H_={T_:Jj.getTypeName(),B_:Jj.getBaseTypes()};class Aj{constructor(D){fh.assign(Aj,this,D)}get metadata(){return this.M_}set metadata(D){this.M_=D}static getTypeName(){return"AugLoop_Tablelint_TableLintWorksheetAggregateAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(D){return fh.iG(D,
[Aj.getTypeName()])}}Aj.H_={T_:Aj.getTypeName(),B_:Aj.getBaseTypes()};class Sj{constructor(D){fh.assign(Sj,this,D)}static getTypeName(){return"AugLoop_Tablelint_TableLintSuggestion"}static getBaseTypes(){return[]}static typeGuard(D){return fh.iG(D,[Sj.getTypeName()])}}Sj.H_={T_:Sj.getTypeName(),B_:Sj.getBaseTypes()};class qj{constructor(D){fh.assign(qj,this,D)}static getTypeName(){return"AugLoop_Tablelint_TableLintTextInconsistencySuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(D){return fh.iG(D,
[qj.getTypeName()])}}qj.H_={T_:qj.getTypeName(),B_:qj.getBaseTypes()};class Zj{constructor(D){fh.assign(Zj,this,D)}static getTypeName(){return"AugLoop_Tablelint_TableLintNumberFormattingInconsistencySuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(D){return fh.iG(D,[Zj.getTypeName()])}}Zj.H_={T_:Zj.getTypeName(),B_:Zj.getBaseTypes()};class Tj{constructor(D){fh.assign(Tj,this,D)}static getTypeName(){return"AugLoop_Tablelint_TableLintExtraSpacesSuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(D){return fh.iG(D,
[Tj.getTypeName()])}}Tj.H_={T_:Tj.getTypeName(),B_:Tj.getBaseTypes()};var Kj=a(885),ok=a(186);class pk{constructor(D){this.$=D;this.rXe=!1}oVb(D){const ha=this;return Io(function*(){if(ha.rXe)ba.ULS.sendTraceTag(509089825,0,50,"DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar was already shown.");else{var fb=String.format(Od.a.instance.xd(213),D),Vb=ok.a.ia(1952),Gc=ok.a.ia(1954);ha.businessBarManager||(ha.businessBarManager=Object(Ge.a)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?
yield je.a.resolve(Fd.m,{Ja:1}):yield df.GetServiceTaskFactory.cQa(ha.$.ga,5,4,1));ha.businessBarManager.E_j(fb,Gc,Vb,()=>{ha.RQa()});ha.rXe=!0;ba.ULS.sendTraceTag(509089824,0,50,`DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar with  ${D} suggestions.`)}})}RQa(){this.businessBarManager&&this.businessBarManager.yH(70)&&this.businessBarManager.removeEntry(70)}}Object(da.a)(pk,"BusinessBar",null,[]);var Uj;const wk=ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingDisableTaskPaneWhenALSessionClose",
!1);let ak=Uj=class extends qb.a{constructor(D,ha){super();this.$=D;this.X8b=ha;this.ahd=!1;this.k$=new mk;this.mUf=(fb,Vb)=>{const Gc=this;return Io(function*(){Gc.tTi(Vb.sheetId,Vb.annotations);Gc.stateChanged();yield Gc.zkf()})};this.om=(fb,Vb)=>{const Gc=this;return Io(function*(){Gc.sug(Vb.rE);Gc.yog(Vb.na);Gc.stateChanged();Gc.businessBar.RQa();yield Gc.zkf()})};this.Nqa=()=>{this.stateChanged()};this.kE=()=>{this.stateChanged()};this.z$=()=>{this.stateChanged()};this.vVf=(fb,Vb)=>{var [Gc,
zd]=Vb;ba.ULS.sendTraceTag(509613389,0,50,`DataCleansingHostManager.onUnrecoverableErrorOccurred: Received augmentation loop session close. ${JSON.stringify({["closeReason"]:Kj.a[Gc],["errorCode"]:zd})}`);wk&&(this.k$.hostState.errorState=zd,this.stateChanged())};this.L$=(fb,Vb)=>{yf.m(Vb.item)&&Vb.item.Oj!==this.k$.worksheetState.isProtected&&(ba.ULS.sendTraceTag(509613388,0,50,`DataCleansingHostManager.onSheetOptionsChanged: sheet protection has changed to ${Vb.item.Oj}.`),this.stateChanged())};
this.Uqa=(fb,Vb)=>{if(fb=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:8099641_DisableFutureDiscoverability"))fb=Vb.hostState,Vb=Vb.worksheetState,fb=!!fb.errorState||fb.isInViewMode||Vb.isInNamedSheetView||Vb.isProtected;fb&&this.ffc()};this.k3g=new kk(this.$);this.Epg=new nk(this.$);this.businessBar=new pk(this.$);ha.D0g(this.mUf);ha.S0g(this.vVf);void ha.I3c();D.sn.Ri(this.om);D.ea.gda(this.kE);D.ea.N0(this.z$);this.yog(this.$.na);this.j8b(this.Uqa);ib.EwaSettings.isChangeGateEnabled("OfficeVSO:7985428_AddingIsFeedbackAllowed")&&
this.$.sad(()=>{this.stateChanged()})}j8b(D){this.addHandler(Uj.W5d,D)}x7f(D){this.removeHandler(Uj.W5d,D)}dispose(){this.X8b.aDj(this.mUf);this.X8b.mDj(this.vVf);this.$.sn.uj(this.om);this.$.ea.yaa(this.kE);this.$.ea.k4(this.z$);this.sug(this.$.na);super.dispose()}get state(){this.k$.annotations=this.X8b.n2g();if(yf.m(this.$.na)){const D=this.$.na.Oj,ha=this.$.na.sheetId,fb=this.$.na.sheetName;this.k$.worksheetState.isInNamedSheetView=this.$.na.ng.$D;this.k$.worksheetState.isProtected=D;this.k$.worksheetState.sheetId=
ha;this.k$.worksheetState.sheetName=fb}this.k$.hostState.isInViewMode=!this.$.ea.isEditMode;this.k$.hostState.isInCoauthoring=this.isInCoauthoring();ib.EwaSettings.isChangeGateEnabled("OfficeVSO:7985428_AddingIsFeedbackAllowed")&&(this.k$.hostState.isFeedbackAllowed=this.$.isFeedbackEnabled);return this.k$}ffc(){ib.EwaSettings.isChangeGateEnabled("OfficeVSO:8099641_DisableFutureDiscoverability")&&(this.businessBar.RQa(),this.ahd=!0)}isInCoauthoring(){return!1}stateChanged(){this.raiseEvent(Uj.W5d,
this.state)}yog(D){yf.m(D)&&(D.ng.K3a(this.Nqa),D.N3a(this.L$))}sug(D){yf.m(D)&&(D.ng.iib(this.Nqa),D.yDc(this.L$))}XTg(){if(!yf.m(this.$.na))return 0;const D=this.X8b.iig(this.$.na.sheetId);return(ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AugmentationLoopTableLint_ActivateResolver",!1)?D.find(Ij.typeGuard):D.find(Aj.typeGuard))?l(D):0}tTi(D,ha){ha=ha.filter(zj.typeGuard);const fb=B(ha);ba.ULS.sendTraceTag(509698241,0,50,`DataCleansingHostManager.logPotentialSuggestionsInfo: ${JSON.stringify({["sheetId"]:D,
["suggestionsInfo"]:fb,["numberFormatTypes"]:y(E(ha).entries())})}`)}get wAh(){return ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverabilityBusinessBar",!1)}zkf(){const D=this;return Io(function*(){const ha=D.XTg();0===ha?D.businessBar.RQa():D.AZj(ha)&&(D.wAh?(yield D.Vbk(ha),D.ahd=!0):D.Sbk(ha))})}Sbk(D){ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTeachingCallout",!1)&&this.Epg.isEnabled&&this.Epg.show(D,!1)}Vbk(D){const ha=
this;return Io(function*(){yield ha.businessBar.oVb(D)})}AZj(D){return!this.ahd&&0<D&&!(ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&this.$.isMobileMode)}};ak.W5d="scek";ak=Uj=Object(Xb.a)([Object(je.d)(Fd.I),Object(Xb.b)(0,Object(Fd.W)()),Object(Xb.b)(1,Object(Fd.G)())],ak);Object(da.a)(ak,"DataCleansingHostManager",qb.a,[]);class Vj{constructor(D){fh.assign(Vj,this,D)}get metadata(){return this.M_}set metadata(D){this.M_=D}static getTypeName(){return"AugLoop_ExcelCleanData_ExtraSpacesColumnAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(D){return fh.iG(D,
[Vj.getTypeName()])}}Vj.H_={T_:Vj.getTypeName(),B_:Vj.getBaseTypes()};class Bj{constructor(D){fh.assign(Bj,this,D)}get metadata(){return this.M_}set metadata(D){this.M_=D}static getTypeName(){return"AugLoop_ExcelCleanData_ExtraSpacesTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(D){return fh.iG(D,[Bj.getTypeName()])}}Bj.H_={T_:Bj.getTypeName(),B_:Bj.getBaseTypes()};class bk{constructor(D){fh.assign(bk,this,D)}get metadata(){return this.M_}set metadata(D){this.M_=
D}static getTypeName(){return"AugLoop_ExcelCleanData_RowsIdentityAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(D){return fh.iG(D,[bk.getTypeName()])}}bk.H_={T_:bk.getTypeName(),B_:bk.getBaseTypes()};class Lj{constructor(D){fh.assign(Lj,this,D)}get metadata(){return this.M_}set metadata(D){this.M_=D}static getTypeName(){return"AugLoop_ExcelCleanData_DuplicatedRowsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(D){return fh.iG(D,
[Lj.getTypeName()])}}Lj.H_={T_:Lj.getTypeName(),B_:Lj.getBaseTypes()};class ck{constructor(D){fh.assign(ck,this,D)}get metadata(){return this.M_}set metadata(D){this.M_=D}static getTypeName(){return"AugLoop_ExcelCleanData_UnprintableCharactersColumnAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(D){return fh.iG(D,[ck.getTypeName()])}}ck.H_={T_:ck.getTypeName(),B_:ck.getBaseTypes()};class Cj{constructor(D){fh.assign(Cj,this,D)}get metadata(){return this.M_}set metadata(D){this.M_=
D}static getTypeName(){return"AugLoop_ExcelCleanData_UnprintableCharactersTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(D){return fh.iG(D,[Cj.getTypeName()])}}Cj.H_={T_:Cj.getTypeName(),B_:Cj.getBaseTypes()};class Wj{constructor(D){fh.assign(Wj,this,D)}get metadata(){return this.M_}set metadata(D){this.M_=D}static getTypeName(){return"AugLoop_ExcelCleanData_DataOutlierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(D){return fh.iG(D,
[Wj.getTypeName()])}}Wj.H_={T_:Wj.getTypeName(),B_:Wj.getBaseTypes()};class sk extends qb.a{constructor(D,ha){super();this.rla=!1;this.Gog=(fb,Vb)=>{fb=Vb.annotation;if(!fb)ba.ULS.sendTraceTag(508560025,306,50,"AnnotationsProvider.suggestionsAnnotationHandler suggestionsAnnotation is null.");else if(!Bj.typeGuard(fb)||ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AugmentationLoopTableLint_UseNewExtraSpacesLinter",!1))switch(Vb.operationType){case 1:case 2:this.raiseEvent("sarek",fb);
break;case 3:break;default:ba.ULS.sendTraceTag(508560024,306,15,`AnnotationsProvider.suggestionsAnnotationHandler Received unexpected OperationType:${Vb.operationType}`)}};this.j$f=(fb,Vb)=>{if(Vb.annotation)switch(Vb.operationType){case 1:case 2:this.raiseEvent("rarek",Vb.annotation);break;case 3:break;default:ba.ULS.sendTraceTag(508560027,306,15,`AnnotationsProvider.resolverAnnotationHandler Received unexpected OperationType:${Vb.operationType}`)}else ba.ULS.sendTraceTag(508560028,306,50,"AnnotationsProvider.resolverAnnotationHandler: resolverAnnotation is null.")};
this.f8j=(fb,Vb)=>{ba.ULS.sendTraceTag(508560023,306,50,`AnnotationsProvider.TableLintColumnAnnotationStateUpdateHandler Received state update: ${fb}->${Vb}`)};this.Ti=D;this.F3i=ha}I3c(){this.rla?ba.ULS.sendTraceTag(508560026,0,50,"AnnotationsProvider.ActivateEvents: Events are already registered"):(this.$xj(),this.rla=!0)}dispose(){this.rla&&(this.Lfk(),this.rla=!1)}L0g(D){this.addHandler("sarek",D)}gDj(D){this.removeHandler("sarek",D)}m0g(D){this.addHandler("rarek",D)}LCj(D){this.removeHandler("rarek",
D)}$xj(){ba.ULS.sendTraceTag(574482312,0,50,"AnnotationsProvider.RegisterTableLintEvents: activate annotations");const D=this.Ti.j2().E4("DataCleansing").C4(this.F3i).activateAnnotation({annotationType:zj.getTypeName(),iu:!0,BEe:this.f8j,UGa:this.Gog}).activateAnnotation({annotationType:Rj.getTypeName(),iu:!0}).activateAnnotation({annotationType:Jj.getTypeName(),iu:!0});ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindDuplicatedRowsLinter",!1)&&D.activateAnnotation({annotationType:Lj.getTypeName(),
iu:!0});ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindUnprintableCharacters",!1)&&D.activateAnnotation({annotationType:Cj.getTypeName(),iu:!0});(ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AugmentationLoopTableLint_CombinedExtraSpacesSuggestions",!1)||ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AugmentationLoopTableLint_UseNewExtraSpacesLinter",!1))&&D.activateAnnotation({annotationType:Bj.getTypeName(),iu:!0,UGa:this.Gog});ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindDataOutliers",
!1)&&D.activateAnnotation({annotationType:Wj.getTypeName(),iu:!0});ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AugmentationLoopTableLint_ActivateResolver",!1)?D.activateAnnotation({annotationType:Ij.getTypeName(),iu:!0,UGa:this.j$f}):D.activateAnnotation({annotationType:Aj.getTypeName(),iu:!0,UGa:this.j$f});this.Ti.register(D.build())}Lfk(){this.Ti.unregister("DataCleansing")}}Object(da.a)(sk,"AnnotationsProvider",qb.a,[5]);var Dj;let Xj=Dj=class extends qb.a{constructor(D){super();
this.$=D;this.mEc=new Map;this.UPd=new Map;this.E6d=new Map;this.dxc=(ha,fb)=>{ha=void 0===ha?"Unknown":ha;ba.ULS.sendTraceTag(520987272,0,50,`DataCleansingAnnotationsManager.onAugmentationLoopSessionClose: Received augmentation loop session close. ${JSON.stringify({["closeReason"]:Kj.a[ha],["errorCode"]:fb})}`);this.raiseEvent(Dj.J9d,[ha,fb])};this.QUf=(ha,fb)=>{this.UPd.set(fb.id,fb);ba.ULS.sendTraceTag(512354457,0,100,`DataCleansingAnnotationsManager.onColumnAnnotationReceived: Received ${fb.id}`)};
this.$Kf=(ha,fb)=>{ha=this.mEc.get(fb.worksheetId);ba.ULS.sendTraceTag(512354456,0,50,`DataCleansingAnnotationsManager.onAggregateAnnotationReceived: Received ${JSON.stringify({["id"]:fb.id,["sheetId"]:fb.worksheetId,["previous"]:null===ha||void 0===ha?void 0:ha.id})}`);(null===ha||void 0===ha?void 0:ha.id)===fb.id&&ba.ULS.sendTraceTag(512354455,0,50,`DataCleansingAnnotationsManager.onAggregateAnnotationReceived: Received duplicate ${fb.id}`);this.mEc.set(fb.worksheetId,fb);ha=this.cfi(fb);ha.forEach(Vb=>
{this.UPd.delete(Vb.id)});this.E6d.set(fb.id,ha);this.b3g(fb.worksheetId)}}D0g(D){this.addHandler(Dj.p2d,D)}aDj(D){this.removeHandler(Dj.p2d,D)}S0g(D){this.addHandler(Dj.J9d,D)}mDj(D){this.removeHandler(Dj.J9d,D)}dispose(){this.vLa&&(this.vLa.gDj(this.QUf),this.vLa.LCj(this.$Kf),this.vLa.dispose());super.dispose()}I3c(){const D=this;return Io(function*(){const ha=yield je.a.resolve(Fd.i,{Ja:1});ha?(D.vLa=new sk(ha,D.dxc),D.vLa.L0g(D.QUf),D.vLa.m0g(D.$Kf),D.vLa.I3c(),ba.ULS.sendTraceTag(520987274,
0,50,"DataCleansingAnnotationsManager.activateEvents: events activated")):ba.ULS.sendTraceTag(520987273,0,10,"DataCleansingAnnotationsManager.activateEvents: no augmentationLoopManager")})}iig(D){var ha;if(D=this.mEc.get(D)){const fb=null!==(ha=this.E6d.get(D.id))&&void 0!==ha?ha:[];return[D,...fb]}return[]}n2g(){const D=[];this.mEc.forEach(ha=>{var fb;const Vb=null!==(fb=this.E6d.get(ha.id))&&void 0!==fb?fb:[];D.push(ha,...Vb)});return D}b3g(D){D={sheetId:D,annotations:this.iig(D)};this.raiseEvent(Dj.p2d,
D)}cfi(D){var ha=Array.from(this.UPd.values()).filter(Gc=>Gc.worksheetId===D.worksheetId);if(!ha.length)return ba.ULS.sendTraceTag(509682374,0,50,"DataCleansingAnnotationsManager.getRelatedPendingAnnotations: No pending sheet annotations"),[];if(!Array.isArray(D.aggregatedAnnotations))return ba.ULS.sendTraceTag(509682373,0,20,"DataCleansingAnnotationsManager.getRelatedPendingAnnotations: No aggregated annotations IDs"),ha;const fb=new Set(D.aggregatedAnnotations),Vb=ha.filter(Gc=>fb.has(Gc.id));ha=
ha.filter(Gc=>!fb.has(Gc.id));ha.length&&ba.ULS.sendTraceTag(509682372,0,50,`DataCleansingAnnotationsManager.getRelatedPendingAnnotations: Found ${ha.length} unrelated annotations`);return Vb}};Xj.p2d="sacek";Xj.J9d="ueoek";Xj=Dj=Object(Xb.a)([Object(je.d)(Fd.G),Object(Xb.b)(0,Object(Fd.W)())],Xj);Object(da.a)(Xj,"DataCleansingAnnotationsManager",qb.a,[]);class tk{constructor(){this.startTime=Hc.a.$b.ke;this.gA=new pj.a}Acf(){return wd.a(Hc.a.$b,this.startTime)}}Object(da.a)(tk,"OngoingAction",null,
[]);class uk extends za.a{constructor(D,ha,fb,Vb,Gc){Gc=void 0===Gc?null:Gc;super();this.NUa=this.Vub=null;this.L9c=0;this.pzc=null;this.Fdj=()=>{const zd=this.NUa.Acf();ba.ULS.sendTraceTag(537153861,0,50,`ActionAggregator<${this.$pa}>.OnRunningLong: Operation running for more than ${zd}ms`);this.pzc=W.a.instance.create(this.O$,Math.max(this.eKe-zd,0),ed.a.Fye)};this.O$=()=>{ba.ULS.sendTraceTag(537153860,0,50,`ActionAggregator<${this.$pa}>.OnTimeout: Operation running for more than ${this.NUa.Acf()}ms, timing out. Has pending actions: ${this.Uab}`);
this.L9c++;this.L9c>this.dKe&&ba.ULS.sendTraceTag(537153859,0,50,`ActionAggregator<${this.$pa}>.OnTimeout: passed the allowed bypassed count`);this.NUa.gA.cancel();this.J7e()};this.rC=()=>{this.Uab&&ba.ULS.sendTraceTag(537153858,0,50,`ActionAggregator<${this.$pa}>.OnDocumentUnhidden: Start. IsActionOngoing: ${this.vRa}, AggregatedActionParams not null: ${this.Uab}`);this.uyd()};this.BTg=D;this.CTg=ha;this.documentVisibilityObserver=fb;this.$pa=Vb;this.DO=Gc;fb&&this.documentVisibilityObserver.YW(this.rC);
this.K9c=!!fb&&ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);this.dKe=ib.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);ha=ib.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);this.eKe=D.L$e(ha);D=ib.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);this.ubh=Math.max(this.eKe-
ha,0)+D}get vRa(){return!!this.NUa}get Uab(){return!!this.Vub}WXf(D){ba.ULS.sendTraceTag(537153864,0,50,`ActionAggregator<${this.$pa}>.PerformThrottledAction: Start. IsActionOngoing: ${this.vRa}, AggregatedActionParams not null: ${this.Uab}`);this.Vub=this.CTg.PDe(D,this.Vub);this.uyd()}dispose(){this.documentVisibilityObserver&&this.documentVisibilityObserver.DEa(this.rC);this.NLe();super.dispose()}qgg(D){this.K9c?(this.NUa=D?new tk:null,D?this.startTimer():this.NLe()):this.NUa=D?{}:null}J7e(D){D=
void 0===D?null:D;this.K9c&&D&&D.pQ?ba.ULS.sendTraceTag(537153863,0,50,`ActionAggregator<${this.$pa}>.FinishedCallback: timedout, skipping`):(ba.ULS.sendTraceTag(537153862,0,50,`ActionAggregator<${this.$pa}>.FinishedCallback: Start. IsActionOngoing: ${this.vRa}, AggregatedActionParams not null: ${this.Uab}`),this.qgg(!1),this.uyd())}uyd(){if(!this.lVb()){var D=this.Vub;this.Vub=null;this.qgg(!0);ba.ULS.sendTraceTag(537153857,0,50,`ActionAggregator<${this.$pa}>.InternalPerformAction: Calling PerformAction.`);
var ha=this.K9c?this.NUa.gA.token:Eb.a.none;qa.TaskExtensions.za(this.BTg.SXf(D),()=>{this.J7e(ha)},ha,0,this.DO)}}lVb(){return!this.Uab||this.vRa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.hj?(ba.ULS.sendTraceTag(593376846,0,50,`ActionAggregator<${this.$pa}>.ShouldThrottle: Not Calling PerformAction as document is hidden.`),!0):!1}NLe(){this.pzc&&this.pzc.cancel()}startTimer(){this.L9c<=this.dKe&&(this.pzc=W.a.instance.create(this.Fdj,this.ubh,ed.a.Fye))}}Object(da.a)(uk,
"ActionAggregator",za.a,[642,5]);class xg extends qb.a{constructor(D){super();this.jz=this.firstElement=null;this.SRa=!1;this.vv=null;this.BWj=cb.a.vh;this.AQf=ha=>{const fb=ha.Ba.keyCode;return fb===Eg.a.xk?this.b7i():fb===Eg.a.HE&&ha.Ba.shiftKey?this.CSh(this.firstElement):!1};this.WVf=ha=>{if(!this.SRa||ha.Ba.keyCode!==Eg.a.JO)return!1;xg.wnf();ka.Task.delay(1).Vr(()=>{this.jz.focus();return!0},0,this.ka);return!0};this.Rgj=()=>{document.activeElement&&document.activeElement.id===this.jz.id||(xg.wnf(),
ka.Task.delay(1).Vr(()=>{this.jz.focus();return!0},0,this.ka))};this.yOf=()=>{this.Irg(this.jz)};this.zQf=ha=>{ha.stopPropagation();ha.preventDefault();this.SRa&&(this.SRa=!1)};this.$=D;(D=this.$.ea.te)&&ba.ULS.sendTraceTag(39350791,0,50,`EmbedViewFocusControl: PermissionSet = ${D.Oxa}; InWebPart = '${D.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${D.inEmbedView?"True (+Modern)":"False (not Modern)"}'`);D&&(D.inWebPart||D.inEmbedView)?ba.ULS.sendTraceTag(537153856,0,15,`EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '${D.inWebPart?
"Classic":"Non Classic"}', InEmbedView = '${D.inEmbedView?"True (+Modern)":"False (not Modern)"}'`):(this.qqh(),this.orh(),hg.KeyInputManager.instance.ta(ze.a.me,this.$.domElement,this.WVf));this.$.ga.Qa(238,this)}$Zg(D){this.addHandler("KBIS",D)}NBj(D){this.removeHandler("KBIS",D)}dispose(){this.firstElement&&Rf.a.removeHandler(this.firstElement,ze.a.focus,this.yOf);this.vv&&this.vv.detach("focus");this.jz&&(Rf.a.removeHandler(this.jz,ze.a.focus,this.zQf),Rf.a.removeHandler(this.jz,ze.a.blur,xg.onBlur),
hg.KeyInputManager.instance.Aa(ze.a.me,this.jz,this.AQf));hg.KeyInputManager.instance.Aa(ze.a.me,this.$.domElement,this.WVf);this.vv=this.jz=this.firstElement=this.$=null;super.dispose()}qqh(){this.BWj?(this.firstElement=document.documentElement,this.vv=gb.a.instance.UM(document.parentWindow),this.vv.la("focus",this.Rgj)):(this.firstElement=xg.TSe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),Rf.a.addHandler(this.firstElement,ze.a.focus,this.yOf))}orh(){this.jz=xg.TSe();
this.jz.id=Af.a.q_e;this.jz.setAttribute(Af.a.Pw,Od.a.instance.ia(863));document.body.appendChild(this.jz);Rf.a.addHandler(this.jz,ze.a.focus,this.zQf);Rf.a.addHandler(this.jz,ze.a.blur,xg.onBlur);hg.KeyInputManager.instance.ta(ze.a.me,this.jz,this.AQf)}CSh(D){this.Irg(D);return!1}b7i(){this.SRa=!0;$a.h(this.$).focus();$a.h(this.$).ha.Lkf();this.raiseEvent("KBIS");return!0}Irg(D){this.SRa?this.SRa=!1:(this.SRa=!0,D&&D.focus())}static TSe(){const D=document.createElement("div");D.tabIndex=0;return D}static wnf(){document.body.classList.add(De.a.L1e)}static onBlur(){document.body.classList.remove(De.a.L1e)}}
Object(da.a)(xg,"EmbedViewFocusControl",qb.a,[641,5]);var qk=a(69),K=a(532),Da=a(125);class xb extends qb.a{constructor(D,ha){super();this.ySb=this.Zpd=this.wDb=this.tS=null;this.C2b=!1;this.qhe=null;this.fpa=this.NSd=!1;this.G8i=(fb,Vb,Gc)=>{ba.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+Gc);this.ySb&&this.ySb.stop();this.tS=null;this.raiseEvent("GetFieldInfoListContextOperationFailed")};this.H8i=fb=>{lc.a(fb)||(this.ySb&&this.ySb.stop(),this.C2b=!1,(this.tS=
fb.Result)&&0<this.tS.length&&ba.ULS.sendTraceTag(25264351,0,50,`Retrieved ${this.tS.length} rich value field list context for autocomplete`),this.g1a=!0,this.yBc())};this.g1a=!1;this.vd=D;this.e1b=-1;this.tableManager=ha;this.NSd=ib.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults");this.fpa=ib.EwaSettings.fpa()}o5c(D){this.addHandler("FieldInfoListContextLoaded",D)}JVd(D){this.removeHandler("FieldInfoListContextLoaded",D)}yZg(D){this.addHandler("GetFieldInfoListContextOperationFailed",
D)}tBj(D){this.removeHandler("GetFieldInfoListContextOperationFailed",D)}get rAd(){return this.g1a}get UQi(){return this.C2b}get H9e(){return this.e1b}get zfd(){return this.qhe}get $(){return this.vd}get sr(){return this.tS}get R7h(){return!!this.wDb}dispose(){this.vd=null;this.hEc();super.dispose()}X9a(D,ha,fb,Vb){Vb=void 0===Vb?null:Vb;if(D){this.q$c();this.kac();var Gc=null,zd=!1;if(!Vb&&(()=>{let ae=this.rdk(D,ha,fb);({ogb:zd,sr:Gc}=ae);return ae})().returnValue)if(this.NSd||this.qfg(Gc),this.C2b=
!0,this.tS=Gc,this.NSd){if(!zd){this.g1a=!0;this.yBc();return}}else if(this.tS&&0<this.tS.length&&(this.g1a=!0,this.yBc()),!zd)return;this.Lvg(D,Vb,ha,fb,!1)}}Lvg(D,ha,fb,Vb,Gc){if(this.$.ea.oe){this.$.Sd&&(this.ySb=this.$.Sd.Ze("WebServiceCall","GetRichValueFieldInfoListContext"));this.wDb=null;var zd=this.$.qa.ua.ie(),ae=this.$.qa.ua,He=this.H8i,hf=this.G8i;const zf=ae.Pa(1,null);zf.selectedRange=D;zf.richValueKeyPath=ha;zf.singleColumn=fb;zf.searchForRange=Vb;zf.calculateMajorityDataType=Gc;this.wDb=
be.g(ae,"GetRichValueFieldListContextList",zf,He,hf,null,zd,4)}else this.tS=null}hEc(){this.tS=null;this.g1a=!1;this.q$c();this.kac();this.wDb=null;this.e1b=-1}q$c(){xb.Xwb(this.wDb)}kac(){xb.Xwb(this.Zpd)}yBc(){this.raiseEvent("FieldInfoListContextLoaded")}fu(D){D=Gb.E(D);--D.left;--D.right;return this.tableManager.fu(D)}IPa(D){D.FirstColumn=D.FirstColumn;D.LastColumn=D.LastColumn;D.FirstRow=D.FirstRow;D.LastRow=D.LastRow;this.kac();this.Zpd=null;return ya.a(this.$.userOperationManager,(ha,fb,Vb)=>
Yj.k(this.$.qa.ua,D,Bd.b(ha,Gc=>{this.Q8i(Gc)}),Bd.a(fb,fb,Gc=>{this.P8i(Gc)}),Vb,null),ha=>new Db.a(264,0,ha,80),null)}P8i(D){D=Da.a.Lg(D.data);ba.ULS.sendTraceTag(525336847,0,10,`FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: ${zh.a.ue(D)}`)}Q8i(D){if(lc.a(D))-315732528!==D.Errors[0].MessageId&&ba.ULS.sendTraceTag(525336846,0,10,`FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : ${zh.a.ue(D.Errors)}`);else if(D&&D.Result){D=
D.Result;var ha=D.HasHeaderRow;ha=new K.AutofilterRange(D.TableRange.FirstRow+(ha?1:0)+1,D.TableRange.FirstColumn+1,D.TableRange.LastRow+1,D.TableRange.LastColumn+1,null,null,null,0,ha);this.e1b=D.TableRange.FirstColumn;(D=this.j0f(!1,!0,ha))||ba.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.qfg(D)}else ba.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")}rdk(D,
ha,fb){let Vb,Gc;Gc=null;Vb=!1;if(D.SheetName!==this.$.ea.na.sheetName)return{returnValue:!1,ogb:Vb,IPa:!1,sr:Gc};let zd;this.e1b=-1;if(fb){zd=this.fu(D);if(!zd||!zd.Aoa)return{returnValue:!1,ogb:Vb,IPa:!1,sr:Gc};var ae=this.fpa?(ae=$a.h(this.$).zd.$gf(zd))&&0<ae.size:(ae=$a.h(this.$).zd.ahf(zd))&&0<ae.count;this.qhe=zd;if(ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&ae)return--D.FirstColumn,--D.LastColumn,this.Zpd=this.IPa(D),
{returnValue:!0,ogb:Vb,IPa:!0,sr:Gc};zd.top+=1;zd.right=Gb.E(D).right-1}else zd=new K.AutofilterRange(D.FirstRow+1,D.FirstColumn+1,D.LastRow+1,D.LastColumn+1,null,null,null,0,!1);if(zd.top>zd.bottom||zd.left>zd.right)return{returnValue:!0,ogb:Vb,IPa:!1,sr:Gc};D=$a.h(this.$);var He=D.jd.width,hf=D.jd.height;ae=D.view.visibleArea;He=new qk.a(ae.x-He,ae.y-hf,ae.width+He,ae.height+hf);hf=D.Ni(zd);if(!ae||!hf||!D.Hrc(zd))return{returnValue:!1,ogb:Vb,IPa:!1,sr:Gc};He.contains(hf)||(Vb=!0);Gc=this.j0f(ha,
fb,zd);return{returnValue:!0,ogb:Vb,IPa:!1,sr:Gc}}qfg(D){D&&ba.ULS.sendTraceTag(25264348,0,50,`Retrieved ${D.length} rich value field contexts from block cache`);this.C2b=!0;(this.tS=D)&&0<this.tS.length&&(this.g1a=!0,this.yBc())}j0f(D,ha,fb){let Vb;Vb=null;const Gc=fb.clone();if(ha)for(let zd=fb.right,ae=0;zd>=fb.left;--zd){if(Gc.left=zd,Gc.right=zd,ha=this.Qcf(Gc,!0,fb.left)){Vb||(Vb=[]);Vb[ae]=ha;if(D)break;++ae}}else if(D=this.Qcf(Gc,!1))Vb=[],Vb[0]=D;return Vb}Qcf(D,ha,fb){fb=void 0===fb?0:fb;
var Vb=null;let Gc=[];if(this.fpa){var zd=$a.h(this.$).zd.$gf(D);if(!zd||0>=zd.size)return Vb;Gc=Array(zd.size);let He=0;zd.forEach(hf=>{let zf={};zf.Name=hf.Value;zf.RefersToDotFunction=hf.RefersToDotFunction;Gc[He]=zf;++He})}else{var ae=$a.h(this.$).zd.ahf(D);if(!ae||0>=ae.count)return Vb;Gc=Array(ae.count);Vb=0;for(zd of ae.values)ae={},ae.Name=zd,Gc[Vb]=ae,++Vb}zd="";ae=-1;0<D.top&&ha&&(D=new Sf.Range(D.top-1,D.left,D.top-1,D.left,!1,!1),null!=$a.h(this.$).Hd(D)&&null!=$a.h(this.$).Hd(D).originalText&&
(zd=$a.h(this.$).Hd(D).originalText),ae=D.left-fb);Vb={};Vb.ColumnName=zd;Vb.ColumnIndex=ae;Vb.FieldInfoDataList=Gc;return Vb}static Xwb(D){D&&na.AFrameworkApplication.tf.Gx(D.Qw)}}Object(da.a)(xb,"FieldInfoManager",qb.a,[379,5]);class kc extends xb{constructor(D,ha,fb,Vb){super(D,ha);this.V7a=null;this.sOf=()=>{this.JVd(this.sOf);if(this.sr&&this.sr.length&&this.contextMenuManager){var Gc=this.contextMenuManager.jpd("autoFilterRichFieldList"),zd=window.document.getElementById(this.V7a);Gc.K4(null,
zd,this,null,!0)}};this.IFg=fb;this.contextMenuManager=Vb}get aK(){return this.IFg}c8h(D,ha){this.V7a=ha;ba.ULS.sendTraceTag(537153825,0,100,`FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col (${D.FirstRow}, ${D.FirstColumn}, ${D.LastRow}, ${D.LastColumn})`);this.Lvg(D,null,!0,!1,!0)}}Object(da.a)(kc,"FilterInfoManager",xb,[386,379,5]);var Nc=a(967),md=a(1131);class Cd{}Cd.yMh="ewa-sharedUi-launchButton";Cd.BMh="ewa-sharedUi-launchButtonWithText";
Cd.zMh="ewa-sharedUi-launchButtonClick";Cd.CMh="ewa-sharedUi-launchButtonWithTextClick";Cd.AMh="ewa-sharedUi-launchButtonText";Object(da.a)(Cd,"CssClassNames",null,[]);a(526);var Td=a(299),we=a(75),Fe=a(265);class vf extends Ca.a{constructor(D,ha,fb,Vb,Gc,zd,ae,He,hf){super(document.createElement("div"));this.jAf=null;this.K4d=!1;this.Zd=this.RWb=this.zYa=null;this.WQ=()=>{this.raiseEvent("OnObjectButtonMouseOver")};this.VQ=()=>{this.raiseEvent("OnObjectButtonMouseOut")};this.f2j=()=>{this.Sye()};
this.mf=zf=>{this.raiseEvent(this.yPb,zf);this.Hgb();return!0};this.H6i=zf=>{100<wd.a(Hc.a.$b,this.jAf)&&this.Aud(new Sys.UI.Point(Math.round(zf.clientX),Math.round(zf.clientY)))};this.RQ=zf=>{we.g(zf.Ba,!1);return!1};this.K1=this.vg.nNa();this.set_visible(!1);this.nsc=Gc;this.yPb=zd;this.Bwc=D;this.nbc=ha;this.Zd=hf;this.nsc&&(this.zYa=W.a.instance.create(this.f2j,3E4,"OnObjectButton.ShyTimerFired",!1,!1));D&&this.domElement.classList.add(D);this.xwb=document.createElement("div");this.domElement.appendChild(this.xwb);
fb&&this.xwb.classList.add(fb);this.k$d(Vb);ae&&(this.RWb=document.createElement("div"),this.domElement.appendChild(this.RWb),this.RWb.classList.add(He),this.RWb.innerText=ae,this.domElement.style.padding="3px",Ue.a.instance.ta(ze.a.pointerDown,this.domElement,this.RQ));this.g5a=new Td.a(this.domElement,7);of.a.instance.ta(ze.a.click,this.domElement,this.mf);ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&Ue.a.instance.ta(ze.a.pointerDown,this.domElement,
this.RQ);D=zf=>{we.g(zf)};this.Xe.la("mouseup",D);this.Xe.la("click",D);this.Xe.la("dblclick",D)}O0(D){this.addHandler(this.yPb,D)}raa(D){this.get_events().removeHandler(this.yPb,D)}t_g(D){this.addHandler("OnObjectButtonMouseOver",D)}eCj(D){this.get_events().removeHandler("OnObjectButtonMouseOver",D)}s_g(D){this.addHandler("OnObjectButtonMouseOut",D)}dCj(D){this.get_events().removeHandler("OnObjectButtonMouseOut",D)}k$d(D){D&&this.Zd.Tj(this.xwb,D)}Ogk(D,ha,fb){var Vb=16,Gc=16;Vb=void 0===Vb?0:Vb;
Gc=void 0===Gc?0:Gc;this.Zd.gK(this.xwb);D?D.Bfa(ha,16,16,this.xwb,Vb,Gc,void 0,fb):ba.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")}Pgk(D,ha){D&&(this.RWb.innerText=D);this.domElement.title=ha}dispose(){this.get_isInitialized()&&(this.hide(),this.Xe.MH(),oc.a.Fe([this.K1,this.g5a]),of.a.instance.Aa(ze.a.click,this.domElement,this.mf),Ue.a.instance.Aa(ze.a.pointerDown,this.domElement,this.RQ),this.zYa&&this.zYa.dispose(),super.dispose())}hSb(){this.nbc&&
this.domElement.classList.remove(this.nbc);this.Bwc&&this.domElement.classList.add(this.Bwc)}Hgb(){this.Bwc&&this.domElement.classList.remove(this.Bwc);this.nbc&&this.domElement.classList.add(this.nbc);this.j8a()}j8a(){this.nsc&&(this.zYa.cancel(),this.Ing(),this.setOpacity(1));this.set_visible(!0)}Vo(D,ha,fb,Vb,Gc){Gc=void 0===Gc?!1:Gc;D=de.a(Vb).Mj(D);ha=de.a(Vb).Mj(ha);de.a(Vb).NGc(this.domElement);this.domElement.style.top=jd.HelperMethods.Qe(ha);this.domElement.style.left=this.domElement.style.right=
"";ha=D;Gc&&(ha=D-this.domElement.offsetWidth);Fe.c(this.domElement.style,fb,jd.HelperMethods.Qe(ha));this.set_visible(!0);this.setOpacity(1);this.nsc&&(this.K4d=!1,this.c5j(),this.zYa.Es())}hide(){this.hSb();this.set_visible(!1);this.nsc&&(this.Ing(),this.zYa.cancel())}Rid(){this.Xe.la("mouseover",this.WQ,!0);this.Xe.la("mouseout",this.VQ,!0)}c5j(){this.K1.Pk("mousemove")||this.K1.la("mousemove",this.H6i)}Ing(){this.K1.Pk("mousemove")&&this.K1.detach("mousemove")}Aud(D){if(this.domElement.parentNode){var ha=
Sys.UI.DomElement.getBounds(this.domElement);const fb=new Sys.UI.Point(Math.round(ha.x+ha.width),Math.round(ha.y+ha.height));ha=Math.abs(fb.x-D.x);D=Math.abs(fb.y-D.y);D=ha>D?ha:D;this.K4d?this.setOpacity(vf.Gch(D)):100>=D&&this.Sye()}}Sye(){this.K4d=!0;this.zYa.cancel()}setOpacity(D){cb.a.setOpacity(this.domElement,D);this.jAf=Hc.a.$b.ke}static Gch(D){return 100>=D?1:250<=D?0:.01*(100-(D-100)/150*100)}}Object(da.a)(vf,"OnObjectButton",Ca.a,[675,197,5]);var Jf=a(811);const lg=Cd.AMh;class ph extends za.a{constructor(D,
ha,fb,Vb,Gc,zd,ae,He,hf){hf=void 0===hf?"":hf;super();this.XAa=null;this.$nf=!1;this.Zd=this.Yvc=this.Zvc=null;this.buttons={};this.a1e={};this.$=D;this.svgIconProvider=ha;this.Y4i=fb;this.Zwd=Vb;this.Ywd=Gc;this.altText=zd;this.yPb=ae;this.Zd=He;this.buttonText=hf}get dy(){return de.a(this.$).lLa(Wa.a.Obj)}get fxb(){return Wa.a.Nbj}get buttonWidth(){return de.a(this.$).lLa(Wa.a.Pbj)}dispose(){this.jBh();this.$=null;super.dispose()}getButton(D,ha){return this.Nza(D,void 0===ha?!0:ha)}Nza(D,ha){const fb=
D.toString();fb in this.buttons||this.qrh(D,void 0===ha?!0:ha);return this.buttons[fb]}Vo(D,ha,fb,Vb,Gc,zd){Gc=void 0===Gc?!0:Gc;zd=void 0===zd?!1:zd;this.hide();if(this.$.ea.isNamedObjectViewMode&&yf.i(this.$.na)){var ae=$a.h(this.$).rV.domElement;const He=D+this.buttonWidth-ae.scrollWidth;ae=ha+this.buttonWidth-ae.scrollHeight;D=0<He?D-He:D;ha=0<ae?ha-ae:ha}this.Nza(Vb,Gc).Vo(D,ha,fb,this.$,zd)}hide(){const D=this.buttons;for(let ha in D)D[ha].hide()}Rid(D,ha){!this.$nf&&(ha=this.buttons[ha.toString()])&&
(this.Zvc=(fb,Vb)=>{D(Vb,!0)},ha.t_g(this.Zvc),this.Yvc=(fb,Vb)=>{D(Vb,!1)},ha.s_g(this.Yvc),this.$nf=!0,ha.Rid())}qrh(D,ha){this.XAa=String.format(this.Zwd===De.a.ehc?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',Ua.a.nm(this.Zwd),Ua.a.nm(this.Ywd),"{0}");var fb=String.format(this.XAa,Ua.a.nm(this.altText));ha=new vf(""===this.buttonText?Cd.yMh:Cd.BMh,""===this.buttonText?Cd.zMh:Cd.CMh,
De.a.hK,fb,ha,this.yPb,this.buttonText,lg,this.Zd);fb=(Vb,Gc)=>{this.Y4i(Gc,D)};ha.O0(fb);this.buttons[D.toString()]=ha;this.a1e[D.toString()]=fb;fb=$a.h(this.$).Xh(D);fb.domElement.insertBefore(ha.domElement,fb.domElement.firstChild)}jBh(){for(const D of Jf.a(this.buttons)){const ha=this.buttons[D];ha.raa(this.a1e[D]);oc.a.Ma(ha);delete this.buttons[D];this.Zvc&&ha.eCj(this.Zvc);this.Yvc&&ha.dCj(this.Yvc)}}domElement(D){return this.Nza(D).domElement}j8a(D){this.Nza(D).j8a()}mYb(D,ha,fb){fb=void 0===
fb?!0:fb;this.XAa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',Ua.a.nm(this.Zwd),Ua.a.nm(this.Ywd),"{0}");D=String.format(this.XAa,Ua.a.nm(D));this.Nza(ha,fb).k$d(D)}SZa(D,ha,fb){this.Nza(fb,!1).Pgk(D,ha)}Jvg(){var D=void 0===D?!1:D;this.XAa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",Ua.a.nm(this.Ywd),"{1}");const ha=String.format(this.XAa,void 0,Ua.a.nm(void 0));
this.Nza(void 0,D).k$d(ha)}vMc(D,ha,fb){this.Nza(fb,!1).Ogk(this.svgIconProvider,D,ha)}}Object(da.a)(ph,"OnObjectLaunchButton",za.a,[640,5]);class eh extends Gf.a{constructor(D,ha){super(D);this.ZKb=null;this.SAh=()=>{this.display()};this.hui=Math.max(1,ha)}dispose(){oc.a.Ma(this.ZKb);this.ZKb=null;super.dispose()}LYa(){oc.a.Ma(this.ZKb);this.ZKb=W.a.instance.create(this.SAh,this.hui,ed.a.YQi)}SYa(){oc.a.Ma(this.ZKb);this.hide()}}Object(da.a)(eh,"LoadingIndicatorBehavior",Gf.a,[643,5]);class $g extends eh{constructor(D,
ha,fb,Vb){super(D,ha);this.YKb=null;this.iIg=fb;this.wri=Vb;this.VVg()}dispose(){this.YKb=null;super.dispose()}display(){this.iIg(this.YKb)}hide(){this.wri(this.YKb)}VVg(){this.YKb=document.createElement("div");this.domElement.appendChild(this.YKb)}}Object(da.a)($g,"ShimmerLoadingIndicatorBehavior",eh,[]);var Ug=a(68);class Ch extends eh{constructor(D,ha,fb,Vb,Gc,zd){Vb=void 0===Vb?null:Vb;Gc=void 0===Gc?null:Gc;zd=void 0===zd?0:zd;super(D,ha);this.pab=this.oTa=null;this.pab=fb;this.goc=Vb||Dg.a.current.tq(102);
this.fCf=zd;this.Efd=Gc;this.UVg()}dispose(){this.oTa=null;super.dispose()}display(){sd.DOMElementExtensions.setVisible(this.oTa,!0)}hide(){sd.DOMElementExtensions.setVisible(this.oTa,!1)}UVg(){this.oTa=document.createElement("div");this.oTa.classList.add(Ug.a.gLh);const D=document.createElement("div");D.classList.add(Ug.a.hLh);this.Efd&&""!=this.Efd&&D.classList.add(this.Efd);const ha=0===this.fCf?"":Od.a.instance.ia(this.fCf),fb=String.format('<div class="'+Ug.a.iLh+'">{0}</div>',ha);this.goc?this.pab.Tj(D,
`<img src="${this.goc}" alt="${ha}" title="${ha}"/>`+fb):this.pab.Tj(D,fb);this.oTa.appendChild(D);this.domElement.appendChild(this.oTa)}}Object(da.a)(Ch,"SpinnerLoadingIndicatorBehavior",eh,[]);Object(je.b)(Fd.Hc)(D=>Io(function*(){const ha=yield je.a.resolve(Fd.Ab,{Ja:D.Ja});return new Yh(ha)}));class Yh{constructor(D){this.pab=D}Aed(D,ha,fb){return new Nc.a(D,ha,fb)}idc(D,ha,fb,Vb,Gc,zd,ae,He,hf,zf){return new md.a(D,ha,fb,Vb,Gc,zd,ae,He,hf,zf)}Vyb(D,ha,fb,Vb,Gc){return new Ch(D,ha,this.pab,fb,
Vb,void 0===Gc?0:Gc)}Frd(D){return D.ga.Da(238)||new xg(D)}Lyb(D,ha,fb,Vb,Gc,zd,ae,He){return new ph(D,ha,fb,Vb,Gc,zd,ae,this.pab,void 0===He?"":He)}RSe(D,ha){return new xb(D,ha)}lqh(D,ha,fb,Vb){return new kc(D,ha,fb,Vb)}TRe(D,ha,fb,Vb){return new uk(D,ha,fb,Vb)}}Object(da.a)(Yh,"SharedUIControlsFactory",null,[621]);let Dh=class{constructor(D,ha){this.f8c=this.GHe=this.g8c=0;this.FHe=!1;this.proactiveSuggestionCard=null;this.v6a=this.wQe=!1;this.sessionCount=this.autoAdjustColumnWidthSettings=0;this.bOd=
fb=>{zh.a.ph(fb.Errors)?ba.ULS.sendTraceTag(508641556,0,10,`AutoAdjustColumnWidth.onReadRoamingStringSuccess encountered an error. Errors: ${zh.a.ue(fb.Errors)}.`):(fb.Result&&(this.autoAdjustColumnWidthSettings=parseInt(fb.Result,10),this.v6a=0!==(this.autoAdjustColumnWidthSettings&3),this.sessionCount=(this.autoAdjustColumnWidthSettings&65280)>>8),this.FHe||0!==(this.autoAdjustColumnWidthSettings&2)||(0===this.sessionCount&&(this.v6a=!1),this.Yti()))};this.cOd=fb=>{fb=Da.a.Lg(fb.data);ba.ULS.sendTraceTag(508641555,
0,10,`AutoAdjustColumnWidth.onReadWriteRoamingStringFailure: Encountered errors while reading/writing roaming setting. Errors: ${zh.a.ue(fb)}.`)};this.SOd=fb=>{zh.a.ph(fb.Errors)?ba.ULS.sendTraceTag(508641554,0,10,`AutoAdjustColumnWidth.onWriteRoamingStringSuccess: encountered an error. Errors: ${zh.a.ue(fb.Errors)}`):fb.Result||ba.ULS.sendTraceTag(508641553,0,10,"AutoAdjustColumnWidth.onWriteRoamingStringSuccess failed to write to roaming service.")};this.Tcj=fb=>{if(zh.a.ph(fb.Errors))ba.ULS.sendTraceTag(508641552,
0,10,`AutoAdjustColumnWidth.onReadRoamingStringSuccess encountered an error. Errors: ${zh.a.ue(fb.Errors)}.`);else{var Vb=0;fb.Result&&(Vb=parseInt(fb.Result,10));Vb=Vb&-4|this.autoAdjustColumnWidthSettings&3;this.Mzg(Vb)}};this.UMf=()=>{zb.a("AutoAdjustColumnWidthKeepOn");0===(this.autoAdjustColumnWidthSettings&1)&&(this.autoAdjustColumnWidthSettings|=1,this.M2f());this.v6a=!0;this.proactiveSuggestionCard.hide()};this.t5i=()=>{this.Zkh();this.proactiveSuggestionCard.hide()};this.Nhj=()=>{zb.a("AutoAdjustColumnWidthHelp");
let fb=new bb.a(-859308420,eb.a.Bd,this.$.se,9,null);this.$.Ha.Ad(fb,{[eb.a.Th]:"HelpID=151880",["InputMethod"]:eb.a.Bd,["ShouldCanvasTakeFocus"]:!0,[eb.a.We]:Af.a.xN,[Af.a.Eia]:!0})};this.c$i=()=>{const fb={};fb[Af.a.SH]="AutoAdjustColumnWidth";this.$.Me(802602464,eb.a.Bd,8,fb)};this.fgj=()=>{zb.a("AutoAdjustColumnWidthTurnedOff");this.autoAdjustColumnWidthSettings|=2;this.M2f();this.v6a=!0;this.proactiveSuggestionCard.hide()};this.$=D;this.proactiveSuggestionCard=ha;this.GHe=ib.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.AutoAdjustColumnConfirmThreshold",
5);this.f8c=ib.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.AutoAdjustColumnConfirmSessionCycle",5);this.FHe=0===this.f8c;this.initialize()}dispose(){this.proactiveSuggestionCard&&this.proactiveSuggestionCard.dispose();this.$=null}initialize(){ba.ULS.shipAssertTag(508641557,0,$b.a.Xoa(),"AutoAdjustColumnWidth feature is off");Yj.y(this.$.qa.ua,5,this.bOd,this.cOd,null,null)}Mzg(D){Yj.F(this.$.qa.ua,5,D.toString(),this.SOd,this.cOd,null,null)}Yti(){if(2!==(this.autoAdjustColumnWidthSettings&
2)){var D=this.sessionCount+1;D>=this.f8c&&(D=0);this.Mzg(this.autoAdjustColumnWidthSettings&-65281|D<<8)}}M2f(){Yj.y(this.$.qa.ua,5,this.Tcj,this.cOd,null,null)}Yyd(){return 2!==(this.autoAdjustColumnWidthSettings&2)}sLf(D){if(0===this.g8c){const ha=[];ha.push(rd.a.Yg("Command",D,2));zb.a("AutoAdjustedColumnWidth",void 0,void 0,ha)}++this.g8c;ba.ULS.shipAssertTag(508641551,0,0===(this.autoAdjustColumnWidthSettings&2),"AutoAdjustedColumns when AutoAdjustColumnWidthSettings is Off");!this.v6a&&this.g8c>=
this.GHe&&this.Ykh()}Ykh(){if(null!=this.proactiveSuggestionCard){zb.a("AutoAdjustColumnWidthDialog");var D=Od.a.instance.Ia(858),ha=Od.a.instance.Ia(859),fb=Od.a.instance.Ia(860),Vb=Od.a.instance.Ia(861),Gc=Od.a.instance.Ia(863);this.proactiveSuggestionCard.show($a.h(this.$).ha.ra.lf,D,ha,fb,Vb,this.UMf,this.t5i,this.glc(),void 0,void 0,"WrapText",void 0,void 0,void 0,void 0,!1,!1,Gc,this.c$i);this.wQe?this.v6a=!0:this.wQe=!0}}glc(){return[{key:"learnMessage",text:Od.a.instance.Ia(862),onClick:this.Nhj}]}Zkh(){const D=
Od.a.instance.Ia(864),ha=Od.a.instance.Ia(865),fb=Od.a.instance.Ia(866),Vb=Od.a.instance.Ia(861);this.proactiveSuggestionCard.show($a.h(this.$).ha.ra.lf,D,ha,fb,Vb,this.UMf,this.fgj,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,!1,!1,void 0,void 0)}};Dh=Object(Xb.a)([Object(je.d)(Fd.j),Object(Xb.b)(0,Object(Fd.W)()),Object(Xb.b)(1,Object(Fd.pc)())],Dh);Object(da.a)(Dh,"AutoAdjustColumnsManager",null,[5,620]);Object(je.b)(Fd.fc,{yt:"singleton"})(()=>{Fi();const D=Ja.a.instance.resolve("Common.App.PenMinutesManager.IPenMinutesManager");
D.ygg();return D});var Ph;let ej=Ph=class{constructor(){this.y4a=null;this.nOd=ha=>{ba.ULS.sendTraceTag(508421248,0,50,`DMS call to get SDX list succeeds with status ${ha.data.httpStatus}.`);this.bFb(ha.data.Tf)};this.mOd=ha=>{200<=ha.data.httpStatus&&300>ha.data.httpStatus?(ba.ULS.sendTraceTag(508421219,0,50,`DMS call to get SDX list succeeds with status ${ha.data.httpStatus}.`),this.bFb(ha.data.Tf)):ba.ULS.sendTraceTag(508421218,0,15,`DMS call to get SDX list fails with status ${ha.data.httpStatus}.`)};
const D=ib.EwaSettings.getStringFeatureGate("Microsoft.Office.ExcelOnline.SdxManifestPrefetchAssetIds","");""!==D&&(this.y4a=D.split(";"),this.$Qd())}$Qd(){const D=Cg.a.create().toString();ba.ULS.sendTraceTag(508421250,0,50,`Start calling DMS to retrieve the list of SDXs to prefetch (dmsActivityId = ${D}).`);na.AFrameworkApplication.tf.Ho(Dg.a.current.FI.SdxDmsUrl,2,Ph.Sed(),Ph.Ted(D),!1,4,this.nOd,this.mOd,null)}bFb(D){try{const ha=wb.b(D).Packages;for(const fb of ha)if(this.y4a.includes(fb.AssetId)){const Vb=
String.format(Dg.a.current.FI.SdxCdnUrl,fb.AssetId,fb.FFN,fb.Version,"en-us");Dg.a.MPb(Vb,!1,null,!0)}window.prefetchedDmsResponse=D}catch(ha){ba.ULS.sendTraceTag(508421249,0,15,`Failed to parse DMS response: "${D.substring(0,40)}...".`)}}static Sed(){const D=Object(pb.a)(String,na.AFrameworkApplication.Yd.AudienceGroup)||"";return wb.c({["Context"]:{["Hosts"]:["Workbook"],["ReactNativeVersion"]:"0.0.0.0",["Channel"]:"DevMain",["Capabilities"]:[{["Name"]:"addincommands",["Version"]:"1.1"},{["Name"]:"bindingevents",
["Version"]:"1.1"},{["Name"]:"biplatvisualrichapi",["Version"]:"1.8"},{["Name"]:"customfunctions",["Version"]:"1.9"},{["Name"]:"customfunctionsruntime",["Version"]:"1.2"},{["Name"]:"compressedfile",["Version"]:"1.1"},{["Name"]:"DataFromPicture",["Version"]:"1.1"},{["Name"]:"pivotfilters",["Version"]:"1.2"},{["Name"]:"pdffile",["Version"]:"1.1"},{["Name"]:"dialogapi",["Version"]:"1.2"},{["Name"]:"dialogorigin",["Version"]:"1.2"},{["Name"]:"documentevents",["Version"]:"1.1"},{["Name"]:"excelapi",["Version"]:"1.12"},
{["Name"]:"excelapionline",["Version"]:"1.1"},{["Name"]:"excelapiundo",["Version"]:"1.4"},{["Name"]:"firstpartyauthentication",["Version"]:"1.1"},{["Name"]:"identityapi",["Version"]:"1.3"},{["Name"]:"matrixbindings",["Version"]:"1.1"},{["Name"]:"matrixcoercion",["Version"]:"1.1"},{["Name"]:"numberformatting",["Version"]:"1.2"},{["Name"]:"pivot",["Version"]:"1.5"},{["Name"]:"richapiruntime",["Version"]:"1.2"},{["Name"]:"richapiruntimeflag",["Version"]:"1.2"},{["Name"]:"selection",["Version"]:"1.1"},
{["Name"]:"settings",["Version"]:"1.1"},{["Name"]:"sharedruntime",["Version"]:"1.1"},{["Name"]:"tablebindings",["Version"]:"1.1"},{["Name"]:"tablecoercion",["Version"]:"1.1"},{["Name"]:"tablestyle",["Version"]:"1.1"},{["Name"]:"textbindings",["Version"]:"1.1"},{["Name"]:"textcoercion",["Version"]:"1.1"},{["Name"]:"file",["Version"]:"1.1"},{["Name"]:"webauth",["Version"]:"1.1"}],["Ring"]:"Automation"===D?"Dogfood":D,["Platform"]:"Web",["Locales"]:[na.AFrameworkApplication.uiCulture],["ClientId"]:na.AFrameworkApplication.da.Sa("LoggableUserId")},
["SyncId"]:0})}static Ted(D){return{["Content-Type"]:"application/json",["DMSActivityId"]:D}}};ej=Ph=Object(Xb.a)([Object(je.d)(Fd.Cc)],ej);Object(da.a)(ej,"SdxManifestPrefetcher",null,[]);var Ej=a(790),Bk=a(219),xk=a(210);class yk{constructor(){this.RRg=new Ub.a;this.SRg=new Ub.a}get kZa(){return this.RRg}get iqg(){return this.SRg}get VL(){return this.q9j}zXg(D,ha){this.kZa.add(D);this.iqg.add(ha)}AXg(D,ha){this.q9j={wJd:D,nId:ha}}}Object(da.a)(yk,"ThemeInfoCache",null,[]);var Ck=a(49);let vk=class{constructor(D){this.kZa=
this.GO=null;this.vqc=!1;this.E7d=null;this.Hvc=new Set;this.clb=this.DWc=!1;this.EBb=0;this.U9i=ha=>{this.vqc=!1;if(!ha||lc.a(ha))ba.ULS.sendTraceTag(556656004,0,15,`ThemesManager: The obtained result has errors, [Error: ${ha?zh.a.ue(ha.Errors):"(no result)"}]`),this.I$f();else if(this.EBb=0,ha=ha.Result){this.Zn&&null!==this.GO&&this.lkh(ha);this.GO=new yk;if(this.eG){this.kZa=ha.ThemeColors;this.E7d=[];for(var fb=0;10>fb;fb++)this.E7d.push(Ej.a.$Pa(Bk.a.XH(this.kZa[fb])));for(fb=0;6>fb;fb++)for(let Vb=
0;10>Vb;Vb++){const Gc=xk.a.Rha(xk.a.fJ(this.kZa[10*fb+Vb])),zd=Ej.a.gbi(fb,Vb,this.E7d[Vb],this.kZa[Vb]);this.GO.zXg(Gc,zd)}}this.Zn&&(this.GO.AXg(ha.MinorFont,ha.MajorFont),this.clb=!1);ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",!1)&&ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewOfficeDefaultThemeSurvey",!1)&&"Aptos Narrow"===ha.MinorFont&&(ha=Ck.PageLoadTrackingInfo.instance.foa(new Date),27E4>ha?window.setTimeout(()=>{this.$.Me(-569754003,
-1,0,null)},27E4-ha):this.$.Me(-569754003,-1,0,null));this.DWc=!1;this.Bha()}else ba.ULS.sendTraceTag(556656003,0,10,"ThemesManager: The obtained ThemeInfo is null")};this.T9i=()=>{this.vqc=!1;this.I$f()};this.I$f=()=>{3>this.EBb?(this.EBb++,ba.ULS.sendTraceTag(509669709,0,50,`ThemesManager::retryFetchThemeInfo - Retry fetchThemeInfo API count = ${this.EBb}`),this.DBb(null,!0)):(this.EBb=0,ba.ULS.sendTraceTag(509669708,0,15,"ThemesManager::retryFetchThemeInfo - Maximum retry count for fetchThemeInfo API has reached."))};
this.Gyc=()=>{this.GO&&(ba.ULS.sendTraceTag(537150473,0,50,"ThemesManager: OnReloadCache"),this.Zn?this.clb=!0:this.GO=null,this.DBb(null,!0))};this.ff=(ha,fb)=>{this.GO&&(ba.ULS.sendTraceTag(537150472,0,50,"ThemesManager: OnSessionIdChanged"),fb.nI&&(this.DWc=!0))};this.uC=()=>{this.Hvc.clear()};this.$=D;this.$.ea.BM(this.Gyc);this.$.ea.Zl(this.ff);this.$.Ha.I3a(this.uC);this.eG=ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.Zn=ib.EwaSettings.Zn()}get dlb(){return!this.GO||
this.clb?null:this.GO.kZa}get hqg(){return!this.GO||this.clb?null:this.GO.iqg}get VL(){return!this.GO||this.clb?null:this.GO.VL}get dyf(){return this.DWc}DBb(D,ha){if(this.$.isEditMode||(void 0===ha?0:ha))if(!this.GO||this.dyf||this.clb)if(D&&""!==D&&this.Hvc.add(D),!this.vqc){this.vqc=!0;D=this.$.qa.ua;ha=this.U9i;var fb=this.T9i;const Vb=D.Pa(1,null);be.g(D,"GetThemeInfo",Vb,ha,fb,null,null,4)}}getThemeColor(D){let ha,fb=-1;ha=-1;if(!this.dlb)return ba.ULS.sendTraceTag(537150475,0,10,"ThemesManager: ThemeColorsList is null"),
{returnValue:!1,themeIndex:-1,eGa:ha};for(let Vb=0;Vb<this.dlb.count;Vb++)if(D===this.dlb.ma(Vb)){fb=Vb;break}if(-1!==fb)return ha=Math.floor(fb/10),{returnValue:!0,themeIndex:fb%10,eGa:ha};ba.ULS.sendTraceTag(537150474,0,10,"ThemesManager: Couldn't find theme color in cache.");return{returnValue:!1,themeIndex:-1,eGa:ha}}Bha(){for(let D of this.Hvc)this.$.frame.Lz(D);this.Hvc.clear()}lkh(D){const ha=this.GO.VL.nId;this.GO.VL.wJd===D.MinorFont&&ha===D.MajorFont||ba.ULS.sendTraceTag(512230155,0,50,
"ThemesManager.compareThemeInfoCache: Theme Fonts are updated")}};vk=Object(Xb.a)([Object(je.d)(Fd.Yc),Object(Xb.b)(0,Object(Fd.W)())],vk);Object(da.a)(vk,"ThemesManager",null,[579]);Type.registerNamespace("Common.App.InProductMessaging");cc.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");gc.main();(()=>{ec.a.Ga(()=>{ec.a.Ga(Fa.la)})})();(()=>{ec.a.Ga(()=>{ec.a.Ga(Na.la)})})();ec.a.Ga(Ce.la);(()=>{ec.a.Ga(D=>{ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2NetworkConnectionStateManager",
!1)||ac.la(D)})})();(()=>{ec.a.Ga(D=>{ib.EwaSettings.NBd()||li.la(D)})})();bd.a.Dk(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}");
Object(Ge.a)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")||ec.a.Ga(se.la);(()=>{ec.a.Ga(D=>{kf.la(D);Q.la(D)})})();(()=>{ec.a.Ga(D=>{tf.la(D);Yb.la(D)})})();(()=>{ec.a.Ga(D=>{Vg.la(D)})})();(()=>{ec.a.Ga(D=>{ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2Services15",!1)||Nh.la(D)})})();Type.registerNamespace("Common.App.Rename");Sb.a.instance.Tk(new Ff,7);(()=>{ec.a.Ga(D=>{Vd.la(D)})})();(()=>{ec.a.Ga(D=>{Oe.la(D)})})();bd.a.Dk(".ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{background:linear-gradient(120deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{background:linear-gradient(300deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{background:linear-gradient(30deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{background:linear-gradient(210deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:start:decrement,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:end:increment,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-thumb{width:calc(16px/var(--zoom-level,1));height:calc(16px/var(--zoom-level,1));border:solid calc(1px/var(--zoom-level,1)) #363636;background-color:#b1b1b1}@media screen and (-ms-high-contrast:active){.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar{background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-thumb{background-color:WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-corner{background-color:Window}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(120deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(300deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(30deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(210deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}}");
(()=>{ec.a.Ga(D=>{D.ga.Qa(203,new ff)})})();Type.registerNamespace("Common.App.LivePersonaUtils");ih.main();Type.registerNamespace("Common.App.SaveStatus");Sb.a.instance.Tk(new Pi);ec.a.Ga(Jg.la);ec.a.Ga(F.la);(()=>{ec.a.Ga(D=>{ib.EwaSettings.ZD()||gj.la(D)})})();bd.a.Dk('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}');
ec.a.Ga(Rh.la);Type.registerNamespace("CAUI");rh.main();uf.a.Xn.Qa(141,new qi);ec.a.Ga(cj.la);Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=Gi.a;Type.registerNamespace("Common.App.WopiIdentity");Re.main();Type.registerNamespace("Common.App.HostNotification");tg.main();Type.registerNamespace("Common.App.FloatPane");oi.main();Type.registerNamespace("Common.App.DisplayEnvironmentName");P.main();fc.main();ec.a.Ga(Mc.la);(()=>{ec.a.Ga(D=>
{D.ga.qd(29,()=>{ig.la(D)})})})();ec.a.Ga(Fh.la);String(H);String(M);String(R);String(O);String(L);String(S);String(T);String(I);String(V);String(la);String(Z);window.___1689695406702_closurehack=H;window.___1689695406702_closurehack=M;window.___1689695406702_closurehack=R;window.___1689695406702_closurehack=O;window.___1689695406702_closurehack=L;window.___1689695406702_closurehack=S;window.___1689695406702_closurehack=T;window.___1689695406702_closurehack=I;window.___1689695406702_closurehack=V;
window.___1689695406702_closurehack=la;window.___1689695406702_closurehack=Z},745:function(w,C,a){a.d(C,"a",function(){return R});w=a(0);var b=a(2),c=a(14),h=a(96),k=a(234),d=a(13),f=a(117),u=a(189),r=a(5),t=a(92);C=a(249);var v=a(1117),x=a(18),m=a(6),l=a(334),n=a(56),z=a(12),y=a(75),B=a(16),G=a(19),E=a(97),J=a(964),I=a(1);class R extends C.a{constructor(X,H){super(document.createElement("div"));this.oBf=this.nEe=this.Gye=this.ubc=this.kga=this.Kba=this.lS=this.OB=null;this.HAa=this.GY=this.gu=this.hideCloseButton=
!1;this.b5i=M=>{this.pG(M)};this.h5i=M=>{13===M.keyCode&&this.pG(M)};this.LLd=M=>{this.to(M.Gd);return!0};this.RLd=M=>{this.sZ(M.Gd);return!0};this.fyc=M=>{this.Mqa(M.Gd?M.Gd:0);return!0};this.c5i=M=>{this.pG(M.Ba);return!0};this.ICg=M=>{M=void 0===M?null:M;this.to(M.inputMethod?M.inputMethod:0);return!0};this.JCg=M=>{M=void 0===M?null:M;this.sZ(M.inputMethod?M.inputMethod:0);return!0};this.x5=X;this.cu=H;this.x8c=H.p5a.toString();this.title=H.title;this.message=H.message;this.set_visibilityMode(1)}get gbh(){return this.cu.p5a}get businessBar(){return this.x5}get actionButton(){return this.cu?
this.cu.actionButton:""}get sLa(){return this.cu?this.cu.sLa:""}get linkText(){return this.cu?this.cu.link:""}get Bn(){return this.cu?this.cu.Bn:""}get alt(){return this.cu?this.cu.alt:""}qsa(X){this.cu.businessBarType=X}dispose(){h.a.Fe([this.ubc,this.lS,this.Kba]);this.gu&&this.lS&&(k.a.instance.Aa(d.a.click,this.lS.domElement,this.LLd),f.KeyInputManager.instance.uB(this.domElement,this.Gye));this.GY&&this.Kba&&(k.a.instance.Aa(d.a.click,this.Kba.domElement,this.RLd),f.KeyInputManager.instance.uB(this.domElement,
this.nEe));this.HAa&&this.kga&&(k.a.instance.Aa(d.a.click,this.kga,this.fyc),f.KeyInputManager.instance.uB(this.domElement,this.oBf));this.kga=this.OB=this.x5=this.Kba=this.lS=null;super.dispose()}update(){}Ngk(){this.MTe(!0)}qSe(){this.MTe(!1)}dth(){const X=this.businessBar.$.Sd.fi("DOMUpdate","ReactBusinessBar");X.start();this.message=E.a.mh(this.message);this.title=E.a.mh(this.title);u.UISurfaces.lrd().then(H=>{H.initializeMessageBarInStore();let M=Object(b.a)(new J.a,{messageTitle:this.title,
message:this.message,isMultiline:!1,messageBarType:this.cu.businessBarType,dismissButtonAriaLabel:B.a.instance.ia(10)});this.hideCloseButton||(M.onDismiss=this.c5i);this.HAa&&(M.linkProps={["type"]:"AppLinkProps",["text"]:this.linkText,["onExecute"]:this.fyc});this.gu&&(M.firstActionButtonProps={["type"]:"AppButtonProps",["label"]:this.actionButton,["onExecute"]:this.ICg});this.GY&&(M.secondActionButtonProps={["type"]:"AppButtonProps",["label"]:this.sLa,["onExecute"]:this.JCg});this.cu.iconName&&
(M.messageBarIconProps={["iconName"]:this.cu.iconName});H.createNewMessageBarWithCallback(this.domElement,M,()=>{if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:8064129_businessbarv8fix")&&!r.AFrameworkApplication.da.pa("Fluent2StyleIsEnabled")){let O="1px solid ";switch(this.cu.businessBarType){case 1:case 2:case 3:O+="#F1707B";break;case 4:O+="#92C353";break;case 5:O+="#FCE100";break;case 0:O+="#C8C6C4";break;default:O+="#C8C6C4"}this.domElement.style.border=O}X.stop();c.ULS.sendTraceTag(509657951,
0,50,`React Business Bar created for ${this.cu.aza} in: ${X.Te} milliSeconds.`)});return null},H=>{c.ULS.sendTraceTag(524075914,0,10,`React BusinessBar for ${this.cu.aza} could not be initialized. ${H}`);return null});if(r.AFrameworkApplication.da.pa("Fluent2StyleIsEnabled"))this.domElement.classList.add("VNextBusinessBarEntry"),this.domElement.classList.add("WACBusinessBarEntry");else if(!I.EwaSettings.isChangeGateEnabled("OfficeVSO:8064129_businessbarv8fix")){let H="1px solid ";switch(this.cu.businessBarType){case 1:case 2:case 3:H+=
"#F1707B";break;case 4:H+="#92C353";break;case 5:H+="#FCE100";break;case 0:H+="#C8C6C4";break;default:H+="#C8C6C4"}this.domElement.style.border=H}this.domElement.classList.add("ReactBusinessBarEntry");this.businessBar.domElement.appendChild(this.domElement)}nsh(X){const H=this.businessBar.$.Sd.fi("DOMUpdate","LegacyBusinessBar");H.start();X||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var M=this.businessBar.$.Pd;X=M+"ewaBusinessBarEntryBody"+this.x8c;const O=
M+"ewaBusinessBarEntryTitle"+this.x8c;var L=M+"ewaBusinessBarEntryIcon"+this.x8c;this.domElement.className=v.a.SHh;z.DOMElementExtensions.gK(this.domElement);M=document.createElement("div");M.className=v.a.THh;M.id=X;var S=document.createElement("div");S.className=v.a.RHh;var T=document.createElement("a");T.className=v.a.ZHh;T.title=this.alt;var V=document.createElement("span");V.classList.add(x.a.sbc);V.classList.add(v.a.VHh);V.id=L;this.Bn.length&&(L=document.createElement("img"),L.classList.add(this.Bn),
L.src=n.a.Ci(0),V.appendChild(L));T.appendChild(V);S.appendChild(T);T=document.createElement("span");T.classList.add(v.a.YHh);T.id=O;T.innerText=E.a.mh(this.title);S.appendChild(T);T=document.createElement("span");T.classList.add(v.a.XHh);T.id="message";T.innerText=E.a.mh(this.message);S.appendChild(T);T=document.createElement("a");T.id="link";T.href="#";T.className=v.a.WHh;T.innerText=E.a.mh(this.linkText);S.appendChild(T);T=document.createElement("span");T.classList.add(v.a.o1e);V=document.createElement("button");
V.type="button";V.id="action";V.className=v.a.n1e;V.innerText=E.a.mh(this.actionButton);T.appendChild(V);S.appendChild(T);T=document.createElement("span");T.classList.add(v.a.o1e);V=document.createElement("button");V.type="button";V.id="altAction";V.className=v.a.n1e;V.innerText=E.a.mh(this.sLa);T.appendChild(V);S.appendChild(T);M.appendChild(S);S=document.createElement("a");S.className=v.a.UHh;S.tabIndex=0;S.setAttribute("role","button");T=document.createElement("span");T.id="close";T.classList.add(x.a.hK);
V=document.createElement("img");V.classList.add(x.a.ykd);V.src=n.a.Ci(13);V.alt=B.a.instance.ia(793);V.title=B.a.instance.ia(793);V.setAttribute("role","button");T.appendChild(V);S.appendChild(T);M.appendChild(S);this.domElement.appendChild(M);z.DOMElementExtensions.Gz(this.domElement,m.a.tla,O,X);this.kga=$get("link",this.domElement);z.DOMElementExtensions.setVisible(this.kga,this.HAa);this.HAa&&(k.a.instance.ta(d.a.click,this.kga,this.fyc),this.oBf=f.KeyInputManager.instance.zx(this.kga,this.fyc,
t.a.xk,t.a.l5));this.lS=new l.a(z.DOMElementExtensions.getElementById(this.domElement,"action"));this.lS.isVisible=this.gu;this.Kba=new l.a(z.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.Kba.isVisible=this.GY;this.gu&&(k.a.instance.ta(d.a.click,this.lS.domElement,this.LLd),this.Gye=f.KeyInputManager.instance.zx(this.lS.domElement,this.LLd,t.a.xk,t.a.l5),this.GY&&(k.a.instance.ta(d.a.click,this.Kba.domElement,this.RLd),this.nEe=f.KeyInputManager.instance.zx(this.lS.domElement,
this.RLd,t.a.xk,t.a.l5)));this.OB=$get("close",this.domElement);this.ubc=this.vg.kg(this.OB);this.ubc.la("click",this.b5i);this.ubc.la("keydown",this.h5i);z.DOMElementExtensions.setVisible(this.OB,!this.hideCloseButton);H.stop();c.ULS.sendTraceTag(508614337,0,10,`Legacy Business Bar created for ${this.cu.aza} in: ${H.Te} milliSeconds.`)}MTe(X){I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.dth():this.nsh(X)}to(){c.ULS.sendTraceTag(21517968,0,50,`BusinessBar [${this.cu.hash}]: BusinessBarEntry.OnActionClick() for EntryName ${this.cu.aza}`);
G.h(this.businessBar.$).Kt(!0)}sZ(){c.ULS.sendTraceTag(537170257,0,50,`BusinessBar [${this.cu.hash}]: BusinessBarEntry.OnAltActionClick() for EntryName ${this.cu.aza}`);G.h(this.businessBar.$).Kt(!0)}Mqa(){c.ULS.sendTraceTag(537170256,0,50,`BusinessBar [${this.cu.hash}]: BusinessBarEntry.OnLinkClick() for EntryName ${this.cu.aza}`);G.h(this.businessBar.$).Kt(!0)}pG(X){c.ULS.sendTraceTag(21517971,0,50,`BusinessBar [${this.cu.hash}]: BusinessBarEntry.OnCloseClick() for EntryName ${this.cu.aza}`);this.set_visible(!1);
this.businessBar.removeEntry(this.gbh);y.g(X)}lN(){return I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:this.lS.domElement}}Object(w.a)(R,"BusinessBarEntry",C.a,[])},803:function(w,C,a){a.r(C);w=a(0);var b=a(14),c=a(96),h=a(237),k=a(5),d=a(31),f=a(842),u=a(144),r=a(84),t=a(39),v=a(18),x=a(6),m=a(180),l=a(1194),n=a(994),z=a(175),y=a(567),B=a(359),G=a(59);const E=(ua,$a,Va,hb,qb,Nb,yb,ja,Ka,Pb,rc)=>{rc=ua.Pa(1,void 0===
rc?null:rc);rc.selectedRanges=$a;rc.isChangeObject=Va;rc.isFloodgateEnabled=hb;rc.isStarterData=qb;rc.starterDataDomainId=Nb;return G.g(ua,"GetDataSelectorPaneData",rc,yb,ja,Ka,Pb,4)};var J=a(79),I=a(754),R=a(926);class X{}X.Tsi="EnrichmentContentFrame";X.width=320;Object(w.a)(X,"EnrichmentConstants",null,[]);class H{constructor(ua){this.messageType=0;this.messageType=ua}}Object(w.a)(H,"EnrichmentResponseMessage",null,[]);class M extends H{constructor(ua,$a){super(ua);this.messageContent=null;this.messageContent=
$a}}Object(w.a)(M,"EnrichmentResponseMessageWithContent",H,[]);class O extends M{constructor(ua,$a,Va){super(ua,$a);this.telemetryJson=null;this.telemetryJson=Va}}Object(w.a)(O,"EnrichmentResponseMessageWithContentAndTelemetryData",M,[]);var L=a(277),S=a(13),T=a(102),V=a(47),la=a(92),Z=a(117),da=a(42),ba=a(64),na=a(32),Y=a(116),Ga=a(733),ma=a(27);class fa{constructor(ua,$a,Va,hb,qb){this.xy=this.rn=this.wle=this.ule=this.Cy=this.Kx=null;this.Rz=!1;this.Co=ua;this.Hg=$a;this.eca=Va;this.Re=hb;this.Na=
qb;this.Yua=Z.KeyInputManager.fs(la.a.SGa,0)}get UUb(){return!0}get SAb(){return k.AFrameworkApplication.da.Sa("EnrichmentPaneUrl")}dispose(){this.UUb&&this.xy&&(this.Co.Aa(S.a.click,this.xy,Object(J.a)(this,this.xp,"onClosePaneClick")),this.Hg.Aa(S.a.Vf,this.xy,Object(J.a)(this,this.sQf,"onKeyHide")));this.xy=null;this.Cy&&(this.yfk(),this.Cy.parentNode.removeChild(this.Cy),this.Cy=null);this.Re.am("EnrichmentPaneId").tv(this.Yua)}show(ua,$a,Va){this.Kx=ua;this.Rz||(this.rn=this.Zcc(),this.NYd.appendChild(this.rn),
this.fxj(),this.Na.ae(ma.a.qOe,Y.a.frame,Object(J.a)(this,this.dni,"handleEscapeKeyAction")),this.R1d(),this.Rz=!0);this.Cy.src=this.SAb&&this.SAb.length?this.SAb+"?culture="+$a.market+"&appName="+$a.applicationName+"&themeId="+$a.themeId+"&featuresBitMask="+$a.featuresBitMask:fa.JJf;this.ule=$a;this.wle=Va;this.nkb()}sMc(ua,$a){ua=new O(2,ua,$a);this.FAc(ua)}R1d(){const ua=this.Re.am("EnrichmentPaneId");ua.parent=L.AFrame.ceb;this.Co.n7b("EnrichmentPaneId",this.rn);ua.bindAction(this.Yua,ma.a.qOe)}zfg(){if(this.Cy){T.FocusManager.yta(this.Cy.contentWindow);
const ua=new O(4,null,null);this.FAc(ua)}}xp(){this.wbc();return!0}sQf(ua){ua=ua.Ba.keyCode;return ua===Sys.UI.Key.enter||ua===Sys.UI.Key.space?(this.wbc(),!0):!1}wbc(){this.hide();if(this.Kx)this.Kx.onPaneClosed()}Zcc(){const ua=I.a("div","EnrichmentPaneId","EnrichmentPane");this.UUb&&ua.appendChild(this.Oqh());this.Nwi(ua);return ua}Oqh(){const ua=I.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),$a=I.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");$a.innerText=
CommonUIStrings.l_EnrichmentPaneTitle;$a.title=CommonUIStrings.l_EnrichmentPaneTitle;const Va=R.a.od("CloseEnrichmentPane","EnrichmentPaneCloseButton",CommonUIStrings.l_Close,"ClosePaneGlyph_16x16x32",!1);this.Co.ta(S.a.click,Va,Object(J.a)(this,this.xp,"onClosePaneClick"));this.Hg.ta(S.a.Vf,Va,Object(J.a)(this,this.sQf,"onKeyHide"));ua.appendChild($a);ua.appendChild(Va);this.xy=Va;return ua}Nwi(ua){this.Cy=I.b("iframe","","EnrichmentFrame");ua.appendChild(this.Cy);this.Cy.id=X.Tsi;this.Cy.setAttribute("role",
"presentation")}fxj(){V.a.addHandler(this.Cy,"load",Object(J.a)(this,this.VPf,"onIFrameLoad"));V.a.addHandler(this.Cy,"error",Object(J.a)(this,this.Wxc,"onIFrameError"));$addHandler(window,"message",Object(J.a)(this,this.WPf,"onIFrameMessage"))}yfk(){V.a.removeHandler(this.Cy,"load",Object(J.a)(this,this.VPf,"onIFrameLoad"));V.a.removeHandler(this.Cy,"error",Object(J.a)(this,this.Wxc,"onIFrameError"));$removeHandler(window,"message",Object(J.a)(this,this.WPf,"onIFrameMessage"))}Bwh(){this.Cy.src=
fa.JJf}hide(){this.Cnc();this.Bwh()}dni(ua,$a,Va){if(1!==Va&&(this.hide(),this.Kx))this.Kx.onPaneClosed();return 32}VPf(){}Wxc(){}WPf(ua){ua=ua.rawEvent;if(!this.Cy||-1!==this.Cy.src.indexOf(ua.origin)){try{var $a=da.a(ua.data)}catch(Va){return}if(!Ga.c($a.messageType)){ua=window.g_badCastCallback;window.g_badCastCallback=null;switch($a.messageType){case 2:this.FAc(new O(1,da.c(this.ule),this.wle));break;case 1:this.FAc(new M(0,this.Q1h()));break;case 3:this.Kx&&this.Kx.selectEntity($a.messageContent);
break;case 5:this.Kx&&this.Kx.qMb($a.messageContent);break;case 8:this.Kx&&($a=da.a($a.messageContent),0<$a.DomainId?this.Kx.MZd($a.Query,$a.TelemetryJson,$a.DomainId,$a.DomainIdString):this.Kx.searchEntity($a.Query,$a.TelemetryJson));break;case 6:this.Kx&&this.Kx.cancelSearch();break;case 11:$a=da.a($a.messageContent);$a=fa.hdc("keydown","f6",la.a.yZb,!0,!1,$a,!0,!1);this.Cy&&this.Cy.dispatchEvent($a);break;case 12:if(da.a($a.messageContent).keyCode===la.a.JO&&($a=fa.hdc("keydown","esc",la.a.JO,
!0,!1,!1,!1,!1),this.Cy&&(this.Cy.dispatchEvent($a),this.hide(),this.Kx)))this.Kx.onPaneClosed();break;case 13:this.Kx&&this.Kx.selectDataType($a.messageContent);break;case 14:this.Kx&&this.Kx.showHelpArticle($a.messageContent);break;case 15:this.Kx&&this.Kx.showSurveyDialog($a.messageContent);break;case 16:this.Kx&&($a=da.a($a.messageContent),this.Kx.insertTable($a.DomainId,$a.DomainIdString))}window.g_badCastCallback=ua}}}Q1h(){return da.c([2,1,3,5,8,6])}FAc(ua){ua=da.c(ua);this.Cy.contentWindow.postMessage(ua,
ba.a.rN(this.SAb))}static hdc(ua,$a,Va,hb,qb,Nb,yb,ja){na.a.fC?(Nb=String.format("{0} {1} {2}",Nb?"Shift":"",yb?"Control":"",ja?"Alt":""),Nb.trim(),Va=document.createEvent("KeyboardEvent"),Va.initKeyboardEvent(ua,hb,qb,window.self,$a,0,Nb,!1,"en-US")):($a={},$a.keyCode=Va,$a.ctrlKey=yb,$a.shiftKey=Nb,$a.altKey=ja,$a.bubbles=hb,$a.cancelable=qb,Va=new KeyboardEvent(ua,$a));return Va}}fa.JJf="about:blank";Object(w.a)(fa,"EnrichmentPane",null,[722,5]);class Xa extends fa{constructor(ua){super(k.AFrameworkApplication.sa.ZC,
k.AFrameworkApplication.sa.sB,k.AFrameworkApplication.sa.lta,k.AFrameworkApplication.sa.ii,k.AFrameworkApplication.Dd);this.taskPane=ua;this.taskPane.C_g(this.zfg)}get NYd(){return this.taskPane.Ce}nkb(){this.taskPane.isVisible||this.taskPane.Ik(!0)}Cnc(){this.taskPane.Ik(!1)}dispose(){this.taskPane&&(this.taskPane.jCj(this.zfg),this.taskPane=null);super.dispose()}}Object(w.a)(Xa,"EnrichmentTaskPaneWrapper",fa,[]);class Ua{constructor(ua){this.AB=null;this.yja=ua}FOi(ua,$a){this.AB=ua;this.yja&&this.yja.show(this,
$a,null)}sMc(ua,$a){this.yja&&this.yja.sMc(ua,$a)}Svd(){this.yja&&this.yja.hide()}dispose(){this.yja&&(this.yja.dispose(),this.yja=null)}selectEntity(ua){return this.AB?this.AB.selectEntity(ua):!1}searchEntity(ua,$a){this.AB&&this.AB.searchEntity(ua,$a)}MZd(ua,$a,Va,hb){this.AB&&this.AB.MZd(ua,$a,Va,hb)}qMb(ua){return this.AB?this.AB.qMb(ua):!1}onPaneClosed(){if(this.AB)this.AB.onPaneClosed()}cancelSearch(){this.AB&&this.AB.cancelSearch()}selectDataType(ua){this.AB&&this.AB.selectDataType(ua)}showHelpArticle(ua){this.AB&&
this.AB.showHelpArticle(ua)}showSurveyDialog(ua){this.AB&&this.AB.showSurveyDialog(ua)}insertTable(ua,$a){this.AB&&this.AB.insertTable(ua,$a)}}Object(w.a)(Ua,"EnrichmentManager",null,[723,5]);class ka extends Ua{constructor(ua){super(ua)}dispose(){super.dispose()}}Object(w.a)(ka,"ExcelEnrichmentManager",Ua,[]);var nb=a(16);class Ea{constructor(ua){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=
this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=ua;this.commentQuestion=nb.a.instance.xd(199);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=nb.a.instance.xd(195);this.ratingValuesAscending=[nb.a.instance.xd(196),nb.a.instance.xd(197),nb.a.instance.xd(198)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=nb.a.instance.xd(194)}}Object(w.a)(Ea,"FloodgateSurvey",null,[]);var sb=a(26),Oa=a(77),La=a(431),ia=a(45),
Sa=a(383),Za=a(200),Ab=a(30),pb=a(93),Tb=a(34),ob=a(247),va=a(19);class Pa{constructor(){this.market=this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}}Object(w.a)(Pa,"EnrichmentMessageContentAppProperties",null,[]);class jb{constructor(ua,$a,Va,hb,qb){this.Gya=this.NXe=!1;this.hjb=this.Kfa=!0;this.OOb=this.dVb=!1;this.ukb=null;this.Ozc=0;this.qz=()=>{(this.hjb||this.Gya)&&
2!==this.Ozc&&(this.OOb||this.yFd(!1))};this.ff=()=>{b.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};this.R5i=Nb=>{Tb.a.ph(Nb.Errors)?(Nb=Tb.a.ue(Nb.Errors),Nb.includes("OperationSucceededWithAlert")?b.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):b.ULS.sendTraceTag(36975687,0,10,`Failed to Convert to Linked Entity. errors: ${Nb}`)):Nb.Result&&(this.$.ea.gm(this.ff),this.$.ea.Zl(this.ff),Nb=Nb.Result,this.ukb=
Nb.SkydanceFeatureBitmask,this.IJd(Nb),this.dVb=!0)};this.Mh=()=>{(this.hjb||this.Gya)&&this.yFd(!1)};this.Pxc=(Nb,yb)=>{Tb.a.ph(Nb.Errors)?b.ULS.sendTraceTag(36975688,0,10,`Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: ${Tb.a.ue(Nb.Errors)}`):Nb.Result&&(Nb=Nb.Result,Nb.DisambiguationJson?(this.dVb=!1,this.wgg(yb),this.ukb=Nb.SkydanceFeatureBitmask,yb=Nb.DisambiguationJson,b.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),
this.OOb=!1,this.TAf(yb)):b.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};this.B8i=(Nb,yb)=>{Tb.a.ph(Nb.Errors)?(yb=Tb.a.ue(Nb.Errors),b.ULS.sendTraceTag(36975689,0,10,`Failed to retrieve disambiguation data for search. errors: ${yb}`)):Nb.Result&&(Nb=Nb.Result,Nb.DisambiguationJson?(this.wgg(yb),this.ukb=Nb.SkydanceFeatureBitmask,yb=Nb.DisambiguationJson,b.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),
this.OOb=!0,this.TAf(yb)):b.ULS.sendTraceTag(537166939,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};this.kbj=Nb=>{Tb.a.ph(Nb.Errors)?(Nb=Tb.a.ue(Nb.Errors),b.ULS.sendTraceTag(36975690,0,10,`Failed to move to the next ambiguous Linked Entity. errors: ${Nb}`),this.hjb=!0):Nb.Result&&(Nb=Nb.Result,this.ukb=Nb.SkydanceFeatureBitmask,this.IJd(Nb),this.dVb=!0)};this.hej=Nb=>{if(Tb.a.ph(Nb.Errors)){const yb=Tb.a.ue(Nb.Errors);b.ULS.sendTraceTag(36975691,
0,10,`Failed to select Linked Entity for Disambiguation.. errors: ${yb}`)}Nb.Result?(this.IJd(Nb.Result),this.dVb=!0):this.Kxa()};this.ITf=Nb=>{Tb.a.ph(Nb.Errors)?(Nb=Tb.a.ue(Nb.Errors),b.ULS.sendTraceTag(36975692,0,15,`Failed to retrieve data for searching in Disambiguation Pane.  Error id names: ${Nb}`)):Nb.Result?this.vgc.sMc(Nb.Result,null):(b.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.Kxa())};
this.R$i=Nb=>{Tb.a.ph(Nb.Errors)?(Nb=Tb.a.ue(Nb.Errors),b.ULS.sendTraceTag(537166926,0,15,`Failed to insert starter data table. Error id names: ${Nb}`)):this.Kxa()};this.$=ua;this.gridView=va.h(this.$);this.gridView.ha.XJ(this.Mh);this.gridView.Fu(this.qz);this.G0e=hb;this.convertToLinkedEntityManager=qb;Ab.a.gg()||Va.h9($a);ua=new Xa($a);this.vgc=new ka(ua);r.a.instance.Qd("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Nb=>{Nb.isFeatureEnabled("mso_sendASmile",!0).then(yb=>
{this.Kfa=yb;return null})})}dispose(){this.$&&(this.gridView.ha.QI(this.Mh),this.gridView.Ax(this.qz))}selectEntity(ua){const $a=ia.o(this.gridView.ha.ra.activeCell,this.$),Va=()=>new La.a;Sa.a(this.$.userOperationManager,(hb,qb,Nb)=>{var yb=this.$.qa.ua;hb=ob.b(hb,this.hej);const ja=yb.Pa(9,null);ja.activeCell=$a;ja.selectionIndex=ua;return G.g(yb,"SelectLinkedEntityForDisambiguation",ja,hb,qb,Nb,null,4)},hb=>new Za.a(109,0,hb,void 0,Va),null);return!0}searchEntity(ua,$a,Va,hb,qb){Va=void 0===Va?
!1:Va;hb=void 0===hb?0:hb;qb=void 0===qb?null:qb;b.ULS.sendTraceTag(38846755,0,50,`ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: ${$a}`);const Nb=ia.o(this.gridView.ha.ra.activeCell,this.$);Sa.a(this.$.userOperationManager,(yb,ja,Ka)=>{var Pb=this.$.qa.ua,rc=this.Kfa,$c=Va,Dd=hb,Jd=qb;yb=ob.b(yb,this.ITf);const Kd=Pb.Pa(1,null);Kd.searchCell=Nb;Kd.searchQuery=ua;Kd.isFloodgateEnabled=rc;Kd.isStarterData=$c;Kd.starterDataDomainId=Dd;Kd.starterDataDomainIdString=
Jd;return G.g(Pb,"LinkedEntitySearch",Kd,yb,ja,Ka,null,4)},yb=>new Za.a(110,0,yb,16),null)}qMb(ua){const $a=ia.o(this.gridView.ha.ra.activeCell,this.$);this.hjb=!1;Sa.a(this.$.userOperationManager,(Va,hb,qb)=>{var Nb=this.$.qa.ua;Va=ob.b(Va,this.kbj);const yb=Nb.Pa(1,null);yb.activeCell=$a;yb.isBackward=ua;return G.g(Nb,"MoveToNextAmbiguousLinkedEntity",yb,Va,hb,qb,null,4)},Va=>new Za.a(111,0,Va,16),null);return!0}onPaneClosed(){this.Gya=!1;this.NXe=!0;this.Ozc=0;this.OOb=!1}cancelSearch(){const ua=
this.i_d();ua&&Sa.a(this.$.userOperationManager,($a,Va,hb)=>{var qb=this.$.qa.ua;$a=ob.b($a,this.ITf);const Nb=qb.Pa(9,null);Nb.activeCell=ua;return G.g(qb,"CancelSearchLinkedEntity",Nb,$a,Va,hb,null,4)},$a=>new Za.a(112,0,$a,16),null)}selectDataType(ua){b.ULS.sendTraceTag(537166977,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.Kxa();if(ua&&ua.length)if(ua=JSON.parse(ua))if(null==ua.domainId)b.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");
else{var $a={};$a.Id=ua.domainId;$a.StringId=ua.stringId;this.convertToLinkedEntityManager.convertToLinkedEntity($a)}else b.ULS.sendTraceTag(537166947,0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else b.ULS.sendTraceTag(537166976,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")}showHelpArticle(ua){const $a=new pb.a(-859308420,Oa.a.Bd,this.$.se,9,null);this.$.Ha.Ad($a,{[Oa.a.Th]:"HelpID="+ua,["InputMethod"]:Oa.a.Bd,["ShouldCanvasTakeFocus"]:!0,
[Oa.a.We]:x.a.xN})}showSurveyDialog(ua){n.BrowserFeedbackControlOCV.pkb(new Ea(ua))}insertTable(ua,$a){const Va=this.i_d();Va&&Sa.a(this.$.userOperationManager,(hb,qb,Nb)=>{var yb=this.$.qa.ua;hb=ob.b(hb,this.R$i);const ja=yb.Pa(1,null);ja.cell=Va;ja.starterDataDomainId=ua;ja.starterDataDomainIdString=$a;return G.g(yb,"InsertStarterDataTable",ja,hb,qb,Nb,null,4)},hb=>new Za.a(259,0,hb,1),null)}yFd(ua){this.launchOrCloseDisambiguationPane(ua)}launchDisambiguationPaneForSearch(){b.ULS.sendTraceTag(36975685,
0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");const ua=this.sMj();ua&&Sa.a(this.$.userOperationManager,($a,Va,hb)=>E(this.$.qa.ua,ua,!0,this.Kfa,!1,null,ob.b($a,this.B8i),Va,hb,1),$a=>new Za.a(114,0,$a,16),null)}launchLinkedEntityDataTypeSelectorPane(ua,$a){Sa.a(this.$.userOperationManager,(Va,hb,qb)=>{var Nb=this.$.qa.ua;Va=ob.b(Va,this.Pxc);const yb=Nb.Pa(1,null);yb.selectedRanges=ua;yb.letyDomainId=$a;return G.g(Nb,"GetDataTypeSelectorData",
yb,Va,hb,qb,2,4)},Va=>new Za.a(233,0,Va,16),null)}zOi(ua,$a){ua&&Sa.a(this.$.userOperationManager,(Va,hb,qb)=>E(this.$.qa.ua,ua,!1,!1,!0,$a,ob.b(Va,this.Pxc),hb,qb,2),Va=>new Za.a(257,0,Va,16),null)}wgg(ua){ua&&(this.Ozc=ua)}TAf(ua){var $a=new pb.a(-90814711,Oa.a.Bd,0,10,null);this.$.Ha.Ad($a,null);this.Gya?this.vgc.sMc(ua,null):($a=3,null!=this.ukb?$a=this.ukb:b.ULS.shipAssertTag(537166937,0,!1,"SkydanceFeatureBitmask was not set"),(ua=this.t7h(ua,$a))||b.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),
this.G0e||b.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.vgc.FOi(this.G0e,ua),this.Gya=!0)}Kxa(){this.Gya&&(b.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.vgc.Svd(),this.Gya=!1,this.Ozc=0,this.OOb=!1)}IJd(ua){var $a=ua.Row+1;ua=ua.Column+1;0>$a||0>ua?(b.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.Kxa(),
this.$.ea.gm(this.ff)):($a=new sb.Range($a,ua,$a,ua,!0,!1),this.gridView.ha.updateSelection($a,$a,60),this.hjb=!0)}t7h(ua,$a){const Va=new Pa;Va.applicationVersion=k.AFrameworkApplication.buildVersion;Va.applicationName="ExcelWac";Va.anid="00000000-0000-0000-0000-000000000000";Va.sessionId=k.AFrameworkApplication.userSessionId;Va.appCorrelationId=z.a.create().toString();var hb=y.a.pN(k.AFrameworkApplication.lcid);hb=hb?hb.name:null;Va.uiLanguage=hb;Va.market=this.lkc(hb);Va.themeId=0;Va.disambiguationJson=
ua;$a<=B.a.o5?Va.featuresBitMask=$a:b.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return Va}lkc(ua){ua=ua.split("-");return ua[ua.length-1]}launchOrCloseDisambiguationPane(ua){const $a=this.gridView.ha.ra.activeCell;if(this.i_d()&&$a)if(this.gridView.zd.aHb($a)){if((!this.NXe||ua||this.dVb)&&!this.gridView.ld){ua&&(this.hjb=!0);var Va=ia.q($a,this.$);Sa.a(this.$.userOperationManager,(hb,qb,Nb)=>E(this.$.qa.ua,Va,!1,this.Kfa,!1,
null,ob.b(hb,this.Pxc),qb,Nb,1),hb=>new Za.a(114,0,hb,16),null)}}else this.Kxa();else this.Kxa()}Wvj(){if(this.Gya){var ua=this.gridView.ha.ra.activeCell;if(ua){var $a=ia.q(ua,this.$);Sa.a(this.$.userOperationManager,(Va,hb,qb)=>E(this.$.qa.ua,$a,!1,this.Kfa,!1,null,ob.b(Va,this.Pxc),hb,qb,1),Va=>new Za.a(114,0,Va,16),null)}else this.Kxa()}}i_d(){const ua=this.gridView.ha.ra;return ua.Ufa()?ia.o(ua.activeCell,this.$):null}sMj(){const ua=this.gridView.ha.ra;return ua.Ufa()?ia.q(ua.activeCell,this.$):
null}}Object(w.a)(jb,"ConvertToLinkedEntityDisambiguationPane",null,[5]);var Ob=a(2),kb=a(386),ra=a(1229),rb=a(56),Kb=a(747);class Sb{constructor(ua,$a,Va){this.sBf=2;this.rBf="Size64by48";this.$=ua;this.Ya=$a;this.convertToLinkedEntityManager=Va}K_h(ua,$a){var {ConvertToLinkedEntityManager:Va}=a(803);this.Zhk();$a=this.Ya.ft($a).rH();let hb=0,qb=0,Nb=!1;for(var yb of ua.Categories){const ja=this.o0h(yb,hb);ja&&(qb===Va.Edb&&(Nb=!0),$a.MenuSectionList.push(ja),++hb);++qb}Nb&&hb<=Va.tBf&&$a.MenuSectionList.splice(Va.Edb,
1);Va=this.Ya.Ne().z$b();yb=rb.a.Ci(11);for(const ja of ua.LongButtons)this.convertToLinkedEntityManager.eZj(ja)&&this.XWg(Va,ja,yb);0<Va.ControlList.length&&$a.MenuSectionList.push(Va);return $a}XWg(ua,$a,Va){if($a){var hb="Data.ConvertToLinkedEntityMenuItem_"+$a.Name,qb=this.convertToLinkedEntityManager.QX($a.DomainId);qb&&($a=Object(Ob.a)(new kb.a,{Id:hb,ExternalId:hb,Command:"-1662108744",LabelText:$a.Name,Alt:$a.SuperTip,Visible:!0,MenuItemId:a(803).ConvertToLinkedEntityManager.L7a($a.DomainId),
Image16by16:Va,Image16by16Class:this.sti(qb.FontLocator)}),ua.ControlList.push($a))}}j0h(ua,$a){return Object(Ob.a)(new ra.a,{Id:a(803).ConvertToLinkedEntityManager.BZe+ua.toString(),ExternalId:a(803).ConvertToLinkedEntityManager.BZe+ua.toString(),MenuItemId:a(803).ConvertToLinkedEntityManager.iid+ua.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",Icon:this.pof($a.FontLocator),LabelText:$a.Name,PreviewIconStyle:{["root"]:{["width"]:24,["min-width"]:24,["height"]:24}},
Alt:this.ypd($a)})}I6g(ua){switch(ua){case "Animal":return Kb.a.R2g;case "Apple":return Kb.a.X3g;case "Atom":return Kb.a.y5g;case "Beaker":return Kb.a.y7g;case "Bridge":return Kb.a.c9g;case "Cat":return Kb.a.qeh;case "City":return Kb.a.Bgh;case "Constellation":return Kb.a.rlh;case "Dog":return Kb.a.vCh;case "Finance":return Kb.a.q7g;case "GradCap":return Kb.a.Fli;case "HumanAnatomy":return Kb.a.Rsi;case "LocationPointer":return Kb.a.jRi;case "Map":return Kb.a.Dhj;case "MedicineNeedle":return Kb.a.UXi;
case "Mountain":return Kb.a.lZi;case "Movie":return Kb.a.EZi;case "Music":return Kb.a.SZi;case "OuterSpace":return Kb.a.kij;case "Planet":return Kb.a.vlj;case "Satellite":return Kb.a.JJj;case "WolframGeneric":return Kb.a.BIj;default:return Kb.a.fnh}}sti(ua){if("PowerBIRibbon"!==ua)return v.a.xkd;switch(ua){case "AnimalRibbon":return v.a.jOh;case "AppleRibbon":return v.a.kOh;case "AtomRibbon":return v.a.lOh;case "BeakerRibbon":return v.a.mOh;case "BridgeRibbon":return v.a.nOh;case "CenterMapRibbon":return v.a.oOh;
case "CityRibbon":return v.a.pOh;case "CurrencyRibbon":return v.a.qOh;case "ExerciseRibbon":return v.a.rOh;case "FinanceRibbon":return v.a.l4e;case "FirstAidRibbon":return v.a.sOh;case "GlobeLightningRibbon":return v.a.tOh;case "GradCapRibbon":return v.a.uOh;case "HumanAnatomyRibbon":return v.a.vOh;case "LeafRibbon":return v.a.wOh;case "LocationPointerRibbon":return v.a.yOh;case "MapRibbon":return v.a.j4e;case "MountainRibbon":return v.a.zOh;case "MovieRibbon":return v.a.AOh;case "MusicRibbon":return v.a.BOh;
case "NotablePeopleRibbon":return v.a.COh;case "OuterSpaceRibbon":return v.a.DOh;case "PartlySunnyWeatherRibbon":return v.a.EOh;case "PowerBIRibbon":return v.a.k4e;case "SatelliteRibbon":return v.a.FOh;case "WolframGenericRibbon":return v.a.xOh;case "YogaRibbon":return v.a.HOh;default:return v.a.i4e}}pof(ua){switch(ua){case "AnimalRibbon":return"AnimalExcelDataTypes_24";case "AppleRibbon":return"AppleExcelDataTypes_24";case "AtomRibbon":return"AtomExcelDataTypes_24";case "BeakerRibbon":return"BeakerExcelDataTypes_24";
case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";case "GlobeLightningRibbon":return"GlobeLightning_24";case "GradCapRibbon":return"GradCapExcelDataTypes_24";case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";
case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";
case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}}o0h(ua,$a){$a=this.Ya.DF("ConvertToLinkedEntitySection_"+$a,this.sBf,this.rBf);var Va=!1;for(var hb of ua.DomainIds){const qb=this.convertToLinkedEntityManager.QX(hb);if(!qb||qb.DomainBlocked||!qb.ShowInRibbon)continue;Va=qb.Name;const Nb=a(803).ConvertToLinkedEntityManager.L7a(hb);
$a.Kv("Data.ConvertToLinkedEntityMenuItem_"+Nb,-1203788282,"QueryLinkedEntityGalleryIcon",void 0,Nb,this.pof(qb.FontLocator),void 0,void 0,this.ypd(qb),Va);Va=!0}if(!Va)return null;hb=$a.y$b(!0);$a=this.Ya.Ne();$a.title=ua.Name;ua=$a.z$b();ua.ControlList.push(hb);return ua}Zhk(){this.sBf=5;this.rBf="Size112by64"}ypd(ua){return ua.RibbonTooltipHeader?ua.RibbonTooltipHeader+"\n\n"+ua.RibbonTooltip:ua.RibbonTooltip}}Object(w.a)(Sb,"ConvertToLinkedEntityMenuRenderer",null,[699]);var cb=a(63),cc=a(324),
Ub=a(125),wb=a(1),vc=a(110),Lb=a(73);class Ja{constructor(ua,$a){this.svd=this.vvd=!1;this.bOd=Va=>{b.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");this.vvd=!0;if(Tb.a.ph(Va.Errors))b.ULS.sendTraceTag(537166679,0,10,`OnReadRoamingStringSuccess encountered an error. Errors: ${Tb.a.ue(Va.Errors)}`);else{var hb=0,qb=[],Nb=!1;try{if(!Va.Result)return;const yb=Va.Result;if(!yb){b.ULS.sendTraceTag(537166678,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}qb=
this.Cjj(yb);if(!qb||!qb.length)return;hb=qb.length;this.iYi(qb);this.UEa.H9f();b.ULS.sendTraceTag(537166677,0,50,`OnReadRoamingStringSuccess MruCount:${this.UEa.Jhb.length}`);if(wb.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(const ja of this.UEa.Jhb)if(1===(ja.Id&1048320)>>8){Nb=!0;break}b.ULS.sendTraceTag(537166676,0,50,`OnReadRoamingStringSuccess MruWolframAvailable:${Nb}`)}}finally{b.ULS.sendTraceTag(537166675,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${hb} data types.`),
Va=[],Va.push(Object(Ob.a)(new Lb.a,{name:"MruCount",int64:hb})),Va.push(Object(Ob.a)(new Lb.a,{name:"MruWolframAvailable",bool:Nb})),vc.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,Va)}this.svd&&(this.Lzg(this.UEa.Jhb),this.svd=!1)}};this.SOd=Va=>{b.ULS.sendTraceTag(537166674,0,50,"OnWriteRoamingStringSuccess called.");Tb.a.ph(Va.Errors)?b.ULS.sendTraceTag(537166673,0,10,`OnWriteRoamingStringSuccess encountered an error. Errors: ${Tb.a.ue(Va.Errors)}`):Va.Result&&(Va.Result||b.ULS.sendTraceTag(537166672,
0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.mTf=(Va,hb,qb)=>{Va=Ub.a.Lg(Va.data);b.ULS.sendTraceTag(537166671,0,10,`OnRoamingOperationFailure: Encountered errors for ${qb}. Errors: ${Tb.a.ue(Va)}.`)};this.$=ua;this.UEa=$a}Wei(){!this.vvd&&this.$.ea.oe&&(b.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),cc.y(this.$.qa.ua,0,this.bOd,this.mTf,null,null))}Lzg(ua){ua&&ua.length?
this.vvd?(ua=this.bOj(ua))?(b.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),cc.F(this.$.qa.ua,0,ua,this.SOd,this.mTf,null,null)):b.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.svd=!0:b.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")}bOj(ua){if(!ua||
!ua.length)return b.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var $a=[];for(const Va of ua)ua={},ua.Id=Va.Id,Va.StringId&&(ua.StringId=Va.StringId),$a.push(ua);$a="<DataTypes>"+cb.a.He($a)+"</DataTypes>";return 1906<$a.length?(b.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):$a}Cjj(ua){if(!ua)return b.ULS.sendTraceTag(537166685,0,
15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!ua.startsWith("<DataTypes>")||!ua.endsWith("</DataTypes>"))return b.ULS.sendTraceTag(537166684,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;ua=ua.substring(11,ua.length-12);if(!ua)return b.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;let $a=[];try{$a=cb.a.Fk(ua)}catch(Va){return b.ULS.sendTraceTag(537166682,0,10,`ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: ${Va.message}`),
null}b.ULS.sendTraceTag(537166681,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${$a.length} data types.`);return $a}iYi(ua){const $a=this.UEa.Jhb,Va=this.UEa.Tuj;if($a.length!==Va){for(let hb=0;hb<ua.length&&$a.length<Va;++hb){const qb=ua[hb];this.UEa.QX(qb)&&!$a.includes(qb)&&$a.push(qb)}this.UEa.Jhb=$a}}}Object(w.a)(Ja,"LinkedDataTypeRoamingHandler",null,[]);var Hb=a(60),gc=a(53),ec=a(153),Ta=a(38),ib=a(54),bc=a(33),jc=a(248),sc=a(22),Fa=a(106),Ha=a(155),Na=a(91),W=a(137),U=a(15);a.d(C,"ConvertToLinkedEntityManager",
function(){return za});class za extends t.a{constructor(ua,$a,Va,hb,qb,Nb,yb){super();this.Cxf=this.mDd=this.iEd=this.$Bd=this.ZBd=this.ecb=this.Wyd=null;this.VMb=this.Vud=0;this.Spa=null;this.izd=!1;this.Knd=this.qq=this.KYd=null;this.ev=0;this.e1=null;this.IQa=8;this.k$c=this.qBf=this.Jtf=this.agb=!1;this.UDa=this.H$e=this.k7e=null;this.u8c=0;this.T6g=5;this.Q9b=3E4;this.Lrg=!1;this.qxa=null;this.Pya=Array(wb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataTabReorgExperiment",!1)?
3:5);this.yug=this.c$d=!1;this.gag=this.YFd=0;this.Zd=this.wpe=null;this.Elg=!0;this.ff=(ja,Ka)=>{Ka.oe&&!Ka.mJb&&this.showUntrustedImageBusinessBarIfNecessary()};this.B9i=ja=>{if(ja.Result){var Ka=ja.Result;if(Ka&&Ka.length){b.ULS.sendTraceTag(537166922,0,50,`OnGetRichDataClassificationLabelsSuccess: Received ${Ka.length} labels`);var Pb=gc.GetServiceTaskFactory.ud(this.$.ga,274,275,0);Ta.TaskExtensions.za(Pb,()=>{Pb.result.h8c(Ka,2)||b.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},
this.$.ka,3)}}else b.ULS.sendTraceTag(537166923,0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};this.Nh=()=>{this.hdk();this.Tni(this.$.ea.pp.LinkedEntityAsyncRefreshStateId);this.qcb?this.Voi(this.$.ea.pp.RichDataClassificationLabelStateId):this.ubb&&this.q9d(!0)};this.Z6i=()=>{this.c$d=!0;this.qq&&this.qq.Wvj()};this.U8i=ja=>{if(ja&&!jc.a(ja))try{ja.Result.HasUntrustedImageUrl&&(this.businessBar.yi(59,null),this.yug=!0)}catch(Ka){b.ULS.sendTraceTag(574718945,0,10,`ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception ${Ka}.`)}};
this.PAf=()=>{if(!this.qBf&&this.AHb()&&!this.Xzd())if(vc.a("DataTabActive"),Hb.a.Bi.wU)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var ja=this.Xcc();if(ja){var Ka={};Ka.InputMethod=Oa.a.Bd;Ka.CalloutName=8;Ka.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.$.Ha.Ad(ja,Ka);this.qBf=!0}else b.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else b.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");
else b.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};this.S5i=ja=>{Tb.a.ph(ja.Errors)||(this.qcb||this.q9d(!1),this.raiseEvent("LinkedEntityConverted"))};this.hfj=()=>{wb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2AriaLiveNotifier",!1)?void W.a.resolve(U.f).then(ja=>{ja.readText(nb.a.instance.ia(1813))}):this.$.ga.qd(211,ja=>{ja.readText(nb.a.instance.ia(1813))})};
this.wf=(ja,Ka)=>{b.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");Ka.YY?b.ULS.sendTraceTag(537166865,0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):(this.$.isEditMode?this.TMe():this.kGj(),this.c$d&&this.H_e())};this.c9i=ja=>{this.fbc();if(ja.Result){var Ka=ja.Result;ja=Ka.DomainDataArray;if(this.Spa=Ka.Ribbon){var Pb={};Pb.Name=nb.a.instance.ia(1803);Pb.DomainIds=this.JN;this.Spa.Categories.splice(za.Edb,0,Pb)}0<
Ka.MaximumCellsToConvert&&(this.wpe=Ka.MaximumCellsToConvert);this.ev=2;Ka=!1;if(ja){b.ULS.sendTraceTag(39949271,0,50,`OnGetLinkedEntityServiceDomainsSuccess: Received ${ja.length} domains`);this.iTa||(this.iTa=[]);Pb=nb.a.instance.ia(1800);const rc=nb.a.instance.ia(1802);for(const $c of ja)$c.DomainId?(this.iTa.push($c),$c.DomainBlocked?(ja=!!$c.DomainId.StringId,b.ULS.sendTraceTag(537166861,0,50,`Domain: ${ja?$c.DomainId.Id.toString():$c.Name} is telemetry only, do not show in menu (Has String ID: ${ja})`)):
(this.PX.fa(za.L7a($c.DomainId),$c),$c.Name===Pb||268435456===$c.DomainId.Id?this.k7e=$c.DomainId.Id.toString():$c.Name===rc||536870912===$c.DomainId.Id?this.H$e=$c.DomainId.Id.toString():268435712===$c.DomainId.Id&&$c.ShowInRibbon&&(this.k$c=!0),Ka=!0)):b.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}Ka||(this.iTa=null);this.mvg();this.KYd.Wei();this.Lrg||(this.cdk(),this.Lrg=!0)}else this.iTa=null,this.ev=3,-1<this.IQa&&window.setTimeout(()=>{this.DPb()},
100*(8-this.IQa)),b.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");this.iUd();this.mTe();this.k$c&&this.Zuf&&ec.c(this.PAf,this.$.ka,500);this.ubb&&!this.qcb&&this.q9d(!0)};this.b9i=ja=>{ja=Ub.a.Lg(ja.data);b.ULS.sendTraceTag(34415007,0,15,`OnGetLinkedEntityServiceDomainsFailure [Errors: ${Tb.a.ue(ja)}].`);this.iTa=null;this.ev=3;this.agb=!0;this.iUd()};this.onContentReady=()=>{this.btg()&&this.gridView.Ax(this.onContentReady);this.Elg&&this.$.workbookContext.Options&
1048576&&(this.businessBar.b2j(),this.Elg=!1)};this.Rk=()=>{this.fbc()};this.Jaj=ja=>{if(jc.a(ja)){const Ka=Object(Ha.a)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?Object(Na.d)(W.a.resolve(U.m,{Ja:0})):gc.GetServiceTaskFactory.ud(this.$.ga,5,4,0);Ta.TaskExtensions.za(Ka,()=>{let rc=null;if(null===ja||void 0===ja?0:ja.Errors)rc=ja.Errors[0];Ka.result.jlg(rc,null)},this.$.ka,3);b.ULS.sendTraceTag(537166800,0,15,`ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: ${Tb.a.ue(ja.Errors)}].`);
const Pb=Tb.a.uE(ja.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");this.$.ea.Yp(Pb)}};this.f$c=()=>{b.ULS.sendTraceTag(537166796,0,50,`ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a ${this.Q9b} millisecond interval`);this.Yqf("Periodic auto-refresh check",this.e4i,this.d4i)};this.e4i=ja=>{jc.a(ja)?(b.ULS.sendTraceTag(537166795,0,15,`ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: ${Tb.a.ue(ja.Errors)}].`),
++this.u8c):this.u8c=0;c.a.Ma(this.UDa);this.u8c>=this.T6g?(b.ULS.sendTraceTag(537166794,0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),this.UDa=null):(b.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),this.UDa=ib.a.instance.create(this.f$c,this.Q9b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};
this.d4i=ja=>{ja=Ub.a.Lg(ja.data);h.a.ij(ja)?b.ULS.sendTraceTag(537166791,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):b.ULS.sendTraceTag(537166792,0,15,`OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: ${Tb.a.ue(ja)}].`);c.a.Ma(this.UDa);this.UDa=ib.a.instance.create(this.f$c,this.Q9b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};this.Lbj=ja=>{ja=!!ja.Result&&ja.Result;b.ULS.sendTraceTag(537166790,
0,50,`OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = ${ja.toString()}`);ja?(b.ULS.sendTraceTag(537166789,0,50,`OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = ${bc.a.$b.og.m-this.Vud} ms, retry count = ${this.VMb}`),this.DPb()):this.fJc()};this.Kbj=()=>{b.ULS.sendTraceTag(537166788,0,15,"OnNotifyFeatureLicensingStatusFailed");this.fJc()};this.F8i=ja=>{ja.Result?(ja=ja.Result)?(this.sVd(),this.businessBar.jlg(null,ja)):b.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):
b.ULS.sendTraceTag(537166726,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};this.$=ua;this.businessBar=Nb;this.svgIconProvider=Va;this.Zd=yb;this.iTa=[];this.JN=[];this.gridView=va.h(this.$);this.Vmc=-1;this.EGi=wb.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");this.ubb=wb.EwaSettings.Ea(387);this.qcb=wb.EwaSettings.Ea(586);this.Zuf=wb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",
!1);this.PX=new Fa.a;this.peb=new Sb(ua,$a,this);hb&&(this.qq=new jb(ua,hb,qb,this,this));this.$.Zm(this.wf);m.a(this.$)&&m.a(this.$).GPj(this);this.TMe();(this.ubb||this.qcb)&&this.$.ea.Mw(this.Nh);wb.EwaSettings.Ea(123)&&wb.EwaSettings.Ea(131)&&(this.btg()||this.gridView.Fu(this.onContentReady));this.$.IB(this.Rk);this.$.ea.Zl(this.ff);this.showUntrustedImageBusinessBarIfNecessary();this.KYd=new Ja(this.$,this)}dispose(){(this.ubb||this.qcb)&&this.$.ea.ny(this.Nh);this.$.ea.gm(this.ff);!this.qxa&&
wb.EwaSettings.Ea(123)&&wb.EwaSettings.Ea(131)&&this.gridView.Ax(this.onContentReady);this.qq&&this.qq.dispose();this.$.vE(this.Rk);this.$.co(this.wf);this.ubb&&(this.Wyd=null);c.a.Ma(this.UDa)}g_g(ua){this.addHandler("LinkedEntityConverted",ua)}UBj(ua){this.removeHandler("LinkedEntityConverted",ua)}get Tuj(){return 5}get Jhb(){return this.JN}set Jhb(ua){this.JN=ua}selectEntity(ua){return this.qq?this.qq.selectEntity(ua):!1}searchEntity(ua,$a){this.qq&&this.qq.searchEntity(ua,$a)}MZd(ua,$a,Va,hb){this.qq&&
this.qq.searchEntity(ua,$a,!0,Va,hb)}qMb(ua){return this.qq?this.qq.qMb(ua):!1}onPaneClosed(){if(this.qq)this.qq.onPaneClosed()}cancelSearch(){this.qq&&this.qq.cancelSearch()}selectDataType(ua){this.qq&&this.qq.selectDataType(ua)}showHelpArticle(ua){this.qq&&this.qq.showHelpArticle(ua)}showSurveyDialog(ua){this.qq&&this.qq.showSurveyDialog(ua)}insertTable(ua,$a){this.qq&&this.qq.insertTable(ua,$a)}Voi(ua){if(this.$.isEditMode&&this.gag!==ua&&k.AFrameworkApplication.da.pa("SupportsPolicies")){this.gag=
ua;b.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels");ua=this.$.qa.ua;var $a=this.B9i;const Va=ua.Pa(1,null);G.g(ua,"GetRichDataClassificationLabels",Va,$a,null,null,null,4)}}H_e(){this.$.userOperationManager.enqueueOperation(new Za.a(589,0,(ua,$a,Va)=>{var hb=this.$.qa.ua;ua=ob.b(ua,this.Z6i);const qb=hb.Pa(1,null);return G.g(hb,"LinkedEntitiesEnableUntrustedImages",qb,ua,$a,Va,null,0)},80),null)}showUntrustedImageBusinessBarIfNecessary(){this.c$d||
this.yug||!this.$.ea.oe||this.dNj()}dNj(){this.$.userOperationManager.enqueueOperation(new Za.a(588,0,(ua,$a,Va)=>{var hb=this.$.qa.ua;ua=ob.b(ua,this.U8i);const qb=hb.Pa(1,null);return G.g(hb,"GetHasUntrustedImageUrls",qb,ua,$a,Va,null,4)},80),null)}q9d(ua){if(this.ubb&&null==this.Wyd&&!this.qcb&&k.AFrameworkApplication.da.pa("SupportsPolicies")&&null!=this.ecb&&this.ecb&&(!ua||this.$.workbookContext.Options&262144)){var $a=gc.GetServiceTaskFactory.ud(this.$.ga,274,275,0);Ta.TaskExtensions.za($a,
()=>{this.Wyd=$a.result.q4f(2)},this.$.ka,3)}}get OLb(){return this.Pya.length}get RXi(){return this.wpe}gnh(ua){(ua=this.zCh(ua))?this.convertToLinkedEntity(ua):b.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")}convertToLinkedEntity(ua){b.ULS.sendTraceTag(34415004,0,50,`ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: ${ua.Id}].`);if(this.gridView){var $a=this.gridView.ha.ra.lf,Va=$a.wg(this.gridView.UT);this.izd&&this.IXg(ua);
if(Va){Va=this.gridView.zd.JBa(Va);if(!this.Tlf(ua)&&this.Wvf(ua.Id)){b.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");if(Hb.a.Bi.wU){$a=this.Pod();if(!$a){b.ULS.sendTraceTag(537166917,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Va=this.Xcc();if(!Va){b.ULS.sendTraceTag(537166916,0,50,"RibbonCommandInfo is null for blankCellConvert");return}var hb={["InputMethod"]:Oa.a.Bd,
CalloutName:3};hb.Target=$a;hb.RibbonButtonLabel=wb.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.U$f(ua):this.bKb(ua.Id.toString());hb.ExampleEntities=this.j5e(ua);this.$.Ha.Ad(Va,hb);return}b.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.Wvf(ua.Id)&&!ua.StringId)this.launchLinkedEntityDataTypeSelectorPane(za.L7a(ua));
else{if(Va){b.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(wb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",!1)&&this.m7j(ua)){$a=ia.r(this.gridView.ha.ra.selectedRanges,this.$);this.qq.zOi($a,ua);return}if(Hb.a.Bi.wU){$a=this.Pod();if(!$a){b.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Va=this.Xcc();if(!Va){b.ULS.sendTraceTag(537166912,
0,50,"RibbonCommandInfo is null for blankCellConvert");return}hb={["InputMethod"]:Oa.a.Bd,CalloutName:2};hb.Target=$a;hb.RibbonButtonLabel=this.U$f(ua);hb.ExampleEntities=this.j5e(ua);hb.BlankCellResourceId=this.X7g(ua);hb.HasBlankCellWalkthrough=this.Spi(ua);hb.ServiceDomain=ua.Id;this.$.Ha.Ad(Va,hb);return}b.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.kdd(ua,!1,$a)}}}else b.ULS.shipAssertTag(537166919,
0,!1,"grid view should not be null")}convertToLinkedEntityFromAutoDetect(){this.qxa&&this.qxa.hNa()}onAutoDetectUIShown(){Sa.a(this.$.userOperationManager,(ua,$a,Va)=>{var hb=this.$.qa.ua;const qb=hb.Pa(1,null);return G.g(hb,"OnAutoDetectUIShown",qb,ua,$a,Va,null,4)},ua=>new Za.a(230,0,ua,80),null)}kdd(ua,$a,Va){const hb=ia.q(Va,this.$),qb=()=>new La.a;Sa.a(this.$.userOperationManager,(Nb,yb,ja)=>{var Ka=this.$.qa.ua;Nb=ob.b(Nb,this.S5i,this.hfj,this.qq.R5i);const Pb=Ka.Pa(1,null);Pb.selectedRanges=
hb;Pb.domainId=ua;Pb.autodetect=$a;return G.g(Ka,"ConvertToLinkedEntity",Pb,Nb,yb,ja,null,4)},Nb=>new Za.a(115,0,Nb,void 0,qb),null)}IXg(ua){if(this.izd){var $a={};$a.Id=ua.Id;ua.StringId&&($a.StringId=ua.StringId);if(!(0<this.JN.length&&this.JN[0].Id===$a.Id&&this.JN[0].StringId===$a.StringId)){ua=!1;this.JN.splice(0,0,$a);for(let Va=1;Va<this.JN.length;++Va)if(this.JN[Va].Id===$a.Id&&this.JN[Va].StringId===$a.StringId){this.JN.splice(Va,1);ua=!0;break}for(;5<this.JN.length;)this.JN.splice(this.JN.length-
1,1);this.Spa.Categories[za.Edb].DomainIds=this.JN;this.H9f();ua||this.KYd.Lzg(this.JN)}}}convertLinkedEntityToText(){b.ULS.sendTraceTag(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");if(this.gridView){var ua=ia.q(this.gridView.ha.ra.lf,this.$);Sa.a(this.$.userOperationManager,($a,Va,hb)=>{var qb=this.$.qa.ua;const Nb=qb.Pa(1,null);Nb.selectedRanges=ua;return G.g(qb,"ConvertLinkedEntityToText",Nb,$a,Va,hb,null,4)},$a=>new Za.a(116,0,$a),null)}else b.ULS.shipAssertTag(537166879,
0,!1,"grid view should not be null")}refreshLinkedEntitiesInRange(){b.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");if(va.h(this.$)){this.$.isEditMode||b.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");this.sVd();var ua=ia.r(this.gridView.ha.ra.selectedRanges,this.$);Sa.a(this.$.userOperationManager,($a,Va,hb)=>{var qb=this.$.qa.ua;const Nb=qb.Pa(1,
null);Nb.selectedRanges=ua;return G.g(qb,"RefreshLinkedEntitiesInRange",Nb,$a,Va,hb,null,4)},$a=>new Za.a(248,0,$a),null)}else b.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")}eZj(ua){ua=this.QX(ua.DomainId);if(!ua||ua.DomainBlocked||!ua.HasCuratedData)return!1;if(this.EGi){for(let $a of this.PX)if($a.value.DomainId.Id===ua.DomainId.Id&&$a.value.ShowInRibbon)return!0;return!1}return ua.ShowInRibbon}HXj(ua){return 2!==this.ev||!this.Pya[ua]}launchDisambiguationPaneForSearch(){this.qq&&
this.qq.launchDisambiguationPaneForSearch()}Ue(ua,$a,Va){if("PopulateConvertToLinkedEntityMenu"!==$a)return!1;this.Knd=Va.MenuId;if(0===this.ev||3===this.ev)return this.$lj(),!0;if(!this.Spa)return b.ULS.sendTraceTag(537166873,0,10,"PopulateMenu: Encountered null ribbon section info"),!1;if(!this.PX)return b.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),!1;this.e1=this.e1||this.peb.K_h(this.Spa,Va.MenuId);Va.MenuItems=this.e1;return this.izd=!0}$lj(){-1===this.Vmc&&
(this.DPb(),this.Vmc=window.setInterval(()=>{this.DPb()},2E3))}DPb(){if(this.$.ea.oe&&2!==this.ev){this.IQa--;b.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted.");this.ev=1;var ua=this.$.qa.ua,$a=this.c9i,Va=this.b9i;const hb=ua.Pa(1,null);G.g(ua,"GetLinkedEntityMetadata",hb,$a,Va,null,null,4)}}Xzd(){return this.$.isEditMode&&2!==this.ev&&(0<=this.IQa||!this.agb)}V$d(ua){k.AFrameworkApplication.Di?b.ULS.sendTraceTag(537166869,0,50,
"UpdatePreviewGalleryVisibility bailed out on shutting down."):m.a(this.$)?(this.Gik(),ua&&this.$.Qh()):b.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")}kGj(){this.VMb=0;this.IQa=8;this.agb=!1;this.ev=this.Vmc=0;this.iTa=this.Spa=null;this.fbc();for(let ua=0;ua<this.OLb;++ua)this.Pya[ua]=null;this.AHb()&&this.V$d(!0)}fbc(){this.e1=null}AHb(){const ua=x.a.xQb,$a=m.a(this.$);return!!$a&&$a.Fs.jB===ua}mvg(){if(this.Spa){let Va=0;var ua=-1,$a=-1;let hb=
0,qb=0,Nb=0,yb=0;const ja=[null,null,null,null,null];for(const Ka of this.Spa.Categories){let Pb=!1;for(const rc of Ka.DomainIds){let $c=this.QX(rc);$c&&!$c.DomainBlocked&&$c.ShowInRibbon&&(Va<this.OLb?(this.Pya[Va]=rc,qb===za.Edb&&(-1===ua&&(ua=Va),$a=Va,yb=$a-ua+1),++Va):Va===this.OLb&&hb<yb&&qb!==za.Edb&&(ja[hb]=rc,++hb),Pb=!0)}Pb&&++Nb;++qb}if(-1<ua&&Nb<=za.tBf){for(;$a>=ua;--$a)this.Pya.splice($a,1);for(ua=0;ua<yb;++ua)this.Pya.splice(Va+ua,0,ja[ua])}for(;Va<this.OLb;)this.Pya[Va]=null,++Va}}btg(){const ua=
va.h(this.$).ya,$a=this.gridView.ha.Bg;if(ua&&ua.avd&&1===$a&&this.gridView.ha.ra.activeCell){const Va=Object(Na.d)(W.a.resolve(U.Hc,{Ja:1}));Ta.TaskExtensions.za(Va,()=>{this.qxa=new l.a(this.$,this.svgIconProvider,Va.result,this,this.Zd)},this.$.ka,3);return!0}return!1}COi(){this.qq&&this.qq.yFd(!0)}launchLinkedEntityDataTypeSelectorPane(ua){if(this.qq)if(ua=this.Khd(ua))if(ua.DomainId.StringId)b.ULS.sendTraceTag(537166855,0,10,"Domain with a string ID used when launching Data Type Selector pane");
else{var $a=ia.r(this.gridView.ha.ra.selectedRanges,this.$);this.qq.launchLinkedEntityDataTypeSelectorPane($a,ua.DomainId.Id)}else b.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")}ulh(ua){const $a=this.rti(ua),Va=d.a.nm(this.bKb(ua));ua=d.a.nm(this.t8d(ua));return za.o_h($a,rb.a.Ci(11),Va,ua)}t8d(ua){try{return this.NYe(parseInt(ua,10)).Description}catch($a){}return nb.a.instance.ia(1797)}bKb(ua){try{return this.NYe(parseInt(ua,10)).Name}catch($a){}return nb.a.instance.ia(1783)}U$f(ua){try{return this.QX(ua).Name}catch($a){}return this.bKb(ua.Id.toString())}X7g(ua){try{return this.QX(ua).BlankCellResourceId}catch($a){}return null}Spi(ua){try{return this.QX(ua).HasBlankCellWalkthrough}catch($a){}return!1}Tlf(ua){try{const $a=
za.L7a(ua);if(this.PX.kd($a))return this.PX.ma($a).HasCuratedData}catch($a){}return!1}m7j(ua){try{return this.QX(ua).SupportsStarterData}catch($a){}return!1}Wvf(ua){return 268435968===ua}Pod(){return 2===m.a(this.$).wR?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"}Xcc(){return new pb.a(-847286761,Oa.a.Bd,this.$.se,0,x.a.d4)}mTe(){if(this.AHb()&&!this.Xzd()&&!this.Jtf&&wb.EwaSettings.Ea(387)&&this.Tlf({Id:268435968,StringId:null}))if(b.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),
Hb.a.Bi.wU){const Va=this.Pod();if(Va){var ua=this.Xcc();if(ua){var $a={["InputMethod"]:Oa.a.Bd,CalloutName:6};$a.Target=Va;$a.ShouldCanvasTakeFocus=!0;this.$.Ha.Ad(ua,$a);this.Jtf=!0}else b.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else b.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else b.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")}Zsi(ua){ua=
this.Khd(ua);return ua?this.peb.I6g(ua.SubdomainFontLocator):(b.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)}Cpc(ua){return this.qxa?this.qxa.H6g(ua):!1}u2h(){return this.qxa?this.qxa.q3h():""}c7h(ua,$a){const Va=this.Xof(ua);if(0>Va)b.ULS.sendTraceTag(537166813,0,10,`Unexpected menuItemKey for dynamic preview gallery button: ${ua}`);else if(ua=(ua=this.OYe(ua))?this.QX(ua):null)$a[f.a.GalleryButtonProps]=
this.peb.j0h(Va,ua),$a[f.a.Alt]=this.peb.ypd(ua)}H9f(){this.mvg();this.AHb()&&this.V$d(!0);this.fbc()}rti(ua){return ua===this.k7e?v.a.l4e:ua===this.H$e?v.a.j4e:v.a.i4e}j5e(ua){try{return this.QX(ua).ExampleEntities}catch($a){}return nb.a.instance.ia(1805)}iUd(){(0>this.IQa||this.agb)&&b.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.ev||0>this.IQa||this.agb)&&window.clearInterval(this.Vmc);this.Xzd()?this.Knd&&this.$.frame.Lz(this.Knd):
this.V$d(this.AHb())}Xd(ua){return this.$.Pd+ua}Gik(){var ua=!0;const $a=Array(this.OLb),Va=m.a(this.$)?m.a(this.$).Fs:null;if(Va){for(let hb=0;hb<$a.length;++hb)this.HXj(hb)?$a[hb]=!0:ua=$a[hb]=!1;Va.Jgg(["ConvertToLinkedEntityGallery"],ua);if(!ua)for(ua=0;ua<$a.length;++ua)$a[ua]&&Va.Jgg([this.b7h(ua)],!0)}else b.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}QX(ua){const $a=za.L7a(ua);if(this.PX.kd($a))return this.PX.ma($a);b.ULS.sendTraceTag(592729218,
0,15,`No domain data for domain ID ${ua.Id} (Has String ID: ${!!ua.StringId})`);return null}b7h(ua){return"ConvertToLinkedEntityPreview"+ua.toString()}L$d(){u.a.get_instance().ik(10,()=>{this.mTe();this.k$c&&this.Zuf&&ec.c(this.PAf,this.$.ka,500)})}Imc(ua,$a){switch(ua){case "QueryLinkedEntityGalleryButtons":if(!$a[f.a.InnerHTML]){ua=$a[Oa.a.We].toString();const Va=sc.a.equals(ua,nb.a.instance.ia(1800),!0)||sc.a.equals(ua,nb.a.instance.ia(1801),!0),hb=sc.a.equals(ua,nb.a.instance.ia(1802),!0);Va||
hb||this.c7h(ua,$a)}break;case "QueryLinkedEntityMenuGalleryButtons":$a[f.a.InnerHTML]||($a[f.a.InnerHTML]=this.ulh($a[Oa.a.We]))}return $a}zCh(ua){var $a=this.OYe(ua);if($a)return $a;if($a=this.Khd(ua))return $a.DomainId;b.ULS.sendTraceTag(537166805,0,10,`Could not convert key into domain: ${ua}`);return null}NYe(ua){const $a={};$a.Id=ua;return this.QX($a)}Khd(ua){return this.PX.kd(ua)?this.PX.ma(ua):null}Xof(ua){if(!ua.startsWith(za.iid))return-1;const $a=parseInt(ua.substr(za.iid.length),10);return isNaN($a)?
(b.ULS.sendTraceTag(537166802,0,10,`Unexpected index in preview gallery button key: ${ua}`),-1):$a}OYe(ua){ua=this.Xof(ua);return 0>ua?null:this.Pya[ua]}Yqf(ua,$a,Va){if(this.PX&&this.PX.count){b.ULS.sendTraceTag(537166801,0,50,`ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. (${ua})`);var hb=this.$.qa.ua.ie();this.$.ea.oe&&(ua=this.$.qa.ua,$a=ob.b(this.Jaj,$a),hb=ua.Pa(1,void 0===hb?null:hb),G.g(ua,"LinkedEntityTryAutoRefresh",hb,$a,Va,null,null,0))}}cdk(){this.Yqf("Auto-refresh on load",
null,null)}hdk(){this.PX&&this.PX.count&&(this.UDa?b.ULS.sendTraceTag(537166799,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):this.$.ea.pp.HasAutoRefreshableLinkedEntityDomainsEver?(b.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.UDa=ib.a.instance.create(this.f$c,
this.Q9b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):b.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))}fJc(){if(this.$.ea.oe&&null!=this.ecb&&null!=this.ZBd&&null!=this.$Bd&&null!=this.iEd&&null!=this.mDd)if(++this.VMb,12>=this.VMb){1===this.VMb&&(this.Vud=bc.a.$b.og.m,b.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));
const ua=this.$.qa.ua.ie();cc.w(this.$.qa.ua,this.FPi,this.GPi(),this.Lbj,this.Kbj,null,ua)}else b.ULS.sendTraceTag(537166751,0,15,`StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration ${bc.a.$b.og.m-this.Vud} ms`),this.agb=!0,this.iUd()}TMe(){if(this.$.isEditMode)if(null!=this.ecb)this.fJc();else{var ua=bc.a.$b.og.m,$a=[];r.a.instance.Qd("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Va=>{Va.isFeatureEnabled("ExcelPowerBiPro",!1).then(hb=>
{b.ULS.sendTraceTag(537166747,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPro"} takes ${bc.a.$b.og.m-ua} Millisecond.`);b.ULS.sendTraceTag(537166746,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPro"}] isEnabled=[${hb}]`);return this.ecb=hb}).then(()=>{$a.push(Va.isFeatureEnabled("ExcelWolframAlpha",!1).then(hb=>{b.ULS.sendTraceTag(590960588,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelWolframAlpha"} takes ${bc.a.$b.og.m-ua} Millisecond.`);
b.ULS.sendTraceTag(537166743,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelWolframAlpha"}] isEnabled=[${hb}]`);return this.iEd=hb}))}).then(()=>{$a.push(Va.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(hb=>{b.ULS.sendTraceTag(537166741,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelDisableStockGeographyDataTypes"} takes ${bc.a.$b.og.m-ua} Millisecond.`);b.ULS.sendTraceTag(537166740,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelDisableStockGeographyDataTypes"}] isEnabled=[${hb}]`);
const qb=[Object(Ob.a)(new Lb.a,{name:"IsRestrictedByLicense",bool:hb})];vc.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,qb);this.Cxf=hb&&wb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return hb}))}).then(()=>{$a.push(Va.isFeatureEnabled("StockHistory",!1).then(hb=>{b.ULS.sendTraceTag(537166739,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"StockHistory"} takes ${bc.a.$b.og.m-ua} Millisecond.`);b.ULS.sendTraceTag(537166738,0,50,
`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"StockHistory"}] isEnabled=[${hb}]`);return this.mDd=hb}))}).then(()=>{$a.push(Va.isFeatureEnabled("ExcelPowerBiFree",!1).then(hb=>{b.ULS.sendTraceTag(537166736,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiFree"} takes ${bc.a.$b.og.m-ua} Millisecond.`);b.ULS.sendTraceTag(537166735,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiFree"}] isEnabled=[${hb}]`);return this.ZBd=hb}))}).then(()=>{$a.push(Va.isFeatureEnabled("ExcelPowerBiPremiumPerUser",
!1).then(hb=>{b.ULS.sendTraceTag(537166734,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPremiumPerUser"} takes ${bc.a.$b.og.m-ua} Millisecond.`);b.ULS.sendTraceTag(537166733,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPremiumPerUser"}] isEnabled=[${hb}]`);return this.$Bd=hb}))}).then(()=>{Promise.all($a).then(()=>{this.fJc()})})})}}get FPi(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}GPi(){return[this.ecb,
this.iEd,this.mDd,this.ZBd,this.$Bd,this.Cxf]}sVd(){this.businessBar&&this.businessBar.jpa(58)&&this.businessBar.removeEntry(58)}Tni(ua){if(this.YFd!==ua&&this.businessBar)if(this.YFd=ua){ua=this.$.qa.ua;var $a=this.F8i;const Va=ua.Pa(1,null);G.g(ua,"GetErrorMessageForLinkedDataTypeRefresh",Va,$a,null,null,null,4)}else this.sVd()}static o_h(ua,$a,Va,hb){ua=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',ua,$a,hb);Va=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',
Va);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',ua,Va)}static L7a(ua){return ua.StringId?ua.Id.toString()+"."+ua.StringId:ua.Id.toString()}}za.BZe="ConvertToLinkedEntityPreview";za.iid="PreviewGalleryButtonIndex.";za.Edb=0;za.tBf=2;Object(w.a)(za,"ConvertToLinkedEntityManager",t.a,[662,663,5,664])},884:function(w,C,a){a.d(C,"a",function(){return c});w=a(0);C=a(745);var b=a(93);class c extends C.a{constructor(h,k,d){super(h,k);this.gu=!0;this.command=
d}to(h){super.to(h);this.businessBar.$.Ha.Ad(new b.a(this.command,h,this.businessBar.$.se,10,null))}}Object(w.a)(c,"CommandActionBusinessBarEntry",C.a,[])},909:function(w,C,a){a.r(C);w=a(0);var b=a(2),c=a(14),h=a(362),k=a(34),d=a(11),f=a(276);class u{constructor(){this.scenario=null;this.timeElapsed=0;this.isNewSession=!1;this.rawData=null}}Object(w.a)(u,"ConnectionErrorLogInfo",null,[]);var r=a(1113),t=a(1114);class v{constructor(z){this.ywd=[r.a.zAg,r.a.tOc];this.ho=(y,B)=>{this.uR[B]=y;this.Cqi()&&
this.hFj("OnNetworkDownImmediatePing"===y.caller)};this.lqa=z;this.$=z.$;this.uR={}}xOi(){const z=t.a.cod(this.ho,"OnNetworkDownImmediatePing",this.$,this.ywd);for(const y of z)y.runTest()}Cqi(){for(const z of this.ywd)if(void 0===this.uR[z]||null===this.uR[z])return!1;return!0}hFj(z){const y=this.$.Ug.G9;z&&this.n6j(y);for(var B of this.ywd)this.uR[B]=Sys.Serialization.JavaScriptSerializer.serialize(this.uR[B]);z=Date.now();B=(()=>this.lqa.ktd(a(909).NetworkConnectionHealthChecker.GMb))().returnValue;
const G=(()=>this.lqa.ktd(a(909).NetworkConnectionHealthChecker.PTb))().returnValue;this.uR.isOfflineMode=y;this.uR.networkDownBBAge=-1===B?B:z-B;this.uR.transientServerCommunicationFailuresBBAge=-1===G?G:z-G;this.lqa.businessBar?(this.uR.isNetworkDownBBShown=this.lqa.businessBar.yH(56).toString(),this.uR.isServerErrorBBShown=this.lqa.businessBar.yH(21).toString()):(this.uR.isNetworkDownBBShown="unknown",this.uR.isServerErrorBBShown="unknown");c.ULS.sendTraceTag(537155224,0,50,`ConnectionHealthTestsRunner.ReportPingResults: ${Sys.Serialization.JavaScriptSerializer.serialize(this.uR)}`)}n6j(z){const {NetworkConnectionHealthChecker:y}=
a(909),B={};for(const G of Object.keys(this.uR)){const E=this.uR[G];B[E.testName]=E.isSuccess}B.isOfflineMode=z;this.lqa.k6d(y.Ecd,Sys.Serialization.JavaScriptSerializer.serialize(B))}}Object(w.a)(v,"ConnectionHealthTestsRunner",null,[]);var x=a(137),m=a(15),l=a(1);a.d(C,"NetworkConnectionHealthChecker",function(){return n});class n{constructor(z){this.businessBar=this.kdb=null;this.OLf=(y,B)=>{B.uhd?this.Y3i(B):this.X3i(B)};this.xj=(y,B)=>{y=B.context.methodName;this.kdb&&y===this.kdb&&(c.ULS.sendTraceTag(537155230,
0,50,`NetworkConnectionHealthChecker.OnWebMethodSuccess: Failed web method "${this.kdb}" has now succeeded. Querying local storage for BB showings.`),this.Pdb(n.PTb,!0),this.kdb=null);this.mDf(!1);this.ccc=!1};this.So=(y,B)=>{k.a.nj(B.errors,[-1387426400])&&!this.ccc&&(this.ccc=!0,this.$ig()&&window.performance.mark(n.yKf),(new v(this)).xOi())};this.Lh=()=>{this.mDf(!0);this.Pdb(n.GMb,!1);this.Pdb(n.PTb,!1)};this.xDa=()=>{this.Pdb(n.GMb,!0)};this.$=z;this.qa=this.$.qa;this.localStorage=new f.a;this.ccc=
!1;this.$.ea.Fl(this.Lh);this.qa.Ug.xub(this.xDa);this.qa.St(this.xj);l.EwaSettings.isChangeGateEnabled("OfficeVSO:8010793_ConvertBusinessBarManagerServiceStage2")?void x.a.KE(m.m).then(y=>{const B=this;return Io(function*(){B.businessBar=y;y.CBe(B.OLf)})}):this.$.ga.qd(5,y=>{this.businessBar=y;y.CBe(this.OLf)});this.qa.aA(this.So)}dispose(){this.$&&(this.$.ea&&this.$.ea.xo(this.Lh),this.qa&&(this.qa.Ug.DRb(this.xDa),this.qa.hB(this.So),this.qa.mv(this.xj)))}Y3i(z){const y={};y.Timestamp=Date.now().toString();
switch(z.p5a){case 21:this.kdb=z.data.FailedMethod;y.FailedMethod=this.kdb;this.k6d(n.PTb,JSON.stringify(y));break;case 56:this.k6d(n.GMb,JSON.stringify(y))}}X3i(z){switch(z.p5a){case 21:this.Pdb(n.PTb,!0);break;case 56:this.Pdb(n.GMb,!0)}}k6d(z,y){try{this.localStorage.Vh()&&this.localStorage.setItem(z,y)}catch(B){c.ULS.sendTraceTag(537155231,0,15,`NetworkConnectionHealthChecker.StoreDataInLocalStorage: Failed to set item to local storage. reason: ${B.message||"Unknown"}`)}}ktd(z){if(this.localStorage.Vh()&&
(z=this.localStorage.XPa(z))&&"null"!==z){var y=JSON.parse(z);z=parseInt(y.Timestamp,10);y=Sys.Serialization.JavaScriptSerializer.serialize(y);return{returnValue:z,rawData:y}}return{returnValue:-1,rawData:null}}mDf(z){if(this.localStorage.Vh()){const y=this.localStorage.XPa(n.Ecd);if(y&&"null"!==y){let B=-1;this.ccc&&(B=this.$6h(n.yKf,n.F2i));c.ULS.sendTraceTag(537155229,0,50,`NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: Ping Results: ${Sys.Serialization.JavaScriptSerializer.serialize(y)}, Period offline: ${B}, New session: ${z}`);
this.localStorage.removeItem(n.Ecd)}}}$6h(z,y){if(!this.$ig())return-1;window.performance.measure(y,z);z=window.performance.getEntriesByName(y);return z.length&&z[z.length-1]?z[z.length-1].duration:(c.ULS.sendTraceTag(537155228,0,10,`NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: measure name ${y} returned no measures.`),-1)}Pdb(z,y){try{let B;const G=(()=>{let E=this.ktd(z);({rawData:B}=E);return E})().returnValue;if(-1!==G){const E=Object(b.a)(new u,{timeElapsed:Date.now()-G,scenario:z,
isNewSession:!y,rawData:B});c.ULS.sendTraceTag(537155227,0,50,`NetworkConnectionHealthChecker.LogNetworkIssueBBShown: ${JSON.stringify(E)}`)}this.localStorage.removeItem(z)}catch(B){c.ULS.sendTraceTag(537155226,0,15,`NetworkConnectionHealthChecker.LogNetworkIssueBBShown: Failed to get item from local storage. reason: ${B.message||"Unknown"}`)}}$ig(){return d.HelperMethods.v$b&&h.a.f5a}}n.GMb="NetworkDownBBShown";n.PTb="ServerCommunicationFailureBBShown";n.Ecd="ConnectionHealthPingRsults";n.yKf="offMoStMa";
n.F2i="offMoDuMea";Object(w.a)(n,"NetworkConnectionHealthChecker",null,[5])},965:function(w,C,a){a.d(C,"a",function(){return d});w=a(0);var b=a(14),c=a(5),h=a(41),k=a(32);class d{static jaf(f,u){switch(f){case 3:return d.Fki(u);case 2:return d.Wci(u);case 1:return d.G7h(u)}return""}static Fki(f){switch(f){case 1:return c.AFrameworkApplication.da.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return c.AFrameworkApplication.da.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static Wci(f){switch(f){case 1:return c.AFrameworkApplication.da.appSettings.WildFireAdjustLinkPptWac.toString();
case 2:return c.AFrameworkApplication.da.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static G7h(f){switch(f){case 1:return c.AFrameworkApplication.da.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return c.AFrameworkApplication.da.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(f,u,r){if(k.a.Xi||k.a.Rp)window.setTimeout(()=>{d.K3f(r,d.rjf())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(d.$Ee(r),f,0,!1)}static Lhh(f,u,r,t){u&&
t&&t();d.openInClient(f,u,r)}static rjf(){return k.a.Xi?1:k.a.Rp?2:k.a.QSa?3:k.a.isMac?4:0}static get vIb(){return"zh-CN"===window.navigator.language}static K3f(f,u){1===u?(b.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),f=d.jaf(f,u),8<k.a.YFb?h.a.Sg(f,void 0,void 0,"RedirectToAppStore"):h.a.f2(f)):document.hidden||(d.vIb?(f=c.AFrameworkApplication.da.appSettings.WildFireUrlChinaStoreAndroid.toString())?(b.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),h.a.f2(f)):
b.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(b.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(d.jaf(f,u),null,null)))}static $Ee(f){switch(f){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get D3d(){return(k.a.QSa||k.a.isMac)&&k.a.Sp}static yaf(f){switch(f){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static AGi(f){return(f=
d.M$h(f))&&""!==f?Boolean.parse(f):!1}static B1d(f){d.CRj(f)}static M$h(f){try{return localStorage.getItem(f)}catch(u){return b.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+u.message),null}}static CRj(f){try{localStorage.setItem(f,"true")}catch(u){b.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+u.message)}}}d.wgh="ChromeExtensionBarDismiss";Object(w.a)(d,"WildFireUtilities",null,[])},999:function(w,
C,a){a.r(C);w=a(0);var b=a(14),c=a(237),h;(function(m){m[m.paren=0]="paren";m[m.lead=1]="lead";m[m.intern=2]="intern";m[m.trail=3]="trail";m[m.undefined=4]="undefined"})(h||(h={}));Object(w.b)("CurrencyFormatOption",h);var k;(function(m){m[m.none=-1]="none";m[m.mdy=0]="mdy";m[m.dmy=1]="dmy";m[m.ymd=2]="ymd";m[m.myd=3]="myd";m[m.dym=4]="dym";m[m.ydm=5]="ydm"})(k||(k={}));Object(w.b)("DateOrderOption",k);class d{constructor(m,l){({CalcHelper:m}=a(999));l&&(l.hh||b.ULS.shipAssertTag(537169942,0,!1,"LocaleHolder constructor - locale information is not available"));
this.AMg=m.qTe(l,m.$Se(l.Gna));this.BMg=excelOnlineCalc.calc.localeInfoFromData(this.localeData)}get localeInfo(){return this.BMg}get localeData(){return this.AMg}}Object(w.a)(d,"LocaleHolder",null,[]);var f=a(1128),u=a(56),r=a(1),t=a(22),v=a(114);a.d(C,"CalcHelper",function(){return x});class x{constructor(m){this.$=m;(this.ox=this.$.ga.Da(268))||b.ULS.shipAssertTag(537170070,0,!1,"CalcHelper constructor - IInstantaneousSupportInformationManager is not available");let l;l=r.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")?
u.a.current.tq(75):u.a.current.tq(78);this.logger=new f.a;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.fRi=new d(m,this.ox);excelOnlineCalc.config.initCalc(this.logger,this.ox?n=>this.ox.isFeatureEnabled(n):()=>!1,l);this.Nt=excelOnlineCalc.config.calcConfig(this.fRi.localeInfo)}get config(){return this.Nt}xvh(){if(r.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")){if(!this.$.va)return b.ULS.shipAssertTag(537170069,
0,!1,"CalcHelper.CurrentSheetIndex() - this.ewaControl.Sheets is null"),0;const m=this.$.va.na;return m?m.index:(b.ULS.shipAssertTag(537170068,0,!1,"CalcHelper.CurrentSheetIndex() - sheet is null"),0)}return this.$.va.na.index}createParser(){const m={};m.config=this.config;return excelOnlineCalc.parse.createParser(m)}createNumberFormatter(){const m=excelOnlineCalc.numfmt.createFormatGlobals(this.config,(l,n)=>excelOnlineCalc.calc.getTime(this.config,l,n,"Estimation"));return excelOnlineCalc.numfmt.createNumberFormatter(m)}Rth(m,
l,n,z){if(!z)return{range:{row:l,col:n},sheet:{document:this.documentLoc,index:m}};l=excelOnlineCalc.location.gridCell(l,n);m=excelOnlineCalc.location.sheetIndex(this.documentLoc,m);return excelOnlineCalc.location.sheetGridCell(m,l)}static qTe(m,l){l=void 0===l?null:l;const n=m.fqh(),z=m.hh.TrueValueString,y=m.hh.FalseValueString,B=m.hh.DecimalSeparator.toString(),G=m.hh.ListSeparator.toString(),E=m.hh.ColumnSeparator.toString(),J=m.hh.RowSeparator.toString(),I=m.hh.ThousandsDataArray,R=m.hh.ThousandSeparator.toString(),
X=m.hh.Lcid,H=m.hh.Country,M=m.hh.DigitsNumber,O=m.hh.ExpSeparatedBySpace,L=m.hh.FractionSeparator.toString(),S=m.hh.PercentSeparatedBySpace,T=t.a.geh(Enum.toString(h,m.hh.CurrencyFormat)),V=m.hh.CurrencySymbolLead,la=m.hh.CurrencySeparatedBySpace,Z=m.hh.CurrencySymbolString,da=m.hh.DigitsCurrency,ba=-1===m.hh.DateOrder?"MDY":v.e(Enum.toString(k,m.hh.DateOrder)),na=m.hh.DateSeparator.toString(),Y=m.hh.DateAlternativeSeparator.toString(),Ga=m.hh.Year4Digits,ma=m.hh.Month2Digits,fa=m.hh.Day2Digits,
Xa=m.hh.LongDateFormat,Ua=m.hh.TimeSeparator.toString(),ka=m.hh.TimeAltSeparator,nb=m.hh.Hour2Digits,Ea=m.hh.Use24HourClock,sb=m.hh.AmPmSeparatedBySpace,Oa=[m.hh.AmString,m.hh.PmString],La=m.hh.DayNameShortArray,ia=m.hh.DayNameLongArray,Sa=m.hh.MonthNameShortArray,Za=m.hh.MonthNameLongArray,Ab=m.hh.PictureSpecialArray,pb=c.a.map(("\x00"+m.hh.PictureSingleString).split(""),Kb=>"\x00"===Kb?null:Kb),Tb=m.hh.PictureColorArray,ob=m.hh.PictureDbnumArray,va=m.hh.RowLetter.toString(),Pa=m.hh.ColumnLetter.toString(),
jb=m.hh.LeftBrace.toString(),Ob=m.hh.RightBrace.toString(),kb=m.hh.LeftBracket.toString(),ra=m.hh.RightBracket.toString(),rb=x.xhi(m.hh);return excelOnlineCalc.calc.localeData(l,n,z,y,va,Pa,jb,Ob,kb,ra,B,G,E,J,I,R,X,H,M,O,L,S,T,V,la,Z,da,ba,na,Y,Ga,ma,fa,Xa,Ua,ka,nb,Ea,sb,Oa,La,ia,Sa,Za,Ab,pb,Tb,ob,rb,m.hh.SysDateFormatString,m.hh.SysTimeFormatString)}static $Se(m){const l=[];if(!m)return l;for(const n of m)m=null,n.IsDynamicUdf||(m=excelOnlineCalc.calc.worksheetFunctionName(n.FunctionIndexInServer,
n.NameUI)),m&&l.push(m);return l}static xhi(m){const l=Array(6);l[1]="#"+m.AllStructRefString;l[3]="#"+m.HeadersStructRefString;l[2]="#"+m.DataStructRefString;l[4]="#"+m.TotalsStructRefString;l[5]="#"+m.ThisRowStructRefString;return l}}Object(w.a)(x,"CalcHelper",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.pi.js.map/86b233aed286dbd7e57d2324a91324cd/EwaTS.pi.js.map