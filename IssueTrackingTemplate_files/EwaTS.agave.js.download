'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[11],{1004:function(w,C,a){a.r(C);w=a(0);var b=a(14),c=a(1386),h=a(176),k=a(118),d=a(753),f=a(772),u=a(357);class r{constructor(l,n,z,y){this.Eq=!1;this._id=l;this.Vz=n;this.I5=z;this.yf=y}get enabled(){return this.Eq}set enabled(l){const {DynamicRibbon:n}=a(1004);var z=this.yf.OwnerAddinStoreType?this.yf.OwnerAddinStoreType:this.yf.PrimaryMarketplace.MarketplaceType;const y=this.yf.PrimaryMarketplace.MarketplaceRef,
B=this.yf.AssetMarketplace?this.yf.AssetMarketplace.SolutionId:null,G=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Vz,z,null,null,null,y);z={["addinSolutionId"]:G,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.yf.OwnerAddinSolutionId,z,B,null,null,y),["ownerAddinStoreType"]:z,["ribbonControlType"]:"Button",["toggle"]:l};h.a.sendTelemetryEvent(Object.assign(new u.a,{name:n.rKc+"ControlUpdate",dataFields:k.a.$k(z)}));this.Eq=l;this.I5.wN(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:1,
["SolutionId"]:this.Vz,["PrivacyCompliantSolutionId"]:G,["SourceControlId"]:this.id,["MethodData"]:this.Eq})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(l){switch(l){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(l);}invokePropertyGetAsync(l){l=this.invokePropertyGet(l);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(l)}invokePropertySet(l,
n){switch(l){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(l);}invokePropertySetAsync(l,n){this.invokePropertySet(l,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(l,n){switch(l){case 5:return this.qQj(n);case 1:return this.rHa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(l);}invokeMethodAsync(l,n){l=this.invokeMethod(l,
n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(l)}qQj(l){l=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(l,0,"boolean");this.setEnabled(l);return null}rHa(){this._OnAccess();return null}}Object(w.a)(r,"RibbonButton",null,[]);class t{constructor(l,n,z,y){this._id=l;this.Vz=n;this.I5=z;this.yf=y}get id(){return this._id}setVisibility(l){const {DynamicRibbon:n}=a(1004),z=this.yf.OwnerAddinStoreType?this.yf.OwnerAddinStoreType:this.yf.PrimaryMarketplace.MarketplaceType;
var y=this.yf.PrimaryMarketplace.MarketplaceRef;const B=this.yf.AssetMarketplace?this.yf.AssetMarketplace.SolutionId:null,G=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Vz,z,B,null,null,y);y={["addinSolutionId"]:G,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.yf.OwnerAddinSolutionId,z,B,null,null,y),["ownerAddinStoreType"]:z,["ribbonControlType"]:"Tab",["toggle"]:l};h.a.sendTelemetryEvent(Object.assign(new u.a,{name:n.rKc+"ControlUpdate",dataFields:k.a.$k(y)}));this.I5.wN(-1014260128,
{["DynamicAddinCommandsMethodDispatchId"]:2,["SolutionId"]:this.Vz,["PrivacyCompliantSolutionId"]:G,["StoreType"]:z,["SourceControlId"]:this.id,["MethodData"]:l})}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(l){switch(l){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(l);}invokePropertyGetAsync(l){l=this.invokePropertyGet(l);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(l)}invokePropertySet(l){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(l);
}invokePropertySetAsync(l,n){this.invokePropertySet(l,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(l,n){switch(l){case 3:return this.nUj(n);case 1:return this.rHa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(l);}invokeMethodAsync(l,n){l=this.invokeMethod(l,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(l)}nUj(l){l=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(l,0,"boolean");this.setVisibility(l);
return null}rHa(){this._OnAccess();return null}}Object(w.a)(t,"RibbonTab",null,[]);var v=a(1029),x=a(186);a.d(C,"DynamicRibbon",function(){return m});class m{constructor(l,n,z,y,B){this.Vz=l;this.sJ=z;this.I5=y;this.yf=B;this.Znb=this.sJ.Vg;this.zB=this.Znb.getOsfControl(n);this.OMg=this.zB.getManifest()}get buttons(){return null}executeRequestCreate(l){try{var n=this.yf.OwnerAddinStoreType?this.yf.OwnerAddinStoreType:this.yf.PrimaryMarketplace.MarketplaceType;const y=this.yf.PrimaryMarketplace.MarketplaceRef,
B=this.yf.AssetMarketplace?this.yf.AssetMarketplace.SolutionId:null;var z=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Vz,n,B,null,null,y);const G={["addinSolutionId"]:z,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.yf.OwnerAddinSolutionId,n,B,null,null,y),["ownerAddinStoreType"]:this.yf.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};h.a.sendTelemetryEvent(Object.assign(new u.a,{name:m.rKc+"ExecuteRequestCreate",dataFields:k.a.$k(G)}));const E=x.a.Fk(l);l={};
n={};n[d.a.aOa]=this.zB;n[d.a.bOa]=E;n[d.a.eid]=this.yf;l[d.a.wAb]=3;l[d.a.X7]=this.Vz;l[d.a.agc]=z;l[d.a.W7]=n;this.I5.wN(-1014260128,l);let J=m.ujc("ExecuteRequestCreate",!0,"");b.ULS.sendTraceTag(538572826,0,50,J)}catch(y){z=m.ujc("ExecuteRequestCreate",!1,y.toString()),b.ULS.sendTraceTag(538572825,0,50,z)}return null}executeRequestUpdate(l){try{var n=this.yf.OwnerAddinStoreType?this.yf.OwnerAddinStoreType:this.yf.PrimaryMarketplace.MarketplaceType;const y=this.yf.PrimaryMarketplace.MarketplaceRef,
B=this.yf.AssetMarketplace?this.yf.AssetMarketplace.SolutionId:null;var z=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Vz,n,B,null,null,y);const G={["addinSolutionId"]:z,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.yf.OwnerAddinSolutionId,n,B,null,null,y),["ownerAddinStoreType"]:this.yf.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};h.a.sendTelemetryEvent(Object.assign(new u.a,{name:m.rKc+"ExecuteRequestUpdate",dataFields:k.a.$k(G)}));const E=x.a.Fk(l);l={};
n={};n[d.a.aOa]=this.zB;n[d.a.bOa]=E;n[d.a.eid]=this.yf;l[d.a.wAb]=3;l[d.a.X7]=this.Vz;l[d.a.agc]=z;l[d.a.W7]=n;this.I5.wN(-1014260128,l);let J=m.ujc("ExecuteRequestUpdate",!0,"");b.ULS.sendTraceTag(538572824,0,50,J)}catch(y){z=m.ujc("ExecuteRequestUpdate",!1,y.toString()),b.ULS.sendTraceTag(538572823,0,50,z)}return null}getButton(l){let n=null;if(!this.gtf())return this.hSe();if(l&&0<l.length){if(!this.bNe(l))return this.ASe(l);n=new r(l,this.Vz,this.I5,this.yf)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)}getTab(l){let n=
null;if(!this.gtf())return this.hSe();if(this.zB.getOwnerAddinControlRecreated())return this.Xqh();if(l&&0<l.length){if(!this.bNe(l))return this.ASe(l);n=new t(l,this.Vz,this.I5,this.yf)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(l){switch(l){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(l);}invokePropertyGetAsync(l){l=this.invokePropertyGet(l);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(l)}invokePropertySet(l){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(l);}invokePropertySetAsync(l,n){this.invokePropertySet(l,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(l){switch(l){case 1:return this.rHa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(l);}invokeMethodAsync(l,n){switch(l){case 7:return this.tSh(n);case 6:return this.uSh(n);case 3:return this.r3h(n);
case 5:return this.jii(n)}l=this.invokeMethod(l,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(l)}tSh(l){l=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(l,0,"string");return this.executeRequestCreate(l)}uSh(l){l=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(l,0,"string");return this.executeRequestUpdate(l)}r3h(l){l=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(l,0,"string");return this.getButton(l)}jii(l){l=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(l,
0,"string");return this.getTab(l)}rHa(){this._OnAccess();return null}ASe(l){return v.a(f.a.vmh,x.a.ia(1771)+l)}hSe(){return v.a(f.a.WHj,x.a.ia(1767))}Xqh(){return v.a(f.a.hostRestartNeeded,x.a.ia(1772))}gtf(){var l=this.zB.getSharedRuntimeId();l=!!l&&0<l.length;b.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",l));return l}bNe(l){const n=this.OMg.getRibbonExtensionControlMap();return l in n||this.Ofh(l)}Ofh(l){var n=this.SVh();if(n){n=n.CZe;
for(const z of n.tabs){if(z.id===l)return!0;for(const y of z.groups)for(const B of y.controls){if(B.id===l)return!0;if("Menu"===B.type){n=B;for(const G of n.items)if(G.id===l)return!0}}}}return!1}SVh(){return c.a.getInstance().nna(this.yf.PrimaryMarketplace.MarketplaceType,this.yf.PrimaryMarketplace.SolutionId,1)}static ujc(l,n,z){const y={};y.methodName="DynamicRibbon."+l;y.result=n?"Succeeded":"Failed";y.message=z;return x.a.He(y)}}m.rKc="Office.Online.Extensibility.Ribbon.";Object(w.a)(m,"DynamicRibbon",
null,[])},1025:function(w,C,a){a.d(C,"a",function(){return b});const b=(c,h)=>{let k=!1;c&&(c=h.osfControl,(h=c.getManifest())&&h.getSharedRuntimeForCustomFunctions("Workbook")&&!c.getIsUpgrading()&&(k=!0));return k}},1026:function(w,C,a){a.d(C,"a",function(){return b});w=a(0);class b{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.xla=this.tZa=this.Lqd=this.mtd=this.EEb=this.s7d=null}}Object(w.a)(b,"AppsForOfficeOauthResult",null,[])},1029:function(w,C,a){a.d(C,"a",function(){return b});
const b=(c,h)=>OfficeExtension.WacRuntime.Utility.createPromise((k,d)=>{d(OfficeExtension.WacRuntime.Utility.createRichApiException(c,h))})},1180:function(w,C,a){a.r(C);w=a(0);var b=a(2),c=a(14),h=a(5),k=a(179),d=a(198),f=a(138),u=a(200),r=a(59),t=a(53),v=a(38),x=a(238),m=a(125),l=a(540);class n{constructor(Ea){Ea=Ea.split("|");this.Vz=Ea[1];this.p1c=Ea[2];this.n6d=Ea[3]}get solutionId(){return this.Vz}get solutionVersion(){return this.p1c}get needToRestoreManifest(){return this.n6d===OSF.StoreTypeEnum.Registry.toString()}}
Object(w.a)(n,"AddinStoreInfo",null,[]);class z{}Object(w.a)(z,"CustomFunctionRegistrationInfos",null,[]);var y=a(207),B=a(78);const G=(Ea,sb,Oa)=>E(Ea,sb,y.a.none,B.a.current,Oa),E=(Ea,sb,Oa,La,ia)=>{Oa=Ea.continueWith(()=>{sb(Ea)},3,Oa,La);Oa.continueWith(()=>{c.ULS.sendTraceTag(537163463,0,10,ia)},4);return Oa},J=(Ea,sb,Oa)=>I(Ea,sb,y.a.none,B.a.current,Oa),I=(Ea,sb,Oa,La,ia)=>{Oa=Ea.Vr(()=>sb(Ea),3,Oa,La);Oa.continueWith(()=>{c.ULS.sendTraceTag(537163462,0,10,ia)},4);return v.TaskExtensions.VLc(Oa)},
R=(Ea,sb,Oa)=>X(Ea,sb,y.a.none,B.a.current,Oa),X=(Ea,sb,Oa,La,ia)=>{Oa=Ea.Vr(()=>sb(Ea),3,Oa,La);Oa.continueWith(()=>{c.ULS.sendTraceTag(537163461,0,10,ia)},4);return Oa},H=(Ea,sb,Oa)=>M(Ea,sb,y.a.none,B.a.current,Oa),M=(Ea,sb,Oa,La,ia)=>{Oa=Ea.Vr(()=>sb(Ea),3,Oa,La);Oa.continueWith(()=>{c.ULS.sendTraceTag(537163460,0,10,ia)},4);return v.TaskExtensions.VLc(Oa)},O=(Ea,sb,Oa)=>L(Ea,sb,y.a.none,B.a.current,Oa),L=(Ea,sb,Oa,La,ia)=>{Oa=Ea.continueWith(()=>{sb(Ea)},3,Oa,La);Oa.continueWith(()=>{c.ULS.sendTraceTag(537163459,
0,10,ia)},4);return Oa},S=(Ea,sb)=>{R(a(1180).CustomFunctionsInstaller.Hef("CustomFunctionsRuntimeLogging"),Oa=>{if(Oa.result&&window.console)switch(Oa=T(Ea.severity)+" "+Ea.message+sb,Ea.severity){case 2:window.console.log&&window.console.log(Oa);break;case 0:window.console.info&&window.console.info(Oa);break;case 1:window.console.error&&window.console.error(Oa)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")},T=Ea=>{switch(Ea){case 0:return"Medium";
case 1:return"Unexpected";case 2:return"Verbose";default:return""}};var V=a(1025);class la{}Object(w.a)(la,"InstallationInfo",null,[]);class Z{}Object(w.a)(Z,"UninstallationInfo",null,[]);var da=a(33),ba=a(93),na=a(40),Y=a(34),Ga=a(1),ma=a(22),fa=a(247),Xa=a(836),Ua=a(62);class ka{constructor(Ea,sb){this.O0c=Ea;this._message=sb}get severity(){return this.O0c}get message(){return this._message}}Object(w.a)(ka,"CustomFunctionLog",null,[]);a.d(C,"CustomFunctionsInstaller",function(){return nb});class nb{constructor(Ea,
sb,Oa){this.y9=!1;this.kI={};this.$=Ea;this.Dl=sb;this.hyd().$ra();this.indexedDB=Oa;this.indexedDB.Vh()&&(this.y9=!0,this.indexedDB.initialize(nb.uGb,nb.vGb))}get LY(){return this.Dl.LY}sqf(Ea,sb,Oa,La){if(La.invariantNamespace)for(let ia=0;ia<La.invariantNamespace.length;++ia){const Sa=La.invariantNamespace.charAt(ia);if("."!==Sa&&"_"!==Sa&&"a">Sa&&"z"<Sa&&"A">Sa&&"Z"<Sa&&"0">Sa&&"9"<Sa)throw c.ULS.sendTraceTag(537163552,0,10,`CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='${Sa}', Position=${ia}.`),
Error.create("InvariantNamespace validation failed");}return J(this.ach(Oa,La.manifest),()=>J(this.xTd(Ea),ia=>{let Sa=ia.result;return(null===Sa||void 0===Sa?0:Sa.isDynamicMetadata)?this.wUd(Ea,sb,Sa,!1,!1,!1):J(this.upk(Ea,sb,La),Za=>{Sa=new la;Sa.addinId=Oa;Sa.locale=La.locale;Sa.addinInvariantNamespace=La.invariantNamespace;Sa.addinNamespace=La.namespace;Sa.addinTitle=La.title;Sa.isXllCompatible=La.isXllCompatible;Sa.metadataContent=JSON.stringify(JSON.parse(Za.result));return this.wUd(Ea,sb,
Sa,!1,nb.tTh(La.osfControl.getStoreType()),V.a(this.$,La))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed"),"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")}uqf(Ea,sb,Oa,La){if(!nb.SDd(Oa))throw c.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");
return J(this.xTd(Ea),ia=>{ia=ia.result;if(!ia&&(ia=na.a.kf(this.LY,Ea),!ia))throw c.ULS.sendTraceTag(537163550,0,10,`CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ea,sb,null)} hasn't been installed yet.`),Error.create("Customfunctions dynamic registration failed");ia.metadataContent=JSON.stringify(JSON.parse(Oa));ia.isDynamicMetadata=!0;return this.wUd(Ea,sb,ia,!0,!0,La)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")}Itg(Ea,
sb){this.Dl.Yma();const Oa=Object(b.a)(new Z,{solutionId:Ea}),La=`CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ea,sb,null)}.`;return J(this.bVd(Ea),()=>J(this.jVd(Ea),()=>this.P9d(this.Dl,Ea,sb,Oa),"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed"),La)}upk(Ea,sb,Oa){const La=new k.a;OSF.OUtil.xhrGet(Oa.metadataUrl,ia=>{ia?La.setResult(ia):La.setException(Error.create("Invalid manifest"))},
ia=>{c.ULS.sendTraceTag(537163548,0,10,`CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ea,sb,null)}. ErrorCode: ${ia}.`);La.ww()});return La.task}hyd(){return J(this.PBc(),Ea=>{const sb=Ea.result;if(!sb.length)return Ua.Task.Wa(!0);c.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");Ea=new d.a;const Oa=[];for(let La=
0;La<sb.length;La++){const ia=Object(f.a)(String,sb[La]);Ea.add(R(this.xTd(ia),Sa=>{if(Sa=Sa.result){const Za=na.a.kf(this.kI,Sa.addinId);Za&&Za===Sa.metadataContent||(this.kI[Sa.addinId]=Sa.metadataContent,this.LY[ia]=Sa,Oa.push(Sa))}return!0},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"))}return H(Ua.Task.WhenAllEnumerable(Ea),()=>{if(Oa.length){let La=new z;La.registrationInfos=Oa;return this.W9b(this.Dl,sb,La)}c.ULS.sendTraceTag(537163546,0,
50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return Ua.Task.Wa(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")}vqf(){var Ea=new k.a;new d.a;const sb=[],Oa=[];Object.keys(this.LY).forEach(La=>{La=Object(f.a)(String,La);const ia=na.a.kf(this.LY,La);sb.push(ia);Oa.push(La)});if(!Oa.length)return Ea.setResult(!0),Ea.task;Ea=Object(b.a)(new z,
{registrationInfos:sb});return this.W9b(this.Dl,Oa,Ea)}PBc(){return R(this.drd(l.a.T3a),Ea=>{Ea=Ea.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(Ea||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(Ea||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")}Nzg(Ea){return this.U0d(l.a.T3a,Sys.Serialization.JavaScriptSerializer.serialize(Ea))}xTd(Ea){return J(this.drd(l.a.g$a(Ea)),sb=>{sb=sb.result||
"";return 0<sb.length?Ua.Task.Wa(Sys.Serialization.JavaScriptSerializer.deserialize(sb,!0)):Ua.Task.Wa(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")}mpk(Ea,sb){return J(this.j0e(Ea),()=>J(this.U0d(l.a.g$a(Ea),Sys.Serialization.JavaScriptSerializer.serialize(sb)),()=>nb.V0d(l.a.ivd,"true"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")}bVd(Ea){return J(this.w5f(Ea),
()=>J(this.O5f(l.a.g$a(Ea)),()=>J(this.PBc(),sb=>sb.result.length?Ua.Task.Wa(!0):nb.V0d(l.a.ivd,"false"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}Q2f(Ea){return this.drd(l.a.f$a(Ea))}Jzg(Ea,sb){return J(this.j0e(Ea),
()=>this.U0d(l.a.f$a(Ea),sb),"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")}jVd(Ea){return J(this.w5f(Ea),()=>this.O5f(l.a.f$a(Ea)),"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}j0e(Ea){return J(this.PBc(),sb=>{sb=sb.result;const Oa=Ea.toLowerCase();if(sb.includes(Oa))return Ua.Task.Wa(!0);sb.push(Oa);return this.Nzg(sb)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}w5f(Ea){return J(this.PBc(),
sb=>{sb=sb.result;const Oa=Ea.toLowerCase();return sb.includes(Oa)?(sb.splice(Array.indexOf(sb,Oa),1),this.Nzg(sb)):Ua.Task.Wa(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}ach(Ea,sb){if(Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return Ea=new OSF.AddinIdInfo(Ea),Ea.needToRestoreManifest()?this.Jzg(Ea.getSolutionId(),sb):Ua.Task.Wa(!0);Ea=new n(Ea);return Ea.needToRestoreManifest?this.Jzg(Ea.solutionId,
sb):Ua.Task.Wa(!0)}zHj(Ea){if(Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){const Oa=new OSF.AddinIdInfo(Ea);return Oa.needToRestoreManifest()?R(this.Q2f(Oa.getSolutionId()),La=>{(La=La.result)&&OSF.OsfManifestManager.cacheManifestFromXml(Oa.getSolutionId(),Oa.getSolutionVersion(),La,this.$.xa.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):Ua.Task.Wa(!0)}const sb=new n(Ea);return sb.needToRestoreManifest?
R(this.Q2f(sb.solutionId),Oa=>{(Oa=Oa.result)&&OSF.OsfManifestManager.cacheManifestFromXml(sb.solutionId,sb.solutionVersion,Oa,this.$.xa.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):Ua.Task.Wa(!0)}O5f(Ea){return this.y9?this.indexedDB.Jgd(Ea):nb.Gzj(Ea)}U0d(Ea,sb){return this.y9?this.indexedDB.mXa(new Xa.a(Ea,sb)):nb.V0d(Ea,sb)}drd(Ea){return this.y9?this.indexedDB.OPa(Ea):nb.Hef(Ea)}wUd(Ea,sb,Oa,La,ia,Sa){const Za=`CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ea,
sb,null)}.`;return v.TaskExtensions.VLc(R(this.xUd(this.Dl,Ea,sb,Oa,!1,La,Sa),()=>ia?this.mpk(Ea,Oa):Ua.Task.Wa(!0),Za))}xUd(Ea,sb,Oa,La,ia,Sa,Za){if(!Sa&&(Sa=na.a.kf(this.kI,La.addinId))&&Sa===La.metadataContent)return Ua.Task.Wa(!0);this.kI[La.addinId]=La.metadataContent;this.LY[sb]=La;Za||Ea.jRb(sb);Ea.Yma();return J(this.Qwj(sb,Oa,La),()=>this.gSd(La.addinId,ia),"Failed to register functions for customfunction addin")}Qwj(Ea,sb,Oa){const La=new k.a,ia=this.dMa(Oa);return this.j8(Sa=>{S(nb.pzb,
Ea);(Sa=Sa.Result)&&204===Sa.ResponseStatusCode?La.setResult(!0):(delete this.kI[Oa.addinId],delete this.LY[Ea],G(this.bVd(Ea),()=>{G(this.jVd(Ea),()=>{this.hkg()},"Failed to show customfunctions installation error info")},`CustomFunctionsInstaller: Failed to register Custom Functions for solution: ${Ea}. Received status code ${Sa?Sa.ResponseStatusCode.toString():"Unknown"}.`),La.setResult(!1))},Sa=>{Sa=m.a.Lg(Sa.data);c.ULS.sendTraceTag(537163544,0,10,`CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ea,
sb,null)}. Errors: ${Y.a.ue(Sa)}.`);S(nb.ozb,Ea);delete this.kI[Oa.addinId];delete this.LY[Ea];La.setResult(!1)},ia,La,!0)}W9b(Ea,sb,Oa){const La=new k.a,ia=da.a.$b.og.m;sb.forEach(Za=>{Za=Object(f.a)(String,Za);Ea.KMe(Za)});Ea.Yma();const Sa=this.r9c(Oa);return this.j8(Za=>{S(nb.pzb,Sys.Serialization.JavaScriptSerializer.serialize(sb));Za=Za.Result;let Ab=!0;var pb=[];Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7667457_responseBody"),pb=Sys.Serialization.JavaScriptSerializer.deserialize(Za.ResponseBody.toString()),
pb=Array.isArray(pb.value)?pb.value:null;const Tb=new d.a;for(let ob=0;ob<pb.length;ob++)if(!pb[ob]){Ab=!1;const va=`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code ${Za.ResponseStatusCode}.`;Tb.add(J(this.bVd(sb[ob]),()=>{delete this.kI[Oa.registrationInfos[ob].addinId];delete this.LY[sb[ob]];return this.jVd(sb[ob])},va))}O(Ua.Task.WhenAllEnumerable(Tb),()=>{G(this.gSd("",!1),()=>{c.ULS.sendTraceTag(537163542,0,50,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes ${da.a.$b.og.m-
ia} Millisecond.`);Ab?La.setResult(Ab):O(this.hkg(),()=>{La.setResult(Ab)},"Failed to show customfunctions installation error info")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},Za=>{Za=m.a.Lg(Za.data);c.ULS.sendTraceTag(537163541,0,10,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: ${Y.a.ue(Za)}.`);
S(nb.ozb,Sys.Serialization.JavaScriptSerializer.serialize(sb));for(Za=0;Za<Oa.registrationInfos.length;Za++)delete this.kI[Oa.registrationInfos[Za].addinId],delete this.LY[sb[Za]];La.setResult(!1)},Sa,La,!0)}P9d(Ea,sb,Oa,La){return J(this.vfk(Ea,sb,Oa,La),()=>this.gSd(La.solutionId,!1),"Failed to unregister functions for customfunction addin")}vfk(Ea,sb,Oa,La){const ia=new k.a;Ea.jRb(sb);(Ea=na.a.kf(this.LY,sb))&&delete this.kI[Ea.addinId];delete this.LY[sb];La=this.E9c(La);return this.j8(()=>{S(nb.Jfd,
sb);ia.setResult(!0)},Sa=>{Sa=m.a.Lg(Sa.data);c.ULS.sendTraceTag(537163539,0,10,`CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(sb,Oa,null)}. Errors: ${Y.a.ue(Sa)}.`);S(nb.Ifd,sb);ia.setResult(!1)},La,ia,!1)}j8(Ea,sb,Oa,La,ia){const Sa=this.$.userOperationManager,Za=this.$.qa;let Ab=null,pb=null,Tb=null;const ob=()=>{if(Sa.aNa()||0<Za.ua.k8||0<Za.an.k8)return!1;Ab&&Sa.Ap(Ab);pb&&Za.mv(pb);
Tb&&Za.hB(Tb);const va=Oa.request;let Pa=0;Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?va.RequestFlags&1&&256!==(va.RequestFlags&256)||(Pa=16):Pa=va.RequestFlags&1?0:16;Sa.OH(new u.a(507,0,(jb,Ob,kb)=>{S(ia?nb.Hfd:nb.Kfd,va.RequestBody);return r.g(Za.ua,"ExecuteRichApiRequest",Oa,fa.b(jb,Ea),fa.a(Ob,sb),kb,null,0)},Pa|64));return!0};ob()||(Ab=()=>{ob()},pb=()=>{ob()},Tb=()=>{ob()},Sa.Pr(Ab),Za.St(pb),Za.aA(Tb));return La.task}dMa(Ea){const sb={HttpMethod:"POST",
PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};sb.RequestBody=JSON.stringify(Ea);sb.RequestFlags=1;Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(sb.RequestFlags|=256);Ea=this.$.qa.ua.Pa(1);Ea.request=sb;return Ea}r9c(Ea){const sb={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};sb.RequestBody=JSON.stringify(Ea);sb.RequestFlags=1;Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&
(sb.RequestFlags|=256);Ea=this.$.qa.ua.Pa(1);Ea.request=sb;return Ea}E9c(Ea){const sb={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};sb.RequestBody=JSON.stringify(Ea);sb.RequestFlags=1;Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(sb.RequestFlags|=256);Ea=this.$.qa.ua.Pa(1);Ea.request=sb;return Ea}gSd(Ea,sb){const Oa=t.GetServiceTaskFactory.create(this.$.ga,153,this.$.ka,1);return I(Oa,()=>{Oa.result.xXd();return Ea&&sb?
this.zHj(Ea):Ua.Task.Wa(!0)},this.$.ka,x.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")}hkg(){const Ea=new ba.a(1949669462,0,this.$.se,0,null);return this.$.Ha.Ad(Ea)}static Hef(Ea){try{return Ua.Task.Wa(localStorage.getItem(Ea))}catch(sb){return c.ULS.sendTraceTag(537163537,0,50,`CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: ${sb.message||"Unknown"}`),Ua.Task.Wa(null)}}static V0d(Ea,
sb){try{return localStorage.setItem(Ea,sb),Ua.Task.Wa(!0)}catch(Oa){return c.ULS.sendTraceTag(537163536,0,50,`CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: ${Oa.message||"Unknown"}`),Ua.Task.Wa(!1)}}static Gzj(Ea){try{return localStorage.removeItem(Ea),Ua.Task.Wa(!0)}catch(sb){return c.ULS.sendTraceTag(537163535,0,50,`CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: ${sb.message||"Unknown"}`),
Ua.Task.Wa(!1)}}static tTh(Ea){return ma.a.equals(Ea,"registry",!0)||ma.a.equals(Ea,"uploadfiledevcatalog",!0)||h.AFrameworkApplication.userNameUnknown||h.AFrameworkApplication.limitedEdit}static SDd(Ea){if(!Ea)return!1;try{JSON.parse(Ea)}catch(sb){return!1}return!0}}nb.uGb="CustomFunctionCache";nb.vGb="CustomFunction";nb.Hfd=new ka(2,"CustomFunctions [Registration] [Begin] SolutionId=");nb.pzb=new ka(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");nb.ozb=new ka(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
nb.Kfd=new ka(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");nb.Jfd=new ka(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");nb.Ifd=new ka(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(w.a)(nb,"CustomFunctionsInstaller",null,[803])},1183:function(w,C,a){a.r(C);w=a(0);var b=a(2),c=a(14),h=a(995),k=a(179),d=a(138),f=a(200),u=a(59),r=a(53),t=a(38),v=a(125),x=a(540),m=a(1025);class l{constructor(T){T=T.split("|");this.Vz=T[1];this.p1c=T[2];this.n6d=
T[3]}get solutionId(){return this.Vz}get solutionVersion(){return this.p1c}get needToRestoreManifest(){return this.n6d===OSF.StoreTypeEnum.Registry.toString()}}Object(w.a)(l,"AddinStoreInfo",null,[]);class n{}Object(w.a)(n,"CustomFunctionRegistrationInfos",null,[]);const z=(T,V)=>{if(a(1183).CustomFunctionsLegacyInstaller.RDb("CustomFunctionsRuntimeLogging")&&window.console)switch(V=y(T.severity)+" "+T.message+V,T.severity){case 2:window.console.log&&window.console.log(V);break;case 0:window.console.info&&
window.console.info(V);break;case 1:window.console.error&&window.console.error(V)}},y=T=>{switch(T){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};class B{}Object(w.a)(B,"InstallationInfo",null,[]);class G{}Object(w.a)(G,"UninstallationInfo",null,[]);var E=a(185),J=a(40),I=a(34),R=a(1),X=a(16),H=a(247),M=a(923),O=a(62);class L{constructor(T,V){this.O0c=T;this._message=V}get severity(){return this.O0c}get message(){return this._message}}Object(w.a)(L,"CustomFunctionLog",
null,[]);a.d(C,"CustomFunctionsLegacyInstaller",function(){return S});class S{constructor(T){this.kI={};this.$=T;this.hyd().$ra()}sqf(T,V,la,Z){const da=new k.a;if(Z.invariantNamespace)for(V=0;V<Z.invariantNamespace.length;++V){const na=Z.invariantNamespace.charAt(V);if("."!==na&&"_"!==na&&"a">na&&"z"<na&&"A">na&&"Z"<na&&"0">na&&"9"<na)return c.ULS.sendTraceTag(537163530,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='${na}', Position=${V}.`),da.setResult(!1),
da.task}S.cacheManifest(la,Z.manifest);let ba=S.yTd(T);(null===ba||void 0===ba?0:ba.isDynamicMetadata)?this.vUd(T,ba,da,!1,!1):OSF.OUtil.xhrGet(Z.metadataUrl,na=>{ba=Object(b.a)(new B,{addinId:la,locale:Z.locale,addinInvariantNamespace:Z.invariantNamespace,addinNamespace:Z.namespace,addinTitle:Z.title,isXllCompatible:Z.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(na))});this.vUd(T,ba,da,!1,m.a(this.$,Z))},na=>{c.ULS.sendTraceTag(537163528,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution ${T}. ErrorCode: ${na}.`);
da.setResult(!1)});return da.task}uqf(T,V,la,Z){V=new k.a;if(!S.SDd(la))return c.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),V.setResult(!1),V.task;const da=S.yTd(T);if(!da)return c.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),V.setResult(!1),V.task;da.metadataContent=JSON.stringify(JSON.parse(la));da.isDynamicMetadata=
!0;this.vUd(T,da,V,!0,Z);return V.task}Itg(T){const V=new k.a,la=r.GetServiceTaskFactory.create(this.$.ga,106,this.$.ka,1);t.TaskExtensions.za(la,()=>{const Z=la.result;Z.Yma();const da=Object(b.a)(new G,{solutionId:T});S.cVd(T);S.kVd(T);t.TaskExtensions.za(this.P9d(Z,T,da),ba=>{E.b(ba)?V.setResult(ba.result):(ba.Kh?c.ULS.sendTraceTag(537163524,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${T}.`):ba.qj&&c.ULS.sendTraceTag(537163523,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: ${T}.`),
V.setResult(!1))},this.$.ka,0)},this.$.ka,3);return V.task}hyd(){const T=new k.a,V=S.DTd();0<V.length&&c.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");const la=[];V.forEach(da=>{da=Object(d.a)(String,da);if(da=S.yTd(da)){const ba=J.a.kf(this.kI,da.addinId);ba&&ba===da.metadataContent||(this.kI[da.addinId]=da.metadataContent,la.push(da))}});if(!la.length)return T.setResult(!0),c.ULS.sendTraceTag(537163521,
0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),T.task;const Z=r.GetServiceTaskFactory.create(this.$.ga,106,this.$.ka,1);t.TaskExtensions.za(Z,()=>{const da=Z.result,ba=Object(b.a)(new n,{registrationInfos:la});t.TaskExtensions.za(this.W9b(da,V,ba),na=>{E.b(na)?T.setResult(na.result):(na.Kh?c.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):na.qj&&c.ULS.sendTraceTag(537163490,
0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),T.setResult(!1))},this.$.ka,0)},this.$.ka,3);return T.task}yHj(T){T=new l(T);if(T.needToRestoreManifest){const V=S.fuj(T.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(T.solutionId,T.solutionVersion,V,this.$.xa.UICultureTag)}}vUd(T,V,la,Z,da){const ba=r.GetServiceTaskFactory.create(this.$.ga,106,this.$.ka,1);t.TaskExtensions.za(ba,()=>{t.TaskExtensions.za(this.xUd(ba.result,T,V,!1,Z,da),
na=>{E.b(na)?((na=na.result)&&S.npk(T,V),la.setResult(na)):(na.Kh?c.ULS.sendTraceTag(537163488,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: ${T}.`):na.qj&&c.ULS.sendTraceTag(537163487,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: ${T}.`),la.setResult(!1))},this.$.ka,0)},this.$.ka,3)}xUd(T,V,la,Z,da,ba){if(!da&&(da=J.a.kf(this.kI,la.addinId))&&da===la.metadataContent)return O.Task.Wa(!0);
this.kI[la.addinId]=la.metadataContent;const na=new k.a;ba||T.jRb(V);T.Yma();T=this.dMa(la);return this.j8(Y=>{z(S.pzb,V);const Ga=Y.Result;204===Ga.ResponseStatusCode?t.TaskExtensions.za(this.fSd(na,la.addinId,Z),ma=>{ma.Kh?V?c.ULS.sendTraceTag(537163485,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${V}.`):c.ULS.sendTraceTag(537163484,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId ${la.addinId}.`):
ma.qj&&(V?c.ULS.sendTraceTag(537163483,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution ${V}.`):c.ULS.sendTraceTag(537163482,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId ${la.addinId}.`));na.setResult(!1)},this.$.ka,4):(Y=()=>{delete this.kI[la.addinId];S.cVd(V);S.kVd(V);c.ULS.sendTraceTag(537163481,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: ${V}. Received status code ${Ga.ResponseStatusCode}.`);
na.setResult(!1)},Y=Object(b.a)(new M.a,{lRa:OSF.InfoType.Error,title:la.addinTitle,description:String.format(X.a.instance.xd(153),X.a.instance.ia(1892)),buttonText:X.a.instance.ia(4),Pla:Y,Hnc:!1,Mma:Y,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),h.a.J3d(Y))},Y=>{Y=v.a.Lg(Y.data);c.ULS.sendTraceTag(537163480,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${V}. Errors: ${I.a.ue(Y)}.`);z(S.ozb,V);delete this.kI[la.addinId];
na.setResult(!1)},T,na,!0)}W9b(T,V,la){const Z=new k.a;V.forEach(ba=>{ba=Object(d.a)(String,ba);T.KMe(ba)});T.Yma();const da=this.r9c(la);return this.j8(ba=>{z(S.pzb,Sys.Serialization.JavaScriptSerializer.serialize(V));ba=ba.Result;let na=!0;var Y=[];R.EwaSettings.isChangeGateEnabled("OfficeVSO:7667457_responseBody"),Y=Sys.Serialization.JavaScriptSerializer.deserialize(ba.ResponseBody.toString()),Y=Array.isArray(Y.value)?Y.value:null;for(let Ga=0;Ga<Y.length;Ga++)Y[Ga]||(na=!1,delete this.kI[la.registrationInfos[Ga].addinId],
S.cVd(V[Ga]),S.kVd(V[Ga]),c.ULS.sendTraceTag(537163478,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: ${V[Ga]}. Received status code ${ba.ResponseStatusCode}.`));t.TaskExtensions.za(this.fSd(Z,"",!1),Ga=>{Ga.Kh?c.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):Ga.qj&&c.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");
Z.setResult(!1)},this.$.ka,4);Z.setResult(na)},ba=>{ba=v.a.Lg(ba.data);c.ULS.sendTraceTag(537163475,0,10,`CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds ${Sys.Serialization.JavaScriptSerializer.serialize(V)}. Errors: ${I.a.ue(ba)}.`);z(S.ozb,Sys.Serialization.JavaScriptSerializer.serialize(V));for(const na of la.registrationInfos)delete this.kI[na.addinId];Z.setResult(!1)},da,Z,!0)}P9d(T,V,la){const Z=new k.a;T.jRb(V);T=this.E9c(la);
return this.j8(()=>{z(S.Jfd,V);t.TaskExtensions.za(this.fSd(Z,la.solutionId,!1),da=>{da.Kh?V&&c.ULS.sendTraceTag(537163473,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${V}.`):da.qj&&V&&c.ULS.sendTraceTag(537163472,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution ${V}.`);Z.setResult(!1)},this.$.ka,4)},da=>{da=v.a.Lg(da.data);c.ULS.sendTraceTag(537163471,
0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${V}. Errors: ${I.a.ue(da)}.`);z(S.Ifd,V);Z.setResult(!1)},T,Z,!1)}j8(T,V,la,Z,da){const ba=this.$.userOperationManager,na=this.$.qa;let Y=null,Ga=null,ma=null;const fa=()=>{if(ba.aNa()||0<na.ua.k8||0<na.an.k8)return!1;Y&&ba.Ap(Y);Ga&&na.mv(Ga);ma&&na.hB(ma);const Xa=la.request;ba.OH(new f.a(507,0,(Ua,ka,nb)=>{z(da?S.Hfd:S.Kfd,Xa.RequestBody);return u.g(na.ua,"ExecuteRichApiRequest",
la,H.b(Ua,T),H.a(ka,V),nb,null,0)},(Xa.RequestFlags&1?0:16)|64));return!0};fa()||(Y=()=>{fa()},Ga=()=>{fa()},ma=()=>{fa()},ba.Pr(Y),na.St(Ga),na.aA(ma));return Z.task}dMa(T){const V={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};V.RequestBody=JSON.stringify(T);V.RequestFlags=1;T=this.$.qa.ua.Pa(1);T.request=V;return T}r9c(T){const V={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};V.RequestBody=JSON.stringify(T);V.RequestFlags=1;T=
this.$.qa.ua.Pa(1);T.request=V;return T}E9c(T){const V={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};V.RequestBody=JSON.stringify(T);V.RequestFlags=1;T=this.$.qa.ua.Pa(1);T.request=V;return T}fSd(T,V,la){const Z=r.GetServiceTaskFactory.create(this.$.ga,153,this.$.ka,1);t.TaskExtensions.za(Z,()=>{Z.result.xXd();V&&la&&this.yHj(V);T.setResult(!0)},this.$.ka,3);return Z}vqf(){return O.Task.Wa(!0)}static DTd(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(S.RDb(x.a.T3a)||
"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(S.RDb(x.a.T3a)||"[]"):null)||[]}static Ozg(T){S.W0d(x.a.T3a,Sys.Serialization.JavaScriptSerializer.serialize(T))}static yTd(T){T=S.RDb(x.a.g$a(T))||"";return 0<T.length?Sys.Serialization.JavaScriptSerializer.deserialize(T,!0):null}static npk(T,V){S.i0e(T);S.W0d(x.a.g$a(T),Sys.Serialization.JavaScriptSerializer.serialize(V))}static cVd(T){S.v5f(T);S.P5f(x.a.g$a(T))}static fuj(T){return S.RDb(x.a.f$a(T))}static opk(T,V){S.i0e(T);S.W0d(x.a.f$a(T),
V)}static kVd(T){S.v5f(T);S.P5f(x.a.f$a(T))}static i0e(T){const V=S.DTd();T=T.toLowerCase();V.includes(T)||(V.push(T),S.Ozg(V))}static v5f(T){const V=S.DTd();T=T.toLowerCase();V.includes(T)&&(V.splice(Array.indexOf(V,T),1),S.Ozg(V))}static cacheManifest(T,V){T=new l(T);T.needToRestoreManifest&&S.opk(T.solutionId,V)}static RDb(T){try{return localStorage.getItem(T)}catch(V){return c.ULS.sendTraceTag(537163469,0,50,`CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: ${V.message||
"Unknown"}`),null}}static W0d(T,V){try{localStorage.setItem(T,V)}catch(la){c.ULS.sendTraceTag(537163468,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${la.message||"Unknown"}`)}}static P5f(T){try{localStorage.removeItem(T)}catch(V){c.ULS.sendTraceTag(537163467,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${V.message||"Unknown"}`)}}static SDd(T){if(!T)return!1;try{JSON.parse(T)}catch(V){return!1}return!0}}
S.Hfd=new L(2,"CustomFunctions [Registration] [Begin] SolutionId=");S.pzb=new L(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");S.ozb=new L(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");S.Kfd=new L(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");S.Jfd=new L(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");S.Ifd=new L(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(w.a)(S,"CustomFunctionsLegacyInstaller",null,[803])},
1193:function(w,C,a){w=a(0);var b=a(207),c=a(14);class h{}Object(w.a)(h,"AddinCommandsHost",null,[]);var k=a(1230),d=a(1318),f=a(920),u=a(59);const r=(E,J,I,R,X,H)=>{const M=E.Pa(9);M.sharedInfo=J;return u.g(E,"InsertAgaveTaskpane",M,I,R,X,H,0)};var t=a(383),v=a(200),x=a(38),m=a(1),l=a(247),n=a(151);class z extends n.a{constructor(E){super();this.ug=this.gIa="AddInCommandsDialog";this.Rd=5;this.dialogWidth=695;this.dialogHeight=438;this.Glh="100%";this.Dlh="408px";this.Elh="15px";this.Flh="0";this.ANg=
E}get containerDiv(){return this.Wj}yz(){super.yz();this.Wj.style.width=this.Glh;this.Wj.style.height=this.Dlh;this.Wj.style.marginTop=this.Elh;this.Wj.style.padding=this.Flh}AG(){super.AG();this.nd.style.width=String.format("{0}px",this.dialogWidth);this.nd.style.height=String.format("{0}px",this.dialogHeight)}dispose(){super.dispose();this.ANg()}}Object(w.a)(z,"AddInCommandsDialog",n.a,[]);var y=a(62),B=a(78);n=a(106);a.d(C,"a",function(){return G});class G extends h{constructor(E,J,I,R,X){R=void 0===
R?null:R;X=void 0===X?null:X;super();this.$=E;this.Gf=J;this.ownerAddinInfo=I;this.Bf=X;this.Nib=R||y.Task.Wa(!0)}ylh(){const E=this.Nib;this.Nib=y.Task.Wa(!0);return E}disposeHost(E){this.Gf.tWa(E)}setOwnerAddinEToken(E){this.ownerAddinInfo.eToken=E}showTaskpane(E,J,I){c.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");let R=null,X=!1,H=(new k.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new f.a,!0)).kVe(E.solutionId.substr(this.ownerAddinInfo.solutionId.length));
R=J.getSharedRuntimeForTaskpane("Workbook",H);X=!!R&&1===R.LifeTime;this.Gf.NMe(X?this.ownerAddinInfo.solutionId:E.solutionId,X?R:null,null)||(this.zDf(X,!0),this.Nib=this.gyd(E,R,(M,O)=>{M?(X&&(M.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,M.SharedRuntime=R),M.WebExtensionOsfControlType=3,this.Gf.qNa(M),I(M.InstanceId,O),this.zDf(X,!1),m.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&c.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):
(c.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),I(null,O))}))}getSettings(E,J){let I=this.Gf.Nea(E.solutionId);I?J(this.Gf.hY(I).OsfPropertyBag):this.Nib=this.gyd(E,null,R=>{R?J(R.OsfPropertyBag):c.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})}showDialog(E,J,I){c.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");const R=this.$.qa.ua,X=M=>{const O=M.Result,L=O?O.AgaveData:null;L?(this.Gf.eUe(L,()=>{const S=new z(()=>{this.disposeHost(L.InstanceId)});
S.initializeAndShow("",null,null);return S.containerDiv}),I(L.InstanceId,0)):(c.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),I(null,M.Errors?M.Errors[0].ErrorCause:5001))},H=G.eya(E,this.ownerAddinInfo);this.Nib=t.a(this.$.userOperationManager,(M,O,L)=>r(R,H,l.b(M,X),O,L,null),M=>new v.a(500,0,M,64),this.Bf)}createUILessSandbox(E,J,I){c.ULS.sendTraceTag(537170637,220,50,"UILess action called.");const R=J.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),X=!!R&&1===R.LifeTime;
(J=this.Gf.WVh(X?this.ownerAddinInfo.solutionId:E.solutionId,X?R:null))?I(J,0):this.Nib=this.gyd(E,R,(H,M)=>{H?(X?(H.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,H.SharedRuntime=R,H.TaskpaneVisible=!1,H.WebExtensionOsfControlType=3,this.Gf.qNa(H)):(H.WebExtensionOsfControlType=4,this.Gf.eUe(H,()=>{G.Plb.fa(H.InstanceId,new d.a);return G.Plb.ma(H.InstanceId).rea})),I(H.InstanceId,M)):(c.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),I(null,M))})}gyd(E,J,I){let R=
null;const X=this.$.qa.ua,H=T=>{const V=T.Result;(R=V?V.AgaveData:null)||I(null,T.Errors?T.Errors[0].ErrorCause:5001)},M=G.eya(E,this.ownerAddinInfo);J&&(c.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),M.SharedRuntimeId=J.Resid);let O=500;var L=(T,V,la)=>r(X,M,l.b(T,H),V,la,null);let S=0;void 0===M.IsToBePersisted||null===M.IsToBePersisted||M.IsToBePersisted||(O=538,L=(T,V,la)=>{c.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",
Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ownerAddinInfo.solutionId,this.ownerAddinInfo.storeType,this.ownerAddinInfo.assetId,null,null,this.ownerAddinInfo.storeId));T=l.b(T,H);const Z=X.Pa(9,null);Z.sharedInfo=M;return u.g(X,"ShowAgaveTaskpane",Z,T,V,la,null,0)},S=16);S|=64;L=t.a(this.$.userOperationManager,L,T=>new v.a(O,0,T,S),this.Bf);return x.TaskExtensions.ts(L,()=>R?this.jGd(X,R.InstanceId,(T,V)=>{if(T){J||(R.PrimaryMarketplace.MarketplaceType=E.storeType);E.assetId?E.assetId.toLowerCase().startsWith("wa")?
R.AssetMarketplace={SolutionId:E.assetId,SolutionVersion:E.version,MarketplaceType:OSF.StoreType.OMEX,MarketplaceRef:E.assetStoreId}:(R.AssetMarketplace=null,c.ULS.sendTraceTag(512325019,344,10,"WACExcelAddinCommandsHost: AssetId is not a valid value")):R.AssetMarketplace=null;R.OwnerAddinSolutionId=this.ownerAddinInfo.solutionId;R.OwnerAddinStoreType=this.ownerAddinInfo.storeType;R.OsfPropertyBag=[];for(V=0;V<T.Settings.length;V++){const la=[];la[0]=T.Settings[V].Name;la[1]=T.Settings[V].Value;R.OsfPropertyBag[V]=
la}I(R,0)}else I(null,V.Errors?V.Errors[0].ErrorCause:5001)}):y.Task.Wa(!1),b.a.none,3,B.a.current)}jGd(E,J,I){const R=X=>{I(X.Result,X)};return t.a(this.$.userOperationManager,(X,H,M)=>{X=l.b(X,R);const O=E.Pa(1);O.controlId=J;return u.g(E,"DdaLoadSettings",O,X,H,M,null,0)},X=>new v.a(501,0,X,80),this.Bf)}zDf(E,J){var I;E&&(null===(I=window.performance)||void 0===I?0:I.memory)&&c.ULS.sendTraceTag(537170630,220,50,`Shared runtime memory usage: before=${J}, jsHeapSizeLimit=${window.performance.memory.jsHeapSizeLimit}, totalJSHeapSize=${window.performance.memory.totalJSHeapSize}, usedJSHeapSize=${window.performance.memory.usedJSHeapSize}`)}static showUILessDialog(E){G.Plb.kd(E)&&
G.Plb.ma(E).initializeAndShowWithTitle()}static hideUILessDialog(E){G.Plb.kd(E)&&G.Plb.ma(E).hide()}static eya(E,J){var I,R;const X={};X.SolutionId=E.solutionId;X.Version=E.version;X.StoreType=J.storeType;X.StoreId=E.storeId;X.AssetId=null!==(I=E.assetId)&&void 0!==I?I:E.solutionId;X.AssetStoreId=null!==(R=E.assetStoreId)&&void 0!==R?R:"omex";X.TargetType=1;X.Width=350;X.OwnerAddinSolutionId=J.solutionId;X.OwnerAddinStoreType=J.storeType;X.SharedRuntimeId=null;X.Preload=!1;return X}}G.Plb=new n.a;
Object(w.a)(G,"WACExcelAddinCommandsHost",h,[])},1230:function(w,C,a){a.d(C,"a",function(){return c});w=a(0);a(14);var b=a(5);class c{constructor(h,k,d,f){this.crb=h;b.AFrameworkApplication.da.pa("AddInCommandsMissingTabIsEnabled")&&d.Xai();this.Vz=k;this.lQg=f}get CMb(){return this.crb}get solutionId(){return this.Vz}get e3d(){return this.lQg}FPa(h){h=this.CMb+this.solutionId+h;return this.e3d?(h in c.t8b||(c.t8b[h]="AddinControl"+c.j1g++),c.t8b[h]):h}kVe(h){if(this.e3d){const d=c.t8b;for(const f in d){var k=
f;if(h===d[f])return k.substr(this.CMb.length+this.solutionId.length)}}return h}sif(h){h=this.CMb+this.solutionId+h;return this.e3d?(h in c.j6c||(c.j6c[h]="AddinTab"+c.u1g++),c.j6c[h]):h}}c.t8b={};c.j6c={};c.u1g=0;c.j1g=0;Object(w.a)(c,"DefaultRibbonNamingProvider",null,[829])},1295:function(w,C,a){a.r(C);w=a(0);var b=a(14),c=a(138),h;(function(m){m[m.none=0]="none";m[m.testEvent=1]="testEvent";m[m.test1Event=2]="test1Event";m[m.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";m[m.worksheetActivatedEvent=
11]="worksheetActivatedEvent";m[m.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";m[m.worksheetAddedEvent=13]="worksheetAddedEvent";m[m.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";m[m.worksheetDeletedEvent=15]="worksheetDeletedEvent";m[m.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";m[m.worksheetFilteredEvent=17]="worksheetFilteredEvent";m[m.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";m[m.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";
m[m.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";m[m.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";m[m.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";m[m.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";m[m.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";m[m.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";m[m.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";m[m.worksheetMovedEvent=
27]="worksheetMovedEvent";m[m.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";m[m.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";m[m.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";m[m.chartAddedEvent=50]="chartAddedEvent";m[m.chartActivatedEvent=51]="chartActivatedEvent";m[m.chartDeactivatedEvent=52]="chartDeactivatedEvent";m[m.chartDeletedEvent=53]="chartDeletedEvent";m[m.tableSelectionChangedEvent=
100]="tableSelectionChangedEvent";m[m.tableDataChangedEvent=101]="tableDataChangedEvent";m[m.tableAddedEvent=102]="tableAddedEvent";m[m.tableDeletedEvent=103]="tableDeletedEvent";m[m.tableFilteredEvent=104]="tableFilteredEvent";m[m.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";m[m.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";m[m.customFunctionExecutionEndEvent=201]="customFunctionExecutionEndEvent";m[m.commentAddedEvent=250]="commentAddedEvent";m[m.commentDeletedEvent=
251]="commentDeletedEvent";m[m.commentChangedEvent=252]="commentChangedEvent";m[m.invocationMessage=1E3]="invocationMessage";m[m.cancellationMessage=1001]="cancellationMessage";m[m.metadataMessage=1002]="metadataMessage";m[m.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";m[m.visualChangeEvent=2001]="visualChangeEvent";m[m.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";m[m.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";m[m.shapeActivatedEvent=2101]=
"shapeActivatedEvent";m[m.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";m[m.shapeAddedEvent=2103]="shapeAddedEvent";m[m.shapeDeletedEvent=2104]="shapeDeletedEvent";m[m.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";m[m.wacOperationEvent=2201]="wacOperationEvent";m[m.recordingStateChangedEvent=2202]="recordingStateChangedEvent";m[m.workbookActivatedEvent=2203]="workbookActivatedEvent";m[m.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";
m[m.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";m[m.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";m[m.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";m[m.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";m[m.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";m[m.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";
m[m.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";m[m.rangePickerDeactivatedEvent=2701]="rangePickerDeactivatedEvent";m[m.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";m[m.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";m[m.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";m[m.pivotTableAddedEvent=2900]="pivotTableAddedEvent";m[m.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";
m[m.namedItemAddedEvent=3E3]="namedItemAddedEvent";m[m.namedItemDeletedEvent=3001]="namedItemDeletedEvent";m[m.guidedReapplyManagerUpdateAvailableEvent=3100]="guidedReapplyManagerUpdateAvailableEvent";m[m.vbaRecorderRecordingChangedEvent=3200]="vbaRecorderRecordingChangedEvent";m[m.vbaRecorderRecordingChanged2Event=3202]="vbaRecorderRecordingChanged2Event";m[m.workbookActionRecordedEvent=3201]="workbookActionRecordedEvent";m[m.externalCodeServiceDiagnosticsNewEntryEvent=3300]="externalCodeServiceDiagnosticsNewEntryEvent";
m[m.externalCodeServiceDiagnosticsFilterUpdatedEvent=3301]="externalCodeServiceDiagnosticsFilterUpdatedEvent";m[m.rangeValuesPreviewDismissedEvent=3400]="rangeValuesPreviewDismissedEvent";m[m.applicationUndoChangedEvent=3500]="applicationUndoChangedEvent";m[m.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";m[m.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent";m[m.augmentationLoopAnnotationAddedEvent=65541]="augmentationLoopAnnotationAddedEvent"})(h||
(h={}));Object(w.b)("MessageType",h);var k=a(806),d=a(263),f=a(775),u=a(63),r=a(38),t=a(185),v=a(1);a.d(C,"DdaEventDispatch",function(){return x});class x{constructor(m){this.HD=null;this.wrg={};this.yrg={};this.mmd={};this.VKd={};this.Oud=(l,n)=>{l=this.$.Sd.Ze("Task","DdaEventDispatch.HandleServerEvent");n=n.Sdg;for(let G=0;G<n.length;G++)switch(n[G].EventType){case 2:var z=n[G],y={};y.Name=z.Name;y.BindingType=z.BindingType;y.ColCount=z.ColCount;y.RowCount=z.RowCount;this.BAa(z.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,
y,null);break;case 4:this.BAa(n[G].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(z=n[G],z.InstanceId){y=Array(z.Entries.length);for(var B=0;B<z.Entries.length;B++)y[B]=x.Clc(z.Entries[B],z.IsRemoteOverride);0<z.Entries.length&&1===z.Entries[0].Category?this.ipj(z.InstanceId,y):z.InstanceId&&this.BAa(z.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,y)}else{this.mmd={};this.VKd={};for(y=0;y<z.Entries.length;y++)this.ZXe(z.Entries[y],z.IsRemoteOverride);
z=JSON.stringify(this.mmd);y=JSON.stringify(this.VKd);B=JSON.stringify(this.wrg);const E=JSON.stringify(this.yrg);b.ULS.sendTraceTag(537170593,0,50,`Number of Fired event: ${z}, Number of Not Fired event: ${y}, Total Number of Fired event: ${B}, Total Number of Not Fired event: ${E}`)}}l.stop()};this.xTb=(l,n)=>{this.BAa(l,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,n)};this.$=m;this.YFc=this.Oud}Z7b(m){m&&(this.Yma(),this.HD.push(m))}oDc(m){this.HD&&(Array.remove(this.HD,m),this.HD.length||
(this.$.wantServerEvents=!1,this.$.XCj(this.YFc),this.HD=null))}ipj(m,l){const n=Object(c.a)(f.DdaFacade,d.a(this.$));r.TaskExtensions.za(n.Hci(m),z=>{if(t.b(z)){var y=z.result;z=n.No(y);if(y)if(z.nrc)this.BAa(y,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,l);else if(z.$dc)for(y=0;y<l.length;y++)z.$dc.push(l[y]);else z.$dc=l}else z.Kh?b.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):z.qj&&b.ULS.sendTraceTag(537170590,
0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.ka,0)}Gpj(m,l){const n=Object(c.a)(f.DdaFacade,d.a(this.$)),z=n.t1h(m);z?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(z,l,this.xTb):n.aoh(m,l)}ZXe(m,l){let n=!1;const z=parseInt(m.Type,10);var y=m.Target;const B=Object(c.a)(f.DdaFacade,d.a(this.$));if((y=B.lj.Mci(z,y))&&0<Object.keys(y).length){n=!0;for(let E in y)if(y=E,B.lj.r9b(y)){const J=Array(1);J[0]=x.Clc(m,
l);if(v.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var G=J[0][3];if(void 0!==G&&null!==G&&(G=Object(c.a)(Object,u.a.Fk(G)))&&void 0!==G.triggerControlId&&null!==G.triggerControlId&&void 0!==G.triggerSource&&null!==G.triggerSource){let I=!1;l?(G.triggerSource="Unknown",I=!0):B.JBh(G.triggerControlId,y)&&(G.triggerSource="ThisLocalAddin",I=!0);I&&(J[0][3]=u.a.He(G))}}this.BAa(y,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,J)}}n?(this.moc(h[z],this.mmd),this.moc(h[z],
this.wrg)):(this.moc(h[z],this.VKd),this.moc(h[z],this.yrg))}Yma(){this.HD||(this.HD=[],this.$.SCe(this.YFc),this.$.wantServerEvents=!0)}moc(m,l){m in l||(l[m]=0);l[m]+=1}OF(m,l,n){const z={};z.Target=l;z.Category=65536;z.Type=m;z.Message=n;z.Id=-1;this.ZXe(z,!1)}mWh(m,l){const n={Target:"",Category:2,Type:1E3};n.Message=l;n.Id=0;l=Array(1);l[0]=x.Clc(n,!1);this.Gpj(m,l)}Bic(m,l,n,z){const y={};y.Target=n;y.Category=65536;y.Type=l;y.Message=z;y.Id=-1;l=Array(1);l[0]=x.Clc(y,!1);this.BAa(m,OSF.DDA.EventDispId.dispidRichApiMessageEvent,
null,l)}lWh(m,l){this.BAa(m,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,l)}BAa(m,l,n,z){if(this.HD){var y=Object(c.a)(f.DdaFacade,d.a(this.$));if(!y||l!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&l!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||y.lj.r9b(m)){m=new k.a(l,m,n,z);for(let B=0,G=this.HD.length;B<G;B++)(l=this.HD[B])&&l(m)}}}static Clc(m,l){const n=Array(6);n[0]=m.Category;n[1]=m.Type;n[2]=m.Target;n[3]=m.Message;n[4]=m.Id;n[5]=l;return n}}Object(w.a)(x,"DdaEventDispatch",
null,[])},1318:function(w,C,a){a.d(C,"a",function(){return c});w=a(0);C=a(151);var b=a(95);class c extends C.a{constructor(){super(void 0,void 0,void 0,!0);this.gIa="AddinCommandsUILessDialog";this.r2c="WACDialogTitleText";this.X_="0";this.UG=380;this.WE=190;this.ug=this.gIa;this.Rd=5;this.mHg=String.format("{0}px",this.UG);this.W_=String.format("{0}px",this.WE);this.Nlf=this.hw=!1;this.yz()}yz(){super.yz();this.Wj.style.width=this.mHg;this.Wj.style.height=this.W_;this.Wj.style.padding=this.X_}lB(h){this.AG();
document.getElementById(this.Rj(this.r2c)).innerText=h}AG(){super.AG();this.nd.style.width=String.format("{0}px",this.UG);this.nd.style.height=String.format("{0}px",this.WE);this.nd.removeAttribute(b.a.Mf);this.nd.removeAttribute(b.a.wP)}hide(){this.fab()}get rea(){return this.Wj}initializeAndShowWithTitle(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,null,null)}}Object(w.a)(c,"AddinCommandsUILessDialog",C.a,[833])},1326:function(w,C,a){a.r(C);var b={};a.r(b);a.d(b,"MacroRecorderEventHandler",
function(){return ye});var c={};a.r(c);a.d(c,"AgaveOnSelectedReadoutHandler",function(){return Ti});var h=a(521),k=a(1),d=a(10),f=a(0),u=a(233),r=a(198),t=a(604);class v{constructor(){this.jnb=null}get w7g(){this.jnb||(this.jnb=new r.a,this.jnb.add(12),this.jnb.add(11));return this.jnb}uBi(K){return this.w7g.contains(K.operation)}Gek(K){const Da=[],xb=K.payload;for(const kc of xb.batchedOperations)Da.push(new t.a(K.operation,kc));return Da}}Object(f.a)(v,"MacroRecorderBatchedEventList",null,[]);var x=
a(731),m=a(14);class l{constructor(){this.fTc=this.gTc=this.kZc=this.R2c=null}get operations(){this.kZc||(this.kZc=new r.a,this.ee());return this.kZc}get uNc(){this.R2c||(this.R2c=new r.a,this.si());return this.R2c}get x6e(){this.fTc||(this.fTc=new r.a);return this.fTc}get featureGates(){this.gTc||(this.gTc=new r.a,this.Mxd());return this.gTc}si(){}Mxd(){}zf(K){this.uNc.add(K)}Wd(K){this.operations.contains(K)||this.operations.add(K)}jAe(K){this.x6e.add(K)}}Object(f.a)(l,"MacroRecorderEventBase",
null,[]);class n extends l{constructor(){super()}get eventId(){return 130}ee(){this.Wd(100)}}Object(f.a)(n,"AccessibilityCheckRunEvent",l,[]);class z extends l{constructor(){super()}get eventId(){return 160}ee(){this.Wd(241)}si(){this.zf(K=>K.addToPrintArea)}}Object(f.a)(z,"AddedToPrintAreaEvent",l,[]);class y extends l{constructor(){super()}get eventId(){return 65}ee(){this.Wd(516)}}Object(f.a)(y,"AutoFilterToggledEvent",l,[]);class B extends l{constructor(){super()}get eventId(){return 118}ee(){this.Wd(502)}si(){this.zf(K=>
!(K.v$a().FirstColumn===K.v$a().LastColumn&&K.v$a().FirstRow===K.v$a().LastRow))}}Object(f.a)(B,"AutoSumEvent",l,[]);class G extends l{constructor(){super()}get eventId(){return 223}ee(){this.Wd(1032)}}Object(f.a)(G,"CellImageAltTextAppliedEvent",l,[]);class E extends l{constructor(K,Da){super();this.zja=K;this.rmk=Da}get eventId(){return this.zja}ee(){this.Wd(529);this.Wd(594)}si(){this.zf(K=>this.rmk.includes(K.Crd()))}}Object(f.a)(E,"ChartPropertyAppliedEventBase",l,[]);class J extends E{constructor(){super(84,
[348,349,350,351,352,353,354,355,356,357,372,373,374,375])}}Object(f.a)(J,"ChartAxisChangedEvent",E,[]);class I extends E{constructor(){super(80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])}}Object(f.a)(I,"ChartAxisTitleChangedEvent",E,[]);class R extends E{constructor(){super(82,[200,201,202,203,204,205,206,207,208,209,210])}}Object(f.a)(R,"ChartDataLabelsChangedEvent",E,[]);class X extends E{constructor(){super(76,[-100])}}Object(f.a)(X,"ChartDataSelectedEvent",E,[]);class H extends E{constructor(){super(83,
[500,501,502])}}Object(f.a)(H,"ChartDataTableChangedEvent",E,[]);var M=a(661),O=a(563),L=a(355),S=a(138);class T extends l{constructor(){super()}}Object(f.a)(T,"RichApiRequestExecutedEventBase",l,[]);class V{constructor(K,Da,xb){this.response=this.request=this.eventId=this.source=null;K&&(this.source=K.source,this.eventId=K.eventId,this.request=Da,this.response=xb)}get isValid(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}Object(f.a)(V,"MacroRecorderRichApiRequestExecutedPayload",
null,[135]);class la extends T{constructor(){super()}get eventId(){return 117}hC(K){la.qaa||(la.qaa=new M.a(O.a.Fh()),la.qaa.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),la.qaa.add("fa000000014"));return!!K&&la.qaa.contains(K.toLowerCase())}ee(){this.Wd(507);this.Wd(10);this.Wd(576)}si(){this.zf(K=>Object(L.a)(V,K)&&(K=Object(S.a)(V,K),K.isValid&&this.hC(K.source))?(m.ULS.sendTraceTag(537155427,0,50,`[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: ${K.eventId}`),!0):
!1)}}la.qaa=null;Object(f.a)(la,"ChartFormatRichApiRequestExecutedEvent",T,[]);class Z extends E{constructor(){super(85,[328,329,330,331,332,333,334,335])}}Object(f.a)(Z,"ChartGridlinesChangedEvent",E,[]);class da extends l{constructor(){super()}get eventId(){return 66}ee(){this.Wd(528)}}Object(f.a)(da,"ChartInsertedEvent",l,[]);class ba extends E{constructor(){super(81,[100,101,102,103,104,105,106])}}Object(f.a)(ba,"ChartLegendChangedEvent",E,[]);class na extends E{constructor(){super(75,[-101])}}
Object(f.a)(na,"ChartRowColumnSwitchedEvent",E,[]);class Y extends E{constructor(){super(79,[0,1,2,-102])}}Object(f.a)(Y,"ChartTitleChangedEvent",E,[]);class Ga extends E{constructor(){super(78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])}}Object(f.a)(Ga,"ChartTypeChangedEvent",E,[]);class ma extends l{constructor(){super()}get eventId(){return 131}ee(){this.Wd(521)}}Object(f.a)(ma,
"ConnectorFloatingObjectResizedEvent",l,[]);class fa extends l{constructor(){super()}get eventId(){return 129}ee(){this.Wd(109)}}Object(f.a)(fa,"EntitySelectedEvent",l,[]);class Xa extends l{constructor(){super()}get eventId(){return 49}ee(){this.Wd(149);this.Wd(147)}}Object(f.a)(Xa,"FindCellEvent",l,[]);class Ua extends l{constructor(){super()}get eventId(){return 96}ee(){this.Wd(122)}}Object(f.a)(Ua,"FloatingObjectAltTextAppliedEvent",l,[]);class ka extends l{constructor(){super()}get eventId(){return 93}ee(){this.Wd(522)}}
Object(f.a)(ka,"FloatingObjectDeletedEvent",l,[]);class nb extends l{constructor(){super()}get eventId(){return 94}ee(){this.Wd(524)}}Object(f.a)(nb,"FloatingObjectMovedAndResizedEvent",l,[]);class Ea extends l{constructor(){super()}get eventId(){return 95}ee(){this.Wd(523)}}Object(f.a)(Ea,"FloatingObjectRotatedEvent",l,[]);class sb extends l{constructor(){super()}get eventId(){return 100}ee(){this.Wd(543)}}Object(f.a)(sb,"GroupDetailsShownOrHiddenEvent",l,[]);class Oa extends l{constructor(){super()}get eventId(){return 154}ee(){this.Wd(125)}}
Object(f.a)(Oa,"HyperlinksRemovedFromRangeEvent",l,[]);class La extends T{constructor(){super()}get eventId(){return 125}hC(K){La.qaa||(La.qaa=new M.a(O.a.Fh()),La.qaa.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),La.qaa.add("fa000000005"));return!!K&&La.qaa.contains(K.toLowerCase())}ee(){this.Wd(507);this.Wd(10);this.Wd(576)}si(){this.zf(K=>Object(L.a)(V,K)?(K=Object(S.a)(V,K),K.isValid&&this.hC(K.source)):!1)}}La.qaa=null;Object(f.a)(La,"IdeasRichApiRequestExecutedEvent",T,[]);class ia extends l{constructor(){super()}get eventId(){return 136}ee(){this.Wd(115)}}
Object(f.a)(ia,"LinkedEntityConvertedEvent",l,[]);class Sa extends l{constructor(){super()}get eventId(){return 148}ee(){this.Wd(114)}}Object(f.a)(Sa,"LinkedEntityDisambiguationPaneToggledEvent",l,[]);class Za extends l{constructor(){super()}get eventId(){return 127}ee(){this.Wd(119)}}Object(f.a)(Za,"MovedToEdgeEvent",l,[]);class Ab extends l{constructor(){super()}get eventId(){return 135}ee(){this.Wd(191)}}Object(f.a)(Ab,"NamedSheetViewCreatedEvent",l,[]);class pb extends l{constructor(){super()}get eventId(){return 166}ee(){this.Wd(200)}}
Object(f.a)(pb,"NamedSheetViewDeletedEvent",l,[]);class Tb extends l{constructor(){super()}get eventId(){return 133}ee(){this.Wd(192)}}Object(f.a)(Tb,"NamedSheetViewExitedEvent",l,[]);class ob extends l{constructor(){super()}get eventId(){return 162}ee(){this.Wd(199)}}Object(f.a)(ob,"NamedSheetViewRenamedEvent",l,[]);class va extends l{constructor(){super()}get eventId(){return 167}ee(){this.Wd(195)}}Object(f.a)(va,"NamedSheetViewSwitchedEvent",l,[]);class Pa extends l{constructor(){super()}get eventId(){return 99}ee(){this.Wd(174)}}
Object(f.a)(Pa,"OutlineLevelSetEvent",l,[]);class jb extends l{constructor(){super()}get eventId(){return 156}ee(){this.Wd(244)}}Object(f.a)(jb,"PageBreakInsertedEvent",l,[]);class Ob extends l{constructor(){super()}get eventId(){return 157}ee(){this.Wd(245)}}Object(f.a)(Ob,"PageBreakRemovedEvent",l,[]);class kb extends l{constructor(){super()}get eventId(){return 158}ee(){this.Wd(246)}}Object(f.a)(kb,"PageBreaksAllResetEvent",l,[]);class ra extends l{constructor(){super()}get eventId(){return 112}ee(){this.Wd(503)}si(){this.zf(K=>
!!K.pasteParameters.ClientEstimationFloatingObjectId&&2===K.pasteParameters.CopyPasteTargetType&&!K.isFromCurrentSession)}}Object(f.a)(ra,"PasteArtOtherWorkbookEvent",l,[]);class rb extends l{constructor(){super()}get eventId(){return 52}ee(){this.Wd(503)}si(){this.zf(K=>!!K.pasteParameters.ClientEstimationFloatingObjectId&&2===K.pasteParameters.CopyPasteTargetType&&K.isFromCurrentSession)}}Object(f.a)(rb,"PasteArtSameWorkbookEvent",l,[]);class Kb extends l{constructor(){super()}get eventId(){return 110}ee(){this.Wd(204)}}
Object(f.a)(Kb,"PasteHtmlEvent",l,[]);class Sb extends l{constructor(){super()}get eventId(){return 35}ee(){this.Wd(506)}}Object(f.a)(Sb,"PasteRangeEvent",l,[]);class cb extends l{constructor(){super()}get eventId(){return 111}ee(){this.Wd(503)}si(){this.zf(K=>1===K.pasteParameters.CopyPasteTargetType)}}Object(f.a)(cb,"PasteShadowWorkbookRangeEvent",l,[]);class cc extends l{constructor(){super()}get eventId(){return 42}ee(){this.Wd(180)}}Object(f.a)(cc,"PasteStringEvent",l,[]);class Ub extends l{constructor(){super()}get eventId(){return 134}ee(){this.Wd(220)}}
Object(f.a)(Ub,"PendingMergeEvent",l,[]);class wb extends l{constructor(){super()}get eventId(){return 122}ee(){this.Wd(510)}}Object(f.a)(wb,"PictureInsertedEvent",l,[]);class vc extends l{constructor(){super()}get eventId(){return 153}ee(){this.Wd(161)}}Object(f.a)(vc,"PivotDrillToggledEvent",l,[]);class Lb extends l{constructor(K,Da){super();this.zja=K;this.opType=Da}get eventId(){return this.zja}ee(){this.Wd(225)}si(){this.zf(K=>K.opType===this.opType)}}Object(f.a)(Lb,"PivotTableSettingsChangedEventBase",
l,[]);class Ja extends Lb{constructor(){super(171,4)}}Object(f.a)(Ja,"PivotTableAllItemLabelsRepeatedEvent",Lb,[]);class Hb extends Lb{constructor(){super(184,17)}}Object(f.a)(Hb,"PivotTableAltTextDescriptionChangedEvent",Lb,[]);class gc extends Lb{constructor(){super(183,16)}}Object(f.a)(gc,"PivotTableAltTextTitleChangedEvent",Lb,[]);class ec extends Lb{constructor(){super(173,6)}}Object(f.a)(ec,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",Lb,[]);class Ta extends Lb{constructor(){super(172,
5)}}Object(f.a)(Ta,"PivotTableBlankLineAfterEachItemToggledEvent",Lb,[]);class ib extends Lb{constructor(){super(170,3)}}Object(f.a)(ib,"PivotTableColumnGrandTotalShownEvent",Lb,[]);class bc extends l{constructor(){super()}get eventId(){return 98}ee(){this.Wd(132)}}Object(f.a)(bc,"PivotTableCreatedEvent",l,[]);class jc extends Lb{constructor(){super(177,10)}}Object(f.a)(jc,"PivotTableDisplayErrorStringToggledEvent",Lb,[]);class sc extends Lb{constructor(){super(178,11)}}Object(f.a)(sc,"PivotTableDisplayNullStringToggledEvent",
Lb,[]);class Fa extends Lb{constructor(){super(179,12)}}Object(f.a)(Fa,"PivotTableErrorStringChangedEvent",Lb,[]);class Ha extends Lb{constructor(){super(174,7)}}Object(f.a)(Ha,"PivotTableExpandCollapseButtonsShownEvent",Lb,[]);class Na extends Lb{constructor(){super(187,20)}}Object(f.a)(Na,"PivotTableIndentChangedEvent",Lb,[]);class W extends Lb{constructor(){super(176,9)}}Object(f.a)(W,"PivotTableItemsWithNoDataOnColumnsShownEvent",Lb,[]);class U extends Lb{constructor(){super(175,8)}}Object(f.a)(U,
"PivotTableItemsWithNoDataOnRowsShownEvent",Lb,[]);class za extends Lb{constructor(){super(186,19)}}Object(f.a)(za,"PivotTableLayoutTypeSetEvent",Lb,[]);class ua extends Lb{constructor(){super(180,13)}}Object(f.a)(ua,"PivotTableNullStringChangedEvent",Lb,[]);class $a extends l{constructor(){super()}get eventId(){return 149}ee(){this.Wd(219)}}Object(f.a)($a,"PivotTablePivotLocationChangedEvent",l,[]);class Va extends l{constructor(){super()}get eventId(){return 102}ee(){this.Wd(145)}}Object(f.a)(Va,
"PivotTablePivotedEvent",l,[]);class hb extends Lb{constructor(){super(182,15)}}Object(f.a)(hb,"PivotTableRefreshDataOnLoadToggledEvent",Lb,[]);class qb extends l{constructor(){super()}get eventId(){return 104}ee(){this.Wd(50)}si(){this.zf(K=>!!K.pivotTableId&&!!K.pivotTableName)}}Object(f.a)(qb,"PivotTableRefreshedEvent",l,[]);class Nb extends Lb{constructor(){super(168,1)}}Object(f.a)(Nb,"PivotTableRenamedEvent",Lb,[]);class yb extends Lb{constructor(){super(169,2)}}Object(f.a)(yb,"PivotTableRowGrandTotalShownEvent",
Lb,[]);class ja extends Lb{constructor(){super(181,14)}}Object(f.a)(ja,"PivotTableSaveSourceDataWithFileToggledEvent",Lb,[]);var Ka=a(624);class Pb extends l{constructor(){super()}get eventId(){return 155}ee(){this.Wd(131)}si(){this.zf(K=>{K=Object(S.a)(Ka.a,K);return!!K&&!!K.JPa()&&!!K.hierarchyName})}}Object(f.a)(Pb,"PivotTableSortedEvent",l,[]);class rc extends Lb{constructor(){super(185,18)}}Object(f.a)(rc,"PivotTableSubTotalsVisibilitySettingSetEvent",Lb,[]);class $c extends l{constructor(){super()}get eventId(){return 206}ee(){this.Wd(560)}}
Object(f.a)($c,"PivotValueFieldSettingAppliedEvent",l,[]);class Dd extends l{constructor(){super()}get eventId(){return 161}ee(){this.Wd(243)}}Object(f.a)(Dd,"PrintAreaClearedEvent",l,[]);class Jd extends l{constructor(){super()}get eventId(){return 159}ee(){this.Wd(241)}si(){this.zf(K=>!K.addToPrintArea)}}Object(f.a)(Jd,"PrintAreaSetEvent",l,[]);class Kd extends l{constructor(){super()}get eventId(){return 57}ee(){this.Wd(517)}}Object(f.a)(Kd,"RangeAutoFilterClearedEvent",l,[]);class ce extends l{constructor(K,
Da){super();this.zja=K;this.Rae=Da}get eventId(){return this.zja}ee(){this.Wd(11)}si(){this.zf(K=>16===K.l2().ValidMembers);this.zf(K=>K.l2().Font.ValidMembers===this.Rae)}}Object(f.a)(ce,"RangeFontFormattedEventBase",l,[]);class ge extends ce{constructor(){super(3,4)}}Object(f.a)(ge,"RangeBoldedEvent",ce,[]);class uc extends l{constructor(){super()}get eventId(){return 2}ee(){this.Wd(11)}si(){this.zf(K=>128===K.l2().ValidMembers)}}Object(f.a)(uc,"RangeBorderedEvent",l,[]);class dd{}dd.Wfb="Table";
dd.tzc="Sheet";Object(f.a)(dd,"MacroRecorderEventConstants",null,[]);class Rd extends l{constructor(){super()}get eventId(){return 113}ee(){this.Wd(208)}si(){this.zf(K=>K.getParameters().FilterType===dd.tzc)}}Object(f.a)(Rd,"RangeCheckedItemsFilteredEvent",l,[]);class Yd extends l{constructor(){super()}get eventId(){return 109}ee(){this.Wd(105)}}Object(f.a)(Yd,"RangeConditionalFormattingCreatedEvent",l,[]);class Md extends l{constructor(){super()}get eventId(){return 124}ee(){this.Wd(221)}}Object(f.a)(Md,
"RangeConditionalFormattingRuleDeletedEvent",l,[]);class ad extends l{constructor(){super()}get eventId(){return 29}ee(){this.Wd(508)}si(){this.zf(K=>3===K.eu()||1===K.eu()||4===K.eu())}}Object(f.a)(ad,"RangeContentClearedEvent",l,[]);class Mb extends l{constructor(){super()}get eventId(){return 40}ee(){this.Wd(104)}}Object(f.a)(Mb,"RangeCopiedCutCellsInsertedEvent",l,[]);class Aa extends l{constructor(){super()}get eventId(){return 114}ee(){this.Wd(209)}si(){this.zf(K=>K.getParameters().FilterType===
dd.tzc)}}Object(f.a)(Aa,"RangeCustomFilteredEvent",l,[]);class Bc extends l{constructor(){super()}get eventId(){return 106}ee(){this.Wd(121)}}Object(f.a)(Bc,"RangeDataValidationChangedEvent",l,[]);class Vc extends ce{constructor(){super(4,64)}}Object(f.a)(Vc,"RangeDoubleUnderlinedEvent",ce,[]);class hc extends l{constructor(){super()}get eventId(){return 69}ee(){this.Wd(190)}}Object(f.a)(hc,"RangeDuplicatesRemovedEvent",l,[]);class xc extends l{constructor(){super()}get eventId(){return 1}ee(){this.Wd(527);
this.Wd(12)}}Object(f.a)(xc,"RangeEditedEvent",l,[]);class ab extends l{constructor(){super()}get eventId(){return 164}ee(){this.Wd(255)}si(){this.zf(K=>4===K.actionType)}}Object(f.a)(ab,"RangeExternalLinksBrokeAllLinksEvent",l,[]);class Wb extends l{constructor(){super()}get eventId(){return 119}ee(){this.Wd(255)}si(){this.zf(K=>3===K.actionType)}}Object(f.a)(Wb,"RangeExternalLinksBrokeLinkEvent",l,[]);class Yc extends l{constructor(){super()}get eventId(){return 205}ee(){this.Wd(256)}Mxd(){this.jAe("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")}}
Object(f.a)(Yc,"RangeExternalLinksChangeSourceEvent",l,[]);class Tc extends l{constructor(){super()}get eventId(){return 163}ee(){this.Wd(553)}si(){this.zf(K=>1===K.actionType)}}Object(f.a)(Tc,"RangeExternalLinksRefreshedAllEvent",l,[]);class ed extends l{constructor(){super()}get eventId(){return 77}ee(){this.Wd(553)}si(){this.zf(K=>0===K.actionType)}}Object(f.a)(ed,"RangeExternalLinksRefreshedEvent",l,[]);class be extends l{constructor(){super()}get eventId(){return 165}ee(){this.Wd(224)}}Object(f.a)(be,
"RangeExternalLinksSetAutoRefreshEvent",l,[]);class Fc extends l{constructor(){super()}get eventId(){return 5}ee(){this.Wd(11)}si(){this.zf(K=>64===K.l2().ValidMembers)}}Object(f.a)(Fc,"RangeFillColoredEvent",l,[]);class vd extends l{constructor(){super()}get eventId(){return 59}ee(){this.Wd(155)}}Object(f.a)(vd,"RangeFilledEvent",l,[]);class lb extends l{constructor(){super()}get eventId(){return 115}ee(){this.Wd(176)}si(){this.zf(K=>K.pY().AutoFilterType===dd.tzc&&!!K.pY().CriteriaType)}}Object(f.a)(lb,
"RangeFilterAppliedEvent",l,[]);class Eb extends l{constructor(){super()}get eventId(){return 58}ee(){this.Wd(176)}si(){this.zf(K=>K.pY().AutoFilterType===dd.tzc&&!K.pY().CriteriaType)}}Object(f.a)(Eb,"RangeFilterClearedEvent",l,[]);class Hc extends l{constructor(){super()}get eventId(){return 41}ee(){this.Wd(518)}}Object(f.a)(Hc,"RangeFilterReappliedEvent",l,[]);class Bd extends l{constructor(){super()}get eventId(){return 86}ee(){this.Wd(150)}}Object(f.a)(Bd,"RangeFlashFilledEvent",l,[]);class he extends ce{constructor(){super(6,
32)}}Object(f.a)(he,"RangeFontColoredEvent",ce,[]);class je extends ce{constructor(){super(7,8)}}Object(f.a)(je,"RangeFontItalicizedEvent",ce,[]);class Fd extends ce{constructor(){super(8,1)}}Object(f.a)(Fd,"RangeFontNamedEvent",ce,[]);class Oc extends ce{constructor(){super(9,2)}}Object(f.a)(Oc,"RangeFontSizedEvent",ce,[]);class Ad extends l{constructor(){super()}get eventId(){return 74}ee(){this.Wd(215)}}Object(f.a)(Ad,"RangeFormattedAsTableEvent",l,[]);class Gb extends l{constructor(){super()}get eventId(){return 97}ee(){this.Wd(188)}}
Object(f.a)(Gb,"RangeGroupedOrUngroupedEvent",l,[]);class Wc extends l{constructor(){super()}get eventId(){return 60}ee(){this.Wd(11)}si(){this.zf(K=>2===K.l2().ValidMembers)}}Object(f.a)(Wc,"RangeHorizontallyAlignedEvent",l,[]);class pd extends l{constructor(){super()}get eventId(){return 43}ee(){this.Wd(526)}}Object(f.a)(pd,"RangeHyperlinkAppliedEvent",l,[]);class fe extends l{constructor(){super()}get eventId(){return 63}ee(){this.Wd(11)}si(){this.zf(K=>256===K.l2().ValidMembers)}}Object(f.a)(fe,
"RangeIndentChangedEvent",l,[]);class le extends l{constructor(){super()}get eventId(){return 53}ee(){this.Wd(156)}si(){this.zf(K=>2===K.eu()||5===K.eu()||6===K.eu()||7===K.eu())}}Object(f.a)(le,"RangeMergedEvent",l,[]);class te extends l{constructor(){super()}get eventId(){return 107}ee(){this.Wd(216)}}Object(f.a)(te,"RangeNamedCellStyleAppliedEvent",l,[]);class Ce extends l{constructor(){super()}get eventId(){return 12}ee(){this.Wd(11)}si(){this.zf(K=>32===K.l2().ValidMembers)}}Object(f.a)(Ce,"RangeNumberFormattedEvent",
l,[]);var Xb=a(1019);class oc extends l{constructor(){super()}get eventId(){return 108}ee(){this.Wd(141)}si(){this.zf(K=>Object(L.a)(Xb.a,K))}}Object(f.a)(oc,"RangeSortedEvent",l,[]);class Zc extends ce{constructor(){super(10,128)}}Object(f.a)(Zc,"RangeStrikedThroughEvent",ce,[]);class yd extends ce{constructor(){super(11,16)}}Object(f.a)(yd,"RangeUnderlinedEvent",ce,[]);class Od extends l{constructor(){super()}get eventId(){return 61}ee(){this.Wd(11)}si(){this.zf(K=>1===K.l2().ValidMembers)}}Object(f.a)(Od,
"RangeVerticallyAlignedEvent",l,[]);class dc extends l{constructor(){super()}get eventId(){return 62}ee(){this.Wd(11)}si(){this.zf(K=>8===K.l2().ValidMembers)}}Object(f.a)(dc,"RangeWrapTextToggledEvent",l,[]);class gd extends l{constructor(){super()}get eventId(){return 103}ee(){this.Wd(51)}}Object(f.a)(gd,"RefreshedAllEvent",l,[]);class wd extends l{constructor(){super()}get eventId(){return 47}ee(){this.Wd(148)}}Object(f.a)(wd,"ReplaceAllEvent",l,[]);class Ld extends l{constructor(){super()}get eventId(){return 226}ee(){this.Wd(1025)}}
Object(f.a)(Ld,"SampleTableCreatedEvent",l,[]);class Xd extends l{constructor(){super()}get eventId(){return 91}ee(){this.Wd(532)}si(){this.zf(K=>95!==K.getShapeType()&&96!==K.getShapeType()&&97!==K.getShapeType()&&98!==K.getShapeType()&&100!==K.getShapeType()&&102!==K.getShapeType()&&103!==K.getShapeType())}}Object(f.a)(Xd,"ShapeInsertedEvent",l,[]);class Ie extends l{constructor(){super()}get eventId(){return 92}ee(){this.Wd(531)}}Object(f.a)(Ie,"ShapeStyleSetEvent",l,[]);var We=a(866);class jf extends l{constructor(K,
Da){super();this.zja=K;this.Rae=Da}get eventId(){return this.zja}ee(){this.Wd(581)}si(){this.zf(K=>Object(L.a)(We.a,K)&&4===K.getShapeTextFormat().ValidMembers);this.zf(K=>Object(L.a)(We.a,K)&&K.getShapeTextFormat().Font.ValidMembers===this.Rae)}}Object(f.a)(jf,"ShapeTextFontFormattedEventBase",l,[]);class tc extends jf{constructor(){super(193,4)}}Object(f.a)(tc,"ShapeTextBoldedEvent",jf,[]);var Qc=a(1021);class xd extends l{constructor(){super()}get eventId(){return 191}ee(){this.Wd(581)}si(){this.zf(K=>
Object(L.a)(Qc.a,K))}}Object(f.a)(xd,"ShapeTextChangedEvent",l,[]);class Gd extends jf{constructor(){super(196,32)}}Object(f.a)(Gd,"ShapeTextFontColorChangedEvent",jf,[]);class pe extends jf{constructor(){super(197,1)}}Object(f.a)(pe,"ShapeTextFontNameChangedEvent",jf,[]);class Dc extends jf{constructor(){super(198,2)}}Object(f.a)(Dc,"ShapeTextFontSizeChangedEvent",jf,[]);class Wa extends l{constructor(){super()}get eventId(){return 199}ee(){this.Wd(581)}si(){this.zf(K=>Object(L.a)(We.a,K)&&2===K.getShapeTextFormat().ValidMembers)}}
Object(f.a)(Wa,"ShapeTextHorizontallyAlignedEvent",l,[]);class Qb extends jf{constructor(){super(194,8)}}Object(f.a)(Qb,"ShapeTextItalicizedEvent",jf,[]);class Lc extends jf{constructor(){super(195,16)}}Object(f.a)(Lc,"ShapeTextUnderlinedEvent",jf,[]);class Ba extends l{constructor(){super()}get eventId(){return 200}ee(){this.Wd(581)}si(){this.zf(K=>Object(L.a)(We.a,K)&&1===K.getShapeTextFormat().ValidMembers)}}Object(f.a)(Ba,"ShapeTextVerticallyAlignedEvent",l,[]);class qa extends l{constructor(){super()}get eventId(){return 13}ee(){this.Wd(138)}}
Object(f.a)(qa,"SheetAddedEvent",l,[]);var gb=a(8);class Bb extends l{constructor(){super()}get eventId(){return 142}ee(){this.Wd(237)}si(){this.zf(K=>!!K.insertDeleteMultiRangeParameters);this.zf(K=>!K.insertDeleteMultiRangeParameters.IsTableCommand);this.zf(K=>{K=K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>K.DeltaColumn&&!K.DeltaRow&&(!!K.InsertDeleteRange.FirstRow||K.InsertDeleteRange.LastRow!==gb.a.UA)||!K.DeltaColumn&&0>K.DeltaRow&&(!!K.InsertDeleteRange.FirstColumn||
K.InsertDeleteRange.LastColumn!==gb.a.lz)})}}Object(f.a)(Bb,"SheetCellsDeletedEvent",l,[]);class ic extends l{constructor(){super()}get eventId(){return 143}ee(){this.Wd(237)}si(){this.zf(K=>!!K.insertDeleteMultiRangeParameters);this.zf(K=>!K.insertDeleteMultiRangeParameters.IsTableCommand);this.zf(K=>{K=K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<K.DeltaColumn&&!K.DeltaRow&&(!!K.InsertDeleteRange.FirstRow||K.InsertDeleteRange.LastRow!==gb.a.UA)||!K.DeltaColumn&&0<K.DeltaRow&&
(!!K.InsertDeleteRange.FirstColumn||K.InsertDeleteRange.LastColumn!==gb.a.lz)})}}Object(f.a)(ic,"SheetCellsInsertedEvent",l,[]);class Cc extends l{constructor(){super()}get eventId(){return 139}ee(){this.Wd(237)}si(){this.zf(K=>!!K.insertDeleteMultiRangeParameters);this.zf(K=>!K.insertDeleteMultiRangeParameters.IsTableCommand);this.zf(K=>0>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.zf(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.zf(K=>
!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.zf(K=>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===gb.a.UA)}}Object(f.a)(Cc,"SheetColumnDeletedEvent",l,[]);class hd extends l{constructor(){super()}get eventId(){return 138}ee(){this.Wd(237)}si(){this.zf(K=>!!K.insertDeleteMultiRangeParameters);this.zf(K=>!K.insertDeleteMultiRangeParameters.IsTableCommand);this.zf(K=>0<K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.zf(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.zf(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.zf(K=>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===gb.a.UA)}}Object(f.a)(hd,"SheetColumnInsertedEvent",l,[]);class Pd extends l{constructor(){super()}get eventId(){return 14}ee(){this.Wd(137)}}Object(f.a)(Pd,"SheetDeletedEvent",l,[]);class ue extends l{constructor(){super()}get eventId(){return 137}ee(){this.Wd(185)}}
Object(f.a)(ue,"SheetDirectionChangedEvent",l,[]);class Ee extends l{constructor(){super()}get eventId(){return 54}ee(){this.Wd(139)}}Object(f.a)(Ee,"SheetDuplicatedEvent",l,[]);class Se extends l{constructor(){super()}get eventId(){return 15}ee(){this.Wd(207)}}Object(f.a)(Se,"SheetNameEditedEvent",l,[]);class cf extends l{constructor(){super()}get eventId(){return 90}ee(){this.Wd(151)}}Object(f.a)(cf,"SheetPaneFrozenEvent",l,[]);class mf extends l{constructor(){super()}get eventId(){return 120}ee(){this.Wd(226)}}
Object(f.a)(mf,"SheetPrintSettingsSavedEvent",l,[]);var ac=a(915);class bd extends l{constructor(){super()}get eventId(){return 215}ee(){this.Wd(507)}Mxd(){this.jAe("Microsoft.Office.Excel.SheetProtectionMacroRecording")}si(){this.zf(K=>Object.getType(K)===ac.a)}}Object(f.a)(bd,"SheetProtectionPausedResumedEvent",l,[]);class nd extends l{constructor(){super()}get eventId(){return 64}ee(){this.Wd(557)}}Object(f.a)(nd,"SheetReorderedEvent",l,[]);class se extends l{constructor(){super()}get eventId(){return 141}ee(){this.Wd(237)}si(){this.zf(K=>
!!K.insertDeleteMultiRangeParameters);this.zf(K=>!K.insertDeleteMultiRangeParameters.IsTableCommand);this.zf(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.zf(K=>0>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.zf(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.zf(K=>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===gb.a.lz)}}Object(f.a)(se,
"SheetRowDeletedEvent",l,[]);class Ge extends l{constructor(){super()}get eventId(){return 140}ee(){this.Wd(237)}si(){this.zf(K=>!!K.insertDeleteMultiRangeParameters);this.zf(K=>!K.insertDeleteMultiRangeParameters.IsTableCommand);this.zf(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.zf(K=>0<K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.zf(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);
this.zf(K=>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===gb.a.lz)}}Object(f.a)(Ge,"SheetRowInsertedEvent",l,[]);class Ve extends l{constructor(){super()}get eventId(){return 39}ee(){this.Wd(135)}}Object(f.a)(Ve,"SheetRowsColumnsAutoFitEvent",l,[]);class df extends l{constructor(){super()}get eventId(){return 36}ee(){this.Wd(136)}}Object(f.a)(df,"SheetRowsColumnsResizedEvent",l,[]);class pf extends l{constructor(){super()}get eventId(){return 68}ee(){this.Wd(183)}}
Object(f.a)(pf,"SheetShowGridlinesToggledEvent",l,[]);class kf extends l{constructor(){super()}get eventId(){return 67}ee(){this.Wd(184)}}Object(f.a)(kf,"SheetShowHeadingsToggledEvent",l,[]);class Af extends l{constructor(){super()}get eventId(){return 89}ee(){this.Wd(213)}}Object(f.a)(Af,"SheetSpellCheckedEvent",l,[]);class eb extends l{constructor(){super()}get eventId(){return 70}ee(){this.Wd(515)}}Object(f.a)(eb,"SheetTabColoredEvent",l,[]);class bb extends l{constructor(){super()}get eventId(){return 71}ee(){this.Wd(157)}}
Object(f.a)(bb,"SheetVisibilityChangedEvent",l,[]);class Rb extends l{constructor(){super()}get eventId(){return 126}ee(){this.Wd(239)}}Object(f.a)(Rb,"SheetsVisibilityChangedEvent",l,[]);class Q extends l{constructor(){super()}get eventId(){return 188}ee(){this.Wd(203)}}Object(f.a)(Q,"SlicerInsertedEvent",l,[]);class Ia extends l{constructor(){super()}get eventId(){return 189}ee(){this.Wd(173)}si(){this.zf(K=>!K.clearFilter)}}Object(f.a)(Ia,"SlicerSelectionAppliedEvent",l,[]);class ub extends l{constructor(){super()}get eventId(){return 190}ee(){this.Wd(173)}si(){this.zf(K=>
K.clearFilter)}}Object(f.a)(ub,"SlicerSelectionClearedEvent",l,[]);class Yb extends l{constructor(){super()}get eventId(){return 27}ee(){this.Wd(208)}si(){this.zf(K=>K.getParameters().FilterType===dd.Wfb)}}Object(f.a)(Yb,"TableCheckedItemsFilteredEvent",l,[]);class Ca extends l{constructor(){super()}get eventId(){return 144}ee(){this.Wd(237)}si(){this.zf(K=>!!K.insertDeleteMultiRangeParameters);this.zf(K=>K.insertDeleteMultiRangeParameters.IsTableCommand);this.zf(K=>0>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.zf(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(f.a)(Ca,"TableColumnDeletedEvent",l,[]);class tb extends l{constructor(){super()}get eventId(){return 145}ee(){this.Wd(237)}si(){this.zf(K=>!!K.insertDeleteMultiRangeParameters);this.zf(K=>K.insertDeleteMultiRangeParameters.IsTableCommand);this.zf(K=>0<K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.zf(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}
Object(f.a)(tb,"TableColumnInsertedEvent",l,[]);var $b=a(1020);class cd extends l{constructor(){super()}get eventId(){return 121}ee(){this.Wd(141)}si(){this.zf(K=>Object(L.a)($b.a,K))}}Object(f.a)(cd,"TableColumnSortedEvent",l,[]);class sd extends l{constructor(){super()}get eventId(){return 105}ee(){this.Wd(193)}}Object(f.a)(sd,"TableConvertedToRangeEvent",l,[]);class re extends l{constructor(){super()}get eventId(){return 16}ee(){this.Wd(206)}}Object(f.a)(re,"TableCreatedEvent",l,[]);class De extends l{constructor(){super()}get eventId(){return 30}ee(){this.Wd(209)}si(){this.zf(K=>
K.getParameters().FilterType===dd.Wfb)}}Object(f.a)(De,"TableCustomFilteredEvent",l,[]);class Ye extends l{constructor(){super()}get eventId(){return 25}ee(){this.Wd(187)}si(){this.zf(K=>1===K.options.OperationType)}}Object(f.a)(Ye,"TableCustomSortedEvent",l,[]);class $e extends l{constructor(){super()}get eventId(){return 28}ee(){this.Wd(176)}si(){this.zf(K=>K.pY().AutoFilterType===dd.Wfb);this.zf(K=>0===K.pY().CriteriaType)}}Object(f.a)($e,"TableFilterClearedEvent",l,[]);class tf extends l{constructor(){super()}get eventId(){return 32}ee(){this.Wd(176)}si(){this.zf(K=>
K.pY().AutoFilterType===dd.Wfb);this.zf(K=>{const Da=new r.a;Da.add(1);Da.add(2);Da.add(8);Da.add(9);Da.add(10);Da.add(11);Da.add(12);Da.add(13);Da.add(14);Da.add(15);Da.add(16);Da.add(17);Da.add(18);Da.add(19);Da.add(20);Da.add(21);Da.add(22);Da.add(23);Da.add(24);Da.add(25);Da.add(26);Da.add(27);Da.add(28);Da.add(29);Da.add(30);Da.add(31);Da.add(32);Da.add(33);Da.add(34);Da.add(35);Da.add(36);Da.add(37);Da.add(38);Da.add(39);return Da.contains(K.pY().CriteriaType)})}}Object(f.a)(tf,"TableItemFilteredEvent",
l,[]);class Jb extends l{constructor(){super()}get eventId(){return 101}ee(){this.Wd(217)}}Object(f.a)(Jb,"TableRenamedEvent",l,[]);class yc extends l{constructor(){super()}get eventId(){return 73}ee(){this.Wd(211)}}Object(f.a)(yc,"TableResizedEvent",l,[]);class Id extends l{constructor(){super()}get eventId(){return 44}ee(){this.Wd(514)}}Object(f.a)(Id,"TableRowColumnRearrangedEvent",l,[]);class qe extends l{constructor(){super()}get eventId(){return 146}ee(){this.Wd(237)}si(){this.zf(K=>!!K.insertDeleteMultiRangeParameters);
this.zf(K=>K.insertDeleteMultiRangeParameters.IsTableCommand);this.zf(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.zf(K=>0>K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(f.a)(qe,"TableRowDeletedEvent",l,[]);class Me extends l{constructor(){super()}get eventId(){return 147}ee(){this.Wd(237)}si(){this.zf(K=>!!K.insertDeleteMultiRangeParameters);this.zf(K=>K.insertDeleteMultiRangeParameters.IsTableCommand);this.zf(K=>!K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.zf(K=>0<K.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(f.a)(Me,"TableRowInsertedEvent",l,[]);class oa extends l{constructor(){super()}get eventId(){return 26}ee(){this.Wd(177)}si(){this.zf(K=>K.pY().AutoFilterType===dd.Wfb)}}Object(f.a)(oa,"TableSortedEvent",l,[]);class vb extends l{constructor(){super()}get eventId(){return 87}ee(){this.Wd(212)}}Object(f.a)(vb,"TableStyleAppliedEvent",l,[]);class Ac extends l{constructor(){super()}get eventId(){return 88}ee(){this.Wd(196)}}
Object(f.a)(Ac,"TableStyleOptionToggledEvent",l,[]);class jd extends l{constructor(){super()}get eventId(){return 31}ee(){this.Wd(210)}si(){this.zf(K=>K.getParameters().FilterType===dd.Wfb)}}Object(f.a)(jd,"TableTop10FilteredEvent",l,[]);class Ud extends l{constructor(){super()}get eventId(){return 207}ee(){this.Wd(238)}}Object(f.a)(Ud,"TextToColumnsEvent",l,[]);class ke extends l{constructor(){super()}get eventId(){return 128}ee(){this.Wd(559)}}Object(f.a)(ke,"ValuesSortedEvent",l,[]);class Pe extends l{constructor(){super()}get eventId(){return 55}ee(){this.Wd(197)}}
Object(f.a)(Pe,"WorkbookCalculationModeSetEvent",l,[]);class ze extends l{constructor(){super()}get eventId(){return 34}ee(){this.Wd(181)}si(){this.zf(K=>!!K.parentCommentId)}}Object(f.a)(ze,"WorkbookCommentRepliedEvent",l,[]);class Ue extends l{constructor(){super()}get eventId(){return 33}ee(){this.Wd(181)}si(){this.zf(K=>!K.parentCommentId)}}Object(f.a)(Ue,"WorkbookCommentedEvent",l,[]);class hg extends l{constructor(){super()}get eventId(){return 56}ee(){this.Wd(128)}}Object(f.a)(hg,"WorkbookRecalculatedEvent",
l,[]);class of extends l{constructor(){super()}get eventId(){return 46}ee(){this.Wd(171)}}Object(f.a)(of,"WorkbookRedoEvent",l,[]);class Gf extends l{constructor(){super()}get eventId(){return 45}ee(){this.Wd(170);this.Wd(1033)}}Object(f.a)(Gf,"WorkbookUndoEvent",l,[]);class Wf extends l{constructor(){super()}get eventId(){return 116}ee(){this.Wd(507);this.Wd(576);this.Wd(10)}si(){this.zf(K=>{if(Object(L.a)(V,K)&&(K=Object(S.a)(V,K),void 0!==K.source&&null!==K.source&&void 0!==K.eventId&&null!==K.eventId))return m.ULS.sendTraceTag(537155426,
0,50,`[RichApiRecorder]: received a valid but unhandled event: source: ${K.source}; eventId: ${K.eventId}.`),!0;m.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})}}Object(f.a)(Wf,"DefaultRichApiRequestExecutedEvent",l,[]);class bg extends l{constructor(){super()}get eventId(){return 216}ee(){this.Wd(1022)}}Object(f.a)(bg,"TablelAltTextEditedEvent",l,[]);class Dg extends l{constructor(){super()}get eventId(){return 217}ee(){this.Wd(263)}}Object(f.a)(Dg,
"FloatingObjectZOrderChangedEvent",l,[]);var Gg=a(1022);class Rf extends l{constructor(){super()}get eventId(){return 192}ee(){this.Wd(507)}si(){this.zf(K=>Object(L.a)(Gg.a,K)?!0:!1)}}Object(f.a)(Rf,"VisualPropertySetEvent",l,[]);class Eg extends E{constructor(){super(219,[510])}}Object(f.a)(Eg,"ChartSeriesDeletedEvent",E,[]);class vh extends l{get eventId(){return 220}ee(){this.Wd(1027)}}Object(f.a)(vh,"ChartDataChangedEvent",l,[]);class Og extends E{constructor(){super(221,[512])}}Object(f.a)(Og,
"ChartSeriesDataChangedEvent",E,[]);class e extends l{constructor(){super()}get eventId(){return 225}ee(){this.Wd(269)}}Object(f.a)(e,"FloatingObjectPutFloatingImageInCellEvent",l,[]);class sa extends l{constructor(){super()}get eventId(){return 224}ee(){this.Wd(268)}}Object(f.a)(sa,"ImageInCellConvertToFloatingObjectEvent",l,[]);class Ya{constructor(K){this.Ed=null;this.$=K}get macroRecorderEvents(){this.Ed||(this.Ed=new r.a,this.Ed.add(new xc),this.Ed.add(new uc),this.Ed.add(new ge),this.Ed.add(new Vc),
this.Ed.add(new Fc),this.Ed.add(new he),this.Ed.add(new je),this.Ed.add(new Fd),this.Ed.add(new Oc),this.Ed.add(new Zc),this.Ed.add(new yd),this.Ed.add(new Ce),this.Ed.add(new qa),this.Ed.add(new Pd),this.Ed.add(new Se),this.Ed.add(new re),this.Ed.add(new Ca),this.Ed.add(new tb),this.Ed.add(new qe),this.Ed.add(new Me),this.Ed.add(new hd),this.Ed.add(new Cc),this.Ed.add(new Ge),this.Ed.add(new se),this.Ed.add(new Ye),this.Ed.add(new oa),this.Ed.add(new Yb),this.Ed.add(new $e),this.Ed.add(new ad),this.Ed.add(new De),
this.Ed.add(new jd),this.Ed.add(new tf),this.Ed.add(new Ue),this.Ed.add(new ze),this.Ed.add(new Sb),this.Ed.add(new df),this.Ed.add(new Bb),this.Ed.add(new ic),this.Ed.add(new Ve),this.Ed.add(new Mb),this.Ed.add(new Hc),this.Ed.add(new pd),this.Ed.add(new cc),this.Ed.add(new Id),this.Ed.add(new of),this.Ed.add(new Gf),this.Ed.add(new wd),this.Ed.add(new Xa),this.Ed.add(new rb),this.Ed.add(new le),this.Ed.add(new Ee),this.Ed.add(new Pe),this.Ed.add(new hg),this.Ed.add(new Kd),this.Ed.add(new Eb),this.Ed.add(new vd),
this.Ed.add(new Wc),this.Ed.add(new Od),this.Ed.add(new dc),this.Ed.add(new fe),this.Ed.add(new nd),this.Ed.add(new y),this.Ed.add(new da),this.Ed.add(new kf),this.Ed.add(new pf),this.Ed.add(new hc),this.Ed.add(new bb),this.Ed.add(new eb),this.Ed.add(new yc),this.Ed.add(new Ad),this.Ed.add(new na),this.Ed.add(new X),this.Ed.add(new ed),this.Ed.add(new G),this.Ed.add(new Ga),this.Ed.add(new Y),this.Ed.add(new I),this.Ed.add(new ba),this.Ed.add(new R),this.Ed.add(new H),this.Ed.add(new J),this.Ed.add(new Z),
this.Ed.add(new Bd),this.Ed.add(new vb),this.Ed.add(new Ac),this.Ed.add(new Af),this.Ed.add(new cf),this.Ed.add(new Xd),this.Ed.add(new Ie),this.Ed.add(new ka),this.Ed.add(new nb),this.Ed.add(new Ea),this.Ed.add(new Ua),this.Ed.add(new Gb),this.Ed.add(new bc),this.Ed.add(new Pa),this.Ed.add(new sb),this.Ed.add(new Jb),this.Ed.add(new Va),this.Ed.add(new gd),this.Ed.add(new qb),this.Ed.add(new sd),this.Ed.add(new Bc),this.Ed.add(new te),this.Ed.add(new oc),this.Ed.add(new Yd),this.Ed.add(new Kb),this.Ed.add(new cb),
this.Ed.add(new ra),this.Ed.add(new Rd),this.Ed.add(new Aa),this.Ed.add(new lb),this.Ed.add(new B),this.Ed.add(new wb),this.Ed.add(new Wb),this.Ed.add(new mf),this.Ed.add(new cd),this.Ed.add(new Md),this.Ed.add(new Rb),this.Ed.add(new Za),this.Ed.add(new ke),this.Ed.add(new fa),this.Ed.add(new n),this.Ed.add(new ma),this.Ed.add(new Tb),this.Ed.add(new Ub),this.Ed.add(new Ab),this.Ed.add(new ia),this.Ed.add(new ue),this.Ed.add(new Sa),this.Ed.add(new $a),this.Ed.add(new vc),this.Ed.add(new Oa),this.Ed.add(new Pb),
this.Ed.add(new jb),this.Ed.add(new Ob),this.Ed.add(new kb),this.Ed.add(new Jd),this.Ed.add(new z),this.Ed.add(new Dd),this.Ed.add(new ob),this.Ed.add(new Tc),this.Ed.add(new ab),this.Ed.add(new be),this.Ed.add(new pb),this.Ed.add(new va),this.Ed.add(new Nb),this.Ed.add(new yb),this.Ed.add(new ib),this.Ed.add(new Ja),this.Ed.add(new Ta),this.Ed.add(new ec),this.Ed.add(new Ha),this.Ed.add(new U),this.Ed.add(new W),this.Ed.add(new jc),this.Ed.add(new sc),this.Ed.add(new Fa),this.Ed.add(new ua),this.Ed.add(new ja),
this.Ed.add(new hb),this.Ed.add(new gc),this.Ed.add(new Hb),this.Ed.add(new rc),this.Ed.add(new za),this.Ed.add(new Na),this.Ed.add(new Q),this.Ed.add(new Ia),this.Ed.add(new ub),this.Ed.add(new xd),this.Ed.add(new tc),this.Ed.add(new Qb),this.Ed.add(new Lc),this.Ed.add(new Gd),this.Ed.add(new pe),this.Ed.add(new Dc),this.Ed.add(new Wa),this.Ed.add(new Ba),this.Ed.add(new Yc),this.Ed.add(new $c),this.Ed.add(new Ud),this.Ed.add(new bd),this.Ed.add(new bg),this.Ed.add(new Dg),this.Ed.add(new Rf),this.Ed.add(new Eg),
this.Ed.add(new Og),this.Ed.add(new vh),this.Ed.add(new sa),this.Ed.add(new e),this.Ed.add(new Ld),k.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.izj());return this.Ed}Pef(K,Da){let xb=this.Qef(K,this.macroRecorderEvents,Da);xb||(xb=this.Qef(K,Ya.bli(),Da),!xb&&this.fvf(K,Ya.dWe,Da)&&(xb=Ya.dWe));return xb}Qef(K,Da,xb){const kc=new r.a;for(let Nc of Da)this.fvf(K,Nc,xb)&&kc.add(Nc);return 1===kc.count?kc.ma(0):1<kc.count?Ya.K2h(kc):null}fvf(K,Da,xb){const kc=Ya.Shj(K,
Da);return xb?kc&&Ya.bnk(K,Da):kc}izj(){const K=new r.a;for(let Da of this.Ed){let xb=!1;for(let kc of Da.featureGates)if(!k.EwaSettings.Ea(kc)){K.add(Da);xb=!0;break}if(!xb)for(let kc of Da.x6e)if(!k.EwaSettings.getBooleanFeatureGate(kc,!1)){K.add(Da);break}}for(let Da of K)this.Ed.remove(Da)}static bli(){Ya.JLb||(Ya.JLb=new r.a,Ya.JLb.add(new la),Ya.JLb.add(new La));return Ya.JLb}static Shj(K,Da){return Da.operations.contains(K.operation)}static bnk(K,Da){Da=Da.uNc;if(!Da.count)return!0;let xb=
!0;for(let kc of Da)if(!kc(K.payload)){xb=!1;break}return xb}static K2h(K){let Da=K.ma(0);for(let xb of K)xb.uNc.count>Da.uNc.count&&(Da=xb);return Da}}Ya.JLb=null;Ya.dWe=new Wf;Object(f.a)(Ya,"MacroRecorderEventList",null,[]);var Fb=a(63),pc=a(124);class Uc{equals(K,Da){return K===Da}getHashCode(K){return K}Una(K){return K}}Object(f.a)(Uc,"UserOperationNameComparer",null,[38,39]);class Sc{static hli(){Sc.Ke||(Sc.Ke=new M.a(new Uc),Sc.Ke.add(507),Sc.Ke.add(10),Sc.Ke.add(576),Sc.Ke.add(563),Sc.Ke.add(564),
Sc.Ke.add(565),Sc.Ke.add(566),Sc.Ke.add(567),Sc.Ke.add(568),Sc.Ke.add(569),Sc.Ke.add(570),Sc.Ke.add(571),Sc.Ke.add(572),Sc.Ke.add(573),Sc.Ke.add(574),Sc.Ke.add(575),Sc.Ke.add(501),Sc.Ke.add(520),Sc.Ke.add(1),Sc.Ke.add(1002),Sc.Ke.add(129),Sc.Ke.add(198),Sc.Ke.add(500),Sc.Ke.add(519),Sc.Ke.add(538),Sc.Ke.add(1E3),Sc.Ke.add(1003),Sc.Ke.add(144),Sc.Ke.add(502),Sc.Ke.add(505),Sc.Ke.add(179),Sc.Ke.add(205),Sc.Ke.add(134),Sc.Ke.add(230),Sc.Ke.add(103),Sc.Ke.add(110),Sc.Ke.add(112),Sc.Ke.add(113),Sc.Ke.add(124),
Sc.Ke.add(133),Sc.Ke.add(154),Sc.Ke.add(162),Sc.Ke.add(168),Sc.Ke.add(172),Sc.Ke.add(201),Sc.Ke.add(222),Sc.Ke.add(227),Sc.Ke.add(513),Sc.Ke.add(534),Sc.Ke.add(539),Sc.Ke.add(545),Sc.Ke.add(600),Sc.Ke.add(547),Sc.Ke.add(555),Sc.Ke.add(558),Sc.Ke.add(562),Sc.Ke.add(585),Sc.Ke.add(1001),Sc.Ke.add(1005),Sc.Ke.add(1008),Sc.Ke.add(1010),Sc.Ke.add(1011),Sc.Ke.add(1012),Sc.Ke.add(1018),Sc.Ke.add(1029),Sc.Ke.add(252),Sc.Ke.add(253),Sc.Ke.add(258),Sc.Ke.add(101),Sc.Ke.add(102),Sc.Ke.add(108),Sc.Ke.add(257),
Sc.Ke.add(119),Sc.Ke.add(120),Sc.Ke.add(123),Sc.Ke.add(126),Sc.Ke.add(127),Sc.Ke.add(130),Sc.Ke.add(140),Sc.Ke.add(159),Sc.Ke.add(160),Sc.Ke.add(165),Sc.Ke.add(166),Sc.Ke.add(167),Sc.Ke.add(169),Sc.Ke.add(189),Sc.Ke.add(223),Sc.Ke.add(214),Sc.Ke.add(228),Sc.Ke.add(233),Sc.Ke.add(247),Sc.Ke.add(504),Sc.Ke.add(511),Sc.Ke.add(512),Sc.Ke.add(525),Sc.Ke.add(533),Sc.Ke.add(537),Sc.Ke.add(542),Sc.Ke.add(544),Sc.Ke.add(548),Sc.Ke.add(550),Sc.Ke.add(551),Sc.Ke.add(552),Sc.Ke.add(554),Sc.Ke.add(577),Sc.Ke.add(584),
Sc.Ke.add(586),Sc.Ke.add(587),Sc.Ke.add(588),Sc.Ke.add(592),Sc.Ke.add(1009),Sc.Ke.add(1016),Sc.Ke.add(1017),Sc.Ke.add(1024),Sc.Ke.add(260),Sc.Ke.add(597),Sc.Ke.add(264),Sc.Ke.add(596),Sc.Ke.add(254),Sc.Ke.add(262),Sc.Ke.add(1030),Sc.Ke.add(1031),Sc.Ke.add(606));return Sc.Ke}}Sc.Ke=null;Object(f.a)(Sc,"MacroRecorderUnrecognizedEventList",null,[]);var Nd=a(15),ne=a(137);let ye=class{constructor(K,Da,xb){Da=void 0===Da?new Ya(K):Da;xb=void 0===xb?new v:xb;this.QBb=null;this.BVi=(kc,Nc)=>{this.ejg()&&
this.jmd(Nc)};this.PFf=Da;this.OFf=xb;this.$=K;this.$.UY&&this.$.G_g(this.BVi);k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2Services15",!1)||K.ga.Qa(297,this)}init(K){this.$.UY&&(K?this.QBb=K:m.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))}jmd(K){if(this.ejg())try{if(this.OFf.uBi(K)){var Da=this.OFf.Gek(K);for(const xb of Da)this.O7e(xb)}else this.O7e(K)}catch(xb){Da=`MacroRecorderEventHandler.FireMacroRecorderEvent: Error: ${pc.a(K.operation)}, Exception: ${xb.stack}`;
m.ULS.sendTraceTag(537155423,0,10,Da);try{this.jWh(K)}catch(kc){}}}O7e(K){var Da=this.PFf.Pef(K,!0);Da?(this.QBb(Da.eventId,Fb.a.He(K.payload)),m.ULS.sendTraceTag(537155422,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Da.eventId}`)):(Da=this.PFf.Pef(K,!1))?m.ULS.sendTraceTag(537155421,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Da.eventId}, but failed to match filters`):Sc.hli().contains(K.operation)||(this.QBb(0,Fb.a.He(K.operation)),K=`MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: ${pc.a(K.operation)}`,
m.ULS.sendTraceTag(537155420,0,50,K))}jWh(K){this.QBb(222,Fb.a.He(K.operation))}ejg(){return this.$.upa&&this.QBb&&this.$.A9?!0:!1}};ye=Object(x.a)([Object(ne.d)(Nd.Lb),Object(x.b)(0,Object(Nd.W)())],ye);Object(f.a)(ye,"MacroRecorderEventHandler",null,[772]);class bf extends u.a{constructor(K){super();this.$=K;this.je()}create(){this.Ld(this.$.ga.Da(297)||new ye(this.$,new Ya(this.$),new v))}static la(K){K.ga.Qa(298,new bf(K))}}Object(f.a)(bf,"MacroRecorderEventHandlerFactory",u.a,[]);var uf=a(2),
Qf=a(568);class Yf{constructor(){this.pGg=new r.a}get P$b(){return this.pGg}uci(K){m.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",K);const Da=new r.a;for(const xb of this.P$b)for(const kc of xb.hNb)kc.id===K&&Da.add(kc);return Da}Yze(K){this.P$b.add(K)}bzj(K){for(const Da of this.P$b)if(Da.MDe===K.MDe){this.P$b.remove(Da);break}}static eAh(K,Da,xb){xb=void 0===xb?null:xb;K=Yf.h5h(K);0<K.length&&(Yf.zGc(K,!1),xb&&xb(Da,K))}static h5h(K){const Da=[];if(K&&K.hNb&&0<K.hNb.count)for(const xb of K.hNb)if(xb.controls&&
0<xb.controls.count)for(const kc of xb.controls)if(kc.menuItems&&0<kc.menuItems.count)for(const Nc of kc.menuItems)Array.add(Da,Nc.id);return Da}static zGc(K,Da){if(K.length){var xb=[];for(const kc of K)xb.push(appChrome.actions.updateControlEnabledDisabledState(kc,Da));appChrome.api.dispatch(xb)}}}Object(f.a)(Yf,"ContextMenuExtensibilityCache",null,[835,836]);var Of=a(1386),eg=a(79),gf=a(5),Vg=a(923),Jh=a(863);class Nh{y3a(K,Da){Da=void 0===Da?null:Da;if(K=Jh.a.DCb(K)){appChrome.addInApi.dispatchActionsToInstallAddIn(K,
Da);for(const xb of K.tabs)if(xb.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(K,()=>{});break}}}wVd(K){(K=Jh.a.DCb(K))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(K)}$fg(){}static mAh(K,Da,xb){xb=void 0===xb?null:xb;K=Nh.Ffi(K);0<K.length&&(Nh.zGc(K,!1),xb&&xb(Da,K))}static Ffi(K){const Da=[];if(K&&(K=K.wZ,K.Mv&&0<K.Mv.count))for(const xb of K.Mv)if(xb.groups&&0<xb.groups.length)for(const kc of xb.groups)if(kc.controls&&0<kc.controls.length)for(const Nc of kc.controls)Array.add(Da,
Nc.id);return Da}static zGc(K){if(K.length){var Da=[];for(const xb of K)Da.push(appChrome.actions.updateControlEnabledDisabledState(xb,!0));appChrome.api.dispatch(Da)}}}Object(f.a)(Nh,"OneLineRibbonExtensibilityManager",null,[848]);var Qg=a(995);class bh{constructor(){this.dfe=this.TOc=null}get z3c(){return this.TOc||(this.TOc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set z3c(K){this.TOc=K}get W6g(){return this.dfe||(this.dfe=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(K,
Da){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(K,Da)}hud(K,Da,xb,kc,Nc,md,Cd){md=void 0===md?null:md;Cd=void 0===Cd?null:Cd;m.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",K);if((K=Da.nna(Nc.ownerAddinInfo.storeType,Nc.ownerAddinInfo.solutionId))&&K.lE&&!K.lE.getIsUpgrading())if(Da=null,0<K.lE.getNotificationParams().length&&(Da=this.AJe(K.lE.getNotificationParams()[0]))&&2147758681===Da.errorCode&&(K.isUpgraded=!0),2!==K.lE.getStatus()&&(1!==K.lE.getStatus()||
Da&&2147758681===Da.errorCode))Da&&this.Sjg(K,Da,Cd);else try{xb.setOwnerAddinEToken(K.lE.getEToken()),Nc.action(xb,kc.Yga),md&&md()}catch(Td){m.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",gf.AFrameworkApplication.da.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?Td.stack:Td.message)),Qg.a.I3d(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}Sjg(K,Da,xb){xb=void 0===xb?null:xb;const kc=K.lE;
if(1===kc.getNotificationParams().length||Da.Hnc){const Nc=Da.Pla,md=Da.Mma;Da.Pla=()=>{kc.removeFirstNotification();if(0<kc.getNotificationParams().length){const Cd=this.AJe(kc.getNotificationParams()[0]);this.Sjg(K,Cd)}2147758681===Da.errorCode&&(Nh.mAh(K.Aq,kc,Object(eg.a)(this,this.xpf,"initUpgradeStateDetectTask")),Yf.eAh(K.iyb,kc,Object(eg.a)(this,this.xpf,"initUpgradeStateDetectTask")));Nc&&Nc()};Da.Mma=()=>{md&&md();xb&&xb()};Qg.a.J3d(Da)}}xpf(K,Da){let xb=null;xb=()=>{K.getIsUpgrading()?
window.setTimeout(xb,1E3):K.getUpgradingFailed()?Nh.zGc(Da,!0):gf.AFrameworkApplication.sa.updateCommandUI()};window.setTimeout(xb,1E3)}AJe(K){const Da=new Vg.a;Da.lRa=K.infoType;Da.id=K.id;Da.title=K.title;Da.description=K.description;Da.buttonText=K.buttonTxt;Da.Pla=K.buttonCallback;Da.Hnc=K.highPriority;Da.Mma=K.dismissCallback;Da.errorCode=K.errorCode;Da.zof=K.iframeNotificationUrl;return Da}}Object(f.a)(bh,"AddinCommandsActionHandler",null,[834]);var Yg=a(84),kh=a(179),qh=a(734),nh=a(6),Zg=a(776),
Rg=a(733);class Eh{constructor(K,Da){this.Ya=K;this.Xlh=Da}P_h(K){if(void 0!==K&&null!==K&&K===nh.a.UQe)K="ContextMenuCell";else return null;const Da=this.Ya.Ne();this.g_h(Da,K);return Da}g_h(K,Da){Da=this.Xlh.uci(Da);for(let xb of Da){Da=xb.controls;for(let kc of Da)this.TZh(K,kc)}}TZh(K,Da){var xb=Da.wX[Zg.a.id];const kc=Da.wX[Zg.a.w_a],Nc=Da.wX[Zg.a.A_a];let md="Image16by16",Cd=Da.wX[Zg.a.x_a];Rg.c(Nc)&&(md="None");0<Da.menuItems.count?(xb=this.Ya.Vx(xb,xb,kc,798637440),xb.gUb(md,Nc,null),this.N_h(xb.menu,
Da),K.buttons.push(xb)):K.buttons.push(this.Ya.lNa(xb,kc,Cd,Nc,md,null,!1))}N_h(K,Da){const xb=this.Ya.Ne();for(let kc of Da.menuItems){Da=kc.fqa[Zg.a.id];const Nc=kc.fqa[Zg.a.w_a],md=kc.fqa[Zg.a.A_a];let Cd="Image16by16";const Td=kc.fqa[Zg.a.x_a];Rg.c(md)&&(Cd="None");Da=this.Ya.lNa(Da,Nc,Td,md,Cd,null,!1);xb.buttons.push(Da)}K.Ae.push(xb)}}Object(f.a)(Eh,"AddInCommandsContextMenuExtensibilityHandler",null,[867]);var hh=a(916);class ch{constructor(){this.ak=null;this.visible=!1}}Object(f.a)(ch,"AddinStatusCommandValues",
null,[]);class qg{static Cqj(K){const Da=new ch;Da.ak=K.Ywa;Da.visible=Da.ak?!0:!1;return Da}static kIc(K,Da,xb,kc,Nc){const md=document.getElementById(xb);md?qg.B0j(K,Da,md,kc,Nc):m.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",xb))}static B0j(K,Da,xb,kc,Nc){xb?K.Ywa===CommonUIStrings.l_ErrorLoadingAddInsTitle?Qg.a.i_j(Da,xb,kc,Nc):K.Ywa===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&Qg.a.I0j(Da,xb):m.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}
Object(f.a)(qg,"AddinCommandsStatusHandler",null,[]);var zg=a(39),wh=a(236),Ag=a(16),Sg=a(30),dh=a(90);class Sh extends zg.a{constructor(K,Da){super();this.agaveCommandManager=this.statusBarManager=null;this.NNe=()=>{this.wE&&this.wE.qNe()};this.jkf=()=>{this.raiseEvent("LAC")};this.ff=(xb,kc)=>{!xb.oe&&wh.b(kc)&&this.statusBarManager&&(this.statusBarManager.MI(this),this.statusBarManager=null)};this.wE=Da;this.$=K;Sg.a.Yn()||(this.mJc=K.Pd+"OfficeAddinLabel-Medium14");this.$.ga.qd(29,xb=>{this.statusBarManager=
xb;xb.zM(this)});this.$.ea.Zl(this.ff);this.wE.hYg(this.jkf);this.$.ga.qd(206,xb=>{this.agaveCommandManager=xb;xb.MZg(this.NNe)})}Xs(K){this.addHandler("LAC",K)}Gt(K){this.removeHandler("LAC",K)}Ru(K,Da){if("QueryAddinLabel"!==K)return!1;K=!1;Sg.a.Yn()?(K=appChrome.selectors.getControlLabel(dh.a.wLd),K=!(!K&&!this.wE.Ywa)&&K!==this.wE.Ywa):K=Da[hh.a.LabelText]!==this.wE.Ywa;K&&(K=qg.Cqj(this.wE),Da[hh.a.LabelText]=K.ak,Da[hh.a.Visible]=K.visible,window.setTimeout(()=>{this.kIc()},0));return!0}Up(){return!0}kIc(){if(this.$){if(Sg.a.Yn()&&
isNullOrUndefined(this.mJc)){const K=document.querySelector('button[data-unique-id="StatusBar-OfficeAddinLabel"]');K&&(this.mJc=K.getElementsByClassName("ms-Button-label")[0].id)}this.mJc&&qg.kIc(this.wE,this.$.domElement,this.mJc,Ag.a.instance.ia(333),Ag.a.instance.ia(334))}}dispose(){this.$.ea.gm(this.ff);this.wE.nAj(this.jkf);this.agaveCommandManager&&(this.agaveCommandManager.EBj(this.NNe),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.MI(this),this.statusBarManager=
null);this.wE=this.$=null;super.dispose()}}Object(f.a)(Sh,"AddinCommandsStatusBarManager",zg.a,[295,188]);var Tf=a(176),ag=a(118),Cf=a(753),yh=a(919),xa=a(1228),wa=a(835),Ic=a(136),Zd=a(112),Ke=a(581),Te=a(144);class If{constructor(){this.R3a=null}setErrorMessageForAddin(K,Da){this.R3a||(this.R3a={});this.R3a[K]=Da}y7h(K){return this.R3a&&K in this.R3a?this.R3a[K]:null}}Object(f.a)(If,"AddinCommandsErrorManager",null,[]);var Ef=a(105);class ta{constructor(){this.lu=this.tra=0;this.e6c=null;this.jBc=
this.eLc=0;this.Dua=this.ITc=this.lPc=null}get s8b(){this.lPc||(this.lPc=new r.a);return this.lPc}get Jnd(){this.ITc||(this.ITc=new r.a);return this.ITc}get bNa(){this.Dua||(this.Dua=new r.a);return this.Dua}}Object(f.a)(ta,"AddinCommandsListLoaderContext",null,[]);var zb=a(869);class qc{constructor(K,Da){this.entitlement=K;this.metadata=Da}cXb(){var K=this.entitlement;const Da={};Da.solutionId=K.solutionId;Da.version=K.version;Da.storeType=K.storeType;Da.storeId=K.storeId;Da.assetId=K.assetId;Da.assetStoreId=
K.assetStoreId;Da.targetType=K.targetType;Da.requireConsent=K.requireConsent||!1;Da.isAddinCommands=!0;Da.addinCommandsActionType=0;Da.targetType=this.targetType;return Da}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==this.entitlement.targetType?
this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(f.a)(qc,"AddinEntitlementEx",null,[]);var Kc=a(271),Xc=a(342);class Sd{}Object(f.a)(Sd,"AppsForOfficeEntitlementQueryInfo",null,[]);var me=a(42),Le=a(31);class Xe{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(f.a)(Xe,"AddinAbstract",null,[]);
class rf extends Sys.EventArgs{constructor(){super();this.Aq=this.Mm=null}}Object(f.a)(rf,"InsertionParamEventArgs",Sys.EventArgs,[]);class Ff{constructor(K,Da,xb,kc){this.JSb=gf.AFrameworkApplication.da.Sa("RoamingServiceHandlerWebServiceBase");this.appName=K;this.MIa=Da;this.ppb=xb;this.Hrb=void 0===kc?null:kc}bld(K){this.D5e(K,"getAddinTeachingCalloutSettings",Object(eg.a)(this,this.goa,"getRequestSuccessCallback"),Object(eg.a)(this,this.yY,"getRequestFailureCallback"))}kSh(){const K=new r.a;K.add(this.appName);
this.D5e(K,"getTeachingCalloutSettingsForAddinBetterEntryPoint",Object(eg.a)(this,this.tfi,"getRequestSuccessCallbackForBEP"),Object(eg.a)(this,this.yY,"getRequestFailureCallback"))}D5e(K,Da,xb,kc){const Nc=new Sys.StringBuilder(this.JSb);Nc.append("RoamingServiceHandler.ashx?action=");Nc.append(Da);Nc.append("&");Nc.append(this.$rd(K));Nc.append("&");Nc.append(gf.AFrameworkApplication.Ak);gf.AFrameworkApplication.tf.Ho(Nc.toString(),1,null,null,!0,2,xb,kc,null)}zhc(K){this.I5e(K,"saveAddinTeachingCalloutSettings")}pSh(K){this.I5e(K,
"saveTeachingCalloutSettingsForAddinBetterEntryPoint")}I5e(K,Da){const xb=new Sys.StringBuilder(this.JSb);xb.append("RoamingServiceHandler.ashx?action=");xb.append(Da);xb.append("&");xb.append(gf.AFrameworkApplication.Ak);Da=xb.toString();K=me.c(K);gf.AFrameworkApplication.tf.Ho(Da,2,K,null,!0,4,null,Object(eg.a)(this,this.Y$,"postRequestFailureCallback"),null)}goa(K){let Da=!1,xb=null;try{if(0<K.data.Tf.length){const kc=Object(S.a)(Object,me.a(K.data.Tf)),Nc=kc?kc[this.appName]:null;Nc&&(xb=Object(S.a)(Object,
me.a(Nc.toString())))}Da=!0}catch(kc){this.yY(null)}Da&&this.MIa&&this.MIa(xb)}tfi(K){let Da=!1,xb=null;try{if(0<K.data.Tf.length){const kc=Object(S.a)(Object,me.a(K.data.Tf));xb=Object(S.a)(String,kc[this.appName])||null}Da=!0}catch(kc){this.yY(null)}Da&&this.MIa&&(K={},K.Platforms=xb,this.MIa(K))}yY(K){this.ppb&&this.ppb(K?K.data:null)}Y$(K){this.Hrb&&this.Hrb(K?K.data:null)}$rd(K){const Da=new Sys.StringBuilder("requestedsettings=");for(let xb=0;xb<K.count;xb++)Da.append(K.ma(xb)),xb<K.count-1&&
Da.append(";");return Da.toString()}}Object(f.a)(Ff,"AddinTeachingUIRoamingRequestHandler",null,[]);class Kf extends Sys.EventArgs{constructor(K){super();this.solutionId=K.solutionId;this.assetId=K.assetId;this.storeType=K.storeType;this.storeId=K.storeId;this.assetStoreId=K.assetStoreId;this.targetType=K.targetType;this.width=K.width;this.height=K.height;this.displayName=K.displayName;this.version=K.version}}Object(f.a)(Kf,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var Pf=a(357);
class ya{constructor(K){this.U3a=this.Mm=null;this.YWa=!1;this.Dua=this.KZb=this.sha=this.Vg=this.qPc=this.Tib=null;this.Ua=K}get appName(){return gf.AFrameworkApplication.da.Sa("WebAppShortName")}get Pub(){this.qPc||(this.qPc=new Ff(this.appName,Object(eg.a)(this,this.goa,"getRequestSuccessCallback"),Object(eg.a)(this,this.yY,"getRequestFailureCallback"),Object(eg.a)(this,this.Y$,"postRequestFailureCallback")));return this.qPc}get Xwa(){this.KZb||(this.KZb=new r.a);return this.KZb}set Xwa(K){this.KZb=
K}get bNa(){this.Dua||(this.Dua=new r.a);return this.Dua}set bNa(K){this.Dua=K}oVg(K,Da){window.addEventListener?(this.Mm=K,this.U3a=Da,window.addEventListener("LaunchAddinTaskpane",Object(eg.a)(this,this.yaj,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(eg.a)(this,this.FMd,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(eg.a)(this,this.sMd,"onCloseButtonClickedEventHandler"),!0),window.addEventListener("FGWebSurfaceEvent",
Object(eg.a)(this,this.VLf,"onCampaignLaunchedHandler"),!0)):m.ULS.sendTraceTag(508625357,220,15,"AddEventListenerForTeachingCallout failed to get Window")}a9d(K,Da,xb,kc){this.Vg=K;this.Xwa=Da;this.bNa=xb;this.sha=kc;m.ULS.sendTraceTag(508625356,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",Da?Da.count.toString():"null",xb?xb.count.toString():"null");0<this.Xwa.count||0<this.bNa.count?(K=new r.a,K.add(this.appName),this.Pub.bld(K)):this.sha(new r.a,
null)}yaj(){const K=new Kc.ScriptSharpLegacyMap;this.U3a&&this.U3a.tabs&&!this.U3a.tabs[0].isOfficeTab&&K.fa("SDX.FeatureFlags","NonOfficeTab");this.Ldb(ya.q$a(this.Mm),"ClickOnLaunch",K);this.pvc();this.U3a?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.U3a,()=>{const Da=new rf;Da.Mm=this.Mm;this.Ua.raiseEvent(Cf.a.JAf,Da)}):m.ULS.sendTraceTag(508625355,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}sMd(){this.Ldb(ya.q$a(this.Mm),"ClickOnClose");this.pvc()}FMd(){this.Ldb(ya.q$a(this.Mm),
"ClickOnDismiss");this.pvc()}VLf(K){if(K&&(K=K.detail)&&K.id&&this.NBi(K.id)){const Da=(K.action||"").toLowerCase();if(K.success&&"opened"===Da)this.Ldb(ya.q$a(this.Mm),"CampaignLaunched"),m.ULS.sendTraceTag(508625354,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.pvc(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(eg.a)(this,this.VLf,"onCampaignLaunchedHandler"),!0);else{let xb;try{xb=JSON.stringify(K),m.ULS.sendTraceTag(508625353,220,
15,"Campaign launch failure. Event:"+xb)}catch(kc){xb="id : "+K.id+" telemetryEventName: "+K.telemetryEventName,m.ULS.sendTraceTag(508625352,220,50,"Error serializing campaign event. "+xb+" Error: "+(kc?kc.toString():""))}}}}NBi(K){K=Le.a.Tm(K);return-1!==K.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==K.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==K.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==K.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==K.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||
-1!==K.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}ZEc(K){if(this.appName){const Da={},xb={};xb.LastTeachingUIShowTime=(new Date).toUTCString();xb.AddinHasShown=K;Da[this.appName]=me.c(xb);this.Pub.zhc(Da);m.ULS.sendTraceTag(508625351,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else m.ULS.sendTraceTag(508625350,220,10,"Fail to save roaming service since AppName is null")}pvc(){if(!this.YWa){const K=window.g_roamingAddinList;K&&
(this.ZEc(K),this.YWa=!0)}}goa(K){K?this.u3d(K)?(m.ULS.sendTraceTag(508625348,220,50,"should show teaching UI"),this.Tib="AddinHasShown"in K&&K.AddinHasShown?K.AddinHasShown.toString():null,this.hQe()):(m.ULS.sendTraceTag(508625347,220,50,"Not Show TeachingUI this time"),this.sha(this.Xwa,null)):(m.ULS.sendTraceTag(508625349,220,50,"userSettings is null"),this.Tib=null,this.hQe())}yY(K){m.ULS.sendTraceTag(508625346,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",K?K.httpStatus:
-1);this.sha(this.Xwa,null)}Y$(K){m.ULS.sendTraceTag(508625345,220,10,"failed to POST data to Roaming Settings Service with status: {0}",K?K.httpStatus:-1)}hQe(){const K=this.$yh();0===K.targetType?(K.solutionId?this.yqj(K):this.Ldb(null,"NoSolutionId"),this.pwg(K),this.sha(this.Xwa,null)):this.sha(this.Xwa,K);m.ULS.sendTraceTag(508625344,220,50,"Show teaching callout for: {0}",K.addinId)}yqj(K){const Da=new Sd;Da.callbackFunc=xb=>{if(xb.errorCode){this.Ldb(K.solutionId,"FailToGetAppDetails");var kc=
window.g_roamingAddinList;kc&&this.ZEc(kc)}else if(xb.value)for(kc of xb.value)if(xb=kc[1],xb===K.solutionId){const Nc={};Nc.solutionId=xb;Nc.assetId=kc[5];Nc.storeType=kc[12];Nc.storeId=kc[11];Nc.assetStoreId=kc[6];Nc.targetType=kc[3];Nc.width=kc[7];Nc.height=kc[8];Nc.displayName=kc[0];Nc.version=kc[4];m.ULS.sendTraceTag(508625315,220,50,"Raise a teaching callout event for content addin: {0}.",K.solutionId);kc=new Kf(Nc);this.Ua.raiseEvent(Cf.a.Xjg,kc);break}};Da.storeType=OSF.StoreTypeEnum.PrivateCatalog;
Da.fromInsertDialog=!1;Da.refresh=!1;this.Vg.queryEntitlementDetails(Da)}u3d(K){if("LastTeachingUIShowTime"in K){if(K=+new Date-+new Date(K.LastTeachingUIShowTime.toString()),K<gf.AFrameworkApplication.da.wY("AddinShowTeachingUIIntervalInMS",864E5))return m.ULS.sendTraceTag(508625314,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",K),!1}else m.ULS.sendTraceTag(508625313,220,50,"userSetting has no date key");return!0}$yh(){let K=new Xc.a(new Xe,0),Da=new Xc.a(new Xe,0),xb=
0,kc=0,Nc=0;var md=new r.a;for(var Cd of this.Xwa)md.add(Cd);for(const Td of this.bNa)md.add(Td);for(const Td of md)if(!("excatalog"!==Td.storeType||Rg.c(Td.installTimeInMS)||!Td.installTimeInMS||Td.installTimeInMS<=gf.AFrameworkApplication.da.wY("DateTimeInMSForNewAddin",16409952E5))){md=ya.S$e(Td);if(this.Tib&&(Cd=this.Tib.split(","),0<Cd.length&&Array.contains(Cd,md))){Nc++;m.ULS.sendTraceTag(508625312,220,50,"This addin has shown teaching UI before");continue}md.startsWith("private_")?(K=ya.yef(Td,
K),kc++):(Da=ya.yef(Td,Da),xb++)}m.ULS.sendTraceTag(508625311,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",kc,xb,Nc);return 0<Da.value?Da.key:0<K.value?K.key:Object.assign(new Xe,{addinId:null,targetType:-1,solutionId:null})}Ldb(K,Da,xb){xb=void 0===xb?null:xb;K={["AppTeachingUICalloutAction"]:Da,["SDX.Id"]:K,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(xb)for(const kc of xb.keys)K[kc]=xb.ma(kc);
Tf.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ag.a.$k(K)}))}pwg(K){K&&(window.g_roamingAddinList=this.Tib?this.Tib+","+K.addinId:K.addinId)}static q$a(K){return Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.storeType,K.assetId,null,null,K.storeId)}static yef(K,Da){return Da.value<K.installTimeInMS?new Xc.a(Object.assign(new Xe,{addinId:ya.S$e(K),targetType:K.targetType,solutionId:K.solutionId}),K.installTimeInMS):Da}static S$e(K){return Telemetry.PrivacyRules.IsPrivateAddin(K.storeType,
K.assetId,null,null,K.storeId)?"private_"+K.installTimeInMS:K.solutionId}}Object(f.a)(ya,"PrivateCatalogTeachingCalloutHandler",null,[]);var Db=a(64);const lc=()=>{const K=Db.a.u2(window.location.href.toLowerCase(),"wdomexsrctype");return!!K&&"4"===K},zc=()=>Db.a.u2(window.location.href.toLowerCase(),"wdtpl"),id=()=>{const K=Db.a.u2(window.location.href.toLowerCase(),"wdomexsrctype");return!!K&&"1"===K};var Vd=a(868);class de extends Sys.EventArgs{constructor(K){super();this.properties=K}}Object(f.a)(de,
"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class Je{constructor(K,Da,xb){this.Ua=new Ef.a;this.context=new ta;this.X1c=null;this.contextActivationMgr=K;this.k1g=Da;this.r8b=xb;this.appName=gf.AFrameworkApplication.da.Sa("WebAppShortName")}get MWb(){this.X1c||(this.X1c=new ya(this.Ua));return this.X1c}fYg(K){this.Ua.addHandler(Cf.a.gDe,K)}H0g(K){this.Ua.addHandler(Cf.a.Xjg,K)}Zdk(K){null!==K&&(this.context.tra=K[Cf.a.T0],this.context.lu=K[Cf.a.$W],this.context.eLc=this.context.jBc=
0,K=Cf.a.dLa in K?K[Cf.a.dLa]:0,-1!==this.context.tra&&0!==this.context.lu&&(this.context.e6c=this.k1g.createAddinDataProvider(Vd.a(this.context.tra),this.contextActivationMgr),this.context.e6c?this.context.e6c.getEntitlementsAsync(this.contextActivationMgr.Yga,!0,K,Da=>{this.Kaj(Da)}):m.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.tra)))}Kaj(K){if(K&&0<K.length){this.context.eLc=K.length;const xb=gf.AFrameworkApplication.da.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?
zc():null;for(let kc=0;kc<K.length;kc++){const Nc=K[kc];if(gf.AFrameworkApplication.da.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&id()&&Nc&&Nc.storeType&&"omex"===Nc.storeType.toLowerCase()&&Nc.assetId&&xb&&Nc.assetId.toLowerCase()===xb.toLowerCase()){var Da={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:Je.q$a(Nc)};Tf.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:ag.a.$k(Da)}))}!Nc||1!==Nc.targetType&&-1!==Nc.targetType?
this.OLd():(Da={},gf.AFrameworkApplication.da.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(Da.solutionId=Nc.solutionId,Da.version=Nc.version):(Da.marketplaceId=Nc.solutionId,Da.marketplaceVersion=Nc.version),Da.storeType=Nc.storeType,Da.storeId=Nc.storeId,Da.targetData=Nc,this.contextActivationMgr.isAddinCommandsExAsync(Da,Object(eg.a)(this,this.daj,"onIsAddinCommandsExCompleted")))}}else this.OLd()}OLd(){var K;(K=this.context).jBc=
K.jBc+1;this.context.jBc>=this.context.eLc&&(this.r8b.geg(this.context.tra,!1),0<this.context.eLc&&10===this.context.tra&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(K=!1,lc()&&(K=this.eSi(this.context.Jnd)),this.rRi(this.context.Jnd),K?this.sha(this.gQe(this.context.s8b)):this.MWb.a9d(this.contextActivationMgr,this.context.s8b,this.context.bNa,(Da,xb)=>{const kc=new r.a;for(const Nc of Da)Da=Nc.cXb(),xb&&xb.solutionId===Nc.solutionId&&(Da.showCallout=!0,this.MWb.pwg(xb)),
kc.add(Da);this.sha(kc)})):this.sha(this.gQe(this.context.s8b)))}gQe(K){const Da=new r.a;if(K)for(const xb of K)Da.add(xb.cXb());return Da}sha(K){K&&K.count||zb.a.zLc(Cf.a.d6c,"false",this.context.tra);K={["ack2"]:K};K[Cf.a.T0]=this.context.tra;K[Cf.a.$W]=this.context.lu;this.Ua.raiseEvent(Cf.a.gDe,new de(K),this)}eSi(K){let Da=!1;if(K&&1>K.count)return Da;const xb=zc();if(!xb)return Da;for(const kc of K)if(kc.storeId&&kc.storeId.toLowerCase()===xb.toLowerCase()||kc.assetId&&kc.assetId.toLowerCase()===
xb.toLowerCase())K={["SDX_Id"]:Je.tgf(kc),["SDX_TargetType"]:Rg.c(kc.targetType)?"":kc.targetType.toString()},Tf.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:ag.a.$k(K)})),Da=!0;return Da}rRi(K){if(!(K&&1>K.count))if(this.r8b.zGi()){var Da=this.r8b.Qdi();Da?(K=this.Sbf(K,Da),m.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(K=this.Sbf(K,null),m.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.r8b.LSj(K)}else m.ULS.sendTraceTag(528589915,
306,50,"Local storage got disabled")}Sbf(K,Da){const xb={};let kc=!1;for(const Nc of K)if(K=Je.tgf(Nc))!Da||K in Da||(this.kC(Nc,K),m.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===K.toLowerCase()?kc||(kc=!0,xb[K]=null):xb[K]=null;return xb}kC(K,Da){var xb=K.installTimeInMS?(new Date(K.installTimeInMS)).toISOString():"";xb={["SDX.Id"]:Da,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Rg.c(K.targetType)?"":K.targetType.toString(),["SDX.AdminDeploymentTime"]:xb};
Tf.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:ag.a.$k(xb)}));1===K.targetType&&(K={["SDX.Id"]:Da,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},Tf.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:ag.a.$k(K)})))}daj(K,Da,xb,kc){K?(K=new qc(xb.targetData,kc),Da&&this.context.s8b.add(K),10===this.context.tra&&(this.context.Jnd.add(K),0===K.targetType&&this.context.bNa.add(K))):
(Da=xb.targetData,m.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Da.solutionId,Da.storeType,Da.assetId,null,null,Da.storeId),Da.storeType));this.OLd()}static q$a(K){return Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.storeType,K.assetId,null,null,K.storeId)}static tgf(K){return Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.storeType,K.assetId,null,null,K.storeId)}}Object(f.a)(Je,"AddInCommandsListLoader",
null,[]);class Ze{constructor(K){this.MNg=K}get Yga(){return this.MNg}insertOsfControl(K){return this.Yga.insertOsfControl(K)}getManifestInvaildErrorString(){return this.Yga.getManifestInvaildErrorString()}isAddinCommandsAsync(K,Da){this.Yga.isAddinCommandsAsync(K,Da)}isAddinCommandsExAsync(K,Da){this.Yga.isAddinCommandsExAsync(K,Da)}ownerAddinControlRecreated(K,Da){this.Yga.ownerAddinControlRecreated(K,Da)}queryEntitlementDetails(K){this.Yga.queryEntitlementDetails(K)}}Object(f.a)(Ze,"ContextActivationMgrWrapper",
null,[832]);class yf{createAddinDataProvider(K,Da){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(K,Da.Yga)}static get instance(){yf.La||(yf.La=new yf);return yf.La}}yf.La=null;Object(f.a)(yf,"OSFAddinDataProviderFactory",null,[826]);class Lf{constructor(){this.Ver=1}}Object(f.a)(Lf,"CacheItem",null,[]);class aa{constructor(K){this.kJa=K}Zj(K){const Da=this.kJa.getItem(K);if(Da){let xb=new Lf;try{xb=Sys.Serialization.JavaScriptSerializer.deserialize(Da,!0)}catch(kc){return this.kJa.removeItem(K),
null}return xb.Data?xb.Data:xb.data}return null}qWa(K){this.kJa.removeItem(K)}}Object(f.a)(aa,"AppsDataCacheManager",null,[847]);class db{constructor(){new aa(wa.a.instance)}geg(K,Da){K=Cf.a.$cf()+K;wa.a.instance.setItem(K,Da.toString())}Qdi(){var K=Cf.a.ugf();m.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",K);K=wa.a.instance.getItem(K);return me.a(K)}LSj(K){const Da=Cf.a.ugf();m.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",Da);wa.a.instance.setItem(Da,me.c(K))}zGi(){return!!wa.a.instance.localStorage}static get instance(){db.La||
(db.La=new db);return db.La}}db.La=null;Object(f.a)(db,"AddInCommandsCacheManager",null,[825]);class N{constructor(K){this.qKc=null;this.YWa=!1;this.Ua=new Ef.a;this.KSb=this.oua=null;this.contextActivationMgr=K;window.addEventListener&&(window.addEventListener("LaunchBEPCallout",Object(eg.a)(this,this.Bcj,"onPrimaryButtonClickedEventHandler"),!0),window.addEventListener("DismissBEPCallout",Object(eg.a)(this,this.FMd,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseBEPCallout",
Object(eg.a)(this,this.sMd,"onCloseButtonClickedEventHandler"),!0))}get appName(){Rg.b(this.oua)&&(this.oua=gf.AFrameworkApplication.da.Sa("WebAppShortName"));return this.oua}e_g(K){this.Ua.addHandler(Cf.a.OAf,K)}a9d(){this.contextActivationMgr.queryStoreDisabled("omex",K=>{K?m.ULS.sendTraceTag(509686157,344,50,"Store is disabled for current user"):this.Eck()})}Eck(){this.qKc=new Ff(this.appName,Object(eg.a)(this,this.goa,"getRequestSuccessCallback"),Object(eg.a)(this,this.yY,"getRequestFailureCallback"),
Object(eg.a)(this,this.Y$,"postRequestFailureCallback"));this.qKc.kSh()}goa(K){this.u3d(K)&&(m.ULS.sendTraceTag(509690977,344,50,"should show teaching UI"),this.A4d())}yY(K){m.ULS.sendTraceTag(509690976,344,10,"Failed to GET data from Roaming Settings with status: {0}",K?K.httpStatus:-1)}Y$(K){m.ULS.sendTraceTag(509690975,344,10,"Failed to POST data to Roaming Settings with status: {0}",K?K.httpStatus:-1)}u3d(K){if(!K)m.ULS.sendTraceTag(509690974,344,50,"userSettings is null");else if("Platforms"in
K&&(this.KSb=Object(S.a)(String,K.Platforms),!Rg.b(this.KSb)&&(K=this.KSb.split(","),0<K.length&&Array.contains(K,"Web"))))return m.ULS.sendTraceTag(509690973,344,50,"callout has shown for this platform"),!1;return!0}A4d(){if(!gf.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.WordOnline.CEBlockPopupEnabled",!1)){var K=Yg.a.instance.Qd("Common.ISystemInitiatedFeedback");if(K){var Da=this.q1h();Rg.b(Da)?m.ULS.sendTraceTag(509686979,344,50,"activity name is empty"):K.execute(xb=>{xb.logActivity(Da,
null)})}else m.ULS.sendTraceTag(509690972,344,50,"Error resolving ISystemInitiatedFeedback Future")}}Bcj(){this.kC("ClickOnLaunch");this.oZd();this.Ua.raiseEvent(Cf.a.OAf)}sMd(){this.kC("ClickOnClose");this.oZd()}FMd(){this.kC("ClickOnDismiss");this.oZd()}q1h(){let K;switch(this.appName){case "Word":K="WordShowCalloutForBEPHomeTab";break;case "Excel":K="ExcelShowCalloutForBEPHomeTab";break;case "PowerPoint":K="PPTShowCalloutForBEPHomeTab";break;default:K=""}return K}kC(K){K={["AppTeachingUICalloutAction"]:K,
["AppTeachingUICalloutGoal"]:"BetterEntryPoint"};Tf.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ag.a.$k(K)}))}oZd(){if(!this.YWa)if(Rg.b(this.appName))m.ULS.sendTraceTag(509690970,344,10,"Fail saving to roaming service since AppName is null");else{const K={};K[this.appName]=this.KSb?this.KSb+",Web":"Web";this.qKc&&(this.qKc.pSh(K),m.ULS.sendTraceTag(509690971,344,50,"Initiating call to save Roaming Settings for current user"));this.YWa=
!0}}}Object(f.a)(N,"BetterEntryTeachingCalloutLauncher",null,[]);class pa{constructor(K,Da,xb,kc,Nc,md){this.lu=K;this.Mm=Da;this.r4=xb;this.displayName=Nc;this.Kzf=md}}Object(f.a)(pa,"PostLaunchAddinCommandsParameters",null,[]);class Ib{constructor(K){this.XWc=null;this.Ale=K}get WSa(){return this.XWc}y3a(K,Da){this.Ale.y3a(K,void 0===Da?null:Da);this.XWc=K}wVd(K){this.Ale.wVd(K)}$fg(K){this.XWc=K}}Object(f.a)(Ib,"RibbonExtensibilityManagerWithChangeDetection",null,[848]);var nc=a(922),kd=a(106);
class Wd{static Udf(K){const Da=new r.a;if(Wd.UPe)for(var xb of Wd.UPe)Da.add(xb);xb=null;switch(K){case "Workbook":xb=Wd.Xok;break;case "Document":xb=Wd.gCh;break;case "Presentation":xb=Wd.moj}if(xb)for(const kc of xb)Da.add(kc);return Da}}Wd.UPe=["PrimaryCommandSurface","ContextMenu"];Wd.Xok=null;Wd.gCh=null;Wd.moj=null;Object(f.a)(Wd,"ExtensionPointType",null,[]);class Ae{constructor(K){this.Rqe=null;if(Rg.c(K))throw m.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),
Error.create("The agave key should not be null or undefined");this.TEg=K}get hNb(){return this.Rqe||(this.Rqe=new r.a)}get MDe(){return this.TEg}}Object(f.a)(Ae,"ContextMenuExtensibility",null,[831]);class Oe{constructor(K,Da,xb){Da=void 0===Da?null:Da;xb=void 0===xb?0:xb;if(Rg.c(K))throw m.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.FNg=K;this.UQg=Da;this.AJg=
xb}get wZ(){return this.FNg}get startedNode(){return this.UQg}get O0h(){return this.AJg}}Object(f.a)(Oe,"RibbonExtensibility",null,[864]);class sf{constructor(K){this.DIg=K.entitlement}get entitlement(){return this.DIg}createActionContext(K,Da){K={};K.ownerAddinInfo=this.entitlement;K.action=Da;return K}}Object(f.a)(sf,"AddInCommandsContextProvider",null,[]);class ff{constructor(K,Da,xb){this.see=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;
this.ribbonBuilder=K;this.eventBuilder=Da;this.contextMenuBuilder=xb}get addinInfo(){return this.see}zph(K){return new sf(K)}createActionBuilder(K,Da){return OfficeExt.DefaultControlActionBinder.createActionBuilder(K,Da.entitlement,Da.manifest)}startApplyAddin(K){this.see=K;const Da=this.zph(K);this.actionBuilder=this.createActionBuilder(Da,K)}endApplyAddin(){}god(K,Da,xb){xb=void 0===xb?0:xb;return this.ribbonBuilder.Mv&&0<this.ribbonBuilder.Mv.count?new Oe(this.b0h(K,Da),this.addinInfo.startedNode,
xb):null}h$e(){var K=void 0===K?null:K;if(this.contextMenuBuilder.Ivc&&0<this.contextMenuBuilder.Ivc.count){K||(K=this.addinInfo.entitlement.solutionId);K=new Ae(K);for(const Da of this.contextMenuBuilder.Ivc)K.hNb.add(Da);return K}return null}b0h(K,Da){return this.ribbonBuilder.Mv&&0<this.ribbonBuilder.Mv.count?new Jh.a(this.ribbonBuilder.Mv,K,Da):null}}Object(f.a)(ff,"AddinCommandsBuilder",null,[]);class cg{constructor(K,Da,xb,kc,Nc,md,Cd){this.UYa=new kd.a;this.lu=K;this.Vg=Da;this.lr=xb;this.ribbonManager=
kc;this.contextMenuManager=Nc;this.wE=md;this.ila=Cd;this.MR=gf.AFrameworkApplication.sa.EG}EKb(K,Da,xb,kc,Nc,md,Cd){const Td=(we,Fe,vf,Jf)=>{Nc(we,Fe,vf,Jf);const lg=nc.a[this.lu]+Fe.assetId;let ph;(()=>{let eh=this.UYa.kf(lg);({value:ph}=eh);return eh})().returnValue&&(ph.stop(),ph=null,this.UYa.remove(lg))};if(0!==this.lu&&K){m.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",K.count);4===this.lu&&(m.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",
kc)),this.Ogh(K,kc),md());for(const we of K)if(K=we,m.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.lr.iQ,Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.ownerAddinStoreType||K.storeType,K.assetId,null,null,K.storeId))),this.iyg(K))if(Cd&&K.requireConsent)Cd(K,Fe=>{try{if(this.MR){const Jf=nc.a[this.lu]+Fe.solutionId,lg=this.MR.Ze("ComponentAttach",Jf);this.UYa.fa(Jf,lg)}const vf=this.wE.nna(Fe.storeType,Fe.solutionId);6!==this.lu&&(vf&&(this.dbc(vf),vf.lE.purge(!1)),
this.Vg.insertOsfControl(this.OPb(Fe,Da,xb,Td)),vf&&this.Vg.ownerAddinControlRecreated(Fe.solutionId,Fe.storeType))}catch(vf){m.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.lr.iQ,Telemetry.PrivacyRules.GetPrivacyCompliantId(Fe.solutionId,Fe.ownerAddinStoreType||Fe.storeType,Fe.assetId,null,null,Fe.storeId),Fe.version,Fe.storeType,Fe.storeId,vf.message)),Td(!1,Fe,null,null)}});
else try{if(this.MR){const vf=nc.a[this.lu]+K.solutionId,Jf=this.MR.Ze("ComponentAttach",vf);this.UYa.fa(vf,Jf)}const Fe=this.wE.nna(K.storeType,K.solutionId);!gf.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFAddinLaunchRefactor",!1)||3!==gf.AFrameworkApplication.sa.Ra.kj&&1!==gf.AFrameworkApplication.sa.Ra.kj&&2!==gf.AFrameworkApplication.sa.Ra.kj||3!==this.lu||"excatalog"===K.storeType||!Fe||Fe.isUpgraded?6!==this.lu&&(Fe&&(this.dbc(Fe),Fe.lE.purge(!1)),this.Vg.insertOsfControl(this.OPb(K,
Da,xb,Td)),Fe&&this.Vg.ownerAddinControlRecreated(K.solutionId,K.storeType)):(this.ribbonManager.$fg(Fe.Aq),Td(!0,K,null,Fe.displayName))}catch(Fe){m.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.lr.iQ,Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.ownerAddinStoreType||K.storeType,K.assetId,null,null,K.storeId),K.version,K.storeType,K.storeId,Fe.message)),Td(!1,K,
null,null)}else Td(!1,K,null,null)}}DOi(K,Da,xb,kc,Nc,md){const Cd=(Td,we,Fe,vf)=>{md(Td,we,Fe,vf);const Jf=nc.a[this.lu]+we.solutionId;let lg;(()=>{let ph=this.UYa.kf(Jf);({value:lg}=ph);return ph})().returnValue&&(lg.stop(),lg=null,this.UYa.remove(Jf))};if(6===this.lu&&K)if(m.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.lr.iQ,Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.ownerAddinStoreType||K.storeType,K.assetId,null,null,K.storeId))),this.iyg(K))try{if(this.MR){const we=
nc.a[this.lu]+K.solutionId,Fe=this.MR.Ze("ComponentAttach",we);this.UYa.fa(we,Fe)}const Td=this.wE.nna(K.storeType,K.solutionId);Td||Cd(!1,K,null,null);gf.AFrameworkApplication.sa&&gf.AFrameworkApplication.sa.Ra.delayInstallAddInIsEnabled?this.E$e(K,Da,kc,Nc,xb,we=>{Cd(we,K,xb,Td.displayName)}):(this.E$e(K,Da,kc,Nc,xb),Cd(!0,K,xb,Td.displayName))}catch(Td){m.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",
this.lr.iQ,Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.ownerAddinStoreType||K.storeType,K.assetId,null,null,K.storeId),K.version,K.storeType,K.storeId,Td.message)),Cd(!1,K,null,null)}else Cd(!1,K,null,null)}a3i(K,Da,xb,kc,Nc,md){if(md)if(md._isAddinCommandsManifest(this.lr.iQ))try{gf.AFrameworkApplication.sa&&gf.AFrameworkApplication.sa.Ra.delayInstallAddInIsEnabled?this.D$e(K,Da,xb,Nc,md,Cd=>{kc(Cd,K,md,md.getDefaultDisplayName())}):(this.D$e(K,Da,xb,Nc,md),kc(!0,K,md,md.getDefaultDisplayName()))}catch(Cd){m.ULS.sendTraceTag(17586257,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.lr.iQ,Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.ownerAddinStoreType||K.storeType,K.assetId,null,null,K.storeId),K.version,K.storeType,K.storeId,Cd.message)),kc(!1,K,md,md.getDefaultDisplayName())}else m.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",
this.lr.iQ,Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.ownerAddinStoreType||K.storeType,K.assetId,null,null,K.storeId),K.version,K.storeType,K.storeId)),kc(!1,K,null,null);else m.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.lr.iQ,Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.ownerAddinStoreType||K.storeType,K.assetId,null,null,K.storeId),K.version,K.storeType,K.storeId)),
kc(!1,K,null,null)}OPb(K,Da,xb,kc){const Nc={},md=document.createElement("div");md.setAttribute("visible","false");Nc.div=md;Nc.id=K.solutionId;Nc.solutionId=K.solutionId;Nc.version=K.version;Nc.storeType=K.storeType;Nc.storeId=K.storeId;Nc.assetId=K.assetId;Nc.assetStoreId=K.assetStoreId;Nc.isvirtualOsfControl=!0;Nc.virtualOsfControlActivationCallback=(Cd,Td)=>{const we=this.wE.nna(K.storeType,K.solutionId);we&&(we.isUpgraded&&(K.isUpgraded=!0),this.dbc(we));this.a3i(K,Da,xb,kc,Cd,Td)};Nc.reason=
3===this.lu?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return Nc}D$e(K,Da,xb,kc,Nc,md){md=void 0===md?null:md;const Cd={};Cd.solutionId=kc.getSolutionId();Cd.version=kc.getVersion();Cd.storeType=kc.getStoreType();Cd.storeId=kc.getStoreId();Cd.assetId=kc.getAssetId();Cd.assetStoreId=kc.getAssetStoreId();Cd.targetType=kc.getOsfControlType();let Td=null,we=null;if(gf.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1))Td=(new OfficeExt.Parser.AddinCommandsManifestParser(this.lr.iQ,this.lr.formFactor)).parseExtensions(Cd,Nc,this.ila),we=Wd.Udf(this.lr.iQ);else try{Td=(new OfficeExt.Parser.AddinCommandsManifestParser(this.lr.iQ,this.lr.formFactor)).parseExtensions(Cd,Nc,this.ila),we=Wd.Udf(this.lr.iQ)}catch(vf){throw m.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+vf.message),vf;}if(we&&0<we.count){if(gf.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1)){var Fe=Da(K);Da=xb(K);xb=!!gf.AFrameworkApplication.da&&gf.AFrameworkApplication.da.pa("AddinCommandsMultipleCustomTabsEnabled");Fe=new ff(Fe,null,Da);for(const vf of we)Fe.commandSurface=vf,Td.apply(Fe,this.ila,xb)}else try{const vf=Da(K),Jf=xb(K),lg=!!gf.AFrameworkApplication.da&&gf.AFrameworkApplication.da.pa("AddinCommandsMultipleCustomTabsEnabled");Fe=new ff(vf,null,Jf);for(const ph of we)Fe.commandSurface=ph,Td.apply(Fe,this.ila,lg)}catch(vf){throw m.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+
vf.message),vf;}if(OSF.OUtil.checkFlight(14))try{const vf=Fe.god(K.solutionId,Nc.getDefaultDisplayName()),Jf=Fe.h$e();vf&&this.ribbonManager.y3a(vf,md);Jf&&this.contextMenuManager.Yze(Jf);this.wE.xAe(kc,vf,Jf,Nc.getDefaultDisplayName());m.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Nc.getDefaultDisplayName())}catch(vf){throw OfficeExt.DevConsole.log(vf),m.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+vf.message),vf;}else try{const vf=Fe.god(K.solutionId,
Nc.getDefaultDisplayName()),Jf=Fe.h$e();vf&&this.ribbonManager.y3a(vf);Jf&&this.contextMenuManager.Yze(Jf);this.wE.xAe(kc,vf,Jf,Nc.getDefaultDisplayName());m.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Nc.getDefaultDisplayName())}catch(vf){throw m.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+vf.message),vf;}}}E$e(K,Da,xb,kc,Nc,md){md=void 0===md?null:md;const Cd={};Cd.solutionId=K.solutionId;Cd.version=K.version;Cd.storeType=K.storeType;Cd.storeId=
K.storeId;Cd.assetId=K.assetId;Cd.assetStoreId=K.assetStoreId;Cd.targetType=K.targetType;const Td=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.lr.iQ,this.lr.formFactor);try{const we=Da.getManifest(),Fe=Td.parse(Cd,we,Nc,this.ila,Da.getSharedRuntimeId(),Da),vf=xb(K),Jf=kc(K),lg=new ff(vf,null,Jf);lg.commandSurface="PrimaryCommandSurface";Fe.apply(lg,this.ila,!0);if(lg.ribbonBuilder.Mv&&0<lg.ribbonBuilder.Mv.count){const ph=lg.god(K.solutionId,Da.getManifest().getDefaultDisplayName(),1);gf.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.ribbonManager.y3a(ph,md):ph&&this.ribbonManager.y3a(ph,md);this.wE.iWg(Da,ph,Nc,Da.getManifest().getDefaultDisplayName());m.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",Da.getManifest().getDefaultDisplayName())}}catch(we){m.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",Da.getManifest().getDefaultDisplayName(),we.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(we)}}dbc(K){K.Aq&&this.ribbonManager.wVd(K.Aq);
K.iyb&&this.contextMenuManager.bzj(K.iyb);this.wE.Kyj(K.lE.getStoreType(),K.lE.getSolutionId())}Ogh(K,Da){Da=Vd.a(Da);for(const xb of this.wE.Mab){if(xb.lE.getStoreType()!==Da)continue;let kc=!0;for(const Nc of K){const md=Nc;if(md&&xb.Pwf(md.storeType,md.solutionId)){kc=!1;break}}kc&&(this.dbc(xb),xb.lE.purge(!1))}}iyg(K){return!!K&&!!K.solutionId&&!!K.version&&!!K.storeType&&!!K.storeId}}Object(f.a)(cg,"AddInCommandsIntegration",null,[]);class jg{constructor(K,Da,xb,kc,Nc,md,Cd,Td){Td=void 0===
Td?null:Td;this.$a=new Ef.a;this.nPc=K;this.rHg=Da;this.Wl=xb;this.exe=kc;this.k2a=Nc;this.HEg=md;this.LZb=Cd;this.wNg=Td}gYg(K){this.$a.addHandler(Cf.a.hDe,K)}d_g(K){this.$a.addHandler(Cf.a.JAf,K)}G0g(K){this.$a.addHandler(Cf.a.Yjg,K)}mYg(K){this.$a.addHandler(Cf.a.t8c,K)}WOi(K,Da,xb){const kc=xb[Cf.a.Mub],Nc=void 0===xb[Cf.a.$W]?0:xb[Cf.a.$W];if(kc&&0!==Nc)if(0>=kc.count&&4!==Nc)this.cZf(new pa(Nc,null,null,Da,null,!0));else{var md=kc.count,Cd=new Ib(new Nh),Td=void 0===xb[Cf.a.T0]?-1:xb[Cf.a.T0],
we=new cg(Nc,this.Wl,this.nPc,Cd,this.rHg,this.k2a,this.LZb),Fe=eh=>this.exe.U$g(eh.solutionId,this.LZb,this.nPc,K),vf=eh=>this.exe.d$g(eh.solutionId),Jf=(eh,$g,Ug)=>{md--;Ug=new pa(Nc,$g,Cd,Da,Ug,0>=md);if(eh&&$g)this.cZf(Ug);else{if(3===Nc||$g&&$g.isUpgraded)eh="",$g&&(eh=Telemetry.PrivacyRules.GetPrivacyCompliantId($g.solutionId,$g.ownerAddinStoreType||$g.storeType,$g.assetId,null,null,$g.storeId)),$g={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:eh},
Tf.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:ag.a.$k($g)}));this.bZf(Ug)}md||gf.AFrameworkApplication.sa.updateCommandUI()},lg=(eh,$g,Ug,Ch)=>{Jf(eh,$g,Ch)},ph=()=>{this.fLd();0>=kc.count&&4===Nc&&this.k2a.w0d()};6===Nc?(Td=xb[Cf.a.aOa],xb=xb[Cf.a.bOa],we.DOi(kc.ma(0),Td,xb,Fe,vf,(eh,$g,Ug,Ch)=>{Jf(eh,$g,Ch)})):we.EKb(kc,Fe,vf,Td,lg,ph,this.wNg)}else Tf.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.AppInstall",
dataFields:ag.a.$k({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),m.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.nPc.iQ)),this.bZf(new pa(Nc,null,null,Da,null,!0))}bZf(K){this.fLd(K);this.Skg(!1,K)}cZf(K){const Da=K.Mm;let xb=null;null!==Da&&(xb=Da.storeType,xb=xb.toLowerCase());if(K&&"omex"===xb&&(3===K.lu||Da.isUpgraded)){var kc={["SDX_AppInstallOrigin"]:"User",
["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Da.solutionId,Da.ownerAddinStoreType||Da.storeType,Da.assetId,null,null,Da.storeId)};Tf.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:ag.a.$k(kc)}))}this.fLd(K);kc=id()&&"omex"===xb&&!!K.r4&&!!Da.solutionId&&2===K.lu&&Da.solutionId.toLowerCase()===zc().toLowerCase();var Nc="excatalog"===xb&&3===K.lu;if("omex"===xb&&K.r4&&(3===K.lu&&"hardcodedpreinstall"!==xb||
Da.isUpgraded)||kc||Nc)kc=new rf,kc.Mm=Da,kc.Aq=K.r4.WSa,this.$a.raiseEvent(Cf.a.t8c,kc);kc=lc();Nc=zc();kc&&Da&&"excatalog"===Da.storeType&&K.r4&&5===K.lu&&Nc&&(Da.storeId&&Da.storeId.toLowerCase()===Nc.toLowerCase()||Da.assetId&&Da.assetId.toLowerCase()===Nc.toLowerCase())&&(kc=new rf,kc.Mm=Da,kc.Aq=K.r4.WSa,this.$a.raiseEvent(Cf.a.t8c,kc),m.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."));Da&&(db.instance.geg(Vd.b(xb),!0),"uploadfiledevcatalog"===xb&&(kc=this.HEg.createAddinDataProvider(xb,
this.Wl))&&kc.localCacheAddinCommands(this.Wl.Yga,Da.solutionId,Da.version,Da.storeId),zb.a.zLc(Cf.a.d6c,"true",Vd.b(xb)));this.Skg(!0,K)}Skg(K,Da){K?Da.r4&&5===Da.lu&&Da.r4.WSa&&void 0!==Da.Mm.showCallout&&null!==Da.Mm.showCallout&&Da.Mm.showCallout?((new ya(this.$a)).oVg(Da.Mm,Jh.a.DCb(Da.r4.WSa)),K=new rf,K.Aq=Da.r4.WSa,K.Mm=Da.Mm,this.$a.raiseEvent(Cf.a.Yjg,K)):3!==Da.lu?Da.Kzf&&this.k2a.w0d():Da.r4&&Da.r4.WSa&&"hardcodedpreinstall"!==Da.Mm.storeType&&Qg.a.k_j(Da.displayName,Da.r4.WSa,Da.Mm.isAutoLaunched):
3===Da.lu?Da.Mm&&"uploadfiledevcatalog"===Da.Mm.storeType.toLowerCase()?(Da=this.LZb.y7h(Da.Mm.solutionId),Qg.a.I3d(Da?Da:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.k2a.pfg():Da.Kzf&&this.k2a.w0d()}fLd(K){var Da=(K=void 0===K?null:K)?K.Mm:null;const xb=new rf;if(xb.Mm=Da){var kc=this.k2a.nna(Da.storeType,Da.solutionId,6===K.lu?1:0);if(kc&&kc.Aq){xb.Aq=kc.Aq;var Nc=zc();Nc=id()&&!!Da.solutionId&&!!Nc&&Da.solutionId.toLowerCase()===Nc.toLowerCase()&&2===K.lu;
if(3===K.lu&&"hardcodedpreinstall"!==Da.storeType||Nc)K="",kc.Aq.wZ&&kc.Aq.wZ.Mv&&(kc=kc.Aq.wZ.Mv.ma(0))&&(K=kc.id),Da={["SDX_CommandPlacement"]:K,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Da.solutionId,Da.ownerAddinStoreType||Da.storeType,Da.assetId,null,null,Da.storeId)},Tf.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:ag.a.$k(Da)}))}}this.$a.raiseEvent(Cf.a.hDe,
xb)}}Object(f.a)(jg,"LaunchAddinCommandsHandler",null,[828]);class pg{}pg.w_a="Alt";pg.x_a="Command";pg.id="Id";pg.A_a="Image16by16";pg.uZb="LabelText";pg.B_a="Title";pg.GROUP="Group";pg.dde="Groups";pg.Xmb="Controls";pg.button="Button";pg.Qea="FlyoutAnchor";pg.LARGE="Large";pg.SMALL="Small";Object(f.a)(pg,"AddinDataNodeConstants",null,[]);var Wg=a(386);a(576);var ih=a(571);a(147);class Ah{constructor(K,Da){this.qJa=this.$ge=null;if(Rg.c(K)||Rg.c(Da))throw m.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),
Error.create("ControlDefinition id or type should not be null or undefined");this.yHg=Da;this._id=K;this.wX[pg.id]=this._id}get id(){return this._id||""}get wX(){return this.$ge||(this.$ge={})}get controlType(){return this.yHg||""}get menuItems(){return this.qJa||(this.qJa=new r.a)}}Object(f.a)(Ah,"ControlDefinition",null,[830]);class ki{constructor(K){this.ype=null;if(Rg.c(K))throw m.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");
this._id=K;this.fqa[pg.id]=this._id}get fqa(){return this.ype||(this.ype={})}get id(){return this._id||""}}Object(f.a)(ki,"MenuItemDefinition",null,[852]);class ai{constructor(K){this.Fua=null;if(Rg.c(K))throw m.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=K}get id(){return this._id}get controls(){return this.Fua||(this.Fua=new r.a)}}Object(f.a)(ai,"OfficeMenuDefinition",
null,[827]);var fg=a(27);class Bi{constructor(K,Da,xb){this.jM=this.n0a=null;this.GYc=K;this.d0a=Da;this.D_a=xb;this.VMg=new r.a}get owc(){return this.GYc}get Nxb(){return this.d0a}get y3c(){return this.D_a}addButton(K){m.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",K.actionType);this.jM=new Ah(this.xxa(K.id),pg.button);this.jM.wX[pg.uZb]=K.label;this.jM.wX[pg.w_a]=K.label;this.jM.wX[pg.A_a]=K.icon["16"];this.Zvb(this.jM.wX[pg.id],K.action);this.MKa(this.jM.wX);this.n0a.controls.add(this.jM);
this.jM=null}startBuildMenu(K){if(Rg.c(this.n0a))this.n0a=new ai(K.id);else{const Da=this.xxa(K.id);this.jM=new Ah(Da,pg.Qea);this.j5a(this.jM.wX,K);this.jM.wX[pg.A_a]=K.icon["16"];this.jM.wX[pg.x_a]=fg.a.alwaysEnabled}}addMenuItem(K){m.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",K.actionType);const Da=new ki(this.xxa(K.id));this.j5a(Da.fqa,K);K.icon&&(Da.fqa[pg.A_a]=K.icon["16"]);this.Zvb(Da.fqa[pg.id],K.action);this.MKa(Da.fqa);this.jM.menuItems.add(Da)}endBuildMenu(){Rg.c(this.jM)?
(this.Ivc.add(this.n0a),this.n0a=null):(this.n0a.controls.add(this.jM),this.jM=null)}get Ivc(){return this.VMg}Zvb(K,Da){this.y3c.bindAction(K,Da)}MKa(K){this.Nxb.MKa(K)}xxa(K){return this.owc.FPa(K)}j5a(K,Da){K[pg.uZb]=Da.label;K[pg.w_a]=Da.label}}Object(f.a)(Bi,"ContextMenuExtensibilityCreator",null,[846,842]);class Wi{constructor(K){this.crb=K}get CMb(){return this.crb}FPa(K){return this.CMb+K}}Object(f.a)(Wi,"DefaultContextMenuNamingProvider",null,[845]);var Pi=a(1230);class Qi{bindAction(K,Da){OfficeExt.DefaultControlActionBinder.bindAction(K,
Da)}}Object(f.a)(Qi,"DefaultUIControlActionBinder",null,[844]);class zh{constructor(K){this.THa=K}get command(){return this.THa}MKa(K){K[pg.x_a]=this.command}}Object(f.a)(zh,"DefaultUIControlCommandBinder",null,[843]);var Ri=a(29);class Jg{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(f.a)(Jg,"AddInControl",null,[]);class hj{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=
null}}Object(f.a)(hj,"AddInGroup",null,[]);class Ci{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(f.a)(Ci,"AddInMenuItem",null,[]);class ij{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(f.a)(ij,"AddInTab",null,[]);class yi{constructor(K,Da,xb,kc,Nc,md){this.IZb=new r.a;this.hob=this.oja=this.o0a=null;this.GYc=K;this.D_a=
Da;this.d0a=xb;this.Vz=kc;this.LZb=Nc;this.gje=md}get owc(){return this.GYc}get Mv(){return this.IZb}get y3c(){return this.D_a}get Nxb(){return this.d0a}startBuildTab(K){const Da=K.isOfficeTab?K.id:this.owc.sif(K.id),xb=K.isOfficeTab?null:K.label;this.o0a=Object.assign(new ij,{id:Da,title:xb,isOfficeTab:K.isOfficeTab,visible:K.visible,groups:[],tabType:K.tabType,insertBefore:K.insertBefore,insertAfter:K.insertAfter,autoFocus:K.autoFocus})}startBuildGroup(K){const Da=this.xxa(K.id);this.oja=Object.assign(new hj,
{id:Da,mlrId:K.mlrId,title:K.label,controls:[],groupType:0})}addNativeGroup(K){this.oja=Object.assign(new hj,{id:K.id,mlrId:K.mlrId,title:K.label,controls:[],groupType:1});this.o0a.groups.push(this.oja)}addButton(K){const Da=this.xxa(K.id);Da&&(this.Zvb(Da,K.action),m.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",K.actionType),K=Object.assign(new Jg,{id:Da,title:K.label,iconLocation:this.Mqd(K),enabled:K.enabled,controlType:0,attributes:this.j5a()}),this.gje.Jze(new Ri.a(Da,
this.Nxb.command.toString())),this.oja.controls.push(K))}addNativeControl(K){K.id&&(m.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",K.actionType),K=Object.assign(new Jg,{id:K.id,title:"",iconLocation:"",enabled:K.enabled,controlType:2,attributes:this.j5a()}),this.oja.controls.push(K))}startBuildMenu(K){const Da=this.xxa(K.id);Da&&(this.hob=Object.assign(new Jg,{id:Da,title:K.label,iconLocation:this.Mqd(K),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(K){const Da=
this.xxa(K.id);Da&&(this.Zvb(Da,K.action),m.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",K.actionType),K=Object.assign(new Ci,{id:Da,title:K.label,iconLocation:this.Mqd(K),enabled:K.enabled,attributes:this.j5a()}),this.gje.Jze(new Ri.a(Da,this.Nxb.command.toString())),this.hob.menuItems.push(K))}endBuildMenu(){Rg.c(this.hob.id)||this.oja.controls.push(this.hob);this.hob=null}endBuildGroup(){Rg.c(this.oja.id)||this.o0a.groups.push(this.oja);this.oja=null}endBuildTab(){Rg.c(this.o0a.id)||
this.IZb.add(this.o0a);this.o0a=null}j5a(){const K={};this.MKa(K);return K}Mqd(K){return K.icon["80"]?K.icon["80"]:K.icon["32"]}MKa(K){this.Nxb.MKa(K)}xxa(K){return this.owc.FPa(K)}Zvb(K,Da){this.y3c.bindAction(K,Da)}}Object(f.a)(yi,"OneLineRibbonExtensibilityCreator",null,[841,842]);class Th{constructor(K,Da){this.crb=K;this.D_a=new Qi;this.d0a=new zh(Da)}d$g(K){K=new Wi(K);return new Bi(K,this.d0a,this.D_a)}U$g(K,Da,xb,kc){xb=new Pi.a(this.crb,K,xb,!0);return new yi(xb,this.D_a,this.d0a,K,Da,kc)}}
Object(f.a)(Th,"UIExtensibilityFactory",null,[824]);var Uh=a(93),lj=a(920),pi=a(22),jh=a(38),Qe=a(77),F=a(53);class ea{constructor(K){this.bLa=this.fLa=this.Mm=this.Aq=null;this.G5f=0;this.waj=()=>{if(this.Mm&&this.bLa){const Da=new Uh.a(fg.a.A6,0,0,2,null);this.addinUICommandHandler.executeCommand(0,Da,{["SourceControlId"]:this.bLa},null);m.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.l_j=(Da,xb)=>{Da=null;if(xb)if(Da=xb,this.Mm=Da.Mm,(this.Aq=Da.Aq)&&this.Aq.wZ&&
this.Aq.wZ.Mv&&(this.fLa=this.Aq.wZ.Mv.ma(0)),this.fLa&&this.fLa.id)if(this.fLa.isOfficeTab)if(xb=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),Da=this.Mm.solutionId,Da in xb?this.bLa=xb[Da]:(xb=ea.GetPrivacyCompliantId(this.Mm),m.ULS.sendTraceTag(537170695,220,15,`Failed to get button id from controlIdMap for add-in: ${xb}`),this.bLa=this.z1h(this.Aq)),this.bLa)if(pi.a.contains(this.fLa.id,nh.a.nR,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Jh.a.DCb(this.Aq),
()=>{this.wlg(this.asd(this.bLa))});else{if(xb=this.$.Ha)xb.ZCe(this.RUf),m.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else m.ULS.sendTraceTag(537170694,220,10,"Failed to get button id for addin"),xb={["AppTeachingUICalloutAction"]:"NoEnabledButtonFound",["SDX.Id"]:ea.GetPrivacyCompliantId(this.Mm),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Tf.a.sendTelemetryEvent(Object(uf.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:ag.a.$k(xb)})),this.l$();else this.ylg(this.asd(this.fLa.id),0);else m.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),xb={["AppTeachingUICalloutAction"]:"NoTabFound",["SDX.Id"]:ea.GetPrivacyCompliantId(this.Mm),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Tf.a.sendTelemetryEvent(Object(uf.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ag.a.$k(xb)})),this.l$();
else this.l$()};this.RUf=()=>{if(pi.a.contains(this.fLa.id,appChrome.selectors.getSelectedTabId(),!0)){var Da=this.$.Ha;Da&&Da.y7f(this.RUf);this.wlg(this.asd(this.bLa))}};this.zaj=()=>{var Da={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:ea.y_a(this.zF),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Tf.a.sendTelemetryEvent(Object(uf.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ag.a.$k(Da)}));this.l$();let xb=
{};xb[Qe.a.Th]=this.zF;Da={};Da.solutionId=this.zF.solutionId;Da.assetId=this.zF.assetId;Da.assetStoreId=this.zF.assetStoreId;Da.height=0!=this.zF.height?this.zF.height:600;Da.storeId=this.zF.storeId;Da.storeType=this.zF.storeType;Da.targetType=this.zF.targetType;Da.width=0!=this.zF.width?this.zF.width:600;Da.displayName=this.zF.displayName;Da.version=this.zF.version;Da.isAddinCommands=!1;xb[Cf.a.jla]=Da;let kc=new Uh.a(-741808261,0,0,2,null);jh.TaskExtensions.za(F.GetServiceTaskFactory.ud(this.$.ga,
374,375,1),Nc=>{Nc=Nc.result;null!=Nc&&Nc.insertAgave(xb,kc)},this.$.ka,3)};this.$4i=()=>{let Da={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:ea.y_a(this.zF),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Tf.a.sendTelemetryEvent(Object(uf.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ag.a.$k(Da)}));this.l$()};this.y6i=()=>{let Da={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:ea.y_a(this.zF),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};Tf.a.sendTelemetryEvent(Object(uf.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ag.a.$k(Da)}));this.l$()};this.Y$=Da=>{m.ULS.sendTraceTag(522981591,306,10,`failed to POST data to Roaming Settings Service with status: ${Da?Da.httpStatus:-1}`)};this.$=K.$;this.addinUICommandHandler=K;this.appName=gf.AFrameworkApplication.da.Sa("WebAppShortName")||"Excel";this.p1g=gf.AFrameworkApplication.da.Hf("AddinMaxDOMElementDetectionTimesForTeachingUI",
10)}static GetPrivacyCompliantId(K){return Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.storeType,K.assetId,null,null,K.storeId)}static y_a(K){return Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,K.storeType,K.assetId,null,null,K.storeId)}ayj(K){this.zF=K;window.addEventListener&&(window.addEventListener("LaunchContentAddin",this.zaj,!0),window.addEventListener("DismissCallout",this.y6i,!0),window.addEventListener("CloseCallout",this.$4i,!0))}asd(K){return"[id="+K+"]"}ylg(K,
Da){Da>this.p1g?(window.clearTimeout(this.G5f),this.xlg("[data-unique-id='pivotOverflowButton']"),m.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+K)?this.xlg(K):this.G5f=window.setTimeout(()=>{this.ylg(K,Da+1)},1E3)}wlg(K){var Da=document.querySelector("button[data-unique-id='RightPaddle']");if(Da)K={["AppTeachingUICalloutAction"]:"RightPaddlePresent",["SDX.Id"]:ea.GetPrivacyCompliantId(this.Mm),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"},Tf.a.sendTelemetryEvent(Object(uf.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ag.a.$k(K)}));else if(Da=document.querySelector("button"+K),!Da||"none"===window.getComputedStyle(Da).display)if(Da=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!Da){Da={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:ea.GetPrivacyCompliantId(this.Mm),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};
Tf.a.sendTelemetryEvent(Object(uf.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ag.a.$k(Da)}));m.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");this.l$();return}this.Vrg(Da,"ShowTeachingUIForAddinButton")}xlg(K){K=document.querySelector("button"+K);if(!K&&(K=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!K)){K={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:ea.GetPrivacyCompliantId(this.Mm),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};Tf.a.sendTelemetryEvent(Object(uf.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ag.a.$k(K)}));m.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.l$();return}this.Vrg(K,"ShowTeachingUIForAddinTab")}Vrg(K,Da){K.setAttribute("lpp-id","latestAddin");const xb=Yg.a.instance.Qd("Common.ISystemInitiatedFeedback");xb&&K?(xb.execute(kc=>{kc.logActivity(Da,null)}),K={["AppTeachingUICalloutAction"]:"Show",
["SDX.Id"]:ea.GetPrivacyCompliantId(this.Mm),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Tf.a.sendTelemetryEvent(Object(uf.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ag.a.$k(K)})),m.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(m.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),K={["AppTeachingUICalloutAction"]:"NoSifFutureObject",
["SDX.Id"]:ea.GetPrivacyCompliantId(this.Mm),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Tf.a.sendTelemetryEvent(Object(uf.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ag.a.$k(K)})),this.l$())}z1h(K){if(!K)return null;K=K.wZ;if((null===K||void 0===K?0:K.Mv)&&0<K.Mv.count)for(let Da of K.Mv)if(Da.groups&&0<Da.groups.length)for(const xb of Da.groups)if(xb.controls&&0<xb.controls.length)for(const kc of xb.controls){if(kc.attributes&&
0===kc.controlType&&kc.enabled)return kc.id;if(kc.menuItems)for(const Nc of kc.menuItems)if(Nc.attributes&&Nc.enabled)return kc.id}return null}L1j(){var K=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");if(K&&"none"!==window.getComputedStyle(K).display)m.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");else{K=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==K){K={["AppTeachingUICalloutAction"]:"NoAnchor",
["SDX.Id"]:ea.y_a(this.zF),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Tf.a.sendTelemetryEvent(Object(uf.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ag.a.$k(K)}));m.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");this.l$();return}m.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}const Da=Yg.a.instance.Qd("Common.ISystemInitiatedFeedback");null==
Da||null==K?(K={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:ea.y_a(this.zF),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Tf.a.sendTelemetryEvent(Object(uf.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ag.a.$k(K)})),m.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.l$()):(Da.execute(xb=>{xb.logActivity("ShowTeachingUIForContentAddin",null)}),K={["AppTeachingUICalloutAction"]:"Show",
["SDX.Id"]:ea.y_a(this.zF),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Tf.a.sendTelemetryEvent(Object(uf.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ag.a.$k(K)})),m.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))}ZEc(K){const Da={},xb={};xb.LastTeachingUIShowTime=(new Date).toUTCString();xb.AddinHasShown=K;Da[this.appName]=me.c(xb);this.Pub=new Ff(this.appName,null,null,
this.Y$),this.Pub.zhc(Da),m.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}l$(){if(!this.YWa){const K=window.g_roamingAddinList;K&&(this.ZEc(K),this.YWa=!0)}}}Object(f.a)(ea,"AddinTeachingCalloutHandler",null,[]);var Ma=a(1193),Cb=a(430),mc=a(11),Pc=a(199),Rc=a(44),ud=a(19),od=a(62),Ed=a(151),oe=a(194);class Ne extends Ed.a{constructor(K,Da,xb,kc){super();this.W_="calc(100% - 46px)";this.Vba="15px";this.X_=
"0";this.Bob="WACDialogPanel";this.UG=695;this.Cob=462;this.WE="80%";this.onb=350;this.vua="100%";this.nW=null;this.Rd=5;this.ug="AddinInstallDialog";this.xFg=K;this.h0=Da;this.sSg=xb;this.CNg=kc}yz(){super.yz();this.Wj.style.width=this.vua;this.Wj.style.height=this.W_;this.Wj.style.marginTop=this.Vba;this.Wj.style.padding=this.X_;document.getElementById(this.Rj("WACDialogButtonPanel")).style.display="none";this.ama.setAttribute("tabindex","0");$addHandler(this.ama,"keyup",Object(eg.a)(this,this.onKeyUp,
"onKeyUp"));const K=document.createElement("iframe");K.setAttribute("id","InstallAddinDialog");K.setAttribute("src","about:blank");K.setAttribute("width","100%");K.setAttribute("height","100%");K.setAttribute("marginHeight","0");K.setAttribute("marginWidth","0");K.setAttribute("frameBorder","0");K.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");const Da=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",
this.xFg,this.h0,this.sSg);K.setAttribute("src",Da);this.nW=K;$addHandler(K,"load",Object(eg.a)(this,this.onLoad,"onLoad"));$addHandler(window,"message",Object(eg.a)(this,this.onMessage,"onMessage"));this.Wj.appendChild(K);this.Wj.appendChild(this.yqh())}yqh(){const K=document.createElement("div");K.setAttribute("tabindex","0");$addHandler(K,"focus",Object(eg.a)(this,this.Uaj,"onLoopPivotFocus"));return K}onKeyUp(K){13!==K.keyCode&&32!==K.keyCode||this.hide()}Uaj(){this.ama.focus()}onLoad(){this.nW.focus()}onMessage(K){K=
K.rawEvent;if(K.source===this.nW.contentWindow&&(K=(K=K.data)?K.split("|"):null)&&0<K.length&&("REFRESH_REQUIRED"===K[0]||"PRELOAD_MANIFEST"===K[0])){wa.a.instance.setItem("refreshRequired","true");const Da={};Da.solutionId=K[1];Da.version=Ne.B0i(K[3]);Da.storeType=K[4];Da.storeId=K[5];Da.assetId=K[6];Da.targetType=Ne.Kjj(K[2]);Da.assetStoreId=K[7];Da.width=parseInt(K[8]);Da.height=parseInt(K[9]);this.CNg(Da)}}zra(){this.Wj.style.width=this.vua;this.Wj.style.height=this.W_;this.Wj.style.marginTop=
this.Vba;this.Wj.style.padding=this.X_;this.UG>oe.a.T3?(this.nd.style.width=String.format("{0}px",oe.a.T3),this.nd.style.overflowX="scroll",gf.AFrameworkApplication.isRtl?this.nd.style.right="0":this.nd.style.left="0"):(this.nd.style.width=String.format("{0}px",this.UG),this.nd.style.overflowX="hidden");this.nd.offsetHeight>oe.a.$U||this.Cob+50>oe.a.$U?(this.nd.style.height=String.format("{0}px",oe.a.$U),this.nd.style.overflowY="scroll",this.nd.style.top="0",gf.AFrameworkApplication.isRtl?this.nd.style.right=
"0":this.nd.style.left="0",this.Wj.style.minHeight=String.format("{0}px",this.onb)):(this.nd.style.overflowY="hidden",this.nd.style.top="10%",this.nd.style.height=this.WE);this.Nda()}Nda(){if(this.nd){var K=this.nd.style.zIndex;this.nd.style.zIndex="-9999";if(this.UG>oe.a.T3)gf.AFrameworkApplication.isRtl?this.nd.style.marginRight="0":this.nd.style.marginLeft="0";else{const Da=String.format("{0}px",Math.floor(-this.nd.offsetWidth/2));gf.AFrameworkApplication.isRtl?this.nd.style.marginRight=Da:this.nd.style.marginLeft=
Da;gf.AFrameworkApplication.isRtl?this.nd.style.right="50%":this.nd.style.left="50%"}this.nd.style.zIndex=String(K)}else m.ULS.sendTraceTag(509871430,306,10,"_divMessageBox is null in CenterDialog()")}AG(){super.AG();const K=document.getElementById(this.Rj(this.Bob));K.style.width=String.format("{0}px",this.UG);K.style.height=this.WE}get rea(){return this.Wj}dispose(){super.dispose();$removeHandler(window,"message",Object(eg.a)(this,this.onMessage,"onMessage"))}static Kjj(K){switch(K){case "1":return 0;
case "2":return 1;default:return 0}}static B0i(K){const Da=K.split(".");for(let xb=0;xb<4-Da.length;xb++)K+=".0";return K}}Object(f.a)(Ne,"AddinInstallDialog",Ed.a,[]);class ef{constructor(){this.addInDetails=this.title=null}}Object(f.a)(ef,"AddInCategoryData",null,[]);class Mf{constructor(){this.links=this.description=this.displayName=this.uniqueId=this.solutionId=null}}Object(f.a)(Mf,"AddInDetailData",null,[]);class nf{constructor(){this.href=this.text=null}}Object(f.a)(nf,"AddInLinkData",null,
[]);var Df=a(114);class wg{constructor(K,Da,xb){this.Hba=0;this.wke=!1;this.Jsb=[];this.Oa=K;this.wHa=Da;this.XZc=xb;m.ULS.sendTraceTag(508821708,220,50,"AddInCategoryManager Initialized")}zqa(K,Da){K&&Da&&this.eYj(Da)&&(K=0===this.wHa.A8(2).errorCode,this.Olj(K))}eYj(K){0===K.lH&&(this.Hba|=1);1===K.lH&&(this.Hba|=2);2===K.lH&&(this.Hba|=4);return!!this.Hba}Olj(K){const Da={};var xb=!0;K&&(xb=this.Nlj,Da.categories=xb,(xb=!!xb.length)||m.ULS.sendTraceTag(509110467,220,10,"get popular add-ins for backstage error: empty category, JsonString {0} Flag {1}",
this.XZc,this.Hba));Da.mruAddIns=this.HZi;appChrome.api.dispatch(appChrome.actions.setFileMenuAddInsData(Da,xb));K&&xb&&!this.wke&&(this.wke=!0,m.ULS.sendTraceTag(508821707,220,50,"Set Popular Add-ins List to Backstage Success. Flag: {0}",this.Hba))}get Nlj(){if(Rg.c(this.XZc))return[];var K=JSON.parse(this.XZc);const Da=[];for(var xb of K)K=Object.assign(new ef,{title:xb.title,addInDetails:[]}),this.R9g(K,xb.solutionIds),0<K.addInDetails.length&&Array.add(Da,K);0<this.Jsb.length&&(xb=this.wHa.A8(2),
m.ULS.sendTraceTag(509110497,220,15,"{0} SolutionIds not found in mapping: {1}, collection length: {2}",this.Jsb.length,this.Jsb,xb.JB.length),this.Jsb=[]);return Da}get HZi(){var K=[],Da=this.wHa.A8(0);Array.addRange(K,Da.JB);Da=this.wHa.A8(1);Array.addRange(K,Da.JB);K.sort((xb,kc)=>{xb=Df.d(xb.displayName);kc=Df.d(kc.displayName);return Le.a.localeCompare(xb,kc)});Da=[];for(const xb of K)K=Object.assign(new Mf,{description:xb.description,displayName:xb.displayName,solutionId:xb.solutionId,uniqueId:this.ECb(xb)}),
Array.add(Da,K);return Da}R9g(K,Da){const xb=this.IZi;let kc=0;for(const Nc of Da){if(4===kc)break;if(xb.contains(Nc))continue;Da=this.wHa.z9a(Nc);if(!Da){this.Jsb.push(Nc);continue}const md=Object.assign(new Mf,{description:Da.description,displayName:Da.displayName,solutionId:Da.solutionId,uniqueId:this.ECb(Da)});md.links=[Object.assign(new nf,{text:CommonUIStrings.l_AddinListPrivacy,href:Da.privacyUrl}),Object.assign(new nf,{text:CommonUIStrings.l_AddinListLicense,href:Da.licenseUrl}),Object.assign(new nf,
{text:CommonUIStrings.l_AddinListStore,href:"https://appsource.microsoft.com/en-us/product/office/"+Da.solutionId})];Array.add(K.addInDetails,md);++kc}}get IZi(){const K=[];var Da=this.wHa.A8(0);Array.addRange(K,Da.JB);Da=this.wHa.A8(1);Array.addRange(K,Da.JB);Da=new M.a(O.a.Fh());for(const xb of K)Da.add(xb.solutionId);return Da}ECb(K){return this.dSa?String.format("{0}#{1}",K.solutionId,K.storeId):K.solutionId}get dSa(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",
!1)&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsPopularLoaderEnabled",!1)}}Object(f.a)(wg,"AddInCategoryManager",null,[]);var Sf=a(921);class gg{constructor(K){this.x0c=K}next(K){this.x0c=(9301*this.x0c+49297)%233280;return Math.floor(this.x0c/233280*K)}}Object(f.a)(gg,"Random",null,[]);class dg extends Wg.a{constructor(){super();this.DismissHostingSurfaceOnExecute=!0}}Object(f.a)(dg,"CuiButtonPropsExtended",Wg.a,[]);var kg=a(1024),Zf=a(596);class qd{constructor(){this.InsertionPoint=
this.GalleryButtons=this.Title=this.SectionId=null}}Object(f.a)(qd,"GallerySectionProps",null,[]);var ie=a(1229),og=a(577);class ah{constructor(){this.text=this.href=null}}Object(f.a)(ah,"LinkProps",null,[]);var vi=a(1023);class Xg{constructor(K,Da,xb,kc,Nc,md,Cd){this.QTc={};this.Koe={};this.g1b={};this.gke=0;this.nse=!1;this.Tua=this.oqb=this.Hba=0;this.cnb=Da;this.Tz=null;this.nMg=xb;this.pMg=kc;this.RPg=Nc;this.pee=void 0===Cd?null:Cd;this.Oa=(void 0===md?null:md)||gf.AFrameworkApplication.da;
this.cnb.Qhb(Object(eg.a)(this,this.zqa,"onAddinDetailsRefreshed"));appChrome.addInApi.loadOfficeAddInIcons()}get umh(){return this.g1b}gxj(K){if(K.JB)for(let Da=0;Da<K.JB.length;Da++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+K.JB[Da].solutionId,K.JB[Da].iconUrl);else 0===K.errorCode&&m.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}get uAh(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",
!1)}get Mqc(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get dSa(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsPopularLoaderEnabled",!1)}get vcb(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ScrollableFlyoutEnable",!1)}zqa(K,Da){this.gxj(Da);this.pee&&this.pee.zqa(K,
Da)}Tkj(K){const Da=[];var xb=new gg((new Date).getDate());for(var kc=0;30>kc;kc++)Array.add(Da,xb.next(K.count));xb=0;for(const Nc of K){kc=!1;for(const md of Da)if(xb===md){kc=!0;break}xb++;if(kc){let md;(md=Nc.addinInfo).AUP=20*md.AUP}else if(1===Nc.addinInfo.priority){let md;(md=Nc.addinInfo).AUP=4*md.AUP}else if(2===Nc.addinInfo.priority){let md;(md=Nc.addinInfo).AUP=2*md.AUP}}K.Sc((Nc,md)=>Nc.addinInfo.AUP<md.addinInfo.AUP?1:-1);return K}Ukj(K){for(const Da of K)if(1===Da.addinInfo.priority){let xb;
(xb=Da.addinInfo).AUP=4*xb.AUP}else if(2===Da.addinInfo.priority){let xb;(xb=Da.addinInfo).AUP=2*xb.AUP}K.Sc((Da,xb)=>Da.addinInfo.AUP<xb.addinInfo.AUP?1:-1);return K}dya(K,Da){const xb={};xb.width=K;xb.height=Da;xb.backgroundColor="transparent";return xb}fed(){return{flexDirection:"column"}}xed(){return{"margin-top":"4px","max-width":"96px",height:"32px","font-size":"12px",overflow:"hidden",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical","white-space":"normal","word-break":"break-word",
"text-overflow":"ellipsis"}}h9h(){const K={},Da={},xb={};Da.root={marginTop:"0px",marginLeft:"16px",marginRight:"16px",marginBottom:"8px",width:"100%",padding:0};Da.inner={margin:"-4px"};xb.root=this.dya(100,100);xb.flexContainer=this.fed();xb.label=this.Mqc?{"margin-top":"4px","max-width":"86px","font-size":"12px","text-overflow":"ellipsis"}:this.xed();K.galleryButtonInExpanded=xb;K.galleryStack=Da;return K}r0h(){return Object.assign(new ie.a,{Id:"AddinFlyoutMoreButton",ExternalId:"AddinFlyoutMoreButton",
Icon:"AllApps_16",Command:this.RPg,LabelText:CommonUIStrings.l_AddinsFlyoutSeeAllButtonText,FullIconStyle:{root:{"max-width":"16px","max-height":"16px","min-width":"16px","min-height":"16px",border:"1px solid var(--border-color, #c8c8c8)","border-radius":"6px",padding:"15px 15px 15px 15px",overflow:"hidden"}},Alt:CommonUIStrings.l_AddinsPickerGalleryButtonMoreArialText})}n_h(K,Da,xb){const kc={},Nc={width:"32px",height:"32px","border-radius":"6px",overflow:"hidden",padding:"7px",border:"1px solid var(--border-color, #c8c8c8)"};
gf.AFrameworkApplication.isRtl&&(Nc.direction="ltr");kc.root=Nc;return Object.assign(new ie.a,{Id:xb,ExternalId:xb,Icon:"AddinFlyoutControl"+Da.solutionId,Command:K===CommonUIStrings.l_PopularAddins?this.nMg:this.pMg,LabelText:Da.displayName,FullIconStyle:kc,Alt:Da.description})}emj(K,Da,xb){const kc=Object.assign(new qd,{SectionId:K,Title:K,GalleryButtons:[]});for(let Nc=0;Nc<xb;Nc++)Array.add(kc.GalleryButtons,this.n_h(K,Da[Nc],this.QTc[Da[Nc].solutionId]));return kc}Qei(){var K=[];const Da=this.cnb.A8(0);
Array.addRange(K,Da.JB);const xb=this.cnb.A8(1);Array.addRange(K,xb.JB);let kc=K.length;this.Tua=0<kc?5:6;gf.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&m.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}",kc,Sf.a[Da.errorCode],Da.JB.length,Sf.a[xb.errorCode],xb.JB.length);K.sort((vf,Jf)=>{vf=Df.d(vf.displayName);Jf=Df.d(Jf.displayName);return Le.a.localeCompare(vf,Jf)});var Nc=
this.vcb?3:6;const md=kc>Nc;md&&(kc=Nc-1);for(Nc=0;Nc<kc;Nc++)this.sJe(K[Nc]);let Cd=[];Nc=null;this.Tz?Cd=this.Tz:(Nc=this.cnb.A8(2),0===Nc.errorCode&&Nc.JB.forEach(vf=>{-1!==vf.addinInfo.priority&&(this.sJe(vf),Cd.push(vf))}));Nc=!0;Cd.length||(Nc=!1);let Td=0;if(Nc&&(Td=K.length?3>=K.length?9:6:12,Cd=this.Mqc&&this.vcb?this.q4g(Cd,K):this.r4g(Cd,K),Td>Cd.length&&(Td=Cd.length),this.vcb&&(this.Tua=30>Cd.length?Cd.length:30),gf.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",
!0)&&!this.nse&&!this.Mqc)){var we="",Fe="";for(let vf=0;vf<Cd.length&&vf<Td;vf++)we+=Cd[vf].displayName,we+=",",Fe+=Cd[vf].solutionId,Fe+=",";m.ULS.sendTraceTag(509673818,220,15,"The popular list number is {0}, addin name list:{1}, addin solution id list:{2}",Td,we,Fe);this.nse=!0}we=Object.assign(new Qf.a,{Id:"FooterSection",ControlsId:"FooterSection.Controls",ControlList:[]});Fe=Object.assign(new Wg.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:CommonUIStrings.l_AddinsPickerFooterButtonMoreArialText});
Array.add(we.ControlList,Fe);appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",CommonUIStrings.l_AddinPickerButtonMore));we=Object.assign(new ih.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],MenuFooterSection:we,UpdateDynamically:!0,IsFlexLayout:this.vcb});2!==Da.errorCode||K.length?3===Da.errorCode&&3===xb.errorCode?(m.ULS.sendTraceTag(509687426,220,10,"dataProvider invoke error hit"),K=this.Ynd("Common",CommonUIStrings.l_AddinPickerGeneralError),Array.add(we.MenuSectionList,
K)):this.uAh&&4===Da.errorCode&&!K.length?(m.ULS.sendTraceTag(508598107,220,10,"dataProvider disconnecteddisabled error hit"),K=this.Ynd("StoreDisabled",CommonUIStrings.l_AddinPickerServiceDisconnectedError),Array.add(we.MenuSectionList,K)):(0<kc?this.WRe(we,K,kc,"MRUAddins",CommonUIStrings.l_MyAddinSection,md):this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",!1)&&(K=this.QZh(),Array.add(we.MenuSectionList,K),m.ULS.sendTraceTag(509216389,220,50,"Show flyout banner")),
Nc&&(this.Mqc?(Array.add(we.MenuSectionList,this.g0h(Cd,this.Tua)),K=[],this.Pvg(K),appChrome.api.dispatch(K),this.oqb=this.Tz.length<this.Tua?this.Tz.length:this.Tua):this.WRe(we,Cd,Td,"PopularAddins",CommonUIStrings.l_PopularAddins))):(m.ULS.sendTraceTag(509687427,220,10,"store disabled hit"),K=this.Ynd("StoreDisabled",CommonUIStrings.l_AddinPickerDisableError),Array.add(we.MenuSectionList,K));this.vcb&&this.bgh();return we}bgh(){window.setTimeout(()=>{var K=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");
K&&K.firstChild&&K.firstChild.firstChild&&K.firstChild.firstChild.firstChild&&(K=K.firstChild.firstChild.firstChild.scrollTop,0<K&&(K={["scrollTopValue"]:K.toString()},Tf.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.ScrollableListView",dataFields:ag.a.$k(K)}))))},6E4)}A7j(){if(!(this.Tua>=this.Tz.length)){var K=[];for(let Da=0;Da<this.Tua;Da++)this.Koe["PopularAddInsListItem"+Da]=this.Tz[Da].solutionId,this.sgk(K,Da.toString(),this.Tz[this.oqb]),this.oqb===this.Tz.length-
1?this.oqb=0:this.oqb++;this.Pvg(K);appChrome.api.dispatch(K)}}Pvg(K){6>this.Tua?K.push(appChrome.actions.updateControlHiddenState("PopularAddInsListItem5",!0)):K.push(appChrome.actions.updateControlHiddenState("PopularAddInsListItem5",!1))}g0h(K,Da){const xb=Object.assign(new Qf.a,{Id:"PopularAddinListSection",ControlsId:"PopularAddinListSection.Controls",ControlList:[],Title:CommonUIStrings.l_PopularAddins});for(let kc=0;kc<0+Da&&kc<K.length;kc++)this.Koe.PopularAddInsListItem0=K[kc].solutionId,
this.LZh(xb.ControlList,kc.toString(),K[kc]);this.vcb||(K=Object.assign(new dg,{Id:"SwitchPopularAddIns",ExternalId:"SwitchPopularAddIns",ExternalImageId:"RefreshGreen_20",Command:"152023954",LabelText:CommonUIStrings.l_AddinSwitchText,ShouldTakeFocus:!1,DismissHostingSurfaceOnExecute:!1}),Array.add(xb.ControlList,K));return xb}LZh(K,Da,xb){Da=this.nTe(Da,xb);Array.add(K,Da)}sgk(K,Da,xb){xb=this.nTe(Da,xb);const kc={};kc.label=xb.Label;kc.secondaryLabel=xb.SecondaryLabel;kc.description=xb.Description;
kc.iconSet=xb.iconSet;kc.links=xb.Links;kc.commandValueId=xb.CommandValueId;kc.actionCommandValueId=xb.ActionCommandValueId;K.push(appChrome.actions.updateMultiActionButton("PopularAddInsListItem"+Da,kc))}nTe(K,Da){const xb=[];var kc=Object.assign(new ah,{text:CommonUIStrings.l_AddinListPrivacy,href:Da.privacyUrl});Array.add(xb,kc);kc=Object.assign(new ah,{text:CommonUIStrings.l_AddinListLicense,href:Da.licenseUrl});Array.add(xb,kc);kc=Object.assign(new ah,{text:CommonUIStrings.l_AddinListStore,href:"https://appsource.microsoft.com/en-us/product/office/"+
Da.solutionId});Array.add(xb,kc);kc={};kc["default"]="AddinFlyoutControl"+Da.solutionId;const Nc=this.ECb(Da);return Object.assign(new vi.a,{Id:"PopularAddInsListItem"+K,ExternalId:"PopularAddInsListItem"+K,CommandId:"PopularAddInsListItem"+K,CommandIdMapped:"1497204054",iconSet:kc,SecondaryLabel:null,Details:null,Label:Da.displayName,ActionText:CommonUIStrings.l_AddinListAdd,Description:Da.description,Links:xb,ActionId:"PopularAddInsListItemAdd"+K,ActionIdMapped:"2882601901",ActionCommandValueId:Nc,
CommandValueId:Nc})}ECb(K){return this.dSa?String.format("{0}#{1}",K.solutionId,K.storeId):K.solutionId}A9a(K){if(!K)return null;var Da=K.split("#");if(1!==Da.length&&2!==Da.length)return m.ULS.sendTraceTag(508912466,220,10,"GetAddinDetailByUniqueId: uniqueId's format is wrong"),null;K=Da[0].trim();Da=2===Da.length?Da[1].trim():gf.AFrameworkApplication.uiCulture;return this.cnb.z9a(K,Da)}sJe(K){if(!(K.solutionId in this.QTc)){const Da="AddinGalleryButton"+this.gke.toString();this.QTc[K.solutionId]=
Da;K=this.ECb(K);this.g1b[Da]=K;this.g1b[Da+"Add"]=K;this.gke++}}vtd(K){return K?this.g1b[K]:null}QZh(){const K=Object.assign(new Qf.a,{Id:"BannerSection",ControlsId:"BannerSection.Controls",ControlList:[]}),Da=Object.assign(new og.a,{Id:"AddInFlyoutBanner",ExternalId:"AddInFlyoutBanner",LabelText:this.Oa.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableConfigBannerUIString",CommonUIStrings.l_AddinBannerText),IconName:"FlyoutBannerCommon",IsBanner:!0});Array.add(K.ControlList,Da);return K}Ynd(K,
Da){const xb=Object.assign(new Qf.a,{Id:"ErrorSection",ControlsId:"ErrorSection.Controls",ControlList:[]});K=Object.assign(new kg.a,{Id:"ErrorView",ExternalId:"ReloadAddInPicker",IconName:K,Label:Da,RetryButtonTitle:"",OnRetryCommandId:"ReloadAddInPicker",AriaDescription:"StoreDisabled"===K?Da:CommonUIStrings.l_AddinPickerTryAgainAriaLabel});Array.add(xb.ControlList,K);return xb}q4g(K,Da){var xb=new r.a;for(let kc=0;kc<K.length;kc++)xb.add(K[kc]);this.Tz||(30<xb.count&&(xb=this.Tkj(xb)),this.Tz=xb.toArray());
for(K=0;K<this.Tz.length;K++)for(xb=0;xb<Da.length;xb++)if(this.Tz[K].solutionId.toLowerCase()===Da[xb].solutionId.toLowerCase()){Array.remove(this.Tz,this.Tz[K--]);break}return this.Tz}r4g(K,Da){var xb=new r.a;for(let kc=0;kc<K.length;kc++)xb.add(K[kc]);this.Tz||(30<xb.count&&(xb=this.Ukj(xb)),this.Tz=xb.toArray());for(K=0;K<this.Tz.length;K++)for(xb=0;xb<Da.length;xb++)if(this.Tz[K].solutionId.toLowerCase()===Da[xb].solutionId.toLowerCase()){Array.remove(this.Tz,this.Tz[K--]);break}return this.Tz}WRe(K,
Da,xb,kc,Nc,md){md=void 0===md?!1:md;const Cd=Object.assign(new Qf.a,{Id:kc+"Section",ControlsId:kc+"Section.Controls",ControlList:[]});kc=Object.assign(new Zf.a,{Id:kc+"GalleryControl",ExternalId:kc+"GalleryControl",GalleryStyle:this.h9h(),Width:3,Type:4,GallerySections:[]});Array.add(K.MenuSectionList,Cd);Array.add(Cd.ControlList,kc);K=this.emj(Nc,Da,xb);md&&Array.add(K.GalleryButtons,this.r0h());kc.GallerySections.push(K)}imj(K){if(K)try{K.MenuItems=this.Qei()}catch(Da){m.ULS.sendTraceTag(509687425,
220,10,"GetReactGalleryMenu hit exception "+(Da?Da.toString():""))}else m.ULS.sendTraceTag(509687424,220,10,"PopulateMenu menuProps is null")}dispose(){}}Object(f.a)(Xg,"AppsFlyoutGenerator",null,[5]);var wi=a(155),uh=a(91);class Ai{constructor(K,Da,xb,kc,Nc,md,Cd){Cd=void 0===Cd?null:Cd;this.disposed=!1;this.u8b=null;this.Lub=0;this.Qtf=this.K3d=!1;this.wXh=1E3;this.BXh="AddinFlyoutFeedbackSurvey";this.CXh=15E3;this.r3d=!0;this.Kbh='[{"title":"Adding pictures, icons and charts","solutionIds":["wa102957665","wa104381973","wa104051163","wa104104476","wa104379279","wa200000113","wa104380662","wa200004688","wa104379169","wa103147117","wa200004179","wa104380194","wa200003220","wa200004687"]},{"title":"Improving productivity with AI","solutionIds":["wa200005271","wa200004935","wa200001584","wa200005281","wa200005333"]},{"title":"Data sync and analysis","solutionIds":["wa104100404","wa104379220","wa104380662","wa104380050","wa104381859","wa200002503","wa104381717","wa200003692","wa200000018","wa200000169","wa200001306","wa104381841","wa104379190","wa104381695","wa104380711","wa104380978","wa200003784"]}]';
this.nmi=(Td,we,Fe)=>{if(Td){if(Td=this.A9a(Td))Td={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Td.solutionId,Td.storeType,Td.assetId,Td.storeId)},Td.href=we,Td.UILocation=Fe,Tf.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.AddInListLinkClickedFromFlyout",dataFields:ag.a.$k(Td)}))}else m.ULS.sendTraceTag(509089754,220,10,"Unique id is null.")};this.Nni=(Td,we)=>{if(this.W0.dSa){Td=this.A9a(Td);if(!Td){m.ULS.sendTraceTag(508872144,220,10,"Fail to get a valid AddinDetail with provided unique id.");
return}Td=Td.cXb()}else Td=this.hef(Td);if(Td){var Fe={[Cf.a.jla]:Td,[Qe.a.Th]:this.Gf.eya(Td)},vf=new Uh.a(-741808261,0,this.$.se,we,"");this.$.Ha.Ad(vf,Fe);this.Gf.eOb("installAddinFromFlyout",OSF.AgaveHostAction.ClickTrust,Td);we={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Td.solutionId,Td.storeType,Td.assetId,Td.storeId),["UILocation"]:we};Tf.a.sendTelemetryEvent(Object.assign(new Pf.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyoutListView",dataFields:ag.a.$k(we)}))}else m.ULS.sendTraceTag(509362325,
220,10,"Get add-in entitlement fails.")};this.xud=(Td,we)=>{if(Td)if(Td=this.A9a(Td)){var Fe=this.Gf.Vg;Fe=Fe?Fe.getAppUILocale()||"en-US":"en-US";this.u8b=new Ne(Td.solutionId,"wac_excel",Fe,vf=>{this.Gf.eOb("installAddinFromFlyout",OSF.AgaveHostAction.ClickTrust,vf);const Jf=new Uh.a(-741808261,0,this.$.se,we,null);this.$.Ha.Ad(Jf,{[Cf.a.jla]:vf,[Qe.a.Th]:this.Gf.eya(vf)});this.u8b&&this.u8b.hide();k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PopularAddinInstalledTelemetryEnabled",
!0)&&(vf=Telemetry.PrivacyRules.GetPrivacyCompliantId(vf.solutionId,vf.storeType,vf.assetId,null,null,vf.storeId),Tf.a.sendTelemetryEvent(Object(uf.a)(new Pf.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyout",dataFields:ag.a.$k({SolutionId:vf,uDg:we})})))});this.u8b.initializeAndShow("",null,null)}else m.ULS.sendTraceTag(508872143,220,10,"Can not find a valid addinDetail with provided unique id.");else m.ULS.sendTraceTag(509362328,220,10,"Unique id is null.")};this.Rni=(Td,we)=>{if(Td){if(this.W0.dSa){Td=
this.W0.A9a(Td);if(!Td){m.ULS.sendTraceTag(508872141,220,10,"Can not find a valid addinDetail with provided unique id");return}Td=Td.cXb()}else if(Td=this.hef(Td),!Td){m.ULS.sendTraceTag(509089755,220,10,"Get add-in entitlement fails.");return}var Fe={[Cf.a.jla]:Td,[Qe.a.Th]:this.Gf.eya(Td)},vf=new Uh.a(-741808261,0,this.$.se,we,"");this.$.Ha.Ad(vf,Fe);k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled",!0)&&(Td=Telemetry.PrivacyRules.GetPrivacyCompliantId(Td.solutionId,
Td.storeType,Td.assetId,null,null,Td.storeId),Tf.a.sendTelemetryEvent(Object(uf.a)(new Pf.a,{name:"Office.Extensibility.Host.InstallMRUAddinFromFlyout",dataFields:ag.a.$k({SolutionId:Td,uDg:we})})))}else m.ULS.sendTraceTag(509362326,220,10,"UniqueId is null.")};this.A9a=Td=>this.W0.dSa?this.W0.A9a(Td):this.J6.z9a(Td);this.I3i=(Td,we)=>{if(we)if(we)if(Td=we.Mm){if(id()||lc()){const vf=this.$.ea.workbookContext.WebExtensions;if(vf){let Jf=!1;for(var Fe of vf)if(Fe.PrimaryMarketplace.SolutionId.toLowerCase()===
Td.solutionId.toLowerCase()){Jf=!0;break}if(!Jf){m.ULS.sendTraceTag(512258444,220,15,"Not find add-in persisted in the template file.");return}}else{m.ULS.sendTraceTag(512258443,220,15,"Has no add-in persisted in the file.");return}}we=we.Aq;Fe=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(Td.solutionId in Fe)we=Fe[Td.solutionId];else if(we=this.i5h(we),void 0===we||null===we){m.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}Fe=
new Uh.a(fg.a.A6,0,0,2,null);this.executeCommand(0,Fe,{["SourceControlId"]:we},null);Td.isAutoLaunched=!0}else m.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else m.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else m.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.oqf=(Td,we)=>{"Insert"==we.tabName&&(Td=this.$.Ha,null!=Td&&(Td.y7f(this.oqf),m.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),this.MWb.L1j())};this.xaj=(Td,
we)=>{Td=null;we&&(Td=we);(null===Td||void 0===Td?0:Td.Aq)&&this.cTj(Td.Aq);this.$.Qh();Td&&Td.Mm&&this.V6g(Td.Mm)};this.rgk=(Td,we)=>{we.lH===yh.a.myAddins&&(this.Lub|=1);we.lH===yh.a.adminManaged&&(this.Lub|=2);this.Jig()&&appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("InsertAddInFlyout",!1))};this.$=K;m.ULS.shipAssertTag(537170659,0,!(void 0===Da||null===Da),`AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: ${Rc.a.t1()}`);this.Gf=
Da;this.TQe=xb;this.q8b=kc;this.hda=Nc;this.Nub=md;this.lr=new lj.a;this.ila=new If;this.rld=Cd;xa.a.TFb=xa.a.r5e;this.vgd=new r.a;this.D7a=new r.a;this.g6c&&(this.K3d=gf.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyEnabled",!1),this.J6=this.Gf.J6,null!==this.J6?(K=this.rwc?new wg(gf.AFrameworkApplication.da,this.J6,this.Kbh):null,this.W0=new Xg(gf.AFrameworkApplication.Dd,this.J6,fg.a.Ptc.toString(),fg.a.HKb.toString(),"1296389134",gf.AFrameworkApplication.da,
K),this.J6.Qhb(this.rgk)):m.ULS.sendTraceTag(509362330,220,10,"addinDetailsProvider is null"))}get g6c(){return gf.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&gf.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}get rwc(){return gf.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewBackstageEnabled",!1)}dispose(){void 0!==this.Nub&&null!==this.Nub&&
(this.Nub.dispose(),this.Nub=null);this.Gf=this.$=null;this.disposed=!0}oXj(K,Da){switch(K){case fg.a.A6:K=this.ZWj(Da);break;default:K=!1}return K}Pe(K,Da){return"Dev Box"===gf.AFrameworkApplication.da.Sa("StatusBarEnvironmentNameToUse")?!1:619219938===Da?!this.Jig():!1}executeCommand(K,Da,xb){K=jh.TaskExtensions.Ul();var kc=Da.command;Da=Nc=>{let md=null;if(!Nc)return md;(md=Nc.CommandValueId)||(md=this.W0.vtd(Nc.SourceControlId));md||m.ULS.sendTraceTag(508560270,220,10,"UniqueId is null.");return md};
switch(kc){case 843847158:break;case fg.a.Ptc:this.$hb();kc=xb.UILocation;this.rwc?(xb=Da(xb),this.xud(xb,kc)):(xb=xb.SourceControlId)?this.xud(this.W0.vtd(xb),kc):m.ULS.sendTraceTag(509362329,220,10,"Control id is null.");break;case fg.a.uFd:this.$hb();Da=this.rwc?Da(xb):xb.CommandValueId;kc=xb.UILocation;"LinkClickedPayload"===xb.Type?this.nmi(Da,xb.Href,kc):this.xud(Da,kc);break;case fg.a.W6d:this.$hb();this.W0.A7j();break;case fg.a.iyd:this.$hb();this.Nni(xb.CommandValueId,xb.UILocation);break;
case fg.a.HKb:this.$hb();kc=xb.UILocation;if(this.rwc)xb=Da(xb);else{xb=xb.SourceControlId;if(!xb){m.ULS.sendTraceTag(508440995,220,10,"ControlId is null.");break}xb=this.W0.dSa?this.W0.vtd(xb):this.W0.umh[xb]}this.Rni(xb,kc);break;case -2025863019:Qg.a.I3d(xb[Cf.a.f6c].toString(),()=>{ud.h(this.$).focus()});break;case -1777565636:Ma.a.showUILessDialog(xb[Cf.a.Oub].toString());this.Gf.C_j(xb[Cf.a.Oub].toString());break;case 1592314317:Ma.a.hideUILessDialog(xb[Cf.a.Oub].toString());this.Gf.Cri(xb[Cf.a.Oub].toString());
break;case fg.a.A6:K=this.hud(xb);break;case fg.a.DKb:this.EKb(xb);break;case fg.a.AC:this.vqj(xb);break;case fg.a.Vra:this.Vra(xb);break;case fg.a.WHc:this.Nub.kIc();break;case fg.a.refreshAddinCommands:this.Qvj();break;case 1949669462:this.hda.pfg(!0);break;case -1014260128:K=this.executeDynamicAddInCommandsAPI(xb);break;case fg.a.Hlb:this.Hlb();break;default:K=Pc.a(kc)}return K}Be(K,Da,xb){K=!1;switch(Da.command){case fg.a.uFd:case fg.a.W6d:case fg.a.iyd:case fg.a.Ptc:case fg.a.HKb:K=!!xb;break;
case 843847158:case -2025863019:case -1777565636:case 1592314317:case fg.a.AC:case fg.a.Vra:case fg.a.WHc:case fg.a.refreshAddinCommands:case 1949669462:case fg.a.DKb:case -1014260128:case fg.a.Hlb:K=!0;break;case fg.a.A6:K=!gf.AFrameworkApplication.protectedFile}return K}Jig(){return 0!==this.Lub&&this.$.eX&&!k.EwaSettings.Ea(174)}Ue(K,Da,xb){switch(Da){case "PopulateAddInGallery":return k.EwaSettings.isChangeGateEnabled("OfficeVSO:7653071_PopulateAddInGalleryTelemetryEnabled")&&Tf.a.sendTelemetryEvent(Object(uf.a)(new Pf.a,
{name:"Office.Extensibility.Host.PopulateAddinGallery",dataFields:ag.a.$k({})})),this.W0.imj(xb),this.K3d&&(this.$hb(),this.tOi()),!0;default:return!1}}tOi(){wa.a.instance.getItem("AddinFlyoutSurveyShowed")&&(this.r3d=!1);this.r3d&&(window.setTimeout(()=>{let K=this.jdf();K&&"hidden"!==K.visibility&&(this.Qtf=!0)},this.wXh),this.vzj=window.setTimeout(()=>{this.cpg=Yg.a.instance.Qd("Common.ISystemInitiatedFeedback");this.Qtf&&this.cpg&&this.cpg.execute(K=>{let Da=this.jdf();Da&&"hidden"===Da.visibility&&
(K.pkb(this.BXh,null),this.r3d=!1,wa.a.instance.setItem("AddinFlyoutSurveyShowed","1"))})},this.CXh))}jdf(){let K=null;try{const Da=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");Da&&(K=Ic.a.aC(Da.parentNode.parentNode.parentNode))}catch(Da){m.ULS.sendTraceTag(508911886,220,10,"AddinFlyout get parent and parent get exception "+(Da?Da.toString():""))}return K}$hb(){this.K3d&&window.clearTimeout(this.vzj)}i5h(K){if(!K)return m.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),
null;if((K=K.wZ)&&K.Mv&&0<K.Mv.count)for(let Da of K.Mv){if(Da.groups&&1===Da.groups.length){K=Da.groups[0];if(K.controls&&1===K.controls.length){const xb=K.controls[0];if(xb.attributes&&!xb.controlType&&xb.enabled)return xb.id}K.controls&&m.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}Da.groups&&m.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}return null}get PF(){return gf.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&gf.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}vqj(K){if(K&&Cf.a.T0 in K)if(this.Gf){var Da=K[Cf.a.T0];this.PF?Cf.a.v8b in K&&(K=K[Cf.a.v8b],this.Gf.RQb(Da,K),1===K&&this.AC(Da,!0)):this.AC(Da,!0)}else m.ULS.sendTraceTag(509686150,220,10,"QueryAddinDetails: abort because ddaFacadeService is null..");else m.ULS.sendTraceTag(509686151,220,10,"queryAddinDetailsWithActionData: invalid actionData.")}AC(K,Da){Da=void 0===Da?!1:Da;this.Gf?
(m.ULS.sendTraceTag(509686149,220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",K,Da),this.Gf.AC(K,Da)):m.ULS.sendTraceTag(508564227,220,10,"QueryAddinDetails: abort because ddaFacadeService is null..")}Qvj(){if(this.hda.nuc()){this.hda.qNe();var K=this.Cod();if(K&&0<K.count)for(let Da of K)K={[Cf.a.T0]:Da,[Cf.a.$W]:4,[Cf.a.dLa]:(new Date).getTime()},this.Vra(K)}else gf.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&(m.ULS.sendTraceTag(509686148,220,50,"refreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",this.hda.nuc()),this.AC(10,!0),this.AC(0,!0))}Vra(K){m.ULS.sendTraceTag(537170657,220,50,`Launch AddinCommands entitlements list, LaunchOperationType ${K[Cf.a.$W]}, DataProvider ${K[Cf.a.T0]}.`);this.hda.aPj();window.setTimeout(()=>{if(void 0===this.Gf||null===this.Gf)m.ULS.sendTraceTag(537170656,220,10,`AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: ${Rc.a.t1()}`);
else{const Da=new Je(new Ze(this.Gf.Vg),yf.instance,db.instance);Da.fYg((xb,kc)=>{gf.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.AC(K[Cf.a.T0]);this.EKb(kc.properties)});Da.H0g((xb,kc)=>{null==kc?Tf.a.sendTelemetryEvent(Object(uf.a)(new Pf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ag.a.$k({["AppTeachingUICalloutAction"]:"InvalidEventArgs",["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"})})):
(this.MWb=new ea(this),this.MWb.ayj(kc),xb=this.$.Ha,null!=xb&&(xb.ZCe(this.oqf),m.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});Da.Zdk(K)}},0)}Hlb(){if(this.sBi)if(void 0===this.Gf||null===this.Gf)m.ULS.sendTraceTag(509686154,220,10,"DdaFacadeService should not be null");else{const K=new N(this.Gf.Vg);K.e_g(()=>{this.xFd()});K.a9d()}}get sBi(){return!k.EwaSettings.Ea(174)&&this.$.ea.pj.get(27)&&this.$.eX}xFd(){const K=document.getElementById("InsertAddInFlyout");if(null===
K||void 0===K||"none"===window.getComputedStyle(K).display){const Da=document.getElementById("RibbonOverflowMenu-overflow");null!=Da?(Da.onclick=function(){const xb=new Zd.a(0,1,500,()=>{const kc=document.getElementsByName("Add-ins")[0];null!=kc&&(kc.click(),m.ULS.sendTraceTag(509445257,341,50,"Launch flyout in overflow"))});gf.AFrameworkApplication.Vj.Sh(xb);Da.onclick=function(){}},Da.click()):m.ULS.sendTraceTag(509677591,220,10,"Cannot find flyout button on ribbon or overflow button")}else K.click(),
m.ULS.sendTraceTag(509677590,220,50,"Launch flyout")}EKb(K){if(!this.disposed){m.ULS.sendTraceTag(537170655,220,50,`LaunchOperationType ${K[Cf.a.$W]}.`);try{if(k.EwaSettings.Ea(174)){const kc=K[Cf.a.Mub];if(kc&&0<kc.count){const Nc=kc.count;for(let md=Nc-1;0<=md;md--){const Cd=kc.ma(md);OSF.OsfControl.isFirstPartyStoreString(Cd.storeType)||kc.remove(kc.ma(md))}if(kc.count<Nc){const md=Object(wi.a)("OfficeVSO:7624544_ConvertBusinessBarManagerService")?Object(uh.d)(ne.a.resolve(Nd.m,{Ja:0})):F.GetServiceTaskFactory.ud(this.$.ga,
5,4,0);jh.TaskExtensions.za(md,()=>{md.result.yi(36,null)},this.$.ka,3)}if(!kc.count)return}}if(void 0===this.Gf||null===this.Gf)m.ULS.sendTraceTag(537170654,220,10,`LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: ${Rc.a.t1()}`);else{var Da=null;Da=gf.AFrameworkApplication.da.pa("HostInstallAddInsIsEnabled")?new jg(this.lr,this.TQe,new Ze(this.Gf.Vg),new Th(this.$.Pd,fg.a.A6),this.hda,yf.instance,this.ila,(kc,Nc)=>{const md={};md.InstanceId=Ke.a.create().toString();md.PrimaryMarketplace=
{};md.PrimaryMarketplace.SolutionId=kc.solutionId;md.PrimaryMarketplace.SolutionVersion=kc.version;md.PrimaryMarketplace.MarketplaceType=kc.storeType;md.PrimaryMarketplace.MarketplaceRef=kc.storeId;md.WebExtensionType=1;this.Gf.T1j(md,()=>{Nc(kc)})}):new jg(this.lr,this.TQe,new Ze(this.Gf.Vg),new Th(this.$.Pd,fg.a.A6),this.hda,yf.instance,this.ila);Da.mYg(this.I3i);Da.gYg(this.xaj);var xb=new ea(this);Da.d_g(xb.waj);Da.G0g(xb.l_j);this.$.ga.Da(53).Fs&&Te.a.get_instance().ik(5,null).continueWith(()=>
{this.disposed||Da.WOi(this.rld,this.$.domElement,K)})}}catch(kc){m.ULS.sendTraceTag(537170653,220,10,`LaunchAddinCommands error message : ${kc.message}.`)}}}hud(K){const Da=jh.TaskExtensions.Ul();K=K[this.lr.rma];const xb=this.q8b.z3c(K),kc=new Ma.a(this.$,this.Gf,xb.ownerAddinInfo,Da);return this.ikf(Da,K,xb,kc)}ikf(K,Da,xb,kc){this.q8b.hud(Da,this.hda,kc,new Ze(this.Gf.Vg),xb,()=>{K=kc.ylh()},()=>{ud.h(this.$).focus()});return K}V6g(K){const Da=jh.TaskExtensions.Ul();var xb=this.Gf.Nea(K.solutionId);
if(xb){var kc=this.Gf.hY(xb);if(mc.HelperMethods.ez(kc)&&0!==kc.SharedRuntime.State)return}kc=this.q8b.W6g;const Nc=K.solutionId in kc?kc[K.solutionId]:null;if(Nc){const md=this.q8b.z3c(Nc),Cd=new Ma.a(this.$,this.Gf,md.ownerAddinInfo,Da),Td=Telemetry.PrivacyRules.GetPrivacyCompliantId(K.solutionId,null!==md.ownerAddinInfo?md.ownerAddinInfo.storeType:K.storeType,K.assetId,null,null,K.storeId);kc=we=>{if(we){const Fe={};for(const vf of we)Fe[vf[0]]=vf[1];(we=Cf.a.fDe in Fe?Fe[Cf.a.fDe]:null)&&"true"===
we.toLowerCase()&&(m.ULS.sendTraceTag(537170652,220,50,`Auto-Show AddinCommands TaskPane, StoreType ${K.storeType}, StoreId ${K.storeId}, SolutionId ${Td}.`),this.ikf(Da,Nc,md,Cd))}};m.ULS.sendTraceTag(537170651,220,50,`Check Auto-Show AddinCommands TaskPane, StoreType ${K.storeType}, StoreId ${K.storeId}, SolutionId ${Td}.`);if(xb)kc(this.Gf.hY(xb).OsfPropertyBag);else if(xb=this.$.ea.workbookContext.WebExtensions)for(const we of xb)if((1===we.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===
K.targetType&&we.PrimaryMarketplace.MarketplaceType.toLowerCase()===K.storeType.toLowerCase()&&we.PrimaryMarketplace.MarketplaceRef.toLowerCase()===K.storeId.toLowerCase()&&we.PrimaryMarketplace.SolutionId.toLowerCase()===K.solutionId.toLowerCase()){kc(we.OsfPropertyBag);break}}}$6d(K,Da,xb){K&&(void 0===xb||!xb||Da||this.vgd.contains(K)||this.vgd.add(K),(xb=this.D7a.contains(K))&&Da&&this.D7a.remove(K),xb||Da||this.D7a.add(K))}cTj(K){if((K=K.wZ)&&K.Mv)for(let Da of K.Mv)if(Da.groups)for(const xb of Da.groups)if(xb.controls)for(const kc of xb.controls)if(this.$6d(kc.id,
kc.enabled,!0),1===kc.controlType&&kc.menuItems)for(const Nc of kc.menuItems)this.$6d(Nc.id,Nc.enabled,!0)}Cod(){const K=new r.a;k.EwaSettings.Ea(52)&&(this.$.ea.pj.get(27)&&(K.add(0),K.add(16)),this.$.ea.pj.get(33)&&K.add(1),K.add(8));return K}executeDynamicAddInCommandsAPI(K){let Da=!0;if(void 0===K||null===K||void 0===K[Cf.a.wAb]||null===K[Cf.a.wAb])return od.Task.Wa(!1);switch(K[Cf.a.wAb]){case 1:Da=this.lhk(K);break;case 2:Da=this.gTj(K);break;case 4:this.D7a.clear();this.D7a.addRange(this.vgd);
break;case 3:Da=this.installContextualTab(K);break;default:Da=!1}return od.Task.Wa(Da)}ZWj(K){return K&&this.lr.rma in K?(K=K[this.lr.rma])?this.D7a.contains(K):!1:!1}lhk(K){var Da=null;let xb=null,kc=null,Nc=!0;void 0!==K[Cf.a.X7]&&null!==K[Cf.a.X7]&&void 0!==K[this.lr.rma]&&null!==K[this.lr.rma]&&void 0!==K[Cf.a.W7]&&null!==K[Cf.a.W7]&&(Da=K[Cf.a.X7],xb=K[Cf.a.agc],kc=K[this.lr.rma],Nc=K[Cf.a.W7]);if(!Da||!kc)return m.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),
!1;K=(new Pi.a(this.$.Pd,Da,this.lr,!0)).FPa(kc);Da={DynamicAddinCommandsApiName:"UpdateControlEnableState"};Da.AssetId=xb;Da.MaskedTabId=K;Da.IsToEnable=Nc;m.ULS.sendTraceTag(537170648,220,50,Fb.a.He(Da));this.$6d(K,Nc);Cb.a.GB.updateCommandUI();return!0}gTj(K){var Da,xb,kc=null,Nc=null;let md=null;var Cd=null;let Td=!0;void 0!==K[Cf.a.did]&&null!==K[Cf.a.did]&&void 0!==K[Cf.a.X7]&&null!==K[Cf.a.X7]&&void 0!==K[this.lr.rma]&&null!==K[this.lr.rma]&&void 0!==K[Cf.a.W7]&&null!==K[Cf.a.W7]&&(kc=K[Cf.a.did],
Nc=K[Cf.a.X7],md=K[Cf.a.agc],Cd=K[this.lr.rma],Td=K[Cf.a.W7]);if(!kc||!Nc||!Cd)return m.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;K=(new Pi.a(this.$.Pd,Nc,this.lr,!0)).sif(Cd);Cd={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};Cd.StoreType=kc;Cd.AssetId=md;Cd.MaskedTabId=K;Cd.IsToShow=Td;m.ULS.sendTraceTag(537170646,220,15,Fb.a.He(Cd));kc=this.hda.nna(kc,Nc,1);Nc=!1;if(null===(xb=null===(Da=null===kc||void 0===kc?void 0:kc.Aq)||
void 0===Da?void 0:Da.wZ)||void 0===xb?0:xb.Mv)for(let we of kc.Aq.wZ.Mv)if(we.id===K){Nc=!0;break}if(!Nc)return m.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;Da=[];Td?appChrome.selectors.getSelectedTabId()!==K&&Da.push(appChrome.actions.activateRibbonTab(K)):(appChrome.selectors.getSelectedTabId()===K&&Da.push(appChrome.actions.setCurrentTab(nh.a.nR)),Da.push(appChrome.actions.deactivateRibbonTab(K)));appChrome.api.dispatch(Da);return!0}hef(K){if(this.J6){if(K=
this.J6.z9a(K)){const Da={};Da.solutionId=K.solutionId;Da.version=K.version;Da.storeType=K.storeType;Da.storeId=K.storeId;Da.assetId=K.assetId;Da.assetStoreId=K.assetStoreId;Da.targetType=K.targetType;Da.displayName=K.displayName;Da.width=K.width;Da.height=K.height;return Da}m.ULS.sendTraceTag(509362324,0,10,"Get addinDetail fail.");return null}m.ULS.sendTraceTag(509362323,0,10,"No addinDetailManager instance.");return null}installContextualTab(K){let Da=null,xb=null,kc=null;var Nc=null;if(void 0!==
K[Cf.a.X7]&&null!==K[Cf.a.X7]&&void 0!==K[Cf.a.W7]&&null!==K[Cf.a.W7]){const md=K[Cf.a.W7];Da=K[Cf.a.X7];void 0!==md[Cf.a.aOa]&&null!==md[Cf.a.aOa]&&void 0!==md[Cf.a.bOa]&&null!==md[Cf.a.bOa]&&(xb=md[Cf.a.aOa],kc=md[Cf.a.bOa],Nc=md[Cf.a.eid])}if(!(Da&&kc&&xb&&Nc))return m.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;K=this.hda.nna(Nc.PrimaryMarketplace.MarketplaceType,Nc.PrimaryMarketplace.SolutionId,1);if(null===K||void 0===K?0:K.Aq)return m.ULS.sendTraceTag(537170643,
220,15,"InstallContextualTab was called multiple times"),!1;K={};K.solutionId=Nc.PrimaryMarketplace.SolutionId;K.version=Nc.PrimaryMarketplace.SolutionVersion;K.storeType=Nc.PrimaryMarketplace.MarketplaceType;K.storeId=Nc.PrimaryMarketplace.MarketplaceRef;Nc.AssetMarketplace?(K.assetId=Nc.AssetMarketplace.SolutionId,K.assetStoreId=Nc.AssetMarketplace.MarketplaceRef):(K.assetId=null,K.assetStoreId=null);K.targetType=Nc.WebExtensionOsfControlType;K.width=Nc.TaskpaneWidth;K.height=0;K.isAddinCommands=
!0;Nc=new r.a;Nc.add(K);K={};K[Cf.a.Mub]=Nc;K[Cf.a.$W]=6;K[Cf.a.aOa]=xb;K[Cf.a.bOa]=kc;this.EKb(K);return!0}}Object(f.a)(Ai,"AddinUICommandHandler",null,[805,203,5]);var gj=a(66);class xi{constructor(K,Da,xb,kc){this.E2d=void 0===K?null:K;this.G3c=void 0===Da?null:Da;this.lgd=void 0===xb?null:xb;this.ABb=void 0===kc?0:kc}xFa(){return this.E2d()}activate(){return this.G3c()}deactivate(){this.lgd()}dispose(){this.lgd=this.G3c=this.E2d=null}}Object(f.a)(xi,"FeatureActivator",null,[24,5]);var nj=a(24),
jj=a(21);class Yi extends qh.a{constructor(K){super(K);this.handler=null;this.MTg=()=>{m.ULS.sendTraceTag(38410434,0,50,`AddinUICommandHandlerFactory.ActivateFeature, isEditMode [${this.$.isEditMode}] ShowCommandUI [${!!(this.$.If&16384)}]`);const Da=new kh.a;this.$.ga.qd(53,Fe=>{m.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");Da.setResult(Fe)});const xb=Da.task,kc=new Yf,Nc=Of.a.getInstance(),md=new Sh(this.$,Nc),Cd=F.GetServiceTaskFactory.create(this.$.ga,
203,this.ka,this.Ta),Td=this.vwj(kc),we=Object(uh.d)(ne.a.resolve(Nd.Vb,{Ja:this.Ta}));return jh.TaskExtensions.za(jh.TaskExtensions.Wf([xb,Cd,Td,we],this.ka),()=>{m.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");jh.TaskExtensions.za(F.GetServiceTaskFactory.create(this.$.ga,106,this.ka,this.Ta),Fe=>{this.handler=new Ai(this.$,Fe.result,kc,new bh,Nc,md,Yg.a.instance.oi("Common.IExternalUICommandDefinitionMapping"));m.ULS.sendTraceTag(38410436,
0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");this.Lf([this.handler]);this.$.ga.Qa(198,this.handler)},this.ka,3)},this.ka,3)};this.zwh=()=>{void 0!==this.handler&&null!==this.handler?(this.$.Ha.Yhb(this.handler),this.$.ga.C1(198),this.handler=null):m.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");this.$.ga.C1(204);jj.a(nj.a,19,this.$.ga,198)}}Uf(){m.ULS.sendTraceTag(38410432,
0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");gj.a(this.$).add(Object(uf.a)(new xi,{E2d:()=>{const K=this.$.ea.YK&&this.$.ea.oe&&!!(this.$.If&16384)&&this.$.isEditMode;this.$.ea.oe&&m.ULS.sendTraceTag(38410433,0,50,`AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [${K}] IsSessionFullyLoaded [${this.$.ea.YK}] IsSessionActive [${this.$.ea.oe}] ShowCommandUI [${!!(this.$.If&16384)}] IsEditMode [${this.$.isEditMode}]`);return K},G3c:this.MTg,
lgd:this.zwh,ABb:2}))}vwj(K){const Da=F.GetServiceTaskFactory.create(this.$.ga,102,this.ka,this.Ta);return jh.TaskExtensions.za(Da,()=>{m.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");this.$.ga.Qa(204,new Eh(Da.result,K))},this.ka,3)}static la(K){qh.a.qg(199,new Yi(K))}}Object(f.a)(Yi,"AddinUICommandHandlerFactory",qh.a,[]);var uj=a(1180),oj=a(1183),Bh=a(737);class rh extends u.a{constructor(K){super();this.$=
K;this.je()}create(){let K;if(k.EwaSettings.Ea(355)){const Da=F.GetServiceTaskFactory.create(this.$.ga,106,this.$.ka,this.Ta);let xb=Object(uh.d)(ne.a.resolve(Nd.Cb,{Ja:this.Ta}));jh.TaskExtensions.za(od.Task.MG(Da,xb),()=>{this.Ld(Object(Bh.a)(this.$.ga,278,()=>new uj.CustomFunctionsInstaller(this.$,Da.result,xb.result)))},this.$.ka,3)}else K=Object(Bh.a)(this.$.ga,278,()=>new oj.CustomFunctionsLegacyInstaller(this.$)),this.Ld(K)}static la(K){K.ga.Qa(279,new rh(K))}}Object(f.a)(rh,"CustomFunctionsInstallerFactory",
u.a,[]);var Ji=a(96),Ki=a(54),Ig=a(48);let Ti=class{constructor(K,Da){this.SVa=this.TVa=null;this.Zrg=(xb,kc)=>{let Nc=null,md=null,Cd=null;kc?(Object(L.a)(482,kc)?(Nc=kc.nLa,Cd=kc.instanceId):Object(L.a)(404,kc)&&(Nc=kc.get_element(),Cd=kc.instanceId),Nc)?(md=Object(S.a)(770,xb),md)?this.b3f(Cd,Nc,md)||Cd in this.SVa||(this.TVa[Cd]=0,this.SVa[Cd]=Ki.a.instance.CF(()=>{10<=this.TVa[Cd]||this.b3f(Cd,Nc,md)?(delete this.TVa[Cd],this.SVa[Cd].dispose(),delete this.SVa[Cd]):this.TVa[Cd]+=1},500,Ig.a.Y1g,
!0,!1)):m.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):m.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):m.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=K;this.$=Da;this.$7c=!1;k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2AgaveOnSelectedReadoutHandler",!1)||this.$.ga.Qa(224,this)}la(K){this.$7c?m.ULS.sendTraceTag(537170629,
0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.$7c=!0,this.SVa={},this.TVa={},K?K.SYg(this.Zrg):m.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))}detach(K){if(K){K.SAj(this.Zrg);K=this.SVa;for(let Da in K)Ji.a.Ma(K[Da]);this.TVa=this.SVa=null;this.$7c=!1}else m.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")}b3f(K,Da,xb){if(this.UAi(xb,K))return!1;
K=Da.querySelector("iframe");if(!K)return m.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;K=K.title;if(!K||!K.length)return m.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(K);return!0}UAi(K,Da){return(K=K.Vg.getOsfControl(Da))?K.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0}};Ti=Object(x.a)([Object(ne.d)(Nd.d),Object(x.b)(0,Object(Nd.f)()),
Object(x.b)(1,Object(Nd.W)())],Ti);Object(f.a)(Ti,"AgaveOnSelectedReadoutHandler",null,[771]);class ii extends u.a{constructor(K){super();this.$=K;this.je()}create(){const K=this.$.ga;jh.TaskExtensions.za(k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2AriaLiveNotifier",!1)?Object(uh.d)(ne.a.resolve(Nd.f,{Ja:this.Ta})):F.GetServiceTaskFactory.ud(K,211,212,this.Ta),Da=>{Da=K.Da(224)||new Ti(Da.result,this.$);this.Ld(Da)},this.ka,3)}static la(K){K.ga.Qa(225,new ii(K))}}Object(f.a)(ii,
"AgaveOnSelectedReadoutHandlerFactory",u.a,[]);var di=a(775),ng=a(56);const Zi=(K,Da)=>ng.a.iGd(64,()=>window.OfficeExtension&&!!window.OfficeExtension.WacRuntime,gf.AFrameworkApplication.da.Hf("MaxRetriesForLoadingScript",0),K,Da);var Rh=a(217);class Lh{constructor(K,Da,xb){this.iframe=K;this.onSuccess=Da;this.onError=xb;$addHandler(window,"message",Object(eg.a)(this,this.rlf,"handleResponse"))}rlf(K){try{if(K&&K.rawEvent&&K.rawEvent.origin&&this.iframe&&this.iframe.id){var Da=this.pXf(K.rawEvent.origin);
const xb=this.pXf(document.domain);if(O.a.Fh().equals(xb,Da))if(K.rawEvent.source&&K.rawEvent.source.frameElement&&K.rawEvent.source.frameElement.id&&O.a.Fh().equals(K.rawEvent.source.frameElement.id,this.iframe.id)){Da=null;try{Da=JSON.parse(K.rawEvent.data)}catch(kc){m.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",kc.message)}Da?(Da.statusCode!==Rh.a.PE||void 0!==Da.error&&Da.error?(m.ULS.sendTraceTag(23707648,
344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",Da.statusCode,Da.error),this.onError()):(m.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(Da.authorizationCode?Da.authorizationCode:Da.signInUrl)),$removeHandler(window,"message",Object(eg.a)(this,this.rlf,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):m.ULS.sendTraceTag(24978499,344,15,
"The iframe is not a child of Body."):m.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):m.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else m.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else m.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else m.ULS.sendTraceTag(51418200,
344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(xb){m.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",xb.message)}}pXf(K){let Da="";try{K&&(Da=-1<K.indexOf("//")?K.split("/")[2]:K.split("/")[0])&&(Da=Da.split(":")[0],Da=Da.split("?")[0])}catch(xb){m.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",xb.message)}return Da}static la(K,Da,xb){new Lh(K,Da,xb)}}Object(f.a)(Lh,"ResponseHandler",null,[]);
var Xh=a(264);class qi{constructor(K){this.AKa=K}tryAuthenticate(K,Da){this.Agb(qi.AKg,()=>{K()},Da)}tryAuthorize(K,Da){this.Agb(qi.EFg,K,Da)}getSignInUrl(K,Da){this.Agb(qi.Dve,K,Da)}signOut(K,Da){this.Agb(qi.FQg,K,Da)}Agb(K,Da,xb){var kc=new Xh.QueryStringBuilder("AuthenticationProxyHandler.aspx");kc.mj("responseType",K);gf.AFrameworkApplication.s3a(kc);kc=String.format("{0}{1}&{2}",this.AKa,kc.toString(),gf.AFrameworkApplication.Ak);const Nc=document.createElement("iframe");Nc.setAttribute("id",
"privateCatalogIframe");Nc.setAttribute("name","privateCatalogIframe");Nc.setAttribute("style","display: none");O.a.Fh().equals(K,qi.Dve)||Nc.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Lh.la(Nc,Da,xb);Nc.setAttribute("src",kc);document.body.appendChild(Nc)}}qi.EFg="authcode";qi.AKg="identitytoken";qi.Dve="signinurl";qi.FQg="signout";Object(f.a)(qi,"AuthenticationProxy",null,[]);class Tg{}Tg.getUserId="getUserId";Tg.getLastStoreUpdate="laststoreupdate";
Tg.getEntitlement="getEntitlements";Tg.getEToken="getEToken";Tg.getManifest="getManifest";Tg.getAppState="getAppState";Tg.getKilledApps="getRemovedAddins";Tg.getAppDetails="getAppDetails";Tg.removeApps="removeAddin";Tg.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";Tg.getPrivateCatalogAddIns="getAddIns";Tg.getPrivateCatalogManifests="getAppManifests";Tg.isStoreDisabled="isStoreDisabled";Object(f.a)(Tg,"S2SWebRequestActions",null,[]);var mi=a(586);class Ih{getUserId(K,Da){const xb=new r.a;
xb.add(new Xc.a("corr",K));this.d_(Tg.getUserId,xb,1,Da)}getLastStoreUpdate(K,Da,xb){const kc=new r.a;kc.add(new Xc.a("lc",K));kc.add(new Xc.a("corr",Da));this.d_(Tg.getLastStoreUpdate,kc,1,xb)}getEntitlement(K,Da,xb,kc){K=new r.a;K.add(new Xc.a("av",Da));K.add(new Xc.a("corr",xb));this.d_(Tg.getEntitlement,K,1,kc)}getEToken(K,Da,xb,kc,Nc,md){const Cd=new r.a;Cd.add(new Xc.a("cmu",K));Cd.add(new Xc.a("cmf",Da));Cd.add(new Xc.a("assetid",xb));Cd.add(new Xc.a("expver",kc));Cd.add(new Xc.a("corr",Nc));
this.d_(Tg.getEToken,Cd,1,md)}getManifest(K,Da,xb,kc){const Nc=new r.a;Nc.add(new Xc.a("cmu",K));Nc.add(new Xc.a("assetid",Da));Nc.add(new Xc.a("corr",xb));this.d_(Tg.getManifest,Nc,1,kc)}getAppState(K,Da,xb){const kc=new r.a;kc.add(new Xc.a("ma",K));kc.add(new Xc.a("corr",Da));this.d_(Tg.getAppState,kc,1,xb)}getKilledApps(K,Da){const xb=new r.a;xb.add(new Xc.a("corr",K));this.d_(Tg.getKilledApps,xb,1,Da)}getAppDetails(K,Da,xb,kc){const Nc=new r.a;Nc.add(new Xc.a("cmo",K));Nc.add(new Xc.a("corr",
xb));this.sendWithBody(Tg.getAppDetails,Nc,Da,2,kc,!1)}removeApps(K,Da,xb){const kc=new r.a;kc.add(new Xc.a("corr",Da));this.sendWithBody(Tg.removeApps,kc,K,2,xb,!1)}getLastPrivateCatalogUpdate(K,Da,xb,kc,Nc,md){const Cd=new r.a;Cd.add(new Xc.a("catalog","privatecatalog"));Cd.add(new Xc.a("clientCode",K));Cd.add(new Xc.a("clientVersion",Da));Cd.add(new Xc.a("corr",Nc));K=String.format("authorizationCode={0}&refreshToken={1}",xb?Le.a.$g(xb):"",kc?Le.a.$g(kc):"");this.sendWithBody(Tg.getLastPrivateCatalogUpdate,
Cd,K,2,md,!0)}getPrivateCatalogAddIns(K,Da,xb,kc,Nc,md){const Cd=new r.a;Cd.add(new Xc.a("catalog","privatecatalog"));Cd.add(new Xc.a("clientCode",K));Cd.add(new Xc.a("clientVersion",Da));Cd.add(new Xc.a("corr",Nc));K=String.format("authorizationCode={0}&refreshToken={1}",xb?Le.a.$g(xb):"",kc?Le.a.$g(kc):"");this.sendWithBody(Tg.getPrivateCatalogAddIns,Cd,K,2,md,!0)}getPrivateCatalogManifests(K,Da,xb,kc,Nc){const md=new r.a;md.add(new Xc.a("catalog","privatecatalog"));md.add(new Xc.a("corr",kc));
K=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Le.a.$g(K),Da?Le.a.$g(Da):"",xb?Le.a.$g(xb):"");this.sendWithBody(Tg.getPrivateCatalogManifests,md,K,2,Nc,!0)}isStoreDisabled(K,Da){const xb=new r.a;xb.add(new Xc.a("corr",K));this.d_(Tg.isStoreDisabled,xb,2,Da)}d_(K,Da,xb,kc){this.sendWithBody(K,Da,null,xb,kc,!1)}sendWithBody(K,Da,xb,kc,Nc,md){const Cd=new Xh.QueryStringBuilder("AddinServiceHandler.ashx");Cd.mj("action",K);Cd.mj("app",mi.a[gf.AFrameworkApplication.sa.Ra.kj]);
for(const Td of Da)Cd.mj(Td.key,Td.value);Da=String.format("{0}{1}&{2}",gf.AFrameworkApplication.sa.Ra.rZ,Cd.toString(),gf.AFrameworkApplication.Ak);gf.AFrameworkApplication.tf.Ho(Da,kc,xb,null,!1,2,Td=>{let we=null,Fe=null;Td&&Td.data&&(Td.data.responseHeaders["X-BlockedForMinor"]&&"1"===Td.data.responseHeaders["X-BlockedForMinor"].toString()&&(Td.data.httpStatus=451),we=Td.data.Tf,Fe=Td.data.responseHeaders);Nc(Td.data.httpStatus,we,Fe)},Td=>{var we=null;let Fe=null;md&&Td&&Td.data&&Td.data.Tf&&
(we=Td.data.Tf,Fe=Td.data.responseHeaders);Nc(Td.data.httpStatus,we,Fe);if(gf.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){we={message:"AddinServiceHandler request failed"};we.code=Td.data.httpStatus;we.action=K;if(Td.data.request||Td.data.request.get_headers())we["X-UserSessionId"]=Td.data.request.get_headers()["X-UserSessionId"];408===Td.data.httpStatus||503===Td.data.httpStatus?m.ULS.sendTraceTag(538784582,220,10,JSON.stringify(we)):
m.ULS.sendTraceTag(18392345,220,50,JSON.stringify(we))}else m.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",Td.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+K,void 0,void 0,void 0,["X-UserKey"])}}Object(f.a)(Ih,"S2SWebRequestManager",null,[]);class ei extends u.a{constructor(K){super();this.a3f=this.ddaFacade=null;this.$=K;K.ga.Qa(106,this);this.je()}get Gf(){return this.ddaFacade||(this.ddaFacade=new di.DdaFacade(this.$,this.a3f,this.eh))}create(){m.ULS.sendTraceTag(537170507,
0,50,"DdaFacadeServiceFactory:Create.");gf.AFrameworkApplication.disableWholeAppsForOfficeFeature?m.ULS.sendTraceTag(537170506,0,50,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${gf.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`):k.EwaSettings.Ea(359)?Yg.a.instance.Qd("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(K=>{K.isFeatureEnabled("mso_officeStore",!0).then(Da=>{di.DdaFacade.zcc=Da;this.Hyb();return null})}):
this.Hyb()}Hyb(){var K=this.$.ga;const Da=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2AgaveOnSelectedReadoutHandler",!1)?Object(uh.d)(ne.a.resolve(Nd.d,{Ja:this.Ta})):F.GetServiceTaskFactory.ud(K,224,225,this.Ta);K=ng.a.iGd(63,()=>!(void 0===window.OSF||null===window.OSF),this.$.xa.MaxRetriesForLoadingScript,this.$.ka,this.Ta,106);const xb=Zi(this.ka,this.Ta),kc=Object(uh.d)(ne.a.resolve(Nd.gb,{Ja:this.Ta}));jh.TaskExtensions.za(jh.TaskExtensions.Wf([Da,K,xb,kc],this.$.ka),
()=>{"undefined"===typeof OfficeExt||"undefined"===typeof OSF?m.ULS.sendTraceTag(537170505,0,15,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: ${Rc.a.t1()}`):this.mvi();m.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");this.a3f=Da.result;this.eh=kc.result;this.Ld(this.Gf);m.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.ka,3)}mvi(){k.EwaSettings.Ea(63)&&
OfficeExt.S2SOmexCatalogService.initRequestHandler(new Ih);this.$.mg.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new Ih,new qi(gf.AFrameworkApplication.da.appSettings.WebServiceBase),k.EwaSettings.Ea(70),!0);OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new Ih);OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new Ih)}dispose(){Ji.a.Ma(this.ddaFacade);this.$=this.ddaFacade=null;super.dispose()}static la(K){new ei(K)}}
Object(f.a)(ei,"DdaFacadeServiceFactory",u.a,[]);class aj{constructor(K,Da,xb,kc,Nc,md){this.$=K;this.agaveCommandManager=md}Ue(){return!1}Pe(){return!1}Be(K,Da,xb,kc){let Nc=!1;switch(Da.command){case -684355545:Nc=!0;break;case -741808261:Nc=!!xb;break;case -859308420:Nc=!!kc&&1===kc.iA;break;case 418618014:Nc=1===K&&!!kc&&1===kc.iA;break;case -167264441:Nc=Sg.a.OHb(this.$)&&1===K&&!!kc&&1===kc.iA;break;case -515602470:Da=k.EwaSettings.Ea(217)&&2===K;Nc=(1===K||Da)&&!!kc&&1===kc.iA;break;case 2086613372:Nc=
k.EwaSettings.Ea(217)&&2===K&&!!kc&&1===kc.iA;break;case -1336341324:Nc=k.EwaSettings.Ea(417)&&1===K&&!!kc&&1===kc.iA;break;case 451940422:Nc=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AnalyzeDataInAutoFilter",!1)&&1===K&&!!kc&&1===kc.iA;break;case -1444574190:case -336193495:Nc=1===K&&!!kc&&1===kc.iA;break;case 1296389134:Nc=1===K&&!!kc&&1===kc.iA;break;case fg.a.Kab:Nc=1===K&&!!kc&&1===kc.iA;break;case 1221897806:Nc=k.EwaSettings.Ea(155)&&2===K;break;case 1172793074:case 1930653487:Nc=
k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&2===K;break;case -1753056834:Nc=!0;break;case 932597253:Nc=!0;break;case 301511274:Nc=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:Nc=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!0)&&this.$.isEditMode;break;case 1723441034:Nc=this.$.isEditMode&&this.$.ea.NUb;break;case 1485761473:Nc=Sg.a.qBa()&&this.$.isEditMode}return Nc}executeCommand(K,
Da,xb){let kc=jh.TaskExtensions.Ul();const Nc=Da.command;switch(Da.command){case fg.a.Kab:this.agaveCommandManager.Soh(xb.SourceControlId);break;case 1296389134:this.agaveCommandManager.Y4j(xb.SourceControlId,xb.LabelText);break;case -684355545:this.agaveCommandManager.o$c();break;case -741808261:kc=this.agaveCommandManager.insertAgave(xb,Da);break;case -1336341324:k.EwaSettings.Ea(417)&&(kc=this.agaveCommandManager.Fmc(xb,K,Da));break;case 1172793074:k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",
!1)&&(kc=this.agaveCommandManager.Fmc(xb,K,Da));break;case 1485761473:kc=this.agaveCommandManager.Fmc(xb,K,Da);break;case -859308420:case -515602470:case -167264441:case 2086613372:case -336193495:case -1444574190:case 451940422:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:kc=this.agaveCommandManager.Fmc(xb,K,Da);break;default:kc=Pc.a(Nc)}return kc}}Object(f.a)(aj,"AgaveCommandHandler",null,[203]);class vj{}Object(f.a)(vj,
"Selection",null,[]);var kj=a(1236),Nj=a(1235),wj=a(1237),Cg=a(1233),Ei=a(1231);class pj{}Object(f.a)(pj,"SmartLookupApplicationInterface",null,[]);class Gj{}Object(f.a)(Gj,"ApplicationProperties",null,[]);class rj{}Object(f.a)(rj,"EnterpriseUserInfo",null,[]);class Li{}Object(f.a)(Li,"FeatureGates",null,[]);class Mi{constructor(K,Da,xb){this.oak=9E5;this.rak=3E5;this.OHd=null;this.BEf="";this.LHd=0;this.vzb=Date.now;this.ACa=K;this.beb=Da;(void 0===xb||xb)&&this.zod()}ihi(){var K=void 0===K?!0:K;
const Da=this.vzb();if(Da<this.LHd+this.oak)return Da>this.LHd+this.rak&&this.zod(),this.BEf;K&&this.zod();return""}zod(){this.OHd=this.OHd||new Promise(K=>{this.jhi().then(Da=>{this.BEf=Da;this.LHd=this.vzb();this.OHd=null;K(Da)})})}jhi(){return this.beb&&this.beb.length?new Promise(K=>{this.ACa.$C("SmartLookup",this.beb).then(Da=>{Da.IsSuccess?Da.Token||(K(""),m.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(m.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+
Da.ErrorCode+": "+Da.ErrorMessage),K(""));K(Da.Token)}).catch(Da=>{Da=me.c(Da);m.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+Da);K("")})}):(m.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))}}Object(f.a)(Mi,"SmartLookupAuthenticationManager",null,[821]);class si{static s7h(){switch(Object(S.a)(String,gf.AFrameworkApplication.Yd.AudienceGroup)||""){case "Dogfood":if(gf.AFrameworkApplication.da){let K=
gf.AFrameworkApplication.da.Sa("UserPrincipalName");K=Le.a.Tm(K);const Da=gf.AFrameworkApplication.da.Ur("SmartLookupINTEnabledForSKITeam")?gf.AFrameworkApplication.da.ay("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(Da,K)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static Fgi(){switch(gf.AFrameworkApplication.da.pa("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":gf.AFrameworkApplication.da.pa("IntentSvcEnableProdSourceLocationOverride")?"PROD":gf.AFrameworkApplication.da.pa("IntentSvcEnableIntSourceLocationOverride")?
"INT":si.s7h()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(f.a)(si,"Utils",null,[]);var bj=a(567),$i=a(175);class Ni{constructor(K){m.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.iFf=gf.AFrameworkApplication.da.pa("IsTellMeUpSellEnterpriseEnabled");
this.SUi=gf.AFrameworkApplication.da.Sa("SmartLookupApprovedOriginPattern");this.beb=gf.AFrameworkApplication.da.Sa("SmartLookupShredderServiceEndpoint");this.vVi=Db.a.AK(gf.AFrameworkApplication.da.Sa("AppCatalogUrl")||"");this.aeb=new Li;this.aeb.EnableAllTabV2=!0;this.aeb.EnableIntentService=!0;this.aeb.EnableInDocumentSearch=gf.AFrameworkApplication.da.pa("SmartLookupEnableInDocumentSearch");this.aeb.EnableLocalSearch=gf.AFrameworkApplication.da.pa("SmartLookupEnableLocalSearch");this.aeb.IntentServiceEndpoint=
si.Fgi();this.qVi=new Mi(K,this.beb)}get approvedOriginPattern(){return this.SUi}b2h(){return Promise.resolve(this.c2h())}c2h(){const K=new Gj;K.anid="";K.applicationVersion=gf.AFrameworkApplication.buildVersion;K.appCorrelationId=$i.a.create().toString();K.themePlatform=Ni.eok;K.lcid=gf.AFrameworkApplication.lcid;K.launchUtcTime=(new Date).toUTCString();K.featureGates=this.aeb;var Da=bj.a.pN(gf.AFrameworkApplication.lcid);Da=Da?Da.name:null;K.market=this.lkc(Da);K.uiLanguage=Da;K.sessionId=gf.AFrameworkApplication.userSessionId;
K.themeId=0;K.parentalControl=Ni.jjj;const xb=new rj;xb.CountryCode=this.lkc(Da);xb.ServiceEndpoint=this.beb;xb.IsGoLocal=!1;xb.IsEnabled=this.iFf;xb.IsEnterpriseEnabled=this.iFf;xb.TenantRoot=this.vVi;K.enterpriseUserInfo=xb;K.accessToken=this.qVi.ihi();return K}lkc(K){K=K.split("-");return K[K.length-1]}}Ni.eok="web";Ni.jjj="yes";Object(f.a)(Ni,"SmartLookupManager",null,[813]);class ti extends zg.a{constructor(K){super();this.$=K;this.isFirstLaunch=!1}Ue(){return!1}Pe(){return!1}Be(K,Da){K=k.EwaSettings.Ea(127);
return-983891024===Da.command&&K}executeCommand(K,Da){K=jh.TaskExtensions.Ul();-983891024===Da.command&&this.EOi();return K}EOi(){var K=new Ni(null);const Da={};var xb=ud.h(this.$).Hd(null).originalText;xb=Object(uf.a)(new vj,{neighborhood:xb,mentionStart:0,mentionLength:xb?xb.length:0});const kc=Object(uf.a)(new pj,{selection:xb,entryPoint:0});K.b2h().then(md=>{md.applicationName=ti.appName;md.isFirstLaunch=this.isFirstLaunch;md.themeId=5;Da[ti.smartLookupApplicationInterface]=JSON.stringify(kc);
Da[ti.t3g]=JSON.stringify(md);this.isFirstLaunch=!1});K=new kj.a("ExcelOnline","Web","en-Us");xb=new Nj.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");const Nc=new wj.a;Nc.optionalProperties[Cg.a.Cm]=Ag.a.instance.ia(1810);Nc.optionalProperties[Cg.a.taskPaneWidth]=350;Nc.optionalProperties[Cg.a.sourceLocationOverrideResourceId]="WAC.PROD.URL";Nc.jt=Da;Ei.a.instance.mCa(xb,"Taskpane","SmartLookupSDXTaskpane",K,Nc)}}ti.t3g="AppProperties";ti.appName="Excel";ti.smartLookupApplicationInterface=
"SmartLookupApplicationInterface";Object(f.a)(ti,"SmartLookupCommandHandler",zg.a,[203]);var xj=a(470);class Bg extends qh.a{constructor(K){super(K)}Uf(){xj.a(this.$,374,375,this.Ta,K=>{this.Lf([new aj(this.$,null,null,null,null,K),new ti(this.$)])})}static la(K){qh.a.qg(76,new Bg(K))}}Object(f.a)(Bg,"AgaveCommandHandlerFactory",qh.a,[]);var sh=a(1238),Oi=a(116);class ji{constructor(){this.Gf=null;this.ihb=(K,Da,xb,kc,Nc)=>{if(2===xb){K=Nc?Nc:{};Da=K.callback;xb=K.refresh?K.refresh:!1;if(!Da)return 16;
gf.AFrameworkApplication.da.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType")&&null!=K.storeType?this.Gf.I0f(Da,xb,K.storeType):this.Gf.ESd(Da,xb)}return 32};this.kCc=(K,Da,xb,kc,Nc)=>{if(2===xb){K=Nc?Nc:{};Da=K.Observer;if(!Da)return m.ULS.sendTraceTag(509686147,220,10,"registerAddinDetailObserver: invalid actionData: {0}",JSON.stringify(K)),16;if(!this.Gf||!this.Gf.J6)return m.ULS.sendTraceTag(509671006,220,10,"registerAddinDetailObserver: ddaFacadeService or its addinDetailsProvider is null, abort the operation, actionData: {0}",
JSON.stringify(K)),16;this.Gf.J6.Qhb(Da)}return 32};this.Bxj=(K,Da,xb,kc,Nc)=>{2===xb&&(K=Nc?Nc.callback:null)&&this.Gf.RYg(K);return 32};this.nyi=(K,Da,xb,kc,Nc)=>{2===xb&&this.Gf.eOb(null,OSF.AgaveHostAction.InsertAgave,Nc);return 32}}initialize(K){ji.initialized||(this.Gf=K,this.tj(),ji.initialized=!0)}tj(){gf.AFrameworkApplication.Dd.Rg(fg.a.ihb,Oi.a.frame,this.ihb,96);gf.AFrameworkApplication.Dd.Rg(fg.a.kCc,Oi.a.frame,this.kCc,96);gf.AFrameworkApplication.Dd.ae(fg.a.lwj,Oi.a.frame,this.Bxj);
k.EwaSettings.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.OfficeVSO_7976369_RemoveAddinSearchFGs")&&gf.AFrameworkApplication.Dd.Rg(fg.a.lqf,Oi.a.frame,this.nyi,96)}static get instance(){ji.La||(ji.La=new ji);return ji.La}}ji.La=null;ji.initialized=!1;Object(f.a)(ji,"AgaveCommandActor",null,[]);var ui=a(1292),fi=a(1234),ri=a(113),sj=a(332),cj=a(333),Gi=a(994),xh=a(18),tj=a(359);class Mh{constructor(){this.o7d=this.oKc=null;this.rB=0;this.mKc=null}}Object(f.a)(Mh,"FirstPartyAddinTaskpaneOverrides",
null,[]);class A{constructor(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}}Object(f.a)(A,"IdeasSelectionContext",null,[]);class ca extends A{constructor(){super();this.hasTableHeaders=this.isPivotTable=this.isTable=!1;this.tableName=null;this.userSelectedPivotTable=!1}}Object(f.a)(ca,"IdeasTableSelectionContext",A,[]);class Ra{constructor(){this.sheetName=null;this.lastRow=
this.firstRow=this.lastColumn=this.firstColumn=0}}Object(f.a)(Ra,"AutoFilterRange",null,[]);class Zb{constructor(){this.autoFilterType=this.autoFilterRange=null;this.id=this.itemIndex=0}}Object(f.a)(Zb,"IdeasAutoFilterSource",null,[]);class wc{constructor(K,Da){this.selection=K;this.tables=Da}}Object(f.a)(wc,"IdeasXLIMTableBoundaries",null,[]);var Jc=a(59),fd=a(1027),$d=a(74),Be=a(142),Re=a(45),lf=a(383),xf=a(200),$f=a(190),tg=a(573),Vf=a(247),ug=a(111),lh=a(143),ni=a(55);class oi extends Ed.a{constructor(){super();
this.W_="calc(100% - 46px)";this.Vba="15px";this.X_="0";this.Bob="WACDialogPanel";this.UG=695;this.Cob=462;this.WE="80%";this.onb=350;this.vua="100%";this.Rd=5;this.ug="AppsForOfficeInsertionDialog";this.NSc=!!gf.AFrameworkApplication.da&&gf.AFrameworkApplication.da.pa("OfficeAddinEnableInsertDialogAccessibilityFix")}yz(){super.yz();this.Wj.style.width=this.vua;this.Wj.style.height=this.W_;this.Wj.style.marginTop=this.Vba;this.Wj.style.padding=this.X_}zra(){this.Wj.style.width=this.vua;this.Wj.style.height=
this.W_;this.Wj.style.marginTop=this.Vba;this.Wj.style.padding=this.X_;this.UG>oe.a.T3?(this.nd.style.width=String.format("{0}px",oe.a.T3),this.nd.style.overflowX="scroll",gf.AFrameworkApplication.isRtl?this.nd.style.right="0":this.nd.style.left="0"):(this.nd.style.width=String.format("{0}px",this.UG),this.nd.style.overflowX="hidden");this.nd.offsetHeight>oe.a.$U||this.Cob+50>oe.a.$U?(this.nd.style.height=String.format("{0}px",oe.a.$U),this.nd.style.overflowY="scroll",this.nd.style.top="0",gf.AFrameworkApplication.isRtl?
this.nd.style.right="0":this.nd.style.left="0",this.NSc||(this.nd.style.marginTop="-48px"),this.Wj.style.minHeight=String.format("{0}px",this.onb)):(this.nd.style.overflowY="hidden",this.nd.style.top="10%",this.nd.style.height=this.WE);this.Nda()}Nda(){if(this.nd){var K=this.nd.style.zIndex;this.nd.style.zIndex="-9999";if(this.UG>oe.a.T3)gf.AFrameworkApplication.isRtl?this.nd.style.marginRight="0":this.nd.style.marginLeft="0";else{const Da=String.format("{0}px",Math.floor(-this.nd.offsetWidth/2));
gf.AFrameworkApplication.isRtl?this.nd.style.marginRight=Da:this.nd.style.marginLeft=Da;gf.AFrameworkApplication.isRtl?this.nd.style.right="50%":this.nd.style.left="50%"}this.nd.style.zIndex=String(K)}else m.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}AG(){super.AG();const K=document.getElementById(this.Rj(this.Bob));K.style.width=String.format("{0}px",this.UG);K.style.height=this.WE}get rea(){return this.Wj}}Object(f.a)(oi,"AppsForOfficeInsertionDialog",Ed.a,[720]);
class Oj extends Ed.a{constructor(K,Da,xb){K=void 0===K?!0:K;Da=void 0===Da?!0:Da;xb=void 0===xb?null:xb;super();this.W_="calc(100% - 46px)";this.Vba="15px";this.X_="0";this.Bob="WACDialogPanel";this.UG=695;this.Cob=462;this.WE="80%";this.onb=350;this.vua="100%";this.Vhe=this.Kja=null;this.nie="auto";this.oie="5px";this.qie="auto";this.mie="40px";this.r0b="100px";this.Dob="200px";this.Rd=5;this.ug="SDXDialog";this.Z1b=K;this.wFb=Da;this.m0b=xb}yz(){super.yz();this.Wj.style.width=this.vua;this.Wj.style.height=
this.W_;this.Wj.style.marginTop=this.Vba;this.Wj.style.padding=this.X_}zra(){this.Wj.style.width=this.vua;this.Wj.style.height=this.Z1b?this.W_:"100%";this.Wj.style.marginTop=this.Z1b?this.Vba:"0px";this.Wj.style.padding=this.X_;if(this.Z1b){this.r0b&&this.Dob&&(this.UG=parseInt(this.Dob.substring(0,this.Dob.length-2)),this.WE=this.r0b);this.UG>oe.a.T3?(this.nd.style.width=String.format("{0}px",oe.a.T3),this.nd.style.overflowX="scroll",gf.AFrameworkApplication.isRtl?this.nd.style.right="0":this.nd.style.left=
"0"):(this.nd.style.width=String.format("{0}px",this.UG),this.nd.style.overflowX="hidden");if(this.nd.offsetHeight>oe.a.$U||this.Cob+50>oe.a.$U)this.nd.style.height=String.format("{0}px",oe.a.$U),this.nd.style.overflowY="scroll",this.nd.style.top="0",gf.AFrameworkApplication.isRtl?this.nd.style.right="0":this.nd.style.left="0",this.Wj.style.minHeight=String.format("{0}px",this.onb);else{this.nd.style.overflowY="hidden";const K="%"===this.WE.substring(this.WE.length-1,this.WE.length),Da=K?parseInt(this.WE.substring(0,
this.WE.length-1)):parseInt(this.WE.substring(0,this.WE.length-2));this.nd.style.top=K?(100-Da)/2+"%":100*(oe.a.$U-Da)/oe.a.$U/2+"%";this.nd.style.height=this.WE}this.Nda()}else this.nd.style.left=this.nie,this.nd.style.right=this.oie,this.nd.style.top=this.qie,this.nd.style.bottom=this.mie,this.nd.style.width=this.Dob,this.nd.style.height=this.r0b,this.nd.style.overflowX="hidden",this.nd.style.overflowY="hidden"}Nda(){if(this.nd){var K=this.nd.style.zIndex;this.nd.style.zIndex="-9999";if(this.UG>
oe.a.T3)gf.AFrameworkApplication.isRtl?this.nd.style.marginRight="0":this.nd.style.marginLeft="0";else{const Da=String.format("{0}px",Math.floor(-this.nd.offsetWidth/2));gf.AFrameworkApplication.isRtl?this.nd.style.marginRight=Da:this.nd.style.marginLeft=Da;gf.AFrameworkApplication.isRtl?this.nd.style.right="50%":this.nd.style.left="50%"}this.nd.style.zIndex=String(K)}else m.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}AG(){super.AG();const K=document.getElementById(this.Rj(this.Bob));
K.style.width=String.format("{0}px",this.UG);K.style.height=this.WE}get C9(){return this.Z1b}get rea(){return this.Wj}get instanceId(){return this.Kja}set instanceId(K){this.Kja=K}get Oec(){return this.Vhe}set Oec(K){this.Vhe=K}aQj(K,Da,xb,kc){this.nie=K;this.oie=Da;this.qie=xb;this.mie=kc}cQj(K,Da){this.r0b=K;this.Dob=Da}}Object(f.a)(Oj,"SDXDialog",Ed.a,[]);var Hi=a(924),yj=a(110),P=a(305),Qa;(function(K){K[K.Valid=2]="Valid";K[K.Invalid=4]="Invalid";K[K.All=6]="All"})(Qa||(Qa={}));Object(f.b)("MetadataState",
Qa);var mb=a(356);class fc extends zg.a{constructor(K,Da,xb,kc,Nc){super();this.ysa={};this.IZd={};this.smd={};this.tVa=this.sdxDialog=this.P2=null;this.Shb=!1;this.O3j=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAppsForOffice","Ribbon"],["LaunchAddinDialogFromTellMe","TellMe"],["TeachingCallout","TeachingCallout"],["AddinFlyoutMoreButton","AddinFlyoutSeeAll"],["InsertMoreAddInsFromFooter","InsertMoreAddInsFromFooter"],["InsertMoreAddInsFromBackstageFooter","InsertMoreAddInsFromBackstageFooter"],
["LaunchMyAddInsFromBackstage","BackstageSeeAll"]]);this.Soh=md=>{md?(md=new Uh.a(-847286761,Qe.a.Bd,this.$.se,0,md),this.$.Ha.Ad(md,{["CalloutName"]:19})):m.ULS.sendTraceTag(509220127,220,10,"Control id is null.")};this.Qni=(md,Cd,Td,we,Fe)=>{if(2!==Td)return 32;this.Utc(Fe);return 32};this.FKb=(md,Cd,Td,we,Fe)=>{2===Td&&(this.P2=new oi,this.P2.initializeAndShow("",null,null),md=Fe.CommandValueId,Cd=[],Cd.push(Fe.SourceControlId),Cd.push(md),Cd.push(null),this.Gf.UAf(this.P2.rea,Cd));return 32};
this.Utc=md=>{var Cd=md[Hi.a.wBb];md=md[Hi.a.Xga];var Td=md.optionalProperties[Cg.a.iXe];const we=md.optionalProperties[Cg.a.nXe],Fe=md.optionalProperties[Cg.a.xm],vf=md.optionalProperties[Cg.a.dialogHeight],Jf=md.optionalProperties[Cg.a.dialogWidth],lg=md.optionalProperties[Cg.a.dialogLeft],ph=md.optionalProperties[Cg.a.mXe],eh=md.optionalProperties[Cg.a.dialogTop],$g=md.optionalProperties[Cg.a.cXe];var Ug=md.optionalProperties.InstanceToken;Ug=null!=Ug?Ug:(new Ke.a($i.a.create(),1)).toString();
this.sdxDialog=new Oj(Td,we);null!=lg&&null!=ph&&null!=eh&&null!=$g&&this.sdxDialog.aQj(lg,ph,eh,$g);null!=vf&&null!=Jf&&this.sdxDialog.cQj(vf,Jf);this.sdxDialog.instanceId=Ug;this.sdxDialog.Oec=md.optionalProperties[Cg.a.Oec];this.sdxDialog.initializeAndShow(Fe,null,null);Td={};Td.div=this.sdxDialog.rea;Td.id=Ug;Td.solutionId=Cd.getId();Td.version=Cd.CHa;Td.storeType=Cd.getStoreType();Td.storeId=Cd.getStoreId();Td.assetId=null;Td.assetStoreId=null;Td.settings=null!=md.jt?md.jt:{};Td.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;
Td.osfControlType=OSF.OsfControlType.ContainerLevel;Td.sourceLocationOverrideResourceId=md.optionalProperties[Cg.a.sourceLocationOverrideResourceId];Td.featureGates=gf.AFrameworkApplication.da.adf(Cd.getId());Td.onExtensionLaunchCallback=md.optionalProperties[Cg.a.onExtensionLaunchCallback];Cd={};Cd.InstanceId=Td.id;Cd.WebExtensionType=2;Cd.PrimaryMarketplace={};Cd.PrimaryMarketplace.SolutionId=Td.solutionId;Cd.PrimaryMarketplace.MarketplaceType=Td.storeType;Cd.PrimaryMarketplace.MarketplaceRef=Td.storeId;
Cd.PrimaryMarketplace.SolutionVersion=Td.version;Cd.SrcLocationOverrideResourceId=Td.sourceLocationOverrideResourceId;Cd.WebExtensionOsfControlType=6;Cd.OnExtensionLaunchCallback=Td.onExtensionLaunchCallback;this.ysa[Td.solutionId]=Td.settings;const {lBc:Ch,TBb:Yh}=this.Lvc([],Td.solutionId);Cd.OsfPropertyBag=Ch;Cd.HostPropertyBag=Yh;this.Gf.qNa(Cd);this.Gf.Vg.insertOsfControl(Td)};this.lpi=(md,Cd,Td,we,Fe)=>{if(2!==Td)return 32;md=Fe[Hi.a.wBb];Td=Fe[Hi.a.XMa];Fe=Fe[Hi.a.Xga];Cd=new ui.a;Cd.Pyi=Fe.optionalProperties.InstanceToken;
Cd.Cm=Fe.optionalProperties[Cg.a.Cm];Cd.BO=Fe.optionalProperties[Cg.a.BO];Cg.a.taskPaneWidth in Fe.optionalProperties&&(Cd.taskPaneWidth=Fe.optionalProperties[Cg.a.taskPaneWidth]);Cd.sourceLocationOverrideResourceId=Fe.optionalProperties[Cg.a.sourceLocationOverrideResourceId];Cd.onTaskPaneClose=Fe.optionalProperties[Cg.a.onTaskPaneClose];Cd.onExtensionLaunchCallback=Fe.optionalProperties[Cg.a.onExtensionLaunchCallback];Cd.XA=Fe.jt;Cd.XMa=Td;Td=new Uh.a(-859308420,0,2,0,"");we=md.getStoreType()===
OSF.StoreType.Sdx;const vf=new fd.a;vf.G2=Fe.optionalProperties.HeaderCssClass||xh.a.z8a;vf.llb=Fe.optionalProperties.TitleCssClass;this.L4(Td,md.getId(),Cd,we,vf);return 32};this.Poi=(md,Cd,Td,we,Fe)=>{if(2!==Td)return 32;md=Fe[Hi.a.wBb].getId();Fe=Fe[Hi.a.Xga].optionalProperties[Cg.a.sourceLocationOverrideResourceId];return md?(this.Gf.Vg.refreshOsfControl(md,Fe),32):8};this.Wmj=md=>{md=md.Result;if(md=null===md?null:md.SolutionId)this.Gf.aAe(md),ug.a(this.$).Iaa(3,md)};this.aZf=(md,Cd)=>{var Td;
const we=(md=md.Result)?md.AgaveData:null;if(we){var Fe=Telemetry.PrivacyRules.GetPrivacyCompliantId(we.PrimaryMarketplace.SolutionId,we.PrimaryMarketplace.MarketplaceType,null===(Td=null===we||void 0===we?void 0:we.AssetMarketplace)||void 0===Td?void 0:Td.SolutionId,null,null,we.PrimaryMarketplace.MarketplaceRef);m.ULS.shipAssertTag(537170434,0,we.TaskpaneWidth===fc.jWe,`Taskpane width is ${we.TaskpaneWidth}, assetId is ${Fe}.`);if(Td=this.smd[we.PrimaryMarketplace.SolutionId])Td.oKc&&(we.TaskpaneTitle=
Td.oKc),Td.mKc&&(we.TaskpaneIconId=Td.mKc),Td.o7d&&(we.TaskpaneButtonTooltip=Td.o7d),0<Td.rB&&(we.TaskpaneWidth=Td.rB);Cd&&(we.FocusOnIframeWhenLoaded=Cd.focusOnIframeWhenLoaded,Cd.width&&(we.TaskpaneWidth=Cd.width),we.TaskpaneIconCssClass=Cd.Bn,we.TaskpaneHeaderCssClass=Cd.G2,we.TaskpaneTitleCssClass=Cd.llb,we.IsFirstPartyOptOutAppContextOptmization=Cd.isFirstPartyOptOutAppContextOptmization);if(this.ysa[we.PrimaryMarketplace.SolutionId]){const {lBc:vf,TBb:Jf}=this.Lvc(we.OsfPropertyBag,we.PrimaryMarketplace.SolutionId);
we.OsfPropertyBag=vf;we.HostPropertyBag=Jf}tg.a(we)||(we.WebExtensionOsfControlType=1);we.OnExtensionLaunchCallback=this.IZd[we.PrimaryMarketplace.SolutionId];we&&(this.Gf.aAe(md.SolutionId),this.Gf.qNa(we))}else m.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};this.HTh=md=>{md&&(this.Cld.qzf(md),this.VLe())};this.eZf=md=>{md=md.toDataURL("image/jpeg");const Cd=this.Gf.Nea(fc.Wmf+"."+fc.omc),Td={};Td.screenshot=md;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Cd,
"onScreenshot",Td,()=>{})};this.hni=(md,Cd,Td,we,Fe)=>{if(2!==Td)return 32;if(ri.a.ij(Fe)||Fe[Hi.a.fQe]!==fi.a.action)return 8;Cd=Fe[Hi.a.Xga];return Cd?(md=(md=this.Lci(Fe))?this.Gf.Nea(md):null)?(Fe=this.Gf.Xnh(Fe[Hi.a.XMa],Cd.optionalProperties[Cg.a.x3c]),k.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(Td=this.Gf.hY(md),Td.TaskpaneTitle!==Cd.optionalProperties[Cg.a.Cm]&&(Td.TaskpaneTitle=Cd.optionalProperties[Cg.a.Cm],Td.TaskpaneIconCssClass=Cd.optionalProperties.IconCssClass,
Td.TaskpaneIconUrl=Cd.optionalProperties.TaskPaneIconUrl,Td.TaskpaneIconId=Cd.optionalProperties.TaskPaneIconId,Td.OnExtensionLaunchCallback=Cd.optionalProperties[Cg.a.onExtensionLaunchCallback],k.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?(Cd=this.Gf.Vg,Cd.changeIframeTitle(md,Td.TaskpaneTitle),Td=Cd.getOsfControl(md),Cd.raiseOsfControlStatusChange(Td)):(Cd=this.Gf.Vg.getOsfControl(md),this.Gf.Vg.raiseOsfControlStatusChange(Cd)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(md,
Fe,this.xTb),32):8:8};this.xTb=(md,Cd)=>{this.Gf.fWh(md,Cd)};this.EUd=()=>{jh.TaskExtensions.v7(F.GetServiceTaskFactory.ud(this.$.ga,20,404,1),md=>{md.result.joa()},this.$.ka)};this.$=K;this.viewBlockContainerHelpers=xb;this.Gf=Da;this.Cld=kc;this.nl=Nc;this.nl.ae(fg.a.skg,Oi.a.frame,this.lpi);this.nl.ae(fg.a.q$f,Oi.a.frame,this.Poi);this.nl.ae(fg.a.v5e,Oi.a.frame,this.hni);this.nl.ae(fg.a.Utc,Oi.a.frame,this.Qni);this.nl.ae(fg.a.FKb,Oi.a.frame,this.FKb)}MZg(K){this.addHandler(fc.aPd,K)}EBj(K){this.removeHandler(fc.aPd,
K)}dispose(){Ji.a.Ma(this.P2);this.P2=null;this.Shb&&(this.$.ea.xo(this.EUd),this.Shb=!1);super.dispose()}o$c(){this.P2&&this.P2.hide()}Y4j(K,Da){var xb;if(K){this.raiseEvent(fc.aPd);const kc=K.split("|");this.USi(K,Da,kc);this.P2=new oi;this.P2.initializeAndShow("",null,null);this.Gf.UAf(this.P2.rea,kc);window[fc.m1g]=null!==(xb=this.O3j.get(K))&&void 0!==xb?xb:"Unknown"}}Fmc(K,Da,xb){var kc=jh.TaskExtensions.Ul();if(-515602470===xb.command||-167264441===xb.command||-336193495===xb.command||2086613372===
xb.command||-1444574190===xb.command||-1336341324===xb.command||451940422===xb.command)kc=this.Fni(K,Da,xb);418618014===xb.command&&(Da=new ui.a,Da.Cm=Ag.a.instance.ia(1823),kc=this.L4(xb,fc.nri,Da,!0));if((xb.tabName===this.$.Pd+nh.a.Y$f||xb.tabName===nh.a.d4)&&2===xb.Tg||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),K[Qe.a.We])||K[Qe.a.We]===nh.a.xN)return this.Wkf(K,xb);if(7===xb.Tg&&K.SourceControlId===this.$.Pd+nh.a.xAa)return K.MenuItemId=nh.a.ETd,this.Wkf(K,
xb);1221897806===xb.command&&(kc=this.$jg(xb,"Format"));if(1930653487===xb.command||1172793074===xb.command)kc=this.$jg(xb,"Data");-1753056834===xb.command&&(kc=this.z0j(xb));932597253===xb.command&&(m.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),yj.c(932597253,!0),Da=new ui.a,Da.Cm=Ag.a.instance.ia(2163),Da.sourceLocationOverrideResourceId=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?fc.enj:fc.gnj,Da.focusOnIframeWhenLoaded=
!0,Da.taskPaneWidth=fc.wof,kc={},kc.LaunchSource=Object(S.a)(String,K.SourceControlId),kc.LaunchMode="Default",Da.XA=kc,kc=this.L4(xb,fc.fnj,Da,!0));301511274===xb.command&&(kc=this.L0j(xb));if(515196233===xb.command){Da=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableTaskPaneFeedback",!1);kc=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableClosePaneFeedback",!1);var Nc=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2OptimizeWorkbookManager",
!1)?ne.a.zg(Nd.bc):this.$.ga.Da(465);Nc&&(Nc.RQa(),Da||kc)&&(Nc.Nxi(),kc&&Nc.BRj(10===xb.Tg));Nc=new ui.a;Nc.Cm=Ag.a.instance.ia(2237);const md={};md.SourceUILocation=sj.a[xb.Tg];if(Da||kc)md.SessionID=this.$.ea.sessionId,Da&&this.x0d(md);Nc.XA=md;Da=new fd.a;Da.G2=xh.a.z8a;kc=this.L4(xb,fc.Uhj,Nc,!0,Da,void 0,Nc.Cm)}1723441034===xb.command&&(Da=new ui.a,Da.Cm=Ag.a.instance.ia(2249),Da.focusOnIframeWhenLoaded=!0,Da.taskPaneWidth=fc.fqj,kc=new fd.a,kc.G2=xh.a.T1e,kc=this.L4(xb,P.c,Da,!0,kc));k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",
!1)&&K.LoadDataFromPictureTaskpane&&(Da={},kc=new ui.a,kc.Cm=Ag.a.instance.ia(2276),Da.SessionID=K.SessionID,kc.XA=Da,kc.focusOnIframeWhenLoaded=!0,kc=this.L4(xb,K.DataFromPictureAssetId,kc,!0));1485761473===xb.command&&Sg.a.qBa()&&(K=new ui.a,K.Cm=fc.unh,k.EwaSettings.isChangeGateEnabled("OfficeVSO:7904707_SDXTaskPaneHeaderIconSupport")&&(K.BO=fc.tnh),K.focusOnIframeWhenLoaded=!0,K.taskPaneWidth=fc.jWe,k.EwaSettings.isChangeGateEnabled("OfficeVSO:8070864_SendAudienceGroupToCopilot")&&(Da={},Da.AudienceGroup=
gf.AFrameworkApplication.Yd.AudienceGroup,K.XA=Da),Da=new fd.a,Da.G2=xh.a.T1e,kc=this.L4(xb,fc.snh,K,!0,Da));return kc}insertAgave(K,Da){var xb=jh.TaskExtensions.Ul();const kc=this.$;let Nc;var md=K[Cf.a.jla];Nc=K[Qe.a.Th];let Cd=null;fd.a.key in K&&(Cd=K[fd.a.key]);this.P2&&this.P2.hide();if(!Nc||!md)return m.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),xb;this.$.J9&&nh.a.Eia in K&&(Nc.EnabledInViewMode=K[nh.a.Eia]);K=this.I4h(Da.command);if(!Nc.EnabledInViewMode&&
!kc.Iu(null,!1,K))return xb;let Td=void 0===Nc.IsToBePersisted||null===Nc.IsToBePersisted||Nc.IsToBePersisted?0:16;if(1===Nc.TargetType)xb=this.Kyi(Nc,md,Da,Cd,Td);else{md=ud.h(kc);xb=this.viewBlockContainerHelpers.Emb(md);const we=kc.ea.isNamedObjectViewMode?kc.na.sheetName:kc.na.name;let Fe,vf,Jf,lg;xb?(md=xb.pg,Fe=md.$f.top,vf=md.$f.left,Jf=xb.dM.x,lg=xb.dM.y):(Fe=vf=1,xb=this.viewBlockContainerHelpers.wQa(md),Jf=xb.x,lg=xb.y);const ph=this.$.qa.ua.ie();Td|=64;xb=lf.a(this.$.userOperationManager,
(eh,$g,Ug)=>{var Ch=kc.qa.ua,Yh=Fe,Dh=vf,Ph=Jf,ej=lg;eh=Vf.b(eh,this.Wmj);const Ej=Ch.Pa(9,ph);Ej.sharedInfo=Nc;Ej.sheetName=we;Ej.positionRow=Yh;Ej.positionCol=Dh;Ej.positionOffsetX=Ph;Ej.positionOffsetY=ej;return Jc.g(Ch,"InsertWebExtension",Ej,eh,$g,Ug,null,0)},eh=>new xf.a(534,0,eh,Td),Da)}return xb}tlh(){var K=Yg.a.instance.Qd("Common.App.ICustomerFeedbackUiWrapper");if(!k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",!1)){var Da=Yg.a.instance.Qd("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");
this.Cld?this.Cld.gqb?this.VLe():Da.instance.Mhd(this.HTh):m.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined")}Da={};gf.AFrameworkApplication.da.C4c(Da);K=K.instance.getContext(Da);Da={};"telemetryGroup"in K&&(Da=K.telemetryGroup);Da.processSessionId=K.sessionId;Da.officeBuild=K.build;K.telemetryGroup=Da;K.feedbackType=-1;K.userVoiceEnabled=!1;"disableIncludeScreenshot"in K||(K.disableIncludeScreenshot=!1);"screenshot"in K||(K.screenshot=!1);K.disableScreenshotPreview=!1;K.includeScreenshotSelectedDefault=
!0;return K}wZf(K){if(!this.tVa){var Da=this.Uqd();Da=this.tJe(Da);const xb=new fd.a;xb.Bn=xh.a.mBb;xb.G2=xh.a.p2e;xb.llb=xh.a.ekd;this.tVa=this.lFc(Da,null,!1,null,xb);lh.b(this.$).nf(Be.a.wnj,{["Location"]:K?sj.a[K.Tg]:0,["InputMethod"]:K?cj.a[K.method]:0},void 0,!0);k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&this.Y8d()}}x0d(K){const Da=this.$.ea.pj.get(17);Yg.a.instance.Qd("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(xb=>
{xb.isFeatureEnabled("mso_sendASmile",Da).then(kc=>{K.FeedbackEnabled=Da&&kc;return null})})}JFi(){return this.Gf.dLi(this.Gf.qPa(fc.fRa,this.Uqd()))}$jg(K,Da){const xb=ud.h(this.$),kc=new ui.a;var Nc={};Nc.ActiveTab=Da;Nc.DatapaneFlighting=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1);Nc.MergeIvyBiDataSources=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeIvyBiDataSources",!1);Nc.ComboChartUIInXLO=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSComboChartUIInXLO",
!1);Nc.AceFlighting=!0;Nc.ThemeColorsFlighting=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&k.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");Nc.UOMirror=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",!1);Nc.FormatTaskPaneAceButtonDark=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneAceButtonDark",!1);Nc.FormatTaskPaneBetterFeedbackButton=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterFeedbackButton",
!1);Nc.FormatTaskPaneBetterScrollbar=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterScrollbar",!1);Nc.FormatTaskPaneUXImprovePhase2=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneUXImprovePhase2",!1);Nc.ChartTPNewFontAndColorTheme=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTPNewFontAndColorTheme",!1);Nc.ChartFOTPRenderRefactor=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSTrendlineEquationFormat",
!1);Nc.UOMirrorTaskPaneRefactor=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirrorTaskPaneRefactor",!1);this.x0d(Nc);Nc.startTimeMs=Date.now();Nc.UserSessionId=this.$.xa.UserSessionId;(Da=xb.ha.Va.iq)&&(Nc.SubSelection=Da);m.ULS.sendTraceTag(592524688,0,50,`Chart task pane launched. UserSessionId: ${Nc.UserSessionId}, UILocation: ${void 0===K.Tg||null===K.Tg?"Null":sj.a[K.Tg]}, SubSelection: ${Da||"ChartRoot"}`);kc.XA=Nc;kc.Cm=Ag.a.instance.ia(984);Nc=new fd.a;Nc.G2=xh.a.z8a;return this.L4(K,
fc.yfh,kc,!0,Nc)}z0j(K){const Da=new ui.a;Da.XA={};Da.Cm=Ag.a.instance.ia(1809);Da.BO=fc.uBf;const xb=new fd.a;xb.G2=xh.a.z8a;return this.L4(K,fc.uBf,Da,!0,xb,void 0,Da.Cm)}L0j(K){const Da=new ui.a;Da.XA={};Da.Cm=Ag.a.instance.ia(2187);const xb=new fd.a;xb.G2=xh.a.bMh;xb.llb=xh.a.t2e;const kc=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavPaneWebReadOnly",!1);return this.L4(K,fc.G_i,Da,!0,xb,kc)}Wkf(K,Da){const xb=fc.Wmf;var kc=K[Qe.a.We].toString();const Nc={},md=new ui.a;md.Cm=Ag.a.instance.ia(9);
switch(kc){case "A0":Nc.query=(K[Qe.a.Th]||"").split("|").slice(2,tj.a.o5).join("|");break;case "A1":Nc.query=K.CommandValueId;break;case "Help":Nc.query="";break;case nh.a.ETd:k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?(md.Cm=Ag.a.instance.ia(1775),md.sourceLocationOverrideResourceId=fc.omc,Nc.feedback=this.tlh()):Nc.query=kc;break;case "HelpArticle":Nc.query=K[Qe.a.Th];break;case "ContactSupport":Nc.query=kc;md.sourceLocationOverrideResourceId=
fc.Blh;break;case "ShowTraining":case "WhatsNew":Nc.query=kc;break;default:return od.Task.Wa(!0)}md.XA=Nc;kc=new fd.a;kc.G2=xh.a.z8a;return this.L4(Da,xb,md,!1,kc,K[nh.a.Eia]||!1)}tJe(K){const Da={};Da.SolutionId=fc.fRa;Da.Version="0.0.0.0";Da.StoreType=OSF.StoreType.Sdx;Da.StoreId=OSF.StoreType.Sdx;Da.AssetId=null;Da.AssetStoreId=null;Da.Height=0;Da.Width=0;Da.TargetType=OSF.OsfControlTarget.TaskPane;Da.IsToBePersisted=!1;Da.SourceLocationOverrideResourceId=K;Da.SharedRuntimeId=K;return Da}Fni(K,
Da,xb){function kc(){Cd.LaunchMode="Default";Nc.Cm=Ag.a.instance.ia(1822);Nc.BO=fc.S8b;Nc.Bn=xh.a.mBb;md.Bn=xh.a.mBb}const Nc=new ui.a,md=new fd.a,Cd={};this.tVa&&this.x0d(Cd);Cd.LaunchSource="";Cd.StartTimeMs=Date.now();Cd.CorrelationId=$i.a.create().toString();Nc.XA=Cd;Nc.focusOnIframeWhenLoaded=!0;Nc.taskPaneWidth=fc.wof;md.G2=xh.a.p2e;md.llb=xh.a.ekd;switch(xb.command){case -1444574190:let Td,we,Fe;Cd.LaunchMode="RecommendedPivotTables";Cd.SelectionContext="";Cd.LaunchSource="PivotTableHandRaise"===
Object(S.a)(String,K.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&k.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&K.SourceSelection){const vf=K.SourceSelection.split(",")[0];Da=k.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if((()=>{let Jf=Re.ab(vf,this.$.va);({sheetName:Td,f2f:we,range:Fe}=Jf);return Jf})().returnValue&&!ud.h(this.$).zd.h3(Fe))K=this.$.va.getItemByName(Td),Cd.SelectionContext=JSON.stringify(Object(uf.a)(new A,
{address:we,addressWithSheet:Td+"!"+Fe.EA(!1),sheetId:$d.d(K),sheetName:Td,isSheetEmpty:!1,columnCount:Fe.width,rowCount:Fe.height,columnIndex:Fe.left+Da,rowIndex:Fe.top+Da,selectionType:"Continuous"}));else if((K=this.$.Ud.getItemByName(Object(S.a)(String,K.SourceSelection)))&&$d.n(K)){Fe=$f.a(K,!0);let Jf=this.$.va.getItemByName(K.sheetName);Cd.SelectionContext=JSON.stringify(Object(uf.a)(new ca,{tableName:K.name,hasTableHeaders:$f.d(K),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:Fe.EA(!1),
addressWithSheet:Jf.name+"!"+Fe.EA(!1),sheetId:$d.d(Jf),sheetName:Jf.name,isSheetEmpty:!1,columnCount:Fe.width,rowCount:Fe.height,columnIndex:Fe.left+Da,rowIndex:Fe.top+Da,selectionType:"Continuous"}))}}Nc.Cm=Ag.a.instance.ia(1821);Nc.BO=fc.llj;Nc.Bn=xh.a.z4e;md.Bn=xh.a.z4e;break;case -336193495:Cd.LaunchMode="RecommendedCharts";Nc.Cm=Ag.a.instance.ia(1820);Nc.BO=fc.Vuj;Nc.Bn=xh.a.A4e;md.Bn=xh.a.A4e;break;case -1336341324:if(!k.EwaSettings.Ea(417))return od.Task.Wa(!1);Cd.LaunchMode="NL";Nc.BO=fc.S8b;
switch(k.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:Nc.Cm=Ag.a.instance.ia(1825);Cd.NLLaunchModeBrandingCandidatesIndex=1;break;case 2:Nc.Cm=Ag.a.instance.ia(1826);Cd.NLLaunchModeBrandingCandidatesIndex=2;break;default:Nc.Cm=Ag.a.instance.ia(1824),Cd.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!k.EwaSettings.Ea(217))return od.Task.Wa(!1);Cd.LaunchMode="ChartDesigner";Cd.LaunchSelectionMode=Da.toString();
Nc.Cm=Ag.a.instance.ia(1827);Nc.BO=fc.S8b;break;case 451940422:Cd.LaunchSource="AutoFilter";Da=JSON.parse(K.CommandValueId);Cd.AutoFilterSource=JSON.stringify(Object.assign(new Zb,{autoFilterRange:{sheetName:Da.AutoFilterRange.SheetName,firstColumn:Da.AutoFilterRange.FirstColumn,lastColumn:Da.AutoFilterRange.LastColumn,firstRow:Da.AutoFilterRange.FirstRow,lastRow:Da.AutoFilterRange.LastRow},autoFilterType:Da.AutoFilterType,itemIndex:Da.ItemIndex,id:Da.Id}));kc();break;case -167264441:Cd.LaunchMode=
"ExcelIntelligence";Cd.TableName=K.tableName;Nc.Cm=Ag.a.instance.ia(2287);Nc.BO=fc.S8b;Nc.Bn=xh.a.mBb;md.Bn=xh.a.mBb;break;default:k.EwaSettings.Ea(217)&&(Cd.LaunchSelectionMode=Da.toString()),k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&(Cd.XlimTableBoundaries=this.kii()),kc()}Nc.sourceLocationOverrideResourceId=this.Uqd();return this.tVa?this.tVa.Vr(()=>this.IMj(Cd,Nc)):this.Pwi(xb,Nc,md,Cd)}Pwi(K,Da,xb,kc){this.tVa=this.lFc(this.tJe(Da.sourceLocationOverrideResourceId),
Da,!1,K,xb,!1);kc.NoActionMsgOnFirstInstance=!0;this.ysa[fc.fRa]=kc;return this.tVa}IMj(K,Da){const xb=this.Gf.Nea(this.Gf.qPa(fc.fRa,Da.sourceLocationOverrideResourceId));if(xb){this.ysa[fc.fRa]=K;const {lBc:kc,TBb:Nc}=this.Lvc(this.Gf.hY(xb).OsfPropertyBag,fc.fRa);this.Gf.hY(xb).OsfPropertyBag=kc;this.Gf.hY(xb).HostPropertyBag=Nc}this.mCa(fc.fRa,fi.a.action,"LaunchIdeasAction",K,"1.0.0.0",Da);return od.Task.Wa(!0)}Uqd(){const K=gf.AFrameworkApplication.Yd.AudienceGroup;if(k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPEApi",
!1)){switch(K){case "Automation":case "Dogfood":case "Microsoft":return"Ideas.PPEApi.PPE"}return"Ideas.PPEApi"}switch(K){case "Automation":case "Dogfood":case "Microsoft":return"Insights.Https.PPE.Bundle"}return"Insights.Https.Bundle"}L4(K,Da,xb,kc,Nc,md,Cd){xb=void 0===xb?null:xb;kc=void 0===kc?!1:kc;Nc=void 0===Nc?null:Nc;md=void 0===md?!1:md;Cd=void 0===Cd?null:Cd;jh.TaskExtensions.Ul();xb||(xb=new ui.a);const Td={};Td.SolutionId=Da;Td.Version="0.0.0.0";Td.StoreType=kc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;
Td.StoreId=kc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Td.AssetId=null;Td.AssetStoreId=null;Td.Height=0;Td.Width=0;Td.TargetType=OSF.OsfControlTarget.TaskPane;Td.IsToBePersisted=!1;Td.SourceLocationOverrideResourceId=xb.sourceLocationOverrideResourceId;if(xb.Cm||Cd)this.smd[Da]=Object(uf.a)(new Mh,{oKc:xb.Cm,o7d:Cd,mKc:xb.BO});k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(xb.XA||(xb.XA={}),xb.XA.ShowFeedback=this.$.isFeedbackEnabled,
this.ysa[Da]=xb.XA):xb.XA&&(this.ysa[Da]=xb.XA);this.IZd[Da]=xb.onExtensionLaunchCallback;Da={};Da[Qe.a.Th]=Td;Cd={};Cd.solutionId=Td.SolutionId;Cd.version=Td.Version;Cd.storeType=Td.StoreType;Cd.storeId=Td.StoreId;Cd.assetId=Td.AssetId;Cd.assetStoreId=Td.AssetStoreId;Cd.height=Td.Height;Cd.targetType=Td.TargetType;Cd.width=Td.Width;Cd.isAddinCommands=!kc;Da[Cf.a.jla]=Cd;Nc||(Nc=new fd.a);Nc.focusOnIframeWhenLoaded=xb.focusOnIframeWhenLoaded;Nc.width=xb.taskPaneWidth;Da[fd.a.key]=Nc;Da[nh.a.Eia]=
md;return this.insertAgave(Da,K)}Kyi(K,Da,xb,kc,Nc){const md=(Fe,vf)=>{var Jf=Fe.SolutionId;const lg=OSF.OsfControl.isFirstPartyStoreString(Fe.StoreType);lg&&Fe.SourceLocationOverrideResourceId&&(Jf=this.Gf.qPa(Jf,Fe.SourceLocationOverrideResourceId));var ph=this.Gf.NMe(Jf,null,Fe.SharedRuntimeId);if(lg){if(k.EwaSettings.Ea(263)&&ph&&(Jf=this.Gf.Nea(Jf))){const {lBc:eh,TBb:$g}=this.Lvc(this.Gf.hY(Jf).OsfPropertyBag,Fe.SolutionId);if(Jf=this.Gf.Vg.getOsfControl(Jf))Jf.setSettings(eh),Jf.setHostSettings($g)}Fe.SharedRuntimeId&&
ph||this.Gf.Vg.refreshOsfControl(Fe.SolutionId,Fe.SourceLocationOverrideResourceId)}if(!ph){const eh=this.$.qa.ua.ie();let $g=519;ph=(Ug,Ch,Yh)=>{var Dh=this.$.qa.ua;Ug=Vf.b(Ug,this.aZf);const Ph=Dh.Pa(9,eh);Ph.sharedInfo=Fe;return Jc.g(Dh,"InsertAgaveTaskpane",Ph,Ug,Ch,Yh,kc,0)};void 0===Fe.IsToBePersisted||null===Fe.IsToBePersisted||Fe.IsToBePersisted||($g=538,ph=(Ug,Ch,Yh)=>{var Dh=Telemetry.PrivacyRules.GetPrivacyCompliantId(Fe.SolutionId,Fe.StoreType,Fe.AssetId,null,null,Fe.StoreId);m.ULS.sendTraceTag(537170442,
220,50,`Web Method ShowAgaveTaskpane is called, StoreType ${Fe.StoreType}, StoreId ${Fe.StoreId}, SolutionId ${Dh}.`);Dh=this.$.qa.ua;Ug=Vf.b(Ug,this.aZf);const Ph=Dh.Pa(9,void 0===eh?null:eh);Ph.sharedInfo=Fe;return Jc.g(Dh,"ShowAgaveTaskpane",Ph,Ug,Ch,Yh,kc,0)});Nc|=64;return lf.a(this.$.userOperationManager,ph,Ug=>new xf.a($g,0,Ug,Nc),vf)}return jh.TaskExtensions.ffa()},Cd=Fe=>{var vf=Telemetry.PrivacyRules.GetPrivacyCompliantId(Fe.solutionId,Fe.storeType,Fe.assetId,null,null,Fe.storeId);m.ULS.sendTraceTag(537170440,
220,50,`Insert addincommands for ${vf} from ${Fe.storeType}.`);vf={};const Jf=new r.a;Jf.add(Fe);vf[Cf.a.Mub]=Jf;vf[Cf.a.$W]=3;Fe=new Uh.a(fg.a.DKb,0,this.$.se,0,null);return this.$.Ha.Ad(Fe,vf)};if(!k.EwaSettings.Ea(52)||K.StoreId===OSF.StoreType.FirstParty)return md(K,xb,kc);if(Da.isAddinCommands)return Cd(Da);const Td=new kh.a,we={};we.solutionId=K.SolutionId;we.version=K.Version;we.storeType=K.StoreType;we.storeId=K.StoreId;we.targetData=K;this.Gf.Vg.isAddinCommandsAsync(we,(Fe,vf,Jf)=>{Td.setResult(vf);
Fe||(Fe=Jf.targetData,vf=Telemetry.PrivacyRules.GetPrivacyCompliantId(Fe.SolutionId,Fe.StoreType,Fe.AssetId,null,null,Fe.StoreId),m.ULS.sendTraceTag(537170438,220,10,`Judging AddinCommands failed for ${vf} from ${Fe.StoreType} during addin inserting`))});return jh.TaskExtensions.ts(Td.task,Fe=>Fe.result?Cd(Da):md(K,xb,kc),this.$.ka)}Lvc(K,Da){if(!this.ysa[Da])return{ask:K,TBb:null};const xb={},kc={};if(K)for(const md of K){const [Cd,Td]=md;xb[Cd]=Td}K=this.ysa[Da];for(var Nc of Object.keys(K))Da=
K[Nc],Nc===fc.JTh&&k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?xb[Nc]=kc[Nc]=Sys.Serialization.JavaScriptSerializer.serialize(Da):xb[Nc]=kc[Nc]=Sys.Serialization.JavaScriptSerializer.serialize(Da.toString());Nc=Object.keys(xb).map(md=>[md,xb[md].toString()]);K=Object.keys(kc).map(md=>[md,kc[md].toString()]);return{lBc:Nc,TBb:K}}USi(K,Da,xb){const kc=this.$.xa.UserSessionId,Nc=this.$.xa.UICultureTag,md=this.$.xa.UICultureTagLcid,Cd=this.$.xa.WacHostId;
let Td="",we="";5<=xb.length&&(Td=xb[3],we=xb[4]);this.VSi(Td,we,K,Da,Nc,md,kc,Cd)}VSi(K,Da,xb,kc,Nc,md,Cd,Td){const we={};we.a=Cd;we.b=xb;we.c=kc;we.d=K;we.e=Da;we.f=Nc;we.g=md;we.h=Td;ni.b().ih(36,we)}VLe(){if(Gi.BrowserFeedbackControlOCV.hKf())m.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.eZf);return}catch(K){m.ULS.sendTraceTag(537170432,1302,15,"Failed to use createScreenshot "+(K?K.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,
null)().then(this.eZf)}catch(K){m.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(K?K.toString():null))}}}lFc(K,Da,xb,kc,Nc,md){Da=void 0===Da?null:Da;xb=void 0===xb?!1:xb;kc=void 0===kc?null:kc;Nc=void 0===Nc?null:Nc;md=void 0===md?!0:md;var Cd=K.SolutionId,Td=od.Task.Wa(!1);K&&Cd&&K.SharedRuntimeId&&(kc=kc||new Uh.a(-859308420,0,2,0,""),Cd={},Cd.solutionId=K.SolutionId,Cd.version=K.Version,Cd.storeType=K.StoreType,Cd.storeId=K.StoreId,Cd.assetId=K.AssetId,Cd.assetStoreId=K.AssetStoreId,
Cd.height=K.Height,Cd.targetType=K.TargetType,Cd.width=0,Cd.isAddinCommands=!1,Cd.sharedRuntimeId=K.SharedRuntimeId,K.Preload=md,Nc=Nc?Nc:new fd.a,Nc.width=0,Da&&(md=Da,Nc.focusOnIframeWhenLoaded=md.focusOnIframeWhenLoaded,Td=new Mh,md.Cm&&(Td.oKc=md.Cm),0<md.taskPaneWidth&&(Td.rB=md.taskPaneWidth),md.BO&&(Td.mKc=md.BO),k.EwaSettings.isChangeGateEnabled("OfficeVSO:7644290_MsFormsCorrelationId")&&md.XA&&(this.ysa[K.SolutionId]=Da.XA),this.smd[K.SolutionId]=Td,this.IZd[K.SolutionId]=Da.onExtensionLaunchCallback),
Da={},Da[Qe.a.Th]=K,Da[Cf.a.jla]=Cd,Da[fd.a.key]=Nc,Da[nh.a.Eia]=xb,Td=this.insertAgave(Da,kc));return Td}mCa(K,Da,xb,kc,Nc,md){md=void 0===md?null:md;if(K&&xb){K=new Nj.a(K,OSF.StoreType.Sdx,OSF.StoreType.Sdx,Nc);Nc=new kj.a("ExcelOnline","Web",this.$.xa.UICultureTag);const Cd=new wj.a;Cd.optionalProperties[Cg.a.x3c]=kc;md&&(kc=md,kc.sourceLocationOverrideResourceId&&(Cd.optionalProperties[Cg.a.sourceLocationOverrideResourceId]=kc.sourceLocationOverrideResourceId),kc.Cm&&(Cd.optionalProperties[Cg.a.Cm]=
kc.Cm),kc.Bn&&(Cd.optionalProperties.IconCssClass=kc.Bn),kc.m7d&&(Cd.optionalProperties.TaskPaneIconUrl=kc.m7d),kc.BO&&(Cd.optionalProperties.TaskPaneIconId=kc.BO),kc.onExtensionLaunchCallback&&(Cd.optionalProperties[Cg.a.onExtensionLaunchCallback]=kc.onExtensionLaunchCallback));Ei.a.instance.mCa(K,Da,xb,Nc,Cd)}}Lci(K){if(!ri.a.ij(K)){var Da=K[Hi.a.wBb];if(Da&&(Da=Da.getId(),K=K[Hi.a.Xga],Da&&K))return this.qPa(Da,K.optionalProperties[Cg.a.sourceLocationOverrideResourceId])}return null}qPa(K,Da){Da=
void 0===Da?null:Da;return K&&Da?`${K}.${Da}`:K}I4h(K){switch(K){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:case 2086613372:return k.EwaSettings.Ea(217)?1023:1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;case 301511274:return 1023;default:return 1}}Y8d(){this.$.ea.nh?this.EUd():(this.$.ea.Fl(this.EUd),this.Shb=!0)}kii(){var K=this.$.ga.Da(20);if(!K)return this.Y8d(),"";K=K.joa();if(!K)return this.Y8d(),"";var Da=this.$.va.getItemByName(this.$.ea.isNamedObjectViewMode?
this.$.na.sheetName:this.$.na.name);Da=$d.d(Da);var xb=ud.h(this.$).ha.ra.selectedRanges;const kc=[];for(const md of xb){xb=new mb.a(md,Da);var Nc=K.fQa(xb,Qa.Valid);xb=[];if(Nc)for(const Cd of Nc)(Nc=Cd.table.wD)&&(Nc=Nc.range.toString())&&xb.push(Nc);xb=new wc(md.toString(),xb);kc.push(xb)}return JSON.stringify(kc)}}fc.aPd="IDS";fc.Wmf="FA000000012";fc.fRa="FA000000005";fc.nri="HelloWorld";fc.yfh="FA000000014";fc.omc="Help.GiveFeedback.Url";fc.Blh="Help.ContactSupport.Url";fc.JTh="feedback";fc.uBf=
"FA000000066";fc.gnj="PowerBi.Url";fc.enj="PowerBi.DevUrl";fc.fnj="FA000000054";fc.G_i="FA000000064";fc.Uhj="FA000000075";fc.S8b="AnalyzeDataTaskPane";fc.Vuj="RecommendedChartsTaskPane";fc.llj="PivotTableTaskPane";fc.jWe=350;fc.wof=320;fc.fqj=320;fc.snh="FA000000124";fc.unh="Copilot (Preview)";fc.tnh="CopilotSDXTaskpane";fc.m1g="g_InstallOrigin";Object(f.a)(fc,"AgaveCommandManager",zg.a,[800,801]);class Ec extends u.a{constructor(K){super();this.$=K;this.je()}create(){const K=this.$.ga,Da=F.GetServiceTaskFactory.create(K,
106,this.ka,this.Ta),xb=F.GetServiceTaskFactory.create(K,104,this.ka,this.Ta);jh.TaskExtensions.za(jh.TaskExtensions.Wf([xb,Da],this.ka),()=>{let kc=null;k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&(kc=Yg.a.instance.Qd("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);ji.instance.initialize(Da.result);const Nc=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PreloadRaceCondition6395242",!0)?Object(Bh.a)(this.$.ga,
374,()=>new fc(this.$,Da.result,xb.result,kc,gf.AFrameworkApplication.Dd)):new fc(this.$,Da.result,xb.result,kc,gf.AFrameworkApplication.Dd);K.Qa(206,Nc);this.Ld(K.Da(374)||K.Qa(374,Nc))},this.ka,3);Yg.a.instance.register(sh.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").Ee().Le(()=>new sh.a(this.$.Ww))}static la(K){K.ga.Qa(375,new Ec(K))}}Object(f.a)(Ec,"AgaveCommandManagerFactory",u.a,[]);var td=a(1240),rd=a(772);class Qd{constructor(){this.sje=this.Nie=this.tja=null;this.Epb=0}get displayName(){return this.tja}set displayName(K){this.tja=
K}get email(){return this.Nie}set email(K){this.Nie=K}get federationProvider(){return this.sje}set federationProvider(K){this.sje=K}get identityType(){return this.Epb}set identityType(K){this.Epb=K}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(K){switch(K){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=
this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K,Da){switch(K){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,
0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Da){this.invokePropertySet(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Da){K=this.invokeMethod(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}static Fqh(K){const Da=new Qd;Da.displayName=K.displayName;Da.email=K.email;
switch(K.authority){case td.a.dWf:Da.identityType=1;break;default:Da.identityType=0}Da.federationProvider="";return Da}}Object(f.a)(Qd,"OfficeIdentityInfo",null,[]);class Mc{static get O0e(){return Mc.HIg}static ykc(K){return K in Mc.O0e?Mc.O0e[K].toString():K}}Mc.HIg={["GeneralException"]:rd.a.generalException,["AccessDenied"]:rd.a.t3c,["ApiNotAvailable"]:rd.a.apiNotAvailable,["UserNotSignedIn"]:rd.a.userNotSignedIn,["UserAborted"]:rd.a.userAborted,["UnsupportedUserIdentity"]:rd.a.lgk,["InvalidResourceUrl"]:rd.a.invalidResourceUrl,
["InvalidGrant"]:rd.a.invalidGrant,["AddinIsAlreadyRequestingToken"]:rd.a.o1g,["ResourceNotAllowed"]:rd.a.jHj,["ClientError"]:rd.a.clientError,["ServerError"]:rd.a.serverError};Mc.map=null;Object(f.a)(Mc,"SingleSignOnErrorCodeMap",null,[]);class Hd{constructor(K,Da){this.AZb=K;this.Epb=Da}get accessToken(){return this.AZb}set accessToken(K){this.AZb=K}get tokenIdenityType(){return this.Epb}set tokenIdenityType(K){this.Epb=K}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(K){switch(K){case 2:return this.accessToken;
case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K,Da){switch(K){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertySetAsync(K,Da){this.invokePropertySet(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Da){K=this.invokeMethod(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}}Object(f.a)(Hd,"SingleSignOnToken",null,[]);class xe{constructor(){this.afe=null;this.sue=this.q4b=this.QG="";this.Fve=!0;this.options=null}get authChallenge(){return this.afe}set authChallenge(K){this.afe=
K}get correlationId(){return this.QG}set correlationId(K){this.QG=K}get policy(){return null}set policy(K){}get resource(){return this.q4b}set resource(K){this.q4b=K}get scope(){return this.sue}set scope(K){this.sue=K}get silentLogin(){return this.Fve}set silentLogin(K){this.Fve=K}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(K){switch(K){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;
case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K,Da){switch(K){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,
0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Da){this.invokePropertySet(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokeMethodAsync(K,Da){K=this.invokeMethod(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}}Object(f.a)(xe,"TokenParameters",null,[312]);class ee{constructor(K,Da){this.Znb=Da;this.Jw=K}get roamingSettings(){return null}getAccessToken(K){const Da=this.Znb.getOsfControl(this.Jw),xb=Da.getManifest(),kc=xb.getMarketplaceID();this.wTa(K,kc);return OfficeExtension.WacRuntime.Utility.createPromise((Nc,md)=>{Da.isFirstParty()&&this.Znb._enableFirstPartySSO?this.oBi(xb,K)?Yg.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(K,
kc).then(Cd=>{Nc(Cd)},Cd=>{md(Cd)}):md(rd.a.t3c):md(rd.a.apiNotAvailable)}).then(Nc=>{let md;switch(Nc.authority){case td.a.dWf:md=1;break;default:md=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Hd(Nc.accessToken,md))},Nc=>{this.logErrorResponse(K,kc,Nc);return Nc?OfficeExtension.WacRuntime.Utility.createPromise((md,Cd)=>{Cd(OfficeExtension.WacRuntime.Utility.createRichApiException(Nc,Mc.ykc(Nc)))}):OfficeExtension.WacRuntime.Utility.createPromise((md,Cd)=>{Cd(OfficeExtension.WacRuntime.Utility.createRichApiException(rd.a.generalException,
Mc.ykc(rd.a.generalException)))})})}getAuthContext(){return null}getPrimaryIdentityInfo(){const K=this.Znb.getOsfControl(this.Jw);K.getManifest();const Da=K.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise((xb,kc)=>{Yg.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(Da).then(Nc=>{xb(Nc)},Nc=>{kc(Nc.toString())})}).then(xb=>{xb=Qd.Fqh(xb);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(xb)},xb=>xb?OfficeExtension.WacRuntime.Utility.createPromise((kc,
Nc)=>{Nc(OfficeExtension.WacRuntime.Utility.createRichApiException(xb,Mc.ykc(xb)))}):OfficeExtension.WacRuntime.Utility.createPromise((kc,Nc)=>{Nc(OfficeExtension.WacRuntime.Utility.createRichApiException(rd.a.generalException,Mc.ykc(rd.a.generalException)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(K){switch(K){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Da){this.invokePropertySet(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Da){switch(K){case 1:return this.$0h(Da);case 3:return this.r2h();case 2:return this.Sdi()}K=this.invokeMethod(K,
Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}$0h(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,xe);return this.getAccessToken(K)}r2h(){return this.getAuthContext()}Sdi(){return this.getPrimaryIdentityInfo()}oBi(K,Da){let xb=!1;const kc=K.getWebApplicationAuthorizations();K=null;for(const Nc of kc)if(Nc.getResource().toLowerCase()===Da.resource.toLowerCase()){K=Nc;xb=!0;break}if(!xb)return!1;Da=Da.scope.split(" ,+");for(const Nc of Da)if(Nc&&Nc.length){Da=
!1;for(const md of K.getScopes())Nc.toLowerCase()===md.toLowerCase()&&(Da=!0);if(!Da)return!1}return!0}wTa(K,Da){K=this.$Jf(K.resource);m.ULS.sendTraceTag(538572831,369,50,"{0}",{["manifestId"]:Da,["resource"]:K})}logErrorResponse(K,Da,xb){K=this.$Jf(K.resource);m.ULS.sendTraceTag(538572830,369,10,"{0}",{["manifestId"]:Da,["resource"]:K,["error"]:xb})}$Jf(K){return K.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(f.a)(ee,"AuthenticationService",null,[]);class ve{create(K,
Da){return new ee(K,Da)}}Object(f.a)(ve,"AuthenticationServiceFactory",null,[]);var af=a(903);class wf{constructor(){this.context=null;this.errorCode=0}}Object(f.a)(wf,"NestedAppAuthContextResult",null,[]);class Hf{static prd(K,Da){const xb=new wf;(K=K.getOsfControl(Da))&&K.isFirstParty()?(xb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,K={},Da=gf.AFrameworkApplication.da.Sa("AADUserObjectId"),K.userObjectId=Da?Da:gf.AFrameworkApplication.da.Sa("HostUserId"),K.userPrincipalName=gf.AFrameworkApplication.da.Sa("UserPrincipalName"),
K.tenantId=gf.AFrameworkApplication.da.Sa("TenantId"),Da=(gf.AFrameworkApplication.da.Sa("HostAuthType")||"").toLowerCase(),K.authorityType="aad"===Da?"aad":"msa"===Da?"msa":"other",xb.context=K):xb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeAccessDenied;return xb}}Object(f.a)(Hf,"NestedAppAuthUtil",null,[]);var ig=a(1026),Bf=a(1005);class Uf{}Uf.generalException="generalException";Uf.invalidArgument="invalidArgument";Uf.notAllowed="notAllowed";Uf.apiNotAvailable="apiNotAvailable";Uf.unresolvedPendingRequest=
"unresolvedPendingRequest";Uf.timeout="timeout";Uf.adalTimeout="adalTimeout";Uf.userNotSignedIn="userNotSignedIn";Uf.userAborted="userAborted";Uf.silentSignInFailed="silentSignInFailed";Uf.invalidResourceUrl="invalidResourceUrl";Uf.invalidGrant="invalidGrant";Uf.connectionLost="connectionLost";Uf.clientError="clientError";Uf.serverError="serverError";Object(f.a)(Uf,"WopiHostErrorCodes",null,[]);var Xf=a(429);class Lg{}Object(f.a)(Lg,"OAuthCallerMetadata",null,[]);var Ng=a(32);class mh{constructor(K){this.ACa=
K;this.yIg=gf.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}ATg(K,Da,xb,kc,Nc,md){if(!this.ACa)return kc=new ig.a,kc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(kc);const Cd=new Lg;Cd.AddinName=Nc;Cd.AddinTrustId=md;let Td=-1;md=null;if(kc&&this.Huf())md=this.ACa.Gsg(Cf.a.GKc,K,kc,mh.vgf(Nc),Cd);else{const we=Date.now();md=this.ACa.$C(Cf.a.GKc,K,Cd).then(Fe=>{Td=Date.now()-we;const vf=(Da||xb)&&"login_required"===
Fe.ErrorCode;return(Da&&("interaction_required"===Fe.ErrorCode||"consent_required"===Fe.ErrorCode||"invalid_grant"===Fe.ErrorCode)||vf)&&this.Huf()?this.ACa.Gsg(Cf.a.GKc,K,null,mh.vgf(Nc),Cd):Promise.resolve(Fe)})}return md.then(we=>{const Fe=new ig.a;we.IsSuccess?(Fe.token=we.Token,we.Telemetry&&(Fe.tZa=we.Telemetry.fromCache,Fe.expiresOn=we.Telemetry.expiresOn)):(Fe.errorCode=this.sWi(we),Fe.s7d=this.ljj(we));return Fe}).catch(()=>{const we=new ig.a;we.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;
return Promise.resolve(we)}).then(we=>{we.xla="OauthManager";0<=Td&&(we.EEb=Td);return we})}UDi(K){const Da=(gf.AFrameworkApplication.da.Sa(gf.AFrameworkApplication.xba)||"").toLowerCase();return(Ng.a.VBa||"teams"===Da&&Xf.OAuthManagerSettings.UFb)&&!mh.yDi(K)||!this.ACa||!this.ACa.Zab()?!1:!0}Huf(){return this.yIg||1!==Bf.a.Kjc()}sWi(K){switch(K.ErrorCode){case "UserCancelled":case "interaction_required":K=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":K=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":K=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":K=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":K=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":K=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:K=K.ErrorCode===Uf.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:
K.ErrorCode===Uf.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:K.ErrorCode===Uf.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:K.ErrorCode===Uf.invalidGrant?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:K.ErrorCode===Uf.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return K}ljj(K){let Da="";(K=RegExp("AADSTS(\\d+)").exec(K.ErrorMessage))&&1<K.length&&
(Da=K[1]);return Da}static vgf(K){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,K)}static yDi(K){if(!K)return!1;K=K.toLowerCase();for(const Da of af.AppsForOfficeSingleSignOnManager.U7e)if(Da===K)return!0;return!1}}Object(f.a)(mh,"AppsforOfficeTokenFromOauthManager",null,[862]);class Gh{constructor(K){this.xVi=K}static Ata(){if(gf.AFrameworkApplication.da.pa("AppForOfficeSSOV2IsEnabled")){var K=null;try{K=Yg.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(Da){m.ULS.sendTraceTag(592061330,
1300,10,"Unable to resolve IOAuthManager: "+Da)}K=new mh(K);Gh.La=new Gh(K)}}static getInstance(){Gh.sle||(Gh.Ata(),Gh.sle=!0);return Gh.La}}Gh.La=null;Gh.sle=!1;Object(f.a)(Gh,"AppsForOfficeOauthManagerFactory",null,[850]);var Vh=a(1239),bi=a(152);class Zh{constructor(K,Da,xb,kc){this.menuItemId=K;this.BG=Da;this.r6j=xb;this.pUh=kc}}Object(f.a)(Zh,"NewDocumentParameters",null,[]);const Ii=K=>{var Da=K.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",
3,0);var xb=Da.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);xb.addParameter("shortcuts","String[]",1,null,0);Da.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);xb=Da.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);xb.addParameter("shortcuts","Object",1,null,0);Da=K.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);xb=Da.addMethod("GetSharedFilePickerResponse",1,"Object",
1,1,"SharedFilePickerResponse",0);xb.addParameter("pickerCustomizationJsonString","String",1,null,0);Da=K.addType("Microsoft.Office.Auth","{8f3d8395-fba3-422f-9e98-33e38d23c2ba}","{e1b105a8-d9d5-4fc8-aa4e-3d90aeb48abf}",3,2);xb=Da.addMethod("GetAccessTokenFirstPartyOAuth",1,"Object",1,1,"AccessTokenFirstPartyOAuth",4);xb.addParameter("appName","String",1,null,0);xb.addParameter("target","String",1,null,0);Da=K.addType("Microsoft.Office.AugLoopHostMessageReceivedEventArgs","{52ebe40e-6476-4f8d-81cb-89f5c90e2e76}",
"{891f2f5b-6598-4c8e-af9d-dc48bf34839f}",2,0);Da.addProperty("Data",4,"String",1,!1,null,0);Da=K.addType("Microsoft.Office.AugLoopEventService","{846cb932-2065-4d2e-b051-5d6673cca2d9}","{019765ca-6d77-447a-9bd8-b07dc47bc657}",3,2);xb=Da.addMethod("SendMessage",1,"Void",0,1,"SendMessage",4);xb.addParameter("data","String",1,null,0);Da.addMethod("_RegisterHostMessageReceivedEvent",2,"Void",0,1,"_RegisterHostMessageReceivedEvent",4);Da.addMethod("_UnregisterHostMessageReceivedEvent",3,"Void",0,1,"_UnregisterHostMessageReceivedEvent",
4);Da=K.addType("Microsoft.Office.CopilotOperationStartedEventArgs","{45400499-b374-4bc9-a709-18989d9cebd1}","{a7c458d5-f043-4d71-b091-03160b2c450e}",2,0);Da.addProperty("BatchId",6,"String",1,!1,null,0);Da=K.addType("Microsoft.Office.UndoService","{69f39738-6c6b-4497-9833-02728cf72dc3}","{9628bdd5-9267-4ca8-8162-82d0a7e484f8}",3,2);xb=Da.addMethod("EndCopilotOperation",5,"Void",0,0,"EndCopilotOperation",4);xb.addParameter("batchId","String",1,null,0);xb=Da.addMethod("StartCopilotOperation",4,"Boolean",
1,0,"StartCopilotOperation",4);xb.addParameter("batchId","String",1,null,0);Da.addMethod("Undo",1,"Boolean",1,0,"Undo",4);Da.addMethod("_RegisterUndoStackChangedEvent",2,"Void",0,1,"_RegisterUndoStackChangedEvent",4);Da.addMethod("_UnregisterUndoStackChangedEvent",3,"Void",0,1,"_UnregisterUndoStackChangedEvent",4);Da=K.addEnumType("Microsoft.Office.UserFeedbackType");Da.addEnumField("Like",0);Da.addEnumField("Dislike",1);Da.addEnumField("Idea",2);Da.addEnumField("Unclassified",3);Da=K.addEnumType("Microsoft.Office.UserFeedbackUIType");
Da.addEnumField("ModalDialog",0);Da.addEnumField("Taskpane",1);Da=K.addType("Microsoft.Office.UserFeedbackService","{92a3da31-eaf9-4225-b909-6c696483a7fb}","{c6f22ae8-52fa-45d5-a1bf-6b7b67f60f8b}",3,2);xb=Da.addMethod("CollectUserFeedback",1,"Void",0,1,"CollectUserFeedback",4);xb.addParameter("feedbacktype","Microsoft.Office.UserFeedbackType",1,null,0);xb.addParameter("UIType","Microsoft.Office.UserFeedbackUIType",1,null,0);xb.addParameter("featureArea","String",1,null,0);xb.addParameter("options",
"Object",1,null,0);Da.addMethod("_RegisterUserFeedbackUIDismissedEvent",18,"Void",0,1,"_RegisterUserFeedbackUIDismissedEvent",4);Da.addMethod("_UnregisterUserFeedbackUIDismissedEvent",19,"Void",0,1,"_UnregisterUserFeedbackUIDismissedEvent",4);Da=K.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);xb=Da.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);xb.addParameter("base64File","String",1,null,0);Da=K.addType("Microsoft.ExcelServices.AppRuntimeService",
"{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);Da.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);xb=Da.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);xb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Da=K.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);Da.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",
2,!0,null,0);xb=Da.addMethod("Register",1,"Void",0,0,"Register",0);xb.addParameter("metadata","String",1,null,0);xb.addParameter("javascript","String",1,null,0);Da=K.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);Da.addProperty("Enabled",1,"Boolean",1,!1,null,0);Da.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);Da.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);Da=K.addEnumType("Microsoft.Authentication.IdentityType");Da.addEnumField("OrganizationAccount",
0);Da.addEnumField("MicrosoftAccount",1);Da=K.addEnumType("Microsoft.Authentication.AuthorityType");Da.addEnumField("External",0);Da.addEnumField("Msa",1);Da.addEnumField("Aad",2);Da=K.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);Da.addProperty("DisplayName",4,"String",1,!1,null,0);Da.addProperty("Email",3,"String",1,!1,null,0);Da.addProperty("FederationProvider",2,"String",1,!1,null,0);Da.addProperty("IdentityType",
1,"Microsoft.Authentication.IdentityType",1,!1,null,0);Da=K.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);Da.addProperty("AppId",4,"String",1,!1,null,0);Da.addProperty("Authority",2,"String",1,!1,null,0);Da.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);Da.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);Da.addProperty("TenantId",6,"String",1,!1,null,0);Da.addProperty("Upn",
1,"String",1,!1,null,0);Da=K.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);Da.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);xb=Da.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);xb.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);Da.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",
2,1,"AuthContext",0);Da.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);Da=K.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);Da.addProperty("AuthChallenge",3,"String",1,!1,null,0);Da.addProperty("CorrelationId",7,"String",1,!1,null,0);Da.addProperty("Policy",4,"String",1,!1,null,0);Da.addProperty("Resource",2,"String",1,!1,null,0);Da.addProperty("Scope",
5,"String",1,!1,null,0);Da.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);Da=K.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);Da.addProperty("AccessToken",2,"String",1,!1,null,0);Da.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);Da=K.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);Da.addProperty("Id",1,"String",1,
!0,null,0);Da.addProperty("Value",2,"Object",1,!1,null,0);Da=K.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);xb=Da.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);xb.addParameter("id","String",1,null,0);xb=Da.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);xb.addParameter("id","String",1,null,0);Da=K.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}",
"{43a4559c-806b-4e89-914e-da9256212148}",3,0);Da.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);xb=Da.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);xb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Da=K.addEnumType("Microsoft.AppRuntime.AppRuntimeState");Da.addEnumField("Inactive",0);Da.addEnumField("Background",1);Da.addEnumField("Visible",2);Da=K.addEnumType("Microsoft.AppRuntime.Visibility");
Da.addEnumField("Hidden",1);Da.addEnumField("Visible",2);Da=K.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);Da.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);xb=Da.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);xb.addParameter("jsonCreate","String",1,null,0);xb=Da.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);xb.addParameter("jsonUpdate",
"String",1,null,0);xb=Da.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);xb.addParameter("id","String",1,null,0);xb=Da.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);xb.addParameter("id","String",1,null,0);Da.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Da=K.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);Da.addProperty("Id",2,"String",1,!0,null,0);xb=Da.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",
0);xb.addParameter("visibility","Boolean",1,null,0);Da.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Da=K.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);Da.addProperty("Enabled",3,"Boolean",1,!1,null,0);Da.addProperty("Id",2,"String",1,!0,null,0);Da.addProperty("Label",4,"String",1,!0,null,0);xb=Da.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);xb.addParameter("enabled","Boolean",1,null,0);Da.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",
0);Da=K.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);Da.addMethod("GetCount",3,"Int32",1,1,"Count",0);xb=Da.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);xb.addParameter("key","String",1,null,0);Da.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Da.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);Da=K.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");Da.addEnumField("Unknown",0);Da.addEnumField("Basic",
1);Da.addEnumField("Premium",2);Da=K.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);xb=Da.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);xb.addParameter("feature","String",1,null,0);xb.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);xb=Da.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",
0);xb.addParameter("feature","String",1,null,0);xb=Da.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);xb.addParameter("feature","String",1,null,0);xb.addParameter("fallbackValue","Boolean",1,null,0);Da.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);xb=Da.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);xb.addParameter("experienceId","String",1,null,0);xb=Da.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",
4);xb.addParameter("feature","String",1,null,0);Da=K.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);Da.addProperty("Id",5,"String",1,!0,null,0);Da.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);Da.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);Da=K.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);
Da.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);Da=K.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification","{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);Da.addMethod("Disable",3,"Void",0,1,"Disable",0);Da.addMethod("Enable",2,"Void",0,1,"Enable",0);Da.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)};var $h=a(186);class Di{constructor(K,Da){this.PMg=K;this.jNg=Da}createAndOpenWorkbook(K){if(K&&
K.length>this.PMg)throw m.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",K.length),OfficeExtension.WacRuntime.Utility.createRichApiException(rd.a.invalidArgument,$h.a.ia(1769));const Da=new Zh("blank","agave",K?"streamBase64":"streamEmpty",K);let xb=null;return OfficeExtension.WacRuntime.Utility.createPromise((kc,Nc)=>{const md=new bi.StandardDialog;md.Rd=4;md.Nm(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,Cd=>{2===Cd||0===Cd?Nc("Cancelled"):
(xb=window.open(""),this.jNg.create(kc,Nc,Da).O6a())})}).then(kc=>{if(!kc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(rd.a.generalException,$h.a.ia(1765));try{xb.top.location.href=kc}catch(Nc){m.ULS.sendTraceTag(538572820,0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",Ng.a.Sp,Nc),m.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),
xb.location.replace(kc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},kc=>{if("Cancelled"===kc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(rd.a.dPd,$h.a.ia(1768));xb.close();this.F9j();return null})}getTypeName(){return"Microsoft.ExcelServices.WacWorkbook"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertySetAsync(K,Da){this.invokePropertySet(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Da){switch(K){case 1:return this.qoh(Da)}K=this.invokeMethod(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}qoh(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");return this.createAndOpenWorkbook(K)}F9j(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(rd.a.generalException,
$h.a.ia(1765));}}Object(f.a)(Di,"WacWorkbook",null,[]);const Fg=(K,Da)=>{console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof K+", objectId="+K+", value="+Da);return null},mg=K=>{K.add("InternalTest","PreviewExecutionMethod",Fg)};var rg=a(263),Nf=a(770),Kg=a(771);class sg{constructor(K){this.vd=K}get $(){return this.vd}}Object(f.a)(sg,"RichApiPreviewExecutionContext",null,[]);var Pg=a(26),Fh=a(1028),ci=a(218),Si=a(222),zi=a(134),Fi=a(12);class li extends Si.a{constructor(K,
Da,xb,kc,Nc){super(K,"Select Data");this.$vb=null;this.BVe=Da;this.kgd=xb;this.Zd=Nc;this.callback=kc}get we(){return"DdaBindingPrompt"}start(K,Da){let xb="<div class='"+zi.a.bJh+" "+xh.a.Uy+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+zi.a.fN+"' /></div>";xb=String.format(xb,Le.a.nm(this.kgd.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.Zd.Tj(this.fe,xb);this.$vb=Fi.DOMElementExtensions.getElementById(this.fe,"bindingText");
K=Da?K.S8a(Da,this.kgd.DdaBindingsMethod.BindingId):null;(null===K||void 0===K?0:K.IsValidRef)?(Da=new Pg.Range(K.Reference.FirstRow+1,K.Reference.FirstColumn+1,K.Reference.LastRow+1,K.Reference.LastColumn+1,!1,!1),this.$vb.value=K.Reference.SheetName+"!"+Da):(K=ud.h(this.$).ha,this.$vb.value=$d.f(this.$.na)||!K.ra.Ij?"":K.Gma);this.initialize();this.Ji()}Is(){this.Had();this.addButton(0);this.addButton(1);super.Is()}setFocus(){Fi.DOMElementExtensions.setFocus(this.$vb)}validate(){return!0}commit(){let K=
this.$vb.value.trim();const Da=K.indexOf("!");-1!==Da&&(K=this.$gi(K.substring(0,Da))+K.substr(Da));this.BVe.addBinding(this.kgd,K,0,this.callback);return!0}C5a(){this.BVe.HT.Aj(Nf.a.internalError,this.callback);super.C5a()}$gi(K){K=pi.a.trimStart(K.trim(),"=");return K.length?K.startsWith("'")&&K.endsWith("'")?K:mc.HelperMethods.Jgc(K):""}}Object(f.a)(li,"DdaBindingPrompt",Si.a,[]);class gi{constructor(K){this.ea=K}Aj(K,Da){if(Da){const xb={};xb.Error=K;xb.Version=this.ea.xg;Da(xb)}}pPa(K,Da){this.Aj(K,
Da)}uK(K,Da){this.Aj(Nf.a.E9e(K.Errors[0].MessageId),Da)}Yx(K){K&&K(this.NP())}NP(){const K={Error:0};K.Version=this.ea.xg;return K}}Object(f.a)(gi,"DdaErrorGenerator",null,[]);var Hg=a(248);class yg{constructor(K,Da,xb){this.$=K;this.HT=Da;this.dD=xb}$Jd(K,Da){const xb=K.DdaGoToByIdMethod.GoToType,kc=K.DdaGoToByIdMethod.SelectionMode,Nc=K.DdaGoToByIdMethod.Id.toString().trim(),md=Cd=>{const Td=this.$.va.getItemByName(Cd.SheetName);(null===Td||void 0===Td?0:Td.visible)?(ud.h(this.$).Bj(Cd,null,null,
null,3,"DdaNavigator.NavigateTo",void 0,void 0,void 0,void 0,!0),this.HT.Yx(Da)):this.HT.Aj(Nf.a.ceh,Da)};0===xb?this.v_i(Nc,kc,K.DdaMethod.ControlId,md,Da):1===xb?this.z_i(Nc,kc,md,Da):this.HT.Aj(Nf.a.igk,Da)}v_i(K,Da,xb,kc,Nc){this.dD.ddaGetBinding(xb,K,md=>{if(!Hg.a(md)&&md.Result&&md.Result.Reference){md=md.Result;var Cd={};Cd.SheetName=md.Reference.SheetName;Cd.FirstRow=md.Reference.FirstRow;Cd.FirstColumn=md.Reference.FirstColumn;Cd.LastRow=md.Reference.LastRow;Cd.LastColumn=md.Reference.LastColumn;
yg.s6c(Cd,Da);1!==md.BindingType?kc(Cd):this.dD.ddaGetBindingData(xb,K,1,0,2,0,0,-1,-1,Td=>{Hg.a(Td)||!Td.Result?this.HT.uK(Td,Nc):(Td=Td.Result,2!==Da&&(Cd.FirstRow-=Td.Headers.length,0>Cd.FirstRow&&(Cd.FirstRow=0)),kc(Cd))},Nc)}else this.HT.pPa(Nf.a.Bmg,Nc)},Nc)}z_i(K,Da,xb,kc){var Nc=Re.A(K);Nc?(Nc=Re.v(Nc,this.$),yg.s6c(Nc,Da),xb(Nc)):this.$.ea.isNamedObjectViewMode&&this.$.Ud.zm(K)?this.$.Ud.psa(this.$.Ud.getItemByName(K),"dda"):(Nc=md=>{Hg.a(md)||!md.Result?this.$.va.contains(K)?(md={},md.SheetName=
K,md.FirstRow=0,md.FirstColumn=0,md.LastRow=0,md.LastColumn=0,xb(md)):this.HT.pPa(Nf.a.Bmg,kc):(md=md.Result,yg.s6c(md,Da),xb(md))},this.$.va.na?this.dD.parseRangeForGoto(K,this.$.va.na.name,Nc,kc):this.dD.parseRange(K,Nc,kc))}static s6c(K,Da){K.LastRow=2===Da?K.FirstRow:K.LastRow;K.LastColumn=2===Da?K.FirstColumn:K.LastColumn}}Object(f.a)(yg,"DdaNavigator",null,[]);const hi=(K,Da,xb,kc,Nc,md)=>{const Cd=K.Pa(1);Cd.request=Da;return Jc.g(K,"ExecuteRichApiRequest",Cd,xb,kc,Nc,md,0)};var oh=a(308),
Wh;(function(K){K[K.unsupported=0]="unsupported";K[K.surface=1]="surface";K[K.combo=2]="combo";K[K.column=3]="column";K[K.column3D=4]="column3D";K[K.bar=5]="bar";K[K.bar3D=6]="bar3D";K[K.line=7]="line";K[K.line3D=8]="line3D";K[K.pie=9]="pie";K[K.pie3D=10]="pie3D";K[K.scatter=11]="scatter";K[K.bubble=12]="bubble";K[K.area=13]="area";K[K.area3D=14]="area3D";K[K.doughnut=15]="doughnut";K[K.radar=16]="radar";K[K.stock=17]="stock";K[K.waterfall=18]="waterfall";K[K.funnel=19]="funnel";K[K.treemap=20]="treemap";
K[K.sunburst=21]="sunburst";K[K.boxWhisker=22]="boxWhisker";K[K.histogram=23]="histogram";K[K.pareto=24]="pareto";K[K.regionMap=25]="regionMap";K[K.noVisibleSeries=26]="noVisibleSeries";K[K.complexDataSource=27]="complexDataSource";K[K.pivotChart=28]="pivotChart"})(Wh||(Wh={}));Object(f.b)("ChartCategory",Wh);class Hh{constructor(K,Da){this.source=K;this.eventId=Da}}Object(f.a)(Hh,"MacroRecorderEventData",null,[]);class Oh{constructor(K,Da,xb){this.parentName=K;this.$=Da;this.request=xb}rfi(K){var Da;
if(void 0===K||null===K||void 0===K.RequestBody||null===K.RequestBody)return null;const xb=JSON.parse(K.RequestBody);if(void 0!==K.ActiveFloatingObjectId&&null!==K.ActiveFloatingObjectId){xb.ActiveFloatingObjectId=K.ActiveFloatingObjectId;const kc=ud.h(this.$).ha.Va.pe;if(null===(Da=null===kc||void 0===kc?void 0:kc.floatingObject)||void 0===Da?0:Da.df)xb.ActiveChartType=Wh[kc.floatingObject.df.ChartCategory]}void 0!==K.SheetMultiRange&&null!==K.SheetMultiRange&&(xb.SheetName=K.SheetMultiRange.SheetName);
return xb}Cfi(K){if(void 0===K||null===K||void 0===K.Result||null===K.Result)return null;K=K.Result;return void 0===K.ResponseBody||null===K.ResponseBody||K.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(K.ResponseBody.join(""))}NIi(K){return!!K&&!(void 0===K.eventId||null===K.eventId)&&0<K.eventId.length}im(K){return()=>{if(this.$.A9){const Da=this.dah(this.request);if(this.NIi(Da)){const xb=this.rfi(this.request),kc=this.Cfi(K);if(xb&&!ri.a.isEmpty(xb)&&kc&&!ri.a.isEmpty(kc))return m.ULS.sendTraceTag(537163164,
0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new V(Da,xb,kc);m.ULS.sendTraceTag(537163163,0,50,`[RichApiRecorder]: Failed due to bad data: ${`requestInfo: ${xb?"(not null)":"(null)"}; responseInfo: ${kc?"(not null)":"(null)"}`}`)}}return new V(null,null,null)}}dah(K){const Da=this.OIi(K.SolutionId),xb=Oh.Yei(K);if(xb&&Da)return m.ULS.sendTraceTag(537163162,0,50,`[RichApiRecorder][${this.parentName}]: ${({["recorderEventId"]:xb,["request.SolutionId"]:K.SolutionId})}`),
new Hh(K.SolutionId,xb);K=JSON.stringify({["recorderEventId"]:xb,["isRecorderAwareAddin"]:Da,["request.SolutionId"]:K.SolutionId});m.ULS.sendTraceTag(537163161,0,50,`[RichApiRecorder][${this.parentName}]: ${K}`);return null}OIi(K){if(!K)return!1;K=K.toLowerCase();return Oh.eli().contains(K)}static eli(){Oh.tEa||(Oh.tEa=new M.a(O.a.Fh()),Oh.tEa.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Oh.tEa.add("fa000000005"),Oh.tEa.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),Oh.tEa.add("fa000000014"),Oh.tEa.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));
return Oh.tEa}static Yei(K){let Da=null;var xb=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(xb.test(K.RequestBody))Da=xb.exec(K.RequestBody)[1];else{K=K.RequestHeaders;if(!K)return Da;xb=gb.a.u2i.toLowerCase();for(let kc=0;kc<K.length;kc++)if(K[kc].Name.toLowerCase()===xb){Da=K[kc].Value;break}}return Da}}Oh.tEa=null;Object(f.a)(Oh,"DdaRichApiRequestRecorder",null,[]);class Xi extends oh.a{constructor(K,Da,xb,kc,Nc,md,Cd,Td){super(10,0,Da,Td);this.Qsb=xb;this.Wob=
kc;this.N7=Nc;this.vKa=md;this.request=Cd;this.JYd=new Oh("10",K,Cd)}get gNc(){return this.vKa}get cJ(){return this.Qsb}get jna(){return this.Wob}X6(K){return super.X6(K)||this.$ch(K)}im(){return this.JYd.im(this.Cf)}nlb(){const K={OperationType:3};K.RichApiRequest=this.request;return K}$ch(K){return(Da,xb,kc)=>hi(K,this.request,Vf.b(Da,this.Qsb),Vf.a(xb,this.Wob),kc,this.N7)}}Object(f.a)(Xi,"DdaRichApiRequestBatchOperation",oh.a,[]);class mj extends xf.a{constructor(K,Da,xb,kc){super(576,0,xb,kc);
this.JYd=new Oh("576",K,Da)}im(){return this.JYd.im(this.Cf)}}Object(f.a)(mj,"DdaRichApiRequestOperation",xf.a,[]);class rk{constructor(K,Da){this.rL=(xb,kc)=>{this.HT.pPa(Nf.a.internalError,kc)};this.$=K;this.HT=Da}ddaAddBinding(K,Da,xb,kc,Nc,md,Cd){this.gN((Td,we,Fe)=>{var vf=this.$.qa.ua,Jf=this.Qna();Td=Vf.b(Td,md);we=Vf.a(we,this.rL);const lg=vf.Pa(9);lg.controlId=K;lg.bindingId=Da;lg.bindingType=xb;lg.currentSheetName=Jf;lg.formula=kc;lg.options=Nc;return Jc.g(vf,"DdaAddBinding",lg,Td,we,Fe,
Cd,0)},Cd,563)}ddaReleaseBinding(K,Da,xb,kc){this.gN((Nc,md,Cd)=>{var Td=this.$.qa.ua;Nc=Vf.b(Nc,xb);md=Vf.a(md,this.rL);const we=Td.Pa(9);we.controlId=K;we.bindingId=Da;return Jc.g(Td,"DdaReleaseBinding",we,Nc,md,Cd,kc,0)},kc,564)}ddaGetBinding(K,Da,xb,kc){this.gN((Nc,md,Cd)=>{var Td=this.$.qa.ua;Nc=Vf.b(Nc,xb);md=Vf.a(md,this.rL);const we=Td.Pa(1);we.controlId=K;we.bindingId=Da;return Jc.g(Td,"DdaGetBinding",we,Nc,md,Cd,kc,0)},kc,565,16)}ddaGetAllBindings(K,Da,xb){this.gN((kc,Nc,md)=>{var Cd=this.$.qa.ua;
kc=Vf.b(kc,Da);Nc=Vf.a(Nc,this.rL);const Td=Cd.Pa(1);Td.controlId=K;return Jc.g(Cd,"DdaGetAllBindings",Td,kc,Nc,md,xb,0)},xb,566,16)}ddaGetBindingData(K,Da,xb,kc,Nc,md,Cd,Td,we,Fe,vf){this.gN((Jf,lg,ph)=>{var eh=this.$.qa.ua,$g=this.Qna();Jf=Vf.b(Jf,Fe);lg=Vf.a(lg,this.rL);const Ug=eh.Pa(1);Ug.controlId=K;Ug.bindingId=Da;Ug.coerceType=xb;Ug.valueFormat=kc;Ug.filterType=Nc;Ug.startRow=md;Ug.startCol=Cd;Ug.rowCount=Td;Ug.colCount=we;Ug.currentSheetName=$g;return Jc.g(eh,"DdaGetBindingData",Ug,Jf,lg,
ph,vf,0)},vf,567,16)}ddaSetBindingData(K,Da,xb,kc,Nc,md,Cd){this.gN((Td,we,Fe)=>{var vf=this.$.qa.ua,Jf=this.Qna();Td=Vf.b(Td,md);we=Vf.a(we,this.rL);const lg=vf.Pa(9);lg.controlId=K;lg.bindingId=Da;lg.startRow=xb;lg.startCol=kc;lg.currentSheetName=Jf;lg.bindingData=Nc;return Jc.g(vf,"DdaSetBindingData",lg,Td,we,Fe,Cd,0)},Cd,568)}ddaGetSelectedData(K,Da,xb,kc,Nc,md,Cd){this.gN((Td,we,Fe)=>{var vf=this.$.qa.ua,Jf=this.Qna();Td=Vf.b(Td,md);we=Vf.a(we,this.rL);const lg=vf.Pa(1);lg.controlId=K;lg.coerceType=
Da;lg.valueFormat=xb;lg.filterType=kc;lg.currentSheetName=Jf;lg.formula=Nc;return Jc.g(vf,"DdaGetSelectedData",lg,Td,we,Fe,Cd,0)},Cd,569,16)}ddaSetSelectedData(K,Da,xb,kc,Nc){this.gN((md,Cd,Td)=>{var we=this.$.qa.ua,Fe=this.Qna();md=Vf.b(md,kc);Cd=Vf.a(Cd,this.rL);const vf=we.Pa(9);vf.controlId=K;vf.currentSheetName=Fe;vf.formula=Da;vf.bindingData=xb;return Jc.g(we,"DdaSetSelectedData",vf,md,Cd,Td,Nc,0)},Nc,570)}ddaLoadSettings(K,Da,xb){this.gN((kc,Nc,md)=>{var Cd=this.$.qa.ua;kc=Vf.b(kc,Da);Nc=Vf.a(Nc,
this.rL);const Td=Cd.Pa(1);Td.controlId=K;return Jc.g(Cd,"DdaLoadSettings",Td,kc,Nc,md,xb,0)},xb,501,16)}ddaSaveSettings(K,Da,xb,kc,Nc){this.gN((md,Cd,Td)=>{var we=this.$.qa.ua;md=Vf.b(md,kc);Cd=Vf.a(Cd,this.rL);const Fe=we.Pa(9);Fe.controlId=K;Fe.settings=Da;Fe.overwriteIfStale=xb;return Jc.g(we,"DdaSaveSettings",Fe,md,Cd,Td,Nc,0)},Nc,571)}ddaAddRowsColumns(K,Da,xb,kc,Nc,md){this.gN((Cd,Td,we)=>{var Fe=this.$.qa.ua,vf=this.Qna();Cd=Vf.b(Cd,Nc);Td=Vf.a(Td,this.rL);const Jf=Fe.Pa(9);Jf.controlId=K;
Jf.bindingId=Da;Jf.isRow=xb;Jf.currentSheetName=vf;Jf.bindingData=kc;return Jc.g(Fe,"DdaAddRowsColumns",Jf,Cd,Td,we,md,0)},md,572)}ddaDeleteAllDataValues(K,Da,xb,kc){this.gN((Nc,md,Cd)=>{var Td=this.$.qa.ua,we=this.Qna();Nc=Vf.b(Nc,xb);md=Vf.a(md,this.rL);const Fe=Td.Pa(9);Fe.controlId=K;Fe.bindingId=Da;Fe.currentSheetName=we;return Jc.g(Td,"DdaDeleteAllDataValues",Fe,Nc,md,Cd,kc,0)},kc,573)}ddaClearBindingFormats(K,Da,xb,kc){this.gN((Nc,md,Cd)=>{var Td=this.$.qa.ua,we=this.Qna();Nc=Vf.b(Nc,xb);md=
Vf.a(md,this.rL);const Fe=Td.Pa(9);Fe.controlId=K;Fe.bindingId=Da;Fe.currentSheetName=we;return Jc.g(Td,"DdaClearBindingFormats",Fe,Nc,md,Cd,kc,0)},kc,574)}ddaSetBindingFormats(K,Da,xb,kc,Nc,md){this.gN((Cd,Td,we)=>{var Fe=this.$.qa.ua,vf=this.Qna();Cd=Vf.b(Cd,Nc);Td=Vf.a(Td,this.rL);const Jf=Fe.Pa(9);Jf.controlId=K;Jf.bindingId=Da;Jf.currentSheetName=vf;Jf.bindingData=xb;Jf.isSetFormats=kc;return Jc.g(Fe,"DdaSetBindingFormats",Jf,Cd,Td,we,md,0)},md,575)}parseRange(K,Da,xb){this.gN((kc,Nc,md)=>{const Cd=
this.$.qa.ua.ie();return Jc.v(this.$.qa.ua,K,-1,Vf.b(kc,Da),Vf.a(Nc,this.rL),md,xb,Cd)},xb,162,16)}parseRangeForGoto(K,Da,xb,kc){this.gN((Nc,md,Cd)=>{const Td=this.$.qa.ua.ie();return Jc.w(this.$.qa.ua,K,Da,Vf.b(Nc,xb),Vf.a(md,this.rL),Cd,kc,Td)},kc,562,16)}executeRichApiRequest(K,Da,xb){k.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(K.RequestFlags&=8191);if(k.EwaSettings.isChangeGateEnabled("OfficeVSO:7867662_RichApiUndoThirdPartyFlight")){var kc=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichApiUndoThirdParty",
!1);const Nc=0!==(K.RequestFlags&128);kc||"sdxcatalog"===K.MarketplaceType||Nc||(K.RequestFlags&=-17)}k.EwaSettings.Ea(233)?this.ySh(this.$.qa.ua.ie(),Da,()=>{this.HT.pPa(Nf.a.internalError,xb)},xb,K):(kc=di.DdaFacade.Brd(K),!this.$.yd.TA||kc&16?(kc|=64,this.$.userOperationManager.OH(new mj(this.$,K,(Nc,md,Cd)=>hi(this.$.qa.ua,K,Vf.b(Nc,Da),Vf.a(md,this.rL),Cd,xb),kc))):(this.HT.pPa(Nf.a.jOc,xb),m.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed")))}Qna(){return this.$.ea.isNamedObjectViewMode?
this.$.na.sheetName:this.$.activeItemName}gN(K,Da,xb,kc){kc=void 0===kc?0:kc;!this.$.yd.TA||kc&16?this.$.userOperationManager.OH(new xf.a(xb,0,K,kc|64)):(this.HT.pPa(Nf.a.jOc,Da),m.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))}ySh(K,Da,xb,kc,Nc){let md=di.DdaFacade.Brd(Nc);if(!this.$.yd.TA||md&16){var Cd=this.$.Sd.Ze("UserAction","Rich Api request");this.$.userOperationManager.enqueueOperation(new Xi(this.$,K,Da,xb,kc,Cd,Nc,md|64),null)}else this.HT.pPa(Nf.a.jOc,kc),m.ULS.sendTraceTag(537163158,
0,50,"Write operation is not allowed")}}Object(f.a)(rk,"DdaWebServiceHelper",null,[]);class Hj{constructor(K,Da,xb,kc){this.eUh=K;this.fileSize=Da;this.P2j=kc}}Object(f.a)(Hj,"DocumentFile",null,[]);class Ui{}Ui.generalException="GeneralException";Ui.i3g="ApiNotFound";Ui.dPd="OperationCancelled";Ui.invalidArgument="InvalidArgument";Object(f.a)(Ui,"ErrorCodes",null,[]);class jk{replaceShortcuts(){return Promise.reject("ReplaceShortcuts method is not overridden")}getShortcuts(){return Promise.reject("GetShortcuts method is not overridden")}checkShortcutsInUse(){return Promise.reject("CheckShortcutsInUse method is not overridden")}}
Object(f.a)(jk,"WacApiDelegates",null,[]);var Yj=a(632);class fk extends jk{constructor(K,Da){super();this.sxf=(xb,kc)=>{xb=fk.Kmh(xb,kc);if(!Yj.a(this.$,xb))return!0;xb=this.$.shortcutKeyManager.Thf(xb);return!!xb&&0<xb.length};this.addinId=K;this.$=Da}replaceShortcuts(K){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,K,this.sxf)}getShortcuts(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)}checkShortcutsInUse(K){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(K,
this.sxf)}static lrh(K,Da){const xb=document.createEvent("KeyboardEvent");if(Ng.a.dE)xb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(K&8),!!(K&32),!!(K&4),!!(K&256));else{const kc=[];K&4&&kc.push("Shift");K&8&&kc.push("Control");K&32&&kc.push("Alt");xb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,kc.join(" "),!1,"en-US")}K=new Sys.UI.DomEvent(xb);K.keyCode=Da;return K}static Kmh(K,Da){if(Ng.a.vh)switch(Da){case 189:Da=173;break;case 187:Da=61;break;case 186:Da=59}return fk.lrh(K,
Da)}}Object(f.a)(fk,"ExcelWacApiDelegates",jk,[]);class dj{constructor(K){this.WNa={};this.nXi=K}jVg(K,Da){this.Zmc(K)||(this.WNa[K]={});if(this.xDi(K))return m.ULS.sendTraceTag(537163157,344,50,`App ${K} has reach the limit of number of cached files.`),Nf.a.WXi;this.WNa[K][Da.eUh.toString()]=Da;return Nf.a.success}T6h(K,Da){let xb=null;this.Zmc(K)&&(xb=this.WNa[K][Da.toString()]);xb||m.ULS.sendTraceTag(537163156,344,15,`File cache for [agave:${K}, fileHandler:${Da}] doesn't exist`);return xb}Zmc(K){return K in
this.WNa}Cyj(K,Da){if(this.Zmc(K)){const xb=this.WNa[K];delete xb[Da.toString()];1>Object.keys(xb).length&&delete this.WNa[K];return Da.toString()in xb?Nf.a.internalError:Nf.a.success}return Nf.a.internalError}xDi(K){return this.Zmc(K)?Object.keys(this.WNa[K]).length>=this.nXi:!1}static getInstance(K){return K.ga.Da(200)||K.ga.Qa(200,new dj(dj.oXi))}static i0i(){return++dj.ech}}dj.PWi=4194304;dj.oXi=1;dj.ech=0;Object(f.a)(dj,"GetFileApiHelper",null,[]);class kk{constructor(K){this.Jw=K}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.Jw)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Da){this.invokePropertySet(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){switch(K){case 1:return this.R0i()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Da){K=this.invokeMethod(K,
Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}R0i(){this.notifyActionHandlerReady();return null}}Object(f.a)(kk,"AddinInternalService",null,[]);class lk{constructor(K,Da){this.sJ=Da;this.Jw=K}getAppRuntimeState(){return this.sJ.getAppRuntimeState(this.Jw)?2:1}setAppRuntimeState(K){switch(K){case 2:K=!0;break;case 1:K=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(rd.a.invalidArgument,$h.a.ia(1769));}this.sJ.setAppRuntimeState(this.Jw,K)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Da){this.invokePropertySet(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K,Da){switch(K){case 2:return this.d2h();case 1:return this.QOj(Da)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,
Da){K=this.invokeMethod(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}d2h(){return this.getAppRuntimeState()}QOj(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"int");this.setAppRuntimeState(K);return null}}Object(f.a)(lk,"AppRuntimeService",null,[]);var gk=a(1029);class mk{constructor(K,Da,xb,kc){this.Vz=K;this.I5=xb;this.zB=kc.Vg.getOsfControl(Da)}disable(){try{if(!$h.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.iSe();
if(!this.Owf())return this.jSe();this.I5.mfk(this.Vz)}catch(K){return m.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",K.message||"Unknown"),this.gSe()}return null}enable(){try{if(!$h.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.iSe();if(!this.Owf())return this.jSe();this.I5.qwj(this.Vz)}catch(K){return m.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",
K.message||"Unknown"),this.gSe()}return null}_OnAccess(){}getTypeName(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Da){this.invokePropertySet(K,
Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){switch(K){case 1:return this.rHa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Da){switch(K){case 3:return this.iAh();case 2:return this.rFh()}K=this.invokeMethod(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}iAh(){return this.disable()}rFh(){return this.enable()}rHa(){this._OnAccess();return null}iSe(){return gk.a(rd.a.notImplemented,
$h.a.ia(1770))}jSe(){return gk.a(rd.a.sharedRuntimeNotAvailable,$h.a.ia(1774))}gSe(){return gk.a(rd.a.generalException,$h.a.ia(1765))}Owf(){const K=this.zB.getSharedRuntimeId();return!!K&&0<K.length}}Object(f.a)(mk,"BeforeDocumentCloseNotification",null,[]);class nk{constructor(){this.ewe=this.hqe=this.Eq=!1}get enabled(){return this.Eq}set enabled(K){this.Eq=K}get nativeRuntime(){return this.hqe}set nativeRuntime(K){this.hqe=K}get streamingEnabled(){return this.ewe}set streamingEnabled(K){this.ewe=
K}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"}invokePropertyGet(K){switch(K){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K,Da){switch(K){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,
0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Da,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Da){this.invokePropertySet(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokeMethodAsync(K,Da){K=this.invokeMethod(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}}Object(f.a)(nk,"CustomFunctionEngineStatus",null,[]);class fh{constructor(K,Da,xb){this.$Kg=K;this.aLg=Da;this.YOg=xb}get status(){const K=new nk;K.enabled=this.$Kg;K.streamingEnabled=this.aLg;K.nativeRuntime=!1;return K}register(K){return OfficeExtension.WacRuntime.Utility.createPromise(this.YOg(K))}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionManager"}invokePropertyGet(K){switch(K){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Da){this.invokePropertySet(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Da){switch(K){case 1:return this.jxj(Da)}K=this.invokeMethod(K,
Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}jxj(K){const Da=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,1,"string");return this.register(Da,K)}}Object(f.a)(fh,"CustomFunctionManager",null,[]);var Ij=a(1004);class Pj{constructor(K,Da,xb,kc){this.Ofe="";this.O0b=0;this.nS=K;this._id=Da;this.Jw=xb;this.sJ=kc}get id(){return this._id}_RegisterStateChange(){this.O0b||this.nS.execute(K=>
{this.Ofe=K.hWa(this._id,Da=>{this.sJ.kWh(this.Jw,this._id,JSON.stringify(Da))})});this.O0b++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.O0b--;this.O0b||this.nS.execute(K=>{K.YUd(this._id,this.Ofe)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(K){switch(K){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Da){this.invokePropertySet(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Da){switch(K){case 6:return this.sEg();case 7:return this.wEg()}K=
this.invokeMethod(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}sEg(){return this._RegisterStateChange()}wEg(){return this._UnregisterStateChange()}}Object(f.a)(Pj,"LicenseFeature",null,[]);class Qj{constructor(K,Da){this.nS=Yg.a.instance.Qd("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.Jw=K;this.sJ=Da;this.NNg=this.sJ.Vg.getOsfControl(this.Jw)}getFeatureTier(K,Da){return OfficeExtension.WacRuntime.Utility.createPromise(xb=>{const kc=1===Da?1:2===
Da?2:0;this.nS.execute(Nc=>{Nc.getFeatureTier(K,kc).then(md=>{xb(this.sai(md))},()=>{xb(Da)})})})}getLicenseFeature(K){K=new Pj(this.nS,K,this.Jw,this.sJ);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}isFeatureEnabled(K,Da){return OfficeExtension.WacRuntime.Utility.createPromise(xb=>{this.nS.execute(kc=>{kc.isFeatureEnabled(K,Da).then(Nc=>{xb(Nc)},()=>{xb(Da)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(K=>{this.nS.execute(Da=>{Da=
Da.isFreemiumUpsellEnabled();K(Da)})})}launchUpsellExperience(K){if(this.NNg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.nS.execute(Da=>{Da.launchUpsellExperience(K)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(rd.a.t3c,"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Da){this.invokePropertySet(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K,Da){switch(K){case 6:return this.uEg(Da)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Da){switch(K){case 2:return this.N7h(Da);case 5:return this.rai(Da);
case 1:return this.nEi(Da);case 3:return this.ZEi();case 4:return this.dPi(Da)}K=this.invokeMethod(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}N7h(K){const Da=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,1,"int");return this.getFeatureTier(Da,K)}rai(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");return this.getLicenseFeature(K)}nEi(K){const Da=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,
0,"string");K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,1,"boolean");return this.isFeatureEnabled(Da,K)}ZEi(){return this.isFreemiumUpsellEnabled()}dPi(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");return this.launchUpsellExperience(K)}uEg(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");this._TestFireStateChangedEvent(K);return null}sai(K){switch(K){case 1:return 1;case 2:return 2;default:return 0}}}Object(f.a)(Qj,"License",
null,[]);var zj=a(185);const Rj=(K,Da,xb)=>kc=>(Nc,md)=>{jh.TaskExtensions.za(F.GetServiceTaskFactory.create(Da.ga,279,Da.ka,1),Cd=>{Cd=Cd.result;let Td=!1;var we=xb.Vg.getOsfControl(K);let Fe=null;we&&(Fe=we.getStoreType(),(we=we.getManifest())&&we.getSharedRuntimeForCustomFunctions("Workbook")&&(Td=!0));jh.TaskExtensions.za(Cd.uqf(K,Fe,kc,Td),vf=>{zj.b(vf)?vf.result?Nc(null):md(OfficeExtension.WacRuntime.Utility.createRichApiException(rd.a.invalidArgument,Ag.a.instance.ia(1769))):md(OfficeExtension.WacRuntime.Utility.createRichApiException(rd.a.generalException,
Ag.a.instance.ia(1765)))},Da.ka,3)},Da.ka,3)};class Jj{constructor(K){if(!K)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.lId=K}areShortcutsInUse(K){return OfficeExtension.WacRuntime.Utility.createPromise((Da,xb)=>{this.lId.checkShortcutsInUse(K).then(kc=>{Da(kc)}).catch(kc=>{xb(kc)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((K,Da)=>{this.lId.getShortcuts().then(xb=>{K(xb)}).catch(xb=>{Da(xb)})})}replaceShortcuts(K){return OfficeExtension.WacRuntime.Utility.createPromise((Da,
xb)=>{this.lId.replaceShortcuts(K).then(()=>{Da(null)}).catch(kc=>{xb(kc)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Da){this.invokePropertySet(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokeMethodAsync(K,Da){switch(K){case 3:return this.W4g(Da);case 1:return this.ehi();case 2:return this.hEj(Da)}K=this.invokeMethod(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}W4g(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"Array<string>");return this.areShortcutsInUse(K)}ehi(){return this.getShortcuts()}hEj(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"any");return this.replaceShortcuts(K)}}Object(f.a)(Jj,"ActionService",
null,[]);class Aj{constructor(){this.data=null}}Object(f.a)(Aj,"AugLoopHostMessageReceivedEventArgs",null,[]);var Sj=a(1030);class qj{constructor(K,Da,xb){this.Yba=K;this.qca=void 0===Da?!1:Da;this.sIa=(void 0===xb?null:xb)||OfficeExtension.WacRuntime.RichApi.getEventManager()}sendMessage(K){this.qca||Sj.a.yNj(K)}_RegisterHostMessageReceivedEvent(){this.qca||(qj.U4f||(Sj.a.bxj(K=>{this.sIa.fireEvent("",65542,Object.assign(new Aj,{data:K}))}),qj.U4f=!0),this.sIa.register(this.Yba,"",65542))}_UnregisterHostMessageReceivedEvent(){this.qca||
this.sIa.unregister(this.Yba,"",65542)}getTypeName(){return"Microsoft.Office.AugLoopEventService"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Da){this.invokePropertySet(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K,
Da){switch(K){case 1:return this.nNj(Da);case 2:return this.rEg();case 3:return this.vEg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Da){K=this.invokeMethod(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}nNj(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");this.sendMessage(K);return null}rEg(){this._RegisterHostMessageReceivedEvent();return null}vEg(){this._UnregisterHostMessageReceivedEvent();
return null}}qj.U4f=!1;Object(f.a)(qj,"AugLoopEventService",null,[]);var Zj=a(807),Tj=a(528);class Kj{constructor(K,Da,xb){this.VYc=this.jke=null;this.Yba=K;this.xre=Da;if(this.Oa=xb)this.jke=this.Oa.Sa("GetAccessTokenOAuthFirstPartyAllowList")}oci(){this.VYc||(this.VYc=Tj.a.ar(Yg.a.instance.Qd("Common.App.OAuth.IOAuthManager")));return this.VYc}jFi(K,Da){if(!this.xre||""===this.Yba||!this.Oa)return!1;const xb=this.xre.getOsfControl(this.Yba);if(!xb)return!1;let kc=!1;this.jke.split(";").forEach(Nc=>
{Da===Nc&&(kc=!0)});return this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthManagerAPI",!1)&&1===gf.AFrameworkApplication.sa.Ra.kj&&xb.isFirstParty()&&K===Kj.F2g&&kc&&Df.d(xb.getSolutionId())===Kj.G2g}getAccessTokenFirstPartyOAuth(K,Da){let xb;xb=this.jFi(K,Da)?kc=>{const Nc=this.oci();Nc.continueWith(()=>{Nc.result.$C(K,Da).then(md=>{kc(md);return md})})}:kc=>{kc(Object.assign(new Zj.a,{IsSuccess:!1,Token:null,ErrorCode:"NotEnabled",ErrorMessage:"OAuthManager is disabled."}))};return OfficeExtension.WacRuntime.Utility.createPromise(xb)}getTypeName(){return"Microsoft.Office.Auth"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Da){this.invokePropertySet(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Da){switch(K){case 1:return this.Z0h(Da)}K=this.invokeMethod(K,
Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}Z0h(K){const Da=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,1,"string");return this.getAccessTokenFirstPartyOAuth(Da,K)}}Kj.F2g="Maker";Kj.G2g="fa000000043";Object(f.a)(Kj,"Auth",null,[]);class ok{constructor(){this.iwa=null}Rgi(){this.iwa||(this.iwa=Tj.a.ar(Yg.a.instance.Qd("Common.App.SharedFilePicker.ISharedFilePicker")));return this.iwa}getSharedFilePickerResponse(K){return OfficeExtension.WacRuntime.Utility.createPromise((Da,
xb)=>{try{const kc=this.Rgi();od.Task.WAA.call(null,kc).continueWith(()=>{const Nc=kc.result;if(Nc){let md={};(()=>{let Cd=me.d(K);({Mu:md}=Cd);return Cd})().returnValue?Nc.bqd(md).then(Cd=>{Cd&&0<Cd.length?Da(Cd):xb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(Cd=>{xb(Cd)}):xb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else xb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker is resolved as null."))})}catch(kc){xb(kc)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertySetAsync(K,Da){this.invokePropertySet(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokeMethodAsync(K,Da){switch(K){case 1:return this.Qgi(Da)}K=this.invokeMethod(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}Qgi(K){K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,0,"string");return this.getSharedFilePickerResponse(K)}}Object(f.a)(ok,"SharedFilePicker",null,[]);class pk{createInstance(K,Da,xb,kc,Nc){xb=void 0===xb?"":xb;kc=void 0===kc?null:kc;Nc=void 0===Nc?null:Nc;switch(K){case "Microsoft.Office.ActionService":return new Jj(Da);case "Microsoft.Office.SharedFilePicker":return new ok;
case "Microsoft.Office.Auth":return new Kj(xb,kc,Nc);case "Microsoft.Office.AugLoopEventService":return new qj(xb)}return null}}Object(f.a)(pk,"WacApiHost",null,[]);class Uj{constructor(){this.isFeedbackSent=!1}}Object(f.a)(Uj,"UserFeedbackUIDismissedEventArgs",null,[]);var wk=a(189),ak=a(237);class Vj{constructor(K,Da,xb,kc){this.Yba=K;this.IHg=Da;this.qca=void 0===xb?!1:xb;this.sIa=(void 0===kc?null:kc)||OfficeExtension.WacRuntime.RichApi.getEventManager()}onDismiss(K){this.sIa.fireEvent("",65546,
Object.assign(new Uj,{isFeedbackSent:K}))}onError(){}sci(K){switch(K){case 0:return"Smile";case 1:return"Frown";case 2:return"Idea";case 3:return"Unclassified";default:return"Unclassified"}}tci(K){switch(K){case 0:return"Modal";case 1:return"SidePane";default:return"Modal"}}rci(K){const Da={};Da.isScenarioEnabled=K.isScenarioEnabled;Da.scenarioType=K.scenarioType;if(K=K.question){const xb={};xb.questionUiType=K.questionUIType;xb.questionUiBehavior=K.questionUIBehavior;xb.questionInstruction=K.questionInstruction;
xb.questionOptions=K.questionOptions;Da.questionDetails=xb}return Da}F7b(K,Da,xb){1===xb?K[Da]=!0:2===xb&&(K[Da]=!1)}collectUserFeedback(K,Da,xb,kc){if(!this.qca){const Nc={};gf.AFrameworkApplication.da.C4c(Nc);const md=this.IHg.getContext(Nc);md.initialFeedbackType=this.sci(K);md.uiType=this.tci(Da);md.telemetryGroup.featureArea=xb;kc.v2Config.contextDataFiles&&(md.isShareContextDataEnabled=!0,md.getContextData=()=>Promise.all(ak.a.map(kc.v2Config.contextDataFiles,Cd=>window.fetch("data:application/octet-stream;base64,"+
Cd.base64Data).then(Td=>Td.blob()).then(Td=>new File([Td],Cd.fileName,{type:Cd.fileType})))));(K=kc.v2Config.scenarioConfig)&&(md.scenarioConfig=this.rci(K));this.F7b(md,"showEmailAddress",kc.v2Config.isEmailCollectionEnabled);this.F7b(md,"isFileUploadEnabled",kc.v2Config.isFileUploadEnabled);this.F7b(md,"screenshot",kc.v2Config.isScreenshotEnabled);this.F7b(md,"isThankYouPageDisabled",kc.v2Config.isThankYouPageDisabled);wk.UISurfaces.Gff().then(Cd=>{Cd.initializeFeedbackModal(md,Object(eg.a)(this,
this.onDismiss,"onDismiss"),Object(eg.a)(this,this.onError,"onError"));return Cd})}}_RegisterUserFeedbackUIDismissedEvent(){this.qca||this.sIa.register(this.Yba,"",65546)}_UnregisterUserFeedbackUIDismissedEvent(){this.qca||this.sIa.unregister(this.Yba,"",65546)}getTypeName(){return"Microsoft.Office.UserFeedbackService"}invokePropertyGet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokePropertyGetAsync(K){K=this.invokePropertyGet(K);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}invokePropertySet(K){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);
}invokePropertySetAsync(K,Da){this.invokePropertySet(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(K,Da){switch(K){case 1:return this.Rih(Da);case 18:return this.tEg();case 19:return this.xEg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(K);}invokeMethodAsync(K,Da){K=this.invokeMethod(K,Da);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(K)}Rih(K){const Da=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,
0,"int"),xb=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,1,"int"),kc=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,2,"string");K=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(K,3,"object");this.collectUserFeedback(Da,xb,kc,K);return null}tEg(){this._RegisterUserFeedbackUIDismissedEvent();return null}xEg(){this._UnregisterUserFeedbackUIDismissedEvent();return null}}Object(f.a)(Vj,"UserFeedbackService",null,[]);class Bj{constructor(K,Da,xb,kc,Nc){this.n6b=null;
this.UZb=K;this.Jw=Da;this.sJ=xb;this.vd=kc;this.cye=Nc}hostName(){return"ExcelOnline"}appId(){return this.UZb}createInstance(K){switch(K){case "Microsoft.Authentication.AuthenticationService":return Yg.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.Jw,this.sJ.Vg);case "Microsoft.Authentication.TokenParameters":return new xe;case "Microsoft.ExcelServices.CustomFunctionManager":K=k.EwaSettings.Ea(114);var Da=k.EwaSettings.Ea(115);return new fh(K,
Da,Rj(this.UZb,this.vd,this.sJ));case "Microsoft.AppRuntime.AppRuntimeService":return new lk(this.Jw,this.sJ);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return K=rg.a(this.vd),new mk(this.UZb,this.Jw,K,this.sJ);case "Microsoft.DynamicRibbon.DynamicRibbon":return K=rg.a(this.vd),new Ij.DynamicRibbon(this.UZb,this.Jw,this.sJ,K,K.No(this.Jw).Vm);case "Microsoft.Office.Licensing.License":return new Qj(this.Jw,this.sJ);case "Microsoft.InternalService.AddinInternalService":return new kk(this.Jw);
case "Microsoft.Office.AugLoopEventService":const xb=rg.a(this.vd),kc=xb.No(this.Jw).Vm;Da=()=>"9202c06a-b7d3-466f-9adb-acad75789dbc"===kc.PrimaryMarketplace.SolutionId&&k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.AugLoopEventServiceDevBypass",!1)&&("TestHost"===this.vd.xa.DocumentHostInfo.HostTier||"Dogfood"===gf.AFrameworkApplication.Yd.AudienceGroup);if(tg.a(kc)||Da())return K=Cd=>(Td,we,Fe)=>{xb.lj.sud({actionType:Cd,controlId:Td,messageType:Fe,targetId:we,message:""})},
K={register:K(1),unregister:K(2),fireEvent:(Cd,Td,we)=>{xb.lj.RK(Td,Cd)&&xb.OF(Td,Cd,JSON.stringify(we))}},new qj(this.Jw,!1,K);break;case "Microsoft.Office.UserFeedbackService":const Nc=rg.a(this.vd),md=Nc.No(this.Jw).Vm;Da=()=>"9202c06a-b7d3-466f-9adb-acad75789dbc"===md.PrimaryMarketplace.SolutionId&&k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.UserFeedbackServiceDevBypass",!1)&&("TestHost"===this.vd.xa.DocumentHostInfo.HostTier||"Dogfood"===gf.AFrameworkApplication.Yd.AudienceGroup);
if(tg.a(md)||Da())return K=Cd=>(Td,we,Fe)=>{Nc.lj.sud({actionType:Cd,controlId:Td,messageType:Fe,targetId:we,message:""})},K={register:K(1),unregister:K(2),fireEvent:(Cd,Td,we)=>{Nc.lj.RK(Td,Cd)&&Nc.OF(Td,Cd,JSON.stringify(we))}},new Vj(this.Jw,Yg.a.instance.resolve("Common.App.ICustomerFeedbackUiWrapper"),!1,K);break;default:if(this.n6b||(this.n6b=new pk),gf.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthManagerAPI",!1)){if(Da=this.n6b.createInstance(K,this.cye,
this.Jw,this.sJ.Vg,gf.AFrameworkApplication.da))return Da}else if(Da=this.n6b.createInstance(K,this.cye))return Da}m.ULS.sendTraceTag(537163155,0,10,`Typename: ${K} is an invalid parameter for the RichApiHost.CreateInstance method.`);throw OfficeExtension.WacRuntime.Utility.createRichApiException(rd.a.generalException,rd.a.generalException);}}Object(f.a)(Bj,"RichApiHost",null,[]);var bk=a(393),Lj=a(33),ck=a(133),Cj=a(40),Wj=a(107),sk=a(297),Dj=a(46),Xj=a(262),tk=a(7),uk=a(76);class xg{constructor(K,
Da,xb,kc){this.Zd=this.rangePicker=null;this.$=K;this.Gf=Da;this.Zd=kc;this.Gg=new gi(K.ea);this.dD=new rk(K,this.Gg);this.LIf=xb;this.Qhc=new Map}get HT(){return this.Gg}dispose(){this.$=this.Qhc=null}Pe(){return!1}Ue(){return!1}executeCommand(K,Da,xb){K=Da.command;switch(K){case 451041795:this.Gg.Aj(xb[Qe.a.Th],xb[Qe.a.N7]);break;case 974713501:this.Xni(xb[Qe.a.Th],xb[Qe.a.N7]);break;case 1237877382:this.Gg.Yx(xb[Qe.a.N7]);break;default:return Pc.a(K)}return od.Task.Wa(!0)}Be(K,Da,xb){if(K=!!xb)switch(Da.command){case 974713501:case 1237877382:case 451041795:break;
default:K=!1}return K}Xni(K,Da){var xb;const kc=K.DdaMethod;"undefined"===typeof kc.DispatchId?this.Gg.Aj(Nf.a.internalError,Da):xg.nDi(K)||this.$.If&1?(kc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new li(this.$,this,K,Da,this.Zd)).start(this.Gf,K.DdaMethod.ControlId):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.ogi(K,Da):kc.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.CTj(K,Da):kc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?
this.addBinding(K,this.upd(K.DdaMethod.ControlId),0,Da):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.M2h(K,Da):kc.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.bPj(K,Da):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.L2h(K,Da):kc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.Byj(K,Da):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.L1h(K,Da):kc.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?
this.jGd(K,Da):kc.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(K,Da):kc.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(K.DdaAddRowsColumns.IsRow=!0,this.SAe(K,Da)):kc.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(K.DdaAddRowsColumns.IsRow=!1,this.SAe(K,Da)):kc.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.Txh(K,Da):kc.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.Sgh(K,Da):kc.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?
(K.DdaSetBindingFormats.IsSetFormats=!0,this.xeg(K,Da)):kc.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(K.DdaSetBindingFormats.IsSetFormats=!1,this.xeg(K,Da)):kc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(K,K.DdaBindingsMethod.ItemName,K.DdaBindingsMethod.FailOnCollision?2:1,Da):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.T7h(Da):kc.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.$Jd(K,Da):kc.DispatchId===
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(K,Da):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.Q6h(K,Da):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.R6h(K,Da):kc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.Dyj(K,Da):kc.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(K.DdaMethod.ControlId,K),this.Gg.Yx(Da)):
kc.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?this.qYi(K,Da):kc.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?this.nYi(K,Da):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(K,Da):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?this.getAuthContext(K,Da):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetNestedAppAuthContextMethod?this.prd(K,Da):this.Gg.Aj(Nf.a.iPd,Da),k.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&
kc.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(K=this.Gf.hY(K.DdaMethod.ControlId),Da="",K&&(Da=di.DdaFacade.getSolutionId(K,this.$),Da=Telemetry.PrivacyRules.GetPrivacyCompliantId(Da,K.OwnerAddinStoreType||K.PrimaryMarketplace.MarketplaceType,null===(xb=K.AssetMarketplace)||void 0===xb?void 0:xb.SolutionId,null,null,K.PrimaryMarketplace.MarketplaceRef)),m.ULS.sendTraceTag(537163224,344,50,`DDA method Id: ${kc.DispatchId}, AppID: ${Da}`))):this.Gg.Aj(Nf.a.EYe,Da)}M2h(K,Da){K.DdaGetBindingData.CoerceType=
xg.Cbc(K.DdaGetBindingData.CoerceType);K.DdaGetBindingData.FilterType=xg.f7e(K.DdaGetBindingData.FilterType);K.DdaGetBindingData.ValueFormat=xg.byg(K.DdaGetBindingData.ValueFormat);if(this.Jsc(K.DdaGetBindingData.CoerceType,Da)){if(K.DdaGetBindingData){const xb=K.DdaGetBindingData;0===xb.FilterType&&(xb.FilterType=2);xb.StartCol|=0;xb.StartRow|=0;xb.ColCount=void 0===xb.ColCount?-1:xb.ColCount;xb.RowCount=void 0===xb.RowCount?-1:xb.RowCount}this.dD.ddaGetBindingData(K.DdaMethod.ControlId,K.DdaGetBindingData.BindingId,
K.DdaGetBindingData.CoerceType,K.DdaGetBindingData.ValueFormat,K.DdaGetBindingData.FilterType,K.DdaGetBindingData.StartRow,K.DdaGetBindingData.StartCol,K.DdaGetBindingData.RowCount,K.DdaGetBindingData.ColCount,xb=>{if(Hg.a(xb)||!xb.Result)this.Gg.uK(xb,Da);else{const kc=this.Gg.NP();kc.Data=xg.qJe(xb.Result);Da(kc)}},Da)}}bPj(K,Da){K.DdaSetBindingData.CoerceType=xg.Cbc(K.DdaSetBindingData.CoerceType);if(this.Jsc(K.DdaSetBindingData.CoerceType,Da)){var xb=xg.s9c(K.DdaSetBindingData.CoerceType,K.DdaSetBindingData.Data);
xg.spc(xb)?this.Gg.Aj(Nf.a.SLc,Da):(1===xb.CoerceType&&(xb.CellFormat||(xb.CellFormat=K.DdaSetBindingData.CellFormat),xb.TableOptions||(xb.TableOptions=K.DdaSetBindingData.TableOptions)),K.DdaSetBindingData&&(K.DdaSetBindingData.StartCol|=0,K.DdaSetBindingData.StartRow|=0),this.dD.ddaSetBindingData(K.DdaMethod.ControlId,K.DdaSetBindingData.BindingId,K.DdaSetBindingData.StartRow,K.DdaSetBindingData.StartCol,xb,kc=>{Hg.a(kc)?this.Gg.uK(kc,Da):this.Gg.Yx(Da)},Da))}}ogi(K,Da){K.DdaGetBindingData.CoerceType=
xg.Cbc(K.DdaGetBindingData.CoerceType);K.DdaGetBindingData.ValueFormat=xg.byg(K.DdaGetBindingData.ValueFormat);K.DdaGetBindingData.FilterType=xg.f7e(K.DdaGetBindingData.FilterType);if(this.Jsc(K.DdaGetBindingData.CoerceType,Da)){var xb=this.upd(K.DdaMethod.ControlId);xb?this.dD.ddaGetSelectedData(K.DdaMethod.ControlId,K.DdaGetBindingData.CoerceType,K.DdaGetBindingData.ValueFormat,K.DdaGetBindingData.FilterType,xb,kc=>{if(Hg.a(kc))this.Gg.uK(kc,Da);else{const Nc=this.Gg.NP();Nc.Data=xg.qJe(kc.Result);
Da(Nc)}},Da):this.Gg.Aj(Nf.a.Chf,Da)}}Q6h(K,Da){const xb=K[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],kc=K[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],Nc=K.DdaMethod.ControlId,md=dj.getInstance(this.$);if(0>=kc)m.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.Gg.Aj(Nf.a.Hzi,Da);else if(kc>dj.PWi)m.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.Gg.Aj(Nf.a.ccf,Da);else{var Cd=
null;switch(xb){case 1:Cd="Compressed";break;case 0:Cd="Text";break;case 2:Cd="Pdf";break;default:m.ULS.sendTraceTag(537163219,344,15,`Requested file type ${xb} is not supported.`);this.Gg.Aj(Nf.a.T6e,Da);return}if("Text"===Cd)m.ULS.sendTraceTag(537163218,344,15,`Requested file type ${Cd} is not supported.`),this.Gg.Aj(Nf.a.T6e,Da);else{k.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(K=new Sys.StringBuilder,K.append(Fh.a(this.$,Cd)),"Pdf"===Cd&&ci.a.Hp(K,
gb.a.R0f,"WholeWorkbook"),K=K.toString()):K=Fh.a(this.$,Cd);var Td=null,we=new XMLHttpRequest;we.onreadystatechange=()=>{if(4===we.readyState)if(200===we.status){var Fe=we.response;if(Fe){Td=new Uint8Array(Fe);Fe=this.Gg.NP();var vf=Td.length,Jf=dj.i0i(),lg={},ph=0;for(let eh=0;eh<vf;eh+=kc){const $g=[],Ug=eh+kc<vf?eh+kc:vf;for(let Ch=0,Yh=eh;Yh<Ug;Ch++,Yh++)$g[Ch]=Td[Yh];lg[(ph++).toString()]=$g}lg=new Hj(Jf,vf,kc,lg);lg=md.jVg(Nc,lg);lg!==Nf.a.success?this.Gg.Aj(lg,Da):(Fe[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=
Jf,Fe[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=vf,m.ULS.sendTraceTag(537163216,344,50,`GetFileAsync get file successfully for file type ${Cd}, the file size is ${vf}`),Da(Fe))}else m.ULS.sendTraceTag(537163217,344,15,`Request is successful, but respone have no data for file type ${Cd}.`),this.Gg.Aj(Nf.a.internalError,Da)}else 500===we.status?this.Gg.Aj(Nf.a.E9e(parseInt(we.statusText,10)),Da):(m.ULS.sendTraceTag(537163215,344,15,`Request failed to obtain the file for type ${Cd}.`),
this.Gg.Aj(Nf.a.P_i,Da))};we.open("GET",K,!0);we.responseType="arraybuffer";we.setRequestHeader("If-Modified-Since","0");we.send(null)}}}R6h(K,Da){var xb=K[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],kc=K[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];K=K.DdaMethod.ControlId;(xb=dj.getInstance(this.$).T6h(K,xb))?(xb=xb.P2j,0>kc||kc>=Object.keys(xb).length?this.Gg.Aj(Nf.a.dui,Da):(kc=xb[kc.toString()],xb=this.Gg.NP(),xb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=
kc,xb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=kc.length,Da(xb))):this.Gg.Aj(Nf.a.internalError,Da)}Dyj(K,Da){var xb=K[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];K=K.DdaMethod.ControlId;xb=dj.getInstance(this.$).Cyj(K,xb);xb===Nf.a.success?this.Gg.Yx(Da):this.Gg.Aj(xb,Da)}CTj(K,Da){K.DdaSetBindingData.CoerceType=xg.Cbc(K.DdaSetBindingData.CoerceType);if(this.Jsc(K.DdaSetBindingData.CoerceType,Da)){var xb=this.upd(K.DdaMethod.ControlId);if(xb){var kc=xg.s9c(K.DdaSetBindingData.CoerceType,
K.DdaSetBindingData.Data),Nc=ud.h(this.$).ha;1===kc.CoerceType&&(!kc.Data&&Nc.ra.$Y&&(kc.Headers||(kc.Headers=[]),kc.Headers.length||kc.Headers.push([]),kc.Headers[0].length||kc.Headers[0].push("")),xg.spc(kc)||(kc.CellFormat||(kc.CellFormat=K.DdaSetBindingData.CellFormat),kc.TableOptions||(kc.TableOptions=K.DdaSetBindingData.TableOptions)));if(xg.spc(kc))this.Gg.Aj(Nf.a.SLc,Da);else{var md=Nc.ra.lf.clone(),Cd=Nc.ra.activeCell.clone();this.dD.ddaSetSelectedData(K.DdaMethod.ControlId,xb,kc,Td=>{var we;
if(Hg.a(Td))this.Gg.uK(Td,Da);else{Td=md.clone();const Fe=kc.Headers?kc.Headers[0].length:kc.Data[0].length;1!==kc.CoerceType||kc.Data?1===kc.CoerceType&&(null===(we=kc.TableOptions)||void 0===we?0:we.length)&&0==kc.TableOptions[0]?(Td.top+=1,Td.bottom=Td.top+kc.Data.length-1):Td.bottom=Td.top+kc.Data.length-(1===kc.CoerceType?0:1):Td.bottom=Td.top+1;Td.right=Td.left+Fe-1;we=Td.contains(Cd)?Cd:Td.topLeft;Nc.updateSelection(Td,we,0);this.Gg.Yx(Da)}},Da)}}else this.Gg.Aj(Nf.a.RLe,Da)}}addBinding(K,
Da,xb,kc){Da?this.dD.ddaAddBinding(K.DdaMethod.ControlId,K.DdaBindingsMethod.BindingId,K.DdaBindingsMethod.BindingType,Da,xb,Nc=>{if(Hg.a(Nc))this.Gg.uK(Nc,kc);else{const md=this.Gg.NP();md.Bindings=Array(1);md.Bindings[0]=this.Gf.$9b(Nc.Result);kc(md)}},kc):this.Gg.Aj(Nf.a.uMj,kc)}L2h(K,Da){this.dD.ddaGetBinding(K.DdaMethod.ControlId,K.DdaBindingsMethod.BindingId,xb=>{if(Hg.a(xb)||!xb.Result)this.Gg.uK(xb,Da);else{const kc=this.Gg.NP();kc.Bindings=Array(1);kc.Bindings[0]=this.Gf.$9b(xb.Result);Da(kc)}},
Da)}T7h(K){const Da=this.Gg.NP(),xb={};xb[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;Da[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=xb;K(Da)}Byj(K,Da){this.dD.ddaReleaseBinding(K.DdaMethod.ControlId,K.DdaBindingsMethod.BindingId,xb=>{Hg.a(xb)?this.Gg.uK(xb,Da):this.Gg.Yx(Da)},Da)}L1h(K,Da){this.dD.ddaGetAllBindings(K.DdaMethod.ControlId,xb=>{if(Hg.a(xb))this.Gg.uK(xb,Da);else{const kc=this.Gg.NP();if(xb.Result){xb=xb.Result;kc.Bindings=
Array(xb.length);for(let Nc=0;Nc<xb.length;Nc++)kc.Bindings[Nc]=this.Gf.$9b(xb[Nc])}else kc.Bindings=null;Da(kc)}},Da)}jGd(K,Da){this.dD.ddaLoadSettings(K.DdaMethod.ControlId,xb=>{if(Hg.a(xb))this.Gg.uK(xb,Da);else{const kc=this.Gg.NP();kc.Properties=xb.Result;Da(kc)}},Da)}saveSettings(K,Da){const xb={Settings:[]};for(let kc=0;kc<K.DdaSettingsMethod.Properties.length;kc++){const Nc={};Nc.Name=K.DdaSettingsMethod.Properties[kc][0];Nc.Value=K.DdaSettingsMethod.Properties[kc][1];xb.Settings[kc]=Nc}this.dD.ddaSaveSettings(K.DdaMethod.ControlId,
xb,K.DdaSettingsMethod.OverwriteIfStale,kc=>{Hg.a(kc)?this.Gg.uK(kc,Da):this.Gg.Yx(Da)},Da)}SAe(K,Da){const xb=xg.s9c(1,K.DdaAddRowsColumns.Data);xg.spc(xb)?this.Gg.Aj(Nf.a.SLc,Da):this.dD.ddaAddRowsColumns(K.DdaMethod.ControlId,K.DdaAddRowsColumns.BindingId,K.DdaAddRowsColumns.IsRow,xb,kc=>{Hg.a(kc)?this.Gg.uK(kc,Da):this.Gg.Yx(Da)},Da)}Txh(K,Da){this.dD.ddaDeleteAllDataValues(K.DdaMethod.ControlId,K.DdaBindingsMethod.BindingId,xb=>{Hg.a(xb)?this.Gg.uK(xb,Da):this.Gg.Yx(Da)},Da)}Sgh(K,Da){this.dD.ddaClearBindingFormats(K.DdaMethod.ControlId,
K.DdaClearBindingFormats.BindingId,xb=>{Hg.a(xb)?this.Gg.uK(xb,Da):this.Gg.Yx(Da)},Da)}xeg(K,Da){const xb={},kc=K.DdaSetBindingFormats.IsSetFormats;kc?xb.CellFormat=K.DdaSetBindingFormats.CellFormat:xb.TableOptions=K.DdaSetBindingFormats.TableOptions;this.dD.ddaSetBindingFormats(K.DdaMethod.ControlId,K.DdaSetBindingFormats.BindingId,xb,kc,Nc=>{Hg.a(Nc)?this.Gg.uK(Nc,Da):this.Gg.Yx(Da)},Da)}executeRichApiRequest(K,Da){var xb;const kc=K.ArrayData,Nc={},md=ud.h(this.$).ha;if(kc){if("WacPartition"===
kc[0]){this.$Rh(K,Da);return}const Jf=Object(S.a)(di.DdaFacade,rg.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===kc[0]){var Cd=Jf.No(K.DdaMethod.ControlId);Cd&&(Cd.nrc=!0,Cd.f0f())}Nc.HttpMethod=kc[1];Nc.PathAndQuery=kc[2];Nc.RequestHeaders=xg.Kdf(kc[3]);Nc.RequestBody=kc[4];Nc.AppPermission=kc[5];Cd=kc[6];Nc.RequestFlags=Cd;var Td=0;if($d.i(this.$.na))switch(md.Bg){case 1:Td=2;break;case 2:Td=3;break;case 64:Td=16;break;case 128:Td=4;break;default:Td=1}var we=null;md.Va.FD&&(we=
md.Va.FD.El);Nc.SheetMultiRange=Re.r(md.ra.selectedRanges,this.$);Nc.ActiveCell=Re.v(md.ra.activeCell,this.$);Nc.ActiveFloatingObjectId=we;Nc.SelectionState=Td;Td=this.Gf.hY(K.DdaMethod.ControlId);Nc.InstanceId=Td?Td.InstanceId:"";if(Td&&Td.PrimaryMarketplace){let lg;if(Td.PrimaryMarketplace.MarketplaceType!==OSF.StoreType.InMemory)lg=Td.PrimaryMarketplace.SolutionId,we=Td.PrimaryMarketplace.MarketplaceType;else{if(!Td.OwnerAddinSolutionId){m.ULS.sendTraceTag(512325018,344,10,"executeRichApiRequest: No OwnerAddinSolutionId for AppCommand");
this.Gg.Aj(Nf.a.UGb,Da);return}if(!Td.OwnerAddinStoreType){m.ULS.sendTraceTag(512325017,344,10,"executeRichApiRequest: No OwnerAddinStoreType for AppCommand");this.Gg.Aj(Nf.a.UGb,Da);return}lg=Td.OwnerAddinSolutionId;we=Td.OwnerAddinStoreType}let ph=Telemetry.PrivacyRules.GetPrivacyCompliantId(lg,we,null===(xb=Td.AssetMarketplace)||void 0===xb?void 0:xb.SolutionId,null,null,Td.PrimaryMarketplace.MarketplaceRef);Nc.CompliantSolutionId=ph;Nc.SolutionId=lg;Nc.MarketplaceType=we;Nc.SolutionVersion=Td.PrimaryMarketplace.SolutionVersion;
Nc.StoreLocation=Td.PrimaryMarketplace.MarketplaceRef}else Nc.SolutionId=Nc.MarketplaceType="",Nc.CompliantSolutionId="";Nc.IsEventsEnabled=void 0===Jf||null===Jf||Jf.lj.r9b(Nc.InstanceId);Nc.RequestGuid=$i.a.create().toString();xb=Nc.RequestBody.length;if(xb>this.$.xa.ExcelRichApiMaxAllowedRequestPayloadSize){this.Gg.Aj(Nf.a.IFj,Da);m.ULS.sendTraceTag(537163213,0,50,`Request payload size:${xb} exceeded the limit`);return}k.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&
Cd&4096&&(xb=new sg(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(xb,mg,kc),Nc.RequestBody=kc[4])}const Fe=xg.Zgf(Nc.RequestHeaders);xg.TPd++;const vf=Lj.a.$b.ke;k.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&Nc&&Nc.RequestBody&&m.ULS.sendTraceTag(537163212,0,50,`Richapi json request body size is ${Nc.RequestBody.length}`);this.dD.executeRichApiRequest(Nc,Jf=>{var lg;this.Ddg(vf,!0,Jf.ServerCorrelationId);let ph=null,eh=null;var $g=Jf.ServerCorrelationId;
if(null===(lg=null===Jf||void 0===Jf?void 0:Jf.Errors)||void 0===lg?0:lg[0])ph=Jf.Errors[0].MessageIdName,eh=Jf.Errors[0].Description,uk.a(this.$).rf.oP(Jf.Errors[0].MessageId);if(Hg.a(Jf)||!Jf.Result)this.Rdb($g,Fe,"Server error",ph,eh),this.Gg.uK(Jf,Da);else{let Ch=null;if(k.EwaSettings.Ea(233))if((lg=Jf.Result)&&lg.length){for(let Ph=0;Ph<lg.length;Ph++)if(lg[Ph].RequestGuid===Nc.RequestGuid){Ch=lg[Ph];break}Ch||this.Gg.uK(Jf,Da)}else Ch=Jf.Result;else Ch=Jf.Result;if(!ph&&Ch&&Ch.ResponseBody&&
Ch.ResponseBody[0])if(Jf=Ch.ResponseBody[0],Jf.startsWith('{"Error":')){1<Ch.ResponseBody.length&&(Jf=Jf.substring(0,Jf.indexOf("}")+1),Jf+="}");try{var Ug=Fb.a.Fk(Jf);Ug.Error&&this.Rdb($g,Fe,"Pipeline error",Ug.Error.Code,Ug.Error.Message)}catch(Ph){this.Rdb($g,Fe,"Json deserialize error",null,"Error info cannot be deserialized.")}}else this.Rdb($g,Fe);else this.Rdb($g,Fe,"Server error",ph,eh);const Yh=($g=Ch.SheetMultiRange)?$g.SheetName:null;Ug=Ch.ActiveFloatingObjectId;const Dh=Ch.SelectionState;
Jf=5===Dh&&!!$g||6===Dh||7===Dh||17===Dh||8===Dh;if(this.$.yd.TA&&Jf)this.Gg.Aj(Nf.a.jOc,Da),m.ULS.sendTraceTag(537163211,0,50,`${Dh.toString()} is not allowed`);else if(5===Dh&&$g){if(this.$.va&&Yh)if(this.$.va.zm(Yh))this.Y3c(Yh);else{let Ph=null;Ph=()=>{this.$.va.zm(Yh)&&(m.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),this.Y3c(Yh),this.$.va.lDc(Ph))};this.$.va.U7b(Ph);if(k.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){let ej=
null;ej=()=>{this.$.va.zm(Yh)&&(this.Y3c(Yh),this.$.va.Lra(ej))};this.$.va.cla(ej)}}}else if(6===Dh||7===Dh||17===Dh||8===Dh||9===Dh){if($g){const Ph=Re.g($g.Ranges);if(Yh&&Re.db(Ph,!0))if(k.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!this.$.va.zm(Yh)){let ej=null;ej=()=>{this.uwg(md,Ph,Yh,Dh);this.$.va.Lra(ej)};this.$.va.cla(ej)}else this.uwg(md,Ph,Yh,Dh)}if(k.EwaSettings.isChangeGateEnabled("OfficeVSO:7915114_SelectImageWhenPossibleUsingXluid")){if(7===
Dh||17===Dh||8===Dh)Ug="{"+Df.e(Ug)+"}",ug.a(this.$).fMj(Ug)}else 7===Dh?($g="38.{"+Df.e(Ug)+"}",ug.a(this.$).Iaa(0,$g,!0)):17===Dh?($g="38.{"+Df.e(Ug)+"}",ug.a(this.$).Iaa(5,$g,!0)):8===Dh&&ug.a(this.$).Iaa(2,Ug,!0);9===Dh&&(this.$.xa.ApiCallToSetPageLayout=!0)}Ch.PostProcessActions?($g=Fb.a.Fk(Ch.PostProcessActions),this.$mj($g).then(()=>{this.kjb(Ch,Da);this.kmd(K.DdaMethod.ControlId,Nc);return Promise.resolve(null)},Ph=>{this.kjb(Ch,Da,Ph);return Promise.reject(Ph)})):this.kjb(Ch,Da)}},Jf=>{this.Ddg(vf,
!1,null);this.Rdb(null,Fe,"Web service error");Da(Jf)})}kmd(K,Da){const xb=Object(S.a)(di.DdaFacade,rg.a(this.$));(null===xb||void 0===xb?0:xb.IYd)&&xb.No(K)&&xg.zXj(Da.RequestHeaders)&&(m.ULS.sendTraceTag(537163209,0,50,`ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: ${K}; SolutionId: ${Da.SolutionId}.`),xb.IYd.FGh(K))}$Rh(K,Da){var xb=this.Gf.hY(K.DdaMethod.ControlId);const kc=di.DdaFacade.getSolutionId(xb,this.$);var Nc=null;Nc=di.DdaFacade.Jza(xb,this.$);
Nc=new fk(Nc,this.$);Nc=new Bj(kc,K.DdaMethod.ControlId,this.Gf,this.$,Nc);const md={ResponseHeaders:[]};md.ResponseBody=Array(1);xb=xg.Kdf(K.ArrayData[3]);const Cd=xg.Zgf(xb);xb=new Di(this.$.xa.CreateWorkbookMaxAllowedBase64Size,this.LIf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Nc,Ii,xb,K.ArrayData).then(Td=>{if(!Td)return this.ZGd(!1,"The rich api executor call failed",Cd),m.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),md.ResponseStatusCode=500,this.kjb(md,
Da),null;this.ZGd(!0,"The rich api executor call succeeded",Cd);md.ResponseStatusCode=Td[0];md.ResponseBody[0]=Td[2];this.kjb(md,Da);return null},Td=>{md.ResponseStatusCode=400;md.ResponseBody[0]=Td.toString();this.ZGd(!1,"The rich api executor call failed",Cd);m.ULS.sendTraceTag(537163207,0,10,`A Excel Rich API batch execution was failed, AppId:${kc}`);this.kjb(md,Da);return null})}Ddg(K,Da,xb){xg.TPd--;K=ck.a(Lj.a.$b,K);m.ULS.sendTraceTag(36763356,0,50,`Rich Api perf log -- total milliseconds used:${K}, requests pending:${xg.TPd}, request result:${Da?
"success":"false"}, server correlationid: ${xb}.`)}kjb(K,Da,xb){xb=void 0===xb?null:xb;const kc=Array(3);kc[0]=K.ResponseStatusCode;kc[1]=xg.Qhi(K.ResponseHeaders);const Nc=[];var md=!1;if(xb&&K.ResponseBody){const Cd=Fb.a.Fk(K.ResponseBody.join(""));Cd.Error||(md={},md.Error=xb,md.TraceIds=Cd.TraceIds,md.ProcessedResults={},md.ProcessedResults.Results=Cd.Results,Nc[0]=Fb.a.He(md),md=!0)}kc[2]=md?Nc:K.ResponseBody;K=this.Gg.NP();K.Data=kc;Da(K)}$Jd(K,Da){(new yg(this.$,this.Gg,this.dD)).$Jd(K,Da)}qYi(K,
Da){m.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");const xb=K[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],kc=K[Cf.a.h6c],Nc=K[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];K=this.$.ga.Da(232).y7a.rYi(K.DdaMethod.ControlId,xb,kc,Nc);K===Nf.a.success?this.Gg.Yx(Da):(m.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.Gg.Aj(K,Da))}nYi(K,Da){m.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");const xb=K[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],
kc=K[Cf.a.h6c],Nc=K[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];this.$.ga.Da(232).y7a.oNj(K.DdaMethod.ControlId,xb,kc,Nc);this.Gg.Yx(Da)}getAccessToken(K,Da){m.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");const xb=(kc,Nc)=>{var md;if(kc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)kc=this.Gg.NP(),kc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=Nc.accessToken,Da(kc);else{Nc=this.Gf.hY(K.DdaMethod.ControlId);let Cd=null!==Nc.OwnerAddinStoreType?Nc.OwnerAddinStoreType:
Nc.PrimaryMarketplace.MarketplaceType;m.ULS.sendTraceTag(537163202,0,10,`${({["errorCode"]:kc.toString(),["appId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(di.DdaFacade.getSolutionId(Nc,this.$),Cd,null===(md=Nc.AssetMarketplace)||void 0===md?void 0:md.SolutionId,null,null,Nc.PrimaryMarketplace.MarketplaceRef),["storeType"]:Cd})}.`);this.Gg.Aj(kc,Da)}};jh.TaskExtensions.za(F.GetServiceTaskFactory.create(this.$.ga,137,this.$.ka,1),kc=>{const Nc=this.Gf.Vg,md=Gh.getInstance();af.AppsForOfficeSingleSignOnManager.getInstance(Nc,
kc.result,md).getAccessToken(K.DdaMethod.ControlId,!0,K,xb)},this.$.ka)}getAuthContext(K,Da){jh.TaskExtensions.za(F.GetServiceTaskFactory.create(this.$.ga,137,this.$.ka,1),()=>{var xb=this.Gf.Vg.getOsfControl(K.DdaMethod.ControlId);if(xb.isFirstParty()){xb=xb.getManifest();var kc=xb.getMarketplaceID(),Nc=xb.getWebApplicationId(),md=xb.getWebApplicationMsaId();Yg.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(kc).then(Cd=>{const Td=this.Gg.NP(),we={};we[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=
Nc;we[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=md||Nc;we[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Cd.upn;we[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Cd.userId;we[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Cd.authority;we[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Vh.a.t2h(Cd.authorityType);we[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Cd.isAnonymous;we[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=
Cd.tenantId;we[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Cd.supportsAuthToken;Td[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=we;Da(Td)},Cd=>{const Td=this.Gg.NP(),we={},Fe=new Vh.a;we[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Nc;we[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=md||Nc;we[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Fe.upn;we[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Fe.userId;
we[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Fe.authority;we[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Fe.authorityType;we[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Fe.isAnonymous;we[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Fe.tenantId;we[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=Cd;we[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Fe.supportsAuthToken;Td[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=
we;Td.Error=1;Da(Td)})}},this.$.ka)}prd(K,Da){K=Hf.prd(this.Gf.Vg,K.DdaMethod.ControlId);K.errorCode===Nf.a.success?(K=Object.assign({},this.Gg.NP(),K.context),Da(K)):this.Gg.Aj(K.errorCode,Da)}bDi(K){const Da=ud.h(this.$).ha;return 16===Da.Bg&&!!Da.Va.pe&&!!Da.Va.pe.floatingObject&&pi.a.equals(Da.Va.pe.floatingObject.id,K,!0)}upd(K){const Da=ud.h(this.$).ha;return Da.ra.Ij?1===Da.Bg||this.bDi(K)?Da.Gma:null:null}Jsc(K,Da){return 1!==K&&2!==K&&3!==K?(this.Gg.Aj(Nf.a.YOe,Da),!1):!0}ZGd(K,Da,xb){const kc=
{};kc.a=this.$.xa.UserSessionId;kc.b=K;kc.c=Da;kc.d=null;kc.e=xb;ni.b().ih(37,kc)}Rdb(K,Da,xb,kc,Nc){xb=void 0===xb?null:xb;kc=void 0===kc?null:kc;Nc=void 0===Nc?null:Nc;const md={};K&&(md.ServerCorrelationId=K);void 0!==Da&&null!==Da&&(md.Source=Da);xb&&(md.ErrorType=xb);kc&&(md.MessageId=kc);Nc&&(md.StatusDescription=Nc);k.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&kc&&"ExternalDataRefreshFailed"===kc&&(md.StatusDescription="");m.ULS.sendTraceTag(50688452,0,50,Fb.a.He(md))}$mj(K){let Da=
new Promise(xb=>{xb(null)});for(let xb=0;xb<K.length;xb++)Da=this.Zmj(Da,K[xb]);return Da}Zmj(K,Da){const xb=this;return Io(function*(){if(!Da)return m.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),K.then(()=>Promise.reject(xg.t9a(Ui.generalException,Ag.a.instance.ia(1765),null)));switch(Da.actionType){case 1:case 2:K=K.then(()=>{const md=Object(S.a)(di.DdaFacade,rg.a(xb.$));if(md.No(Da.controlId))switch(md.lj.sud(Da),Da.messageType){case 14:case 100:md.HYd.M9b(Da);break;case 11:case 12:md.xIj.Nvb(Da);
break;case 51:case 52:md.vIj.Nvb(Da);break;case 2101:case 2102:md.wIj.Nvb(Da);break;case 2E3:md.yIj.M9b(Da);break;case 2201:xb.$.upa&&md.IYd.X5g(Da);break;case 2203:md.zIj.Y5g(Da);break;case 2700:k.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&md.GYd.M9b(Da);break;case 65541:md.FYd.W5g(Da)}else m.ULS.sendTraceTag(537163171,0,10,`OsfControl with instanceId[${Da.controlId}] doesn't exist.`);return Promise.resolve(null)});break;case 3:K=K.then(()=>{xb.Qmi(Da);return Promise.resolve(null)});
break;case 15:k.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(K=K.then(()=>{xb.Foi(Da);return Promise.resolve(null)}));break;case 4:K=K.then(()=>{var md=ud.h(xb.$).ha.ra.activeCell;md.top!==Da.row+1&&md.left!==Da.column+1&&(md=Re.v(Pg.Range.Je(Da.row+1,Da.column+1),xb.$),ud.h(xb.$).Bj(md,null,null,null,3,"DdaMethodHandler.ShowCard"));xj.a(xb.$,243,242,0,Cd=>{Cd.mkb(Da.row+1,Da.column+1,1,!1,!1)});return Promise.resolve(null)});break;case 7:K=K.then(()=>{Object(S.a)(di.DdaFacade,
rg.a(xb.$)).lj.E_e(Da.controlId,Da.isEnableEvents);return Promise.resolve(null)});break;case 5:K=K.then(()=>xb.Zuh(Da));break;case 6:K=K.then(()=>xb.Mhj(Da));break;case 8:K=K.then(()=>{k.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&Object(S.a)(di.DdaFacade,rg.a(xb.$)).Rgh();const md=new Xj.a(tk.a.$l,5,null);Dj.a(xb.$).zs(md);return Promise.resolve(null)});break;case 9:K=K.then(()=>xb.fPj(Da));break;case 10:K=K.then(()=>xb.dpk(Da));break;case 11:K=
K.then(()=>xb.cpk());break;case 12:K=K.then(()=>xb.$ok());break;case 13:K=K.then(()=>xb.apk(Da));break;case 14:K=K.then(()=>xb.bpk(Da));break;case 16:K=K.then(()=>Promise.resolve(Da));break;case 17:K=K.then(()=>xb.wLj(Da,Object(S.a)(di.DdaFacade,rg.a(xb.$))));break;case 18:ud.h(xb.$).focus();break;case 19:xb.nkf(Da.entryType,!1,Da.options);break;case 20:xb.nkf(Da.entryType,!0,Da.options);break;case 21:const kc=rg.a(xb.$);K=K.then(()=>kc.FYd.wmi(Da));break;case 22:const Nc=rg.a(xb.$);K=K.then(()=>
Nc.FYd.xmi(Da));break;case 23:(Sg.a.OHb(xb.$)||Sg.a.qBa())&&xb.Gf.eag.npi(Da.worksheetId,Da.anchorCell,Da.values,Da.options);break;case 24:(Sg.a.OHb(xb.$)||Sg.a.qBa())&&xb.Gf.eag.Bni(Da.worksheetId);break;default:K=K.then(()=>Promise.reject(xg.t9a(Ui.i3g,Ag.a.instance.ia(1766),null)))}return K})}Foi(K){var Da=Object(S.a)(di.DdaFacade,rg.a(this.$)).No(K.controlId);if(Da&&!(0===K.operationType^!Da.Sha)){ud.h(this.$).pGb=!0;switch(K.operationType){case 0:var xb=new sk.a(document.createElement("input"));
xb.text=K.range;Da.xxi(ud.h(this.$).gj.Dth(xb,new bk.a(this.$)));Da.Sha.startEdit(!0);break;case 1:Da.c6f();this.rangePicker=null;break;case 2:Da.Sha.Jwg(K.range);break;case 3:Da.Sha.Jwg(K.startingRange);Da=K.expandSelection;xb=K.getNextDataRegionCell;let kc=0;switch(K.keyboardDirectionValue){case 2:kc=38;K=Da&&xb?105288353:Da?-31900117:xb?542791952:137938150;break;case 3:kc=40;K=Da&&xb?-1297307319:Da?-1603798598:xb?1713663844:-798660877;break;case 0:kc=37;K=Da&&xb?-403586027:Da?2039316657:xb?-2012742350:
-1470715894;break;case 1:kc=39;K=Da&&xb?784916030:Da?589730764:xb?1324884057:-1231471547;break;default:K=1461300262}Da=this.hdc("keydown",kc,Da,xb);ud.h(this.$).NSb(Da,new Uh.a(K,1,0,8,null))}ud.h(this.$).pGb=!1}}hdc(K,Da,xb,kc){const Nc=document.createEvent("KeyboardEvent");if(Ng.a.dE)Nc.initKeyboardEvent(K,!1,!1,window.self,"A",0,kc,!1,xb,!1);else{let md="";xb&&(md+="Shift");kc&&(md+=0<md.length?" Control":"Control");Nc.initKeyboardEvent(K,!1,!1,window.self,"A",0,md,!1,"en-US")}K=new Sys.UI.DomEvent(Nc);
K.keyCode=Da;return K}Qmi(K){switch(K.operationType){case 1:jh.TaskExtensions.za(F.GetServiceTaskFactory.create(this.$.ga,153,this.$.ka,1),Da=>{Da.result.xXd()},this.$.ka,3);break;case 2:if(K=Object(S.a)(di.DdaFacade,rg.a(this.$)).No(K.controlId))K.nrc=!0,K.f0f()}}Zuh(K){const Da=K.fileBase64;return Da&&Da.length>this.$.xa.CreateWorkbookMaxAllowedBase64Size?Promise.reject(xg.t9a(Ui.invalidArgument,Ag.a.instance.ia(1769),"Application.CreateWorkbook")):(new Promise((xb,kc)=>{const Nc=new bi.StandardDialog;
Nc.Rd=4;Nc.Nm(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,md=>{2!==md&&0!==md||kc(xg.t9a(Ui.dPd,Ag.a.instance.ia(1768),"Application.CreateWorkbook"));md=new Zh("blank","agave",Da?"streamBase64":"streamEmpty",Da);this.LIf.create(xb,kc,md).O6a()})})).then(xb=>{this.Qhc.set(K.fakeFileId,xb);return Promise.resolve(null)},xb=>xb?Promise.reject(xb):Promise.reject(xg.t9a(Ui.generalException,Ag.a.instance.ia(1765),"Application.CreateWorkbook")))}Mhj(K){return new Promise((Da,
xb)=>{if(this.Qhc.has(K.fakeFileId)){const kc=this.Qhc.get(K.fakeFileId);xb=new bi.StandardDialog;xb.Rd=4;xb.Nm(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,Nc=>{1===Nc&&mc.HelperMethods.Sg(kc,void 0,void 0,"DdaMethodHandler.fileUrl");Da(null)})}else xb(xg.t9a(Ui.generalException,Ag.a.instance.ia(1765),"Document.Open"))})}fPj(K){return new Promise(Da=>{Object(S.a)(di.DdaFacade,rg.a(this.$)).fag=K.runtimeCalculationMode;const xb=this.$.ga.Da(268);xb&&
xb.$Kd(3===K.runtimeCalculationMode);Da(null)})}dpk(K){Sg.a.MJb(this.$)&&this.$.ga.Da(331).ljb(0,K.urlStr,!0,!0,null);return Promise.resolve(null)}cpk(){Sg.a.MJb(this.$)&&this.$.ga.Da(331).ljb(1,null,!0,!0,null);return Promise.resolve(null)}$ok(){Sg.a.MJb(this.$)&&this.$.ga.Da(331).B_e();return Promise.resolve(null)}apk(K){Sg.a.MJb(this.$)&&this.$.ga.Da(331).ljb(5,K.urlStr,!0,!0,null);return Promise.resolve(null)}bpk(K){if(Sg.a.MJb(this.$)){const Da=this.$.ga.Da(331);for(const xb of Da.Iea)xb.IsActive&&
xb.HostEditUrl&&xb.UrlStr===K.hostEditUrlStr&&mc.HelperMethods.Sg(xb.HostEditUrl,"_blank")}return Promise.resolve(null)}wLj(K,Da){const xb=Kg.a.oO;K=Fb.a.Fk(K.payload);const kc={};"eventId"in K&&"payload"in K&&(kc.eventId=K.eventId,kc.payload=K.payload);Da.OF(2201,xb,Fb.a.He(kc));return Promise.resolve(null)}nkf(K,Da,xb){const kc=k.EwaSettings.isChangeGateEnabled("OfficeVSO:8010793_ConvertBusinessBarManagerServiceStage2")?ne.a.zg(Nd.m):this.$.ga.Da(5);kc&&(K=this.o3h(K))&&(Da?kc.removeEntry(K):kc.O4c(K,
xb))}o3h(K){switch(K){case 0:return 64;case 1:if(k.EwaSettings.isChangeGateEnabled("OfficeVSO:7109926_MsFormsBusinessBarApi"))return 69}}Y3c(K){K=Object(S.a)(Wj.a,this.$.va.getItemByName(K));(null===K||void 0===K?0:K.visible)&&K.activate({disableAutoFocusOnGrid:!0,scenario:"dda"})}uwg(K,Da,xb,kc){var Nc=K.ra.tt;const md=Nc<Da.length&&Da[Nc].contains(K.ra.activeCell);K=md?K.ra.activeCell:Da[0].topLeft;Nc=md?Nc:0;ud.h(this.$).A2(Da,Nc,xb,null,K,null,null,3,"DdaMethodHandler.UpdateSelection",void 0,
void 0,void 0,6===kc)}static get rwh(){xg.Oua||(xg.Oua={},xg.Oua[Microsoft.Office.WebExtension.CoercionType.Table]=1,xg.Oua[Microsoft.Office.WebExtension.CoercionType.Text]=2,xg.Oua[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,xg.Oua[Microsoft.Office.WebExtension.CoercionType.Html]=4,xg.Oua[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return xg.Oua}static get uwh(){xg.lob||(xg.lob={},xg.lob[Microsoft.Office.WebExtension.FilterType.All]=1,xg.lob[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=
2);return xg.lob}static get vwh(){xg.mob||(xg.mob={},xg.mob[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,xg.mob[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return xg.mob}static Kdf(K){if(!K||!K.length)return null;const Da=Array(K.length/2);for(let xb=0;xb<K.length/2;xb++)Da[xb]={},Da[xb].Name=K[2*xb],Da[xb].Value=K[2*xb+1];return Da}static Qhi(K){if(!K||!K.length)return null;const Da=Array(2*K.length);for(let xb=0;xb<K.length;xb++)Da[2*xb]=K[xb].Name,Da[2*xb+1]=K[xb].Value;
return Da}static Bmd(K){if(!K||!K.length)return null;const Da=Array(K.length);for(let xb=0,kc=K.length;xb<kc;xb++){const Nc=K[xb].length;if(Nc){Da[xb]=Array(Nc);for(let md=0;md<Nc;md++)Da[xb][md]=null==K[xb][md]?null:K[xb][md].toString()}else return null}return Da}static Cbc(K){return"string"===typeof K?Cj.a.Ks(xg.rwh,K,0):K}static f7e(K){return"string"===typeof K?Cj.a.Ks(xg.uwh,K,0):K}static byg(K){return"string"===typeof K?Cj.a.Ks(xg.vwh,K,0):K}static nDi(K){switch(K.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1}static s9c(K,
Da){const xb={};xb.CoerceType=K;1===xb.CoerceType?(xb.Data=xg.Bmd(Da.Rows),xb.Headers=xg.Bmd(Da.Headers)):xb.Data=xg.Bmd(Da);return xb}static qJe(K){return 1===K.CoerceType?{["Headers"]:K.Headers,["Rows"]:K.Data}:K.Data}static spc(K){return 1===K.CoerceType?!K.Data&&!K.Headers:!K.Data}static Zgf(K){let Da="Unknown";if(!K)return Da;for(let xb=0;xb<K.length;xb++)if(K[xb].Name.toLowerCase()===gb.a.AIj){Da=K[xb].Value;break}return Da}static zXj(K){if(!K)return!1;const Da=gb.a.v2i.toLowerCase();for(let xb=
0;xb<K.length;xb++)if(K[xb].Name.toLowerCase()===Da)return!0;return!1}static t9a(K,Da,xb){const kc={};kc.Code=K;kc.Message=Da;kc.Location=xb;kc.ActionIndex=0;return kc}}xg.Oua=null;xg.lob=null;xg.mob=null;xg.TPd=0;Object(f.a)(xg,"DdaMethodHandler",null,[203,5]);class qk extends qh.a{constructor(K){super(K)}Uf(){const K=F.GetServiceTaskFactory.create(this.$.ga,106,this.ka,this.Ta),Da=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateNewAndOpenUX",!1)?Object(uh.d)(ne.a.resolve(Nd.Sb,
{Ja:this.Ta})):F.GetServiceTaskFactory.create(this.$.ga,165,this.ka,this.Ta),xb=Zi(this.ka,this.Ta),kc=Object(uh.d)(ne.a.resolve(Nd.Ab,{Ja:this.Ta}));jh.TaskExtensions.za(jh.TaskExtensions.Wf([K,Da,xb,kc],this.ka),()=>{const md=K.result,Cd=Yg.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");this.Lf([new xg(this.$,md,Cd,kc.result)])},this.ka,3);const Nc=Yg.a.instance;jh.TaskExtensions.za(F.GetServiceTaskFactory.create(this.$.ga,137,this.$.ka,this.Ta),()=>{Nc.register(ve,
"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").Ee().Le(()=>new ve)},this.$.ka)}static la(K){qh.a.qg(82,new qk(K))}}Object(f.a)(qk,"DdaCommandHandlerFactory",qh.a,[]);h.a.Dk(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");(()=>{d.a.Ga(K=>{k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2Services15",!1)||bf.la(K)})})();(()=>{d.a.Ga(K=>{k.EwaSettings.Ea(52)&&
Yi.la(K)})})();(()=>{d.a.Ga(K=>{k.EwaSettings.Ea(114)&&rh.la(K)})})();(()=>{d.a.Ga(K=>{k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2AgaveOnSelectedReadoutHandler",!1)||ii.la(K)});d.a.Ga(ei.la)})();(()=>{d.a.Ga(K=>{Bg.la(K);Ec.la(K)})})();d.a.Ga(qk.la);String(b);String(c);window.___1689695406537_closurehack=b;window.___1689695406537_closurehack=c},1386:function(w,C,a){w=a(0);var b=a(198),c=a(105);class h{constructor(){this.CZe=this.displayName=this.iyb=this.Aq=this.lE=null;this.isUpgraded=
!1}Pwf(d,f){return this.lE.getStoreType().toLowerCase()===d.toLowerCase()&&this.lE.getSolutionId().toLowerCase()===f.toLowerCase()}}Object(w.a)(h,"AddinCommandsResourceItem",null,[]);a.d(C,"a",function(){return k});class k{constructor(){this.mPc=null;this.gUc=0;this.MVc=!1;this.$a=new c.a;this.SKg=new b.a}hYg(d){this.$a.addHandler("AddinCommandsLoadingMessageChanged",d)}nAj(d){this.$a.removeHandler("AddinCommandsLoadingMessageChanged",d)}get Ywa(){return this.mPc}Jjb(d){d!==this.mPc&&(this.mPc=d,
this.$a.raiseEvent("AddinCommandsLoadingMessageChanged"))}aPj(){this.gUc++;this.Ywa||this.Jjb(CommonUIStrings.l_LoadingAddInsTitle)}w0d(){this.gUc--;this.nuc()&&(this.MVc?this.Ywa!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.Jjb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.Jjb(null))}pfg(d){this.MVc=!0;this.Jjb((void 0===d?0:d)?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:CommonUIStrings.l_ErrorLoadingAddInsTitle)}qNe(){this.MVc=!1;this.nuc()?this.Jjb(null):this.Jjb(CommonUIStrings.l_LoadingAddInsTitle)}nuc(){return 0>=
this.gUc}get Mab(){return this.SKg}nna(d,f,u){u=void 0===u?0:u;for(const r of this.Mab)if(r.Pwf(d,f)&&(!r.Aq||r.Aq.O0h===u))return r;return null}xAe(d,f,u,r){const t=new h;t.lE=d;t.Aq=f;t.iyb=u;t.displayName=r;this.Mab.add(t)}iWg(d,f,u,r){const t=new h;t.lE=d;t.Aq=f;t.iyb=null;t.CZe=u;t.displayName=r;this.Mab.add(t)}Kyj(d,f){let u=0;for(const r of this.Mab)r.lE.getStoreType()===d&&r.lE.getSolutionId()===f?this.Mab.removeAt(u):u++}static getInstance(){k.La||(k.La=new k);return k.La}}k.La=null;Object(w.a)(k,
"AddinCommandsResourceManager",null,[])},770:function(w,C,a){a.d(C,"a",function(){return c});w=a(0);var b=a(40);class c{static get pYi(){return c.Gpe||(c.Gpe={["-2002156328"]:c.YOe,["-1954750170"]:c.Chf,["317650254"]:c.Gih,["-1005263101"]:c.Azi,["1353664579"]:c.DMj,["159671765"]:c.Bzi,["1446690022"]:c.ccf,["1150069548"]:c.SLc,["-1409306331"]:c.RLe,["338507772"]:c.rVe,["-457159301"]:c.Gij,["-1037701970"]:c.Rvh,["-1893322318"]:c.Gzi,["965579896"]:c.Tvh,["93287890"]:c.Svh,["358088857"]:c.UPj,["-1223650923"]:c.rVe,
["2007306190"]:c.Eeh,["1549955423"]:c.wIe,["-1275974171"]:c.Fzi,["382101082"]:c.Qhj,["-898776235"]:c.ZZi,["335464256"]:c.QZi,["1677378049"]:c.Ezi,["-261992848"]:c.dfk,["-980820954"]:c.wIe,["-931375837"]:c.Phj,["929186550"]:c.TDh,["-982144310"]:c.eqj,["-785741187"]:c.yzi,["2125217573"]:c.Izi,["299124955"]:c.zzi,["1669853884"]:c.NIj,["-1515932330"]:c.Hih,["314621024"]:c.pYh,["-300049690"]:c.Ieh,["14766835"]:c.dVj,["-1251992761"]:c.EYe,["-2087635043"]:c.invalidOrTimedOutSession,["2100961153"]:c.invalidOrTimedOutSession,
["-1218744139"]:c.invalidSheetName,["-1468309555"]:5006,["-315732528"]:c.invalidOrTimedOutSession,["611268539"]:c.invalidOrTimedOutSession,["1531005923"]:5006,["1593924569"]:5006,["299476328"]:c.IKa,["49173765"]:c.IKa,["-907155566"]:c.IKa,["-1201603824"]:c.IKa,["1541165282"]:c.IKa,["-1347753427"]:c.IKa,["134912532"]:c.IKa,["1780971550"]:c.responsePayloadSizeLimitExceeded})}static E9e(h){return b.a.Ks(c.pYi,h.toString(),c.internalError)}}c.success=0;c.YOe=1E3;c.Chf=1001;c.Gih=1002;c.Azi=1003;c.DMj=
1004;c.Bzi=1005;c.ccf=1008;c.T6e=1009;c.invalidSheetName=1014;c.SLc=2E3;c.RLe=2001;c.rVe=2002;c.Gij=2003;c.Rvh=2004;c.Gzi=2005;c.Tvh=2007;c.Svh=2008;c.UPj=2009;c.Eeh=2014;c.uMj=3E3;c.wIe=3002;c.Fzi=3004;c.Qhj=3005;c.ZZi=3006;c.QZi=3007;c.Ezi=3008;c.dfk=3009;c.Phj=3010;c.dVj=4002;c.iPd=5E3;c.internalError=5001;c.EYe=5002;c.UGb=5004;c.igk=5007;c.dui=5008;c.t9f=5011;c.invalidOrTimedOutSession=5012;c.jOc=5016;c.IKa=5102;c.IFj=5103;c.responsePayloadSizeLimitExceeded=5104;c.ceh=7001;c.Bmg=7002;c.TDh=8E3;
c.eqj=8001;c.yzi=8010;c.Izi=8011;c.zzi=8012;c.NIj=8020;c.Hih=8021;c.pYh=8022;c.Ieh=8023;c.WXi=11E3;c.P_i=11001;c.Hzi=11002;c.Gpe=null;Object(w.a)(c,"DdaErrorIds",null,[])},771:function(w,C,a){a.d(C,"a",function(){return h});w=a(0);var b=a(14),c=a(113);class h{constructor(){this.MUd=0;this.QZ={};this.Sxa={}}Mci(k,d){return this.QZ[h.v9c(k,d)]}E_e(k,d){d||void 0!==this.Sxa[k]&&null!==this.Sxa[k]?d&&void 0!==this.Sxa[k]&&null!==this.Sxa[k]&&delete this.Sxa[k]:this.Sxa[k]=1}r9b(k){return void 0===this.Sxa[k]||
null===this.Sxa[k]}sud(k){const d=h.v9c(k.messageType,k.targetId);1===k.actionType?this.Koi(k.controlId,k.messageType,d):2===k.actionType&&this.Dpi(k.controlId,k.messageType,d)}qzj(k){if(k){var d=Object.keys(this.QZ);if(!(void 0===d||null===d||0>=d.length))for(const f of d)d=this.QZ[f],d[k]&&(delete d[k],Object.keys(d).length||delete this.QZ[f])}}RK(k,d){k=h.v9c(k,d);k=this.QZ[k];return!!k&&0<Object.keys(k).length}Aqi(){return!c.a.isEmpty(this.QZ)}Oxf(){return 0<this.MUd}E7h(){const k=[],d=this.QZ;
for(let r in d){var f=r,u=d[r];for(let t in u){u=t;const v={};v.eventType=parseInt(f.split("#")[0],10);v.targetId=f.split("#")[1];v.addinId=u;k.push(v)}}return k}Koi(k,d,f){if(this.QZ[f])f=this.QZ[f],f[k]=f[k]?f[k]+1:1;else{let u={};u[k]=1;this.QZ[f]=u}100===d&&this.MUd++}Dpi(k,d,f){if(this.QZ[f]){const u=this.QZ[f];if(k){const r=u[k];1===r?(delete u[k],Object.keys(u).length||delete this.QZ[f]):u[k]=r-1;100===d&&this.MUd--}else b.ULS.sendTraceTag(537170459,0,50,`The OsfControl[${k}] doesn't register event with key[${f}].`)}else b.ULS.sendTraceTag(537170460,
0,50,`The event with key[${f}] that will be unregistered doesn't exist.`)}static v9c(k,d){return String.format("{0}#{1}",k,d)}}h.oO="Workbook";Object(w.a)(h,"RichApiEventRegistration",null,[])},772:function(w,C,a){a.d(C,"a",function(){return b});w=a(0);class b{}b.generalException="GeneralException";b.invalidArgument="InvalidArgument";b.notImplemented="NotImplemented";b.t3c="AccessDenied";b.notSupported="NotSupported";b.apiNotAvailable="ApiNotAvailable";b.notAllowed="NotAllowed";b.dPd="OperationCancelled";
b.userNotSignedIn="UserNotSignedIn";b.userAborted="UserAborted";b.lgk="UnsupportedUserIdentity";b.invalidResourceUrl="InvalidResourceUrl";b.invalidGrant="InvalidGrant";b.o1g="AddinIsAlreadyRequestingToken";b.jHj="ResourceNotAllowed";b.clientError="ClientError";b.serverError="ServerError";b.vmh="ControlIdNotFound";b.WHj="RibbonApiNotAvailable";b.hostRestartNeeded="HostRestartNeeded";b.invalidRibbonDefinition="InvalidRibbonDefinition";b.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(w.a)(b,
"ErrorCodes",null,[])},775:function(w,C,a){a.r(C);var b=a(0),c=a(2),h=a(14),k=a(1231),d=a(79),f=a(105);class u{constructor(Q,Ia,ub){this._id=Q;this.KEg=Ia;this.UGg=ub;this.$qf=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get n1g(){return this.KEg}get hjh(){return this.UGg}execute(Q,Ia,ub){ub=ub||{};ub.commandMode=this.$qf;Ia.invokeAppCommand(this.n1g,this.hjh,ub,()=>{Q.obj(this.id)})}}Object(b.a)(u,"AddinNativeActionBase",null,[790]);class r extends u{constructor(Q,Ia){super(1,Q,Ia);
this.$qf=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(b.a)(r,"AddinTakeSnapshotAction",u,[]);class t{boh(Q){return new u(3,Q,this.x1h().getNativeActionName(3))}x1h(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(b.a)(t,"AddinNativeActionManager",null,[780]);var v=a(151);class x{invokeAppCommand(Q,Ia,ub,Yb){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Q,Ia,ub,Yb)}static getInstance(){x.La||(x.La=new x);return x.La}}x.La=null;Object(b.a)(x,"OSFAddinCommandsRuntimeManager",
null,[781]);var m=a(5),l=a(194),n=a(32);class z extends v.a{constructor(Q,Ia,ub){super();this.Rca=null;this.r2c="WACDialogTitleText";this.X_="0";this.Vba="15px";this.lHg="0px";this.W_="calc(100% - 30px)";this.kHg="100%";this.kte=0;this.$a=new f.a;this.MEg=new t;this.Rd=5;this.ug=this.gIa=ub;this.wSc=Q;this.Whe=Ia;this.NSc=!!m.AFrameworkApplication.da&&m.AFrameworkApplication.da.pa("OfficeAddinEnableInsertDialogAccessibilityFix")}B_g(Q){this.$a.addHandler("OnDialogClosedEventKey",Q)}aSj(){this.sJa=
null}yz(){super.yz();this.Wj.style.width="100%";this.Wj.style.height=this.wFb?this.W_:this.kHg;this.Wj.style.marginTop=this.wFb?this.Vba:this.lHg;this.Wj.style.padding=this.X_}AG(){super.AG();this.nd.style.width=String.format("{0}px",this.wSc*window.innerWidth/100);this.nd.style.height=String.format("{0}px",this.Whe*window.innerHeight/100);this.nd.style.minWidth="0px";this.NSc&&m.AFrameworkApplication.isRtl&&100===this.wSc&&(this.nd.style.right="0px",this.nd.style.marginRight="0px");this.Rca=document.getElementById(this.Rj(this.r2c));
this.Rca.style.position="absolute";this.Rca.style.whiteSpace="nowrap";this.Rca.style.textOverflow="ellipsis";m.AFrameworkApplication.isRtl?(this.Rca.style.right="14px",this.Rca.style.left="44px"):(this.Rca.style.right="44px",this.Rca.style.left="14px")}lB(Q){super.lB(Q);this.Rca&&this.Rca.setAttribute("title",Q)}get rea(){return this.Wj}DXd(){this.nd.style.width=String.format("{0}px",this.wSc*window.innerWidth/100);this.nd.style.height=String.format("{0}px",this.Whe*window.innerHeight/100);this.nd.style.overflowY=
"hidden";this.nd.style.overflowX="hidden";this.nd.style.marginTop="";this.nd.style.top="";n.a.TY&&m.AFrameworkApplication.isRtl?(this.nd.style.right="",this.nd.style.marginRight=""):(this.nd.style.left="",this.nd.style.marginLeft="")}hide(){this.MEg.boh(this.gIa).execute(this,x.getInstance(),{});this.kte=window.setTimeout(()=>{this.$a.raiseEvent("OnDialogClosedEventKey",this.gIa);l.a.prototype.hide.call(this)},500)}obj(Q){3===Q&&(window.clearTimeout(this.kte),this.$a.raiseEvent("OnDialogClosedEventKey",
this.gIa),super.hide())}}Object(b.a)(z,"AppsForOfficeDialog",v.a,[765,766]);class y{constructor(){this.dialog=this.ug=null}}Object(b.a)(y,"DialogInfo",null,[]);class B{}B.url="url";B.height="height";B.width="width";B.phd="displayInIframe";B.Gnc="hideTitle";Object(b.a)(B,"DialogSettings",null,[]);class G{constructor(){this.height=this.width=0;this.ug=this.controlId=this.pageUrl=null;this.Gnc=this.phd=!1}}Object(b.a)(G,"DisplayDialogParams",null,[]);class E extends Sys.EventArgs{constructor(Q,Ia,ub,
Yb,Ca){ub=void 0===ub?null:ub;Yb=void 0===Yb?"":Yb;Ca=void 0===Ca?"":Ca;super();this.controlId=Q;this.messageType=Ia;this.messageContent=ub;this.messageOrigin=Yb;this.targetOrigin=Ca}}Object(b.a)(E,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class J extends Sys.EventArgs{constructor(Q,Ia,ub,Yb,Ca){ub=void 0===ub?null:ub;Yb=void 0===Yb?"":Yb;Ca=void 0===Ca?"":Ca;super();this.controlId=Q;this.messageType=Ia;this.messageContent=ub;this.messageOrigin=Yb;this.targetOrigin=Ca}}Object(b.a)(J,"OnMessageParentEventArgs",
Sys.EventArgs,[]);var I=a(42),R=a(31),X=a(175),H=a(106);class M{constructor(Q){this.$a=new f.a;this.Wl=Q}J_g(Q){this.$a.addHandler("OnMessageParentEventKey",Q)}I_g(Q){this.$a.addHandler("OnMessageDialogEventKey",Q)}showDialog(Q,Ia,ub,Yb){if(M.Iba.kd(Ia))h.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),ub(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const De=I.b(Q),Ye=De[B.url];if(this.Wl.getOsfControl(Ia).checkAppDomains(Ye)){var Ca=
new G;Ca.width=De[B.width];Ca.height=De[B.height];Ca.pageUrl=Ye;Ca.phd=De[B.phd];Ca.Gnc=De[B.Gnc];Ca.controlId=Ia;Ca.ug=X.a.create().toString();var tb=new y;tb.ug=Ca.ug;var $b=this.Wl.getOsfControl(Ca.controlId).getManifest().getDefaultDisplayName(),cd=this.Wl.getOsfControl(Ca.controlId).getStoreType().toLowerCase();Q=null;Q=(4===m.AFrameworkApplication.sa.Ra.kj&&"hardcodedpreinstall"===cd||"sdxcatalog"===cd)&&Ca.Gnc?this.createAndShowAppsForOfficeDialog(Ca.width,Ca.height,Ca.ug,!0,$b):this.createAndShowAppsForOfficeDialog(Ca.width,
Ca.height,Ca.ug,!1,$b);var sd=this.Wl.getOsfControl(Ca.controlId),re=sd.getManifest();Ia={};Ia.id=Ca.ug;Ia.solutionId=sd.getSolutionId();Ia.version=sd.getVersion();Ia.storeType=cd;Ia.storeId=sd.getStoreId();Ia.assetId=sd.getAssetId();Ia.assetStoreId=sd.getAssetStoreId();Ia.ownerAddinSolutionId=sd.getOwnerAddinSolutionId();Ia.ownerAddinStoreType=sd.getOwnerAddinStoreType();Ia.appDomains=re.getAppDomains();Ia.dialogUrl=Ye;Ia.osfControlType=1;Ia.agaveName=$b;Ia.div=Q.rea;h.ULS.sendTraceTag(542978531,
344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Ia.solutionId,Ia.ownerAddinStoreType||Ia.storeType,Ia.assetId,null,null,Ia.storeId),R.a.Ly(Ca.pageUrl));this.Wl.insertDialogControl(Ia);Q.B_g(Object(d.a)(this,this.t6i,"onDialogClosed"));tb.dialog=Q;M.Iba.fa(Ca.controlId,tb);Yb&&Yb(Ia);ub(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else h.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),ub(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(De){h.ULS.sendTraceTag(18371104,
344,10,"ShowDialog: action failed. Exception message: {0}",De.message),ub(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}rYi(Q,Ia,ub,Yb){m.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===Yb&&(Yb=ub);try{const Ca=this.FPa(Q);Ca&&this.$a.raiseEvent("OnMessageParentEventKey",new J(Ca,OSF.DialogMessageType.DialogMessageReceived,Ia,ub,Yb))}catch(Ca){return h.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",
Ca.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Ixb(Q,Ia){if(M.Iba.kd(Q))try{const ub=M.Iba.ma(Q);ub.dialog&&ub.dialog.hide();this.Wl.purgeDialogControl(ub.ug);M.Iba.remove(Q);Ia(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(ub){h.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",ub.message),Ia(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else h.ULS.sendTraceTag(18896286,344,
10,"CloseDialog: agave dialog map does not has dialog info for this control."),Ia(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}oNj(Q,Ia,ub,Yb){m.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===Yb&&(Yb=ub);if(M.Iba.kd(Q)&&(Q=M.Iba.ma(Q),Q.dialog))try{this.$a.raiseEvent("OnMessageDialogEventKey",new E(Q.ug,OSF.DialogMessageType.DialogParentMessageReceived,Ia,ub,Yb))}catch(Ca){h.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",
Ca.message)}}FPa(Q){let Ia=null;for(const ub of M.Iba)if(ub.value.ug===Q){Ia=ub.key;break}return Ia}t6i(Q,Ia){if(Q=this.FPa(Ia))this.Wl.purgeDialogControl(Ia),M.Iba.remove(Q),this.$a.raiseEvent("OnMessageParentEventKey",new J(Q,OSF.DialogMessageType.DialogClosed,null,null,"*"))}createAndShowAppsForOfficeDialog(Q,Ia,ub,Yb,Ca){Q=new z(Q,Ia,ub);Ca=Yb?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Ca);Yb&&(Q.wFb=!1,Q.hw=!1);Q.initializeAndShow(Ca,null,null);Q.aSj();return Q}static Pki(){return M.Iba}static getInstance(Q){M.La||
(M.La=new M(Q));return M.La}}M.La=null;M.Iba=new H.a;Object(b.a)(M,"AppsForOfficeDialogManager",null,[743]);var O=a(903),L=a(712),S=a(563),T=a(198),V=a(387),la=a(919);class Z{constructor(){this.AUP=this.priority=0}}Object(b.a)(Z,"AddinDetailInfo",null,[]);class da{constructor(Q){this.solutionIds=null;this.errorCode=0;this.failure=null;this.mT=Q}}Object(b.a)(da,"AddinCollection",null,[]);class ba extends Sys.EventArgs{constructor(Q,Ia,ub,Yb){Yb=void 0===Yb?null:Yb;super();this.lH=Q;this.errorCode=
Ia;this.JB=ub;this.failure=Yb}}Object(b.a)(ba,"AddinDetailsRefreshedEventArgs",Sys.EventArgs,[]);class na{constructor(Q){this.errorCode=Q;this.JB=[];this.failure=null}}Object(b.a)(na,"GetAddinDetailsResult",null,[]);var Y=a(753),Ga=a(837);class ma{}Object(b.a)(ma,"GetEntitlementDetailsParameters",null,[]);var fa=a(267),Xa=a(264),Ua=a(114),ka=a(217),nb=a(212),Ea=a(85);class sb{constructor(Q,Ia,ub){ub=void 0===ub?null:ub;this.$a=new f.a;this.er=new L.a(S.a.Fh());this.ml=new V.a;this.KJ=this.GS=this.DS=
null;this.IW=new nb.a;this.IW.add(OSF.StoreTypeEnum.MarketPlace,0);this.IW.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Oa=Q;this.Wl=Ia;this.Nt=ub;this.Gpb=sb.LDb(Q,"https://store-images.s-microsoft.com");this.Twa(Object(d.a)(this,this.zqa,"onAddinDetailsRefreshed"))}get zza(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get VHb(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get Vg(){return this.Wl.value}A8(Q){if(!this.j9(Q))return Q=
Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:la.a[Q]}),Object.assign(new na(1),{failure:Q});if(this.ml.ma(Q).failure)return Object.assign(new na(this.ml.ma(Q).errorCode),{failure:this.ml.ma(Q).failure});h.ULS.shipAssertTag(509870082,220,!!this.ml.ma(Q).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Q);const Ia=new na(0);for(const ub of this.ml.ma(Q).solutionIds)this.er.kd(ub)&&Array.add(Ia.JB,this.er.ma(ub));
return Ia}z9a(Q){return this.er.kd(Q)?this.er.ma(Q):null}Qhb(Q){if(Q){this.Twa(Q);for(const ub of this.ml.keys)if(this.j9(ub)&&!this.ml.ma(ub).failure){h.ULS.shipAssertTag(509870081,220,!!this.ml.ma(ub).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",ub);var Ia=[];for(const Yb of this.ml.ma(ub).solutionIds)Array.add(Ia,this.er.ma(Yb));Ia=new ba(ub,this.ml.ma(ub).errorCode,Ia);Q(null,Ia)}}}RQb(){}AC(Q,Ia){Ia=void 0===Ia?!1:Ia;0!==Q&&10!==Q?h.ULS.sendTraceTag(509870080,
220,50,"QueryAddinDetails: skipping providerType: {0}.",Ga.a[Q]):this.iQb(Q,Object(d.a)(this,this.AUa,"onQueryAddinDetailsCompleted"),Ia)}Twa(Q){this.$a.addHandler(Y.a.S3a,Q)}AUa(Q,Ia,ub){if(ub)if(sb.gLb(Q,ub,window.performance.now()-Ia),0===ub.errorCode){let Ca;if(ub.value){let tb=0;Ca=Array(ub.value.length);ub.value.forEach($b=>{Ca[tb++]=$b})}else Ca=[];this.jy(Q,Ca)}else if(-1===ub.errorCode||10===ub.errorCode)this.jy(Q,[]);else{var Yb={};Yb.collectionType=la.a[Q];Yb.invokeResultCode=ub.errorCode;
Yb["queryResult.Value"]=ub.value?String.format("Length: {0}",ub.value.length):"null";Yb.queryStart=Ia;Yb.queryDuration=window.performance.now()-Ia;this.ml.fa(Q,Object.assign(new da(Q),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",Yb)}));h.ULS.sendTraceTag(512231324,220,15,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",la.a[Q],this.ml.ma(Q).failure.toString(),JSON.stringify(this.ml.ma(Q).failure))}else Yb=
{},Yb.collectionType=la.a[Q],Yb.queryResult=ub?"not null":"null",Yb.queryStart=Ia,Yb.queryDuration=window.performance.now()-Ia,this.ml.fa(Q,Object.assign(new da(Q),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",Yb)})),h.ULS.sendTraceTag(512231323,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",la.a[Q],this.ml.ma(Q).failure.toString(),JSON.stringify(this.ml.ma(Q).failure))}Tud(Q){const Ia={};
Ia.collectionType=la.a[Q];this.ml.fa(Q,Object.assign(new da(Q),{errorCode:2,failure:Error.create("The store is disabled.",Ia)}));h.ULS.sendTraceTag(510253056,220,50,"Fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",la.a[Q],this.ml.ma(Q).failure.toString(),JSON.stringify(this.ml.ma(Q).failure))}kYj(){return this.j9(2)?this.Oa.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?!!this.ml.ma(2).failure:!1:!0}iQb(Q,Ia,ub){ub=void 0===ub?!1:ub;
h.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",Q);Q!==OSF.StoreTypeEnum.MarketPlace&&Q!==OSF.StoreTypeEnum.PrivateCatalog?h.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",Q):(this.kYj()&&(this.Nmd&&this.q3d&&sb.LZd(this.solutionIds,this.Vg.getAppUILocale()),this.queryStoreDisabled(0,(Yb,Ca)=>{Ca?this.Tud(2):(Yb=window.performance.now(),Ia(2,Yb,this.Urd()))})),this.queryStoreDisabled(Q,(Yb,Ca)=>{if(Yb===OSF.StoreTypeEnum.MarketPlace&&Ca)this.Tud(0);
else if(Yb===OSF.StoreTypeEnum.PrivateCatalog&&Ca)this.Tud(1);else{var tb=window.performance.now();this.Vg.getEntitlementDetails(Object.assign(new ma,{storeType:Yb,refresh:ub}),$b=>{Ia(this.IW.ma(Yb),tb,$b)})}}))}jy(Q,Ia){Q=new ba(Q,0,Ia);this.$a.raiseEvent(Y.a.S3a,Q)}zqa(Q,Ia){Q=Object.assign(new da(Ia.lH),{solutionIds:new T.a});var ub=Ia.JB;for(const Yb of ub)ub=Yb.solutionId,this.er.kd(ub)?this.er.fa(ub,this.ZLb(this.er.ma(ub),Ia.lH,Yb)):this.er.add(ub,Yb),Q.solutionIds.add(ub);this.ml.fa(Ia.lH,
Q)}j9(Q){return this.ml.kd(Q)?!!this.er:!1}get vvb(){return this.Nt?!this.Nt.AreThirdPartyAddInsAllowed||this.Nt.AppsForOfficeThirdPartyIsDisabled:!this.Oa.pa("AreThirdPartyAddInsAllowed")||this.Oa.pa("AppsForOfficeThirdPartyIsDisabled")}get zIb(){return this.Nt?!this.Nt.AppsForOfficeAllowExternalMarketplace:!this.Oa.pa("AppsForOfficeAllowExternalMarketplace")}get kha(){return this.Nt?this.Nt.PopularAddinDetailsJsonString:this.Oa.Sa("PopularAddinDetailsJsonString")}queryStoreDisabled(Q,Ia){if(this.vvb)Ia(Q,
!0);else if(Q===OSF.StoreTypeEnum.MarketPlace&&this.zIb)Ia(Q,!0);else{const ub=sb.eXb(Q);if(ub){const Yb=window.performance.now();this.Vg.queryStoreDisabled(ub,Ca=>{h.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",Q,Ca,Yb,window.performance.now()-Yb);Ia(Q,Ca)})}else Ia(Q,!1)}}ZLb(Q,Ia,ub){if(!Q)return ub;if(!ub)return Q;if(this.zza)return 2===Ia?sb.MCa(ub,Q):sb.MCa(Q,ub);if(2===Ia)return Q.addinInfo=ub.addinInfo,Q;ub.addinInfo=
Q.addinInfo;return ub}Urd(){if(!this.DS){const Q=JSON.parse(this.kha);this.XBb(Q);this.DS=Q}return sb.bMa(0,this.DS)}XBb(Q){this.zza&&sb.lvb(Q);this.p4a(Q);this.YBb(Q)}p4a(Q){const Ia=this.swb();for(var ub=0;ub<Q.length&&0<Ia.count;ub++){const Yb=Q[ub];if(Ia.kd(Yb.solutionId)){let Ca=String.format("Found an override, solutionId: {0}",Yb.solutionId);const tb=Ia.ma(Yb.solutionId);tb&&(isNaN(tb.addinInfo.priority)||(Ca=String.format("{0}; AddinInfo.Priority: update {1} to {2}",Ca,Yb.addinInfo.priority,
tb.addinInfo.priority),Yb.addinInfo.priority=tb.addinInfo.priority),isNaN(tb.addinInfo.AUP)||(Ca=String.format("{0}; AddinInfo.AUP: update {1} to {2}",Ca,Yb.addinInfo.AUP,tb.addinInfo.AUP),Yb.addinInfo.AUP=tb.addinInfo.AUP),tb.displayName&&(Ca=String.format("{0}; DisplayName: update {1} to {2}",Ca,Yb.displayName,tb.displayName),Yb.displayName=tb.displayName),tb.iconUrl&&(Ca=String.format("{0}; IconUrl: update {1} to {2}",Ca,Yb.iconUrl,tb.iconUrl),Yb.iconUrl=tb.iconUrl),tb.description&&(Ca=String.format("{0}; Description: update {1} to {2}",
Ca,Yb.description,tb.description),Yb.description=tb.description));Ia.remove(Yb.solutionId);this.VHb&&h.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",Ca)}}for(const Yb of Ia.keys)ub=Ia.ma(Yb),ub.displayName&&ub.iconUrl&&ub.addinInfo&&(Q.push(ub),this.VHb&&h.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(ub)))}swb(){const Q=new L.a(S.a.Fh());let Ia=this.Oa.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins",
"");if(!Ia)return Q;Ia=Ia.trim();if(12>=Ia.length)return 0<Ia.length&&h.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",Ia),Q;this.VHb&&h.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",Ia);try{const ub=[],Yb=Ia.split("|");for(let Ca=Yb.length-1;0<=Ca;Ca--){const tb=Yb[Ca],$b=tb.split("\\");if(2>$b.length){ub.push(tb);continue}const cd=sb.hPb($b);cd?Q.kd(cd.solutionId)||Q.add(cd.solutionId,cd):ub.push(tb)}this.VHb&&
0<ub.length&&h.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",ub.join("|"));this.VHb&&0<Q.count&&h.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",Q.count,JSON.stringify(Ea.toArray(Q.values)));return Q}catch(ub){h.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",Ia,ub.toString())}return Q}YBb(Q){for(let Ia=0;Ia<Q.length;Ia++)Ua.c(Q[Ia].iconUrl.toLowerCase(),
"http",0)||(Q[Ia].iconUrl=String.format("{0}/image/apps.{1}",this.Gpb,Q[Ia].iconUrl))}get Nmd(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutSearchAddinDetails",!1)}get q3d(){return!fa.a.MVa(9)}get solutionIds(){if(!this.GS){this.GS=new T.a;for(const Q of this.BPb.keys)this.GS.add(Ua.d(Q))}return this.GS.toArray()}get BPb(){if(!this.KJ){this.KJ=new L.a(S.a.Fh());const Q=JSON.parse(this.kha);for(const Ia of Q)this.KJ.add(Ia.solutionId,Ia.addinInfo)}return this.KJ}static gLb(Q,
Ia,ub){const Yb={};Yb.AddinCollectionType=la.a[Q];Yb.ErrorCode=Ia.errorCode;Yb.AddinCount=Ia.value?Ia.value.length:0;h.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",ub,JSON.stringify(Yb))}static bMa(Q,Ia){const ub={};ub.errorCode=Q;ub.value=Ia;return ub}static eXb(Q){return Q===OSF.StoreTypeEnum.MarketPlace?"omex":Q===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static MCa(Q,Ia){Ia.solutionId=Ia.solutionId||Q.solutionId;Ia.version=
Ia.version||Q.version;Ia.storeType=Ia.storeType||Q.storeType;Ia.storeId=Ia.storeId||Q.storeId;Ia.assetId=Ia.assetId||Q.assetId;Ia.assetStoreId=Ia.assetStoreId||Q.assetStoreId;Ia.displayName=Ia.displayName||Q.displayName;Ia.provider=Ia.provider||Q.provider;Ia.description=Ia.description||Q.description;Ia.iconUrl=Ia.iconUrl||Q.iconUrl;Ia.webApplicationId=Ia.webApplicationId||Q.webApplicationId;Ia.highResolutionIconUrl=Ia.highResolutionIconUrl||Q.highResolutionIconUrl;Ia.licenseUrl=Ia.licenseUrl||Q.licenseUrl;
Ia.privacyUrl=Ia.privacyUrl||Q.privacyUrl;Ia.addinInfo=Ia.addinInfo||Q.addinInfo;isNaN(Ia.targetType)&&(Ia.targetType=Q.targetType);isNaN(Ia.height)&&(Ia.height=Q.height);isNaN(Ia.width)&&(Ia.width=Q.width);return Ia}static lvb(Q){for(const Ia of Q)isNaN(Ia.targetType)&&(Ia.targetType=1),Ia.assetId=Ia.assetId||Ia.solutionId,Ia.storeId=Ia.storeId||"en-US",Ia.storeType=Ia.storeType||"omex",Ia.assetStoreId=Ia.assetStoreId||"omex",isNaN(Ia.width)&&(Ia.width=0),isNaN(Ia.height)&&(Ia.height=0)}static hPb(Q){const Ia=
{};let ub=0;ub<Q.length&&0<Q[ub].trim().length&&Q[ub].trim().toLowerCase().startsWith("wa")&&(Ia.solutionId=Q[ub].trim(),Ia.addinInfo=Object.assign(new Z,{priority:Number.NaN,AUP:Number.NaN}),++ub<Q.length&&0<Q[ub].trim().length&&(Ia.addinInfo.priority=parseInt(Q[ub].trim())),++ub<Q.length&&0<Q[ub].trim().length&&(Ia.addinInfo.AUP=parseInt(Q[ub].trim())),++ub<Q.length&&0<Q[ub].trim().length&&(Ia.displayName=Q[ub].trim()),++ub<Q.length&&0<Q[ub].trim().length&&(Ia.iconUrl=Q[ub].trim()),++ub<Q.length&&
0<Q[ub].trim().length&&(Ia.description=Q[ub].trim()));return Ia.solutionId?Ia:null}static LDb(Q,Ia){Q=Q.Sa("AddinImageStoreServiceUrl");if(!Q)return Ia;Q=Q.toLowerCase();return Q.startsWith("http://")||Q.startsWith("https://")?Q:Ia}static LZd(Q,Ia){if(Q&&Q.length){new na(0);var ub=new Xa.QueryStringBuilder("api/addins/search");ub.mj("apiversion","1.0");ub.mj("assetids",Q.join(","));ub.mj("client","Word");ub.mj("ui",Ia);ub.mj("cv",m.AFrameworkApplication.buildVersion);Q=String.format("{0}{1}","https://api.addins.omex.office.net/",
ub.toString());var Yb=window.performance.now(),Ca=sb.executeRequest(Q,1,"SearchAddinDetails");Ca.continueWith(()=>{if(Ca.qj)var tb="query canceled";else Ca.Kh?tb="query failed (exception)":Ca.result?(tb=Ca.result,tb=void 0===tb.qh||null===tb.qh?"query failed (response.Args is null or undefined)":void 0===tb.qh.data||null===tb.qh.data?"query failed (response.Args.Data is null or undefined)":tb.qh.data.httpStatus!==ka.a.PE?"query failed (response.Args.Data.HttpStatus != HttpStatusCode.OK_200)":"query succeeded"):
tb="query failed (responseTask.Result is null)";const $b=window.performance.now()-Yb;h.ULS.sendTraceTag(508610433,220,15,"SearchAddinDetails: response received, time elapsed: {0}, result: {1}",$b,tb)});h.ULS.sendTraceTag(508610432,220,15,"SearchAddinDetails: request was just sent")}}static executeRequest(Q,Ia,ub,Yb,Ca){return m.AFrameworkApplication.tf.Pwa(Q,Ia,void 0===Ca?null:Ca,void 0===Yb?null:Yb,ub,null,!1,null,6E4)}}Object(b.a)(sb,"AddinDetailsManager",null,[735,736]);class Oa{constructor(Q,
Ia){this.failure=null;this.mT=Q;this.errorCode=void 0===Ia?0:Ia}}Object(b.a)(Oa,"AddinQueryResult",null,[]);class La extends Oa{constructor(Q,Ia){super(Q,void 0===Ia?0:Ia);this.solutionIds=null}}Object(b.a)(La,"AddinCollection",Oa,[]);var ia;(function(Q){Q[Q.stop=-1]="stop";Q[Q.skip=0]="skip";Q[Q.query=1]="query"})(ia||(ia={}));Object(b.b)("QueryStrategy",ia);var Sa=a(921);class Za{constructor(Q,Ia,ub){ub=void 0===ub?null:ub;this.$a=new f.a;this.er=new L.a(S.a.Fh());this.ml=new V.a;this.fP=new V.a;
this.KJ=this.GS=this.DS=null;this.IW=new nb.a;this.IW.add(OSF.StoreTypeEnum.MarketPlace,0);this.IW.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Oa=Q;this.Wl=Ia;this.Nt=ub;this.Gpb=Za.LDb(Q,"https://store-images.s-microsoft.com");this.Twa(Object(d.a)(this,this.zqa,"onAddinDetailsRefreshed"))}get GSd(){return!!this.Oa&&this.Oa.isChangeGateEnabled("QueryPopularForOmexOnlyEnabled")}get PF(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}get isAnonymousUser(){return!!this.Oa&&
this.Oa.pa("IsAnonymousUser")}get Pmd(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNoMailboxFixEnabled",!0)}get lCb(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNotSignedInFixEnabled",!0)}get zza(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get t8(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get Vg(){return this.Wl.value}A8(Q){if(this.PF&&
!this.Voa(Q))return new na(0);if(!this.j9(Q))return Q=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:la.a[Q]}),Object.assign(new na(1),{failure:Q});if(this.ml.ma(Q).failure)return Object.assign(new na(this.ml.ma(Q).errorCode),{failure:this.ml.ma(Q).failure});h.ULS.shipAssertTag(509870082,220,!!this.ml.ma(Q).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Q);const Ia=new na(0);for(const ub of this.ml.ma(Q).solutionIds)this.er.kd(ub)&&
Array.add(Ia.JB,this.er.ma(ub));return Ia}z9a(Q){return this.er.kd(Q)?this.er.ma(Q):null}Qhb(Q){if(Q){this.Twa(Q);for(const Ia of this.ml.keys){if(this.PF&&!this.Voa(Ia))continue;if(!this.j9(Ia)||this.ml.ma(Ia).failure)continue;h.ULS.shipAssertTag(509870081,220,!!this.ml.ma(Ia).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Ia);const ub=[],Yb=this.ml.ma(Ia);for(const Ca of Yb.solutionIds)Array.add(ub,this.er.ma(Ca));Q(null,new ba(Ia,Yb.errorCode,
ub,Yb.failure))}}}RQb(Q,Ia){if(this.PF&&Za.ESa(Q)){var ub=Ca=>{this.jy(Za.aMa(Ca,4,"The connected service is disabled."));this.oaa(Ca,-1)},Yb=Ca=>{this.jy(Za.aMa(Ca,0,"The user doesn't have any addin installed."),[]);this.oaa(Ca,0)};0===Q?(this.DGb(0,Ia,ub,Yb),this.DGb(2,Ia,ub,()=>{this.kQb(Object(d.a)(this,this.AUa,"onQueryAddinDetailsCompleted"))})):10===Q&&this.oaa(1,1)}}AC(Q,Ia){Ia=void 0===Ia?!1:Ia;Za.ESa(Q)?this.iQb(Q,Object(d.a)(this,this.AUa,"onQueryAddinDetailsCompleted"),Ia):h.ULS.sendTraceTag(509870080,
220,50,"QueryAddinDetails: skipping providerType: {0}.",Ga.a[Q])}Twa(Q){this.$a.addHandler(Y.a.S3a,Q)}DGb(Q,Ia,ub,Yb){this.Voa(Q)||(3===Ia&&ub?ub(Q):2===Ia&&Yb?Yb(Q):this.oaa(Q,1))}Voa(Q){return this.fP.kd(Q)}oaa(Q,Ia){if(this.PF){var ub=this.Voa(Q);if(!ub||-1!==this.fP.ma(Q)&&this.fP.ma(Q)!==Ia)h.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",la.a[Q],ub?ia[this.fP.ma(Q)]:"undefined",ia[Ia]),this.fP.fa(Q,Ia)}}AUa(Q,Ia,ub){if(ub)if(Za.gLb(Q,ub,
window.performance.now()-Ia),0===ub.errorCode){let Yb;if(ub.value){let Ca=0;Yb=Array(ub.value.length);ub.value.forEach(tb=>{Yb[Ca++]=tb})}else Yb=[];this.jy(new Oa(Q),Yb)}else-1===ub.errorCode||10===ub.errorCode?this.jy(new Oa(Q),[]):(Q=this.C9c(Q,Ia,ub),this.jy(Q));else Q=Za.D9c(Q,Ia),this.jy(Q)}C9c(Q,Ia,ub){const Yb={};Yb.collectionType=la.a[Q];Yb.invokeResultCode=ub.errorCode;Yb["queryResult.Value"]=ub.value?String.format("Length: {0}",ub.value.length):"null";Yb.queryStart=Ia;Yb.queryDuration=
window.performance.now()-Ia;return Object.assign(new Oa(Q,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Yb)})}h3d(){return this.j9(2)?this.Oa.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?3===this.ml.ma(2).errorCode:!1:!0}cVb(Q){return this.PF&&this.fP.kd(Q)?1===this.fP.ma(Q):!0}iQb(Q,Ia,ub){ub=void 0===ub?!1:ub;h.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",Q);if(Q!==OSF.StoreTypeEnum.MarketPlace&&Q!==OSF.StoreTypeEnum.PrivateCatalog)h.ULS.shipAssertTag(509753571,
220,!1,"Unsupported storeType: {0}",Q);else{var Yb=this.IW.ma(Q);this.i3d(Q)&&this.cVb(2)&&(this.Nmd&&this.q3d&&Za.LZd(this.solutionIds,this.Vg.getAppUILocale()),this.kQb(Ia));this.cVb(Yb)&&(this.lCb&&this.isAnonymousUser?(Q=Za.q9c(Yb),this.jy(Q)):this.DSd(Q,Ia,ub))}}i3d(Q){return this.GSd?Q===OSF.StoreTypeEnum.MarketPlace:!0}DSd(Q,Ia,ub){this.queryStoreDisabled(Q,(Yb,Ca)=>{if(Yb===OSF.StoreTypeEnum.MarketPlace&&Ca)Ca=Za.eMa(0),this.jy(Ca);else if(Yb===OSF.StoreTypeEnum.PrivateCatalog&&Ca)Ca=Za.eMa(1),
this.jy(Ca);else{var tb=window.performance.now();this.Vg.getEntitlementDetails(Object.assign(new ma,{storeType:Yb,refresh:ub}),$b=>{Ia(this.IW.ma(Yb),tb,$b)})}})}kQb(Q){this.h3d()&&this.queryStoreDisabled(0,(Ia,ub)=>{ub?(Ia=Za.eMa(2),this.jy(Ia)):(Ia=window.performance.now(),Q(2,Ia,this.Urd()))})}jy(Q,Ia){Ia=void 0===Ia?null:Ia;0!==Q.errorCode?(h.ULS.shipAssertTag(509116673,220,!Ia,"The parameter addinDetails must be null for any failed queries"),h.ULS.shipAssertTag(509116672,220,!!Q.failure,"The result.Failure must not be available for any failed queries"),
this.c3d(Q)?h.ULS.sendTraceTag(510253056,220,10,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","",la.a[Q.mT],Sa.a[Q.errorCode],Q.failure?Q.failure.toString():"null",JSON.stringify(Q.failure)):h.ULS.sendTraceTag(508610434,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","(downgraded error)",la.a[Q.mT],Sa.a[Q.errorCode],Q.failure?Q.failure.toString():"null",JSON.stringify(Q.failure))):
(h.ULS.shipAssertTag(509116643,220,!!Ia,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",la.a[Q.mT]),h.ULS.sendTraceTag(509116642,220,50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",la.a[Q.mT],Ia?Ia.length:-1));Q=new ba(Q.mT,Q.errorCode,Ia,Q.failure);this.$a.raiseEvent(Y.a.S3a,Q)}c3d(Q){return 3===Q.errorCode&&(this.lCb&&-2147208619===Za.ODb(Q)||this.Pmd&&-2===Za.ODb(Q))||4===Q.errorCode?!1:2!==Q.errorCode}zqa(Q,
Ia){if(0!==Ia.errorCode)this.ml.fa(Ia.lH,Object.assign(new La(Ia.lH,Ia.errorCode),{failure:Ia.failure}));else{Q=Object.assign(new La(Ia.lH),{solutionIds:new T.a});var ub=Ia.JB;for(const Yb of ub)ub=Yb.solutionId,this.er.kd(ub)?this.er.fa(ub,this.ZLb(this.er.ma(ub),Ia.lH,Yb)):this.er.add(ub,Yb),Q.solutionIds.add(ub);this.ml.fa(Ia.lH,Q);this.oaa(Q.mT,1)}}j9(Q){return this.ml.kd(Q)?!!this.er:!1}get vvb(){return this.Nt?!this.Nt.AreThirdPartyAddInsAllowed||this.Nt.AppsForOfficeThirdPartyIsDisabled:!this.Oa.pa("AreThirdPartyAddInsAllowed")||
this.Oa.pa("AppsForOfficeThirdPartyIsDisabled")}get zIb(){return this.Nt?!this.Nt.AppsForOfficeAllowExternalMarketplace:!this.Oa.pa("AppsForOfficeAllowExternalMarketplace")}get kha(){return this.Nt?this.Nt.PopularAddinDetailsJsonString:this.Oa.Sa("PopularAddinDetailsJsonString")}queryStoreDisabled(Q,Ia){if(this.vvb)Ia(Q,!0);else if(Q===OSF.StoreTypeEnum.MarketPlace&&this.zIb)Ia(Q,!0);else{const ub=Za.eXb(Q);if(ub){const Yb=window.performance.now();this.Vg.queryStoreDisabled(ub,Ca=>{h.ULS.sendTraceTag(509679070,
220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",Q,Ca,Yb,window.performance.now()-Yb);Ia(Q,Ca)})}else Ia(Q,!1)}}ZLb(Q,Ia,ub){if(!Q)return ub;if(!ub)return Q;if(this.zza)return 2===Ia?Za.MCa(ub,Q):Za.MCa(Q,ub);if(2===Ia)return Q.addinInfo=ub.addinInfo,Q;ub.addinInfo=Q.addinInfo;return ub}Urd(){if(!this.DS){const Q=JSON.parse(this.kha);this.XBb(Q);this.DS=Q}return Za.bMa(0,this.DS)}XBb(Q){this.zza&&Za.lvb(Q);this.p4a(Q);this.YBb(Q)}p4a(Q){const Ia=this.swb();
for(var ub=0;ub<Q.length&&0<Ia.count;ub++){const Yb=Q[ub];if(Ia.kd(Yb.solutionId)){let Ca=String.format("Found an override, solutionId: {0}",Yb.solutionId);const tb=Ia.ma(Yb.solutionId);tb&&(isNaN(tb.addinInfo.priority)||(Ca=String.format("{0}; AddinInfo.Priority: update {1} to {2}",Ca,Yb.addinInfo.priority,tb.addinInfo.priority),Yb.addinInfo.priority=tb.addinInfo.priority),isNaN(tb.addinInfo.AUP)||(Ca=String.format("{0}; AddinInfo.AUP: update {1} to {2}",Ca,Yb.addinInfo.AUP,tb.addinInfo.AUP),Yb.addinInfo.AUP=
tb.addinInfo.AUP),tb.displayName&&(Ca=String.format("{0}; DisplayName: update {1} to {2}",Ca,Yb.displayName,tb.displayName),Yb.displayName=tb.displayName),tb.iconUrl&&(Ca=String.format("{0}; IconUrl: update {1} to {2}",Ca,Yb.iconUrl,tb.iconUrl),Yb.iconUrl=tb.iconUrl),tb.description&&(Ca=String.format("{0}; Description: update {1} to {2}",Ca,Yb.description,tb.description),Yb.description=tb.description));Ia.remove(Yb.solutionId);this.t8&&h.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",
Ca)}}for(const Yb of Ia.keys)ub=Ia.ma(Yb),ub.displayName&&ub.iconUrl&&ub.addinInfo&&(Q.push(ub),this.t8&&h.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(ub)))}swb(){const Q=new L.a(S.a.Fh());let Ia=this.Oa.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!Ia)return Q;Ia=Ia.trim();if(12>=Ia.length)return 0<Ia.length&&h.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",
Ia),Q;this.t8&&h.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",Ia);try{const ub=[],Yb=Ia.split("|");for(let Ca=Yb.length-1;0<=Ca;Ca--){const tb=Yb[Ca],$b=tb.split("\\");if(2>$b.length){ub.push(tb);continue}const cd=Za.hPb($b);cd?Q.kd(cd.solutionId)||Q.add(cd.solutionId,cd):ub.push(tb)}this.t8&&0<ub.length&&h.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",ub.join("|"));this.t8&&0<Q.count&&h.ULS.sendTraceTag(509379103,
220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",Q.count,JSON.stringify(Ea.toArray(Q.values)));return Q}catch(ub){h.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",Ia,ub.toString())}return Q}YBb(Q){for(let Ia=0;Ia<Q.length;Ia++)Ua.c(Q[Ia].iconUrl.toLowerCase(),"http",0)||(Q[Ia].iconUrl=String.format("{0}/image/apps.{1}",this.Gpb,Q[Ia].iconUrl))}get Nmd(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutSearchAddinDetails",
!1)}get q3d(){return!fa.a.MVa(9)}get solutionIds(){if(!this.GS){this.GS=new T.a;for(const Q of this.BPb.keys)this.GS.add(Ua.d(Q))}return this.GS.toArray()}get BPb(){if(!this.KJ){this.KJ=new L.a(S.a.Fh());const Q=JSON.parse(this.kha);for(const Ia of Q)this.KJ.add(Ia.solutionId,Ia.addinInfo)}return this.KJ}static ESa(Q){return 0===Q||10===Q}static D9c(Q,Ia){const ub={};ub.collectionType=la.a[Q];ub.queryResult="null";ub.queryStart=Ia;ub.queryDuration=window.performance.now()-Ia;return Object.assign(new Oa(Q,
3),{failure:Error.create("QueryAddinDetails hit an invocation failure",ub)})}static aMa(Q,Ia,ub){const Yb={};Yb.collectionType=la.a[Q];Q=new Oa(Q,Ia);0!==Ia&&(Q.failure=Error.create(ub,Yb));return Q}static eMa(Q){return Za.aMa(Q,2,"The store is disabled.")}static q9c(Q){const Ia={};Ia.collectionType=la.a[Q];Ia.invokeResultCode=-2147208619;Ia.queryDuration=0;return Object.assign(new Oa(Q,3),{failure:Error.create("Anonymous users do not have installed add-ins.",Ia)})}static ODb(Q){return Q.failure?
Q.failure.invokeResultCode:-1E3}static gLb(Q,Ia,ub){const Yb={};Yb.AddinCollectionType=la.a[Q];Yb.ErrorCode=Ia.errorCode;Yb.AddinCount=Ia.value?Ia.value.length:0;h.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",ub,JSON.stringify(Yb))}static bMa(Q,Ia){const ub={};ub.errorCode=Q;ub.value=Ia;return ub}static eXb(Q){return Q===OSF.StoreTypeEnum.MarketPlace?"omex":Q===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static MCa(Q,Ia){Ia.solutionId=
Ia.solutionId||Q.solutionId;Ia.version=Ia.version||Q.version;Ia.storeType=Ia.storeType||Q.storeType;Ia.storeId=Ia.storeId||Q.storeId;Ia.assetId=Ia.assetId||Q.assetId;Ia.assetStoreId=Ia.assetStoreId||Q.assetStoreId;Ia.displayName=Ia.displayName||Q.displayName;Ia.provider=Ia.provider||Q.provider;Ia.description=Ia.description||Q.description;Ia.iconUrl=Ia.iconUrl||Q.iconUrl;Ia.webApplicationId=Ia.webApplicationId||Q.webApplicationId;Ia.highResolutionIconUrl=Ia.highResolutionIconUrl||Q.highResolutionIconUrl;
Ia.licenseUrl=Ia.licenseUrl||Q.licenseUrl;Ia.privacyUrl=Ia.privacyUrl||Q.privacyUrl;Ia.addinInfo=Ia.addinInfo||Q.addinInfo;isNaN(Ia.targetType)&&(Ia.targetType=Q.targetType);isNaN(Ia.height)&&(Ia.height=Q.height);isNaN(Ia.width)&&(Ia.width=Q.width);return Ia}static lvb(Q){for(const Ia of Q)isNaN(Ia.targetType)&&(Ia.targetType=1),Ia.assetId=Ia.assetId||Ia.solutionId,Ia.storeId=Ia.storeId||"en-US",Ia.storeType=Ia.storeType||"omex",Ia.assetStoreId=Ia.assetStoreId||"omex",isNaN(Ia.width)&&(Ia.width=0),
isNaN(Ia.height)&&(Ia.height=0)}static hPb(Q){const Ia={};let ub=0;ub<Q.length&&0<Q[ub].trim().length&&Q[ub].trim().toLowerCase().startsWith("wa")&&(Ia.solutionId=Q[ub].trim(),Ia.addinInfo=Object.assign(new Z,{priority:Number.NaN,AUP:Number.NaN}),++ub<Q.length&&0<Q[ub].trim().length&&(Ia.addinInfo.priority=parseInt(Q[ub].trim())),++ub<Q.length&&0<Q[ub].trim().length&&(Ia.addinInfo.AUP=parseInt(Q[ub].trim())),++ub<Q.length&&0<Q[ub].trim().length&&(Ia.displayName=Q[ub].trim()),++ub<Q.length&&0<Q[ub].trim().length&&
(Ia.iconUrl=Q[ub].trim()),++ub<Q.length&&0<Q[ub].trim().length&&(Ia.description=Q[ub].trim()));return Ia.solutionId?Ia:null}static LDb(Q,Ia){Q=Q.Sa("AddinImageStoreServiceUrl");if(!Q)return Ia;Q=Q.toLowerCase();return Q.startsWith("http://")||Q.startsWith("https://")?Q:Ia}static LZd(Q,Ia){if(Q&&Q.length){new na(0);var ub=new Xa.QueryStringBuilder("api/addins/search");ub.mj("apiversion","1.0");ub.mj("assetids",Q.join(","));ub.mj("client","Word");ub.mj("ui",Ia);ub.mj("cv",m.AFrameworkApplication.buildVersion);
Q=String.format("{0}{1}","https://api.addins.omex.office.net/",ub.toString());var Yb=window.performance.now(),Ca=Za.executeRequest(Q,1,"SearchAddinDetails");Ca.continueWith(()=>{if(Ca.qj)var tb="query canceled";else Ca.Kh?tb="query failed (exception)":Ca.result?(tb=Ca.result,tb=void 0===tb.qh||null===tb.qh?"query failed (response.Args is null or undefined)":void 0===tb.qh.data||null===tb.qh.data?"query failed (response.Args.Data is null or undefined)":tb.qh.data.httpStatus!==ka.a.PE?"query failed (response.Args.Data.HttpStatus != HttpStatusCode.OK_200)":
"query succeeded"):tb="query failed (responseTask.Result is null)";const $b=window.performance.now()-Yb;h.ULS.sendTraceTag(508610433,220,15,"SearchAddinDetails: response received, time elapsed: {0}, result: {1}",$b,tb)});h.ULS.sendTraceTag(508610432,220,15,"SearchAddinDetails: request was just sent")}}static executeRequest(Q,Ia,ub,Yb,Ca){return m.AFrameworkApplication.tf.Pwa(Q,Ia,void 0===Ca?null:Ca,void 0===Yb?null:Yb,ub,null,!1,null,6E4)}}Object(b.a)(Za,"AddinDetailsManager1",null,[735,736]);class Ab{constructor(Q,
Ia){this.description=this.provider=this.displayName=this.assetStoreId=this.assetId=this.storeId=this.storeType=this.version=this.solutionId=this.addinInfo=null;this.width=this.height=this.targetType=0;this.privacyUrl=this.licenseUrl=this.highResolutionIconUrl=this.webApplicationId=this.iconUrl=null;this.solutionId=Q.solutionId;this.version=Q.version;this.storeType=Q.storeType;this.storeId=Q.storeId;this.assetId=Q.assetId;this.assetStoreId=Q.assetStoreId;this.displayName=Q.displayName;this.provider=
Q.provider;this.description=Q.description;this.targetType=Q.targetType;this.height=Q.height;this.width=Q.width;this.iconUrl=Q.iconUrl;this.webApplicationId=Q.webApplicationId;this.highResolutionIconUrl=Q.highResolutionIconUrl;this.licenseUrl=Q.licenseUrl;this.privacyUrl=Q.privacyUrl;this.addinInfo=void 0===Ia?null:Ia}cXb(){const Q={};Q.solutionId=this.solutionId;Q.version=this.version;Q.storeType=this.storeType;Q.storeId=this.storeId;Q.assetId=this.assetId;Q.assetStoreId=this.assetStoreId;Q.targetType=
this.targetType;Q.displayName=this.displayName;Q.width=this.width;Q.height=this.height;return Q}}Object(b.a)(Ab,"AddinDetail",null,[]);class pb{constructor(Q,Ia,ub,Yb,Ca){this.GS=null;this.Oa=Q;this.Wl=Ia;this.KJ=ub;this.FOg=Yb;this.eob=Ca}AC(Q,Ia){this.Vg.queryAppDetails(this.FOg,this.eob,this.solutionIds,Q,(ub,Yb)=>{let Ca=null;if(Yb){Ca=Array(Yb.length);for(let tb=0;tb<Yb.length;tb++)Ca[tb]=new Ab(Yb[tb],this.NUi(Yb[tb].solutionId))}Ia(ub,Ca||[])})}get dFi(){return!!this.Vg.queryAppDetails}NUi(Q){return this.KJ.ma(Q)}get solutionIds(){if(!this.GS){this.GS=
new T.a;for(const Q of this.KJ.keys)this.GS.add(Ua.d(Q))}return this.GS.toArray()}get Vg(){return this.Wl.value}}Object(b.a)(pb,"AddinDetailsLoader",null,[]);class Tb{constructor(Q,Ia){this.failure=null;this.mT=Q;this.errorCode=void 0===Ia?0:Ia}}Object(b.a)(Tb,"AddinQueryResult",null,[]);class ob extends Tb{constructor(Q,Ia){super(Q,void 0===Ia?0:Ia);this.l6d=this.solutionIds=null}}Object(b.a)(ob,"AddinCollection",Tb,[]);var va=a(730);class Pa extends va.a{constructor(){super(S.a.Fh())}}Object(b.a)(Pa,
"AddinDetailTable",va.a,[]);var jb;(function(Q){Q[Q.stop=-1]="stop";Q[Q.skip=0]="skip";Q[Q.query=1]="query"})(jb||(jb={}));Object(b.b)("QueryStrategy",jb);class Ob{constructor(Q,Ia,ub){ub=void 0===ub?null:ub;this.$a=new f.a;this.er=new L.a(S.a.Fh());this.ml=new V.a;this.fP=new V.a;this.KJ=this.DS=null;this.IW=new nb.a;this.IW.add(OSF.StoreTypeEnum.MarketPlace,0);this.IW.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Oa=Q;this.Wl=Ia;this.Nt=ub;this.Gpb=Ob.LDb(Q,"https://store-images.s-microsoft.com");
this.YZc=null;this.Twa(Object(d.a)(this,this.zqa,"onAddinDetailsRefreshed"))}get GSd(){return!!this.Oa&&this.Oa.isChangeGateEnabled("QueryPopularForOmexOnlyEnabled")}get PF(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}get isAnonymousUser(){return!!this.Oa&&this.Oa.pa("IsAnonymousUser")}get Pmd(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNoMailboxFixEnabled",!0)}get lCb(){return!!this.Oa&&
this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNotSignedInFixEnabled",!0)}get zza(){return!!this.Oa&&this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)}get t8(){return this.Oa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get Vg(){return this.Wl.value}get AQd(){this.YZc||(this.YZc=new pb(this.Oa,this.Wl,this.BPb,0,this.Vg.getAppUILocale()));return this.YZc}A8(Q){if(this.PF&&!this.Voa(Q))return new na(0);
if(!this.j9(Q))return Q=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:la.a[Q]}),Object.assign(new na(1),{failure:Q});const Ia=this.ml.ma(Q);if(Ia.failure)return Object.assign(new na(Ia.errorCode),{failure:Ia.failure});h.ULS.shipAssertTag(509870082,220,!!Ia.solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Q);const ub=new na(0);for(let Yb=0;Yb<Ia.solutionIds.count;Yb++){const Ca=Ia.solutionIds.ma(Yb),tb=Ia.l6d.ma(Yb);
if(this.er.kd(Ca)){const $b=this.er.ma(Ca);$b.kd(tb)?Array.add(ub.JB,$b.ma(tb)):h.ULS.sendTraceTag(508610437,220,15,"The addin with solutionId '{0}' in '{1}' must contain storeId '{2}' when the collection is ready.",Ca,Q,tb)}else h.ULS.sendTraceTag(508610436,220,15,"The addin with solutionId '{0}' in '{1}' must exist when the collection is ready.",Ca,Q)}return ub}z9a(Q,Ia){Ia=void 0===Ia?null:Ia;if(Q=this.u1h(Q))if(Ia||(Ia=this.uiCulture),Q.kd(Ia))return Q.ma(Ia);return null}u1h(Q){return this.er.kd(Q)?
this.er.ma(Q):null}Qhb(Q){if(Q){this.Twa(Q);for(const Ia of this.ml.keys){if(this.PF&&!this.Voa(Ia))continue;if(!this.j9(Ia)||this.ml.ma(Ia).failure)continue;h.ULS.shipAssertTag(509870081,220,!!this.ml.ma(Ia).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Ia);const ub=[],Yb=this.ml.ma(Ia);for(const Ca of Yb.solutionIds)Array.add(ub,this.er.ma(Ca));Q(null,new ba(Ia,Yb.errorCode,ub,Yb.failure))}}}RQb(Q,Ia){if(this.PF&&Ob.ESa(Q)){var ub=Ca=>{this.jy(Ob.aMa(Ca,
4,"The connected service is disabled."));this.oaa(Ca,-1)},Yb=Ca=>{this.jy(Ob.aMa(Ca,0,"The user doesn't have any addin installed."),[]);this.oaa(Ca,0)};0===Q?(this.DGb(0,Ia,ub,Yb),this.DGb(2,Ia,ub,()=>{this.kQb(Object(d.a)(this,this.AUa,"onQueryAddinDetailsCompleted"))})):10===Q&&this.oaa(1,1)}}AC(Q,Ia){Ia=void 0===Ia?!1:Ia;Ob.ESa(Q)?this.iQb(Q,Object(d.a)(this,this.AUa,"onQueryAddinDetailsCompleted"),Ia):h.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",Ga.a[Q])}Twa(Q){this.$a.addHandler(Y.a.S3a,
Q)}DGb(Q,Ia,ub,Yb){this.Voa(Q)||(3===Ia&&ub?ub(Q):2===Ia&&Yb?Yb(Q):this.oaa(Q,1))}Voa(Q){return this.fP.kd(Q)}oaa(Q,Ia){if(this.PF){var ub=this.Voa(Q);if(!ub||-1!==this.fP.ma(Q)&&this.fP.ma(Q)!==Ia)h.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",la.a[Q],ub?jb[this.fP.ma(Q)]:"undefined",jb[Ia]),this.fP.fa(Q,Ia)}}AUa(Q,Ia,ub){ub?(Ob.gLb(Q,ub,window.performance.now()-Ia),0===ub.errorCode?(Ia=ub.value?Ob.m3g(ub.value):[],this.jy(new Tb(Q),Ia)):
-1===ub.errorCode||10===ub.errorCode?this.jy(new Tb(Q),[]):(Q=this.C9c(Q,Ia,ub),this.jy(Q))):(Q=Ob.D9c(Q,Ia),this.jy(Q))}C9c(Q,Ia,ub){const Yb={};Yb.collectionType=la.a[Q];Yb.invokeResultCode=ub.errorCode;Yb["queryResult.Value"]=ub.value?String.format("Length: {0}",ub.value.length):"null";Yb.queryStart=Ia;Yb.queryDuration=window.performance.now()-Ia;return Object.assign(new Tb(Q,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Yb)})}h3d(){return this.j9(2)?this.Oa.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?
3===this.ml.ma(2).errorCode:!1:!0}cVb(Q){return this.PF&&this.fP.kd(Q)?1===this.fP.ma(Q):!0}iQb(Q,Ia,ub){ub=void 0===ub?!1:ub;h.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",Q);if(Q!==OSF.StoreTypeEnum.MarketPlace&&Q!==OSF.StoreTypeEnum.PrivateCatalog)h.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",Q);else{var Yb=this.IW.ma(Q);this.i3d(Q)&&this.cVb(2)&&this.kQb(Ia);this.cVb(Yb)&&(this.lCb&&this.isAnonymousUser?(Q=Ob.q9c(Yb),this.jy(Q)):this.DSd(Q,
Ia,ub))}}i3d(Q){return this.GSd?Q===OSF.StoreTypeEnum.MarketPlace:!0}DSd(Q,Ia,ub){this.queryStoreDisabled(Q,(Yb,Ca)=>{if(Yb===OSF.StoreTypeEnum.MarketPlace&&Ca)Ca=Ob.eMa(0),this.jy(Ca);else if(Yb===OSF.StoreTypeEnum.PrivateCatalog&&Ca)Ca=Ob.eMa(1),this.jy(Ca);else{var tb=window.performance.now();this.Vg.getEntitlementDetails(Object.assign(new ma,{storeType:Yb,refresh:ub}),$b=>{Ia(this.IW.ma(Yb),tb,$b)})}})}kQb(Q){this.h3d()&&this.queryStoreDisabled(0,(Ia,ub)=>{ub?(Ia=Ob.eMa(2),this.jy(Ia)):this.Gqj(Q)})}jy(Q,
Ia){Ia=void 0===Ia?null:Ia;0!==Q.errorCode?(h.ULS.shipAssertTag(509116673,220,!Ia,"The parameter addinDetails must be null for any failed queries"),h.ULS.shipAssertTag(509116672,220,!!Q.failure,"The result.Failure must not be available for any failed queries"),this.c3d(Q)?h.ULS.sendTraceTag(510253056,220,10,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","",la.a[Q.mT],Sa.a[Q.errorCode],Q.failure?Q.failure.toString():"null",JSON.stringify(Q.failure)):
h.ULS.sendTraceTag(508610434,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","(downgraded error)",la.a[Q.mT],Sa.a[Q.errorCode],Q.failure?Q.failure.toString():"null",JSON.stringify(Q.failure))):(h.ULS.shipAssertTag(509116643,220,!!Ia,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",la.a[Q.mT]),h.ULS.sendTraceTag(509116642,220,50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",
la.a[Q.mT],Ia?Ia.length:-1));Q=new ba(Q.mT,Q.errorCode,Ia,Q.failure);this.$a.raiseEvent(Y.a.S3a,Q)}c3d(Q){return 3===Q.errorCode&&(this.lCb&&-2147208619===Ob.ODb(Q)||this.Pmd&&-2===Ob.ODb(Q))||4===Q.errorCode?!1:2!==Q.errorCode}zqa(Q,Ia){if(0!==Ia.errorCode)this.ml.fa(Ia.lH,Object.assign(new ob(Ia.lH,Ia.errorCode),{failure:Ia.failure}));else{Q=Object.assign(new ob(Ia.lH),{solutionIds:new T.a,l6d:new T.a});var ub=Ia.JB;for(const Ca of ub){ub=Ca.solutionId;const tb=Ca.storeId;if(this.er.kd(ub)){var Yb=
this.er.ma(ub);Yb.kd(tb)?Yb.fa(tb,this.ZLb(Yb.ma(tb),Ia.lH,Ca)):Yb.add(tb,Ca)}else Yb=new Pa,Yb.add(tb,Ca),this.er.add(ub,Yb);Q.solutionIds.add(ub);Q.l6d.add(tb)}this.ml.fa(Ia.lH,Q);this.oaa(Q.mT,1)}}j9(Q){return this.ml.kd(Q)?!!this.er:!1}get uiCulture(){return this.Nt&&this.Nt.UICulture?this.Nt.UICulture:m.AFrameworkApplication.uiCulture}get vvb(){return this.Nt?!this.Nt.AreThirdPartyAddInsAllowed||this.Nt.AppsForOfficeThirdPartyIsDisabled:!this.Oa.pa("AreThirdPartyAddInsAllowed")||this.Oa.pa("AppsForOfficeThirdPartyIsDisabled")}get zIb(){return this.Nt?
!this.Nt.AppsForOfficeAllowExternalMarketplace:!this.Oa.pa("AppsForOfficeAllowExternalMarketplace")}get BPb(){if(!this.KJ){this.KJ=new L.a(S.a.Fh());const Q=JSON.parse(this.kha);for(const Ia of Q)this.KJ.add(Ia.solutionId,Ia.addinInfo)}return this.KJ}get kha(){return this.Nt?this.Nt.PopularAddinDetailsJsonString:this.Oa.Sa("PopularAddinDetailsJsonString")}queryStoreDisabled(Q,Ia){if(this.vvb)Ia(Q,!0);else if(Q===OSF.StoreTypeEnum.MarketPlace&&this.zIb)Ia(Q,!0);else{const ub=Ob.eXb(Q);if(ub){const Yb=
window.performance.now();this.Vg.queryStoreDisabled(ub,Ca=>{h.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",Q,Ca,Yb,window.performance.now()-Yb);Ia(Q,Ca)})}else Ia(Q,!1)}}ZLb(Q,Ia,ub){if(!Q)return ub;if(!ub)return Q;if(this.zza)return 2===Ia?Ob.MCa(ub,Q):Ob.MCa(Q,ub);if(2===Ia)return Q.addinInfo=ub.addinInfo,Q;ub.addinInfo=Q.addinInfo;return ub}Gqj(Q){const Ia=window.performance.now();if(this.DS)Q(2,Ia,Ob.bMa(0,this.DS));
else if(this.AQd&&this.AQd.dFi)this.AQd.AC(!1,(Yb,Ca)=>{this.p4a(Ca);this.DS=Ca;Q(2,Ia,Ob.bMa(Yb,this.DS))});else{var ub=JSON.parse(this.kha);this.XBb(ub);this.DS=ub;Q(2,Ia,Ob.bMa(0,this.DS))}}XBb(Q){this.zza&&Ob.lvb(Q);this.p4a(Q);this.YBb(Q)}p4a(Q){const Ia=this.swb();for(var ub=0;ub<Q.length&&0<Ia.count;ub++){const Yb=Q[ub];if(Ia.kd(Yb.solutionId)){let Ca=String.format("Found an override, solutionId: {0}",Yb.solutionId);const tb=Ia.ma(Yb.solutionId);tb&&(isNaN(tb.addinInfo.priority)||(Ca=String.format("{0}; AddinInfo.Priority: update {1} to {2}",
Ca,Yb.addinInfo.priority,tb.addinInfo.priority),Yb.addinInfo.priority=tb.addinInfo.priority),isNaN(tb.addinInfo.AUP)||(Ca=String.format("{0}; AddinInfo.AUP: update {1} to {2}",Ca,Yb.addinInfo.AUP,tb.addinInfo.AUP),Yb.addinInfo.AUP=tb.addinInfo.AUP),tb.displayName&&(Ca=String.format("{0}; DisplayName: update {1} to {2}",Ca,Yb.displayName,tb.displayName),Yb.displayName=tb.displayName),tb.iconUrl&&(Ca=String.format("{0}; IconUrl: update {1} to {2}",Ca,Yb.iconUrl,tb.iconUrl),Yb.iconUrl=tb.iconUrl),tb.description&&
(Ca=String.format("{0}; Description: update {1} to {2}",Ca,Yb.description,tb.description),Yb.description=tb.description));Ia.remove(Yb.solutionId);this.t8&&h.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",Ca)}}for(const Yb of Ia.keys)ub=Ia.ma(Yb),ub.displayName&&ub.iconUrl&&ub.addinInfo&&(Q.push(ub),this.t8&&h.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(ub)))}swb(){const Q=new L.a(S.a.Fh());
let Ia=this.Oa.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!Ia)return Q;Ia=Ia.trim();if(12>=Ia.length)return 0<Ia.length&&h.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",Ia),Q;this.t8&&h.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",Ia);try{const ub=[],Yb=Ia.split("|");for(let Ca=Yb.length-1;0<=Ca;Ca--){const tb=Yb[Ca],$b=tb.split("\\");if(2>$b.length){ub.push(tb);
continue}const cd=Ob.hPb($b);cd?Q.kd(cd.solutionId)||Q.add(cd.solutionId,cd):ub.push(tb)}this.t8&&0<ub.length&&h.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",ub.join("|"));this.t8&&0<Q.count&&h.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",Q.count,JSON.stringify(Ea.toArray(Q.values)));return Q}catch(ub){h.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",
Ia,ub.toString())}return Q}YBb(Q){for(let Ia=0;Ia<Q.length;Ia++)Ua.c(Q[Ia].iconUrl.toLowerCase(),"http",0)||(Q[Ia].iconUrl=String.format("{0}/image/apps.{1}",this.Gpb,Q[Ia].iconUrl))}static ESa(Q){return 0===Q||10===Q}static D9c(Q,Ia){const ub={};ub.collectionType=la.a[Q];ub.queryResult="null";ub.queryStart=Ia;ub.queryDuration=window.performance.now()-Ia;return Object.assign(new Tb(Q,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",ub)})}static aMa(Q,Ia,ub){const Yb={};Yb.collectionType=
la.a[Q];Q=new Tb(Q,Ia);0!==Ia&&(Q.failure=Error.create(ub,Yb));return Q}static eMa(Q){return Ob.aMa(Q,2,"The store is disabled.")}static q9c(Q){const Ia={};Ia.collectionType=la.a[Q];Ia.invokeResultCode=-2147208619;Ia.queryDuration=0;return Object.assign(new Tb(Q,3),{failure:Error.create("Anonymous users do not have installed add-ins.",Ia)})}static ODb(Q){return Q.failure?Q.failure.invokeResultCode:-1E3}static gLb(Q,Ia,ub){const Yb={};Yb.AddinCollectionType=la.a[Q];Yb.ErrorCode=Ia.errorCode;Yb.AddinCount=
Ia.value?Ia.value.length:0;h.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; fields: {1}",ub,JSON.stringify(Yb))}static bMa(Q,Ia){const ub={};ub.errorCode=Q;ub.value=Ia;return ub}static eXb(Q){return Q===OSF.StoreTypeEnum.MarketPlace?"omex":Q===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static MCa(Q,Ia){Ia.solutionId=Ia.solutionId||Q.solutionId;Ia.version=Ia.version||Q.version;Ia.storeType=Ia.storeType||Q.storeType;Ia.storeId=Ia.storeId||
Q.storeId;Ia.assetId=Ia.assetId||Q.assetId;Ia.assetStoreId=Ia.assetStoreId||Q.assetStoreId;Ia.displayName=Ia.displayName||Q.displayName;Ia.provider=Ia.provider||Q.provider;Ia.description=Ia.description||Q.description;Ia.iconUrl=Ia.iconUrl||Q.iconUrl;Ia.webApplicationId=Ia.webApplicationId||Q.webApplicationId;Ia.highResolutionIconUrl=Ia.highResolutionIconUrl||Q.highResolutionIconUrl;Ia.licenseUrl=Ia.licenseUrl||Q.licenseUrl;Ia.privacyUrl=Ia.privacyUrl||Q.privacyUrl;Ia.addinInfo=Ia.addinInfo||Q.addinInfo;
isNaN(Ia.targetType)&&(Ia.targetType=Q.targetType);isNaN(Ia.height)&&(Ia.height=Q.height);isNaN(Ia.width)&&(Ia.width=Q.width);return Ia}static m3g(Q){const Ia=Array(Q.length);for(let ub=0;ub<Ia.length;ub++)Ia[ub]=new Ab(Q[ub],Q[ub].addinInfo);return Ia}static lvb(Q){for(const Ia of Q)isNaN(Ia.targetType)&&(Ia.targetType=1),Ia.assetId=Ia.assetId||Ia.solutionId,Ia.storeId=Ia.storeId||"en-US",Ia.storeType=Ia.storeType||"omex",Ia.assetStoreId=Ia.assetStoreId||"omex",isNaN(Ia.width)&&(Ia.width=0),isNaN(Ia.height)&&
(Ia.height=0)}static hPb(Q){const Ia={};let ub=0;ub<Q.length&&0<Q[ub].trim().length&&Q[ub].trim().toLowerCase().startsWith("wa")&&(Ia.solutionId=Q[ub].trim(),Ia.addinInfo=Object.assign(new Z,{priority:Number.NaN,AUP:Number.NaN}),++ub<Q.length&&0<Q[ub].trim().length&&(Ia.addinInfo.priority=parseInt(Q[ub].trim())),++ub<Q.length&&0<Q[ub].trim().length&&(Ia.addinInfo.AUP=parseInt(Q[ub].trim())),++ub<Q.length&&0<Q[ub].trim().length&&(Ia.displayName=Q[ub].trim()),++ub<Q.length&&0<Q[ub].trim().length&&(Ia.iconUrl=
Q[ub].trim()),++ub<Q.length&&0<Q[ub].trim().length&&(Ia.description=Q[ub].trim()));return Ia.solutionId?Ia:null}static LDb(Q,Ia){Q=Q.Sa("AddinImageStoreServiceUrl");if(!Q)return Ia;Q=Q.toLowerCase();return Q.startsWith("http://")||Q.startsWith("https://")?Q:Ia}}Object(b.a)(Ob,"AddinDetailsManager2",null,[735,736]);class kb{static createInstance(Q,Ia,ub){ub=void 0===ub?null:ub;if(kb.uHi(Q)){if(kb.l1g(Q))return h.ULS.sendTraceTag(508925833,220,50,"AddinDetailsManagerFactory.CreateInstance: Creating an instance of AddinDetailsManager2."),
new Ob(Q,Ia,ub);h.ULS.sendTraceTag(508925832,220,50,"AddinDetailsManagerFactory.CreateInstance: Creating an instance of AddinDetailsManager1.");return new Za(Q,Ia,ub)}h.ULS.sendTraceTag(508925831,220,50,"AddinDetailsManagerFactory.CreateInstance: Creating an instance of AddinDetailsManager");return new sb(Q,Ia,ub)}static uHi(Q){return(Q||m.AFrameworkApplication.da).getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)}static l1g(Q){return(Q||m.AFrameworkApplication.da).getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsPopularLoaderEnabled",
!1)}}Object(b.a)(kb,"AddinDetailsManagerFactory",null,[]);var ra=a(868),rb=a(1230),Kb=a(1318),Sb=a(995),cb=a(189),cc=a(1238),Ub=a(123),wb=a(84),vc=a(96),Lb=a(661),Ja=a(138),Hb=a(355),gc=a(562),ec=a(179),Ta=a(39),ib=a(6),bc=a(920),jc=a(1193),sc=a(83);class Fa{constructor(){this.command=0;this.properties=null}}Object(b.a)(Fa,"DdaRequestInfo",null,[]);var Ha=a(770),Na=a(77);class W extends sc.a{constructor(Q,Ia){super();this.requests=[];this.disposed=this.xac=!1;this.wj=()=>{if(!this.disposed){this.grid.he.$p(this.wj);
this.xac=!1;const ub=this.requests;this.requests=[];for(let Yb of ub)this.ddaFacade.wN(Yb.command,Yb.properties)}};this.ddaFacade=Q;this.grid=Ia}Jxh(Q,Ia){this.disposed||(this.xac||(this.grid.he.Mq(this.wj),this.xac=!0),this.requests.push(Object(c.a)(new Fa,{command:Q,properties:Ia})))}dispose(){if(!this.disposed){this.disposed=!0;this.xac&&this.grid.he.$p(this.wj);var Q=this.requests;this.requests=null;for(let Ia of Q)(Q=Ia.properties?Ia.properties[Na.a.N7]:null)&&this.ddaFacade.Aj(Ha.a.UGb,Q);this.ddaFacade=
this.grid=null;super.dispose()}}static kjh(Q,Ia){var ub=!1;974713501===Q&&(Ia=(Q=Ia?Ia[Na.a.Th]:null)?Q.DdaMethod:null)&&Ia.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(ub=Q.ArrayData,ub=!!ub&&64===(ub[6]&64));return ub}}Object(b.a)(W,"DdaCellEditDelayRequestHandler",sc.a,[]);var U=a(806);class za extends U.a{constructor(Q,Ia,ub,Yb,Ca,tb,$b){super(Q,Ia,ub);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Yb;this.messageContent=
Ca;this.messageOrigin=tb;this.targetOrigin=$b}}Object(b.a)(za,"DialogMessageReceivedEventArgs",U.a,[]);class ua extends U.a{constructor(Q,Ia,ub,Yb,Ca,tb,$b){super(Q,Ia,ub);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Yb;this.messageContent=Ca;this.messageOrigin=tb;this.targetOrigin=$b}}Object(b.a)(ua,"DialogParentMessageReceivedEventArgs",U.a,[]);var $a=a(1),Va=a(19);class hb{constructor(Q){this.Vg=this.k7c=null;this.ebj=(Ia,ub)=>{this.handlers.kd(ub.controlId)&&
(Ia=new za(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,ub.controlId,null,ub.messageType,ub.messageContent,ub.messageOrigin,ub.targetOrigin),this.handlers.ma(ub.controlId)(Ia),ub.messageType===OSF.DialogMessageType.DialogClosed&&this.handlers.remove(ub.controlId))};this.dbj=(Ia,ub)=>{this.Nvc.kd(ub.controlId)&&(Ia=new ua(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,ub.controlId,null,ub.messageType,ub.messageContent,ub.messageOrigin,ub.targetOrigin),this.Nvc.ma(ub.controlId)(Ia))};
this.handlers=new H.a;this.Nvc=new H.a;this.Mk=Q;this.y7a.J_g(this.ebj);this.y7a.I_g(this.dbj)}get y7a(){this.k7c||(this.k7c=M.getInstance(this.contextActivationMgr));return this.k7c}get contextActivationMgr(){!this.Vg&&this.Mk&&(this.Vg=this.Mk.Vg);return this.Vg}addHandler(Q,Ia,ub,Yb){h.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");const Ca=tb=>{tb===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.handlers.fa(Q,Ia),this.Mk.Yx(ub)):(h.ULS.sendTraceTag(537170501,
0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),this.Mk.Aj(tb,ub))};this.handlers.kd(Q)?Ca(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(Q,Yb,Ca)}$Vg(Q,Ia,ub){h.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!");this.Nvc.fa(Q,Ia);this.Mk.Yx(ub)}removeHandler(Q,Ia){this.handlers.kd(Q)?(h.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.y7a.Ixb(Q,ub=>{this.handlers.remove(Q);
ub===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.Mk.Yx(Ia):(h.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),this.Mk.Aj(ub,Ia))})):this.Mk.Aj(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Ia)}Izj(Q,Ia){h.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!");this.Nvc.remove(Q);this.Mk.Yx(Ia)}showDialog(Q,Ia,ub){try{$a.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&Va.h(this.Mk.$).ld&&
Va.h(this.Mk.$).Kt(!0),this.y7a.showDialog(Ia,Q,ub,Yb=>{this.Mk.qWg(this.Zah(Yb))})}catch(Yb){h.ULS.sendTraceTag(537170496,0,10,`DialogMessageReceivedEventManager: show dialog failed. Exception message: ${Yb.message}`),ub(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}Zah(Q){const Ia={};Ia.InstanceId=Q.id;Ia.WebExtensionType=Q.osfControlType===OSF.OsfControlTarget.InContent?0:1;Ia.PrimaryMarketplace={};Ia.PrimaryMarketplace.SolutionId=Q.solutionId;Ia.PrimaryMarketplace.SolutionVersion=Q.version;
Ia.PrimaryMarketplace.MarketplaceRef=Q.storeId;Ia.PrimaryMarketplace.MarketplaceType=Q.storeType;Ia.OwnerAddinSolutionId=Q.ownerAddinSolutionId;Ia.OwnerAddinStoreType=Q.ownerAddinStoreType;return Ia}static la(Q){if(!Q.$.ga.Da(232)){const Ia=new hb(Q);Q.$.ga.Qa(232,Ia)}}}Object(b.a)(hb,"DialogMessageReceivedEventManager",null,[823]);class qb{constructor(Q,Ia){this.HD=null;this.zja=Q;this.tRg=Ia}Z7b(Q){Q&&(this.HD||(this.HD=[]),this.HD.push(Q))}oDc(Q){this.HD&&Array.remove(this.HD,Q)}get eventId(){return this.zja}get targetId(){return this.tRg}get nqi(){return 0<
this.HD.length}NWi(Q){return this.eventId!==Q.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===Q.ddaBinding.Name:!0}aac(Q){this.HD&&Array.forEach(this.HD,Ia=>{Ia(Q)})}Hra(){this.HD=[]}}Object(b.a)(qb,"DdaEventRegistration",null,[]);class Nb{constructor(Q){this.IH=null;this.TAa=!1;this.uf=()=>{this.IH.forEach(Ia=>{Ia.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Ia.aac(new U.a(Ia.eventId,
"",null))})};this.Mk=Q}invokeDdaMethod(Q,Ia){const ub={};ub[Na.a.Th]=Q;ub[Na.a.N7]=Ia;this.Mk.wN(974713501,ub)}registerDdaEventAsync(Q,Ia,ub,Yb,Ca){Nb.MHb(Q)?(Nb.Nzd(Q)&&this.iwd(),this.IH||(this.IH=[]),Ia=this.LBb(Q,ub),Ia||(Ia=new qb(Q,ub),this.IH.push(Ia)),Ia.Z7b(Yb),this.Mk.Yx(Ca)):this.Mk.Aj(-1,Ca)}unregisterDdaEventAsync(Q,Ia,ub,Yb,Ca){Nb.MHb(Q)?((Q=this.LBb(Q,ub))&&Q.oDc(Yb),this.Mk.Yx(Ca)):this.Mk.Aj(-1,Ca)}iwd(){this.TAa||(Va.h(this.Mk.$).ha.S0(this.uf),this.TAa=!0)}LBb(Q,Ia){if(!this.IH)return null;
for(let ub=0;ub<this.IH.length;ub++){const Yb=this.IH[ub];if(Yb.eventId===Q&&Yb.targetId===Ia)return Yb}return null}static MHb(Q){return Q===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static Nzd(Q){return Q===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}}Object(b.a)(Nb,"EmbeddingPage",null,[798]);var yb=a(191);class ja extends U.a{constructor(Q,Ia,ub,Yb,Ca,tb,$b,cd){super(Q,Ia,ub);this.columnCount=this.rowCount=this.startColumn=this.startRow=0;this.startColumn=tb-Yb.Reference.FirstColumn;
this.columnCount=cd;Q=Math.max(Ca,Yb.Reference.FirstRow);Ca=Math.min(Ca+$b-1,Yb.Reference.LastRow);Q>Ca?this.startRow=this.rowCount=void 0:(this.startRow=Q-Yb.Reference.FirstRow,this.rowCount=Ca-Q+1)}getStartRow(){return this.startRow}getStartColumn(){return this.startColumn}getRowCount(){return this.rowCount}getColumnCount(){return this.columnCount}}Object(b.a)(ja,"DdaBindingSelectionEventArgs",U.a,[]);var Ka=a(211),Pb=a(26),rc=a(45),$c=a(53),Dd=a(427),Jd=a(30),Kd=a(38),ce=a(573),ge=a(131),uc=a(56),
dd=a(93),Rd=a(12),Yd=a(11),Md=a(111);class ad{}ad.ANh="ewa-wx-disabled-div";ad.zNh="ewa-wx-container-div";ad.q2e="ewa-ptp-nov2-flex";Object(b.a)(ad,"CssClassNames",null,[]);var Mb=a(155),Aa=a(91),Bc=a(137),Vc=a(15),hc=a(324),xc=a(200),ab=a(383);const Wb=ad.ANh,Yc=ad.zNh;class Tc extends yb.a{constructor(Q,Ia,ub,Yb){Yb=void 0===Yb?!1:Yb;super();this.pjb=0;this.IH=null;this.TAa=!1;this.ZAc=null;this.OX=0;this.aec=this.q0a=this.yhe=this.$ee=null;this.$Vc=this.Rme=!1;this.lZc=this.Sha=this.Ube=null;this.uf=
()=>{this.enabled&&(this.ANj(),this.ZAc=rc.d(Va.h(this.$).ha.ra.selectedRanges))};this.vkf=Ca=>{Ca.controlId===this.yf.InstanceId&&Array.forEach(this.IH,tb=>{tb.NWi(Ca)&&tb.aac(Ca)})};this.YKf=Ca=>{if((Ca=Object(Ja.a)(482,Ca))&&!Ca.ey())if(!this.yf||OSF.OsfControl.isFirstPartyStoreString(this.yf.PrimaryMarketplace.MarketplaceType)||this.$.eX){Ca.rh=this.yf;Ca.Dl=this.Mk;this.Ube=Ca;this.OGc(Ca.nLa);const tb=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&Jd.a.gg()&&
Yd.HelperMethods.ez(this.yf)&&this.yf.Preload&&!this.yf.TaskpaneVisible;tb?Ca.pNd():$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(Ca.pNd(),(this.yf.SharedRuntime&&1===this.yf.SharedRuntime.LifeTime||this.yf.SharedRuntimeId)&&!this.yf.TaskpaneVisible&&Ca.Ik(!1)):((this.yf.SharedRuntime&&1===this.yf.SharedRuntime.LifeTime||this.yf.SharedRuntimeId)&&!this.yf.TaskpaneVisible&&Ca.Ik(!1),Ca.pNd());this.Wab||(Jd.a.gg()?tb||Ca.Wga():Dd.a(this.$).result.uV(Ca,
!0));this.$.ga.Da(77).s6f(this.YKf);this.wda=Object(Ja.a)(477,Ca)}else h.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};this.onFloatingObjectControlAdded=(Ca,tb)=>{3===tb.control.floatingObject.type&&tb.control.floatingObject.Vm.InstanceId===this.m5.WebExtensionId&&(this.wda=Object(Ja.a)(477,tb.control),this.OGc(tb.control.Kf.firstChild),Md.a(this.$).fDc(this.onFloatingObjectControlAdded))};this.vd=Q.$;this.Mk=Q;this.yf=ub;this.yf.InstanceId=ub.SrcLocationOverrideResourceId?
Q.qPa(ub.InstanceId,ub.SrcLocationOverrideResourceId):ub.InstanceId;this.oj=Ia;this.m5={};this.m5.WebExtensionId=ub.InstanceId;this.KWf="osfControl_"+ub.InstanceId;this.chd="disabled_"+ub.InstanceId;this.m5.BindingData=ub.BindingData;this.Wab=this.Mk.Wab(ub.InstanceId);this.kpc=this.Mk.kpc(ub.InstanceId);this.wre=ub.WebExtensionOsfControlType;this.a_f=Yb}get controlId(){return this.yf.InstanceId}get XFi(){return this.$Vc}xxi(Q){this.Sha||(this.Sha=Q)}c6f(){this.Sha&&(this.Sha.dispose(),this.Sha=null)}get controlType(){return this.yf.WebExtensionType}get ownerAddinSolutionId(){return this.yf.OwnerAddinSolutionId}get $(){return this.vd}get enabled(){return!this.OX}get visible(){return this.yf.TaskpaneVisible}get cB(){return this.lZc}get LP(){return this.yf.SrcLocationOverrideResourceId?
this.Mk.qPa(this.yf.PrimaryMarketplace.SolutionId,this.yf.SrcLocationOverrideResourceId):this.yf.PrimaryMarketplace.SolutionId}get sourceLocationOverrideResourceId(){return this.yf.SrcLocationOverrideResourceId}get Vm(){return this.yf}get wda(){return this.$ee}set wda(Q){this.$ee=Q}get osfControlType(){return this.wre}get uya(){return this.yhe}set uya(Q){this.yhe=Q}get $dc(){return this.q0a}set $dc(Q){this.q0a=Q}get focusOnIframeWhenLoaded(){return this.yf.FocusOnIframeWhenLoaded}get nrc(){return this.Rme}set nrc(Q){this.Rme=
Q}zxd(){if(!OSF.OsfControl.isFirstPartyStoreString(this.yf.PrimaryMarketplace.MarketplaceType)&&$a.EwaSettings.Ea(174)){const Ia=Object(Mb.a)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?Object(Aa.d)(Bc.a.resolve(Vc.m,{Ja:0})):$c.GetServiceTaskFactory.ud(this.$.ga,5,4,0);Kd.TaskExtensions.za(Ia,()=>{Ia.result.yi(36,null)},this.ka,3);return this}if(1===this.yf.WebExtensionType)Kd.TaskExtensions.za(Dd.a(this.$),Ia=>{Ia.result.Eyb(this.$.ga,77,5,this.YKf,1)},this.ka,3);else{var Q=this.m7e();
const Ia=Md.a(this.$);Q||(Q={Type:3},Q.Id=this.m5.WebExtensionId,Q.WebExtensionData=this.yf,Q.ContentHtml="<div/>",Q.Version=0,Q.AbsoluteLeft=0,Q.AbsoluteTop=0,Q.AbsoluteRight=0,Q.AbsoluteBottom=0,Q.Width=0,Q.Height=0,Q.ZOrder=0,Q.OriginDeltaX=0,Q.OriginDeltaY=0,Q=new Ka.a(Q),Ia.Rcc(Q,null),Q=Ia.qt(Q.Wi()));Q?(this.OGc(Q.Kf.firstChild),this.wda=Object(Ja.a)(477,Q)):Ia.P7b(this.onFloatingObjectControlAdded)}return this}npf(Q){this.OGc(Q);return this}vxc(){this.a_f||this.Mk.Vg.purgeOsfControl(this.controlId,
!1);const Q=this.$.qa.ua.ie();ab.a(this.$.userOperationManager,(ub,Yb,Ca)=>hc.e(this.$.qa.ua,this.yf.InstanceId,ub,Yb,Ca,Q),ub=>new xc.a(606,0,ub,64),null);this.Ftg(!0);const Ia=this.m7e();Ia&&Md.a(this.$).deleteFloatingObject(Ia);this.Mk.lj.qzj(this.controlId);this.Mk.lj.E_e(this.controlId,!0);this.lZc=null}CNd(Q){this.m5=Q}invokeDdaMethod(Q,Ia){if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var ub={};ub[Na.a.Th]=Q;ub[Na.a.N7]=Ia;this.Mk.wN(974713501,ub)}else this.Mk.Aj(Ha.a.UGb,
Ia)}xwj(Q,Ia,ub,Yb){if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!Tc.qCh(Q)||void 0!==Ia&&null!==Ia&&void 0!==this.S8a(Ia)&&null!==this.S8a(Ia))if(h.ULS.sendTraceTag(36444195,0,50,`eventId: ${Q}, targetId: ${Ia}`),Tc.Tsf(Q)&&this.rsi(),Tc.Nzd(Q)&&this.iwd(),Tc.Rsf(Q))this.$Vc=!0,this.Mk.$.ga.Da(232).addHandler(this.controlId,ub,Yb,Ia);else if(Tc.Ssf(Q))this.$Vc=!0,this.Mk.$.ga.Da(232).$Vg(this.controlId,ub,Yb);else{Tc.Qsf(Q)&&this.xkf(-1777565636,Yb);
this.IH||(this.IH=[]);var Ca=this.LBb(Q,Ia);Ca||(Ca=new qb(Q,Ia),this.IH.push(Ca));Ca.Hra();Ca.Z7b(ub);this.Mk.Yx(Yb);Q===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.q0a&&(this.aec=ub)}else this.Mk.Aj(3002,Yb);else this.Mk.Aj(-1,Yb)}pfk(Q,Ia,ub,Yb){Tc.Rsf(Q)?this.Mk.$.ga.Da(232).removeHandler(this.controlId,Yb):Tc.Ssf(Q)?this.Mk.$.ga.Da(232).Izj(this.controlId,Yb):(Tc.Qsf(Q)&&this.xkf(1592314317,Yb),Ia=this.LBb(Q,Ia),this.enabled?(Ia&&(Ia.oDc(ub),Ia.nqi||Array.remove(this.IH,Ia),this.IH.length?
Tc.Tsf(Q)&&this.Gtg(!1):this.Ftg(!1)),this.Mk.Yx(Yb)):this.Mk.Aj(-1,Yb))}la(Q){Rd.DOMElementExtensions.getElementById(Q,this.KWf)||Q.appendChild(Rd.DOMElementExtensions.Oh(this.cB))}showHide(Q){Rd.DOMElementExtensions.setVisible(this.cB,Q)}resize(Q,Ia){Rd.DOMElementExtensions.Mz(this.cB,Q);Rd.DOMElementExtensions.bM(this.cB,Ia)}zXe(Q){if(!this.OX&&!Rd.DOMElementExtensions.getElementById(this.cB,this.chd)&&this.cB){const Ia=document.createElement("div");Ia.id=this.chd;Ia.className=Wb;Ia.style.backgroundImage=
"url("+uc.a.current.tq(101)+")";Ia.style.opacity=Q?"1":"0";Ia.style.backgroundRepeat="no-repeat";Ia.style.backgroundPosition="center";this.cB.insertBefore(Ia,this.cB.firstChild)}this.OX++}nFh(){0<this.OX&&this.OX--;this.OX||(Rd.DOMElementExtensions.Oh(Rd.DOMElementExtensions.getElementById(this.cB,this.chd)),this.TAa&&!rc.R(this.ZAc,Va.h(this.$).ha.ra.selectedRanges)&&this.uf(null,null))}S8a(Q){if(!this.m5||!this.m5.BindingData)return null;for(let Ia=0;Ia<this.m5.BindingData.length;Ia++)if(this.m5.BindingData[Ia].Name===
Q)return this.m5.BindingData[Ia];return null}getDefaultIconUrl(){const Q=this.Sff();return Q?Q.getDefaultIconUrl():null}getDefaultDisplayName(){if(this.yf.TaskpaneTitle)return this.yf.TaskpaneTitle;const Q=this.Sff();return Q?Q.getDefaultDisplayName():null}f0f(){if(this.q0a&&this.aec){const Q=new U.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.q0a);this.aec(Q);this.aec=this.q0a=null}}Ik(Q){this.Ube&&this.Ube.Ik(Q)}FPj(){this.$.ea.isNamedObjectViewMode&&this.kIi()&&(this.$.ga.Da(34).EPj(this.cB),
this.showHide(!1));if(this.Mk.rok){if(!this.a_f){const Q={};Q.div=this.cB;Q.id=this.yf.InstanceId;Q.solutionId=this.yf.PrimaryMarketplace.SolutionId;Q.version=this.yf.PrimaryMarketplace.SolutionVersion;Q.storeId=this.yf.PrimaryMarketplace.MarketplaceRef;Q.storeType=this.yf.PrimaryMarketplace.MarketplaceType;Q.ownerAddinSolutionId=this.yf.OwnerAddinSolutionId;Q.ownerAddinStoreType=this.yf.OwnerAddinStoreType;this.yf.AssetMarketplace?(Q.assetId=this.yf.AssetMarketplace.SolutionId,Q.assetStoreId=this.yf.AssetMarketplace.MarketplaceRef):
(Q.assetId=null,Q.assetStoreId=null);Q.settings=this.yf.OsfPropertyBag;Q.hostSettings=this.yf.HostPropertyBag;$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?Q.reason=this.Wab?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.kpc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:Q.reason=this.Wab?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:
Microsoft.Office.WebExtension.InitializationReason.Inserted;Q.osfControlType=0===this.yf.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;Q.isForUILessAction=4===this.yf.WebExtensionOsfControlType;Q.sourceLocationOverrideResourceId=this.yf.SrcLocationOverrideResourceId;Q.focusOnIframeWhenLoaded=this.yf.FocusOnIframeWhenLoaded;ce.a(this.yf)&&(Q.featureGates=m.AFrameworkApplication.da.adf(Q.solutionId));Q.hostInfoFlags=0;this.uya&&(Q.hostInfoFlags|=2);Yd.HelperMethods.ez(this.yf)&&
(Q.hostInfoFlags|=1);this.$.eX||(h.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),Q.hostInfoFlags|=4);$a.EwaSettings.Ea(553)&&(Q.hostInfoFlags|=8);Q.sharedRuntimeId=this.yf.SharedRuntime?this.yf.SharedRuntime.Resid:this.yf.SharedRuntimeId;!Yd.HelperMethods.ez(this.yf)||this.yf.Preload||ce.a(this.yf)||this.Mk.Vg.getOsfControl(a(775).DdaFacade.getSolutionId(this.yf,this.$))||($a.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&
this.Mk.DVf(this.yf):this.Mk.DVf(this.yf));Q.onExtensionLaunchCallback=this.yf.OnExtensionLaunchCallback;Q.initialDisplayMode=this.yf.TaskpaneVisible?2:1;$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(Q.titleOverride=this.Vm.TaskpaneTitle);this.Mk.Vg.insertOsfControl(Q)}this.OX=0}else this.zXe(!0)}Ftg(Q){this.Gtg(Q);this.Xek()}rsi(){this.pjb||this.oj.Z7b(this.vkf);this.pjb++}Gtg(Q){0<this.pjb&&(Q?this.pjb=0:this.pjb--,this.pjb||this.oj.oDc(this.vkf))}iwd(){if(!this.TAa){const Q=
Va.h(this.$).ha;this.ZAc=rc.d(Va.h(this.$).ha.ra.selectedRanges);Q.S0(this.uf);this.TAa=!0}}Xek(){this.TAa&&(Va.h(this.$).ha.m4(this.uf),this.TAa=!1)}vMj(Q){var Ia=new Pb.Range(Q.Reference.FirstRow+1,Q.Reference.FirstColumn+1,Q.Reference.LastRow+1,Q.Reference.LastColumn+1,!1,!1);1===Q.BindingType&&(Q.HasHeaders&&--Ia.top,Q.HasTotals&&(Ia.bottom+=1));var ub=Va.h(this.$).ha.ra.selectedRanges;Q=Ia.Pab(this.ZAc);ub=Ia.Pab(ub);return(Ia=Ia.wg(Va.h(this.$).ha.ra.activeRange))&&(ge.e(Q)&&!ge.e(ub)||!ge.e(Q)&&
!ge.e(ub)&&!rc.R(Q,ub))?Ia:null}ANj(){Array.forEach(this.IH,Q=>{if(Q.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Q.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||this.Mk.lj.r9b(this.controlId))if(Q.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)Q.aac(new U.a(Q.eventId,this.controlId,null));else if(Q.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){const Ia=this.S8a(Q.targetId);if((null===Ia||void 0===Ia?0:Ia.IsValidRef)&&
(this.$.ea.isNamedObjectViewMode?this.$.Ud.na.sheetName:this.$.va.na.name)===Ia.Reference.SheetName){const ub=this.vMj(Ia);ub&&Q.aac(new ja(Q.eventId,this.controlId,this.Mk.$9b(Ia),Ia,ub.top-1,ub.left-1,ub.height,ub.width))}}})}LBb(Q,Ia){if(!this.IH)return null;for(let ub=0;ub<this.IH.length;ub++){const Yb=this.IH[ub];if(Yb.eventId===Q&&Yb.targetId===Ia)return Yb}return null}m7e(){const Q=Md.a(this.$).iY;for(let Ia=Q.length-1;0<=Ia;--Ia){const ub=Q[Ia];if(3===ub.floatingObject.type&&ub.floatingObject.Vm.InstanceId===
this.m5.WebExtensionId)return ub}return null}kIi(){for(let Q=0;Q<this.$.Ud.count;Q++)if(this.$.Ud.getItem(Q).imageId===this.m5.WebExtensionId)return!0;return!1}OGc(Q){this.lZc=Q;this.cB.id=this.KWf;this.cB.className=Yc;this.cB.dir=this.$.isChromeRtl?"rtl":"ltr";this.FPj()}Sff(){if(!this.enabled)return null;const Q=ce.a(this.Vm)?"":this.Vm.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.Vm.PrimaryMarketplace.SolutionId,Q)}xkf(Q,Ia){try{if(h.ULS.sendTraceTag(537170462,
0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.wre)this.Mk.Aj(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,Ia);else{const ub={};ub[Y.a.Oub]=this.controlId;const Yb=new dd.a(Q,0,this.$.isEditMode?2:1,0,null);this.$.Ha.Ad(Yb,ub);this.Mk.Yx(Ia)}}catch(ub){h.ULS.sendTraceTag(537170461,0,10,`HandleDialogNotificationShownInAddinEvent called. Error message: ${ub.message}.`),this.Mk.Aj(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Ia)}}static qCh(Q){return Q===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||
Q===OSF.DDA.EventDispId.dispidBindingDataChangedEvent}static Tsf(Q){return Q===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||Q===OSF.DDA.EventDispId.dispidSettingsChangedEvent||Q===OSF.DDA.EventDispId.dispidRichApiMessageEvent}static Nzd(Q){return Q===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Q===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static Rsf(Q){return Q===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent}static Ssf(Q){return Q===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static Qsf(Q){return Q===
OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent}}Object(b.a)(Tc,"OsfControl",yb.a,[822]);class ed{constructor(){this.V3a={}}add(Q){this.V3a[Q]=!0}remove(Q){delete this.V3a[Q]}clear(){for(const Q of Object.keys(this.V3a))delete this.V3a[Q]}Jlf(){return 0<Object.keys(this.V3a).length}w1h(){return Object.keys(this.V3a)}}Object(b.a)(ed,"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var be=a(63);class Fc{constructor(Q,Ia,ub){this.T4f=this.S4f=0;this.MUb=this.Xgb=null;
this.u4i=()=>{var Yb=Va.h(this.$).ha.Va.FD;if(this.vzd(Yb)&&(Yb=this.$Cb(Yb))){var Ca={};Ca.chartId=Yb;Ca.worksheetId=this.Rna();Ca=be.a.He(Ca);this.qna(51,Yb,Ca);this.qna(51,this.Rna(),Ca)}};this.v4i=()=>{if(this.Xgb){var Yb={};Yb.chartId=this.Xgb;Yb.worksheetId=this.MUb;Yb=be.a.He(Yb);this.qna(52,this.Xgb,Yb);this.qna(52,this.MUb,Yb)}Yb=Va.h(this.$).ha.Va.FD;this.vzd(Yb)?(this.Xgb=this.$Cb(Yb),this.MUb=this.Rna()):this.MUb=this.Xgb=null};this.$=Q;this.lj=Ia;this.oj=ub}Nvb(Q){51===Q.messageType?
this.S4f=this.KLa(Q.actionType,this.S4f,this.u4i):52===Q.messageType&&(this.T4f=this.KLa(Q.actionType,this.T4f,this.v4i))}KLa(Q,Ia,ub){if(1===Q)Ia||Va.h(this.$).ha.Va.p5c(ub),Ia++,this.BTj();else if(2===Q){if(1>Ia)return Ia;1===Ia&&Va.h(this.$).ha.Va.KVd(ub);Ia--}return Ia}qna(Q,Ia,ub){Ia&&this.lj.RK(Q,Ia)&&this.oj.OF(Q,Ia,ub)}$Cb(Q){return Q&&Q.floatingObject?(Q=Q.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&1===Q.length?Q[0]:null:null}Rna(){const Q=this.$.va.na;
return Q&&0===Q.YI?Q.sheetId:null}BTj(){const Q=Va.h(this.$).ha.Va.FD;this.vzd(Q)&&(this.Xgb=this.$Cb(Q),this.MUb=this.Rna())}vzd(Q){return!!Q&&!!Q.floatingObject&&0===Q.floatingObject.type}}Object(b.a)(Fc,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var vd=a(771),lb=a(195),Eb=a(628),Hc=a(107),Bd=a(360),he=a(62);class je extends sc.a{constructor(Q,Ia,ub){super();this.OX=this.zEa=0;this.uf=(Yb,Ca)=>{if(this.enabled&&!(this.Muf()||null!==Ca&&void 0!==Ca&&Ca.$xf)&&(Yb=Object(Ja.a)(Hc.a,this.$.va.na))&&
0===Yb.YI){const tb=Yb.sheetId,$b=this.Wbf();let cd=null,sd=null;this.lj.Oxf()&&(cd=this.grid.zd.sh(this.grid.ha.ra.activeCell),sd=tb in this.stc?this.stc[tb]:null);this.vGe(tb,$b)&&Kd.TaskExtensions.za(he.Task.Wa(!0),()=>{this.Lpi(tb,$b);this.upi(tb,$b,cd,sd)},this.ka);this.zYe(tb,$b,cd)}};this.$=Q;this.lj=Ia;this.oj=ub;this.grid=Va.h(Q);this.bTa={};this.stc={}}get enabled(){return!this.OX&&0<this.zEa}M9b(Q){Object(Ja.a)(Bd.a,this.$.va);1===Q.actionType?(this.zEa||this.grid.ha.S0(this.uf),this.zEa++):
2!==Q.actionType||1>this.zEa||(1===this.zEa&&this.grid.ha.m4(this.uf),this.zEa--)}xGc(Q){Q?this.OX++:(0<this.OX&&this.OX--,this.OX||this.uf(null,new Eb.a(!1)))}Wbf(){return this.grid.ha.ra.selectedRanges}vGe(Q,Ia){return $a.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!Q&&lb.e(this.bTa)||Q in this.bTa)&&!rc.R(this.bTa[Q],Ia):Q in this.bTa&&!rc.R(this.bTa[Q],Ia)}zYe(Q,Ia,ub){this.bTa[Q]=rc.d(Ia);this.stc[Q]=ub}Muf(){return this.grid.ld||
this.grid.fl}K7e(Q,Ia){this.lj.RK(14,Q)&&this.oj.OF(14,Q,Ia);this.lj.RK(14,vd.a.oO)&&this.oj.OF(14,vd.a.oO,Ia)}Lpi(Q,Ia){const ub={};ub.worksheetId=Q;ub.address=this.fsd(Ia);Ia=be.a.He(ub);this.K7e(Q,Ia)}upi(Q,Ia,ub,Yb){if(this.lj.Oxf()){var Ca="";let tb="";Yb&&(Ca=Yb.El);ub&&(tb=ub.El);Yb?ub?(Ia=ub.usedRange.Pab(Ia),Ca!==tb&&this.Cic(Ca,"",Q),this.Cic(tb,this.fsd(Ia),Q)):this.Cic(Ca,"",Q):ub&&(Ca=ub.usedRange.Pab(Ia),this.Cic(tb,this.fsd(Ca),Q))}}Cic(Q,Ia,ub){if(this.lj.RK(100,Q)){const Yb={};Yb.address=
Ia;Yb.worksheetId=ub;this.oj.OF(100,Q,be.a.He(Yb))}}fsd(Q){return rc.i(Q,",",this.$,!1)}dispose(){0<this.zEa&&this.grid.ha.m4(this.uf);this.stc=this.bTa=null;this.zEa=0;this.oj=this.lj=this.$=this.grid=null}}Object(b.a)(je,"RichApiEventSelectionChangedHandler",sc.a,[]);var Fd=a(356);class Oc extends je{constructor(Q,Ia,ub){super(Q,Ia,ub);this.Xzf=this.Yzf=null}Wbf(){return Fd.a.ndc(this.grid.ha.rangePicker.dO)}vGe(Q,Ia){return this.Yzf!==Q||!rc.R(this.Xzf,Ia)}zYe(Q,Ia){this.Yzf=Q;this.Xzf=rc.d(Ia)}Muf(){return!this.grid.ld&&
!this.grid.fl}K7e(Q,Ia){this.lj.RK(2700,vd.a.oO)&&this.oj.OF(2700,vd.a.oO,Ia)}}Object(b.a)(Oc,"RichApiEventPickedRangesChangedHandler",je,[]);class Ad{constructor(Q,Ia,ub){this.lWa=this.kWa=0;this.lMa=this.Rla=null;this.FOf=()=>{var Yb=Va.h(this.$).ha.Va.FD;if(0<this.lWa&&this.Rla&&this.lMa){var Ca={};Ca.shapeId=this.Rla;Ca.worksheetId=this.lMa;Ca=be.a.He(Ca);this.fireEvent(2102,this.Rla,Ca)}this.dKi(Yb)?(this.Rla=this.zdk(Yb),this.lMa=this.Rna(),this.Rla&&this.lMa)?0<this.kWa&&(Yb={},Yb.shapeId=
this.Rla,Yb.worksheetId=this.lMa,Yb=be.a.He(Yb),this.fireEvent(2101,this.Rla,Yb)):h.ULS.sendTraceTag(537170458,344,10,`Something goes wrong, we got invalid shape id: '${this.Rla}', or worksheet id: '${this.lMa}' from a Floating object or gridview.`):this.lMa=this.Rla=null};this.$=Q;this.lj=Ia;this.oj=ub}Nvb(Q){const Ia=Va.h(this.$).ha;1===Q.actionType?(this.kWa||this.lWa||Ia.Va.p5c(this.FOf),2101===Q.messageType?this.kWa++:2102===Q.messageType&&this.lWa++):2===Q.actionType&&(2101===Q.messageType?
this.kWa=0<this.kWa?this.kWa-1:0:2102===Q.messageType&&(this.lWa=0<this.lWa?this.lWa-1:0),this.kWa||this.lWa||Ia.Va.KVd(this.FOf))}dKi(Q){return!!Q&&!!Q.floatingObject&&(0===Q.floatingObject.type||7===Q.floatingObject.type||1===Q.floatingObject.type||3===Q.floatingObject.type||5===Q.floatingObject.type)}zdk(Q){if(!Q||!Q.floatingObject)return null;Q=Q.floatingObject.id;var Ia=Q.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));Ia=Ia&&1===Ia.length?Ia[0]:null;return Ia?Ia:(h.ULS.sendTraceTag(537170457,
344,10,`Expect get the guid like shape id from the floating object id: '${Q}', but we failed.`),null)}Rna(){const Q=this.$.va.na;return Q&&0===Q.YI?Q.sheetId:null}fireEvent(Q,Ia,ub){Ia&&this.lj.RK(Q,Ia)&&this.oj.OF(Q,Ia,ub)}}Object(b.a)(Ad,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);class Gb{constructor(Q,Ia,ub){this.X4f=this.W4f=this.Y4f=this.V4f=0;this.Xgj=(Yb,Ca)=>{Yb=Object(Ja.a)(Hc.a,Ca.na);this.Rcb(Yb)&&(Ca={},Ca.worksheetId=Yb.sheetId,Ca=be.a.He(Ca),this.qna(11,Yb.sheetId,Ca))};
this.$gj=(Yb,Ca)=>{Yb=Object(Ja.a)(Hc.a,Ca.rE);this.Rcb(Yb)&&(Ca={},Ca.worksheetId=Yb.sheetId,Ca=be.a.He(Ca),this.qna(12,Yb.sheetId,Ca))};this.Ygj=(Yb,Ca)=>{Yb=Object(Ja.a)(Hc.a,Ca.na);this.Rcb(Yb)&&(Ca={},Ca.worksheetId=Yb.sheetId,Yb=be.a.He(Ca),this.qna(11,null,Yb,!0))};this.Zgj=(Yb,Ca)=>{Yb=Object(Ja.a)(Hc.a,Ca.rE);this.Rcb(Yb)&&(Ca={},Ca.worksheetId=Yb.sheetId,Yb=be.a.He(Ca),this.qna(12,null,Yb,!0))};this.$=Q;this.lj=Ia;this.oj=ub}Nvb(Q){11===Q.messageType?Q.targetId===vd.a.oO?this.$5g(Q.actionType):
this.Z5g(Q.actionType):12===Q.messageType&&(Q.targetId===vd.a.oO?this.a6g(Q.actionType):this.b6g(Q.actionType))}Z5g(Q){this.V4f=this.KLa(Q,this.V4f,this.Xgj)}b6g(Q){this.Y4f=this.KLa(Q,this.Y4f,this.$gj)}$5g(Q){this.W4f=this.KLa(Q,this.W4f,this.Ygj)}a6g(Q){this.X4f=this.KLa(Q,this.X4f,this.Zgj)}KLa(Q,Ia,ub){1===Q?Ia=this.JLa(Ia,ub):2===Q&&(Ia=this.ONa(Ia,ub));return Ia}JLa(Q,Ia){Q||this.$.va.Ri(Ia);Q++;return Q}ONa(Q,Ia){if(1>Q)return Q;1===Q&&this.$.va.uj(Ia);Q--;return Q}Rcb(Q){return!!Q&&0===Q.YI}qna(Q,
Ia,ub,Yb){Ia=(void 0===Yb?0:Yb)?vd.a.oO:Ia;this.lj.RK(Q,Ia)&&this.oj.OF(Q,Ia,ub)}}Object(b.a)(Gb,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var Wc=a(250),pd=a(13),fe=a(234);class le extends Sys.EventArgs{constructor(Q,Ia,ub,Yb){super();this.sheet=Q;this.Beh=Ia;this.offsetX=ub;this.offsetY=Yb}}Object(b.a)(le,"ClickInActiveCellEventArgs",Sys.EventArgs,[]);class te{constructor(Q,Ia,ub){this.rbc=null;this.GDd=!1;this.onPointerDown=Yb=>{let Ca;3===Yb.Gd?((()=>{let tb=this.gridView.Rjc(Yb.clientPoint);
({a6a:Ca}=tb);return tb})(),this.GDd=!!Ca&&this.gridView.ha.ra.FYe(Ca)):this.GDd=!1;this.rbc=Yb.clientPoint;return!1};this.mf=Yb=>{if(this.gridView.inRangePicker||this.gridView.fl||this.GDd||Yb.shiftKey||Yb.ctrlKey||Yb.Ba.button!==Sys.UI.MouseButton.leftButton||!this.rbc||!Yb.clientPoint||Yb.clientPoint.x!==this.rbc.x||Yb.clientPoint.y!==this.rbc.y)return!1;let Ca;var tb=(()=>{let cd=this.gridView.Rjc(Yb.clientPoint);({a6a:Ca}=cd);return cd})().returnValue;const $b=Object(Ja.a)(Hc.a,this.$.va.na);
if(tb&&$b&&0===$b.YI){if(!this.gridView.ha.ra.x8.contains(Ca))return!1;tb=new le($b,Ca,Yd.HelperMethods.oQd(tb.x),Yd.HelperMethods.oQd(tb.y));this.ahj(tb)}return!1};this.$=Q;this.gridView=Va.h(Q);this.lj=Ia;this.oj=ub;this.dyj()}dispose(){this.Mfk()}dyj(){for(const Q of this.gridView.Xp){const Ia=Q.domElement;Wc.a.instance.ta(pd.a.pointerDown,Ia,this.onPointerDown);fe.a.instance.ta(pd.a.click,Ia,this.mf)}}Mfk(){for(const Q of this.gridView.Xp){const Ia=Q.domElement;Wc.a.instance.Aa(pd.a.pointerDown,
Ia,this.onPointerDown);fe.a.instance.Aa(pd.a.click,Ia,this.mf)}}ahj(Q){var Ia=Q.sheet;if(this.Rcb(Ia)){var ub={};ub.worksheetId=Ia.sheetId;ub.address=Q.Beh.toString();ub.offsetX=Q.offsetX;ub.offsetY=Q.offsetY;Q=Ia.sheetId;this.lj.RK(21,Q)&&(Ia=be.a.He(ub),this.oj.OF(21,Q,Ia));Q=vd.a.oO;this.lj.RK(21,Q)&&(ub=be.a.He(ub),this.oj.OF(21,Q,ub))}}Rcb(Q){return!!Q&&0===Q.YI}}Object(b.a)(te,"RichApiEventSingleClickedHandler",null,[]);class Ce{constructor(Q,Ia,ub){this.ZQb=0;this.Mgb=this.Ugb=null;this.RVf=
()=>{const Yb=Va.h(this.$).ha.Va.FD;if(Yb)if(this.Byf(Yb)){const Ca=this.Rna();this.lmd(Ca);this.Ugb=Yb.floatingObject.id;this.Mgb=Ca}else this.Ugb&&(this.lmd(this.Mgb),this.Mgb=this.Ugb=null);else this.Ugb&&(this.lmd(this.Mgb),this.Mgb=this.Ugb=null)};this.$=Q;this.lj=Ia;this.oj=ub}M9b(Q){2E3===Q.messageType&&(1===Q.actionType?(this.ZQb||Va.h(this.$).ha.Va.p5c(this.RVf),this.ZQb++,this.NPj()):2===Q.actionType&&this.ZQb&&(1===this.ZQb&&Va.h(this.$).ha.Va.KVd(this.RVf),this.ZQb--))}lmd(Q){var Ia;const ub=
{};ub.worksheetId=Q;ub.revisionLoad=!1;if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&($a.EwaSettings.Ea(616)||$a.EwaSettings.isChangeGateEnabled("OfficeVSO:7872385_ChartPlayerManualPlacement"))){const Yb=Va.h(this.$).ha.Va.FD;(null===(Ia=null===Yb||void 0===Yb?void 0:Yb.floatingObject)||void 0===Ia?0:Ia.df)?ub.selectedVisualId=Yb.floatingObject.df.VisualID:ub.selectedVisualId=null}Ia=be.a.He(ub);Q&&this.lj.RK(2E3,Q)&&this.oj.OF(2E3,Q,Ia)}Rna(){const Q=
this.$.va.na;return Q&&0===Q.YI?Q.sheetId:null}NPj(){const Q=Va.h(this.$).ha.Va.FD;this.Byf(Q)&&(this.Ugb=Q.floatingObject.id,this.Mgb=this.Rna())}Byf(Q){return!!Q&&Q.dEd()}}Object(b.a)(Ce,"RichApiEventVisualSelectionChangedHandler",null,[]);class Xb{constructor(Q,Ia,ub){this.$Qb=0;this.Hzg=!0;this.Pic=0;this.yCd=!0;this.UMe=()=>{const Yb=document.hasFocus();if(this.Hzg!==Yb){if(Yb){const Ca=be.a.He({});this.oj.OF(2203,vd.a.oO,Ca)}this.Hzg=Yb}};this.VMe=Yb=>{(0<Yb.timeRemaining()||Yb.didTimeout)&&
this.UMe();window.requestIdleCallback(this.VMe)};this.$=Q;this.lj=Ia;this.oj=ub;window.requestIdleCallback||(this.yCd=!1)}Y5g(Q){1===Q.actionType?(this.$Qb||this.o6g(),this.$Qb++):2!==Q.actionType||1>this.$Qb||(1===this.$Qb&&this.Ryh(),this.$Qb--)}o6g(){if(this.lj.RK(2203,vd.a.oO))if(this.yCd){const Q={};Q.timeout=this.$.xa.CheckFocusTimeout;this.Pic=window.requestIdleCallback(this.VMe,Q)}else this.Pic=window.setInterval(this.UMe,this.$.xa.CheckFocusTimeInterval)}Ryh(){this.yCd?window.cancelIdleCallback(this.Pic):
window.clearInterval(this.Pic)}}Object(b.a)(Xb,"RichApiEventWorkbookActivatedHandler",null,[]);var oc;(function(Q){Q[Q.none=0]="none";Q[Q.registerEvent=1]="registerEvent";Q[Q.unregisterEvent=2]="unregisterEvent";Q[Q.customFunction=3]="customFunction";Q[Q.showCard=4]="showCard";Q[Q.createWorkbook=5]="createWorkbook";Q[Q.openWorkbook=6]="openWorkbook";Q[Q.enableEvents=7]="enableEvents";Q[Q.closeWorkbook=8]="closeWorkbook";Q[Q.setCalculationMode=9]="setCalculationMode";Q[Q.workbookLinksRequestRefresh=
10]="workbookLinksRequestRefresh";Q[Q.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";Q[Q.workbookLinksEnableContent=12]="workbookLinksEnableContent";Q[Q.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";Q[Q.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";Q[Q.rangePicker=15]="rangePicker";Q[Q.enableRichApiRecording=16]="enableRichApiRecording";Q[Q.recordAction=17]="recordAction";Q[Q.focus=18]="focus";Q[Q.businessBarShow=19]="businessBarShow";Q[Q.businessBarHide=
20]="businessBarHide";Q[Q.augmentationLoopActivateAnnotation=21]="augmentationLoopActivateAnnotation";Q[Q.augmentationLoopSubmitSignal=22]="augmentationLoopSubmitSignal";Q[Q.showRangeValuesPreview=23]="showRangeValuesPreview";Q[Q.hideRangeValuesPreview=24]="hideRangeValuesPreview"})(oc||(oc={}));Object(b.b)("PostProcessActionType",oc);var Zc=a(263);class yd{constructor(Q,Ia,ub){this.LWf=null;this.jmd=(Yb,Ca)=>{const tb=vd.a.oO,$b={};$b.eventId=Yb;$b.payload=Ca;this.lj.RK(2201,tb)&&this.oj.OF(2201,
tb,be.a.He($b))};this.$=Q;this.lj=Ia;this.oj=ub;this.Xwi()}X5g(Q){1===Q.actionType?(this.$.A9=!0,Object(Ja.a)(a(775).DdaFacade,Zc.a(this.$)).kmd(!0)):2===Q.actionType&&(this.$.A9=!1);this.LWf=Q.controlId;h.ULS.sendTraceTag(537170456,0,50,`AttachOrDetachMacroRecorderEventHandler: actionType: ${oc[Q.actionType]}; controlId: ${this.LWf}; this.ewaControl.IsMacroRecorderListening: ${this.$.A9}.`)}FGh(Q){Object(Ja.a)(a(775).DdaFacade,Zc.a(this.$)).N7e(Q,this.$.A9)}Xwi(){this.$.UY&&Kd.TaskExtensions.za($a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2Services15",
!1)?Object(Aa.d)(Bc.a.resolve(Vc.Lb,{Ja:1})):$c.GetServiceTaskFactory.ud(this.$.ga,297,298,1),Q=>{(Q=Q.result)&&Q.init(this.jmd)},this.$.ka,3)}}Object(b.a)(yd,"RichApiMacroRecorderEventHandler",null,[]);class Od{}Object(b.a)(Od,"StyleCacheItem",null,[]);class dc{constructor(Q,Ia,ub){this.$=Q;this.gridView=Ia;this.eh=ub}Dla(Q){this.range=Q;this.Kbc=Array(Q.width);this.zJc=Array.from({length:Q.height},()=>Array(Q.width))}vPj(Q,Ia,ub,Yb){this.Mwf(Q,Ia)&&(this.zJc[Q-this.range.top][Ia-this.range.left]||
(this.zJc[Q-this.range.top][Ia-this.range.left]={backgroundColor:ub.backgroundColor}),ub.backgroundColor=Yb)}xPj(Q,Ia,ub){if(this.Mwf(Q,Ia)){Q=Pb.Range.Je(Q,Ia);var Yb=this.gridView.Hd(Q);Yb&&(this.Kbc[Ia-this.range.left]||(this.Kbc[Ia-this.range.left]=Yb.width),Ia=this.eh.b4d(this.gridView,[Q],ub,!1),"Success"!==Ia.kind&&h.ULS.sendTraceTag(509223560,0,10,`InstantaneousGridContentRestorer.setColumnWidth: failed to set column width - ${Ia.reason}`))}}restore(){this.range&&(this.Kbc.forEach((Q,Ia)=>
{Q=this.eh.b4d(this.gridView,[Pb.Range.Je(this.range.top,this.range.left+Ia)],Q,!1);"Success"!==Q.kind&&h.ULS.sendTraceTag(509220497,0,10,`InstantaneousGridContentRestorer.restore: failed to set column width - ${Q.reason}`)}),this.zJc.forEach((Q,Ia)=>{Q.forEach((ub,Yb)=>{Yb=Pb.Range.Je(this.range.top+Ia,this.range.left+Yb);if(Yb=this.gridView.Hd(Yb))Yb.cell.backgroundColor=ub.backgroundColor})}),this.Kbc=this.zJc=this.range=void 0)}Mwf(Q,Ia){if(!this.range)return h.ULS.sendTraceTag(509223559,0,15,
"InstantaneousGridContentRestorer.isRowColInRange: range not yet created - begin has not been called"),!1;(Q=this.range.contains(Pb.Range.Je(Q,Ia)))||h.ULS.sendTraceTag(509223558,0,10,"InstantaneousGridContentRestorer.isRowColInRange: row/column not in range");return Q}}Object(b.a)(dc,"InstantaneousGridContentRestorer",null,[]);var gd=a(221),wd=a(146);class Ld{constructor(Q,Ia,ub,Yb){this.Aei=Ca=>{const tb=Ca.af.block;if(this.rw.wg(tb.$f)){this.RYf([tb.$f]);const $b=Va.h(this.$).G_(tb.$f),cd=()=>
this.KYf([tb.$f]);setTimeout(()=>{$b.skeletonMode?setTimeout(()=>{$b.skeletonMode?h.ULS.sendTraceTag(509220498,0,10,"RichApiRangeValuesPreview.getRangeCallback: skeleton mode not dismissed within alloted time"):cd()},Ld.oCg):cd()},Ld.dDg)}};this.N3=(Ca,tb)=>{0===tb.Dt&&576!==tb.Yh.operation.operationName&&this.QFb(!0)};this.YNd=Ca=>{this.pIc&&(this.iWh(Ca),this.p4())};this.$=Q;this.lj=Ia;this.oj=ub;this.gridView=Va.h(this.$);this.Poc=new dc(this.$,this.gridView,Yb)}npi(Q,Ia,ub,Yb){this.$vf(Q)?(Ia=
this.Kch(Ia,ub))?this.caa?h.ULS.sendTraceTag(509227293,0,15,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: preview already showing, exit"):(this.worksheetId=Q,this.rw=Ia,this.values=ub,this.gba(Yb)):h.ULS.sendTraceTag(509384200,0,10,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to calculate range"):h.ULS.sendTraceTag(509384201,0,50,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: not showing the preview, desired worksheet not supported for this operation")}Bni(Q){this.$vf(Q)?
this.QFb(!1):h.ULS.sendTraceTag(509359639,0,50,"RichApiRangeValuesPreview.handleHideRangeValuesPreviewPostProcessAction: not hiding the preview, desired worksheet not supported for this operation")}gba(Q){this.RYf(this.zaf());Q&&(h.ULS.sendTraceTag(509227290,0,50,`RichApiRangeValuesPreview.showPreview: options: ${JSON.stringify(Q)}`),Q.autoexpandTable&&this.Pch(),Q.autofitColumns&&this.jch());this.pIc=this.gridView.sL.gba(this.rw,this.Aei).then(Ia=>{h.ULS.sendTraceTag(509384199,0,50,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: preview shown");
this.caa=Ia;this.Poc.Dla(this.rw);this.KYf(this.zaf());this.$.userOperationManager.Pr(this.N3);Ia.pYd.then(()=>this.YNd(!0),()=>this.YNd(!0));return Promise.resolve()},Ia=>{h.ULS.sendTraceTag(509384198,0,10,`RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to show preview, rejectionString = ${Ia}`);this.p4();return Promise.resolve()})}QFb(Q){this.pIc&&(h.ULS.sendTraceTag(509359638,0,50,"RichApiRangeValuesPreview.hidePreview: showPromise exists, will hide preview"),this.pIc.then(()=>
{const Ia=this.caa;this.YNd(Q);Ia&&Ia.vfa("RichApiRangeValuesPreview")},()=>{h.ULS.sendTraceTag(509383618,0,10,"RichApiRangeValuesPreview.hidePreview: unexpected rejection of this.showPromise")}))}Kch(Q,Ia){Q=rc.ab(Q,this.$.va);if(Q.returnValue)return new Pb.Range(Q.range.top,Q.range.left,Q.range.top+Ia.length-1,Q.range.left+Ia[0].length-1,!0,!0)}$vf(Q){const Ia=this.$.va.na;return Ia&&Q===Ia.sheetId}RYf(Q){this.cnd(Q,(Ia,ub,Yb,Ca)=>{Ca.cell.qra=this.values[Ia][ub];return!0})}KYf(Q){this.Psa&&this.cnd(Q,
(Ia,ub,Yb,Ca)=>{this.Poc.vPj(Yb.top,Yb.left,Ca,this.W7h(Yb.top));return!0});if(this.M4a){const Ia=this.rw.Pab(Q);0<Ia.length&&this.M4a&&this.M4a.forEach((ub,Yb)=>{this.Poc.xPj(Ia[0].top,this.rw.left+Yb,ub)})}}cnd(Q,Ia){for(let Yb=0;Yb<this.values.length;++Yb)for(let Ca=0;Ca<this.values[Yb].length;++Ca){const tb=Pb.Range.Je(this.rw.top+Yb,this.rw.left+Ca);if(!Q||Q.some($b=>$b.contains(tb))){var ub=this.gridView.fw(tb);if((!ub||tb.equals(ub.topLeft))&&(ub=this.gridView.Hd(tb))&&!Ia(Yb,Ca,tb,ub))return}}}zaf(){return this.gridView.ya.Xy().filter(Q=>
Q.na===this.$.na).map(Q=>Q.$f)}iWh(Q){this.lj.RK(3400,this.worksheetId)&&(Q=be.a.He({type:"RangeValuesPreviewDismissed",source:"Local",Irk:Q}),this.oj.OF(3400,this.worksheetId,Q))}p4(){this.$.userOperationManager.Ap(this.N3);this.AHj();this.Psa=this.worksheetId=this.pIc=this.values=this.rw=this.caa=void 0}Pch(){if(this.rw){var Q=this.mii(this.rw);if(Q){h.ULS.sendTraceTag(509227289,0,50,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: table directly above or to the left of the range - faking autoexpand table");
var Ia=(tb,$b)=>{var cd;return null===(cd=this.gridView.Hd(Pb.Range.Je(tb,$b)))||void 0===cd?void 0:cd.backgroundColor},ub=Q.usedRange.top;if(Q.attributes&16){var Yb=Ia(Q.usedRange.top,Q.usedRange.left);++ub}var Ca=Ia(ub,Q.usedRange.left);Ia=Ia(ub+1,Q.usedRange.left);this.Psa={srg:Q.usedRange.top,Gvd:Yb,Hak:Ca,L8g:Ia}}else h.ULS.sendTraceTag(509223561,0,50,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: table autoexpand requested but no table found")}else h.ULS.sendTraceTag(509227291,
0,10,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: this should never be called with no preview range set")}jch(){this.M4a=Array(this.rw.width);let Q=!1;this.cnd(void 0,(Ia,ub,Yb,Ca)=>{var tb;if(this.gridView.fw(Yb))return Q=!0,!1;Ia=Ca.cell;Ia=Ia.MQe(Ia.qra);Ia>Ca.width&&(this.M4a[ub]=Object(wd.a)(null!==(tb=this.M4a[ub])&&void 0!==tb?tb:0,Ia));return!0});Q&&(this.M4a=void 0)}AHj(){this.Poc.restore();rc.z(this.rw,(Q,Ia)=>{Q=Pb.Range.Je(Q,Ia);if(Q=this.gridView.Hd(Q))Q.cell.qra=void 0})}W7h(Q){return this.Psa.Gvd&&
Q===this.Psa.srg?this.Psa.Gvd:0===(Q-this.Psa.srg-(this.Psa.Gvd?1:0))%2?this.Psa.Hak:this.Psa.L8g}mii(Q){const Ia=gd.b(this.gridView.$,Q,!0);if(!(1<Ia.length)){var ub=Ca=>{var tb;const $b=null!==(tb=this.gridView.zd.lii(Ca))&&void 0!==tb?tb:this.gridView.zd.nii(Ca);if($b)return $b},Yb=ub(Q);if(Yb&&0===Ia.length)return Yb;if(0!==Ia.length&&(Q=rc.Y(Q,Ia[0].usedRange),1===Q.length))return ub(Q[0])}}}Ld.dDg=20;Ld.oCg=100;Object(b.a)(Ld,"RichApiRangeValuesPreview",null,[]);class Xd{}Object(b.a)(Xd,"SessionRecreationInfo",
null,[]);class Ie{constructor(Q,Ia,ub){this.$=Q;this.lj=Ia;this.runtimeCalculationMode=ub}K_i(){return $a.EwaSettings.Ea(234)?this.lj.Aqi()||0!==this.runtimeCalculationMode:!1}jah(){var Q={};Q.eventRegistrationInfos=this.lj.E7h();Q.runtimeCalculationMode=this.runtimeCalculationMode;Q=Object(c.a)(new Xd,{runtimeState:Q});const Ia={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};Ia.RequestBody=JSON.stringify(Q);Ia.RequestFlags=1;return Ia}}Object(b.a)(Ie,"RichApiRuntimeStateHandler",
null,[]);class We{constructor(Q,Ia,ub,Yb,Ca,tb,$b,cd,sd){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=Q;this.processUtcTime=Ia;this.dequeueUtcTime=ub;this.inQueueDurationInMS=Yb;this.executionDurationInMS=Ca;this.operationCount=tb;this.ServerCorrelationId=$b;this.UserOperationName=cd;this.IsDocumentHidden=sd}}
Object(b.a)(We,"UserOperationQueueItemsStatisticsData",null,[]);var jf=a(337),tc=a(35),Qc=a(18),xd=a(307),Gd=a(51),pe=a(610),Dc=a(74),Wa=a(60),Qb=a(75);class Lc extends jf.a{constructor(Q,Ia,ub){super(ub,Q);this.vAa=this.hashCode=null;this.qcc=!1;this.vp=(Yb,Ca)=>{Ca.af.hash===this.hashCode&&this.vAa&&Object(Ja.a)(a(775).DdaFacade,this.$.ga.Da(35)).j0j(this.vAa.InstanceId)};this.Ng=(Yb,Ca)=>{switch(Ca.af.block.state){case 1:case 3:case 5:this.eia(Ca)}};this.ek=()=>{this.oQb(!0)};this.Wq=(Yb,Ca)=>
{this.isVisible&&this.KZa(Ca.rE);this.clearCache()};this.hg=(Yb,Ca)=>{this.PYa(Ca.na,!!Ca.rE)};this.rz=()=>{this.$.ea.Yqa()};this.r_a=Ia;this.domElement.classList.add(tc.a.nhc);this.domElement.classList.add(Qc.a.Uy);ub.tabIndex=0;this.PYa(this.$.na,!1);this.Xe.la("mousedown",this.rz);this.Xe.la("contextmenu",Yb=>{Qb.g(Yb)});this.$.va.AM(this.Wq);this.$.Ud.AM(this.Wq);this.$.Ud.Ri(this.hg);this.$.va.Ri(this.hg);this.ya.Eu(this.Ng);this.ya.WJ(this.vp);this.ya.Ws(this.ek);this.Fu(this.nDa)}get ya(){return this.r_a}dispose(){this.$&&
(this.$.va.iO(this.Wq),this.$.Ud.iO(this.Wq),this.$.Ud.uj(this.hg),this.$.va.uj(this.hg));this.r_a&&(this.r_a.Ft(this.Ng),this.r_a.uL(this.vp),this.r_a.Bs(this.ek));this.Ax(this.nDa);this.clearCache();vc.a.Ma(this.r_a);this.r_a=null;Rd.DOMElementExtensions.Oh(this.domElement);super.dispose()}EPj(Q){Rd.DOMElementExtensions.Oh(Rd.DOMElementExtensions.getElementById(this.domElement,Q.id));this.domElement.appendChild(Q)}Kxd(){if(this.vAa&&!this.qcc){var Q=Object(Ja.a)(a(775).DdaFacade,Zc.a(this.$)).No(this.vAa.InstanceId);
Q&&(Q.resize(this.vAa.Width,this.vAa.Height),Q.la(this.domElement),Q.showHide(!0),this.qcc=!0)}}Tcb(){return!0}eia(Q){this.vAa=Q.af.block.Sf;this.qcc=!1;this.Kxd()}KZa(Q){this.$.ea.X2&&Q&&(Q.xu||(Q.xu=new xd.a),Q.xu.yk=new Gd.a(this.domElement.scrollLeft,this.domElement.scrollTop),Q.xu.EPb=20)}clearCache(){this.ya.qWa(this.hashCode,"ClearCacheWebExtensionView");this.vAa=this.hashCode=null;this.qcc=!1}PYa(Q,Ia){if(this.isVisible=!!Q&&Dc.o(Q))this.hashCode=this.ya.Mwa(Q,Wa.a.pec,this.hashCode),this.$Gc(Ia)}static LLa(Q){if(!Q.ga.Da(34)){const Ia=
Q.Eh;Q.ga.Qa(34,new Lc(Q,new pe.a(Q,Q.ea,Q.qa.an,3,0),Ia.appendChild(Ia.ownerDocument.createElement("div"))))}}}Object(b.a)(Lc,"WebExtensionView",jf.a,[820,399,5]);var Ba=a(236),qa=a(448),gb=a(59),Bb=a(125),ic=a(54),Cc=a(48),hd=a(185),Pd=a(120),ue=a(66),Ee=a(33),Se=a(34),cf=a(248),mf=a(22),ac=a(16),bd=a(247),nd=a(769),se=a(55),Ge=a(176),Ve=a(870);const df=Q=>{Ge.a.sendOtelEvent(Object.assign(new Ve.a,{otelEvent:Q}))},pf=Q=>{Ge.a.sendOtelCustomerContent(Object.assign(new Ve.a,{otelEvent:Q}))};var kf=
a(923),Af=a(27),eb=a(757);class bb{constructor(Q,Ia,ub){this.oCc=0;this.Tye=new Set;this.vwf=!1;this.$=Q;this.lj=Ia;this.oj=ub}W5g(Q){1===Q.actionType?this.lj.RK(65541,vd.a.oO)?this.oCc++:h.ULS.sendTraceTag(509649754,0,10,"AugmentationLoop AnnotationAdded event is not registered"):2===Q.actionType&&0<this.oCc&&this.oCc--}n3i(Q,Ia){if(0===this.oCc)h.ULS.sendTraceTag(509649753,0,50,"No event listeners. Event not fired.");else if(Ia){Q=Ia.annotation;var ub=[];ub.push({content:JSON.stringify(Ia.annotation),
annotationType:eb.a.S8(Q),id:Q.id});this.oj.OF(65541,vd.a.oO,JSON.stringify({annotationProperties:ub}))}else h.ULS.sendTraceTag(509649752,0,10,"Event args are null")}wmi(Q){const Ia=this;return Io(function*(){if(!Ia.lj.RK(65541,vd.a.oO))h.ULS.sendTraceTag(509649751,0,10,"Event is not registered");else if(!Ia.Tye.has(Q.annotationType)){var ub=yield Bc.a.resolve(Vc.i,{Ja:1});Ia.vwf||(ub.register(ub.j2().E4("RichApi").C4(()=>{}).build()),Ia.vwf=!0);ub.Cha("RichApi",{annotationType:Q.annotationType,iu:!1,
JQ:Ia.n3i.bind(Ia)});Ia.Tye.add(Q.annotationType)}})}xmi(Q){return Io(function*(){(yield Bc.a.resolve(Vc.i,{Ja:1})).Kkb(JSON.parse(Q.content));h.ULS.sendTraceTag(509649750,0,100,`Submit operation for type: ${Q.signalType}`)})}}Object(b.a)(bb,"RichApiAugmentationLoopHandler",null,[]);a.d(C,"DdaFacade",function(){return Rb});class Rb extends Ta.a{constructor(Q,Ia,ub){super();this.oj=this.Wl=this.ea=null;this.zh=[];this.hOa=null;this.disposed=this.initialized=this.iZb=this.YUe=!1;this.cHa=null;this.wzc=
[];this.SUe=[];this.cVa=[];this.l7a=null;this.dQd=new Lb.a(S.a.Fh());this.p8b=new L.a(S.a.Fh());this.pPb=[];this.aYf=[];this.Ezb=350;this.bCa=this.ija=null;this.b3c=!1;this.Vte=this.Ute=this.Kte=this.Tte=this.Ste=this.Qte=this.Mte=this.Rte=this.Nte=this.Pte=this.Lte=this.Ote=null;this.IEg=3E3;this.pPc=!1;this.oPc=this.mqb=null;this.Nh=()=>{this.cHa=this.ea.pp.WebExtensions;var Yb=tb=>$a.EwaSettings.Ea(114)?!tb.uya:!0,Ca=tb=>$a.EwaSettings.isChangeGateEnabled("OfficeVSO:7116850_fixDialogApiOsfControlDeletedBySheetLocking")?
!tb.XFi:!0;for(let tb=this.zh.length-1;0<=tb;--tb){let $b=this.zh[tb];!this.bWh($b.controlId)&&Yb($b)&&Ca($b)&&($b.vxc(),this.zh.splice(tb,1))}if(this.cHa)for(let tb=0,$b=this.cHa.length;tb<$b;tb++)Yb=this.cHa[tb],(Ca=this.No(Yb.WebExtensionId))&&Ca.CNd(Yb)};this.zyc=Yb=>{this.raiseEvent("csc",Yb.getID())};this.eOb=(Yb,Ca,tb)=>{if(Ca===OSF.AgaveHostAction.KeyboardShortcuts){var $b=Object(Ja.a)(Object,tb);Ca={};Ca.keyCode=$b.keyCode;Ca.type="keydown";Ca.ctrlKey=$b.ctrlKey;Ca.shiftKey=$b.shiftKey;Ca.altKey=
$b.altKey;Ca.metaKey=$b.metaKey;$b=this.No(Yb);Yb=$b.wda;Ca.srcElement=Object(Hb.a)(482,Yb)?Yb.nLa:Va.h(this.$).Ce;Yb=new Sys.UI.DomEvent(Ca);$b=Rb.Jza($b.Vm,this.$);Ca={};Ca.focusedAddinId=$b;$b=new dd.a(1461300262,1,this.$.se,6,null);Va.h(this.$).NSb(Yb,$b,Ca)}else if(Ca===OSF.AgaveHostAction.Select)this.kkf(!0);else if(Ca===OSF.AgaveHostAction.UnSelect)this.kkf(!1);else if(Ca===OSF.AgaveHostAction.CancelDialog)this.wN(-684355545,null);else if(Ca===OSF.AgaveHostAction.InsertAgave)Yb={},tb&&(this.mqb=
tb,Yb[Y.a.jla]=tb,Yb[Na.a.Th]=this.eya(tb),this.wN(-741808261,Yb));else if(Ca===OSF.AgaveHostAction.ClickTrust)this.v6c&&tb&&(this.mqb=tb);else if(Ca===OSF.AgaveHostAction.OsfControlLoad)this.v6c&&this.mqb&&tb&&this.T4g(this.mqb,tb)&&tb.storeType&&(this.mqb=null,this.AC(ra.b(tb.storeType)));else if(Ca===OSF.AgaveHostAction.InsertDevManifest)Yb={},tb&&(Yb[Y.a.jla]=tb,Yb[Na.a.Th]=this.eya(tb),this.wN(-741808261,Yb));else if(Ca===OSF.AgaveHostAction.InsertDevManifestError)Yb=Object(Ja.a)(Object,tb),
Yb={[Y.a.f6c]:this.Wl.getDevManifestInvalidUrlErrorString(Yb.manifestUrl)},this.wN(-2025863019,Yb);else if(Ca===OSF.AgaveHostAction.NotifyHostError)Yb={[Y.a.f6c]:this.Wl.getManifestInvaildErrorString()},this.wN(-2025863019,Yb);else if(Ca===OSF.AgaveHostAction.RefreshAddinCommands)$a.EwaSettings.Ea(52)&&this.wN(Af.a.refreshAddinCommands,null);else if(Ca===OSF.AgaveHostAction.CtrlF6Exit||Ca===OSF.AgaveHostAction.CtrlF6ExitShift){if($b=$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateEwaAccessibilityManager",
!1)?Bc.a.zg(Vc.V):this.$.ga.Da(15)){(Yb=this.No(Yb).wda)&&Yb.pJc();n.a.vh&&document.activeElement.blur();var cd={keyCode:117,type:"keydown",ctrlKey:!0};cd.shiftKey=Ca===OSF.AgaveHostAction.CtrlF6ExitShift;cd.srcElement=Object(Hb.a)(482,Yb)?Yb.nLa:Va.h(this.$).Ce;Yb=new Sys.UI.DomEvent(cd);$b.Lqa(Yb)}}else if(Ca===OSF.AgaveHostAction.PageIsReady){if((Yb=this.No(Yb).wda)&&Yb.b4a===OSF.OsfControlTarget.TaskPane&&(Yb=this.$.ga.Da(183))&&this.zh){Ca=Jd.a.gg();for($b of this.zh)Rb.HRa($b.LP)&&(Ca?Yb.Pi(!0,
!1):Yb.setFocusOnToolbarFirstElement())}}else if(Ca===OSF.AgaveHostAction.TabExit){Ca=this.No(Yb);const De=Ca.wda;if(De)if(De.b4a===OSF.OsfControlTarget.InContent)De.Czf();else{if(De.b4a===OSF.OsfControlTarget.TaskPane)if(Jd.a.gg())n.a.vh&&document.activeElement.blur(),cb.UISurfaces.ul().then(Ye=>{const $e=Object(Hb.a)(482,De)?De:null;$e?$e.isResizable?Ye.focusResizeHandle():Ye.focusTabbedTaskPaneArea():Ye.focusTabbedTaskPaneArea();return null});else if(Ca=this.$.ga.Da(183))n.a.vh&&document.activeElement.blur(),
(Yb=document.getElementById(this.$.Pd+ib.a.Jwc))&&Rd.DOMElementExtensions.isVisible(Yb)?Rd.DOMElementExtensions.setFocus(Yb):Ca.setFocusOnToolbarFirstElement()}else Ca&&4===Ca.osfControlType&&this.Wl.notifyAgave(Yb,OSF.AgaveHostAction.TabIn)}else if(Ca===OSF.AgaveHostAction.TabExitShift)(Ca=this.No(Yb),$b=Ca.wda)?$b.b4a===OSF.OsfControlTarget.InContent?$b.Dzf():$b.b4a===OSF.OsfControlTarget.TaskPane&&(Yb=Object(Hb.a)(482,$b)?$b:null)&&(n.a.vh&&document.activeElement.blur(),Yb.xfg()):Ca&&4===Ca.osfControlType&&
this.Wl.notifyAgave(Yb,OSF.AgaveHostAction.TabIn);else if(Ca===OSF.AgaveHostAction.EscExit||Ca===OSF.AgaveHostAction.ExitNoFocusable||Ca===OSF.AgaveHostAction.ExitNoFocusableShift)if($b=this.No(Yb).wda)$b.pJc();else{if(Ca===OSF.AgaveHostAction.EscExit){Ca=null;for(cd of M.Pki())if(cd.value.ug===Yb){cd.value.dialog.hide();Ca=cd.key;break}Ca&&(Yb=this.No(Ca))&&4!==Yb.osfControlType&&this.Vg.notifyAgave(Ca,OSF.AgaveHostAction.TabIn)}}else if(Ca===OSF.AgaveHostAction.InstallCustomFunctions)if($a.EwaSettings.Ea(114)){ue.a(this.$).X8e(()=>
!1);var sd=this.$.ga;Kd.TaskExtensions.za($c.GetServiceTaskFactory.ud(sd,278,279,1),De=>{De=De.result;sd.Da(278)||sd.Qa(278,De);const Ye=tb.osfControl.getStoreType();De.sqf(tb.osfControl.getSolutionId(),Ye,Rb.S5h(tb.osfControl),tb).$ra()},this.ka,3)}else h.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(Ca===OSF.AgaveHostAction.UninstallCustomFunctions)if($a.EwaSettings.Ea(114)){ue.a(this.$).X8e(()=>!1);var re=
this.$.ga;Kd.TaskExtensions.za($c.GetServiceTaskFactory.ud(re,278,279,1),De=>{De=De.result;re.Da(278)||re.Qa(278,De);De.Itg(tb.solutionId,tb.storeType).$ra()},this.ka,3)}else h.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else Ca===OSF.AgaveHostAction.SendTelemetryEvent?df(tb):Ca===OSF.AgaveHostAction.SendCustomerContent?pf(tb):Ca===OSF.AgaveHostAction.LaunchExtensionComponent?k.a.instance.GOi(tb):Ca===OSF.AgaveHostAction.RefreshRibbonGallery?
(Yb=this.$.ga.Da(519))&&Yb.Mud(tb):Ca===OSF.AgaveHostAction.RemoveAppCommandsAddin?(this.Ozj(tb.solutionId),Jd.a.gg()||(Yb=this.$.ga.Da(183))&&Yb.IO()):Ca===OSF.AgaveHostAction.GetOriginalControlId&&(Yb=new rb.a(this.$.Pd,tb.ownerAddinSolutionId,new bc.a,!0),tb.originalControlId=Yb?Yb.kVe(tb.controlId):tb.controlId)};this.BNj=(Yb,Ca)=>{const tb=Array(2);tb[0]=Ca;tb[1]=null;this.oj.mWh(Yb,JSON.stringify(tb))};this.Hgj=()=>{this.$.na&&Dc.o(this.$.na)&&this.$.ga.Da(34).Kxd()};this.wf=()=>{this.IBf()};
this.Ng=(Yb,Ca)=>{Yb=Ca.af;(Yb=(Yb=Yb.block.state&1?Yb.block.Sf:null)?Yb.CustomFunctionsObjects:null)&&this.Zdd(Yb)};this.WU=(Yb,Ca)=>{var tb,$b;1===Ca.Dt&&(Yb=Ca.Yh)&&(Ca=new We(Pd.toTimestamp(Yb.enqueueUtcTime),Pd.toTimestamp(Yb.processUtcTime),Pd.toTimestamp(Yb.dequeueUtcTime),Pd.getElapsedMilliseconds(Yb.enqueueUtcTime,Yb.processUtcTime),Pd.getElapsedMilliseconds(Yb.processUtcTime,Yb.dequeueUtcTime),Yb.operationCount,(null===($b=null===(tb=Yb.operation)||void 0===tb?void 0:tb.Cf)||void 0===$b?
0:$b.ServerCorrelationId)?Yb.operation.Cf.ServerCorrelationId:null,Yb.operation?Enum.toString(qa.a,Yb.operation.operationName):null,nd.a.aG(Pd.getElapsedMilliseconds(Yb.enqueueUtcTime,Ee.a.$b.ke))),tb=Sys.Serialization.JavaScriptSerializer.serialize(Ca),h.ULS.sendTraceTag(50872916,0,50,tb))};this.ff=(Yb,Ca)=>{!this.ea.oe&&Ba.a(Ca)?(Array.forEach(this.zh,this.rNf),this.zh.length=0,this.iZb=!1):(Ca.nI&&(h.ULS.sendTraceTag(537170516,0,50,"Silent Reload require reset osf controls."),this.T9f()),this.mO(),
$a.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(this.iZb=!1))};this.yp=()=>{$a.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(h.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),this.T9f());this.mO();$a.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(this.iZb=!1)};this.rNf=Yb=>{Yb.vxc();this.raiseEvent("cd",Yb.controlId)};this.vd=
Q;this.y6c=Ia;this.initialize(ub);hb.la(this);this.fag=0;(Q=(Q=!(n.a.ls||n.a.e3))&&!n.a.vh)&&OfficeExt.ShortcutKeyDispatchManager.init();this.TKg={}}get y9b(){return this.ija||(this.ija=new cc.a(this.$.Ww))}OBe(Q){this.addHandler("cd",Q)}RAj(Q){this.removeHandler("cd",Q)}TYg(Q){this.addHandler("csc",Q)}TAj(Q){this.removeHandler("csc",Q)}QYg(Q){this.addHandler("ca",Q)}QAj(Q){this.removeHandler("ca",Q)}RYg(Q){this.addHandler("ci",Q)}SYg(Q){this.addHandler("ekros",Q)}SAj(Q){this.removeHandler("ekros",
Q)}IPd(Q,Ia){try{return JSON.parse(Q)[Ia].toLowerCase()}catch(ub){return""}}wWj(Q){const Ia=this.IPd(Q,"AudienceGroup"),ub=this.IPd(Q,"SessionOrigin");try{const Yb=parseInt(this.IPd(Q,"Ring"),10);if("automation"!==Ia&&"bluechicken"!==ub&&-2<=Yb)return!0}catch(Yb){if("automation"!==Ia&&"bluechicken"!==ub)return!0}return!1}get Vg(){if(!this.Wl){const Q={},Ia=!(this.$.If&1),ub=uc.a.current.FI,Yb=this.$.workbookContext,Ca=Ub.a.RL+Ub.a.Pbc;Q.pageBaseUrl=ub.LayoutsContentUrlPrefix;Q.appName=OSF.AppName.ExcelWebApp;
Q.appVersion="16";Q.appSettings=this.U9h();Q.singleSignOnSettings=O.AppsForOfficeSingleSignOnManager.nhi();Q.clientMode=Ia?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;Q.appUILocale=this.$.xa.UICultureTag;Q.dataLocale=this.$.xa.DataCultureTag;Q.docUrl=Yb.ClientUrl;Q.hostControl=this;Q.formFactor=OSF.FormFactor.Default;Q.lcid=this.$.GG.toString();Q.localizedScriptsUrl=Ub.a.RL+Ub.a.mcd;Q.localizedImagesUrl=Ca;Q.localizedStylesUrl=Ub.a.RL+Ub.a.TPe;Q.localizedResourcesUrl=Ca;Q.osfOmexBaseUrl=ub.OsfOmexBaseUrl;
Q.firstPartyManifestCDNUrl=ub.FirstPartyAddInManifestCDN;Q.sdxAssetsToPrefetchMapping=m.AFrameworkApplication.da.Sa("SdxAssetsToPrefetchMapping");Q.sdxCdnUrl=ub.SdxCdnUrl;Q.sdxDmsUrl=ub.SdxDmsUrl;Q.devCatalogUrl=ub.DevCatalogUrl;Q.controlStatusChanged=this.zyc;Q.notifyHost=this.eOb;Q.allowExternalMarketplace=this.$.ea.pj.get(27)&&Rb.zcc;Q.enableAddinCommands=$a.EwaSettings.Ea(52);Q.enableBlackForestRedirect=$a.EwaSettings.Ea(87);Q.enableMyOrg=this.$.ea.pj.get(33);Q.enableMyApps=this.$.ea.pj.get(34);
Q.enableDevCatalog=$a.EwaSettings.Ea(43);Q.enablePrivateCatalog=this.qXj();Q.showSignOutFromPrivateCatalogMessage=this.$.ea.pj.get(36);Q.enableUploadFileDevCatalog=$a.EwaSettings.Ea(52)&&!$a.EwaSettings.Ea(254);Q.userNameHashCode=R.a.Ly(m.AFrameworkApplication.userName);Q.envCode=this.$.xa.OfficeAddinTelemetryDataSourceCode.toString();Q.enableSingleSignOnForAddin=m.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;Q.enableDisplayBlockedMinorError=$a.EwaSettings.Ea(171);Q.hideAppsExtensionUrl=
m.AFrameworkApplication.hideAppsExtensionUrl;Q.enableAnonymousUseLegacyCatalogService=$a.EwaSettings.Ea(162);Q.enableInsertDialogAccessibilityFix=$a.EwaSettings.Ea(169);Q.disableAppsForOfficeThirdParty=$a.EwaSettings.Ea(174);Q.enableFirstPartySSO=$a.EwaSettings.Ea(186);Q.wacSessionId=this.$.xa.UserSessionId;Q.disableLogging=!this.$.xa.AriaLoggingIsEnabled;Q.enableFirstPartySDXErrorMessages=$a.EwaSettings.Ea(198);Q.isHostDocumentDomain=$a.EwaSettings.Ea(209);Q.loggableUserId=m.AFrameworkApplication.da.Sa("LoggableUserId");
Q.sessionStartInfoJson=m.AFrameworkApplication.da.Sa("SessionStartInfoJson");Q.wopiHostOriginFromPostMessage=m.AFrameworkApplication.wopiHostOriginFromPostMessage;Q.wopiHostOriginFromWacPropBag=m.AFrameworkApplication.da.Sa("PostMessageOrigin");Q.wacIsEmbedded=m.AFrameworkApplication.da.pa("IsEmbedded");Q.accessibilityAllowFocusAddinTaskpane=m.AFrameworkApplication.da.pa("AccessibilityAllowFocusAddinTaskpane");Q.enableRemoveAppCommandsAddin=m.AFrameworkApplication.da.pa("RemoveAppCommandsAddinIsEnabled");
Q.isHostFrameTrustCheckEnabledForAddIns=m.AFrameworkApplication.da.pa("HostFrameTrustCheckIsEnabledForAddIns");Q.isHostFrameTrusted=m.AFrameworkApplication.isHostFrameTrusted;Q.agaveAddinUploadEnabled=$a.EwaSettings.Ea(45);Q.hostAllowedOfficeStore=m.AFrameworkApplication.da.pa("HostAllowedOfficeStore");Q.hostAllowedSdxEmbedding=m.AFrameworkApplication.da.pa("HostAllowedSdxEmbedding");Q.hostInstallAddIns=m.AFrameworkApplication.da.Sa("HostInstallAddIns");Q.hostInstallAddInsIsEnabled=m.AFrameworkApplication.da.pa("HostInstallAddInsIsEnabled");
Q.approvedAddIns=m.AFrameworkApplication.da.Sa("ApprovedAddIns");Q.addinEnforceHttpsIsEnabled=this.wWj(Q.sessionStartInfoJson);Q.hostFeatureGateFlag=0;Q.isUpnCheckEnabled=m.AFrameworkApplication.da.pa("IsUpnCheckEnabled");Q.wacUpn=m.AFrameworkApplication.da.Sa("UserPrincipalName");Q.isReactRibbonEnabled=Jd.a.isReactRibbonEnabled();Q.enableSetFocusOnTaskpaneOnUserAction=$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);Q.isSafariWithIndexedDBDisabled=
$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&n.a.uSa;Q.isIndexedDBDisabled=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&n.a.uSa||$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&n.a.vh;Q.enableCustomShortcuts=!0;Q.changeGetModifierKeyStringOutputOrder=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");Q.officeJsUrl=m.AFrameworkApplication.qV("OfficeJs/excel.js",5);Q.enableOfficeJsUrlParam=
$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlParam",!1);this.Wl=new OSF.ContextActivationManager(Q);this.Wl.setIframeAttributeBag({["frameborder"]:0,["marginheight"]:0,["marginwidth"]:0});this.Wl.setWSA(m.AFrameworkApplication.Jn);this.Wl&&"undefined"!==typeof this.Wl.hostCheckReadyHandler&&m.AFrameworkApplication.RZg(Object(d.a)(this.Wl,this.Wl.hostCheckReadyHandler,"hostCheckReadyHandler"));try{const tb=wb.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Wl.setOAuthManager(tb)}catch(tb){}}return this.Wl}get rok(){return this.b3c}get lj(){return this.Ote}get Xra(){return this.Lte}get HYd(){return this.Pte}get GYd(){return this.Nte}get xIj(){return this.Rte}get vIj(){return this.Mte}get wIj(){return this.Qte}get yIj(){return this.Ste}get zIj(){return this.Tte}get IYd(){return this.Ute}get eag(){return this.Vte}get LY(){return this.TKg}get $(){return this.vd}get FYd(){return this.Kte}$9b(Q){const Ia=
{};Ia.Name=Q.Name;Ia.BindingType=Q.BindingType;Ia.HasHeaders=Q.HasHeaders;Q.IsValidRef&&(Ia.ColCount=Q.Reference.LastColumn-Q.Reference.FirstColumn+1,Ia.RowCount=Q.Reference.LastRow-Q.Reference.FirstRow+1);return Ia}get g6c(){return m.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&m.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)}UAf(Q,Ia){const ub=this.k$g(Ia);let Yb=null;
if(m.AFrameworkApplication.da.isChangeGateEnabled("OfficeVSO:7073634_TellMeLaunchAddinDialogSetTabIdEnabled")&&$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1)&&null!==Ia&&"LaunchAddinDialogFromTellMe"===Ia[0])null!==ub.assetId&&"undefined"!==typeof ub.assetId&&(Yb="{98143890-AC66-440E-A448-ED8771A02D52}");else if(this.g6c){const Ca=this.$.ea.pj.get(27);!Ca||null===Ia||"InsertMoreAddInsFromFooter"!==Ia[0]&&"InsertMoreAddInsFromBackstageFooter"!==
Ia[0]?!Ca||null===Ia||"AddinFlyoutMoreButton"!==Ia[0]&&"LaunchMyAddInsFromBackstage"!==Ia[0]||(Yb="0"):Yb="{98143890-AC66-440E-A448-ED8771A02D52}"}this.Wl.launchInsertDialog(Q,Yb,ub)}get J6(){return this.cLa}get cLa(){this.v6c&&!this.oPc&&(this.Jxj&&this.EGh(this.IEg),this.oPc=kb.createInstance(m.AFrameworkApplication.da,new gc.a(()=>this.Wl),{["AppsForOfficeAllowExternalMarketplace"]:this.allowExternalMarketplace,["AppsForOfficeThirdPartyIsDisabled"]:this.r9j,["AreThirdPartyAddInsAllowed"]:this.$.eX,
["PopularAddinDetailsJsonString"]:Rb.kha,["UICulture"]:m.AFrameworkApplication.uiCulture}));return this.oPc}get r9j(){return $a.EwaSettings.Ea(174)}get allowExternalMarketplace(){return this.$.ea.pj.get(27)}get v6c(){return m.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}static get kha(){return'[{"displayName":"Bing Maps","solutionId":"wa102957661","version":"1.5.0.0","targetType":0,"width":600,"height":600,"description":"The Bing Maps add-in makes it easy to plot locations and visualize your data through Bing Maps in Excel","iconUrl":"45.d6c30518-91f7-4e79-b846-0813b56a1b2d.75cc16b5-7155-4a84-8094-a4ae7e997116.688fcadb-9dca-414b-91d4-2075b00c2772.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":1,"AUP":1770}},{"displayName":"Mini Calendar and Date Picker","solutionId":"wa102957665","version":"1.3.0.0","targetType":0,"width":240,"height":220,"description":"Add a mini monthly calendar to your spreadsheet and use it to insert dates or the current time.","iconUrl":"31013.352a833c-760b-49ee-b384-f9718a71d650.3966871d-bbca-4abd-996d-777127e5f717.aac00a7f-336d-4d49-9fbb-f41bc3db4515.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.vertex42.com/privacy.html","addinInfo":{"priority":1,"AUP":20064}},{"displayName":"Bubbles","solutionId":"wa103147117","version":"1.1.0.0","targetType":0,"width":500,"height":500,"description":"Visualize your data in a fun and interactive way using bubbles to quickly identify patterns.","iconUrl":"6406.490601bf-78b6-49e5-be4f-e671fe712516.9fc1cb98-b071-4854-918e-40a0d2c7a467.49ae5470-5b06-4fa6-8762-6977e397810a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://roljs.azurewebsites.net/bubbles-privacy-statement","addinInfo":{"priority":1,"AUP":40}},{"displayName":"Geographic Heat Map","solutionId":"wa103304320","version":"1.1.0.0","targetType":0,"width":480,"height":350,"description":"This app will help you visualize data across geographic locations. It\'s simply formatting on a map.","iconUrl":"33870.9aae8635-7790-49e5-9809-7704d4347793.cf84e746-9ce3-4a9a-83c5-4efc8117bc45.2cdca20b-36a0-45d8-bc0e-859ce6e806da.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"","addinInfo":{"priority":-1,"AUP":359}},{"displayName":"QR4Office","solutionId":"wa104051163","version":"1.2.0.3","targetType":1,"width":0,"height":0,"description":"A first-of-its-kind QR-generator that integrates seamlessly into your Office documents.","iconUrl":"53638.20ce8aca-39c5-4b97-b87a-47d0f3e21e0d.0b60ea0f-7e02-4465-baeb-bb55c723d670.9147ef8e-cf16-47cf-af10-ef553e88804d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://q.michaelzlat.com/","addinInfo":{"priority":1,"AUP":1369}},{"displayName":"Wikipedia","solutionId":"wa104099688","version":"1.4.0.0","targetType":1,"width":0,"height":0,"description":"Find and quote related information from Wikipedia.","iconUrl":"7450.110c9a11-7db2-4228-b768-f1ad828e16be.9bd16ea2-22ff-455c-9f92-70de827e079a.aeef7210-898b-4a79-82b5-b648805129b9.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949674774/Asset_733b35d6-e5e0-4163-b45d-3396185864bd/WIKIPEDIAAPPFOROFFICELICENSETE.docx","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":2,"AUP":368}},{"displayName":"Solver","solutionId":"wa104100404","version":"3.0.0.1","targetType":1,"width":0,"height":0,"description":"Solve optimization models in Excel Online and Excel on iPad, upward compatible from Solver in Excel.","iconUrl":"37315.adb6ef87-ef0f-4f99-b639-c08a45950b58.cb56fe0c-c385-43b5-8c1b-88701ddbb898.c5239aae-28c3-4dec-8338-e6c0ceef5b82.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683093/Asset_5ef7a7a3-cb57-4c16-8fe4-6032d115bc04/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":3,"AUP":3146}},{"displayName":"People Graph","solutionId":"wa104104476","version":"1.4.0.0","targetType":0,"width":580,"height":400,"description":"Transform cold data into a cool picture.","iconUrl":"49387.7b82fde0-3b87-471f-a121-86215bd4c0d4.5c5551ff-1f1c-4fdd-83a0-9a311307f989.b07f3a4e-26ca-4174-83e2-a8953ecb5eb6.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949674809/Asset_488b8377-7de8-40ce-82ca-0a2fd48220dd/PEOPLEGRAPHAPPFOROFFICELICENSE.docx","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":1,"AUP":1364}},{"displayName":"E2D3","solutionId":"wa104379169","version":"2.0.1.0","targetType":0,"width":800,"height":680,"description":"Create dynamic and interactive graphs on Excel","iconUrl":"1677.6b2891ac-505f-41cc-80f6-db53a4274b85.62a2ad24-69c3-41ae-9419-bd700be3f626.67a1d711-d2ca-4e12-94b8-49464dc829ec.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://e2d3.org/privacy","addinInfo":{"priority":1,"AUP":68}},{"displayName":"XLMiner Analysis ToolPak","solutionId":"wa104379190","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Statistical analysis in Excel Online, with functions matching the Analysis ToolPak in desktop Excel.","iconUrl":"2225.9cbf413e-e33f-4be9-90ef-2fdb353c52a1.6e475dbb-9ae3-4b89-ae41-004faa21a088.e9552e6b-53ec-4728-ba49-ba04757c6dd0.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-analysis-toolpak-app","addinInfo":{"priority":3,"AUP":6262}},{"displayName":"Stock Connector","solutionId":"wa104379220","version":"8.0.0.0","targetType":1,"width":0,"height":0,"description":"Link stocks, currency, & crypto prices to cells in Excel spreadsheets and update them in real time.","iconUrl":"35421.d104d786-d979-48bb-9827-1b28ac5178cf.c0696ae0-87b8-4c16-ab8c-171be18ca0a9.8dcfdc9c-2863-4fa9-905d-84ff8534af7a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://michael-saunders.com/stocksapp/pages/privacy.html","addinInfo":{"priority":1,"AUP":1710}},{"displayName":"Symbols and Characters - Fast Symbol Lookup","solutionId":"wa104379279","version":"2.1.0.0","targetType":1,"width":0,"height":0,"description":"Symbols and characters | Fast symbol and emoticon search with convenient auto-lookup","iconUrl":"53409.631e9a68-2435-4716-b1b8-dc48b99d3f85.d2f9c29f-cf48-4dcc-8202-fcbc5e4d1482.0216011c-2369-4ee7-8351-ac51d77015c2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/legalconditions/Default.aspx","addinInfo":{"priority":1,"AUP":673}},{"displayName":"Microsoft Dynamics Office Add-in","solutionId":"wa104379629","version":"1.3.0.0","targetType":1,"width":0,"height":0,"description":"The Microsoft Dynamics Office Add-in enables data connections to Microsoft Dynamics systems.","iconUrl":"2287.eac0bf67-c34b-4302-aaa9-a07c1e560721.16c405d8-e48b-42e1-ac8f-7c402b8ae0d1.5ce79e5f-d108-48a7-b34b-75c71b620973.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949677398/Asset_e3871df6-665b-4927-a7fe-cd9e228611cc/LCSTermsofUseFinalFebruary2016.pdf","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=271135","addinInfo":{"priority":3,"AUP":2790}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"wa104380050","version":"3.4.0.0","targetType":1,"width":0,"height":0,"description":"Access your centrally shared templates in Office, Teams, SharePoint Online, and other Apps.","iconUrl":"21517.40f3490e-24f2-4502-9a44-28e543d36a75.cc0236b1-594c-49ad-9462-3f787be3cd4f.f383d0e6-2de8-4367-9108-e62781456dad","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":1,"AUP":588}},{"displayName":"Lucidchart Diagrams for Excel","solutionId":"wa104380194","version":"1.1.2.0","targetType":1,"width":0,"height":0,"description":"The easiest way to draw and insert flowcharts, mockups, UML, mind maps and more in Office documents.","iconUrl":"21470.3fa72610-07ba-489f-b48f-1fcb5ca4253a.fc3d89ad-c9dc-445c-9baa-074b7b8f0cfb.9bc93e17-dd72-4215-b8b0-0cf81a3d9925.png","licenseUrl":"https://www.lucidchart.com/pages/tos","privacyUrl":"https://www.lucidchart.com/pages/privacy","addinInfo":{"priority":3,"AUP":358}},{"displayName":"Microsoft PowerApps Office Add-in","solutionId":"wa104380330","version":"1.3.0.1","targetType":1,"width":0,"height":0,"description":"The Microsoft PowerApps Office Add-in enables data connections to Microsoft PowerApps systems","iconUrl":"60124.e1dfe8b1-6892-4a07-bb52-91fc1006be11.a6787a94-2200-4943-9d6a-f9efb8369662.47ff6184-6b13-4120-955b-1c285e83cbc7.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949679879/Asset_661a2a7f-2764-43c5-aef4-25bc316a1b08/DynamicsAppforOfficeSLTEnglish.pdf","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=271135","addinInfo":{"priority":2,"AUP":597}},{"displayName":"Adobe Acrobat for Microsoft Word, Excel, and PowerPoint","solutionId":"wa104380526","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Do more with enterprise PDF tools, built right into your favorite Microsoft 365 apps.","iconUrl":"832.4553b45a-c9b7-42b8-9c57-e33b57f5df4d.80d83ec3-4ec7-4f7d-b45f-36b1f0c05e78.3d5b10f9-0a9c-4ac1-84fc-b7439dfb4f35.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":1,"AUP":1812}},{"displayName":"ChartExpo\u2122 for Excel","solutionId":"wa104380662","version":"1.0.0.7","targetType":0,"width":655,"height":390,"description":"Select a chart, select your data, and create Insightful charts without hardwork!","iconUrl":"47793.590471af-7e3e-4855-8e7f-1438a654488b.5e466c13-5861-4e47-bf0e-d6a735f06208.7800aa4f-c6b6-43bb-8099-c14624743abc.png","licenseUrl":"https://www.chartexpo.com/Home/EULA","privacyUrl":"https://www.chartexpo.com/Home/OfficeAppPrivacy","addinInfo":{"priority":1,"AUP":434}},{"displayName":"Facebook Ads Manager for Excel","solutionId":"wa104380711","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"The fastest way to view performance data for all of your Facebook ad accounts.","iconUrl":"47990.d08ffb67-b1f0-4ef6-ac6f-4b5379c5d285.a5cb5ec2-3726-4cf0-ae84-5d8ee7ee3439.3af0d784-7a14-4e39-897b-24e4e633fb76.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.facebook.com/about/privacy","addinInfo":{"priority":3,"AUP":353}},{"displayName":"Script Lab, a Microsoft Garage project","solutionId":"wa104380862","version":"1.5.0.0","targetType":1,"width":0,"height":0,"description":"Create, run, and share your Office Add-in code snippets from within Excel, Word, or PowerPoint.","iconUrl":"52703.9fd54003-f1a2-4196-a8a8-ea11bec509a8.9b4da1d4-cb1c-46e6-9463-8a258eb273e6.b5c7baa9-2a17-4db7-b0dd-ca9dea75bd27.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":-1,"AUP":1299}},{"displayName":"Excel-to-Word Document Automation","solutionId":"wa104380955","version":"3.16.2.1","targetType":1,"width":0,"height":0,"description":"Update Word and PowerPoint documents from Excel data, calculations, text, tables, and charts.","iconUrl":"44742.554108a6-3275-4065-9a18-887d38776dca.31f4b432-c6cb-49c5-9fba-56c194301365.e534a91d-b3f5-445e-bdbd-1559dbb4b396.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://analysisplace.com/Privacy","addinInfo":{"priority":3,"AUP":371}},{"displayName":"Journal Entry Batch Creator for Financial Edge NXT","solutionId":"wa104380978","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Create new journal entry batches in Financial Edge NXT via Excel (for existing customers)","iconUrl":"10843.146167ad-49b2-41d3-aff7-76ed38a0ea33.da610372-55d7-45b3-9134-1aa080eaa154.adce15a7-2cb2-4d79-90f8-6888df00287e.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.blackbaud.com/privacy-shield","addinInfo":{"priority":3,"AUP":297}},{"displayName":"Mobile Data Collection - Scan-IT to Office","solutionId":"wa104381026","version":"1.2.0.0","targetType":1,"width":0,"height":0,"description":"Real-time mobile data collection and barcode scanning for Excel and Word ","iconUrl":"7989.6963e6f3-4ebf-4a63-82b7-734a5a002866.814dcb0f-f024-477c-9b9b-9407aef3d56a.a4027334-e000-4b89-bd22-18d0d906a688.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/website/legalconditions/Default.aspx#Privacy","addinInfo":{"priority":3,"AUP":935}},{"displayName":"Functions Translator, a Microsoft Garage project","solutionId":"wa104381504","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Translate the Excel functions and formulas between different languages","iconUrl":"6460.beedf6f4-7724-4c03-8e90-d6cc7d58e77c.a85b2258-a967-4d48-898f-a8db56e4d9c6.1b6557bd-4e89-4bad-a3d7-0ad2f0f0ee55.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/p/?LinkId=123161","addinInfo":{"priority":2,"AUP":1421}},{"displayName":"Cryptosheets","solutionId":"wa104381695","version":"1.0.10.0","targetType":1,"width":0,"height":0,"description":"The easiest way to pull live, real-time, and historical cryptocurrency data directly into a sheet.","iconUrl":"44479.63cc4a83-c6d9-41b8-ab03-721c5071695c.9ab58e20-a9a3-4915-8ece-423d1fbe8e5f.af1fbf7c-11e4-4278-a726-d902df022e8c.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://cryptosheets.com/privacy","addinInfo":{"priority":3,"AUP":373}},{"displayName":"Microsoft Power Automate for Excel","solutionId":"wa104381701","version":"1.0.0.4","targetType":1,"width":0,"height":0,"description":"Automate repetitive tasks by integrating your favorite apps and services with Power Automate.","iconUrl":"24472.5327e164-9595-41b5-94b6-dc524c42d5f6.318749ea-0f55-45b9-aee5-b89aae584a0c.73475625-266a-4866-b041-d9536d4673bb.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":2,"AUP":8162}},{"displayName":"Tiller Money Feeds","solutionId":"wa104381717","version":"1.0.3.0","targetType":1,"width":0,"height":0,"description":"Manage your money, your way with the most powerful automated personal finance service for Excel.","iconUrl":"57987.b83fa962-bb4f-4dd1-89e2-6b40f8b0a724.95198c12-4345-4728-b4c6-d3e76bb58555.affa1083-0e0c-4cf9-b006-636291dae421.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tillerhq.com/privacy","addinInfo":{"priority":1,"AUP":192}},{"displayName":"FYI for Office","solutionId":"wa104381841","version":"1.0.2.2","targetType":1,"width":0,"height":0,"description":"Standardise your output and enforce filing across your practice with FYI.","iconUrl":"55705.a91d847f-3878-41c0-90a2-1a25491d561e.6ece2a38-0dd7-4c23-abd0-2d418443543e.4218a512-bae0-420b-b293-2194a885c9aa.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848155/Product_42949682443/Asset_5cb37a96-0b6a-4b64-bbf2-fa24ee29cec5/eula.pdf","privacyUrl":"https://www.fyidocs.com/privacy","addinInfo":{"priority":2,"AUP":696}},{"displayName":"VitalTax | Making Tax Digital (MTD) for VAT","solutionId":"wa104381859","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Submit your VAT return directly from Excel and digitally link your data to HMRC","iconUrl":"10434.1d05b34e-479a-4769-bf99-07b416b11cbc.482ef49e-8635-4bfe-bb8d-e5ce4a2a4e61.be642c2c-717a-424c-96d8-8cea91a28e75.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848420/Product_42949682533/Asset_28a3de04-adcc-4a88-8d42-b3493d67599a/ENDUSERLICENSEAGREEMENT.docx","privacyUrl":"https://vitaltax.uk/privacy-policy","addinInfo":{"priority":1,"AUP":382}},{"displayName":"Microsoft Visio Data Visualizer","solutionId":"wa104381973","version":"1.0.0.4","targetType":0,"width":732,"height":448,"description":"Quickly and easily visualize your data into polished Visio diagrams within Excel.","iconUrl":"28591.0bb30ee2-d030-40d4-ba7e-3cb028cacb85.45958ca1-0858-42f7-9002-36ecaceadb38.84405685-1ffe-4d1d-9782-069079dc8d28.png","licenseUrl":"https://visio.officeapps.live.com/va/resources/licenseterms.html","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":1,"AUP":10559}},{"displayName":"XL-Connector 365","solutionId":"wa104382023","version":"2.0.0.1","targetType":1,"width":0,"height":0,"description":"Salesforce connector for Microsoft Office Online and Microsoft Office for Mac","iconUrl":"22105.87e56e91-0218-41b6-baf7-cd6d66ed7064.2132bae0-8ca0-4c27-ba4c-949cf6364791.f1ed243e-17f7-41ff-b99a-341d95cc8088.gif","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.xappex.com/docs/xl-connector-365-docs/xl-connector-365-privacy-policy","addinInfo":{"priority":3,"AUP":1674}},{"displayName":"Analytic Solver","solutionId":"wa200000018","version":"23.1.0.0","targetType":1,"width":0,"height":0,"description":"Analyze risk, find the best way to allocate resources using Monte Carlo Simulation and Optimization","iconUrl":"13898.dda126ef-5dd2-44ef-b6bc-a6cb0309f3a1.5b43104b-37e9-4650-8c16-71e032e6cb7d.e1dd0809-9020-4553-ba59-1479f07f4705.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683093/Asset_5ef7a7a3-cb57-4c16-8fe4-6032d115bc04/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":2,"AUP":1315}},{"displayName":"Analytic Solver Data Mining","solutionId":"wa200000019","version":"23.1.0.0","targetType":1,"width":0,"height":0,"description":"Forecast the future, train and deploy predictive models using Data/Text Mining and Machine Learning","iconUrl":"34090.1ece6668-5136-4cbf-8b60-e7747688efc8.cfabfded-2a53-4b39-9eda-001adba2da25.c6775c6d-8ebd-4525-90d6-1304a00887d8.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683094/Asset_8b514640-453a-4c63-9e63-d0c3f2b29f37/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":-1,"AUP":640}},{"displayName":"draw.io Diagrams","solutionId":"wa200000113","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Easily embed draw.io diagrams from cloud storage","iconUrl":"14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474849055/Product_42949683254/Asset_f99133a0-53c0-4c21-905f-757b27070c6a/drawioEULATermsofServicedrawio.pdf","privacyUrl":"https://desk.draw.io/support/solutions/articles/16000096192-privacy-policy-for-draw-io-add-in-for-microsoft-office","addinInfo":{"priority":2,"AUP":441}},{"displayName":"SAP Analytics Cloud for Office","solutionId":"wa200000169","version":"1.15.0.0","targetType":1,"width":0,"height":0,"description":"Use Microsoft Excel\u2019s strengths to get deeper insights into your SAP Analytics Cloud data.","iconUrl":"22967.ffbd93af-2e67-49da-bff8-62f9e5029e69.9930b4d4-9fd9-4eac-8578-8c77ca3d7e15.3a9c2449-9616-45b4-83e5-2f8360c19338.png","licenseUrl":"https://hcs.cloud.sap/office/eula.html","privacyUrl":"https://www.sap.com/about/legal/privacy.html","addinInfo":{"priority":3,"AUP":1112}},{"displayName":"iServer365 Import Tool","solutionId":"wa200000421","version":"2.1.4.7","targetType":1,"width":0,"height":0,"description":"Import data from Excel Workbooks to your iServer365 Repository","iconUrl":"31253.df1e5367-d9bc-46a7-8259-9b24225f294e.24914354-af15-4aa0-8ead-1c9d3e44a16d.8c184953-6f7c-4728-add7-e9aa9aa1c7a1.png","licenseUrl":"https://www.orbussoftware.com/orbus-store-app-terms","privacyUrl":"https://www.orbussoftware.com/privacy-policy","addinInfo":{"priority":3,"AUP":471}},{"displayName":"Jira Cloud for Excel","solutionId":"wa200000556","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Export Jira data to Excel - Combine the power of Jira with the flexibility of Excel","iconUrl":"56884.e2ba98e8-580f-430a-a0f6-2d54d53d7762.fb12baec-4bec-40e4-8dfc-21c060e87964.7ef37c2b-d095-4918-89f1-25637b11e385.png","licenseUrl":"https://www.microsoft.com/en-us/store/standard-application-license-terms","privacyUrl":"https://www.atlassian.com/legal/privacy-policy","addinInfo":{"priority":3,"AUP":83858}},{"displayName":"Refinitiv Add-in","solutionId":"wa200000565","version":"1.0.0.58","targetType":1,"width":0,"height":0,"description":"Build your models in Excel using Refinitiv\u2019s unique content and analytics","iconUrl":"22646.a3a6e343-b9d7-46ab-aad8-c0fc34c7b498.395fe483-7a9c-4c7f-ae27-4082290d2ccf.2a4f9940-98cd-460a-a422-d954187c3909.png","licenseUrl":"https://download.microsoft.com/download/F/D/8/FD8BA8F2-72AF-45D9-B39E-230B26CBD39D/StandardContractMarch2019.pdf","privacyUrl":"https://www.refinitiv.com/en/policies/privacy-statement","addinInfo":{"priority":-1,"AUP":356}},{"displayName":"Money in Excel","solutionId":"wa200001306","version":"2.3.0.1","targetType":1,"width":0,"height":0,"description":"Seamlessly connect your financial accounts to Excel to view and manage your finances in one place.","iconUrl":"9427.a6eaa8f8-8441-4e98-b51b-7cdc68b3ad70.1e0bd518-ace3-4c76-a4e1-5bec9f355e89.eb2dcf06-11b7-4c0c-873b-df18bf95b4fa.png","licenseUrl":"https://officepreview.microsoft.com/en-us/office-store-standard-application-license-terms-HA102821243.aspx","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":2,"AUP":1382}},{"displayName":"AI-aided Formula Editor","solutionId":"wa200001584","version":"2.6.0.0","targetType":1,"width":0,"height":0,"description":"GPT-4-powered AI features like formula generation and explanation built-in a modern Formula Editor.","iconUrl":"65260.49589048-b9b0-4c4d-9166-9853dbc8d0d0.00f729b3-2b4d-4d96-a381-52c6e940cf4e.1e8d39fe-6248-4e13-b4cc-1e61e02c196d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.10studio.tech/privacy","addinInfo":{"priority":1,"AUP":679}},{"displayName":"McGraw Hill","solutionId":"wa200002270","version":"3.0.0.0","targetType":1,"width":0,"height":0,"description":"McGraw Hill tool application aimed to assist students to learn and leverage Microsoft Excel.","iconUrl":"10994.a2611ae6-e1fb-468e-9a75-4292ffd45f92.3e087ea2-0e00-40c2-9e26-d5c264f97fae.ffc523c3-0e09-439c-9422-af52e0770aff.png","licenseUrl":"https://www.mheducation.com/terms-use.html?external_browser=2","privacyUrl":"https://www.mheducation.com/privacy.html?external_browser=2","addinInfo":{"priority":3,"AUP":118855}},{"displayName":"Jasperactive for Office","solutionId":"wa200002334","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Web-based learning for Microsoft Word, Microsoft Excel and for Microsoft PowerPoint.","iconUrl":"24398.0a1bdc08-ac9f-4231-8e69-4eb02a692937.a4408ec1-bba8-4f97-961d-09257a62e38a.0013100a-0ba3-4b30-b729-14bf64da59dc.png","licenseUrl":"https://jasperactive.com/end-user-license-agreement","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":3,"AUP":1991}},{"displayName":"XLSTAT Cloud","solutionId":"wa200002503","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Statistics and data analysis add-in.","iconUrl":"49744.000d2e73-975d-42e3-8f0f-ca360dc2cc60.8a9d0e1f-183b-4ab0-b765-b64f7b230131.6ebabbd6-be54-4fd5-8e89-3e07680d70ba.png","licenseUrl":"https://xlstat365.s3.us-east-2.amazonaws.com/legal/CLUF.pdf","privacyUrl":"https://xlstat365.s3.us-east-2.amazonaws.com/legal/PRIVACY_POLICY.pdf","addinInfo":{"priority":1,"AUP":272}},{"displayName":"PitchBook for Excel","solutionId":"wa200002663","version":"1.6.0.0","targetType":1,"width":0,"height":0,"description":"Strengthen your analysis and build better financial models using PitchBook\u2019s data.","iconUrl":"50447.f729f52c-6484-4a27-9fd9-9a62d0ad734b.8b8a588c-46ce-4201-bddc-3d6086c7d7f2.3d88619d-29d6-49b5-a2ba-33bb2a724d32.png","licenseUrl":"https://pitchbook.com/terms-of-use","privacyUrl":"https://pitchbook.com/privacy-policy","addinInfo":{"priority":-1,"AUP":768}},{"displayName":"FRED Data","solutionId":"wa200003692","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"Download data from the Federal Reserve Bank of St. Louis Economic Data (FRED).","iconUrl":"51797.9b2b8182-033d-4060-9ca5-866292d44261.be4b3e57-cbb1-436a-98af-42040dca76d3.1d354664-b22f-4494-a818-f28e5304fc35.png","licenseUrl":"https://fred.stlouisfed.org/fred-addin/legal.html","privacyUrl":"https://research.stlouisfed.org/privacy.html","addinInfo":{"priority":1,"AUP":185}},{"displayName":"Advanced formula environment, a Microsoft Garage project","solutionId":"wa200003696","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Create, edit, and reuse formulas.","iconUrl":"42604.70ef3bb6-fd4c-4868-b560-ed816d7473dd.f2947730-eef9-434b-a86d-fa6e3bafe076.525d558d-aea8-4a78-89dd-576bcceda686.png","licenseUrl":"https://support.office.com/client/61994a3b-2c87-41c4-a88d-a6455efa362d?omkt=en-US","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":-1,"AUP":382}},{"displayName":"Spreadsheet Sync","solutionId":"wa200003784","version":"1.2.0.1","targetType":1,"width":0,"height":0,"description":"It syncs your QBO Adv data directly with Excel, enabling businesses to build customized reports ","iconUrl":"19754.85145a97-15c6-4376-9196-8515ee6dfda2.17b17ce3-53d9-4050-b1a9-cd8f6d333853.43963bbc-6904-4da7-8514-7b2e0bb7b291.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.intuit.com/privacy","addinInfo":{"priority":3,"AUP":404}},{"displayName":"ArcGIS for Excel","solutionId":"wa200004179","version":"2022.3.6.0","targetType":1,"width":0,"height":0,"description":"Discover new patterns and bring Excel data to life with maps using ArcGIS.","iconUrl":"14874.7ac80e32-4af3-4961-b3a6-2e871982b721.910edbf9-9d95-4224-a14c-7935fbbf3263.64da2c2e-9f1d-4b19-9264-dfe092cbe3eb.png","licenseUrl":"https://www.esri.com/en-us/legal/terms/master-agreement-product","privacyUrl":"https://www.esri.com/en-us/privacy/privacy-statements/privacy-statement","addinInfo":{"priority":3,"AUP":403}},{"displayName":"Cegid Expert Connector for Excel","solutionId":"wa200004571","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Application apportant des fonctions personnalis\u00e9es pour exporter des donn\u00e9es de Cegid Expert.","iconUrl":"10618.583afe98-a839-46f6-a732-dbbf9ac8ac05.b4296dcd-6aea-4fb5-9e1d-d2a88879c875.ee35bc13-726a-4c70-8c82-dd0e375097d6.png","licenseUrl":"https://www.cegid.com/fr/cgv","privacyUrl":"https://www.cegid.com/fr/privacy-policy","addinInfo":{"priority":3,"AUP":2501}},{"displayName":"QR Code Tracker","solutionId":"wa200004687","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"QR Code Tracker lets you easily generate/scan QR codes in a sheet.","iconUrl":"35614.d62fd4d2-7872-42e1-a0c2-405317558142.c8500959-825f-4100-b3e6-c21597165a0b.f5cfa5f9-1345-4020-805c-d8345f029ae2.png","licenseUrl":"https://www.formiraex.com/QR_Code_Tracker/license.html","privacyUrl":"https://www.formiraex.com/QR_Code_Tracker/privacy-policy.html","addinInfo":{"priority":3,"AUP":120}},{"displayName":"Zebra BI Charts for Office","solutionId":"wa200004688","version":"1.0.0.0","targetType":0,"width":1000,"height":500,"description":"The most powerful charting visual in Excel & PowerPoint with a complete set of advanced charts! ","iconUrl":"9365.95df6186-f63a-4f9b-8cd5-414e80da57c8.ef9390f9-280b-4847-b1c6-c6fa272d852c.33527d56-43f3-4e84-bfe0-2bb6d2c2594d.png","licenseUrl":"https://zebrabi.com/legal/?doc=eula","privacyUrl":"https://zebrabi.com/legal/?doc=privacy-policy-visuals","addinInfo":{"priority":1,"AUP":120}},{"displayName":"Flow | Your instant translator for the enterprise","solutionId":"wa200004858","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Access on-brand translations with Flow all across the internet","iconUrl":"21223.73dc3f42-d93e-46d2-ac41-21e4e22f1e9d.9e6a4242-8ef5-4d96-8f3e-e8dd4eebf01b.ea39d408-2aa7-45a1-bab6-3adbaca33d44.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.lengoo.com/privacy-policy","addinInfo":{"priority":3,"AUP":18}},{"displayName":"AI Formula Generator Bot for Excel","solutionId":"wa200004935","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Transform your text instructions into Excel formulas in seconds with the help of AI.","iconUrl":"15321.02bef729-7dee-4518-80a6-f1201acff812.20f898b8-6e94-4547-b2c1-2680aff4db58.e0447c81-0b85-428e-8e98-0c3ecefac08c.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://excelformulabot.com/privacy-policy","addinInfo":{"priority":1,"AUP":286}},{"displayName":"Ghostwriter","solutionId":"wa200005107","version":"1.0.0.5","targetType":1,"width":0,"height":0,"description":"Introducing Ghostwriter OpenAI GPT-3 for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"8283.9a73910f-bc07-461c-a5aa-da58e2ce898e.24d0d825-2d57-4a56-9377-9087d459417f.b690bd3b-df98-4bef-bfc3-14135f3786f8.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://creativedatastudios.com/privacypolicy.html","addinInfo":{"priority":-1,"AUP":19}},{"displayName":"Sage Reporting 365","solutionId":"wa200005246","iconUrl":"40546.f88bb9d8-63aa-45c5-9857-bba65a51e0dd.6bd00930-2608-40f8-b6b9-6b9b7660abf7.8c645fcb-d1e3-4b8d-82a5-cea0150a26a3.png","targetType":1,"width":0,"height":0,"description":"Sage Reporting 365 is a Business Intelligence software providing access to your management data","version":"1.0.0.3","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://blog.infineo.online/privacy","addinInfo":{"priority":3,"AUP":165}},{"displayName":"ChatGPT for Excel","solutionId":"wa200005271","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Unlock the power of Excel with ChatGPT intelligence.","iconUrl":"55257.86bed75f-2814-457c-b505-403f890ae109.bd03c17e-334d-4b64-b573-33cf7a68a966.65bd7d1b-46c0-4876-a3a5-d2b84c95918d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://chatgptforexcel.com/privacy-policy","addinInfo":{"priority":1,"AUP":1541}},{"displayName":"Numerous.ai","solutionId":"wa200005281","iconUrl":"19340.b57a7be8-416b-490a-9c58-b5567322666d.bc5fbf37-4907-473d-826c-150e0ae698aa.35f4cdd6-af50-49e7-8607-efcddc63f117.png","targetType":1,"width":0,"height":0,"description":"Use AI to generate formulas, categorize items, format cells, and perform repetitive tasks.","version":"1.0.0.0","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://numerous.ai/privacy.html","addinInfo":{"priority":1,"AUP":283}},{"displayName":"FormulAI","solutionId":"wa200005333","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"FormulAI is a powerful Microsoft Excel formula assistant using AI.","iconUrl":"18944.a414168a-5468-4d7d-905c-6a9ff954a4a8.ad819f3c-11ba-4124-975b-22d1d3b278cc.d82fb89a-dcbe-49d9-9013-de1b3221d003.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.formulai.xyz/privacy-policy","addinInfo":{"priority":1,"AUP":4}}]'}get Jxj(){return m.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RegisterPopulateCommandRefactorEnabled",
!1)}EGh(Q){window.setTimeout(()=>{this.qSh()},Q)}qSh(){this.pPc?h.ULS.sendTraceTag(508826715,220,50,"The 1st attempt succeeded."):(h.ULS.sendTraceTag(508826716,220,15,"the 1st attempt was timeout, trigger another try."),this.AC(0,!0))}static ESa(Q){return 0===Q||10===Q}RQb(Q,Ia){this.cLa&&this.cLa.RQb(Q,Ia)}AC(Q,Ia){this.cLa&&(!this.pPc&&Rb.ESa(Q)&&(this.pPc=!0),this.cLa.AC(Q,Ia))}kCc(Q){this.cLa&&this.cLa.Qhb(Q)}T4g(Q,Ia){return S.a.Fh().equals(Q.solutionId,Ia.solutionId)&&S.a.Fh().equals(Q.storeType,
Ia.storeType)}ESd(Q,Ia){if(m.AFrameworkApplication.da.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType"))this.I0f(Q,Ia,OSF.StoreTypeEnum.MarketPlace);else{const ub={};ub.callbackFunc=Q;ub.storeType=OSF.StoreTypeEnum.MarketPlace;ub.fromInsertDialog=!1;ub.refresh=Ia;this.Wl.queryEntitlementDetails(ub)}}I0f(Q,Ia,ub){const Yb={};Yb.callbackFunc=Q;Yb.storeType=ub;Yb.fromInsertDialog=!1;Yb.refresh=Ia;this.Wl.queryEntitlementDetails(Yb)}invokeDdaMethod(Q,Ia){const ub=this.No(Q.DdaMethod.ControlId);
ub?ub.invokeDdaMethod(Q,Ia):this.Aj(Ha.a.internalError,Ia)}registerDdaEventAsync(Q,Ia,ub,Yb,Ca){(Ia=this.No(Ia))?Rb.MHb(Q)?Ia.xwj(Q,ub,Yb,Ca):this.Aj(Ha.a.iPd,Ca):this.Aj(Ha.a.internalError,Ca)}unregisterDdaEventAsync(Q,Ia,ub,Yb,Ca){(Ia=this.No(Ia))?Rb.MHb(Q)?Ia.pfk(Q,ub,Yb,Ca):this.Aj(Ha.a.iPd,Ca):this.Aj(Ha.a.internalError,Ca)}dispose(){if(!this.disposed){this.$.co(this.wf);this.ea.gm(this.ff);this.ea.rR(this.yp);this.ea.ny(this.Nh);this.y6c.detach(this);this.$.userOperationManager.Ap(this.WU);
if($a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DeleteCustomFunctionsObjectsManager",!1)){const Q=Va.h(this.$);null===Q||void 0===Q?void 0:Q.ya.Ft(this.Ng)}this.wzc=this.zh=this.oj=this.y6c=this.vd=null;this.hOa&&(this.hOa.dispose(),this.hOa=null);vc.a.Ma(this.HYd);vc.a.Ma(this.GYd);this.l7a&&(this.l7a.dispose(),this.l7a=null);super.dispose();this.disposed=!0;h.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed")}}xpd(Q){return(Q=this.No(Q))?Q.getDefaultIconUrl():null}xGc(Q){if(this.YUe!==
Q){this.YUe=Q;for(let Ia=0,ub=this.zh.length;Ia<ub;Ia++){const Yb=this.zh[Ia];Q?Yb.zXe(!1):Yb.nFh()}this.HYd.xGc(Q);this.GYd.xGc(Q)}}o6h(Q){return(Q=this.No(Q))?Q.getDefaultDisplayName():null}Aj(Q,Ia,ub){const Yb={};Yb[Na.a.Th]=Q;Yb[Na.a.N7]=Ia;this.wN(451041795,Yb,void 0===ub?!0:ub)}Yx(Q){const Ia={};Ia[Na.a.N7]=Q;this.wN(1237877382,Ia)}wN(Q,Ia,ub){ub=void 0===ub?!0:ub;const Yb=new dd.a(Q,0,this.$.se,0,null),Ca=Ia?Ia[Na.a.N7]:null;this.l7a&&Va.h(this.$).ld&&W.kjh(Q,Ia)?this.l7a.Jxh(Q,Ia):(Q=this.$.Ha.Ad(Yb,
Ia),ub&&Kd.TaskExtensions.za(Q,tb=>{hd.a(tb)?this.Aj(Ha.a.internalError,Ca,!1):tb.result||(Va.h(this.$).ld?this.Aj(Ha.a.UGb,Ca,!1):this.Aj(Ha.a.internalError,Ca,!1))},this.ka,8))}Hlh(Q){return!!this.pna(Ia=>Rb.getSolutionId(Ia.Vm,this.$)===Rb.getSolutionId(Q,this.$)&&Ia.Vm.PrimaryMarketplace.MarketplaceType===Q.PrimaryMarketplace.MarketplaceType&&Ia.Vm.PrimaryMarketplace.MarketplaceRef===Q.PrimaryMarketplace.MarketplaceRef&&Ia.Vm.PrimaryMarketplace.SolutionVersion===Q.PrimaryMarketplace.SolutionVersion)}No(Q){return this.pna(Ia=>
Ia.controlId.startsWith(Q))}PVh(Q){return this.pna(Ia=>Ia.uya===Q)}n7e(Q){return this.pna(Ia=>Ia.LP===Q&&!!Ia.uya)}D7e(Q,Ia,ub,Yb){return this.pna(Ca=>Ca.LP===Q&&Ca.Vm.PrimaryMarketplace.MarketplaceRef.toLowerCase()===Ia.toLowerCase()&&Ca.Vm.PrimaryMarketplace.MarketplaceType.toLowerCase()===ub.toLowerCase()&&!!Ca.Vm.SharedRuntime&&!!Ca.Vm.SharedRuntime.Resid&&!!Yb&&!!Yb.Resid&&Ca.Vm.SharedRuntime.Resid.toLowerCase()===Yb.Resid.toLowerCase())}G5g(Q,Ia){if(Q=this.No(Q))Q.la(Ia),Q.showHide(!0)}j0j(Q){(Q=
this.No(Q))&&Q.showHide(!1)}qNa(Q){var Ia;if(1!==Q.WebExtensionType||this.$.If&8388608&&Q.TaskpaneVisible||this.$.If&8388608&&!Q.TaskpaneVisible&&Yd.HelperMethods.ez(Q)){let ub=null;Yd.HelperMethods.ez(Q)&&(ub=Rb.Jza(Q,this.$),Q.TaskpaneWidth||(Q.TaskpaneWidth=this.Ezb));const Yb=(new Tc(this,this.oj,Q)).zxd();h.ULS.sendTraceTag(51263011,0,50,`DdaFacade::CreateOsfControl: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.PrimaryMarketplace.SolutionId,Q.OwnerAddinStoreType||Q.PrimaryMarketplace.MarketplaceType,
null===(Ia=Q.AssetMarketplace)||void 0===Ia?void 0:Ia.SolutionId,null,null,Q.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${Q.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${Yd.HelperMethods.ez(Q)}`);ub&&(Yb.uya=ub);this.zh.push(Yb);this.bCa=null;this.Wab(Q.InstanceId)||(Q=String.format("{0}|{1}|{2}|{3}|{4}",Q.PrimaryMarketplace.SolutionId,Q.PrimaryMarketplace.SolutionVersion,Q.PrimaryMarketplace.MarketplaceRef,Q.PrimaryMarketplace.MarketplaceType,Q.WebExtensionType),this.raiseEvent("ci",
Q))}}T1j(Q,Ia){Q.TaskpaneWidth=this.Ezb;Q.TaskpaneVisible=!0;const ub={};ub.SolutionId=Q.PrimaryMarketplace.SolutionId;ub.TargetType=Q.WebExtensionType;ub.Version=Q.PrimaryMarketplace.SolutionVersion;ub.StoreType=Q.PrimaryMarketplace.MarketplaceType;ub.StoreId=Q.PrimaryMarketplace.MarketplaceRef;Q.AssetMarketplace?(ub.AssetId=Q.AssetMarketplace.SolutionId,ub.AssetStoreId=Q.AssetMarketplace.MarketplaceRef):(ub.AssetId=null,ub.AssetStoreId=null);ub.Width=Q.TaskpaneWidth;const Yb=new Tc(this,this.oj,
Q,!0);Yb.zxd();this.zh.push(Yb);const Ca=()=>{this.tWa(Yb.controlId);this.Vg.purgeOsfControl(Yb.controlId,!1);Ia()};let tb=null;tb=ic.a.instance.CF(()=>{Yb.cB&&(vc.a.Ma(tb),tb=null,this.Vg.insertBlankControlWithErrorUX(this.OPb(Yb,ub),Ca))},100,Cc.a.twh)}Zdd(Q){if(Q&&Q.length){var Ia=[];Q.forEach(ub=>{if(ub.ContainsCustomFunctions){const Yb=Rb.Jza(ub,this.$);this.dQd.contains(Yb)||(this.dQd.add(Yb),this.aYf.push(ub));this.Hlh(ub)||Ia.push(ub)}});Ia.length&&this.YRe(Ia)}}eUe(Q,Ia){this.No(Q.InstanceId)||
(Ia=Ia(),Q=(new Tc(this,this.oj,Q)).npf(Ia),this.zh.push(Q),this.bCa=null)}C_j(Q){Rb.d7a.kd(Q)&&Rb.d7a.ma(Q).initializeAndShowWithTitle()}Cri(Q){Rb.d7a.kd(Q)&&Rb.d7a.ma(Q).hide()}Hci(Q){var Ia=null;let ub,Yb,Ca=null;ub=Rb.Htd(Q,!0);if(!ub)return h.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),he.Task.Wa(null);(Yb=this.Wl.getOsfControl(Rb.getSolutionId(ub,this.$)))&&(Ia=Yb.getManifest())&&(Ca=Ia.getSharedRuntimeForCustomFunctions("Workbook"));
if(Ia=Ca&&1===Ca.LifeTime?this.D7e(ub.PrimaryMarketplace.SolutionId,ub.PrimaryMarketplace.MarketplaceRef,ub.PrimaryMarketplace.MarketplaceType,Ca):this.PVh(Q))return he.Task.Wa(Ia.controlId);const tb=new ec.a;Yd.HelperMethods.Msc(Ca)&&(ub.SharedRuntime=Ca);Q=Yb?Yb.getNotificationParams():[];if(!Q.length)return this.ESe(ub);this.Ujg(Q,()=>{Kd.TaskExtensions.za(tb.task,()=>{this.ESe(ub)},this.ka,3)},()=>{});return tb.task}t1h(Q){Q=Rb.Htd(Q,!1);if(!Q)return h.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),
null;let Ia=null;var ub=this.Wl.getOsfControl(Rb.getSolutionId(Q,this.$));ub&&(ub=ub.getManifest())&&(Ia=ub.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return Yd.HelperMethods.Msc(Ia)&&(Q=this.D7e(Q.PrimaryMarketplace.SolutionId,Q.PrimaryMarketplace.MarketplaceRef,Q.PrimaryMarketplace.MarketplaceType,Ia))?Q.controlId:null}aoh(Q,Ia){var ub=Rb.Htd(Q,!1);if(ub){var Yb=null,Ca=this.Wl.getOsfControl(Rb.getSolutionId(ub,this.$));Ca&&(Ca=Ca.getManifest())&&(Yb=Ca.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));
if(Yd.HelperMethods.Msc(Yb)){ub.SharedRuntime=Yb;var tb=ub.PrimaryMarketplace.SolutionId;Ca=ub.PrimaryMarketplace.SolutionVersion;var $b=OSF.OsfManifestManager.getCachedManifest(tb,Ca);if($b)if(this.p8b.kd(Q))Yb=this.p8b.ma(Q),Kd.TaskExtensions.za(Yb,re=>{(re=re.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(re,Ia,this.oj.xTb)},this.ka,3);else{var cd={};cd.solutionId=tb;cd.version=Ca;cd.storeType=ub.PrimaryMarketplace.MarketplaceType;cd.storeId=ub.PrimaryMarketplace.MarketplaceRef;
ub.AssetMarketplace?(cd.assetId=ub.AssetMarketplace.SolutionId,cd.assetStoreId=ub.AssetMarketplace.MarketplaceRef):(cd.assetId=null,cd.assetStoreId=null);cd.targetType=OSF.OsfControlTarget.TaskPane;var sd=new ec.a;ub=Kd.TaskExtensions.Ul();ub=new jc.a(this.$,this,cd,ub);Yb=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(tb,Yb.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction($b,Yb,Ca);ub.createUILessSandbox(cd,$b,(re,De)=>{re&&!De?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(re,
Ia,this.oj.xTb),sd.setResult(re)):sd.setResult(null);this.p8b.remove(Q)});this.p8b.fa(Q,sd.task)}}}else h.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")}KMe(Q){(Q=this.n7e(Q))&&(Q.Vm.SharedRuntime||this.jRb(Q.controlId))}jRb(Q){(Q=this.n7e(Q))&&this.tWa(Q.controlId)}JBh(Q,Ia){if(!this.zh||!Q||!Ia)return!1;if(Q.toLowerCase()===Ia.toLowerCase())return!0;let ub=null,Yb=null;for(let Ca=0,tb=this.zh.length;Ca<tb;Ca++){const $b=this.zh[Ca];if($b.ownerAddinSolutionId&&
($b.controlId===Q&&(ub=$b.ownerAddinSolutionId.toLowerCase()),$b.controlId===Ia&&(Yb=$b.ownerAddinSolutionId.toLowerCase()),ub&&Yb))break}return ub&&ub===Yb?!0:!1}qWg(Q){this.No(Q.InstanceId)||(Q=new Tc(this,this.oj,Q),this.zh.push(Q),this.bCa=null)}U5f(Q){if(this.zh&&0<=Q&&Q<this.zh.length){const Ia=this.zh[Q],ub=Ia.cB;this.zh.splice(Q,1);this.rNf(Ia);Rd.DOMElementExtensions.Oh(ub)}}tWa(Q){if(this.zh)for(let Ia=0,ub=this.zh.length;Ia<ub;Ia++)if(this.zh[Ia].controlId===Q){this.U5f(Ia);break}}Ozj(Q){if(this.zh){Q=
Q.toLowerCase();for(let Ia=0,ub=this.zh.length;Ia<ub;Ia++)if(Q===this.zh[Ia].ownerAddinSolutionId.toLowerCase()){this.U5f(Ia);break}}}n6g(Q){Q.Pk&&(this.No(Q.floatingObject.Vm.InstanceId)||(this.kpc(Q.floatingObject.Vm.InstanceId)||this.wzc.push(Q.floatingObject.Vm.InstanceId),this.qNa(Q.floatingObject.Vm)),this.ea.isNamedObjectViewMode&&this.G5g(Q.floatingObject.Vm.InstanceId,Q.Kf))}y7e(Q){return null==this.zh?null:this.zh.find(Ia=>1===Ia.controlType&&mf.a.equals(Ia.LP,Q,!0))}Nea(Q){if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:7645729_ConsolidateFindOsfControlFromSolutionId"))return Q=
this.y7e(Q),null===Q||void 0===Q?void 0:Q.controlId;if(this.zh)for(let Ia=0,ub=this.zh.length;Ia<ub;Ia++)if(1===this.zh[Ia].controlType&&mf.a.equals(this.zh[Ia].LP,Q,!0))return this.zh[Ia].controlId;return null}dLi(Q){return(Q=this.y7e(Q))?Q.visible:!1}qVh(Q){const Ia=[];if(this.zh)for(let ub=0,Yb=this.zh.length;ub<Yb;ub++)mf.a.equals(this.zh[ub].LP,Q,!0)&&Ia.push(this.zh[ub].controlId);return Ia}WVh(Q,Ia){if(!Ia||!Q)return null;if(this.zh)for(let ub=0,Yb=this.zh.length;ub<Yb;ub++)if(1===this.zh[ub].controlType&&
mf.a.equals(this.zh[ub].LP,Q,!0)&&this.zh[ub].Vm.SharedRuntime&&mf.a.equals(this.zh[ub].Vm.SharedRuntime.Resid,Ia.Resid,!0))return this.zh[ub].controlId;return null}qPa(Q,Ia){Ia=void 0===Ia?null:Ia;return Q?Ia?`${Q}.${Ia}`:Q:""}NMe(Q,Ia,ub){if(this.bCa===Q)return!0;this.bCa=Q;let Yb=null,Ca=!1;if(!Yb&&this.zh)for(let tb=0,$b=this.zh.length;tb<$b;tb++)if(1===this.zh[tb].controlType&&mf.a.equals(this.zh[tb].LP,Q,!0)){let cd=!1,sd=!1;Ia?(cd=!0,sd=!!this.zh[tb].Vm.SharedRuntime&&mf.a.equals(this.zh[tb].Vm.SharedRuntime.Resid,
Ia.Resid,!0)):ub&&(cd=!0,sd=mf.a.equals(this.zh[tb].Vm.SharedRuntimeId,ub,!0));if(!cd||sd){sd&&this.zh[tb].Ik(!0);Yb=this.zh[tb].controlId;Ca=!0;this.bCa=null;break}}Yb&&this.raiseEvent("ca",Yb);return Ca}setAppRuntimeState(Q,Ia){var ub;if(Q){const Yb=this.No(Q);if(Yb&&Yd.HelperMethods.ez(Yb.Vm))Yb.Ik(Ia),Ia&&(this.raiseEvent("ca",Q),(null===(ub=Yb.cB)||void 0===ub?0:ub.firstChild)&&(Q=Yb.cB.firstChild.title)&&0<Q.length&&this.y9b.qNj(Q));else throw h.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),
Error.invalidOperation(ac.a.instance.ia(2250));}else throw h.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(ac.a.instance.ia(2251));}getAppRuntimeState(Q){if(Q)if((Q=this.No(Q))&&Yd.HelperMethods.ez(Q.Vm))Q=Q.Vm.TaskpaneVisible;else throw h.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(ac.a.instance.ia(2250));else throw h.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),
Error.invalidOperation(ac.a.instance.ia(2251));return Q}S8a(Q,Ia){return(Q=this.No(Q))?Q.S8a(Ia):null}Wab(Q){return this.PMe(this.wzc,Q)}kpc(Q){return this.PMe(this.SUe,Q)}aAe(Q){this.SUe.push(Q)}hY(Q){return(Q=this.No(Q))?Q.Vm:null}bLd(Q){this.raiseEvent("ekros",Q,this)}DVf(Q){if(Q){var Ia=this.No(Q.InstanceId);Ia&&(Q.SharedRuntime||Q.SharedRuntimeId||(this.tWa(Ia.controlId),this.Vg.purgeOsfControl(Ia.controlId,!1)),Ia={},Ia.SolutionId=Q.PrimaryMarketplace.SolutionId,Ia.TargetType=Q.WebExtensionType,
Ia.Version=Q.PrimaryMarketplace.SolutionVersion,Ia.StoreType=Q.PrimaryMarketplace.MarketplaceType,Ia.StoreId=Q.PrimaryMarketplace.MarketplaceRef,Q.AssetMarketplace?(Ia.AssetId=Q.AssetMarketplace.SolutionId,Ia.AssetStoreId=Q.AssetMarketplace.MarketplaceRef):(Ia.AssetId=null,Ia.AssetStoreId=null),Ia.Width=Q.TaskpaneWidth,Ia.SharedRuntimeId=Q.SharedRuntimeId,this.Wrg(Ia))}}Yma(){this.oj.Yma()}OF(Q,Ia,ub){this.oj.OF(Q,Ia,ub)}N7e(Q,Ia){Ia=Rb.mth(Ia);Q=this.hY(Q);this.oj.Bic(Q.InstanceId,2202,vd.a.oO,Ia)}kmd(Q){for(let Ia=
0,ub=this.zh.length;Ia<ub;Ia++)this.N7e(this.zh[Ia].controlId,Q)}gWh(Q,Ia){Ia=Rb.Goh(Ia);this.oj.Bic(Q,65539,"",Ia)}kWh(Q,Ia,ub){this.oj.Bic(Q,1,Ia,ub)}fWh(Q,Ia){this.oj.lWh(Q,Ia)}Xnh(Q,Ia){return[[2,1E3,"",JSON.stringify([Q,Ia]),0,!1]]}vBi(){return!!this.Xra&&this.Xra.Jlf()}Rgh(){this.Xra&&this.Xra.clear()}hWh(){if(this.Xra&&this.Xra.Jlf()){var Q=this.Xra.w1h();for(const Ia of Q){Q=this.qVh(Ia);for(const ub of Q)this.oj.Bic(ub,65540,"","{}")}}}qwj(Q){this.Xra.add(Q)}mfk(Q){this.Xra.remove(Q)}pna(Q){if(!this.zh)return null;
for(const Ia of this.zh)if(Q(Ia))return Ia;return null}ESe(Q){const Ia=new ec.a,ub=Rb.Jza(Q,this.$);if(Yd.HelperMethods.ez(Q))h.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.YXf(Q,Yb=>{Yb?(Q.InstanceId=Yb.InstanceId,Q.WebExtensionOsfControlType=3,Q.TaskpaneVisible=!1,this.qNa(Q),Ia.setResult(Q.InstanceId)):(h.ULS.sendTraceTag(537170530,0,10,`InsertAgaveTaskPane for customfunction: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Q.PrimaryMarketplace.SolutionId,
Q.PrimaryMarketplace.MarketplaceType,null,null,null,Q.PrimaryMarketplace.MarketplaceRef)} failed`),Ia.setException(Error.create("Null insert data")))});else{Rb.d7a.fa(Q.InstanceId,new Kb.a);const Yb=Rb.d7a.ma(Q.InstanceId).rea;this.Fph(Q,Yb,ub);this.YXf(Q,null);Ia.setResult(Q.InstanceId)}return Ia.task}Fph(Q,Ia,ub){this.No(Q.InstanceId)||(Q=new Tc(this,this.oj,Q),Q.uya=ub,Q.npf(Ia),this.zh.push(Q),this.bCa=null)}YXf(Q,Ia){const ub=Rb.Jza(Q,this.$);if(!this.dQd.contains(ub))this.pPb.push(Q),1<=this.pPb.length&&
this.ZXf(Q,Ia);else if(Ia)for(const Yb of this.aYf)if(Rb.Jza(Yb,this.$)===ub){Ia(Yb,0);break}}ZXf(Q,Ia){let ub=null;const Yb={};Yb.SolutionId=Rb.getSolutionId(Q,this.$);Yb.TargetType=Q.WebExtensionType;Yb.Version=Q.PrimaryMarketplace.SolutionVersion;Yb.StoreType=Q.PrimaryMarketplace.MarketplaceType;Yb.StoreId=Q.PrimaryMarketplace.MarketplaceRef;Q.AssetMarketplace?(Yb.AssetId=Q.AssetMarketplace.SolutionId,Yb.AssetStoreId=Q.AssetMarketplace.MarketplaceRef):(Yb.AssetId=null,Yb.AssetStoreId=null);Yb.Width=
Q.TaskpaneWidth;Yb.ContainsCustomFunctions=!0;Yd.HelperMethods.ez(Q)&&(Yb.SharedRuntimeId=Q.SharedRuntime.Resid);const Ca=this.$.qa.ua;Q=this.$.qa.ua.ie();const tb=Ca.Pa(9,Q);tb.sharedInfo=Yb;const $b=sd=>{sd=Bb.a.Lg(sd.data);h.ULS.sendTraceTag(537170528,0,10,`DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: ${Se.a.ue(sd)}`)},cd=sd=>{sd&&!cf.a(sd)||h.ULS.sendTraceTag(537170527,0,10,`InsertAgaveTaskPane for addin ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Yb.SolutionId,
Yb.StoreType,Yb.AssetId,null,null,Yb.StoreId)} finish with errors: ${Se.a.ue(sd.Errors)}`);this.pPb.shift();0<this.pPb.length&&this.ZXf(this.pPb[0],Ia)};if(Ia){const sd=re=>{const De=re.Result;(ub=De?De.AgaveData:null)||Ia(null,re.Errors?re.Errors[0].ErrorCause:5001);Ia(ub,0)};Q=(re,De,Ye)=>gb.g(Ca,"InsertAgaveTaskpane",tb,bd.b(re,cd,sd),bd.a(De,$b),Ye,null,0)}else Q=(sd,re,De)=>gb.g(Ca,"InsertAgaveTaskpane",tb,bd.b(sd,cd),bd.a(re,$b),De,null,0);ab.a(this.$.userOperationManager,Q,sd=>new xc.a(519,
0,sd,64),null)}qXj(){return this.$.mg.get(35)}rVd(Q){Q=this.No(Q);(null===Q||void 0===Q?0:Q.Sha)&&Q.c6f()}X0i(Q){var Ia=this.pna(ub=>Rb.HRa(ub.LP));Ia&&(Ia=this.Vg.getOsfControl(Ia.controlId))&&Ia.notifyAgave(OSF.AgaveHostAction.SendMessage,Q)}mCi(){return!!this.pna(Q=>1===Q.controlType&&Rb.HRa(Q.LP))}lCi(){const Q=this.pna(Ia=>Rb.HRa(Ia.LP));return Q?Q.cB?Rd.DOMElementExtensions.isVisible(Q.cB):!1:!1}HQj(){const Q=this.pna(Ia=>Rb.HRa(Ia.LP));Q&&(Q.Ik(!0),this.raiseEvent("ca",Q.controlId))}initialize(Q){var {DdaEventDispatch:Ia}=
a(1295);const ub=void 0===this.$||null===this.$||$a.EwaSettings.Ea(234);void 0!==this.$&&null!==this.$||h.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");ub&&h.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(Lc.LLa(this.$),this.ea=this.$.ea,this.oj=new Ia(this.$),this.$.Zm(this.wf),this.ea.Zl(this.ff),this.ea.BM(this.yp),this.ea.Mw(this.Nh),this.$.userOperationManager.Pr(this.WU),
$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DeleteCustomFunctionsObjectsManager",!1)&&(Ia=Va.h(this.$),null===Ia||void 0===Ia?void 0:Ia.ya.Eu(this.Ng)),this.IBf(),this.Naj(),this.lwi(),this.$.ga.Qa(35,this),this.y6c.la(this),ub&&h.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.Ote=new vd.a,ub&&h.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.Rte=new Gb(this.$,this.lj,this.oj),new te(this.$,this.lj,
this.oj),this.Pte=new je(this.$,this.lj,this.oj),this.Nte=new Oc(this.$,this.lj,this.oj),this.Mte=new Fc(this.$,this.lj,this.oj),this.Qte=new Ad(this.$,this.lj,this.oj),this.Ste=new Ce(this.$,this.lj,this.oj),this.Tte=new Xb(this.$,this.lj,this.oj),this.$.UY&&(this.Ute=new yd(this.$,this.lj,this.oj)),this.Vte=new Ld(this.$,this.lj,this.oj,Q),this.l7a=new W(this,Va.h(this.$)),$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&(this.Lte=new ed),this.Kte=
new bb(this.$,this.lj,this.oj),this.initialized=!0,h.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))}bWh(Q){if(!this.cHa)return null;for(let Ia=0,ub=this.cHa.length;Ia<ub;Ia++)if(Q.startsWith(this.cHa[Ia].WebExtensionId))return this.cHa[Ia];return null}IBf(){var Q,Ia=this.ea;if(Ia.oe&&!this.iZb){if(Ia.workbookContext){if(this.b3c=this.$.ea.pj.get(22),null===(Q=Ia.workbookContext.WebExtensions)||void 0===Q?0:Q.length){Q=Ia.workbookContext.WebExtensions;Ia=!1;for(let ub=Q.length-1;0<=ub;ub--){if(!this.ea.isNamedObjectViewMode){this.wzc.push(Q[ub].InstanceId);
if(1!==Q[ub].WebExtensionType){Q.splice(ub,1);continue}if(Yd.HelperMethods.ez(Q[ub])&&0!==Q[ub].SharedRuntime.State)1===Q[ub].SharedRuntime.State?Q[ub].TaskpaneVisible=!1:2===Q[ub].SharedRuntime.State?Q[ub].TaskpaneVisible=!0:h.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!Q[ub].ContainsCustomFunctions&&!Q[ub].TaskpaneVisible&&!ce.a(Q[ub])){Q.splice(ub,1);continue}}const Yb=OSF.OsfControl.isFirstPartyStoreString(Q[ub].PrimaryMarketplace.MarketplaceType);if($a.EwaSettings.Ea(174)&&
!Yb&&(Q.splice(ub,1),!Ia)){Ia=!0;const Ca=Object(Mb.a)("OfficeVSO:7811663_ConvertBusinessBarManagerService2")?Object(Aa.d)(Bc.a.resolve(Vc.m,{Ja:3})):$c.GetServiceTaskFactory.ud(this.$.ga,5,4,3);Kd.TaskExtensions.za(Ca,()=>{Ca.result.yi(36,null)},this.ka,3)}$a.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&Q[ub].PrimaryMarketplace&&Rb.HRa(Q[ub].PrimaryMarketplace.SolutionId)&&(h.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),
Q.splice(ub,1))}this.YRe(Q)}}else this.b3c=!1;this.iZb=!0}}kkf(Q){const Ia=Va.h(this.$),ub=Ia.ha.Va.pe;if(ub&&Q){Q=!1;if(this.zh)for(const Yb of this.zh)if(Rb.HRa(Yb.LP)||Rb.KFi(Yb.LP)||Rb.kHi(Yb.LP)){Q=!0;break}Q||Ia.ha.Va.oK(ub)}}Naj(){this.Vg&&this.ea.isNamedObjectViewMode&&this.$.na&&Dc.o(this.$.na)&&(this.$.ga.Da(34).oU?this.$.ga.Da(34).Kxd():this.$.ga.Da(34).Fu(this.Hgj))}YRe(Q){let Ia=null;Ia=ub=>{const Yb=ub.WebExtensionData,Ca=ub.IsTaskPane,tb=ub.RecordHandler,$b=()=>{this.cVa.shift();0<
this.cVa.length&&Ia(this.cVa[0])};if(this.Nea(Yb.PrimaryMarketplace.SolutionId))$b();else{Ca&&(Yb.WebExtensionOsfControlType=1);var cd=ce.a(Yb);if(!Ca||Yb.TaskpaneVisible||cd||Yb.SharedRuntime&&0!==Yb.SharedRuntime.State||Yb.ContainsCustomFunctions){var sd=new Tc(this,this.oj,Yb,!Ca);h.ULS.sendTraceTag(537170517,0,50,`DdaFacade::CreateAllOsfControls: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Yb.PrimaryMarketplace.SolutionId,Yb.PrimaryMarketplace.MarketplaceType,null,null,null,Yb.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${Yb.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${Yd.HelperMethods.ez(Yb)}`);
sd.zxd();Yd.HelperMethods.ez(Yb)&&(sd.uya=Rb.Jza(Yb,this.$),Yb.TaskpaneWidth=this.Ezb);cd&&(Yb.WebExtensionToolTip="");!$a.EwaSettings.isChangeGateEnabled("OfficeVSO:7610902_EnforceDefaultTaskpaneWidth")&&Ca&&Yb.TaskpaneVisible&&!cd&&(Yb.TaskpaneWidth=this.Ezb);this.zh.push(sd);var re=this.bCa=null;re=ic.a.instance.CF(()=>{sd.cB&&(vc.a.Ma(re),re=null,tb&&tb(ub,sd),$b())},100,Cc.a.swh)}else $b()}};for(let ub=0;ub<Q.length;ub++){if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:7610902_EnforceDefaultTaskpaneWidth")){const Yb=
Q[ub].WebExtensionType===OSF.OsfControlTarget.TaskPane,Ca=ce.a(Q[ub]);Yb&&!Ca&&(Q[ub].TaskpaneWidth=this.Ezb)}if(!this.No(Q[ub].InstanceId))if(1!==Q[ub].WebExtensionType)this.qNa(Q[ub]);else if(!$a.EwaSettings.Ea(52))this.Etb(Q[ub],Ia);else if(this.$.If&8388608||Q[ub].TaskpaneVisible){const Yb={};Yb.solutionId=Q[ub].PrimaryMarketplace.SolutionId;Yb.version=Q[ub].PrimaryMarketplace.SolutionVersion;Yb.storeType=Q[ub].PrimaryMarketplace.MarketplaceType;Yb.storeId=Q[ub].PrimaryMarketplace.MarketplaceRef;
Yb.targetData=Q[ub];this.Vg.isAddinCommandsAsync(Yb,(Ca,tb,$b)=>{if(Ca){var cd=$b.targetData;if(tb)if(Yb.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())Ca=Yb.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),tb=Yb.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),(Ca||tb)&&Yd.HelperMethods.ez(cd)&&this.Etb(cd,Ia);else if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))this.ioi($b,Ia);else{let sd=
!1;this.ESd(re=>{if(!re.errorCode){if(re.value)for(const De of re.value){if(sd)break;sd=Ua.e(De[1])===Ua.e(cd.PrimaryMarketplace.SolutionId)}sd?Yd.HelperMethods.ez(cd)&&this.Etb(cd,Ia):(re={},re.SolutionId=$b.solutionId,re.Version=$b.version,re.StoreType=cd.PrimaryMarketplace.MarketplaceType,re.StoreId=$b.storeId,re.AssetId=null,re.AssetStoreId=null,re.Width=cd.TaskpaneWidth,re.TargetType=cd.WebExtensionType,cd.TaskpaneVisible=!0,this.Jye(re,cd,Ia))}},!0)}else this.Etb(cd,Ia)}else Ca=$b.targetData,
h.ULS.sendTraceTag(542185164,220,15,`Judging AddinCommands failed for ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ca.PrimaryMarketplace.SolutionId,Ca.PrimaryMarketplace.MarketplaceType,null,null,null,Ca.PrimaryMarketplace.MarketplaceRef)} from ${Ca.PrimaryMarketplace.MarketplaceType} during document loading`)})}}}ioi(Q,Ia){let ub=!1;this.ESd(Yb=>{const Ca=Q.targetData;if(!Yb.errorCode){if(Yb.value)for(const tb of Yb.value){if(ub)break;ub=Ua.e(tb[1])===Ua.e(Ca.PrimaryMarketplace.SolutionId)}ub?
Yd.HelperMethods.ez(Ca)&&this.Etb(Ca,Ia):(Yb={},Yb.SolutionId=Q.solutionId,Yb.Version=Q.version,Yb.StoreType=Ca.PrimaryMarketplace.MarketplaceType,Yb.StoreId=Q.storeId,Yb.AssetId=null,Yb.AssetStoreId=null,Yb.TargetType=Ca.WebExtensionType,Yb.Width=Ca.TaskpaneWidth,Ca.TaskpaneVisible=!0,this.Jye(Yb,Ca,Ia))}},!0)}Etb(Q,Ia){const ub={};ub.WebExtensionData=Q;ub.IsTaskPane=!0;this.cVa.push(ub);1===this.cVa.length&&Ia(ub)}Jye(Q,Ia,ub){const Yb={};Yb.ActivationInfo=Q;Yb.WebExtensionData=Ia;Yb.IsTaskPane=
!1;Yb.RecordHandler=(Ca,tb)=>{const $b=Ca.ActivationInfo;this.Vg.insertBlankControlWithErrorUX(this.OPb(tb,$b),()=>{this.tWa(tb.controlId);this.Vg.purgeOsfControl(tb.controlId,!1);this.Wrg($b)})};this.cVa.push(Yb);1===this.cVa.length&&ub(Yb)}Wrg(Q){var Ia={};Ia.solutionId=Q.SolutionId;Ia.version=Q.Version;Ia.storeType=Q.StoreType;Ia.storeId=Q.StoreId;Ia.assetId=Q.AssetId;Ia.assetStoreId=Q.AssetStoreId;Ia.targetType=Q.TargetType;Ia.sharedRuntimeId=Q.SharedRuntimeId;Q=new T.a;Q.add(Ia);Ia={};Ia[Y.a.Mub]=
Q;Ia[Y.a.$W]=3;Q=new dd.a(Af.a.DKb,0,this.$.se,0,null);this.$.Ha.Ad(Q,Ia)}OPb(Q,Ia){const ub={};ub.div=Q.cB;ub.id=Q.controlId;ub.solutionId=Ia.SolutionId;ub.version=Ia.Version;ub.storeId=Ia.StoreId;ub.storeType=Ia.StoreType;ub.osfControlType=OSF.OsfControlTarget.TaskPane;return ub}T9f(){if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){const ub=[];for(var Q=0;Q<this.zh.length;Q++){var Ia=this.zh[Q];0!==Ia.osfControlType&&3!==Ia.osfControlType&&4!==Ia.osfControlType||
ub.push(Ia)}Q=!1;for(Ia=0;Ia<ub.length;Ia++){const Yb=ub[Ia];this.tWa(Yb.controlId);!Q&&Yb&&Yb.Vm&&(Q=Yd.HelperMethods.ez(Yb.Vm))}Q&&this.wN(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:4})}$a.EwaSettings.Ea(355)&&Kd.TaskExtensions.za($c.GetServiceTaskFactory.ud(this.$.ga,278,279,3),ub=>{ub&&(ub=ub.result)&&(this.$.ga.Da(278)||this.$.ga.Qa(278,ub),ub.vqf().$ra())},this.ka,3)}mO(){var Q=new Ie(this.$,this.lj,this.fag);void 0===this.$||null===this.$?h.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):
$a.EwaSettings.Ea(234)&&h.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.lj||null===this.lj));if(Q.K_i()){const Ia=()=>{},ub=Ca=>{Ca=Bb.a.Lg(Ca.data);h.ULS.sendTraceTag(537170511,0,10,`ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: ${Se.a.ue(Ca)}.`)},Yb=Q.jah();Q=Rb.Brd(Yb);Q|=64;this.$.userOperationManager.OH(new xc.a(507,0,(Ca,tb,$b)=>gb.g(this.$.qa.ua,"ExecuteRichApiRequest",
this.lah(Yb),bd.b(Ca,Ia),bd.a(tb,ub),$b,null,0),Q))}}lah(Q){const Ia=this.$.qa.ua.Pa(1);Ia.request=Q;return Ia}PMe(Q,Ia){if(Q)for(let ub=0;ub<Q.length;ub++)if(mf.a.equals(Q[ub],Ia,!0))return!0;return!1}k$g(Q){const Ia={};Ia.navigationMode=OSF.OsfNavigationMode.DefaultMode;Ia.assetId=null;Ia.category=null;if(!Q||3>Q.length)return Ia;if(Q[0]){const ub=parseInt(Q[0],10);isNaN(parseInt(ub,10))||(Ia.navigationMode=ub)}Q[1]&&(Ia.assetId=Q[1]);Q[2]&&(Ia.category=Q[2]);return Ia}lwi(){if($a.EwaSettings.Ea(60)){var Q=
this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(Q&&"*"!==Q.trim()){this.hOa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new Nb(this),Q,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.mg.get(2));try{this.hOa.init()}catch(Ia){try{this.hOa.dispose()}catch(ub){}this.hOa=null;h.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+Ia.message)}Q={};Q.a=this.$.xa.UserSessionId;se.b().ih(39,Q)}}}Ujg(Q,Ia,ub){const Yb=Rb.w9g(Q[0]),
Ca=Yb.Pla,tb=Yb.Mma;Yb.Pla=()=>{Ca&&Ca();const $b=Yb.lRa!==OSF.InfoType.Error?Ia:null;Q.shift();Q.length?this.Ujg(Q,$b,ub):$b&&$b()};Yb.Mma=()=>{tb&&tb();ub&&Yb.lRa!==OSF.InfoType.Error&&ub()};Sb.a.J3d(Yb)}U9h(){const Q={};Q.AddinRibbonControlsOverriddenByApi=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();Q.AddinActionDefinitionHybridMode=$a.EwaSettings.Ea(556).toString();Q.UseActionIdForUILessCommand=$a.EwaSettings.Ea(559).toString();Q.AllowStorageAccessByUserActivationOnIFrame=
$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();Q.RequirementSetRibbonApiOnePointTwo=$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();Q.flightingTreatmentVariables=m.AFrameworkApplication.da.Jic;Q.ShortcutInfoArrayInUserPreferenceData=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();Q.DisabledChangeGates=
m.AFrameworkApplication.da.Sa("DisabledChangeGates");Q.DmsSdxListWorkbook=m.AFrameworkApplication.sYe;return Q}static get zcc(){return Rb.ahe}static set zcc(Q){Rb.ahe=Q}static getSolutionId(Q){let Ia=Q.PrimaryMarketplace.SolutionId;$a.EwaSettings.Ea(261)&&Q.OwnerAddinSolutionId&&(Ia=Q.OwnerAddinSolutionId);return Ia}static Brd(Q){let Ia=0;$a.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?Q.RequestFlags&1&&256!==(Q.RequestFlags&256)||(Ia=16):Ia=Q.RequestFlags&
1?0:16;return Ia}static Jza(Q,Ia){Ia=Rb.getSolutionId(Q,Ia);return Rb.$bf(Ia,Q.PrimaryMarketplace.SolutionVersion,Q.PrimaryMarketplace.MarketplaceType,Q.PrimaryMarketplace.MarketplaceRef)}static mth(Q){return JSON.stringify({["recording"]:Q})}static Goh(Q){const Ia={};Ia.visibility=Q?"Visible":"Hidden";return JSON.stringify(Ia)}static S5h(Q){let Ia=Q.getSolutionId(),ub=Q.getVersion(),Yb=Q.getStoreType();Q=Q.getStoreId();return Rb.$bf(Ia,ub,Yb,Q)}static $bf(Q,Ia,ub,Yb){return String.format("{0}|{1}|{2}|{3}|{4}|||",
"2",Q,Ia,Rb.Ohi(ub).toString(),Yb)}static Htd(Q,Ia){var ub=Q.split("|");if(7>ub.length)return h.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==ub[0])return h.ULS.sendTraceTag(537170508,0,10,`DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='${ub[0]}'.`),null;let Yb=ub[1];const Ca=ub[2],tb=Rb.Phi(ub[3]),$b=ub[4];ub=ub[5];Yb&&Yb.length||(Yb=ub);ub={};ub.InstanceId=String.format("{{{0}}}",X.a.create().toString());
ub.WebExtensionOsfControlType=4;ub.WebExtensionType=1;ub.PrimaryMarketplace={};ub.PrimaryMarketplace.SolutionId=Yb;ub.PrimaryMarketplace.SolutionVersion=Ca;ub.PrimaryMarketplace.MarketplaceRef=$b;ub.PrimaryMarketplace.MarketplaceType=tb;ub.ContainsCustomFunctions=Ia?!0:!1;Ia&&(ub.OsfPropertyBag=[["customFunctionAddinId",Q]]);return ub}static Phi(Q){Q=parseInt(Q,10);return Q===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:Q===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:Q===OSF.StoreTypeEnum.SPApp?
OSF.StoreType.SPApp:Q===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:Q===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:Q===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:Q===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:Q===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:Q===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:Q===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:Q===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:
null}static Ohi(Q){return Q===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:Q===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:Q===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:Q===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:Q===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:Q===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:Q===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:Q===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:Q===OSF.StoreType.FirstParty?
OSF.StoreTypeEnum.FirstParty:Q===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:Q===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1}eya(Q){const Ia={};Ia.Version=Q.version;Ia.AssetId=Q.assetId;Ia.AssetStoreId=Q.assetStoreId;Ia.StoreType=Q.storeType;Ia.Height=Q.height;Ia.SolutionId=Q.solutionId;Ia.StoreId=Q.storeId;Ia.TargetType=Q.targetType;Ia.Width=1===Ia.TargetType?0:Q.width;Ia.SharedRuntimeId=Q.sharedRuntimeId;return Ia}static MHb(Q){return Q===OSF.DDA.EventDispId.dispidSettingsChangedEvent||
Q===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||Q===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Q===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||Q===OSF.DDA.EventDispId.dispidRichApiMessageEvent||Q===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||Q===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||Q===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static w9g(Q){return Object(c.a)(new kf.a,{lRa:Q.infoType,id:Q.id,title:Q.title,description:Q.description,
buttonText:Q.buttonTxt,Pla:Q.buttonCallback,Hnc:Q.highPriority,Mma:Q.dismissCallback,errorCode:Q.errorCode,zof:Q.iframeNotificationUrl})}static HRa(Q){let Ia="FA000000014"===Q;Ia||(Ia="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===Q);return Ia}static KFi(Q){return"FA000000005"===Q}static kHi(Q){return"FA000000064"===Q}}Rb.d7a=new H.a;Rb.ahe=!0;Object(b.a)(Rb,"DdaFacade",Ta.a,[204,796,770,797,798,5])},806:function(w,C,a){a.d(C,"a",function(){return b});w=a(0);class b{constructor(c,h,k,d){this.ddaBinding=
null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=c;this.controlId=h;this.ddaBinding=k;this.ArrayData=void 0===d?null:d}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}Object(w.a)(b,"DdaEventArgs",null,[])},863:function(w,C,a){w=a(0);class b{constructor(){this.title=this.id=this.tabs=null}}Object(w.a)(b,"AddInDataTransferObject",null,[]);a.d(C,"a",function(){return c});class c{constructor(h,k,d){this.IZb=h;this.FEg=k;this.GEg=d}get Mv(){return this.IZb}get LVg(){return this.FEg}get MVg(){return this.GEg}static DCb(h){return(h=
h.wZ)?Object.assign(new b,{tabs:h.Mv.toArray(),id:h.LVg,title:h.MVg}):null}}Object(w.a)(c,"OneLineRibbonExtensibility",null,[])},868:function(w,C,a){a.d(C,"a",function(){return b});a.d(C,"b",function(){return c});const b=h=>{let k=null;switch(h){case 0:k="omex";break;case 1:k="spcatalog";break;case 2:k="spapp";break;case 3:k="filesystem";break;case 4:k="exchange";break;case 6:k="registry";break;case 7:k="inmemory";break;case 8:k="uploadfiledevcatalog";break;case 9:k="hardcodedpreinstall";break;case 10:k=
"excatalog";break;case 16:k="wopicatalog"}return k},c=h=>{let k=-1;switch(h.toLowerCase()){case "omex":k=0;break;case "spcatalog":k=1;break;case "spapp":k=2;break;case "filesystem":k=3;break;case "exchange":k=4;break;case "registry":k=6;break;case "inmemory":k=7;break;case "uploadfiledevcatalog":k=8;break;case "hardcodedpreinstall":k=9;break;case "excatalog":k=10;break;case "wopicatalog":k=16}return k}},903:function(w,C,a){a.r(C);w=a(0);var b=a(198),c=a(14),h=a(106);class k{constructor(){this.startTime=
0;this.callback=null}}Object(w.a)(k,"SSOCallbackInfo",null,[]);class d{constructor(){this.accessToken=null}}Object(w.a)(d,"AccessTokenInformation",null,[863]);var f=a(1026);class u{constructor(){this.token=null;this.expiresOn=0;this.xla=this.authChallenge=null}}Object(w.a)(u,"CachedTokenInfo",null,[]);class r{constructor(){this.n_b=new b.a;this.oda=this.nda=!1;this.qta=this.authChallenge=null;this.startTime=this.retryCount=0;this.lDe=null}get callbacks(){return this.n_b}}Object(w.a)(r,"SSORequestInfo",
null,[]);class t extends r{constructor(){super();this.errorCode=0}}Object(w.a)(t,"SSOFailedRequestInfo",r,[]);var v=a(5);class x{constructor(I,R,X,H){this.zW=new b.a;this.xJ=new b.a;this.yua=null;this.Srb=new b.a;this.noe=Promise.resolve(null);this.Bve=!1;this.q4b=R;this.Yba=I;this.dwe=X;this.LEg=H}yYj(I){if(this.yua&&this.yua.authChallenge===I.authChallenge){if(Date.now()/1E3+x.fXi>this.yua.expiresOn)return this.yua=null,!1;I=new f.a;I.token=this.yua.token;I.expiresOn=this.yua.expiresOn;I.xla=this.yua.xla;
I.tZa=!0;I.EEb=0;this.cFb(I);return!0}return!1}VWj(I){for(let R=0;R<this.xJ.count;R++)if(this.xJ.ma(R).authChallenge===I.authChallenge&&this.xJ.ma(R).qta===I.qta){let X;(X=this.xJ.ma(R)).retryCount=X.retryCount+1;I.retryCount=this.xJ.ma(R).retryCount;if(this.xJ.ma(R).retryCount<x.FXi||!this.xJ.ma(R).nda&&I.nda||!this.xJ.ma(R).oda&&I.oda){if(!this.xJ.ma(R).nda&&I.nda||!this.xJ.ma(R).oda&&I.oda)I.retryCount=0;this.xJ.removeAt(R);break}I=new f.a;I.errorCode=this.xJ.ma(R).errorCode;this.cFb(I);return!0}return!1}FXg(I,
R){for(let X=0;X<this.xJ.count;X++)if(this.xJ.ma(X).qta===I.qta&&this.xJ.ma(X).authChallenge===I.authChallenge)return;this.xJ.add(Object.assign(new t,{nda:I.nda,oda:I.oda,authChallenge:I.authChallenge,qta:I.qta,errorCode:R,retryCount:I.retryCount}))}get resource(){return this.q4b}kod(I,R,X,H,M,O){const {AppsForOfficeSingleSignOnManager:L}=a(903);""===X&&(X=null);if(this.Bve)L.e$(O,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var S=null;for(const T of this.zW)if(T.nda===I&&
T.oda===R&&T.authChallenge===X&&T.qta===M){S=T;break}S||(S=Object.assign(new r,{nda:I,oda:R,authChallenge:X,lDe:H,qta:M,retryCount:0,startTime:L.Yy()}),this.zW.add(S));S.retryCount=0;S.callbacks.add(O);this.noe=this.noe.then(()=>{var {AppsForOfficeSingleSignOnManager:T}=a(903);if(0<this.zW.count){var V=this.zW.ma(0);if(this.yYj(V)||this.VWj(V))return null;for(let Z=0;Z<this.Srb.count;)this.Srb.ma(Z)+x.x9j<T.Yy()?this.Srb.removeAt(Z):Z++;if(this.Srb.count>=x.BXi||this.zW.count>=x.aXi)return V=new f.a,
V.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.cFb(V),null;let la=null;v.AFrameworkApplication.sa&&(T=v.AFrameworkApplication.sa.EG)&&(la=T.Ze("ComponentAttach",this.Yba+x.aRg));return V.qta.ATg(this.resource,V.nda,V.oda,V.authChallenge,this.LEg,V.lDe).then(Z=>{la&&la.stop();this.cFb(Z)},()=>{la&&la.stop();const Z=new f.a;Z.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.cFb(Z)})}return null})}}cFb(I){const {AppsForOfficeSingleSignOnManager:R}=a(903);
try{if(this.zW.count){var X=this.zW.ma(0);this.zW.removeAt(0);var H=null;I.errorCode||(H=new d,H.accessToken=I.token);I.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&I.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&I.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&I.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.FXg(X,I.errorCode);var M={};null!=I.EEb&&(M.getTokenSilentTime=I.EEb.toString());null!=I.mtd&&
(M.getTokenPopupTime=I.mtd.toString());null!=I.Lqd&&(M.getIDTokenTime=I.Lqd.toString());null!=I.tZa&&(M.tokenCached=I.tZa.toString());I.s7d&&(M.detailedError=I.s7d);I.xla&&(M.authLibrary=I.xla);X.retryCount&&(M.retryCount=X.retryCount);for(var O of X.callbacks)R.e$(O,I.errorCode,H,M);null!=I.tZa&&I.tZa||this.Srb.add(X.startTime);if(!I.errorCode)for(null!=I.expiresOn&&(this.yua=Object.assign(new u,{token:I.token,expiresOn:I.expiresOn,authChallenge:X.authChallenge,xla:I.xla})),this.xJ.clear(),O=0;O<
this.zW.count;)if(this.zW.ma(O).authChallenge===X.authChallenge){for(const L of this.zW.ma(O).callbacks)R.e$(L,I.errorCode,H,M);this.zW.removeAt(O)}else O++}}catch(L){c.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",L.message)}}shutdown(){this.Bve=!0;this.zW.clear()}}x.x9j=6E4;x.BXi=6;x.aXi=6;x.FXi=3;x.fXi=300;x.aRg="GetAccessToken";Object(w.a)(x,"SSOCallbackManager",null,[]);var m=a(753),l=a(429),n=a(118),z=a(64),y=a(32),B=a(31),G=a(176),E=a(357);a.d(C,"AppsForOfficeSingleSignOnManager",
function(){return J});class J{constructor(I,R,X){X=void 0===X?null:X;this.kPc=new h.a;const H=new b.a;R&&H.add(R.xVi);X&&H.addRange(X);this.Wl=I;this.fSg=H}lod(I,R,X,H,M,O,L,S,T,V){V=Object.assign(new k,{startTime:J.Yy(),callback:V});try{const da=!!X&&""!==X;var la=V.startTime;const ba=this.getOsfControl(I);let na=ba.getStoreType()||"",Y=ba.getOwnerAddinStoreType()||"",Ga=ba.getSolutionId()||"";const ma=ba.getVersion()||"";na=na.toLowerCase();Y=Y.toLowerCase();Ga=Ga.toLowerCase();var Z=z.a.Kqd(R)||
"";const fa=z.a.Kqd(ba.getIframeUrl())||"",Xa=Z.toLowerCase()===fa.toLowerCase();Z=na;"inmemory"===na&&(Z=Y);const Ua=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ga,Z,ba.getAssetId(),null,null,ba.getStoreId()),ka={["callInstanceId"]:la.toString(),["controlSolutionId"]:Ua,["controlVersion"]:ma,["storeType"]:na,["ownerStoreType"]:Y,["allowConsentPrompt"]:H.toString(),["forMSGraphAccess"]:M.toString(),["allowSignInPrompt"]:O.toString(),["hasAddinAuthChallenge"]:da.toString(),["securityOriginEqualsSourceLocation"]:Xa.toString(),
["singleSignOnEnabled"]:L.toString(),["accountTypeFilter"]:S||""};c.ULS.sendTraceTag(51401115,344,50,"{0}",ka);G.a.sendTelemetryEvent(Object.assign(new E.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:n.a.$k(ka)}));la=!0;const nb=v.AFrameworkApplication.da.Sa("HostAuthType");switch(S){case "aad":la="aad"===nb;break;case "msa":la="msa"===nb;break;default:la=!S||"noFilter"===S}if(la){S=null;if(L)for(const Ea of this.fSg)if(Ea.UDi(Ga)){S=Ea;break}S?this.isSSOAddin(I)?(L=!0,
"omex"===Z&&(L=!1),"spapp"===Z||"spcatalog"===Z?(c.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),J.e$(V,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):M&&!L?(c.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),J.e$(V,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(M&&"exchange"===Z&&(H=!1),this.kod(I,R,X,Z,H,O,T,S,V))):(c.ULS.sendTraceTag(22402395,
344,10,"GetAccessToken: current Addin is not a SSO Addin."),J.e$(V,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):J.e$(V,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else J.e$(V,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(da){this.tuc(),c.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",da.message),J.e$(V,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(I,
R,X,H){this.lod(I,X[m.a.h6c]||null,X[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,X[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,X[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,X[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,R,X[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,X[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,H)}kod(I,R,
X,H,M,O,L,S,T){this.kPc.kd(I)?H=this.kPc.ma(I):(H=new x(I,this.getWebApplicationResource(I).split(",")[0],H,this.getDefaultDisplayName(I)),this.kPc.add(I,H));const V=H.resource;I=J.Bfi(V,this.getWebApplicationId(I));const la=OfficeExt.WACUtils.getHostSecure(R);I&&la?I.toLowerCase()===la.toLowerCase()?H.kod(M,O,X,L,S,T):(J.xTa('SSO Resource "'+V+'" cannot be used from "'+R+'" origin due to domain mismatch.'),c.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),
J.e$(T,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(I||c.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),la||c.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),J.e$(T,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}tuc(){c.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(I){return this.Wl.getOsfControl(I)}isSSOAddin(I){return this.getOsfControl(I).getManifest().isSSOAddin()}getWebApplicationId(I){return this.getOsfControl(I).getManifest().getWebApplicationId()}getWebApplicationResource(I){return this.getOsfControl(I).getManifest().getWebApplicationResource()}getDefaultDisplayName(I){return this.getOsfControl(I).getManifest().getDefaultDisplayName()}static nhi(){try{const I=
{};y.a.VBa&&l.OAuthManagerSettings.UFb&&(I.UiHostSupportsAuthTokenAddinList=J.U7e);I.UiHostSupportsAuthToken=l.OAuthManagerSettings.UFb;return I}catch(I){c.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",I.message)}return null}static getInstance(I,R,X){J.La||(J.La=new J(I,void 0===X?null:X));return J.La}static xTa(I){window.console.warn&&window.console.warn(I)}static Bfi(I,R){if(!I)return"";R||(R="");let X=I.toLowerCase();var H=R.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(H)||
(J.xTa('SSO App Id "'+R+'" is not a valid format. It will be rejected from store submission.'),c.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));X.endsWith(H)||(J.xTa('SSO Resource "'+I+'" does not end with App Id "'+R+'". It will be rejected from store submission.'),c.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!X.startsWith("https://")&&!X.startsWith("api://"))return J.xTa('SSO Resource "'+I+'" must be https:// or api:// protocol.'),c.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(R=0;R<I.length;R++){H=I.charAt(R);const M=B.a.charCodeAt(I,R);if(33>M||126<M||"&"===H||"?"===H||"#"===H||"%"===H||"\\"===H)return J.xTa('SSO Resource "'+I+'" contains an invalid character "'+H+'".'),c.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+H+"' in resource URI."),""}if(0<=I.indexOf("::"))return J.xTa('SSO Resource "'+I+'" contains an invalid string "::".'),c.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<
I.length)return J.xTa('SSO Resource "'+I+'" is '+I.length+" characters and exceeds the max length of 120 characters."),c.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+I.length+"."),"";X.startsWith("api://")&&(X="https://"+X.substring(6,X.length));return 8===X.length?"":OfficeExt.WACUtils.getHostSecure(X)||""}static e$(I,R,X,H){var M=I.startTime;let O=0;0<M&&(O=J.Yy()-M);M={["callInstanceId"]:M.toString(),["callDuration"]:O.toString(),["errorCode"]:R.toString()};if(H)for(const L in H)M[L]=
H[L];c.ULS.sendTraceTag(51401116,344,50,"{0}",M);G.a.sendTelemetryEvent(Object.assign(new E.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:n.a.$k(M)}));I.callback(R,X)}static Yy(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(I){}return Date.now()}}J.U7e="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");J.La=null;Object(w.a)(J,
"AppsForOfficeSingleSignOnManager",null,[840])},919:function(w,C,a){a.d(C,"a",function(){return b});w=a(0);var b;(function(c){c[c.myAddins=0]="myAddins";c[c.adminManaged=1]="adminManaged";c[c.popular=2]="popular"})(b||(b={}));Object(w.b)("AddinCollectionType",b)},920:function(w,C,a){a.d(C,"a",function(){return c});w=a(0);var b=a(16);class c{constructor(){this.p5e={["tabhome"]:"Ribbon.Home",["tabinsert"]:"Ribbon.Insert",["tabdata"]:"Ribbon.Data",["tabreview"]:"Ribbon.Review",["tabview"]:"Ribbon.View"};
this.o5e={["tabpagelayoutexcel"]:["Ribbon.PageLayoutExcel",b.a.instance.ia(1633),b.a.instance.ia(1637)],["tabformulas"]:["Ribbon.Formulas",b.a.instance.ia(1634),b.a.instance.ia(1638)],["tabdeveloper"]:["Ribbon.Developer",b.a.instance.ia(1635),b.a.instance.ia(1639)],["tabaddins"]:["Ribbon.AddIns",b.a.instance.ia(1636),b.a.instance.ia(1640)]};this.vhc=null}get rma(){return"SourceControlId"}get iQ(){return"Workbook"}get formFactor(){return"DesktopFormFactor"}Xai(){if(!this.vhc){this.vhc={};for(const h of Object.keys(this.p5e))this.vhc[h]=
this.p5e[h];for(const h of Object.keys(this.o5e))this.vhc[h]=this.o5e[h][0]}}}Object(w.a)(c,"AddinCommandsStringProvider",null,[816])},921:function(w,C,a){a.d(C,"a",function(){return b});w=a(0);var b;(function(c){c[c.OK=0]="OK";c[c.notReady=1]="notReady";c[c.storeDisabled=2]="storeDisabled";c[c.invokeFailure=3]="invokeFailure";c[c.serviceDisabled=4]="serviceDisabled"})(b||(b={}));Object(w.b)("AddinDetailsQueryError",b)},923:function(w,C,a){a.d(C,"a",function(){return b});w=a(0);class b{constructor(){this.lRa=
0;this.Pla=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.Hnc=!1;this.zof=this.Mma=null}}Object(w.a)(b,"AddInCommandsNotificationParameters",null,[])},995:function(w,C,a){w=a(0);var b=a(14),c=a(79),h=a(169),k=a(13),d=a(95);class f extends Sys.UI.Control{constructor(H,M,O,L){super(document.createElement("div"));this.dW=this.bW=this.yy=this.qJ=this.EJ=this.sua=this.Ova=null;this.vpb=this.gva=!1;this.content=this.Mr=null;this.n5=0;this.fIe=null;this.kX=0;this.uUf=null;
this.Awe=H;this.Kre=M;this.xS=O;this.LM=L;this.wi=M.ownerDocument;this.hnc=this.hw=this.Rpb=!1}get yZ(){this.Ova||(this.Ova=this.wi.createElement("div"),this.Ova.id=this.Rj("WACCalloutOuter"),this.Ova.className="WACCalloutOuter",this.Ova.setAttribute(d.a.Mf,d.a.Avb),this.Ova.style.width=this.n5+"px");return this.Ova}get Xvb(){if(!this.sua){this.sua=this.wi.createElement("div");this.sua.id=this.Rj("WACCalloutBeakContainer");this.sua.className="WACCalloutBeakContainer";var H="CalloutBeakTopFilled_32x16x32";
if(5===this.kX||6===this.kX||4===this.kX)H="CalloutBeakBottomFilled_32x16x32";H=h.createClusteredImage(32,16,H,"WACCalloutBeak",!0,"");this.sua.appendChild(H)}return this.sua}set Xvb(H){this.sua=H}get ORa(){return this.Rpb}get title(){return this.Mr}set title(H){this.Mr!==H&&(this.Mr=H,this.bW&&(this.bW.innerText=this.Mr))}get hw(){return this.gva}set hw(H){this.gva!==H&&(this.gva=H,this.EJ&&(this.EJ.contains(this.yy)&&!this.gva?this.EJ.removeChild(this.yy):!this.EJ.contains(this.yy)&&this.gva&&this.Uze()))}get hnc(){return this.vpb}set hnc(H){this.vpb!==
H&&(this.vpb=H,this.EJ&&(this.EJ.contains(this.bW)&&!this.vpb?this.EJ.removeChild(this.bW):!this.EJ.contains(this.bW)&&this.vpb&&this.gBe()))}show(){this.Rpb||(this.Xph(),this.Io(),this.Kre.appendChild(this.yZ),this.yZ.style.display="Block",this.LTj(),this.Rpb=!0,this.uUf&&this.uUf())}dismiss(){this.Rpb&&(this.qea(),this.Kre.removeChild(this.yZ),this.Rpb=!1,this.LM&&this.LM())}dispose(){this.dismiss();this.bW=this.yy=this.qJ=this.sua=this.EJ=this.Ova=null;Sys.Component.prototype.dispose.call(this)}Rj(H){return this.get_element().id+
H}Xph(){this.EJ=this.wi.createElement("div");this.EJ.id=this.Rj("WACCalloutHeader");this.EJ.className="WACCalloutHeader";this.hw&&this.Uze();this.hnc&&this.gBe();this.qJ=this.wi.createElement("div");this.qJ.id=this.Rj("WACCalloutContent");this.qJ.className="WACCalloutContent";this.qJ.style.width=190<this.n5?this.n5-26+"px":"164px";this.qJ.appendChild(this.content);this.yZ.appendChild(this.Xvb);this.yZ.appendChild(this.EJ);this.yZ.appendChild(this.qJ)}Uze(){this.yy=this.wi.createElement("a");this.yy.className=
"WACCalloutCloseAnchor";this.yy.id=this.Rj("WACCalloutCloseAnchor");this.yy.href="#";this.EJ.appendChild(this.yy);const H=h.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.yy.appendChild(H)}gBe(){this.bW=this.wi.createElement("div");this.bW.className="WACCalloutTitle UIFontBold";this.bW.style.width=190<this.n5?this.n5-30+"px":"160px";this.bW.id=this.Rj("WACCalloutTitle");this.bW.innerText=this.title;this.EJ.contains(this.yy)?this.EJ.insertBefore(this.bW,
this.yy):this.EJ.appendChild(this.bW)}LTj(){var H=this.Awe;let M;if(1===this.kX){var O=this.fIe.y+16;M=-16}else 2===this.kX||3===this.kX||0===this.kX?(O=H.y+H.height+15,M=-15):(O=H.y-this.yZ.clientHeight-15-2,M=this.yZ.clientHeight-1);this.yZ.style.top=O+"px";this.Xvb.style.top=M+"px";1===this.kX?(H=this.fIe.x-16,this.yZ.style.left="50%",this.yZ.style.marginLeft=-this.n5/2+"px",O=Sys.UI.DomElement.getBounds(this.yZ),this.Xvb.style.left=H-O.x+"px"):(O=H.x+this.Awe.width/2,2===this.kX||5===this.kX?
(H=20,O-=36):0===this.kX||4===this.kX?(H=this.n5/2-16,O-=this.n5/2):(H=this.n5-20-32,O=O-this.n5+36),this.yZ.style.left=O+"px",this.Xvb.style.left=H+"px")}Io(){this.hw&&!this.dW&&(this.dW=Object(c.a)(this,this.Uda,"closeHandler"),this.xS.ta(k.a.click,this.yy,this.dW,null))}qea(){this.hw&&this.dW&&(this.xS.Aa(k.a.click,this.yy,this.dW),this.dW=null)}Uda(){this.dismiss();return!0}}Object(w.a)(f,"Callout",Sys.UI.Control,[446]);class u extends f{constructor(H,M,O,L,S,T){super(H,O,S.v_,void 0===T?null:
T);this.Ppe=0;this.n5=this.bbi(L);this.U2a=M;this.kh=S;this.z$j=7;this.Qn=this.U2a.ownerDocument.createElement("div");this.Qn.className="ModalCalloutControlOverlay";this.Qn.tabIndex=0;this.U2a.insertBefore(this.Qn,this.U2a.firstChild)}show(){this.ORa||(this.kh.NAc(),this.kh.YS(!1),this.Qn.style.zIndex=String(this.kh.u6),super.show(),this.il(),this.Ppe=window.setTimeout(Object(c.a)(this,this.dismiss,"dismiss"),1E3*this.z$j))}dismiss(){this.ORa&&(this.kh.SP(!1),this.Jk(),this.U2a&&this.U2a.contains(this.Qn)&&
this.U2a.removeChild(this.Qn),super.dismiss(),window.clearTimeout(this.Ppe))}il(){this.kh.Vwa(Object(c.a)(this,this.dismiss,"dismiss"));this.kh.ZC.ta(k.a.click,this.Qn,Object(c.a)(this,this.mf,"onClick"))}Jk(){this.kh.kib(Object(c.a)(this,this.dismiss,"dismiss"));this.kh.ZC.Aa(k.a.click,this.Qn,Object(c.a)(this,this.mf,"onClick"))}mf(){this.dismiss();return!0}bbi(H){let M=0;switch(H){case 0:M=190;break;case 1:M=250;break;case 2:M=300;break;case 3:M=360}return M}}Object(w.a)(u,"ModalCallout",f,[]);
var r=a(472),t=a(189);class v extends u{constructor(H,M,O,L,S,T){super(H,M,O,L,S,void 0===T?null:T);this.f3b=null}show(){if(!this.ORa){const H=Object.assign(new r.a,{onShow:()=>{u.prototype.show.call(this)}});t.UISurfaces.BK().then(M=>{const O=M.externalNotification();this.f3b=M.addNotification(O,H);return null},M=>{b.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",M);return null})}}dismiss(){this.ORa&&this.f3b&&(t.UISurfaces.BK().then(H=>{H.removeNotification(this.f3b);
return this.f3b=null},H=>{b.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",H);return null}),super.dismiss())}}Object(w.a)(v,"ReactManagedModalCallout",u,[]);var x=a(5);class m{static Irh(H,M,O){var L=void 0===L?null:L;return x.AFrameworkApplication.sa.Ra.wU?new v(H,M,O,3,x.AFrameworkApplication.sa,L):new u(H,M,O,3,x.AFrameworkApplication.sa,L)}}Object(w.a)(m,"ModalCalloutControlFactory",null,[]);var l=a(57),n=a(917),z=a(598),y=a(918),B=a(152),G=a(61),E=a(41),J=a(84),I=
a(863),R=a(733);a.d(C,"a",function(){return X});class X{static get y9b(){return X.ija||(X.ija=J.a.instance.oi("Common.Utils.IAriaNotifier"))}static eSe(H,M,O,L){X.oM&&X.oM.ORa&&X.oM.dismiss();X.oM=m.Irh(M,H,H);X.oM.content=O;R.b(L)||(X.oM.title=L,X.oM.hnc=!0);H=new Sys.UI.Bounds(0,0,G.a.IEb(),G.a.HEb());X.oM.kX=X.L3h(H,M,X.oM.n5);X.oM.show();X.y9b&&X.y9b.sendNotification(O.innerText,!0)}static Odd(H,M,O,L){L=void 0===L?null:L;t.UISurfaces.BK().then(S=>{let T=null;X.Prb&&(S.removeNotification(X.Prb),
X.Prb=null);const V=S.callout(Object.assign(new n.a,{target:H,title:M,content:O,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new y.a,{onDismiss:()=>{S.removeNotification(T)},directionalHint:null!=L?L:null})})),la=Object.assign(new r.a,{expirationOptions:Object.assign(new z.a,{displayTimeoutSeconds:7,onExpire:()=>{S.removeNotification(X.Prb)}})});T=X.Prb=S.addNotification(V,la);return null},S=>{b.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",
S);return null})}static I3d(H,M){M=void 0===M?null:M;X.oM&&X.oM.ORa&&X.oM.dismiss();const O=new B.StandardDialog;O.wYa=!1;O.Rd=0;O.UC(l.a.qOi,CommonUIStrings.l_DialogError,R.b(H)?X.kcf():H,M)}static J3d(H){X.oM&&X.oM.ORa&&X.oM.dismiss();b.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",H.errorCode));const M=R.b(H.description)?X.kcf():H.description,O=new B.StandardDialog;let L=null;H.Pla?(O.Rd=1,O.qe(1,H.buttonText),O.D4(1)):O.Rd=0;L=S=>{1===S?H.Pla():
H.Mma&&H.Mma()};O.wYa=!1;0===H.lRa?O.UC(H.errorCode,H.title?H.title:CommonUIStrings.l_DialogError,M,L):1===H.lRa?O.BV(H.title?H.title:CommonUIStrings.l_DialogWarning,M,L):O.Msa(H.title?H.title:CommonUIStrings.l_DialogInfo,M,L)}static L3h(H,M,O){let L=4;const S=H.x+H.width-M.x-M.width;M.x-H.x+M.width/2<=O/2?L=5:S+M.width/2<=O/2&&(L=6);return L}static j_j(H,M,O,L){L=void 0===L?!1:L;(M=I.a.DCb(M))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(M,
S=>{S&&(L||X.Odd(S,O,H,5))})}static k_j(H,M,O){O=void 0===O?!1:O;X.j_j(M.startedNode?M.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,H),M,M.startedNode?M.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,H),O)}static i_j(H,M,O,L){if(X.kxg)H=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,O,L,CommonUIStrings.l_InsertionDialogRefresh)),X.Odd(M,H,CommonUIStrings.l_ErrorLoadingAddInsTitle,
1);else{M=E.a.ur(M);var S=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),T=document.createElement("span");T.innerText=S[0];var V=document.createElement("span");V.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,O,L,CommonUIStrings.l_InsertionDialogRefresh);V.className="UIFontBold";O=document.createElement("span");O.innerText=S[1];L=document.createElement("div");Sys.UI.DomElement.addCssClass(L,"ModalCalloutControl");L.appendChild(T);L.appendChild(V);
L.appendChild(O);X.eSe(H,M,L,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static I0j(H,M){var O=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,L=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;X.kxg?X.Odd(M,O,L):(M=E.a.ur(M),X.eSe(H,M,X.Rah(L),O))}static Rah(H){const M=document.createElement("div");Sys.UI.DomElement.addCssClass(M,"ModalCalloutControl");M.innerText=H;return M}static kcf(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get kxg(){return x.AFrameworkApplication.sa.Ra.dm&&
x.AFrameworkApplication.sa.Ra.wU}}X.oM=null;X.Prb=null;X.ija=null;Object(w.a)(X,"AddInCommandsNotificationFactory",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.agave.js.map/8f3a20bf1df2e2f3d1fce359dc13dc69/EwaTS.agave.js.map