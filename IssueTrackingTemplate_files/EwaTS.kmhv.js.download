'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[36],{1342:function(w,C,a){a.r(C);var b={};a.r(b);a.d(b,"CreateNewCommandHandler",function(){return ob});var c={};a.r(c);a.d(c,"OpenFromMruCommandHandler",function(){return ib});var h={};a.r(h);a.d(h,"NamedSheetViewPublic",function(){return oc});var k={};a.r(k);a.d(k,"NamedSheetViewTeachingCallout",function(){return We});var d={};a.r(d);a.d(d,"TryOfficeThroughTellMeCommandHandler",function(){return jf});var f={};
a.r(f);a.d(f,"SheetOptionsToggleCommandHandler",function(){return Ba});var u={};a.r(u);var r=a(0),t=a(562),v=a(14),x=a(79),m=a(862),l=a(31),n=a(150);class z{static AFh(qa){return z.MJe("New",qa)}static BFh(qa){return z.MJe("Open",qa)}static xJe(qa,gb){return z.Nla("LoadingMenuSection",z.XQi,qa,z.qwb("lblLoading",gb))}static rwb(qa,gb,Bb,ic){return z.Nla("MessageMenuSection",z.QHf,gb,z.qwb("lblMessage",qa,void 0===Bb?null:Bb,void 0===ic?null:ic))}static P$g(qa){return z.xJe(qa,CommonUIStrings.l_VoicedLoadingText)}static Q$g(qa,
gb){return z.rwb(CommonUIStrings.l_NewCreationLocationMessage,qa.ak,gb.aV,gb.Wsa)}static O$g(qa,gb){return z.rwb(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,gb.Wsa,"\n\n"),qa.ak)}static zJe(qa){return z.rwb(CommonUIStrings.l_NewGenericErrorMessage,qa.ak)}static M$g(qa,gb,Bb){return z.Nla("menuNewBlank",z.$qi,Bb?qa.ak:null,z.kwb(qa.Gmf,qa.Hmf,qa.Imf,null,qa.L2,qa.dGb,gb,"blank"))}static Oah(){return z.qwb("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static KJe(){return z.qwb("lblTemplatesError",
CommonUIStrings.l_NewTemplateErrorMessage)}static Pah(qa,gb){return z.Nla("menuNewTemplates",qa,null,gb)}static K$g(qa,gb){return z.Nla("menuNewMoreTemplates",z.V8e,null,z.kwb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,qa,gb))}static N9g(qa,gb,Bb){let ic="";Bb&&gb&&(ic=z.Nla("BrowseMoreMenuSection",z.V8e,null,z.kwb("btnBrowseMore",gb,gb,null,null,null,qa||"1959943459",Bb)));return ic}static qwb(qa,gb,Bb,ic){Bb=void 0===Bb?null:
Bb;let Cc=ic=void 0===ic?null:ic;gb&&0<gb.length&&(Cc=z.NIf.kAc(gb).trimEnd(),Cc=0<=Cc.indexOf("{0}")?String.format(Cc,ic):String.format("{0} {1}",Cc,ic));Bb=Bb&&ic?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',l.a.Ch(Bb),l.a.Ch(ic),l.a.Ch(Cc)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',l.a.Ch(qa||""),z.NIf.kAc(l.a.Ch(gb||"")),Bb)}static kwb(qa,gb,Bb,ic,Cc,hd,
Pd,ue){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',l.a.Ch(qa||""),l.a.Ch(gb||""),l.a.Ch(Bb||""),ic||"32by32",l.a.Ch(Cc||""),l.a.Ch(hd||""),Pd,l.a.Ch(ue||""))}static MJe(qa,gb){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',qa,gb)}static Nla(qa,gb,Bb,ic){Bb=Bb?String.format('Title="{0}"',
l.a.Ch(Bb)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',l.a.Ch(qa||""),l.a.Ch(gb||""),Bb,ic)}}z.QHf="MenuMru";z.XQi="MenuLoading";z.$qi="MenuHeader";z.V8e="MenuFooter";z.NIf=n.a.pA("\n","&#10;");Object(r.a)(z,"NewAndOpenXmlUtilities",null,[]);var y=a(5),B=a(103),G=a(110),E=a(147);class J{constructor(){this.folderName=
this.folderUrl=this.hostName=this.hostUrl=null}}Object(r.a)(J,"HostInformation",null,[]);var I=a(112),R=a(41),X=a(385),H=a(181),M=a(665),O=a(586),L=a(116),S=a(27),T=a(73);class V{constructor(qa,gb,Bb,ic,Cc,hd){this.Vsb=this.Dq=this.l_b=null;this.i5b=this.h1c=!1;this.Cpe=0;this.pWc=!1;this.d6=qa;this.apb=gb;this.JIa=new t.a(()=>new m.a(Bb.value,Object(x.a)(this,this.WDb,"getMoreInfoEventReceived")));this.bNg=ic;this.Kva=Cc;this.qQg=hd;this.xsb=this.RHc;this.k2b=!!y.AFrameworkApplication.da&&y.AFrameworkApplication.da.pa("GateTemplateRenderingByGetMoreInfoResponse");
this.$Lg=!!y.AFrameworkApplication.da&&y.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.WordOnline.TemplatesForUserRetentionTreatment1",!1);this.sne=!!y.AFrameworkApplication.da&&y.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.WordOnline.TemplatesForUserRetentionTreatment2",!1)}get tP(){switch(this.WA.IQ){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}tj(){const qa=this.WA.Heb;qa.ae(S.a.newDocument,
L.a.frame,Object(x.a)(this,this.newDocument,"newDocument"));qa.ae(S.a.DAc,L.a.frame,Object(x.a)(this,this.DAc,"populateNewMenu"))}newDocument(qa,gb,Bb,ic,Cc){if(1===Bb)return 32;if(2===Bb&&Cc){if(y.AFrameworkApplication.da.pa("BackstagePremiumTemplateExperienceEnabled")&&Cc.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),y.AFrameworkApplication.Dd.processAction(S.a.ynj,2);if(Cc.MenuItemId&&Cc.SourceControlId)return"NewDocumentHome"===Cc.SourceControlId&&
G.a("NewDocumentFromHomeTab"),this.O6a(Cc.MenuItemId,Cc.SourceControlId)}return 8}O6a(qa,gb){var Bb=this.uwc.Ced;if(null===Bb)return 8;var ic=y.AFrameworkApplication.da.pa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const Cc=y.AFrameworkApplication.Xfa;"blank"===qa&&this.mHi()&&(v.ULS.sendTraceTag(508687196,202,50,"Updating blank document id with new template id for appId={0}",this.tP),qa="blankNew");if(Cc&&ic){v.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");
const hd={};hd[X.a.Upg]=qa;hd[X.a.tP]=this.tP;hd[X.a.lcid]=y.AFrameworkApplication.lcid.toString();hd[X.a.reason]=M.a.createNew;hd[X.a.uiCulture]=y.AFrameworkApplication.uiCulture;hd[X.a.dataCulture]=y.AFrameworkApplication.dataCulture;y.AFrameworkApplication.fU().execute(Pd=>{Pd.sendMessage(H.a.O6a,hd)})}else ic=(new Date).getTime(),gb=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",Bb,l.a.$g(this.oqa),l.a.$g(qa),l.a.$g(this.tP),
l.a.$g(y.AFrameworkApplication.lcid.toString()),l.a.$g(ic.toString()),l.a.$g(gb),l.a.$g(y.AFrameworkApplication.canary),y.AFrameworkApplication.Ak),(Bb=y.AFrameworkApplication.da.Sa("ScenarioId"))&&""!==Bb&&(gb+="&wdscenarioid="+l.a.$g(Bb)),gb+="&"+y.AFrameworkApplication.Ilc(),y.AFrameworkApplication.npa&&(gb+="&"+y.AFrameworkApplication.Zkc()),(Bb=this.Dq?this.Dq.aV:null)?gb+="&DestinationUrl="+l.a.$g(Bb):3===this.WA.IQ&&this.WA.supportsGetMoreInfoForPersonalStorage&&v.ULS.sendTraceTag(508928088,
202,10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty"),R.a.Sg(gb,"_blank",void 0,"CreateNewDocument");2!==this.WA.IQ&&3!==this.WA.IQ||v.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:O.a[this.WA.IQ],["Template"]:qa});y.AFrameworkApplication.da&&y.AFrameworkApplication.da.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&1===this.WA.IQ&&("blank"===qa||"blankNew"===qa?G.b("ConsumerTemplateNewBlank"):
(qa=[Object.assign(new T.a,{name:"TemplateId",string:qa})],G.b("ConsumerTemplateNew",null,0,!0,0,qa)));return 32}mHi(){let qa=!1;switch(this.WA.IQ){case 3:qa=y.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefaultsUpdate",!1);break;case 2:qa=y.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTODefaultThemeChange",!1);break;case 1:qa=y.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",!1)}return qa}oUi(qa){let gb=
Number.MAX_VALUE,Bb=Number.MIN_VALUE;const ic=window.performance;if(ic&&"undefined"!==typeof ic.getEntriesByName){for(let hd=0;hd<qa.length;hd++){var Cc=ic.getEntriesByName(qa[hd]);Cc&&0<Cc.length&&(Cc=Cc[0],gb=Math.min(parseInt(String(Cc.fetchStart)),gb),Bb=Math.max(parseInt(String(Cc.responseEnd)),Bb))}Bb>gb&&v.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:Bb-gb,["MinFetchStart"]:gb,["MaxResponseEnd"]:Bb})}}DAc(qa,gb,Bb,ic,Cc){if(1===Bb)return 32;
2!==Bb||this.pWc||(this.Cpe=(new Date).getTime(),v.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.RHc,["CachedNewMenuXmlExists"]:!!this.l_b,["ShouldCallGetMoreInfo"]:this.WA.supportsGetMoreInfoForPersonalStorage}));return this.nmj(Cc)}nmj(qa){qa&&(this.l_b?qa.PopulationXML=this.l_b:(this.WA.supportsGetMoreInfoForPersonalStorage&&!this.Dq&&this.$_i.w2("Opened New menu",!0),qa.PopulationXML=this.R0h(this.getTemplateListJson())));return 32}qwf(){return!this.WA.supportsGetMoreInfoForPersonalStorage||
!!this.Dq&&3===this.Dq.state&&!!this.Dq.Wsa&&!!this.Dq.aV}nCd(){return y.AFrameworkApplication.sa&&y.AFrameworkApplication.sa.Ra.k3&&!this.k2b?!0:this.qwf()}getTemplateListJson(){if(!this.RHc&&!this.k2b&&!this.nCd())return null;if(this.xsb&&!this.i5b){let gb=!1;var qa="9";const Bb=y.AFrameworkApplication.da.appSettings;"NumberOfTemplatesInBackstage"in Bb&&(qa=Bb.NumberOfTemplatesInBackstage);let ic=this.tP;"TemplateCollectionId"in Bb&&(ic=Bb.TemplateCollectionId);this.$Lg&&(ic="WordConsumerWAC",qa=
"10");this.sne&&(ic="WordConsumerWAC",qa="10",gb=!0);qa=String.format(this.WA.rZ+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",l.a.$g(y.AFrameworkApplication.lcid.toString()),l.a.$g(ic),qa);Boolean.parse(Bb.AppendOriginQueryParam||"false")&&(qa+="&org=backstage");Boolean.parse(Bb.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in Bb&&(qa+="&templateTier="+Bb.TemplateTier);this.sne&&(qa+="&col=officetemplateswordonlinestartexp2");qa=gb?qa+"&p=1":qa+"&p=0";qa+="&"+y.AFrameworkApplication.Ilc();
y.AFrameworkApplication.npa&&(qa+="&"+y.AFrameworkApplication.Zkc());this.WA.IMb.Ho(qa,1,null,null,!1,2,Cc=>{this.WA.nga("CreateNewActor.GetTemplateListJson",Cc.data);this.P8j(Cc.data.Tf)},Cc=>{this.WA.nga("CreateNewActor.GetTemplateListJson",Cc.data);this.O8j()},null,void 0,void 0,void 0,void 0,"5");this.xsb=!1}return this.Vsb}P8j(qa){this.Vsb=qa;this.xsb=!1;this.NQb();this.k2b?this.nCd()?this.ohd():this.Dq&&(v.ULS.sendTraceTag(508867410,202,10,"GetMoreInfo Received but info is missing"),this.nhd()):
this.ohd()}ohd(){if(y.AFrameworkApplication.sa&&y.AFrameworkApplication.sa.Ra.k3&&E.c()){const qa=y.AFrameworkApplication.da.pa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC"),gb=y.AFrameworkApplication.Xfa;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.Vsb,!0,qa&&gb));3===this.WA.IQ&&v.ULS.sendTraceTag(508867409,202,15,"DispatchSuccessTemplateListJson")}}O8j(){this.i5b=this.xsb=!0;this.NQb();this.nhd();B.Health.instance.recordQosError("TemplateServiceReturnedFailure",
["TemplateServiceFailed"],!1,!0,!0,!1,null)}nhd(){y.AFrameworkApplication.sa&&y.AFrameworkApplication.sa.Ra.k3&&E.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1)),3===this.WA.IQ&&v.ULS.sendTraceTag(508867408,202,15,"DispatchFailureTemplateListJson"))}Oii(qa){var gb=0;for(var Bb=0;Bb<qa.length;Bb++)if("ST"===qa[Bb].ImageType){gb=Bb;break}const ic=qa.length?qa[gb]:null;qa=ic?ic.Url||"":"";var Cc;let hd=Bb=gb=!1;if(ic&&(Cc=ic.AspectRatio))Cc=parseFloat(Cc),1>Cc?gb=!0:
1.5<Cc?Bb=!0:1===Cc&&(hd=!0);else switch(v.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:qa}),this.WA.IQ){case 3:gb=!0;break;case 2:Bb=!0;break;case 5:hd=!0}return{returnValue:qa,uti:gb?"95by123":Bb?"123by69":hd?"100by100":"123by95"}}R0h(qa){let gb;const Bb=this.uwc.fMa||"1056925771",ic=(()=>{let Cc=this.N$g(qa,this.uwc,Bb);({sHc:gb}=Cc);return Cc})().returnValue;if(gb){this.l_b=ic;const Cc=(new Date).getTime()-this.Cpe;v.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",
{["ElapsedMsSinceMenuOpened"]:Cc})}return ic}WDb(qa,gb){v.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Dq||3!==qa.state?2===qa.state&&(v.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.h1c=!0,this.NQb()):(this.Dq=qa,gb||this.NQb(),y.AFrameworkApplication.sa&&y.AFrameworkApplication.sa.Ra.k3&&E.c()&&E.d("setFileMenuHostInformation")&&(qa=Object.assign(new J,{hostUrl:this.Dq.aV,hostName:this.Dq.Wsa,folderUrl:y.AFrameworkApplication.breadcrumbFolderUrl,
folderName:y.AFrameworkApplication.breadcrumbFolderName}),v.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(qa)),this.k2b&&this.Vsb&&this.Vsb.length&&(this.nCd()?this.ohd():this.nhd(),v.ULS.sendTraceTag(508867407,202,15,"Dispatched on GetMoreInfoReceived"))))}N$g(qa,gb,Bb){let ic;ic=!1;const Cc=this.qwf();let hd="";this.WA.supportsGetMoreInfoForPersonalStorage&&(this.h1c?(hd=z.zJe(gb),this.h1c=!1,v.ULS.sendTraceTag(5849605,
202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.Dq?Cc?hd=z.Q$g(gb,this.Dq):this.Dq.Zyi?(ic=!0,this.xsb=!1,hd=z.O$g(gb,this.Dq),v.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(ic=!0,hd=z.zJe(gb),v.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.Dq.aV,["StorageServiceDisplayNameIsSet"]:!!this.Dq.Wsa})):
(hd=z.P$g(gb.ak),v.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));Cc&&(hd+=z.M$g(gb,Bb,!hd)+(()=>{let Pd=this.Nah(qa,Bb);({sHc:ic}=Pd);return Pd})().returnValue);return{returnValue:z.AFh(hd),sHc:ic}}Nah(qa,gb){let Bb;Bb=!1;if(!this.RHc)return Bb=!0,v.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",sHc:Bb};let ic="",Cc="",hd="MenuTemplate";if(this.i5b)ic=z.KJe(),this.i5b=!1,v.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");
else if(qa){try{const Pd=Sys.Serialization.JavaScriptSerializer.deserialize(qa,!0);ic=this.Mah(Pd,gb);v.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");y.AFrameworkApplication.OIf&&"OneDrive"===this.oqa&&(Cc=z.K$g(this.a0i,y.AFrameworkApplication.OIf))}catch(Pd){v.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:qa}),ic=z.KJe()}Bb=!0}else hd="MenuLoading",ic=z.Oah(),v.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");
return{returnValue:z.Pah(hd,ic)+Cc,sHc:Bb}}Mah(qa,gb){let Bb="";const ic=[];for(let hd=0;hd<qa.length;hd++){var Cc=qa[hd];let Pd="";if(Cc){const ue=Cc.Title,Ee=Cc.AssetId;Cc=Cc.Thumbnails;Ee&&ue&&Cc&&({uti:Cc,returnValue:Pd}=this.Oii(Cc),Bb+=z.kwb("jbtnNewTemplate"+hd,ue,null,Cc,null,Pd,gb,Ee))}ic[hd]=Pd}qa=new I.a(4,1,5E3,()=>{this.oUi(ic)},106);this.WA.qwc.Sh(qa);return Bb}NQb(){this.pWc=!0;this.WA.IIf.Lz(this.uwc.jCb);this.pWc=!1}get WA(){return this.d6.value}get uwc(){return this.apb.value}get $_i(){return this.JIa.value}get a0i(){return this.bNg.value}get oqa(){return this.Kva.value}get RHc(){return this.qQg.value}}
Object(r.a)(V,"CreateNewActor",null,[]);var la=a(1253);class Z extends la.a{constructor(){super()}bBe(){this.WW(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.WW(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.WW(2,CommonUIStrings.l_Open);this.WW(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.WW(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.WW(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return Z.La||(Z.La=new Z)}static Ghj(qa){return Z.instance.ia(qa)}}Z.La=null;Object(r.a)(Z,
"MruActorIntlHelper",la.a,[]);var da;(function(qa){qa[qa.success=0]="success";qa[qa.failure=1]="failure";qa[qa.spinner=2]="spinner";qa[qa.none=3]="none"})(da||(da={}));Object(r.b)("DisplayState",da);var ba=a(42);class na{constructor(qa,gb,Bb,ic,Cc,hd,Pd,ue){this.KQc=null;this.$2c=!0;this.k_b="";this.cSg=0;this.B1a=null;this.eXc=3;this.Oa=ue;this.d6=qa;this.Wz=gb;this.bJg=Bb;this.bGg=ic;this.aGg=Cc;this.JIa=new t.a(()=>new m.a(hd.value,null));this.KJg=new t.a(()=>new m.a(Pd.value,Object(x.a)(this,
this.KZi,"mruEventResultReceived")));this.Oa.pa("WacInTabOpenMRUIsEnabledForUiHost");this.Oa.pa("UiHostSupportsDocRebootFeatures")}KZi(qa,gb){this.B1a=qa;gb||this.a4f()}Pxj(){this.vz.Heb.Rg(S.a.CAc,L.a.frame,Object(x.a)(this,this.CAc,"populateMruMenu"),96)}CAc(qa,gb,Bb,ic,Cc){return 1!==Bb&&Cc?this.jmj(Cc):32}jmj(qa){this.hGh();this.gGh();qa.PopulationXML=z.BFh(this.k_b+this.KQc);return 32}hGh(){let qa=3,gb=!1;if(this.k_b&&this.cSg===this.B1a.C$j)v.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",
{["CacheRefresh"]:"Not Dirty"}),qa=this.eXc;else{v.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var Bb=this.vz.Yy();this.B1a=this.JZi.w2("File Open opened",!0);if(this.k_b&&2!==this.eXc&&3!==this.B1a.state)gb=!0;else{const ic=this.Agi(this.B1a);y.AFrameworkApplication.sa&&y.AFrameworkApplication.sa.Ra.k3&&E.c()&&ic&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(ic,!0));this.k_b=(()=>{let Cc=this.S0h(this.B1a);({S_i:qa}=
Cc);return Cc})().returnValue}Bb=this.vz.Yy()-Bb;v.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:Bb})}2!==qa&&(Bb={["DisplayState"]:da[qa]},1!==qa&&(Bb.IsStale=gb),v.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",Bb));this.eXc=qa}Agi(qa){let gb;try{gb=ba.c(qa.LJd)}catch(Bb){gb=null,v.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",Bb)}return gb}gGh(){this.$2c?
(v.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.KQc=(()=>{let qa=this.JVi();({mok:this.$2c}=qa);return qa})().returnValue):v.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");v.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.$2c,["NotDisplayingLink"]:!this.KQc})}S0h(qa){let gb;1===qa.state||0===qa.state?(v.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),
qa=2,gb=z.xJe(this.moa(2),this.moa(5))):3===qa.state&&qa.LJd?(gb=this.L$g(qa.LJd),qa=0):(v.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),gb=z.rwb(this.moa(1),this.moa(2)),qa=1);return{returnValue:gb,S_i:qa}}L$g(qa){let gb;const Bb=this.YLb.fMa||"2155708348";if(qa.length){gb=z.qwb("lblRecentDocuments",this.moa(3));let ic=0;for(let Cc=0;Cc<qa.length;Cc++){const hd=qa[Cc];"FileName"in hd&&"DocumentUrl"in hd&&"Path"in hd&&(gb+=z.kwb("MruButton"+Cc,hd.FileName.toString(),
hd.Path.toString(),null,this.YLb.L2,this.YLb.dGb,Bb,hd.DocumentUrl.toString()),hd.IsPinned&&ic++)}gb=z.Nla("RecentDocumentsMenuSection",z.QHf,this.moa(2),gb);v.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:qa.length,["NumPinnedDocuments"]:ic})}else gb=z.rwb(this.moa(0),this.moa(2)),v.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return gb}JVi(){let qa;qa=!0;let gb=this.f9g;var Bb=this.e9g;if(gb&&Bb||!this.vz.supportsGetMoreInfoForPersonalStorage)qa=
!1;else{const ic=this.flc.w2("File Open",!1);3===ic.state&&(gb=ic.aV,Bb=ic.Wsa,qa=!1)}Bb=Bb?String.format(this.moa(4),Bb):null;return{returnValue:z.N9g(this.YLb.fMa,Bb,gb),mok:qa}}a4f(){this.vz.IIf.Lz(this.YLb.jCb)}get vz(){return this.d6.value}get moa(){return this.Wz.value}get YLb(){return this.bJg.value}get f9g(){return this.bGg.value}get e9g(){return this.aGg.value}get flc(){return this.JIa.value}get JZi(){return this.KJg.value}}Object(r.a)(na,"MruRenderer",null,[]);var Y=a(217),Ga=a(808);class ma{constructor(qa,
gb,Bb,ic,Cc,hd,Pd){this.Dq=null;this.Aue=!1;this.dva=this.Nfe=0;this.iNg=qa;this.Q1a=gb;this.c3b=Bb;this.apb=ic;this.Kva=Cc;this.d6=hd;this.JIa=new t.a(()=>new m.a(Pd.value,Object(x.a)(this,this.WDb,"getMoreInfoEventReceived")))}O6a(){!this.Dq&&this.qKd.supportsGetMoreInfoForPersonalStorage?this.flc.w2("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}WDb(qa){if(!this.Dq&&3===qa.state)this.Dq=qa;else if(2===qa.state){this.Aue?v.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):
(this.flc.w2("NewDocumentFromStream",!0),this.Aue=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.Nfe=(new Date).getTime();var qa=this.kUh.Ced;if(null===qa)this.Q1a(null);else{var gb=this.c3b.menuItemId,Bb=this.c3b.BG,ic=this.c3b.r6j,Cc=this.c3b.pUh;this.dva="streamBase64"===ic?Cc.length/1024:0;v.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.tP,this.dva);var hd=(new Date).getTime();qa=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",
qa,l.a.$g(this.oqa),l.a.$g(gb),l.a.$g(this.tP),l.a.$g(y.AFrameworkApplication.lcid.toString()),l.a.$g(hd.toString()),l.a.$g(Bb),l.a.$g(y.AFrameworkApplication.canary),y.AFrameworkApplication.Ak,l.a.$g(ic));qa+="&"+y.AFrameworkApplication.Ilc();y.AFrameworkApplication.npa&&(qa+="&"+y.AFrameworkApplication.Zkc());(gb=this.Dq?this.Dq.aV:null)&&(qa+="&DestinationUrl="+l.a.$g(gb));this.qKd.IMb.Ho(qa,2,Cc,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(x.a)(this,this.V_i,"newDocumentFromStreamSuccessHandler"),
Object(x.a)(this,this.U_i,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}V_i(qa){if(qa&&qa.data&&qa.data.Tf){let Bb=ba.d(qa.data.Tf);({Mu:gb}=Bb);if(Bb.returnValue)if(qa=gb,qa.StatusCode!==Y.a.PE&&qa.StatusCode!==Y.a.Wyb)v.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.tP,this.dva,qa.StatusCode),this.Q1a(null);else if(qa.NewDocumentUrl&&""!==qa.NewDocumentUrl){var gb=(new Date).getTime()-this.Nfe;
v.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.tP,this.dva,gb);this.iNg(qa.NewDocumentUrl)}else v.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.tP,this.dva),this.Q1a(null);else v.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.tP,this.dva,{["ResponseData"]:Ga.a.Llb(qa.data.Tf)}),
this.Q1a(null)}else v.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.tP,this.dva),this.Q1a(null)}U_i(qa){qa&&qa.data&&v.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.tP,this.dva,qa.data.status);this.Q1a(null)}get tP(){switch(this.qKd.IQ){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get kUh(){return this.apb.value}get oqa(){return this.Kva.value}get qKd(){return this.d6.value}get flc(){return this.JIa.value}}
Object(r.a)(ma,"NewDocumentFromStreamOperation",null,[]);class fa{constructor(qa,gb,Bb,ic){this.apb=qa;this.Kva=gb;this.d6=Bb;this.JJg=ic}create(qa,gb,Bb){return new ma(qa,gb,Bb,this.apb,this.Kva,this.d6,this.JJg)}}Object(r.a)(fa,"NewDocumentFromStreamOperationFactory",null,[525]);var Xa=a(84),Ua=a(528),ka=a(62);class nb{get name(){return"Common.App.NewAndOpen.UX"}Xj(qa){qa.register(fa,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").Ee().Le(()=>
new fa(new t.a(()=>y.AFrameworkApplication.sa.Ra.$pd()),new t.a(()=>y.AFrameworkApplication.oqa),new t.a(()=>qa.oi("Common.INewAndOpenCommonHelpers")),new t.a(()=>qa.oi("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){y.AFrameworkApplication.da.qx(()=>{this.yGb()})}yGb(){const qa=Ua.a.ar(Xa.a.instance.Qd("Common.INewAndOpenCommonHelpers")),gb=Ua.a.ar(Xa.a.instance.Qd("Common.IEventEmitter<Common.IGetMoreInfoResult>"));y.AFrameworkApplication.oqa&&ka.Task.WAA.call(null,qa,gb).continueWith(()=>
{const Bb=new V(new t.a(()=>qa.result),new t.a(()=>y.AFrameworkApplication.sa.Ra.$pd()),new t.a(()=>gb.result),new t.a(()=>y.AFrameworkApplication.sa.Ra.aqd().fMa||"1959943459"),new t.a(()=>y.AFrameworkApplication.oqa),new t.a(()=>y.AFrameworkApplication.oHi));Bb.tj();Bb.NQb()});if(y.AFrameworkApplication.O2f){const Bb=Ua.a.ar(Xa.a.instance.Qd("Common.IEventEmitter<Common.IMruResult>"));ka.Task.WAA.call(null,qa,gb,Bb).continueWith(()=>{const ic=new na(new t.a(()=>qa.result),new t.a(()=>Z.Ghj),new t.a(()=>
y.AFrameworkApplication.sa.Ra.aqd()),new t.a(()=>y.AFrameworkApplication.Fhj),new t.a(()=>y.AFrameworkApplication.Ehj),new t.a(()=>gb.result),new t.a(()=>Bb.result),y.AFrameworkApplication.da);ic.Pxj();ic.a4f()})}}dispose(){}}Object(r.a)(nb,"UXPackageManager",null,[2,3,5]);var Ea=a(261),sb=a(1),Oa=a(10),La=a(734),ia=a(53),Sa=a(38),Za=a(731),Ab=a(199),pb=a(15),Tb=a(137);let ob=class{constructor(qa){this.nl=qa}Pe(){return!1}executeCommand(qa,gb,Bb){return 2!==this.nl.eg(S.a.newDocument,2,Bb)?ka.Task.Wa(!0):
Ab.a(gb.command)}Be(qa,gb){return 1056925771===gb.command}Ue(qa,gb,Bb){qa=!0;switch(gb){case "PopulateNewMenu":this.nl&&(sb.EwaSettings.isChangeGateEnabled("OfficeVSO:6883546_ConsumerTemplatesFileNewTrigger")&&y.AFrameworkApplication.KN("XLS-ConsumerTemplates-Treatment;XLS-ConsumerTemplates-Control"),sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConsumerTemplates",!1)&&y.AFrameworkApplication.da.pa("IsO365ConsumerHost")&&(y.AFrameworkApplication.da.appSettings.TemplateCollectionId=
"ExcelConsumerWAC",y.AFrameworkApplication.da.appSettings.NumberOfTemplatesInBackstage="23"),this.nl.eg(S.a.DAc,2,Bb));break;default:qa=!1}return qa}};ob=Object(Za.a)([Object(Tb.d)(pb.D),Object(Za.b)(0,Object(pb.b)()),Object(Za.b)(1,Object(pb.z)()),Object(Za.b)(2,Object(pb.Sb)())],ob);Object(r.a)(ob,"CreateNewCommandHandler",null,[203]);var va=a(91);class Pa extends La.a{constructor(qa){super(qa)}Uf(){const qa=sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?
Object(va.d)(Tb.a.resolve(pb.z,{Ja:this.Ta})):ia.GetServiceTaskFactory.create(this.$.ga,155,this.ka,this.Ta),gb=sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateNewAndOpenUX",!1)?Object(va.d)(Tb.a.resolve(pb.Sb,{Ja:this.Ta})):ia.GetServiceTaskFactory.create(this.$.ga,165,this.ka,this.Ta);Sa.TaskExtensions.za(Sa.TaskExtensions.Wf([qa,gb],this.ka),()=>{this.Lf([new ob(y.AFrameworkApplication.Dd)])},this.ka,3)}static la(qa){La.a.qg(87,new Pa(qa))}}Object(r.a)(Pa,"CreateNewCommandHandlerFactory",
La.a,[]);var jb=a(521),Ob=a(94),kb=a(200),ra=a(11),rb=a(22),Kb=a(247),Sb=a(468);class cb{}cb.create="Create";cb.activate="Activate";cb.close="Close";cb.remove="Delete";cb.duplicate="Duplicate";Object(r.a)(cb,"Actions",null,[]);var cc=a(34),Ub=a(46);class wb extends ka.Task{constructor(qa){super();this.Ece=null;this.Gce=0;this.ZZb=null;this._state=0;this.moveNext=()=>{try{for(this._state=1;1===this._state;)this.R1a=this.R1a()}catch(gb){this.dispose(),this.tFa(gb),this._state=3}};this.Dw=qa;this.R1a=
this.rOc;this.moveNext()}rOc(){this.Ece=cc.a.qf(3,2,0,1667,0,-1244327602,"MsFormDeleteConfirmation");this.ZZb=Ub.a(this.Dw.$).Uk(this.Ece).G();this.ZZb.isCompleted||(this._state=2,this.ZZb.ifb(this.moveNext));return this.gAg}gAg(){this.Gce=this.ZZb.w2();0===this.Gce&&(this.Dw.$.workbookContext.Options=ra.HelperMethods.ER(!1,this.Dw.$.workbookContext.Options,2048),this.Dw.deleteMsFormMetaDataSheet());this._state=3;this.IXa(!0)}dispose(){}}Object(r.a)(wb,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",
ka.Task,[5]);class vc{}vc.action="Action";vc.NWh="FlexPane";vc.Zic="formId";vc.id="id";vc.title="Title";vc.jZb="XlWorkbookId";vc.HYh="Fragment";vc.host="Host";vc.Oak="TopView";vc.accountType="auth_pvr";Object(r.a)(vc,"Parameters",null,[]);var Lb=a(59);const Ja=(qa,gb,Bb,ic,Cc,hd,Pd)=>{Pd=qa.Pa(9,void 0===Pd?null:Pd);Pd.sheetName=gb;Pd.confirmationChoice=!0;return Lb.g(qa,"DeleteSheet",Pd,Bb,ic,Cc,hd,0)};class Hb{constructor(qa){this.rq="Excel";this.$=qa;this.jY=Sb.a.current}get hasMsForm(){return Ob.c(this.$.Fg)}get ewc(){return this.$.workbookContext.MsFormId}get gZb(){return this.$.workbookContext.MsFormDocUrl}get accountType(){return rb.a.contains(this.$.LB.DocumentHostInfo.FileSource,
"onedrive",!0)?"MSA":"OrgId"}Pe(qa,gb){switch(gb){case -105284469:return!Ob.k(this.$.Fg)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1}executeCommand(qa,gb){qa=Sa.TaskExtensions.Ul();gb=gb.command;switch(gb){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:qa=this.deleteMsForm();break;default:qa=Ab.a(gb)}return qa}Be(qa,
gb){if(!this.$.ea.pj.get(61))return!1;qa=!1;switch(gb.command){case -105284469:qa=Ob.k(this.$.Fg)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:qa=this.hasMsForm}return qa}Ue(){return!1}insertMsForm(){const qa=l.a.ds(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),gb={},Bb={};gb[vc.action]=cb.create;gb[vc.accountType]=this.accountType;Bb[vc.action]=cb.create;Bb[vc.jZb]=encodeURIComponent(this.gZb);Bb[vc.host]=this.rq;Bb[vc.title]=encodeURIComponent(qa);
this.KLb(gb,Bb);this.$.workbookContext.Options=ra.HelperMethods.ER(!1,this.$.workbookContext.Options,2048)}editMsForm(){const qa={},gb={};qa[vc.accountType]=this.accountType;gb[vc.Zic]=this.ewc;gb[vc.jZb]=encodeURIComponent(this.gZb);gb[vc.host]=this.rq;this.KLb(qa,gb)}previewMsForm(){const qa={},gb={};qa[vc.accountType]=this.accountType;gb[vc.Zic]=this.ewc;gb[vc.jZb]=encodeURIComponent(this.gZb);gb[vc.host]=this.rq;gb[vc.Oak]="Preview";this.KLb(qa,gb)}sendMsForm(){const qa={},gb={};qa[vc.accountType]=
this.accountType;gb[vc.Zic]=this.ewc;gb[vc.NWh]="SendForm";gb[vc.jZb]=encodeURIComponent(this.gZb);gb[vc.host]=this.rq;this.KLb(qa,gb)}deleteMsForm(){return new wb(this)}deleteMsFormMetaDataSheet(){this.$.userOperationManager.OH(new kb.a(158,0,(qa,gb,Bb)=>Ja(this.$.qa.oz,this.jY.qCb,Kb.b(qa,()=>{this.eyh()}),gb,Bb,null)))}eyh(){const qa={},gb={};qa[vc.action]=cb.remove;qa[vc.accountType]=this.accountType;gb[vc.action]=cb.remove;gb[vc.host]=this.rq;gb[vc.Zic]=encodeURIComponent(this.ewc);gb[vc.jZb]=
encodeURIComponent(this.gZb);this.KLb(qa,gb)}KLb(qa,gb){const Bb=this.$.xa.MsFormBaseUrl+"/Pages/DesignPage.aspx";let ic="";var Cc="";if(gb){for(let ue in gb){var hd=ue,Pd=gb[ue];Cc+=Cc.length?"&":"";Cc+=hd+"="+Pd}qa||(qa={});qa[vc.HYh]=encodeURIComponent(Cc)}if(qa)for(let ue in qa)gb=ue,Cc=qa[ue],ic+=ic.length?"&":"?",ic+=gb+"="+Cc;window.open(Bb+ic,"_blank")}}Object(r.a)(Hb,"MsFormCommandHandler",null,[203]);class gc extends La.a{constructor(qa){super(qa)}Uf(){const qa=ia.GetServiceTaskFactory.create(this.$.ga,
203,this.ka,this.Ta);Sa.TaskExtensions.za(Sa.TaskExtensions.Wf([qa],this.ka),()=>{this.Lf([new Hb(this.$)])},this.ka,3)}static la(qa){qa.ea.pj.get(61)&&La.a.qg(215,new gc(qa))}}Object(r.a)(gc,"MsFormCommandHandlerFactory",La.a,[]);var ec=a(233);class Ta extends ec.a{constructor(qa){super();this.$=qa;this.je()}create(){Sa.TaskExtensions.za(Object(va.d)(Tb.a.resolve(pb.Rb,{Ja:this.Ta})),()=>{this.Ld(new nb)},this.ka,3)}}Object(r.a)(Ta,"NewAndOpenUXFactory",ec.a,[]);let ib=class{constructor(qa,gb){this.nl=
gb;this.$=qa}executeCommand(qa,gb,Bb){qa=2;switch(gb.command){case S.a.openUrlInNewTab:qa=this.nl.eg(S.a.openUrlInNewTab,2,Bb);break;case S.a.OUa:qa=this.nl.eg(S.a.OUa,2,Bb)}return 2!==qa?ka.Task.Wa(!0):Ab.a(gb.command)}Be(qa,gb){return gb.command===S.a.openUrlInNewTab||gb.command===S.a.OUa}Ue(qa,gb,Bb){return"PopulateMruMenu"===gb?(this.nl.eg(S.a.CAc,2,Bb),!0):!1}Pe(){return!1}};ib=Object(Za.a)([Object(Tb.d)(pb.Zb),Object(Za.b)(0,Object(pb.W)()),Object(Za.b)(1,Object(pb.b)()),Object(Za.b)(2,Object(pb.z)()),
Object(Za.b)(3,Object(pb.Sb)())],ib);Object(r.a)(ib,"OpenFromMruCommandHandler",null,[203]);class bc extends La.a{constructor(qa){super(qa)}Uf(){const qa=sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(va.d)(Tb.a.resolve(pb.z,{Ja:this.Ta})):ia.GetServiceTaskFactory.create(this.$.ga,155,this.ka,this.Ta),gb=sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateNewAndOpenUX",!1)?Object(va.d)(Tb.a.resolve(pb.Sb,{Ja:this.Ta})):ia.GetServiceTaskFactory.create(this.$.ga,
165,this.ka,this.Ta);Sa.TaskExtensions.za(Sa.TaskExtensions.Wf([qa,gb],this.ka),()=>{this.Lf([new ib(this.$,y.AFrameworkApplication.Dd)])},this.ka,3)}static la(qa){La.a.qg(88,new bc(qa))}}Object(r.a)(bc,"OpenFromMruCommandHandlerFactory",La.a,[]);var jc=a(175),sc=a(32),Fa=a(191),Ha=a(251),Na=a(74),W=a(60),U=a(218),za=a(605),ua=a(93),$a=a(19),Va=a(262),hb=a(222),qb=a(12);class Nb extends hb.a{constructor(qa,gb,Bb,ic){super(qa,Bb,2,void 0===ic?null:ic);this.KUc=null;this.onResize=()=>{const Cc=this.Y9h();
this.bRa.setAttribute("width",Cc.x.toString());this.bRa.setAttribute("height",Cc.y.toString());this.thk(Cc);this.lNd()};this.iWe=gb;this.$.IB(this.onResize);this.wnc()}get bRa(){return this.KUc}initialize(){const qa=this.$.Pd+"iframeDialog_frame",gb=this.$.Pd+"iframeDialog";this.fe.style.margin=ra.HelperMethods.Qe(0);this.fe.style.marginBottom=ra.HelperMethods.Qe(-2);const Bb=document.createElement("iframe");Bb.id=qa;Bb.frameBorder="0";Bb.scrolling="auto";Bb.src=this.tdf(gb);this.fe.appendChild(Bb);
this.KUc=document.getElementById(qa);this.domElement.id=gb;this.onResize(null,Sys.EventArgs.Empty);super.initialize()}dispose(){this.$&&this.$.vE(this.onResize);super.dispose()}setFocus(){qb.DOMElementExtensions.setFocus(this.bRa)}onHide(){this.bRa.contentWindow.close();qb.DOMElementExtensions.Oh(this.bRa);this.KUc=null;super.onHide()}thk(qa){const gb=this.domElement.style;gb.width=ra.HelperMethods.Qe(qa.x);gb.marginLeft=ra.HelperMethods.Qe(-qa.x/2)}Y9h(){const qa=qb.DOMElementExtensions.getBounds(document.body);
return new Sys.UI.Point(Math.min(Math.floor(.9*qa.width),this.iWe.x),Math.min(Math.floor(.9*qa.height),this.iWe.y))}}Object(r.a)(Nb,"IFrameDialog",hb.a,[]);var yb=a(6),ja=a(16);class Ka extends Nb{constructor(qa){super(qa,new Sys.UI.Point(960,680),ja.a.instance.ia(1264));this.name=yb.a.s_e}get we(){return"EmbeddingDialog"}tdf(qa){const gb=new Sys.StringBuilder(this.$.xa.EmbedConfiguratorUrl);U.a.Hp(gb,yb.a.EIh,qa);return gb.toString()}onShow(){v.ULS.sendTraceTag(537151690,0,50,"EmbeddingDialog.OnShow: the dialog is being shown");
super.onShow()}}Object(r.a)(Ka,"EmbeddingDialog",Nb,[]);var Pb=a(906),rc=a(96),$c=a(64),Dd=a(778);class Jd{}Jd.Vhg="FrameDialog_ShareFromEdit";Jd.view="FrameDialog_View";Jd.mOe="FrameDialog_CloseAndRefresh";Jd.FVj="FrameDialog_ShareFromView";Jd.edit="FrameDialog_Edit";Jd.$vj="FrameDialog_RefreshGrid";Jd.mih="FrameDialog_CloseMe";Jd.vOe="FrameDialog_CloseMeError";Jd.ready="FrameDialog_Ready";Jd.zlj="FrameDialog_PleaseClose";Jd.vN="GotoRange";Object(r.a)(Jd,"PostMessageConstants",null,[]);var Kd=a(324),
ce=a(125),ge=a(248);class uc{constructor(){this.vN=null;this.SQd=1461300262}}Object(r.a)(uc,"SessionUpdateContext",null,[]);class dd extends Nb{constructor(qa,gb,Bb){super(qa,new Sys.UI.Point(dd.Bxh,dd.$wh),ja.a.instance.ia(gb?1269:1268));this.T6a=null;this.cWc=!1;this.gzc=ic=>{const Cc=this.$,hd=new uc;hd.vN=ic.Values[Jd.vN];let Pd=!1;switch(ic.MessageId){case Jd.Vhg:this.Ux();Pd=!0;hd.SQd=1334518759;break;case Jd.view:this.nta=ja.a.instance.ia(1269);this.Ewg(!0);break;case Jd.mOe:this.Ux(),Pd=!0}ic=
new kb.a(140,0,(ue,Ee,Se)=>Kd.p(Cc.qa.ua,Kb.b(ue,this.qej),Ee,Se,hd));ic.flags=Pd?16:80;Cc.userOperationManager.enqueueOperation(ic,this.Bf)};this.V6i=()=>{const ic=this.$;ic.xa.SurveyRedirectUrl?(this.Ux(),ic.Me(1305810481,0,8,null)):(this.nta=ja.a.instance.ia(1268),this.Ewg(!1))};this.Eej=()=>{const ic=this.$;this.Ux();ic.Me(1334518759,0,8,null)};this.oxc=ic=>{const Cc=this.$;this.Ux();ic.MessageId===Jd.vOe&&Cc.ea.lnd()};this.Vcj=()=>{this.cWc=!0;this.raiseEvent(dd.OFd)};this.qej=(ic,Cc)=>{if(!ge.a(ic)){ic=
this.$;if(Cc.vN){const hd=ic.ea.va;if(hd.contains(Cc.vN.SheetName))this.byc(Cc);else{let Pd=null;Pd=()=>{hd.Lra(Pd);this.byc(Cc)};hd.cla(Pd)}}1461300262!==Cc.SQd&&ic.Me(Cc.SQd,0,8,null)}};this.qca=gb;this.Bf=Bb}f_g(qa){this.addHandler(dd.OFd,qa)}TBj(qa){this.removeHandler(dd.OFd,qa)}get we(){return"FormDialog"}get Wuf(){return this.cWc}get fcb(){return this.qca}dispose(){rc.a.Ma(this.T6a);this.T6a=null;super.dispose()}initialize(){super.initialize();const qa=$c.a.rN(this.$.xa.FormLightBoxUrl),gb=
this.T6a=new Pb.a(this.bRa.contentWindow,qa);gb.isEnabled()&&gb.LS(qa)&&(this.Fra(Jd.Vhg,this.gzc),this.Fra(Jd.view,this.gzc),this.Fra(Jd.mOe,this.gzc),this.Fra(Jd.FVj,this.Eej),this.Fra(Jd.edit,this.V6i),this.Fra(Jd.$vj,this.gzc),this.Fra(Jd.ready,this.Vcj),this.Fra(Jd.mih,this.oxc),this.Fra(Jd.vOe,this.oxc))}close(qa){qa===this.lT&&this.Wuf&&this.T6a.send(new Dd.a(Jd.zlj))||super.close(qa)}tdf(){return this.WSe(this.fcb)}WSe(qa){const gb=this.$.xa,Bb=new Sys.StringBuilder(gb.FormLightBoxUrl);U.a.Hp(Bb,
yb.a.uYh,this.$.ea.sessionId);U.a.Hp(Bb,yb.a.sYh,qa?yb.a.tYh:yb.a.rYh);ce.a.jvb(Bb,gb);return Bb.toString()}Ewg(qa){this.cWc=!1;this.bRa.src=this.WSe(qa);this.qca=qa}Fra(qa,gb){this.T6a.Rn(qa);this.T6a.fm(qa,gb)}byc(qa){const gb=this.$.ea.va.getItemByName(qa.vN.SheetName);gb&&0===gb.TC&&$a.h(this.$).Bj(qa.vN,null,null,null,20,"FormDialog.OnItemInserted")}}dd.Bxh=900;dd.$wh=1200;dd.OFd="lightBoxReady";Object(r.a)(dd,"FormDialog",Nb,[206]);var Rd;(function(qa){qa[qa.comment=10]="comment";qa[qa.range=
12]="range";qa[qa.table=13]="table";qa[qa.chart=14]="chart";qa[qa.sheet=15]="sheet"})(Rd||(Rd={}));Object(r.b)("NavigationType",Rd);var Yd=a(1036),Md=a(134),ad=a(18),Mb=a(569),Aa=a(1003),Bc=a(297),Vc=a(794),hc=a(56);class xc extends Vc.a{constructor(qa,gb,Bb,ic,Cc,hd,Pd){hd=void 0===hd?0:hd;super(qa,ja.a.instance.ia(gb),!1);this.Zd=null;this.message=Bb;this.K2i=ic;this.Vbe=Cc;this.operationFlags=hd;this.Zd=Pd}get we(){return"WebMethodConfirmationDialog"}get FE(){return 1005}get UMa(){return this.operationFlags}initialize(){let qa=
"<div class='"+Md.a.Qu+"'>\r\n\t<div class='"+Md.a.F1e+"'>\r\n\t\t<div class='"+ad.a.fOe+"'>\r\n\t\t\t<img src='{0}' class='"+ad.a.n4e+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+Md.a.H1e+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";qa=String.format(qa,hc.a.Ci(13),ja.a.instance.ia(25),ja.a.instance.ia(this.message));this.Zd.Tj(this.fe,qa);this.addButton(0,this.K2i);this.addButton(1);super.initialize()}bK(){return this.Vbe}}Object(r.a)(xc,"WebMethodConfirmationDialog",Vc.a,[]);class ab extends Yd.a{constructor(qa,
gb){super(qa,ja.a.instance.ia(1271));this.Zd=this.JZa=this.tXa=this.textBox=null;this.xVf=()=>{const Bb=this.$;this.Ux();const ic=new xc(Bb,1274,1275,1276,(Cc,hd,Pd)=>{var ue=Bb.qa.ua.ie(),Ee=Bb.qa.ua;ue=Ee.Pa(1,ue);return Lb.g(Ee,"UnshareForm",ue,Cc,hd,Pd,null,0)},16,this.Zd);ic.initialize();ic.Ji()};this.Zd=gb}get we(){return"ShareFormDialog"}dispose(){this.JZa&&this.JZa.raa(this.xVf);rc.a.Fe([this.textBox,this.tXa,this.JZa]);this.JZa=this.tXa=this.textBox=null;super.dispose()}initialize(){let qa=
"<div class='"+Md.a.Qu+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+Md.a.Sgc+"'>\r\n\t<input type='text' id='{1}' class='"+Md.a.fN+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";qa=String.format(qa,ja.a.instance.ia(1272),"sfd_input","sfd_unshare",ad.a.VB,ja.a.instance.ia(1273));this.Zd.Tj(this.fe,qa);this.textBox=new Bc.a(this.getElementById("sfd_input"));this.tXa=new Aa.a(this.textBox.domElement);this.JZa=Mb.a.create(this.getElementById("sfd_unshare"));
this.JZa.O0(this.xVf);this.textBox.text=ja.a.instance.ia(736);this.textBox.enabled=!1;this.textBox.readOnly=!sc.a.Xi;this.addButton(1,10);super.initialize()}m5a(){return(qa,gb,Bb)=>{var ic=this.$.qa.ua.ie(),Cc=this.$.qa.ua;qa=this.M9a(qa);gb=this.APa(gb);ic=Cc.Pa(1,ic);return Lb.g(Cc,"ShareForm",ic,qa,gb,Bb,null,0)}}I3(qa,gb,Bb){this.textBox.text=qa.Result;this.textBox.enabled=!0;qb.DOMElementExtensions.setVisible(this.JZa.domElement,!0);super.I3(qa,gb,Bb)}setFocus(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();
return}catch(qa){}super.setFocus()}}Object(r.a)(ab,"ShareFormDialog",Yd.a,[]);var Wb=a(259),Yc=a(7),Tc=a(87),ed=a(266),be=a(76),Fc=a(640),vd=a(157),lb=a(435),Eb=a(268),Hc=a(17),Bd=a(264),he=a(30);class je extends Fa.a{constructor(qa,gb,Bb){super();this.VKe=this.WKe=!1;this.M8a=0;this.hna=!1;this.g4i=()=>{this.WKe=!0;this.ckg()};this.$=qa;this.Ya=gb;this.qN=Bb;be.a(this.$).oUd(new vd.a(Yc.a.xug,Yc.a.idle,je.afh),new Wb.a(Yc.a.tOe,Yc.a.qZ,null,Yc.a.fS,Yc.a.idle))}get fOc(){return Ob.b(this.$.Fg)}get kZd(){return this.$.isEditMode&&
(this.$.ea.HDh||this.$.nU)}Pe(qa,gb){switch(gb){case 353606613:case -1099009678:case 192430811:return!sb.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")||this.Gig();case 783415632:return!sb.EwaSettings.isChangeGateEnabled("OfficeVSO:8096933_ShareExcelSheet")||this.Gig();case 869186573:return this.Hig();case -1570751769:case 1986648902:return 131072!==(this.$.a2&131072);case 330035228:return!(this.h9a(!0)&&this.fOc);case -509039657:return!(this.h9a()&&this.fOc);case 1334518759:return!(this.h9a()&&
this.fOc&&this.iLe())}return!1}Gig(){return this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||this.Hig()}Hig(){const qa=this.$.workbookContext.FullDocumentInfo,gb=Eb.a()&&this.$.ea.pj.get(5);return!qa.FileSharingUrl&&!gb}executeCommand(qa,gb,Bb){qa=this.$.workbookContext.FullDocumentInfo;var ic=S.a.workflow,Cc=Sa.TaskExtensions.Ul();const hd=gb.command;if(hd===ic||-266099===hd)return this.Jpi(gb,ic,qa);switch(hd){case 1986648902:this.jhg();break;case -1570751769:this.$mi(gb);break;case 869186573:gb=
S.a.EVj;Cc=y.AFrameworkApplication.da.pa("ShareMenuIsEnabled");ic=null;(sb.EwaSettings.Ea(478)||Cc)&&Bb&&"CopyLink"===Bb.SourceControlId?(ic={},ic[X.a.Njb]="copy",gb=S.a.V1d):Cc&&Bb&&"ManageAccess"===Bb.SourceControlId?(ic={},ic[X.a.Njb]="manageAccess",gb=S.a.GVj):Bb&&"LinkToComment"===Bb.SourceControlId?(ic={},ic[X.a.Njb]="copy",ic[X.a.W1d]=Bb.navId,gb=S.a.V1d):he.a.ewf()&&Bb&&"SaveAsCopyLink"===Bb.SourceControlId&&(ic={},ic[X.a.Njb]="copy",gb=S.a.V1d);Cc=this.slg(qa,ic);G.c(gb);break;case -1099009678:Cc=
this.fHc(12,qa);break;case 192430811:Cc=this.fHc(13,qa);break;case 353606613:Cc=this.fHc(14,qa);break;case 783415632:Bb&&"LinkToThisSheet"===Bb.SourceControlId&&v.ULS.sendTraceTag(509691100,0,50,"SocialSharingCommandHandler.ExecuteCommand: Share Sheet invoked from Collab Corner");Cc=this.fHc(15,qa);break;case -59906385:case 1197060601:this.Noi(gb,qa);break;case 1305810481:this.Qkf(!1,gb);break;case 330035228:this.Qkf(!0,gb);break;case -509039657:Bb=Object(va.d)(Tb.a.resolve(pb.Ab,{Ja:0}));Sa.TaskExtensions.za(Bb,
Pd=>{this.deleteForm(Pd.result)},this.$.ka,3);break;case 1334518759:gb.IHb=!0;Bb=Object(va.d)(Tb.a.resolve(pb.Ab,{Ja:0}));Sa.TaskExtensions.za(Bb,Pd=>{this.shareForm(Pd.result)},this.$.ka,3);break;case 710925581:W.a.Bi.uHc("710925581")&&(Cc=Sa.TaskExtensions.za(this.qN.value,Pd=>{Pd.result.sendMessage(H.a.conversation,{})},this.ka,3));break;case 327119921:this.Mmi();break;default:Cc=Ab.a(hd)}return Cc}Be(qa,gb){qa=!1;gb=gb.command;if(gb===S.a.workflow)return!0;switch(gb){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:qa=
!0;break;case 353606613:case -1099009678:case 192430811:qa=sb.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")&&!this.$.ea.isNamedObjectViewMode;break;case 783415632:qa=sb.EwaSettings.isChangeGateEnabled("OfficeVSO:8096933_ShareExcelSheet")&&!this.$.ea.isNamedObjectViewMode}return qa}Ue(qa,gb,Bb){if("PopulateFormMenu"===gb){gb=this.fOc?this.iLe()?je.ASh:je.BSh:je.Z_i;qa=this.Ya.Ne();for(let ic=0;ic<gb.length;ic++)qa.buttons.push(this.Ya.od(gb[ic]));gb=this.Ya.ft("Forms.Flyout");
gb.Ae.push(qa);Bb.MenuItems=gb.rH();return!0}return!1}Jpi(qa,gb,Bb){return this.kZd&&qa.command===gb?(this.iZd(qa,-266099),Sa.TaskExtensions.ffa()):Sa.TaskExtensions.za(this.qN.value,ic=>{za.a(ic.result,H.a.workflow,null,Bb.WorkflowPostMessage)||ra.HelperMethods.Sg(Bb.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.ka,3)}iLe(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.pj.get(26)}Mmi(){var qa=jc.a.create().toString();v.ULS.sendTraceTag(528581128,
306,50,`Calling share to teams deeplink with ID: ${qa}`);var gb=this.$.frame,Bb=gb.Ceb,ic=this.$;const Cc=new Bd.QueryStringBuilder(y.AFrameworkApplication.da.Sa("TeamsMeetingShareEndpoint"));Cc.mj("deeplinkId",qa);Cc.mj("lm","deeplink");qa=Cc.mj;var hd={};const Pd=new Bd.QueryStringBuilder(y.AFrameworkApplication.da.Sa("TeamsAppSharingUrl"));Pd.mj("auth","2");Pd.mj("flight","officeunihost");Pd.mj("source","TEAMS-ELECTRON.meetingStage.deeplink");var ue={};ue.fileType=l.a.H8(ic.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);
ue.objectUrl=sb.EwaSettings.isChangeGateEnabled("OfficeVSO:8053799_EncodeUrlFixForDeeplink")?encodeURI(ic.workbookContext.FullDocumentInfo.WorkbookPath):ic.workbookContext.FullDocumentInfo.WorkbookPath;ue.baseUrl=sb.EwaSettings.isChangeGateEnabled("OfficeVSO:8053799_EncodeUrlFixForDeeplink")?encodeURI(ic.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl):ic.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;{ic=ic.workbookContext.WorkbookFileVersionId;let Ee=decodeURIComponent(ic);for(;ic!=Ee;)ic=
Ee,Ee=decodeURIComponent(ic);0>ic.indexOf("{")||0>ic.indexOf("}")?(v.ULS.sendTraceTag(528250338,306,15,`Decoded fileId does not match expected format. Decoded id: ${ic}`),ic=""):ic=ic.substring(ic.indexOf("{")+1,ic.indexOf("}")).toLowerCase()}ue.fileId=ic;ue=ba.c(ba.c(ue));Pd.mj("subEntityId",ue.substring(1,ue.length-1));hd.appSharingUrl=Pd.toString();hd.appId=y.AFrameworkApplication.da.Sa("TeamsAppId");hd.useMeetNow=!0;hd=JSON.stringify(hd);qa.call(Cc,"appContext",hd);Bb.call(gb,Cc.toString(),!0)}$mi(qa){this.kZd?
this.iZd(qa,1986648902):this.jhg()}Qkf(qa,gb){!qa&&this.$.xa.SurveyRedirectUrl?this.$pj():(qa=new dd(this.$,qa,gb),qa.initialize(),qa.Ji())}Noi(qa,gb){this.kZd&&1197060601===qa.command?this.iZd(qa,-59906385):Sa.TaskExtensions.za(this.qN.value,Bb=>{Bb=Bb.result;Bb&&za.a(Bb,H.a.replyWithChanges,null,this.$.ea.pj.get(8))||(Bb=new Sys.StringBuilder(gb.ReplyWithChangesUrl),U.a.Hp(Bb,lb.e,lb.d),Ha.a.ntw(Bb.toString(),this.$))},this.ka,3)}iZd(qa,gb){const Bb=be.a(this.$).rf.activityState,ic=new ua.a(gb,
qa.method,qa.mode,qa.Tg,qa.tabName);Ub.a(this.$).zs(new Va.a(Yc.a.ix,5,()=>{Bb[ed.a.Lq]=Yc.a.qbg;Bb[Fc.a.c4c]=ic;this.$.jn.HB("SocialSharingSaveBeforeCommand");this.$.jn.LAe(ic.command)}))}jhg(){const qa=this.$.xa.DocumentHostInfo;qa.HostEmbeddedViewUrl||this.WKe?this.ckg():this.$.mg.get(53)&&Sa.TaskExtensions.za(this.qN.value,gb=>{this.cek(gb.result)||Ha.a.ntw(qa.FileEmbedCommandUrl,this.$)},this.ka,3)}cek(qa){return qa.isEnabled()&&(this.VKe||(this.VKe=qa.fm(H.a.UKe,this.g4i)))?qa.sendMessage(H.a.$Th,
null):!1}ckg(){if(sc.a.ls)Ha.a.ntw(this.$.xa.EmbedConfiguratorUrl,this.$);else{const qa=new Ka(this.$);qa.initialize();qa.Ji()}}deleteForm(qa){const gb=this.$;qa=new xc(gb,1277,1278,1270,(Bb,ic,Cc)=>{var hd=gb.qa.ua.ie(),Pd=gb.qa.ua;hd=Pd.Pa(9,hd);hd.surveyId=null;return Lb.g(Pd,"DeleteSurvey",hd,Bb,ic,Cc,null,0)},0,qa);qa.initialize();qa.Ji()}shareForm(qa){const gb=this.$.workbookContext.FullDocumentInfo;this.$.ea.pj.get(26)?(qa=new ab(this.$,qa),qa.initialize(),qa.Ji()):Sa.TaskExtensions.za(this.qN.value,
Bb=>{za.a(Bb.result,H.a.shareForm,{[X.a.v7j]:this.$.workbookContext.SurveyTitle},this.$.ea.pj.get(10))||Ha.a.ntw(gb.ShareFormCommandUrl,this.$)},this.ka,3)}$pj(){const qa=this.$;qa.xa.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");const gb=new Sys.StringBuilder(qa.xa.SurveyRedirectUrl);U.a.Hp(gb,"startupDialog","FormEdit");const Bb=be.a(this.$),ic=Bb.rf.activityState;ic[Tc.a.w6]=gb.toString();ic[Tc.a.nP]=Tc.a.bKd;this.$.jn.HB("SocialSharingEnvironmentChange");Ub.a(qa).zs(new Va.a(Yc.a.ix,
5,()=>{const Cc=cc.a.qf(3,2,1322,1323,1324,554412057,"FossEnvironmentUnsupported");Bb.rf.Us([Cc]);ic[ed.a.Lq]=Yc.a.xug}))}h9a(qa){return(this.$.ea.isEditMode||(void 0===qa?!1:qa))&&this.$.ea.pj.get(25)&&Eb.a()}Ugi(qa){var gb=void 0===gb?null:gb;var Bb=$a.h(this.$).ha;let ic=!1;const Cc=this.$.va.na?Na.d(this.$.va.na):null;if(!Cc)return v.ULS.sendTraceTag(537151649,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: ${Rd[qa]}.`),null;14===qa?gb=this.qgi(Bb):
12===qa?(gb=Bb.Gma,gb=rb.a.contains(gb,"!",!0)?gb.split("!")[1]:gb,$a.h(this.$).ha.ra.BN()&&(ic=!0)):13===qa&&(Bb=Bb.ra.selectedRanges,Bb[0]&&(Bb=Bb[0],sb.EwaSettings.isChangeGateEnabled("OfficeVSO:8116498_FShareTableContainingActiveCell")&&(Bb=$a.h(this.$).ha.ra.activeCell),Bb=$a.h(this.$).zd.sh(Bb)))&&(gb=Bb.El);if(!gb&&15!==qa)return v.ULS.sendTraceTag(537151648,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: ${Rd[qa]}`),
null;Bb={};Bb[X.a.Njb]="copy";Bb[X.a.W1d]=this.q7h(qa,gb,Cc);Bb[X.a.HVj]="deepLinkShare";v.ULS.sendTraceTag(537151647,0,50,`SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: ${Rd[qa]} and sectionNameOrId: ${gb} and SheetId: ${Cc} and isPartialTable: ${ic}`);return Bb}qgi(qa){if(qa.Va.rU&&(qa=qa.Va.pe.floatingObject)&&0===qa.type){const gb=qa.id.split(".");if(1<gb.length)return gb[1];v.ULS.sendTraceTag(537151646,0,10,`SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  ${qa.id}`)}return null}q7h(qa,
gb,Bb){let ic=qa+"_";ic=btoa(15===qa?ic+Bb:ic+(gb+"_"+Bb));ic=ic.replace(RegExp("\\+","g"),"-");ic=ic.replace(RegExp("\\/","g"),"_");return ic=ic.replace(RegExp("\\=+$","g"),"")}slg(qa,gb,Bb){Bb=void 0===Bb?!1:Bb;return Sa.TaskExtensions.za(this.qN.value,ic=>{za.a(ic.result,H.a.sharing,gb,this.$.ea.pj.get(5))?(v.ULS.sendTraceTag(537151644,0,50,`SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: ${gb?gb[X.a.Njb]:""}`),Bb&&sb.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")&&
!this.hna&&(this.M8a=window.setInterval(()=>{this.Tbk()},6E4),this.hna=!0)):ra.HelperMethods.Sg(qa.FileSharingUrl,"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.ka,3)}fHc(qa,gb){if(15===qa&&!sb.EwaSettings.isChangeGateEnabled("OfficeVSO:8096933_ShareExcelSheet")||15!==qa&&!sb.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")||this.$.isMobileMode)return null;const Bb=this.Ugi(qa);if(Bb)return v.ULS.sendTraceTag(520737606,0,50,`SocialSharingCommandHandler.ShareExcelSection: Calling share dialog with nav id=${Bb[X.a.W1d]}`),
this.slg(gb,Bb,!0);v.ULS.sendTraceTag(537151643,0,10,`SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: ${Rd[qa]}`);return null}Tbk(){this.hna&&window.clearInterval(this.M8a);this.$.Me(638984051,0,0,null);v.ULS.sendTraceTag(512328542,0,50,"SocialSharingCommandHandler.triggerDeepLinkCreationSurvey: FPS survey got triggered.")}}je.Z_i=[103];je.ASh=[107,104,105,106];je.BSh=[104,105];je.afh=[new Hc.a(Yc.a.tOe,554412057,0,0,1325),new Hc.a(Yc.a.idle,554412057,
0,1)];Object(r.a)(je,"SocialSharingCommandHandler",Fa.a,[203]);class Fd extends La.a{constructor(qa){super(qa)}Uf(){const qa=new t.a(()=>ia.GetServiceTaskFactory.create(this.$.ga,137,this.ka,this.Ta));Sa.TaskExtensions.za(ia.GetServiceTaskFactory.create(this.$.ga,102,this.ka,this.Ta),gb=>{this.Lf([new je(this.$,gb.result,qa)])},this.ka,3)}static la(qa){La.a.qg(114,new Fd(qa))}}Object(r.a)(Fd,"SocialSharingCommandHandlerFactory",La.a,[]);var Oc=a(179),Ad=a(278),Gb=a(151),Wc=a(186);class pd{static rY(){return Gb.a.sq(pd.vn,
Wc.a.Ia(444))}}pd.vn="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";Object(r.a)(pd,"NamedSheetViewTeachingDialogHtml",null,[]);var fe=a(77),le=a(185),te=a(55);class Ce extends Ad.a{constructor(qa){super(qa);this.stopwatch=
this.Zv=null;this.j_i=gb=>{if(1===gb)this.$.Ha.Ad(new ua.a(-2050946363,fe.a.Bd,2,8,null)).continueWith(Bb=>{this.Zv.setResult(!le.a(Bb)&&Bb.result)}),gb="Yes";else{const Bb=2===gb;this.Zv.setResult(Bb);gb=2===gb?"No":"Close";Bb&&this.voj()}this.dTi(gb);this.hide()}}get we(){return"ShowNamedSheetViewTeachingDialog"}ri(){this.Rd=4;this.stopwatch=this.$.Sd.Ze("UserAction",this.we);const qa=ja.a.instance.ia(1913);this.di=pd.rY();this.Zv=new Oc.a;this.initializeAndShow(qa,this.j_i,{});return this.Zv.task}lB(qa){super.lB(qa);
this.qe(1,ja.a.instance.ia(1915));this.qe(2,ja.a.instance.Ia(457))}voj(){this.$.ea.XJd=!1}dTi(qa){const gb={};gb.a=this.$.xa.UserSessionId;gb.b="NamedSheetViewTeachingDialogClose";gb.c=qa;gb.e=!0;this.stopwatch&&(this.stopwatch.stop(),gb.d=this.stopwatch.Te);te.b().ih(53,gb,!0)}}Object(r.a)(Ce,"NamedSheetViewTeachingDialog",Ad.a,[]);var Xb=a(160);let oc=class{constructor(qa){this.$=qa}sYa(){return this.QYj()?(new Ce(this.$)).ri():ka.Task.Wa(!0)}QYj(){const qa=this.$.va.na;return this.$.ea.Reb&&this.$.ea.XJd&&
!qa.ng.$D&&this.$.ea.RP&&!Object(Xb.g)(this.$)}};oc=Object(Za.a)([Object(Tb.d)(pb.Ob),Object(Za.b)(0,Object(pb.W)())],oc);Object(r.a)(oc,"NamedSheetViewPublic",null,[544]);var Zc=a(2),yd=a(198),Od=a(1254),dc=a(917),gd=a(472);class wd{constructor(qa,gb,Bb,ic,Cc,hd,Pd){this.title=qa;this.body=gb;this.Hoj=Bb;this.primaryButtonAction=ic;this.secondaryButtonAction=hd;this.Ocg=Cc;this.targetObject=Pd}}Object(r.a)(wd,"NamedSheetViewTeachingCalloutContent",null,[]);class Ld{constructor(qa){this.Gwe=0;this.Hpg=
qa}get Fpg(){return this.Gwe}get kqj(){return this.Fpg<this.Hpg.count?this.Hpg.ma(this.Gwe++):null}}Object(r.a)(Ld,"NamedSheetViewTeachingCalloutList",null,[]);var Xd=a(1090),Ie;let We=Ie=class{constructor(qa){this.$=qa;this.stopwatch=this.Y8b=this.pKc=this.q7d=null;this.Gpg=0}zvi(qa){this.Gpg=qa;const gb=Object(Zc.a)(new yd.a,{});Ie.xEi(qa)?(gb.add(new wd(ja.a.instance.Ia(446),ja.a.instance.Ia(447),ja.a.instance.ia(1943),()=>{this.g$(2,"Continue");this.uea(!0)},ja.a.instance.ia(1944),()=>{this.uea();
this.g$(1,"ExitGuide")},Xd.a())),1===qa&&gb.add(new wd(ja.a.instance.ia(1945),ja.a.instance.Ia(449),ja.a.instance.ia(1943),()=>{this.g$(2,"FirstEnterTempViewContinueSecond");this.uea(!0)},ja.a.instance.ia(1944),()=>{this.uea();this.g$(1,"FirstEnterTempViewExitGuideSecond")},Xd.a())),gb.add(new wd(ja.a.instance.Ia(450),ja.a.instance.Ia(451),ja.a.instance.ia(1943),()=>{this.g$(2,"FirstEnterExitCalloutContinue");this.uea(!0)},ja.a.instance.ia(1944),()=>{this.uea();this.g$(1,"FirstEnterExitCalloutGuide")},
Ie.Gbi())),gb.add(new wd(ja.a.instance.ia(1946),ja.a.instance.Ia(448),ja.a.instance.ia(1947),()=>{this.K0j();this.uea();this.g$(1,"LearnMore")},ja.a.instance.ia(1948),()=>{this.uea();this.g$(1,"Done")},Ie.Fbi()))):2===qa&&gb.add(new wd(ja.a.instance.ia(1945),ja.a.instance.Ia(449),ja.a.instance.ia(1942),()=>{this.uea();this.g$(1,"EnterTempViewAfterPersistedView")},null,null,Xd.a()));this.q7d=new Ld(gb)}K0j(){const qa=new ua.a(-859308420,fe.a.Bd,this.$.se,9,null);this.$.Ha.Ad(qa,{[fe.a.Th]:"HelpID=SheetViews",
["InputMethod"]:fe.a.Bd,[fe.a.We]:yb.a.xN,["ShouldCanvasTakeFocus"]:!0})}show(qa){this.zvi(qa);this.nkb()}hSj(qa){this.Y8b=qa}nkb(){var qa=this.q7d.kqj;if(qa){var gb=Object(Zc.a)(new Od.a,{label:qa.Hoj,onExecute:qa.primaryButtonAction}),Bb=null;qa.Ocg&&(Bb=Object(Zc.a)(new Od.a,{label:qa.Ocg,onExecute:qa.secondaryButtonAction}));qa=Object(Zc.a)(new dc.a,{target:qa.targetObject,content:qa.body,title:qa.title,showCloseIcon:!0,primaryButtonProps:gb,secondaryButtonProps:Bb,useTeachingStyles:!0});qa=this.Y8b.callout(qa);
gb=Object(Zc.a)(new gd.a,{onShow:()=>{this.g$(0)}});this.pKc=this.Y8b.addNotification(qa,gb)}}dismiss(){this.uea();this.g$(1,"DismissedByOthers")}uea(qa){qa=void 0===qa?!1:qa;this.pKc&&(this.Y8b.removeNotification(this.pKc),this.pKc=null);qa&&this.nkb()}g$(qa,gb){const Bb={};Bb.a=this.$.xa.UserSessionId;Bb.b=this.Gpg;Bb.c=this.q7d.Fpg;Bb.d=qa;Bb.e=void 0===gb?null:gb;0===qa?this.stopwatch=this.$.Sd.Ze("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),Bb.f=this.stopwatch.Te,
this.stopwatch=null),2===qa&&(this.stopwatch=this.$.Sd.Ze("UserAction","ShowNamedSheetViewTeachingCalloutNext")));te.b().ih(52,Bb,!0)}static Fbi(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")}static Gbi(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")}static xEi(qa){return 0===qa||1===qa}};We=Ie=Object(Za.a)([Object(Tb.d)(pb.Pb),Object(Za.b)(0,Object(pb.W)())],We);Object(r.a)(We,"NamedSheetViewTeachingCallout",null,[543]);let jf=class{constructor(qa){this.nl=
qa}executeCommand(qa,gb,Bb){return 2!==this.nl.eg(S.a.tryOfficeThroughTellMe,2,Bb)?ka.Task.Wa(!0):Ab.a(gb.command)}Be(qa,gb){return 215809929===gb.command}Ue(){return!1}Pe(){return!1}};jf=Object(Za.a)([Object(Tb.d)(pb.Zc),Object(Za.b)(0,Object(pb.b)())],jf);Object(r.a)(jf,"TryOfficeThroughTellMeCommandHandler",null,[203]);var tc=a(138),Qc=a(383),xd=a(107),Gd=a(384);class pe{constructor(qa,gb){this.sheetName=null;this.value=!1;this.sheetName=qa;this.value=gb}getSheetName(){return this.sheetName}uAa(){return this.value}}
Object(r.a)(pe,"MacroRecorderSheetOptionToggledPayload",null,[135]);const Dc=(qa,gb,Bb,ic,Cc,hd,Pd,ue)=>{ue=qa.Pa(9,void 0===ue?null:ue);ue.sheetName=gb;ue.show=Bb;return Lb.g(qa,"ShowGridlines",ue,ic,Cc,hd,Pd,0)},Wa=(qa,gb,Bb,ic,Cc,hd,Pd,ue)=>{ue=qa.Pa(9,void 0===ue?null:ue);ue.sheetName=gb;ue.show=Bb;return Lb.g(qa,"ShowHeadings",ue,ic,Cc,hd,Pd,0)},Qb=(qa,gb,Bb,ic,Cc,hd,Pd,ue)=>{ue=qa.Pa(9,void 0===ue?null:ue);ue.sheetName=gb;ue.directionRtl=Bb;return Lb.g(qa,"ChangeSheetDirection",ue,ic,Cc,hd,
Pd,0)};var Lc;let Ba=Lc=class{constructor(qa){this.$=qa}Pe(){return!1}executeCommand(qa,gb){const Bb={};this.$.Kl(Bb);qa=gb.command;const ic=Object(tc.a)(xd.a,this.$.va.getItemByName(Bb.SheetName));if(!ic)return Ab.a(qa);let Cc,hd,Pd,ue,Ee;switch(qa){case 705559150:case -1411193626:Cc=16;hd=!ic.hideGridLines;Pd=Dc;Ee=183;ue=ic.hideGridLines;break;case -2052321504:case 515737500:Cc=4;hd=!ic.headersVisible;Pd=Wa;Ee=184;ue=!ic.headersVisible;break;case -1478455630:Cc=2;hd=!ic.displayRtl;Pd=Qb;Ee=185;
ue=!ic.displayRtl;$a.h(this.$).ya.Igk(hd);break;default:return Ab.a(qa)}ic.dxb(Cc,hd);const Se=()=>new pe(Bb.SheetName,ue),cf=this.$.qa.ua;return Qc.a(this.$.userOperationManager,(mf,ac,bd)=>Pd(cf,Bb.SheetName,ue,Kb.b(mf,nd=>{Lc.zOb(nd,ic,Cc,hd)}),Kb.a(ac,()=>{Lc.GNb(ic,Cc,hd)}),bd,null),mf=>new kb.a(Ee,0,mf,void 0,Se),gb)}Be(qa,gb){qa=!1;switch(gb.command){case -1411193626:case 515737500:case -1478455630:qa=!0;break;case 705559150:case -2052321504:qa=Gd.a(this.$)}return qa}Ue(){return!1}static zOb(qa,
gb,Bb,ic){cc.a.Rr(qa.Errors)&&gb.dxb(Bb,!ic)}static GNb(qa,gb,Bb){qa.dxb(gb,!Bb)}};Ba=Lc=Object(Za.a)([Object(Tb.d)(pb.Kc),Object(Za.b)(0,Object(pb.W)())],Ba);Object(r.a)(Ba,"SheetOptionsToggleCommandHandler",null,[203]);Object(Tb.b)(pb.Sb,{yt:"transient"})(qa=>Io(function*(){yield Tb.a.resolve(pb.Rb,qa);return new nb}));Type.registerNamespace("Common.App.NewAndOpen.UX");Ea.a.instance.Tk(new nb);(()=>{Oa.a.Ga(qa=>{sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCreateNewCommandHandler",
!1)||Pa.la(qa)})})();jb.a.Dk(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(()=>{Oa.a.Ga(qa=>{gc.la(qa)})})();(()=>{Oa.a.Ga(qa=>{sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateNewAndOpenUX",!1)||qa.ga.Qa(165,new Ta(qa))})})();(()=>{Oa.a.Ga(qa=>{sb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateOpenFromMruCommandHandler",
!1)||bc.la(qa)})})();Oa.a.Ga(Fd.la);String(h);String(k);String(d);String(f);String(u);String(b);String(c);window.___1689695406674_closurehack=h;window.___1689695406674_closurehack=k;window.___1689695406674_closurehack=d;window.___1689695406674_closurehack=f;window.___1689695406674_closurehack=u;window.___1689695406674_closurehack=b;window.___1689695406674_closurehack=c}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.kmhv.js.map/a0a6f997d4dd69930167b2eb934bf9c7/EwaTS.kmhv.js.map