'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[27],{1190:function(w,C,a){a.r(C);w=a(0);var b=a(14);class c{constructor(u,r,t,v,x,m){u&&(this.N=u);r&&(this.S=r);t&&(this.M=t);v&&(this.F=v);null!=x&&(this.L=x);null!=m&&(this.C=m)}}Object(w.a)(c,"SerializableExceptionEntry",null,[]);class h{constructor(u,r,t,v,x){this.T=u;this.L=r;this.S=t;this.I=v;this.V=x}}Object(w.a)(h,"SerializableLogCache",null,[]);class k{constructor(u,r,t,v,x,m,l=!1,n=null,z=null){this.T=
this.G=0;this.C=this.M=null;this.D=0;this.G=m;this.T=v;this.M=u;this.C=r;this.D=1E3*x+t;l&&(this.O=1);n&&(this.A=n);z&&(this.E=z)}qfh(){if(!this.E)return 0;let u=7,r=0;this.E.N&&(u+=6+k.Oda(this.E.N),r++);this.E.S&&(u+=6+k.Oda(this.E.S),r++);this.E.M&&(u+=6+k.Oda(this.E.M),r++);this.E.F&&(u+=6+k.Oda(this.E.F),r++);this.E.L&&(u+=6+k.Oda(this.E.L),r++);this.E.C&&(u+=6+k.Oda(this.E.C),r++);1<r&&(u+=r-1);return u}Ckh(){let u=a(1190).LogCache.hSi+k.Oda(this.G)+k.Oda(this.T)+this.M.length+k.Oda(this.C)+
k.Oda(this.D)+this.qfh();1===this.O&&(u+=6);if(this.A){u+=7;for(let r=0,t=this.A.length;r<t;++r)u+=this.A[r].length+3}return u}static Oda(u){return(""+u).length}}Object(w.a)(k,"SerializableLogEntry",null,[]);var d=a(391);a.d(C,"LogCache",function(){return f});class f{constructor(u,r,t){this.m2c=0;this.K2b=null;this.IGa=this.b6b=this.kob=0;this.l1c=u;this.I1a=r;this.D0=t;this.l1c=262144>u?u:262144;this.QMg=this.l1c-4*(this.I1a+25);this.reset()}reset(){this.K2b=[];this.kob=25;this.m2c=(new Date).getTime()}get count(){return this.K2b.length}get pYb(){return this.b6b}set pYb(u){this.b6b=
u}WVg(u){if(u){u.message=this.xXb(u.message,"message",u.tag);var r=u.Zkd;r&&(r.name=this.xXb(r.name,"Exception.Name",u.tag),r.stack=this.xXb(r.stack,"Exception.Stack",u.tag),r.message=this.xXb(r.message,"Exception.Message",u.tag),r.file=this.xXb(r.file,"Exception.File",u.tag));if(u.qh)for(var t=0;t<u.qh.length;t++)u.qh[t].length>this.I1a&&(u.qh[t]=u.qh[t].substr(0,this.I1a-13)+"... [trimmed]",b.ULS.sendTraceTag(3465240,100,50,"Trimmed arg {0} for log {1}",t,d.a(u.tag)));r=r?new c(r.name,r.stack,r.message,
r.file,r.line,r.column):null;u=new k(u.message,u.category,u.level,u.timestamp-this.m2c,u.hHd,u.tag,u.SGi,u.qh,r);r=u.Ckh();0<this.b6b&&r+this.kob>this.b6b&&(t=this.count,this.reset(),b.ULS.sendTraceTag(0,100,15,"The log size is too large to be accepted by the server, throwing away {0} logs.",t));Array.add(this.K2b,u);this.kob+=r}}xXb(u,r,t){let v=u;u&&u.length>this.I1a&&(v=u.substr(0,this.I1a-13)+"... [trimmed]",b.ULS.sendTraceTag(3465240,100,50,"Trimmed {0} for log {1}",r,d.a(t)));return v}get kDi(){return this.kob>
this.QMg}serialize(){return b.ULS.He(new h(this.m2c,this.K2b,this.D0,this.IGa,1))}get V4d(){return this.l1c}get JGd(){return this.I1a}}f.hSi=31;Object(w.a)(f,"LogCache",null,[71,72])},1359:function(w,C,a){a.r(C);w=a(646);C=a(0);var b=a(14),c=a(79),h=a(64);class k{constructor(){$addHandler(document,"securitypolicyviolation",Object(c.a)(this,this.LTf,"onSecurityPolicyViolationEventHandler"))}LTf(La){La=La.rawEvent;let ia=La.blockedURI;ia=h.a.j4(ia);const Sa={};Sa.effectiveDirective=La.effectiveDirective;
Sa.violatedDirective=La.violatedDirective;Sa.originalPolicy=La.originalPolicy;Sa.blockedURI=ia;Sa.disposition=La.disposition;b.ULS.sendTraceTag(588084128,306,15,"{0}",Sa)}dispose(){$removeHandler(document,"securitypolicyviolation",Object(c.a)(this,this.LTf,"onSecurityPolicyViolationEventHandler"))}}Object(C.a)(k,"ContentSecurityPolicyListener",null,[5]);var d=a(261);class f{constructor(){this.hd=null}get name(){return"Common.App.ContentSecurityPolicy"}init(){this.hd.resolve("Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener")}dispose(){const La=
this.hd.oi("Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener");La&&La.dispose()}Xj(La){this.hd=La;this.hd.register(k,"Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener").Ee().Le(()=>new k)}static main(){d.a.instance.Tk(new f)}}Object(C.a)(f,"ContentSecurityPolicyPackage",null,[2,3]);var u=a(42);class r{constructor(){this.File=this.Message=null;this.Column=this.Line=0;this.ClientAppVersion=this.Stack=null;this.AppMode=this.AppType=0;this.DeobfuscateWithSourceMaps=!1;this.DataPlumber=
this.SessionStartInfoJson=null;this.IsShuttingDown=!1;this.ErrorName=this.Flight=null}G_d(){return u.c(this)}}Object(C.a)(r,"DiagnosticsRequest",null,[]);var t=a(5),v=a(491),x=a(473),m=a(31);class l{constructor(La,ia,Sa,Za,Ab){this.AKa=La;this.CHa=ia;this.u5=Sa;this.NPc=Za;this.sLg=Ab}Idg(La,ia){try{this.Zqh().send(this.n0h(La,ia))}catch(Sa){b.ULS.sendTraceTag(6161306,201,10,"Could not send error report [{0}]",Sa.toString())}}Zqh(){const La=new XMLHttpRequest;La.open("POST",this.AKa,!0);La.setRequestHeader("Content-Type",
"text/json; charset=utf-8");t.AFrameworkApplication.userSessionId&&La.setRequestHeader(x.a.a_a,m.a.dI(t.AFrameworkApplication.userSessionId));this.CHa&&La.setRequestHeader(x.a.D3,this.CHa);if(t.AFrameworkApplication.tf){const ia=t.AFrameworkApplication.tf.iS;ia&&La.setRequestHeader(x.a.Lmb,ia)}return La}n0h(La,ia){if(!La)return null;ia=ia?"<stack>"+ia+"</stack>":"";const Sa=new r;Sa.Message=La.message;Sa.File=La.source;Sa.Line=La.line;Sa.Column=La.column;Sa.Stack=ia;Sa.ClientAppVersion=this.CHa;Sa.AppType=
this.u5;Sa.AppMode=this.NPc;Sa.DeobfuscateWithSourceMaps=this.sLg;t.AFrameworkApplication.da.pa("JavaScriptCrashJsonTagEnabled")&&(Sa.SessionStartInfoJson=t.AFrameworkApplication.da.appSettings.SessionStartInfoJson||"",t.AFrameworkApplication.Wg&&(Sa.DataPlumber=u.c(t.AFrameworkApplication.Wg)),Sa.IsShuttingDown=t.AFrameworkApplication.Di,Sa.Flight=t.AFrameworkApplication.flightId,Sa.ErrorName=v.a.Pbf(La));return Sa.G_d()}}Object(C.a)(l,"JavascriptErrorReporter",null,[763]);class n{build(La,ia,Sa,
Za,Ab){return new l(La,ia,Sa,Za,Ab)}}Object(C.a)(n,"JavascriptErrorReporterFactory",null,[751]);class z{Xj(La){La.register(n,"Common.App.Diagnostics.JavascriptErrorReporterFactory").as("Common.IJavascriptErrorReporterFactory").Ee().Le(()=>new n)}get name(){return"Common.App.Diagnostics"}init(){}dispose(){}static main(){d.a.instance.Tk(new z)}}Object(C.a)(z,"DiagnosticsPackage",null,[2,3]);var y=a(56),B=a(104),G=a(233),E=a(38),J=a(179),I=a(355),R=a(39),X=a(60),H=a(44),M=a(1190);class O{constructor(La=
null,ia=null,Sa=null,Za=null,Ab=null,pb=null,Tb=null,ob=null){this.JGd=3072;this.V4d=65536;this.$wg=6E4;this.sqg=2E3;this.wWe=1E4;this.cHe=5E3;this.bHe=!1;this.pYb=0;null!=La&&(this.JGd=La);null!=ia&&(this.V4d=ia);null!=Sa&&(this.$wg=Sa);null!=Za&&(this.sqg=Za);null!=Ab&&(this.wWe=Ab);null!=pb&&(this.cHe=pb);null!=Tb&&(this.bHe=Tb);null!=ob&&0<ob&&(this.pYb=ob)}}Object(C.a)(O,"UlsUploadConfiguration",null,[]);var L=a(391);class S{constructor(La,ia,Sa=null){this.N0b=0;this.VSc=!1;this.QMb=0;this.uob=
null;this.htb=0;this.dj=null;this.z1d=this._disposing=!1;this.bF=this.j2c=this.m_b=this.g0b=0;this.NFc=!1;this.Q_a=0;Sa||(Sa=new O);this.J0c=La;this.uploadUrl=ia;this.uploadUrl.toLowerCase().startsWith("http:")&&document.URL.toLowerCase().startsWith("https:")&&b.ULS.disable();this.wSg=Sa.$wg;this.TRg=Sa.sqg;this.$Hg=Sa.wWe;this.xSg=Sa.cHe;this.AFg=Sa.bHe;this.Sja=new M.LogCache(Sa.V4d,Sa.JGd,La);this.Sja.pYb=Sa.pYb;this.AXd();this.I9f();this.J9f()}I9f(){this.uob=[];this.VSc=!1}FY(La){1<this.Qlb?256>
this.uob.length?Array.add(this.uob,La):this.VSc=!0:(this.Sja.WVg(La),this.ISi(La)&&!this.KXe()?(this.w8e("LogIndicatesError in HandleTrace"),b.ULS.sendTraceTag(3731793,100,200,"Flushing error-level log (tag {0}) synchronously",L.a(La.tag))):this.Sja.kDi&&(this.iCb(!1,!0),b.ULS.sendTraceTag(3731794,100,200,"Flushing asynchronously due to cache size")))}ISi(La){return!!La&&(1===La.hHd||10===La.level)}KXe(){return!1}dispose(){this._disposing||(this._disposing=!0,this.nXh(),b.ULS.C1d(null),window.clearTimeout(this.Q_a),
window.clearTimeout(this.g0b),window.clearTimeout(this.m_b),this.m_b=this.g0b=this.Q_a=0)}nXh(){this.mode=2;this.wkf();this.NFc=!1;this.Z_e();this.w8e("FlushForAppClose")}oYb(La,ia){La.IGa=this.QMb;return this.axg(La.serialize(),ia)?(this.QMb++,!0):!1}axg(La,ia){ia=this.AFg||!ia;this.dj&&ia||(this.dj=new XMLHttpRequest);if(0===this.dj.readyState||4===this.dj.readyState)return this.dj.open("POST",this.uploadUrl,ia),this.dj.setRequestHeader("Content-Type","application/json"),this.dj.setRequestHeader(S.Y_d,
this.J0c),ia&&(this.dj.timeout=this.xSg),this.dj.send(La),!0;b.ULS.sendTraceTag(3731796,100,50,"Could not initiate upload {0}",{["UploadId"]:this.QMb,["XhrReadyState"]:this.dj.readyState});return!1}rgj(){this.dj&&this.dj.abort()}ZGc(La,ia,Sa){try{return window.setTimeout(()=>{b.ULS.sendTraceTag(3731797,100,200,"Timeout ({0} ms) set by {1} is now firing.",ia,Sa);La()},ia)}catch(Za){b.ULS.sendTraceTag(0,100,15,"SetTimeoutToLogOriginAndExecute: Calling Window.SetTimeout() failed with exception: {0}",
Za.toString());if(!this.z1d){this.z1d=!0;try{La()}finally{this.z1d=!1}}return 0}}J9f(){try{window.clearTimeout(this.g0b)}catch(La){b.ULS.sendTraceTag(0,100,15,"ResetDelayedLoggingTimer: Calling Window.ClearTimeout() failed with exception: {0}",La.toString())}this.g0b=this.ZGc(Object(c.a)(this,this.wkf,"handleDelayedLogs"),this.$Hg,"ResetDelayedLoggingTimer")}get Qlb(){return b.ULS.Qlb+this.htb}wkf(){const La=this.uob.length;if(La){var ia=this.uob,Sa=this.VSc;this.I9f();b.ULS.sendTraceTag(3731798,
100,50,"HandleDelayedLogs {0}",{["Count"]:La,["Limit"]:256,["ExceededLimit"]:Sa});this.htb++;for(Sa=0;Sa<La;Sa++)this.FY(ia[Sa]);this.htb--}this.J9f()}AXd(){try{window.clearTimeout(this.m_b)}catch(La){b.ULS.sendTraceTag(0,100,15,"ResetCadenceTimer: Calling Window.ClearTimeout() failed with exception: {0}",La.toString())}this.m_b=this.ZGc(Object(c.a)(this,this.iCb,"flushImpl"),this.wSg,"ResetCadenceTimer")}get mode(){return this.bF}set mode(La){const ia=this.bF;this.bF=La;if(0===this.bF&&0!==ia)try{const Sa=
this.j2c;this.j2c=0;window.clearTimeout(Sa)}catch(Sa){b.ULS.sendTraceTag(0,100,15,"set_Mode: Calling Window.ClearTimeout() failed with exception: {0}",Sa.toString())}else 0!==this.bF&&0===ia&&(this.j2c=this.ZGc(Object(c.a)(this,this.Z_e,"endThrottling"),this.TRg,"ThrottlingMode Setter"))}Z_e(){this.mode=0;this.NFc&&(this.NFc=!1,this.iCb())}lVb(La){return 2===this.mode||1===this.mode&&!La}w8e(La){b.ULS.sendTraceTag(3731800,100,200,"Flushing Synchronous due to {0}",La);this.iCb(!0)}gCb(){this.u8e(0)}u8e(La){this.Q_a||
(this.Q_a=this.ZGc(Object(c.a)(this,this.iCb,"flushImpl"),La,"FlushAsynchronous"))}iCb(La,ia){this.htb++;try{window.clearTimeout(this.Q_a)}catch(Za){b.ULS.sendTraceTag(0,100,15,"FlushImpl: Calling Window.ClearTimeout() failed with exception: {0}",Za.toString())}this.Q_a=0;if(this.Sja.count)if(!ia&&this.lVb(La))b.ULS.sendTraceTag(3731801,100,200,"Not flushing ({0}) due to throttling",La?"sync":"async"),this.NFc=!0;else{this.mode=La?2:1;this.AXd();b.ULS.sendTraceTag(3731803,100,200,"Flushing ({0}) cached bULS logs ({1} logs)",
La?"sync":"async",this.Sja.count);try{var Sa=this.oYb(this.Sja,La)}catch(Za){this.rgj(),Sa=!1}Sa?(this.Sja.reset(),this.N0b=0):(this.N0b++,this.N0b<S.HGf?this.u8e(S.sEc):(this.Sja.reset(),this.QMb++,this.N0b=0))}else this.AXd();this.htb--}fFb(){}Bub(){}}S.HGf=3;S.sEc=15E3;S.Y_d="X-UserSessionId";Object(C.a)(S,"UploadingUlsHost",null,[37,5]);const T=La=>{let ia=0;t.AFrameworkApplication.da&&(ia=t.AFrameworkApplication.da.getIntFeatureGate("Microsoft.Office.WordOnline.bUlsFetchRequestOption",-1),-1===
ia&&(ia=t.AFrameworkApplication.da.getIntFeatureGate("Microsoft.Office.Excel.bUlsFetchRequestOption",-1)),-1===ia&&(ia=t.AFrameworkApplication.da.getIntFeatureGate("Microsoft.Office.PowerPointOnline.bUlsFetchRequestOption",-1)),-1===ia&&(ia=t.AFrameworkApplication.da.getIntFeatureGate("Microsoft.Office.SharedOnline.bUlsFetchRequestOption",0)));return ia===La};class V{constructor(La,ia,Sa,Za){this.IGa=La;this.b8c=ia;this.sessionId=Sa;this.version=Za}}Object(C.a)(V,"UploadState",null,[]);class la{constructor(La){this.iMg=
La}get xNi(){return this.iMg}}Object(C.a)(la,"FetchRequestArgs",null,[]);var Z=a(84),da=a(543);class ba extends Sys.EventArgs{constructor(La){super();this.qh=La}}Object(C.a)(ba,"UlsLoggingEventArgs",Sys.EventArgs,[]);var na=a(212);class Y extends S{constructor(La,ia,Sa,Za,Ab,pb=null){super(t.AFrameworkApplication.userSessionId,Y.SZh(Y.n3h(La,Za),ia,Sa,pb),new O(void 0,t.AFrameworkApplication.Ski(),Za.Hf("BulsUploadFrequencyInMs",6E4),void 0,void 0,void 0,void 0,t.AFrameworkApplication.C$b));this.lie=
!1;this.Q_c=this.Tsb=this.VZb=this.wJ=null;this.Qi=Sa;this.pua=Za;(this.Rsb=this.pua.Sa("RemoteUlsETag"))&&Y.l0f(this.pua.Sa("RemoteUlsSuppressions"));Ab&&(this.VZb=Ab,this.VZb.J5c(Object(c.a)(this,this.gUf,"onSettingsRefreshed")))}get events(){return this.wJ||(this.wJ=new Sys.EventHandlerList)}Bub(La){this.events.addHandler(Y.utg,La)}get igb(){return null}get wPd(){return null}get A8c(){return this.pua.pa("BUlsExceptionLoggingIsEnabled")}dispose(){this.lie||(this.lie=!0,super.dispose(),this.VZb&&
this.VZb.k7f(Object(c.a)(this,this.gUf,"onSettingsRefreshed")))}gUf(La,ia){ia.ycb(Y.g7d)&&(this.Tsb=this.vif())}J3h(){return Error().stack}vif(){let La=null;if(this.pua.Ur(Y.g7d)){La=new na.a;const ia=this.pua.ay(Y.g7d);for(let Sa=0;Sa<ia.length;Sa++)La.fa(ia[Sa],!0)}return La}FY(La){this.Tsb||(this.Tsb=this.vif());if(this.Tsb&&this.Tsb.kd(La.tag))try{!La.Zkd&&this.A8c?La.Zkd=new da.a(Error()):La.message+=". JsCallStack: "+this.J3h()}catch(Sa){La.message+=" [Failed to add callstack for this tag. BUlsExceptionLoggingIsEnabled="+
this.A8c+" ("+Sa.message+")]"}super.FY(La);const ia=this.events.getHandler(Y.utg);La=new ba(La);ia&&ia(null,La)}oYb(La,ia){if(this.Qi){if(!this.FZj)return!1;const Sa=La.serialize();if(0<t.AFrameworkApplication.C$b&&Sa.length>t.AFrameworkApplication.C$b)return!1;La.IGa=this.QMb++;if(T(0)){if(this.wjg())return this.GTb(this.uploadUrl,Sa),!0;this.oBe(this.uploadUrl,Sa,ia&&!this.igb?0:3,1,ia&&t.AFrameworkApplication.Di,La.IGa,this.igb,this.wPd)}else{if(this.wjg()){if(T(1))return this.GTb(this.uploadUrl,
Sa),!0;window.console&&window.console.log&&window.console.log("Send shuttingDown buls from common")}this.a5c(this.uploadUrl,Sa,3,1,La.IGa,this.igb,this.wPd)}return!0}return T(0)?super.oYb(La,ia):(this.wNj(this.uploadUrl,La.serialize()),!0)}$yc(La){try{if(La&&La.data&&La.data.responseHeaders&&Y.GFb in La.data.responseHeaders){var ia=La.data.responseHeaders[Y.GFb];ia!==this.Rsb&&(this.Rsb=ia,Y.l0f(La.data.responseHeaders[Y.Hvd]))}}catch(Sa){b.ULS.sendTraceTag(593847297,100,50,"Failed to process tag suppressions. [Message: {0}] [Stack: {1}]",
Sa.message,Sa.stack)}}Hxc(La){const ia=La.data;if(!ia)b.ULS.sendTraceTag(5002497,100,15,"Request Item is null! RequestFailedEventArgs = {0}",La);else if(13===ia.status)b.ULS.sendTraceTag(6399108,100,50,"Request timed out in the ClientRequestManager queue. Falling back to default XHR."),this.axg(ia.request.get_body(),!1);else if(!ia.responseHeaders)b.ULS.sendTraceTag(5002498,100,15,"Item.ResponseHeader is null! RequestItem id = {0}, responseXml = {1}, data = {2}, HttpStatusCode = {3}",ia.id,ia.RWa,
ia.Tf,ia.httpStatus);else if(!(Y.Jzi in ia.responseHeaders||(La=ia.httpStatus,400<=La&&499>=La))){var Sa=ia.state;Sa.b8c>=S.HGf||(T(0)?window.setTimeout(()=>{this.oBe(ia.request.get_url(),ia.request.get_body(),3,Sa.b8c+1,!1,Sa.IGa,Sa.sessionId,Sa.version)},S.sEc):window.setTimeout(()=>{this.a5c(ia.request.get_url(),ia.request.get_body(),3,Sa.b8c+1,Sa.IGa,Sa.sessionId,Sa.version)},S.sEc))}}oBe(La,ia,Sa,Za,Ab,pb,Tb,ob){T(0)?this.Qi.Ho(La,2,ia,this.oed(),!1,Sa,Object(c.a)(this,this.$yc,"onSuccessfulUpload"),
Object(c.a)(this,this.Hxc,"onFailedUpload"),new V(pb,Za,Tb,ob),null,Ab,this.pua.Hf("BulsClientRequestManagerQueueTimeInMS",3E4),void 0,"19",Tb,void 0,ob,[Y.GFb,Y.Hvd]):this.a5c(La,ia,Sa,Za,pb,Tb,ob)}a5c(La,ia,Sa,Za,Ab,pb,Tb){let ob;ob=T(2)||T(3)?new la(!0):new la(!1);this.Qi.vVg(La,ia,this.oed(),ob,Sa,Object(c.a)(this,this.$yc,"onSuccessfulUpload"),Object(c.a)(this,this.Hxc,"onFailedUpload"),new V(Ab,Za,pb,Tb),this.pua.Hf("BulsClientRequestManagerQueueTimeInMS",3E4),pb,Tb,[Y.GFb,Y.Hvd])}wNj(La,ia){const Sa=
{};Sa.body=ia;Sa.method="POST";Sa.headers=this.oed();if(T(2)||T(3))Sa.keepalive=!0;window.fetch(La,Sa).then(()=>null,()=>{b.ULS.sendTraceTag(509149207,100,50,"exception from buls fetch");return null})}oed(){let La=null;this.Rsb&&(La={},La[Y.GFb]=this.Rsb);if(this.A8c){const ia=t.AFrameworkApplication.sa;let Sa=null;ia&&(Sa=ia.Ra);Sa&&(La||(La={}),La[Y.dri]=Sa.cDa,La[Y.eri]=Sa.kj,La[Y.jri]=t.AFrameworkApplication.vCi?"1":"0",T(0)||(La[Y.Xqi]="text/plain"))}return La}GTb(La,ia){this.Qi.GTb(La,ia)}wjg(){return t.AFrameworkApplication.Di||
t.AFrameworkApplication.msc}get PHj(){this.Q_c||(this.Q_c=this.pua.Hf("bULSUploadRetryDelayWhenDisconnectedInMilliseconds",6E4));return this.Q_c}get FZj(){const La=this.Qi.Xbb;return La&&(new Date).getTime()-this.Qi.hOi.getTime()>=this.PHj?!0:!La}static n3h(La,ia){ia=ia.Sa("BulsEndpointUrl");return Y.vvf(ia)?ia:La}static vvf(La){return!(void 0===La||null===La)&&""!==La}static SZh(La,ia,Sa,Za){La=Y.DUg(La,ia);La=Y.VXg(La,Sa);La=Y.lWg(La,Za);return La=Y.TXg(La)}static DUg(La,ia){return ia?h.a.um(La,
"build",t.AFrameworkApplication.buildVersion):La}static VXg(La,ia){if(!ia)return La;ia=ia.iS;return ia?La=h.a.um(La,x.a.SYb,ia):La}static lWg(La,ia){return Y.vvf(ia)?h.a.um(La,"officeserverversion",ia):La}static TXg(La){return t.AFrameworkApplication.userSessionId&&""!==t.AFrameworkApplication.userSessionId?h.a.um(La,t.AFrameworkApplication.Qta,t.AFrameworkApplication.userSessionId):La}static l0f(La){b.ULS.kbc();if(La){La=La.split(",");for(const ia of La)La=parseInt(ia),!isNaN(La)&&isFinite(La)&&
b.ULS.D7b(La)}}}Y.GFb="X-bULS-SuppressionETag";Y.Hvd="X-bULS-SuppressedTags";Y.dri="X-bULS-OfficeAppMode";Y.eri="X-bULS-OfficeAppType";Y.jri="X-bULS-UseSourceMaps";Y.Xqi="Content-Type";Y.utg="CommonUlsTraceEventKey";Y.g7d="TagCallStackInclusionList";Y.Jzi="X-InvalidUlsJson";Object(C.a)(Y,"CommonUlsHost",S,[]);var Ga=a(105);class ma extends Y{constructor(La,ia){super(La,!1,t.AFrameworkApplication.tf,Z.a.instance.oi("Common.IRefreshableAppSettings")||t.AFrameworkApplication.da,Z.a.instance.oi("Common.IRefreshableAppSettings"),
ia);this.Bek="usu";this.yek="ufu";this.vd=null;this.Ua=new Ga.a}get $(){this.vd||(this.vd=0<X.a.getRegisteredEwaInstances().length?X.a.Su(document.body):null);return this.vd}FY(La){1===La.hHd&&(La.message="Assert: "+La.message);super.FY(La)}KXe(){return!0}oYb(La,ia){if(t.AFrameworkApplication.Di&&t.AFrameworkApplication.Baa)return!1;let Sa=null;this.$&&(Sa=this.$.Sd.Ze("UserAction","CommonUlsHostOverrides:UploadLogs"));ia=!t.AFrameworkApplication.Baa&&ia;La=super.oYb(La,ia);Sa&&Sa.stop();return La}$yc(La){super.$yc(La);
this.Ua.raiseEvent(this.Bek,La)}Hxc(La){super.Hxc(La);this.Ua.raiseEvent(this.yek,La)}}Object(C.a)(ma,"CommonUlsHostOverrides",Y,[501,37,5]);class fa{lph(La,ia){return new ma(La,ia)}}Object(C.a)(fa,"CommonHostFactory",null,[522]);var Xa=a(65);class Ua extends R.a{constructor(La){super();this.Obc=La;Sys.Application.registerDisposableObject(this)}Bub(La){this.Obc.Bub(La)}FY(La){this.Obc.FY(La)}fFb(La){this.Obc.fFb(La)}gCb(){this.Obc.gCb()}static la(La,ia=null){const Sa=new J.a;Object(I.a)(Ua,t.AFrameworkApplication.cGa)||
(ia=ia||new fa,H.a.Mwi(()=>{var Za;if(t.AFrameworkApplication.browserUlsIsEnabled){var Ab=La+"/RemoteUls.ashx";Ua.$&&(Ab=Ua.dXg(Ab));const pb=this.Fhf();Ab=ia.lph(Ab,pb);null===(Za=t.AFrameworkApplication.cGa)||void 0===Za?void 0:Za.dispose();t.AFrameworkApplication.cGa=Ab;b.ULS.setTraceLevel(50);b.ULS.C1d(Ab);Sa.setResult(new Ua(Ab))}else b.ULS.disable()},!t.AFrameworkApplication.rXj()));return Sa.task}static dXg(La){const ia=this.Fhf();return h.a.um(La,"officeserverversion",ia)}static Fhf(){return Ua.$?
Xa.d(Ua.$)?Ua.$.workbookContext.BuildVersion:Ua.$.xa.BuildVersion:null}static get $(){Ua.vd||(Ua.vd=0<X.a.getRegisteredEwaInstances().length?X.a.Su(document.body):null);return Ua.vd}}Ua.vd=null;Object(C.a)(Ua,"EwaUlsHost",R.a,[501,37,5]);class ka extends G.a{constructor(La){super();this.isa=La;this.je()}create(){E.TaskExtensions.za(Ua.la(this.isa),La=>{La=La.result;B.a.Xn.Qa(135,La);this.Ld(La)},this.ka)}}Object(C.a)(ka,"EwaUlsHostFactory",G.a,[]);var nb=a(251),Ea=a(40);class sb{constructor(La){this.vqe=
null;this.NMi=La}get OKd(){return this.vqe||(this.vqe={})}ppj(La,ia,Sa){!La&&ia.source&&(La=Ea.a.Ks(this.OKd,ia.source)+1,this.OKd[ia.source]=La,La-1&La||b.ULS.sendTraceTag(537155536,0,15,`${La} errors seen for location=${ia.source}`));ia.source&&1!==Ea.a.Ks(this.OKd,ia.source,1)||(b.ULS.sendTraceTag(537155535,0,50,"JavaSctipCrashProcessor.ProcessJavascriptError: Sending request to log JavaScript crash in the server"),this.NMi.Idg(ia,Sa))}}Object(C.a)(sb,"JavaScriptCrashProcessor",null,[481]);var Oa=
a(78);Type.registerNamespace("_Ewa");Object(w.a)();Type.registerNamespace("Common.App.ContentSecurityPolicy");f.main();Type.registerNamespace("Common.App.Diagnostics");z.main();Type.registerNamespace("DiagUse");B.a.Xn.Qa(43,new ka(y.a.current.FI.ServerUriBase));(()=>{try{nb.a.Ejf().continueWith(La=>{try{if(B.a.Xn.Da(42))b.ULS.sendTraceTag(537155532,0,50,"JavaScriptCrashProcessorBootstrapper: already initialized");else{const ia=La.result,Sa=Z.a.instance.resolve("Common.IJavascriptErrorReporterFactory").build(y.a.current.FI.ServerUriBase+
ia.LayoutsRelativeUri+"/diagnostics.ashx",ia.BuildVersion,1,0,!0);B.a.Xn.Qa(42,new sb(Sa));b.ULS.sendTraceTag(537155533,0,50,"JavaScriptCrashProcessorBootstrapper: initialized and ready to be used")}}catch(ia){b.ULS.sendTraceTag(537155531,0,15,`JavaScriptCrashProcessorBootstrapper: An exception occured while initializing JavascriptErrorProcessor, Message: ${ia.message}, Callstack: ${ia.stack}`)}},3,null,Oa.a.current)}catch(La){b.ULS.sendTraceTag(537155530,0,15,`JavaScriptCrashProcessorBootstrapper: an exception occured, Message: ${La.message}, Callstack: ${La.stack}`)}})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.tmcore.js.map/b00fa3a4e70b5d9047090b18e4ce084e/EwaTS.tmcore.js.map